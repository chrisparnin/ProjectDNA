{
   "url": "https://zapier.com",
   "scripts": {
      "https://www.googleadservices.com/pagead/conversion.js": {
         "pageUrl": "https://zapier.com",
         "scriptUrl": "https://www.googleadservices.com/pagead/conversion.js",
         "body": "(function(){var g=this;var h=parseFloat(\"0.06\"),k=isNaN(h)||1<h||0>h?0:h;var l=function(a,c){for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&c.call(null,a[d],d,a)};var m,n,p,q,r=function(){return g.navigator?g.navigator.userAgent:null};q=p=n=m=!1;var s;if(s=r()){var t=g.navigator;m=0==s.lastIndexOf(\"Opera\",0);n=!m&&(-1!=s.indexOf(\"MSIE\")||-1!=s.indexOf(\"Trident\"));p=!m&&-1!=s.indexOf(\"WebKit\");q=!m&&!p&&!n&&\"Gecko\"==t.product}var u=n,v=q,w=p;var x;if(m&&g.opera){var y=g.opera.version;\"function\"==typeof y&&y()}else v?x=/rv\\:([^\\);]+)(\\)|;)/:u?x=/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/:w&&(x=/WebKit\\/(\\S+)/),x&&x.exec(r());var z=function(a){this.b=[];this.a={};for(var c=0,d=arguments.length;c<d;++c)this.a[arguments[c]]=\"\"},C=function(){var a=A,c=\"317150500 317150501 317150502 317150503 317150504 317150505\".split(\" \");if(a.a.hasOwnProperty(1)&&\"\"==a.a[1]){r:{if(!(1E-4>Math.random())){var d=Math.random();if(d<k){try{var b=new Uint16Array(1);window.crypto.getRandomValues(b);d=b[0]/65536}catch(e){d=Math.random()}c=c[Math.floor(d*c.length)];break r}}c=null}c&&\"\"!=c&&a.a.hasOwnProperty(1)&&(a.a[1]=c)}};\nz.prototype.c=function(a){return this.a.hasOwnProperty(a)?this.a[a]:\"\"};z.prototype.geil=z.prototype.c;var D=function(){var a=A,c=[];l(a.a,function(a){\"\"!=a&&c.push(a)});return 0<a.b.length&&0<c.length?a.b.join(\",\")+\",\"+c.join(\",\"):a.b.join(\",\")+c.join(\",\")};var A,E=\"google_conversion_id google_conversion_format google_conversion_type google_conversion_order_id google_conversion_language google_conversion_value google_conversion_currency_code google_conversion_domain google_conversion_label google_conversion_color google_disable_viewthrough google_remarketing_only google_remarketing_for_search google_conversion_items google_custom_params google_conversion_date google_conversion_time google_conversion_js_version onload_callback opt_image_generator google_is_call google_conversion_page_url\".split(\" \");\nfunction F(a){return null!=a?escape(a.toString()):\"\"}function G(a){return null!=a?a.toString().substring(0,512):\"\"}function H(a,c){var d=F(c);if(\"\"!=d){var b=F(a);if(\"\"!=b)return\"&\".concat(b,\"=\",d)}return\"\"}function I(a){var c=typeof a;return null==a||\"object\"==c||\"function\"==c?null:String(a).replace(/,/g,\"\\\\,\").replace(/;/g,\"\\\\;\").replace(/=/g,\"\\\\=\")}\nfunction J(a){var c;if((a=a.google_custom_params)&&\"object\"==typeof a&&\"function\"!=typeof a.join){var d=[];for(c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var b=a[c];if(b&&\"function\"==typeof b.join){for(var e=[],f=0;f<b.length;++f){var B=I(b[f]);null!=B&&e.push(B)}b=0==e.length?null:e.join(\",\")}else b=I(b);(e=I(c))&&null!=b&&d.push(e+\"=\"+b)}c=d.join(\";\")}else c=\"\";return\"\"==c?\"\":\"&\".concat(\"data=\",encodeURIComponent(c))}\nfunction K(a){return\"number\"!=typeof a&&\"string\"!=typeof a?\"\":F(a.toString())}function L(a){if(!a)return\"\";a=a.google_conversion_items;if(!a)return\"\";for(var c=[],d=0,b=a.length;d<b;d++){var e=a[d],f=[];e&&(f.push(K(e.value)),f.push(K(e.quantity)),f.push(K(e.item_id)),f.push(K(e.adwords_grouping)),f.push(K(e.sku)),c.push(\"(\"+f.join(\"*\")+\")\"))}return 0<c.length?\"&item=\"+c.join(\"\"):\"\"}\nfunction M(a,c,d){var b=[];if(a){var e=a.screen;e&&(b.push(H(\"u_h\",e.height)),b.push(H(\"u_w\",e.width)),b.push(H(\"u_ah\",e.availHeight)),b.push(H(\"u_aw\",e.availWidth)),b.push(H(\"u_cd\",e.colorDepth)));a.history&&b.push(H(\"u_his\",a.history.length))}d&&\"function\"==typeof d.getTimezoneOffset&&b.push(H(\"u_tz\",-d.getTimezoneOffset()));c&&(\"function\"==typeof c.javaEnabled&&b.push(H(\"u_java\",c.javaEnabled())),c.plugins&&b.push(H(\"u_nplug\",c.plugins.length)),c.mimeTypes&&b.push(H(\"u_nmime\",c.mimeTypes.length)));\nreturn b.join(\"\")}function N(a,c,d){var b=\"\";if(c){var e;if(a.top==a)e=0;else{var f=a.location.ancestorOrigins;if(f)e=f[f.length-1]==a.location.origin?1:2;else{f=a.top;try{e=!!f.location.href||\"\"===f.location.href}catch(B){e=!1}e=e?1:2}}f=\"\";f=d?d:1==e?a.top.location.href:a.location.href;b+=H(\"frm\",e);b+=H(\"url\",G(f));b+=H(\"ref\",G(c.referrer))}return b}function O(a){return a&&a.location&&a.location.protocol&&\"https:\"==a.location.protocol.toString().toLowerCase()?\"https:\":\"http:\"}\nfunction P(a){return a.google_remarketing_only?\"googleads.g.doubleclick.net\":a.google_conversion_domain||\"www.googleadservices.com\"}\nfunction Q(a,c,d,b){var e=\"/?\";\"landing\"==b.google_conversion_type&&(e=\"/extclk?\");var e=O(a)+\"//\"+P(b)+\"/pagead/\"+[b.google_remarketing_only?\"viewthroughconversion/\":\"conversion/\",F(b.google_conversion_id),e,\"random=\",F(b.google_conversion_time)].join(\"\"),f;r:{f=b.google_conversion_language;if(null!=f){f=f.toString();if(2==f.length){f=H(\"hl\",f);break r}if(5==f.length){f=H(\"hl\",f.substring(0,2))+H(\"gl\",f.substring(3,5));break r}}f=\"\"}a=[H(\"cv\",b.google_conversion_js_version),H(\"fst\",b.google_conversion_first_time),\nH(\"num\",b.google_conversion_snippets),H(\"fmt\",b.google_conversion_format),H(\"value\",b.google_conversion_value),H(\"currency_code\",b.google_conversion_currency_code),H(\"label\",b.google_conversion_label),H(\"oid\",b.google_conversion_order_id),H(\"bg\",b.google_conversion_color),f,H(\"guid\",\"ON\"),H(\"disvt\",b.google_disable_viewthrough),H(\"is_call\",b.google_is_call),H(\"eid\",D()),L(b),M(a,c,b.google_conversion_date),J(b),N(a,d,b.google_conversion_page_url),b.google_remarketing_for_search&&!b.google_conversion_domain?\n\"&srr=n\":\"\"].join(\"\");return e+a}function R(){var a=S,c=document,d=T,b;b=O(a)+\"//www.google.com/ads/user-lists/\"+[F(d.google_conversion_id),\"/?random=\",Math.floor(1E9*Math.random())].join(\"\");return b+=[H(\"label\",d.google_conversion_label),H(\"fmt\",\"3\"),N(a,c,d.google_conversion_page_url)].join(\"\")}\nfunction U(a){return{ar:1,bg:1,cs:1,da:1,de:1,el:1,en_AU:1,en_US:1,en_GB:1,es:1,et:1,fi:1,fr:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,iw:1,ja:1,ko:1,lt:1,nl:1,no:1,pl:1,pt_BR:1,pt_PT:1,ro:1,ru:1,sk:1,sl:1,sr:1,sv:1,th:1,tl:1,tr:1,vi:1,zh_CN:1,zh_TW:1}[a]?a+\".html\":\"en_US.html\"}\nfunction V(){var a=S,c=navigator,d=document,b=S;3!=b.google_conversion_format||b.google_remarketing_only||b.google_conversion_domain||A&&C();var e=A?A.c(1):\"\",c=Q(a,c,d,b),d=function(a,b,c){return'<img height=\"'+c+'\" width=\"'+b+'\" border=\"0\" alt=\"\" src=\"'+a+'\" />'};return 0==b.google_conversion_format&&null==b.google_conversion_domain?'<a href=\"'+(O(a)+\"//services.google.com/sitestats/\"+U(b.google_conversion_language)+\"?cid=\"+F(b.google_conversion_id))+'\" target=\"_blank\">'+d(c,135,27)+\"</a>\":1<b.google_conversion_snippets||\n3==b.google_conversion_format?\"317150501\"==e||\"317150502\"==e||\"317150503\"==e||\"317150504\"==e||\"317150505\"==e?d(c,1,1)+('<script src=\"'+c.replace(/(&|\\?)fmt=3(&|$)/,\"$1fmt=4&adtest=on$2\")+'\">\\x3c/script>'):d(c,1,1):'<iframe name=\"google_conversion_frame\" title=\"Google conversion frame\" width=\"'+(2==b.google_conversion_format?200:300)+'\" height=\"'+(2==b.google_conversion_format?26:13)+'\" src=\"'+c+'\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" vspace=\"0\" hspace=\"0\" allowtransparency=\"true\" scrolling=\"no\">'+\nd(c.replace(/\\?random=/,\"?frame=0&random=\"),1,1)+\"</iframe>\"}function aa(){return new Image}function ba(){var a=T,c=R(),d=aa;\"function\"===typeof a.opt_image_generator&&(d=a.opt_image_generator);a=d();c+=H(\"async\",\"1\");a.src=c;a.onload=function(){}};var S=window;\nif(S)if(null!=/[\\?&;]google_debug/.exec(document.URL)){var ca=S,W=document.getElementsByTagName(\"head\")[0];W||(W=document.createElement(\"head\"),document.getElementsByTagName(\"html\")[0].insertBefore(W,document.getElementsByTagName(\"body\")[0]));var X=document.createElement(\"script\");X.src=O(window)+\"//\"+P(ca)+\"/pagead/conversion_debug_overlay.js\";W.appendChild(X)}else{try{var Y;var Z=S;\"landing\"==Z.google_conversion_type||!Z.google_conversion_id||Z.google_remarketing_only&&Z.google_disable_viewthrough?Y=\n!1:(Z.google_conversion_date=new Date,Z.google_conversion_time=Z.google_conversion_date.getTime(),Z.google_conversion_snippets=\"number\"==typeof Z.google_conversion_snippets&&0<Z.google_conversion_snippets?Z.google_conversion_snippets+1:1,\"number\"!=typeof Z.google_conversion_first_time&&(Z.google_conversion_first_time=Z.google_conversion_time),Z.google_conversion_js_version=\"7\",0!=Z.google_conversion_format&&1!=Z.google_conversion_format&&2!=Z.google_conversion_format&&3!=Z.google_conversion_format&&\n(Z.google_conversion_format=1),A=new z(1),Y=!0);if(Y&&(document.write(V()),S.google_remarketing_for_search&&!S.google_conversion_domain)){var T=S;ba()}}catch(da){}for(var ea=S,$=0;$<E.length;$++)ea[E[$]]=null};})();\n"
      },
      "https://www.google-analytics.com/analytics.js": {
         "pageUrl": "https://zapier.com",
         "scriptUrl": "https://www.google-analytics.com/analytics.js",
         "body": "(function(){var aa=encodeURIComponent,f=window,ba=setTimeout,n=Math,ea=RegExp;function fa(a,b){return a.name=b}function Pc(a,b){return a.href=b}\nvar p=\"push\",h=\"hash\",ha=\"slice\",Qc=\"replace\",q=\"data\",r=\"cookie\",t=\"indexOf\",m=\"match\",ia=\"defaultValue\",ja=\"port\",u=\"createElement\",id=\"setAttribute\",v=\"name\",da=\"getTime\",x=\"host\",y=\"length\",z=\"prototype\",la=\"clientWidth\",A=\"split\",B=\"location\",ma=\"hostname\",ga=\"search\",jd=\"target\",C=\"call\",E=\"protocol\",na=\"clientHeight\",Ab=\"href\",F=\"substring\",kd=\"action\",G=\"apply\",oa=\"navigator\",Ub=\"parentNode\",H=\"join\",I=\"toLowerCase\";var pa=new function(){var a=[];this.set=function(b){a[b]=!0};this.M=function(){for(var b=[],c=0;c<a[y];c++)a[c]&&(b[n.floor(c/6)]=b[n.floor(c/6)]^1<<c%6);for(c=0;c<b[y];c++)b[c]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\".charAt(b[c]||0);return b[H](\"\")+\"~\"}};function J(a){pa.set(a)};function K(a){return\"function\"==typeof a}function qa(a){return void 0!=a&&-1<(a.constructor+\"\")[t](\"String\")}function ra(){return n.round(2147483647*n.random())}function Ca(a){var b=M[u](\"img\");b.width=1;b.height=1;b.src=a;return b}function L(){}function sa(a){if(aa instanceof Function)return aa(a);J(28);return a}function ka(a){return sa(a)[Qc](/\\(/g,\"%28\")[Qc](/\\)/g,\"%29\")}\nvar ta=function(a,b,c,d){try{a.addEventListener?a.addEventListener(b,c,!!d):a.attachEvent&&a.attachEvent(\"on\"+b,c)}catch(e){J(27)}},ua=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent(\"on\"+b,c)};function vc(a,b){if(a){var c=M[u](\"script\");c.type=\"text/javascript\";c.async=!0;c.src=a;c.id=b;var d=M.getElementsByTagName(\"script\")[0];d[Ub].insertBefore(c,d)}}function eb(){var a=\"\"+M[B][ma];return 0==a[t](\"www.\")?a[F](4):a}\nfunction va(a){var b=M.referrer;if(/^https?:\\/\\//i.test(b)){if(a)return b;a=\"//\"+M[B][ma];var c=b[t](a);if(5==c||6==c)if(a=b.charAt(c+a[y]),\"/\"==a||\"?\"==a||\"\"==a||\":\"==a)return;return b}}function wa(a,b){if(1==b[y]&&null!=b[0]&&\"object\"===typeof b[0])return b[0];for(var c={},d=n.min(a[y]+1,b[y]),e=0;e<d;e++)if(\"object\"===typeof b[e]){for(var g in b[e])b[e].hasOwnProperty(g)&&(c[g]=b[e][g]);break}else e<a[y]&&(c[a[e]]=b[e]);return c};var N=function(){this.keys=[];this.w={};this.m={}};N[z].set=function(a,b,c){this.keys[p](a);c?this.m[\":\"+a]=b:this.w[\":\"+a]=b};N[z].get=function(a){return this.m.hasOwnProperty(\":\"+a)?this.m[\":\"+a]:this.w[\":\"+a]};N[z].map=function(a){for(var b=0;b<this.keys[y];b++){var c=this.keys[b],d=this.get(c);d&&a(c,d)}};var O=f,M=document,xa=function(a){var b=O._gaUserPrefs;if(b&&b.ioo&&b.ioo()||a&&!0===O[\"ga-disable-\"+a])return!0;try{var c=O.external;if(c&&c._gaUserPrefs&&\"oo\"==c._gaUserPrefs)return!0}catch(d){}return!1},fb=function(a){ba(a,100)},ya=function(a){var b=[],c=M[r][A](\";\");a=ea(\"^\\\\s*\"+a+\"=\\\\s*(.*?)\\\\s*$\");for(var d=0;d<c[y];d++){var e=c[d][m](a);e&&b[p](e[1])}return b},zc=function(a,b,c,d,e,g){e=xa(e)?!1:Aa.test(M[B][ma])||\"/\"==c&&za.test(d)?!1:!0;if(!e)return!1;b&&200<b[y]&&(b=b[F](0,200),J(24));c=\na+\"=\"+b+\"; path=\"+c+\"; \";g&&(c+=\"expires=\"+(new Date((new Date)[da]()+g)).toGMTString()+\"; \");d&&\"none\"!=d&&(c+=\"domain=\"+d+\";\");d=M[r];M.cookie=c;if(!(d=d!=M[r]))t:{a=ya(a);for(d=0;d<a[y];d++)if(b==a[d]){d=!0;break t}d=!1}return d},za=ea(/^(www\\.)?google(\\.com?)?(\\.[a-z]{2})?$/),Aa=ea(/(^|\\.)doubleclick\\.net$/i);var oc=function(){return(Ba||\"https:\"==M[B][E]?\"https:\":\"http:\")+\"//www.google-analytics.com\"},Da=function(a){fa(this,\"len\");this.message=a+\"-8192\"},Ea=function(a){fa(this,\"ff2post\");this.message=a+\"-2036\"},Ga=function(a,b){b=b||L;if(2036>=a[y])wc(a,b);else if(8192>=a[y]){var c=b;if(0<=O[oa].userAgent[t](\"Firefox\")&&![].reduce)throw new Ea(a[y]);xc(a,c)||Fa(a,c)}else throw new Da(a[y]);},wc=function(a,b){var c=Ca(oc()+\"/collect?\"+a);c.onload=c.onerror=function(){c.onload=null;c.onerror=null;b()}},\nxc=function(a,b){var c,d=O.XDomainRequest;if(d)c=new d,c.open(\"POST\",oc()+\"/collect\");else if(d=O.XMLHttpRequest)d=new d,\"withCredentials\"in d&&(c=d,c.open(\"POST\",oc()+\"/collect\",!0),c.setRequestHeader(\"Content-Type\",\"text/plain\"));if(c)return c.onreadystatechange=function(){4==c.readyState&&(b(),c=null)},c.send(a),!0},Fa=function(a,b){if(M.body){a=aa(a);try{var c=M[u]('<iframe name=\"'+a+'\"></iframe>')}catch(d){c=M[u](\"iframe\"),fa(c,a)}c.height=\"0\";c.width=\"0\";c.style.display=\"none\";c.style.visibility=\n\"hidden\";var e=M[B],e=oc()+\"/analytics_iframe.html#\"+aa(e[E]+\"//\"+e[x]+\"/favicon.ico\"),g=function(){c.src=\"\";c[Ub]&&c[Ub].removeChild(c)};ta(O,\"beforeunload\",g);var ca=!1,l=0,k=function(){if(!ca){try{if(9<l||c.contentWindow[B][x]==M[B][x]){ca=!0;g();ua(O,\"beforeunload\",g);b();return}}catch(a){}l++;ba(k,200)}};ta(c,\"load\",k);M.body.appendChild(c);c.src=e}else fb(function(){Fa(a,b)})};var Ha=function(){this.t=[]};Ha[z].add=function(a){this.t[p](a)};Ha[z].execute=function(a){try{for(var b=0;b<this.t[y];b++){var c=a.get(this.t[b]);c&&K(c)&&c[C](O,a)}}catch(d){}b=a.get(Ia);b!=L&&K(b)&&(a.set(Ia,L,!0),ba(b,10))};function Ja(a){if(100!=a.get(Ka)&&La(P(a,Q))%1E4>=100*R(a,Ka))throw\"abort\";}function Ma(a){if(xa(P(a,Na)))throw\"abort\";}function Oa(){var a=M[B][E];if(\"http:\"!=a&&\"https:\"!=a)throw\"abort\";}\nfunction Pa(a){a.set(Ac,R(a,Ac)+1);var b=[];Qa.map(function(c,d){if(d.p){var e=a.get(c);void 0!=e&&e!=d[ia]&&(\"boolean\"==typeof e&&(e*=1),b[p](d.p+\"=\"+sa(\"\"+e)))}});b[p](\"z=\"+ra());a.set(Ra,b[H](\"&\"),!0)}function Sa(a){Ga(P(a,Ra),a.get(Ia));a.set(Ia,L,!0)}function Hc(a){var b=O.gaData;b&&(b.expId&&a.set(Nc,b.expId),b.expVar&&a.set(Oc,b.expVar))}function cd(){if(O[oa]&&\"preview\"==O[oa].loadPurpose)throw\"abort\";};function Ta(a){var b=R(a,Ua);500<=b&&J(15);var c=P(a,Va);if(\"transaction\"!=c&&\"item\"!=c){var c=R(a,Wa),d=(new Date)[da](),e=R(a,Xa);0==e&&a.set(Xa,d);e=n.round(2*(d-e)/1E3);0<e&&(c=n.min(c+e,20),a.set(Xa,d));if(0>=c)throw\"abort\";a.set(Wa,--c)}a.set(Ua,++b)};var Ya=function(){this.data=new N},Qa=new N,Za=[];Ya[z].get=function(a){var b=$a(a),c=this[q].get(a);b&&void 0==c&&(c=K(b[ia])?b[ia]():b[ia]);return b&&b.n?b.n(this,a,c):c};var P=function(a,b){var c=a.get(b);return void 0==c?\"\":\"\"+c},R=function(a,b){var c=a.get(b);return void 0==c||\"\"===c?0:1*c};Ya[z].set=function(a,b,c){if(a)if(\"object\"==typeof a)for(var d in a)a.hasOwnProperty(d)&&ab(this,d,a[d],c);else ab(this,a,b,c)};\nvar ab=function(a,b,c,d){var e=$a(b);e&&e.o?e.o(a,b,c,d):a[q].set(b,c,d)},bb=function(a,b,c,d,e){fa(this,a);this.p=b;this.n=d;this.o=e;this.defaultValue=c},$a=function(a){var b=Qa.get(a);if(!b)for(var c=0;c<Za[y];c++){var d=Za[c],e=d[0].exec(a);if(e){b=d[1](e);Qa.set(b[v],b);break}}return b},yc=function(a){var b;Qa.map(function(c,d){d.p==a&&(b=d)});return b&&b[v]},S=function(a,b,c,d,e){a=new bb(a,b,c,d,e);Qa.set(a[v],a);return a[v]},cb=function(a,b){Za[p]([ea(\"^\"+a+\"$\"),b])},T=function(a,b,c){return S(a,\nb,c,void 0,db)},db=function(){};var ld;if(ld=qa(f.GoogleAnalyticsObject)){var md=f.GoogleAnalyticsObject;ld=md?md[Qc](/^[\\s\\xa0]+|[\\s\\xa0]+$/g,\"\"):\"\"}var gb=ld||\"ga\",Ba=!1,hb=T(\"apiVersion\",\"v\"),ib=T(\"clientVersion\",\"_v\");S(\"anonymizeIp\",\"aip\");var jb=S(\"adSenseId\",\"a\"),Va=S(\"hitType\",\"t\"),Ia=S(\"hitCallback\"),Ra=S(\"hitPayload\");S(\"nonInteraction\",\"ni\");S(\"currencyCode\",\"cu\");S(\"sessionControl\",\"sc\",\"\");S(\"queueTime\",\"qt\");var Ac=S(\"_s\",\"_s\");S(\"description\",\"cd\");\nvar kb=S(\"location\",\"dl\",\"\"),lb=S(\"referrer\",\"dr\"),mb=S(\"page\",\"dp\",\"\");S(\"hostname\",\"dh\");var nb=S(\"language\",\"ul\"),ob=S(\"encoding\",\"de\");S(\"title\",\"dt\",function(){return M.title||void 0});cb(\"contentGroup([0-9]+)\",function(a){return new bb(a[0],\"cg\"+a[1])});var pb=S(\"screenColors\",\"sd\"),qb=S(\"screenResolution\",\"sr\"),rb=S(\"viewportSize\",\"vp\"),sb=S(\"javaEnabled\",\"je\"),tb=S(\"flashVersion\",\"fl\");S(\"campaignId\",\"ci\");S(\"campaignName\",\"cn\");S(\"campaignSource\",\"cs\");S(\"campaignMedium\",\"cm\");\nS(\"campaignKeyword\",\"ck\");S(\"campaignContent\",\"cc\");var ub=S(\"eventCategory\",\"ec\"),xb=S(\"eventAction\",\"ea\"),yb=S(\"eventLabel\",\"el\"),zb=S(\"eventValue\",\"ev\"),Bb=S(\"socialNetwork\",\"sn\"),Cb=S(\"socialAction\",\"sa\"),Db=S(\"socialTarget\",\"st\"),Eb=S(\"l1\",\"plt\"),Fb=S(\"l2\",\"pdt\"),Gb=S(\"l3\",\"dns\"),Hb=S(\"l4\",\"rrt\"),Ib=S(\"l5\",\"srt\"),Jb=S(\"l6\",\"tcp\"),Kb=S(\"l7\",\"dit\"),Lb=S(\"l8\",\"clt\"),Mb=S(\"timingCategory\",\"utc\"),Nb=S(\"timingVar\",\"utv\"),Ob=S(\"timingLabel\",\"utl\"),Pb=S(\"timingValue\",\"utt\");S(\"appName\",\"an\");\nS(\"appVersion\",\"av\",\"\");S(\"appId\",\"aid\",\"\");S(\"appInstallerId\",\"aiid\",\"\");S(\"exDescription\",\"exd\");S(\"exFatal\",\"exf\");var Nc=S(\"expId\",\"xid\"),Oc=S(\"expVar\",\"xvar\"),Rc=S(\"_utma\",\"_utma\"),Sc=S(\"_utmz\",\"_utmz\"),Tc=S(\"_utmht\",\"_utmht\"),Ua=S(\"_hc\",void 0,0),Xa=S(\"_ti\",void 0,0),Wa=S(\"_to\",void 0,20);cb(\"dimension([0-9]+)\",function(a){return new bb(a[0],\"cd\"+a[1])});cb(\"metric([0-9]+)\",function(a){return new bb(a[0],\"cm\"+a[1])});S(\"linkerParam\",void 0,void 0,Bc,db);\nS(\"usage\",\"_u\",void 0,function(){return pa.M()},db);S(\"forceSSL\",void 0,void 0,function(){return Ba},function(a,b,c){Ba=!!c});var ed=S(\"joinId\",\"jid\");cb(\"\\\\&(.*)\",function(a){var b=new bb(a[0],a[1]),c=yc(a[0][F](1));c&&(b.n=function(a){return a.get(c)},b.o=function(a,b,g,ca){a.set(c,g,ca)},b.p=void 0);return b});\nvar Qb=T(\"oot\"),dd=S(\"previewTask\"),Rb=S(\"checkProtocolTask\"),Sb=S(\"checkStorageTask\"),Uc=S(\"historyImportTask\"),Tb=S(\"samplerTask\"),Vb=T(\"rateLimiterTask\"),Wb=S(\"buildHitTask\"),Xb=S(\"sendHitTask\"),Vc=S(\"ceTask\"),V=T(\"name\"),Q=T(\"clientId\",\"cid\"),Na=T(\"trackingId\",\"tid\"),U=T(\"cookieName\",void 0,\"_ga\"),W=T(\"cookieDomain\"),Yb=T(\"cookiePath\",void 0,\"/\"),Zb=T(\"cookieExpires\",void 0,63072E3),$b=T(\"legacyCookieDomain\"),Wc=T(\"legacyHistoryImport\",void 0,!0),ac=T(\"storage\",void 0,\"cookie\"),bc=T(\"allowLinker\",\nvoid 0,!1),cc=T(\"allowAnchor\",void 0,!0),Ka=T(\"sampleRate\",\"sf\",100),dc=T(\"siteSpeedSampleRate\",void 0,1),ec=T(\"alwaysSendReferrer\",void 0,!1);function Cc(){var a=$;X(\"create\",a,a.create,3);X(\"getByName\",a,a.j,5);X(\"getAll\",a,a.K,6);a=pc[z];X(\"get\",a,a.get,7);X(\"set\",a,a.set,4);X(\"send\",a,a.send,2);a=Ya[z];X(\"get\",a,a.get);X(\"set\",a,a.set);(O.gaplugins=O.gaplugins||{}).Linker=Dc;a=Dc[z];Z.C(\"linker\",Dc);X(\"decorate\",a,a.Q,20);X(\"autoLink\",a,a.S,25);Z.C(\"displayfeatures\",fd)}\nfunction X(a,b,c,d){b[a]=function(){try{return d&&J(d),c[G](this,arguments)}catch(b){var g=b&&b[v];if(!(1<=100*n.random()||xa(\"?\"))){var ca=[\"t=error\",\"_e=exc\",\"_v=j15\",\"sr=1\"];a&&ca[p](\"_f=\"+a);g&&ca[p](\"_m=\"+sa(g[F](0,100)));ca[p](\"aip=1\");ca[p](\"z=\"+ra());Ga(ca[H](\"&\"))}throw b;}}};function fc(){var a,b,c;if((c=(c=O[oa])?c.plugins:null)&&c[y])for(var d=0;d<c[y]&&!b;d++){var e=c[d];-1<e[v][t](\"Shockwave Flash\")&&(b=e.description)}if(!b)try{a=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.7\"),b=a.GetVariable(\"$version\")}catch(g){}if(!b)try{a=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.6\"),b=\"WIN 6,0,21,0\",a.AllowScriptAccess=\"always\",b=a.GetVariable(\"$version\")}catch(ca){}if(!b)try{a=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\"),b=a.GetVariable(\"$version\")}catch(l){}b&&\n(a=b[m](/[\\d]+/g))&&3<=a[y]&&(b=a[0]+\".\"+a[1]+\" r\"+a[2]);return b||void 0};var gc=function(a,b){var c=n.min(R(a,dc),100);if(!(La(P(a,Q))%100>=c)&&(c={},Ec(c)||Fc(c))){var d=c[Eb];void 0==d||Infinity==d||isNaN(d)||(0<d?(Y(c,Gb),Y(c,Jb),Y(c,Ib),Y(c,Fb),Y(c,Hb),Y(c,Kb),Y(c,Lb),b(c)):ta(O,\"load\",function(){gc(a,b)},!1))}},Ec=function(a){var b=O.performance||O.webkitPerformance,b=b&&b.timing;if(!b)return!1;var c=b.navigationStart;if(0==c)return!1;a[Eb]=b.loadEventStart-c;a[Gb]=b.domainLookupEnd-b.domainLookupStart;a[Jb]=b.connectEnd-b.connectStart;a[Ib]=b.responseStart-b.requestStart;\na[Fb]=b.responseEnd-b.responseStart;a[Hb]=b.fetchStart-c;a[Kb]=b.domInteractive-c;a[Lb]=b.domContentLoadedEventStart-c;return!0},Fc=function(a){if(O.top!=O)return!1;var b=O.external,c=b&&b.onloadT;b&&!b.isValidLoadTime&&(c=void 0);2147483648<c&&(c=void 0);0<c&&b.setPageReadyTime();if(void 0==c)return!1;a[Eb]=c;return!0},Y=function(a,b){var c=a[b];if(isNaN(c)||Infinity==c||0>c)a[b]=void 0};var hc=!1,mc=function(a){if(\"cookie\"==P(a,ac)){var b=P(a,U),c=nd(a),d=kc(P(a,Yb)),e=lc(P(a,W)),g=1E3*R(a,Zb),ca=P(a,Na);if(\"auto\"!=e)zc(b,c,d,e,ca,g)&&(hc=!0);else{J(32);var l;t:{c=[];e=eb()[A](\".\");if(4==e[y]&&(l=e[e[y]-1],parseInt(l,10)==l)){l=[\"none\"];break t}for(l=e[y]-2;0<=l;l--)c[p](e[ha](l)[H](\".\"));c[p](\"none\");l=c}for(var k=0;k<l[y];k++)if(e=l[k],a[q].set(W,e),c=nd(a),zc(b,c,d,e,ca,g)){hc=!0;return}a[q].set(W,\"auto\")}}},nc=function(a){if(\"cookie\"==P(a,ac)&&!hc&&(mc(a),!hc))throw\"abort\";},\nYc=function(a){if(a.get(Wc)){var b=P(a,W),c=P(a,$b)||eb(),d=Xc(\"__utma\",c,b);d&&(J(19),a.set(Tc,(new Date)[da](),!0),a.set(Rc,d.R),(b=Xc(\"__utmz\",c,b))&&d[h]==b[h]&&a.set(Sc,b.R))}},nd=function(a){var b=ka(P(a,Q)),c=ic(P(a,W));a=jc(P(a,Yb));1<a&&(c+=\"-\"+a);return[\"GA1\",c,b][H](\".\")},Gc=function(a,b,c){for(var d=[],e=[],g,ca=0;ca<a[y];ca++){var l=a[ca];if(l.r[c]==b)d[p](l);else void 0==g||l.r[c]<g?(e=[l],g=l.r[c]):l.r[c]==g&&e[p](l)}return 0<d[y]?d:e},lc=function(a){return 0==a[t](\".\")?a.substr(1):\na},ic=function(a){return lc(a)[A](\".\")[y]},kc=function(a){if(!a)return\"/\";1<a[y]&&a.lastIndexOf(\"/\")==a[y]-1&&(a=a.substr(0,a[y]-1));0!=a[t](\"/\")&&(a=\"/\"+a);return a},jc=function(a){a=kc(a);return\"/\"==a?1:a[A](\"/\")[y]};function Xc(a,b,c){\"none\"==b&&(b=\"\");var d=[],e=ya(a);a=\"__utma\"==a?6:2;for(var g=0;g<e[y];g++){var ca=(\"\"+e[g])[A](\".\");ca[y]>=a&&d[p]({hash:ca[0],R:e[g],O:ca})}return 0==d[y]?void 0:1==d[y]?d[0]:Zc(b,d)||Zc(c,d)||Zc(null,d)||d[0]}function Zc(a,b){var c,d;null==a?c=d=1:(c=La(a),d=La(0==a[t](\".\")?a[F](1):\".\"+a));for(var e=0;e<b[y];e++)if(b[e][h]==c||b[e][h]==d)return b[e]};var od=ea(/^https?:\\/\\/([^\\/:]+)/),pd=/(.*)([?&#])(?:_ga=[^&]*)(?:&?)(.*)/;function Bc(a){a=a.get(Q);var b=Ic(a,0);return\"_ga=1.\"+sa(b+\".\"+a)}function Ic(a,b){for(var c=new Date,d=O.screen||{},e=O[oa],g=e.plugins||[],c=[a,e.userAgent,d.width,d.height,c.getTimezoneOffset(),c.getYear(),c.getDate(),c.getHours(),c.getMinutes()+b],d=0;d<g[y];++d)c[p](g[d].description);return La(c[H](\".\"))}var Dc=function(a){this.target=a;this.T=!1};\nDc[z].Q=function(a,b){if(a.tagName){if(\"a\"==a.tagName[I]()){a[Ab]&&Pc(a,qd(this,a[Ab],b));return}if(\"form\"==a.tagName[I]())return rd(this,a)}if(\"string\"==typeof a)return qd(this,a,b)};\nvar qd=function(a,b,c){var d=pd.exec(b);d&&3<=d[y]&&(b=d[1]+(d[3]?d[2]+d[3]:\"\"));a=a[jd].get(\"linkerParam\");var e=b[t](\"?\"),d=b[t](\"#\");c?b+=(-1==d?\"#\":\"&\")+a:(c=-1==e?\"?\":\"&\",b=-1==d?b+(c+a):b[F](0,d)+c+a+b[F](d));return b},rd=function(a,b){if(b&&b[kd]){var c=a[jd].get(\"linkerParam\")[A](\"=\")[1];if(\"get\"==b.method[I]()){for(var d=b.childNodes||[],e=0;e<d[y];e++)if(\"_ga\"==d[e][v]){d[e][id](\"value\",c);return}d=M[u](\"input\");d[id](\"type\",\"hidden\");d[id](\"name\",\"_ga\");d[id](\"value\",c);b.appendChild(d)}else\"post\"==\nb.method[I]()&&(b.action=qd(a,b[kd]))}};\nDc[z].S=function(a,b,c){function d(c){try{c=c||O.event;var d;t:{var g=c[jd]||c.srcElement;for(c=100;g&&0<c;){if(g[Ab]&&g.nodeName[m](/^a(?:rea)?$/i)){d=g;break t}g=g[Ub];c--}d={}}(\"http:\"==d[E]||\"https:\"==d[E])&&sd(a,d[ma]||\"\")&&d[Ab]&&Pc(d,qd(e,d[Ab],b))}catch(w){J(26)}}var e=this;this.T||(this.T=!0,ta(M,\"mousedown\",d,!1),ta(M,\"touchstart\",d,!1),ta(M,\"keyup\",d,!1));if(c){c=function(c){c=c||O.event;if((c=c[jd]||c.srcElement)&&c[kd]){var b=c[kd][m](od);b&&sd(a,b[1])&&rd(e,c)}};for(var g=0;g<M.forms[y];g++)ta(M.forms[g],\n\"submit\",c)}};function sd(a,b){if(b==M[B][ma])return!1;for(var c=0;c<a[y];c++)if(0<=b[t](a[c]))return!0;return!1};var gd=function(a){return a.get(V)&&\"t0\"!=a.get(V)?\"_dc_\"+ka(a.get(V)):\"_dc\"},hd=function(a){if(a.get(ed)){var b=new N,c=function(c){b.set($a(c).p,a.get(c))};c(hb);c(ib);c(Na);c(Q);c(ed);var d=R(a,\"forceSSL\")||\"https:\"==M[B][E]?\"https:\":\"http:\",d=d+\"//stats.g.doubleclick.net/collect?t=dc&aip=1&\";b.map(function(a,c){d+=sa(a)+\"=\"+sa(\"\"+c)+\"&\"});d+=\"z=\"+ra();Ca(d);a.set(ed,\"\",!0)}},fd=function(a){J(29);a=a.b;var b=a.get(Wb);a.set(Wb,function(a){a.get(ed)||(-1!=M[r][t](gd(a)+\"=1\")?a.set(ed,\"\",!0):(gd(a),\nzc(gd(a),\"1\",a.get(Yb),a.get(W),a.get(Na),6E5)?a.set(ed,\"\"+ra(),!0):J(30)));return b(a)});var c=a.get(Xb);a.set(Xb,function(a){var b=c(a);hd(a);return b})};function $c(){var a=O.gaGlobal=O.gaGlobal||{};return a.hid=a.hid||ra()};var ad,bd=function(a,b,c){if(!ad){var d;d=M[B][h];var e=O[v],g=/^#?gaso=([^&]*)/;if(e=(d=(d=d&&d[m](g)||e&&e[m](g))?d[1]:ya(\"GASO\")[0]||\"\")&&d[m](/^(?:!([-0-9a-z.]{1,40})!)?([-.\\w]{10,1200})$/i))zc(\"GASO\",\"\"+d,c,b,a,0),f._udo||(f._udo=b),f._utcp||(f._utcp=c),a=e[1],vc(\"https://www.google.com/analytics/web/inpage/pub/inpage.js?\"+(a?\"prefix=\"+a+\"&\":\"\")+ra(),\"_gasojs\");ad=!0}};var pc=function(a){function b(a,c){d.b[q].set(a,c)}function c(a,c){b(a,c);d.filters.add(a)}var d=this;this.b=new Ya;this.filters=new Ha;b(V,a[V]);b(Na,a[Na]);b(U,a[U]);b(W,a[W]||eb());b(Yb,a[Yb]);b(Zb,a[Zb]);b($b,a[$b]);b(Wc,a[Wc]);b(bc,a[bc]);b(cc,a[cc]);b(Ka,a[Ka]);b(dc,a[dc]);b(ec,a[ec]);b(ac,a[ac]);b(hb,1);b(ib,\"j15\");c(Qb,Ma);c(dd,cd);c(Rb,Oa);c(Sb,nc);c(Uc,Yc);c(Tb,Ja);c(Vb,Ta);c(Vc,Hc);c(Wb,Pa);c(Xb,Sa);Jc(this.b,a[Q]);Kc(this.b);this.b.set(jb,$c());bd(this.b.get(Na),this.b.get(W),this.b.get(Yb))},\nJc=function(a,b){if(\"cookie\"==P(a,ac)){hc=!1;var c;i:{var d=ya(P(a,U));if(d&&!(1>d[y])){c=[];for(var e=0;e<d[y];e++){var g;g=d[e][A](\".\");var ca=g.shift();(\"GA1\"==ca||\"1\"==ca)&&1<g[y]?(ca=g.shift()[A](\"-\"),1==ca[y]&&(ca[1]=\"1\"),ca[0]*=1,ca[1]*=1,g={r:ca,s:g[H](\".\")}):g=void 0;g&&c[p](g)}if(1==c[y]){J(13);c=c[0].s;break i}if(0==c[y])J(12);else{J(14);d=ic(P(a,W));c=Gc(c,d,0);if(1==c[y]){c=c[0].s;break i}d=jc(P(a,Yb));c=Gc(c,d,1);c=c[0]&&c[0].s;break i}}c=void 0}c||(c=P(a,W),d=P(a,$b)||eb(),c=Xc(\"__utma\",\nd,c),(c=void 0==c?void 0:c.O[1]+\".\"+c.O[2])&&J(10));c&&(a[q].set(Q,c),hc=!0)}c=a.get(cc);if(e=(c=M[B][c?\"href\":\"search\"][m](\"(?:&|#|\\\\?)\"+sa(\"_ga\")[Qc](/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g,\"\\\\$1\")+\"=([^&#]*)\"))&&2==c[y]?c[1]:\"\")a.get(bc)?(c=e[t](\".\"),-1==c?J(22):(d=e[F](c+1),\"1\"!=e[F](0,c)?J(22):(c=d[t](\".\"),-1==c?J(22):(e=d[F](0,c),c=d[F](c+1),e!=Ic(c,0)&&e!=Ic(c,-1)&&e!=Ic(c,-2)?J(23):(J(11),a[q].set(Q,c)))))):J(21);b&&(J(9),a[q].set(Q,sa(b)));if(!a.get(Q))if(c=(c=O.gaGlobal&&O.gaGlobal.vid)&&-1!=c[ga](/^(?:utma\\.)?\\d+\\.\\d+$/)?\nc:void 0)J(17),a[q].set(Q,c);else{J(8);c=O[oa];c=c.appName+c.version+c.platform+c.userAgent+(M[r]?M[r]:\"\")+(M.referrer?M.referrer:\"\");d=c[y];for(e=O.history[y];0<e;)c+=e--^d++;a[q].set(Q,[ra()^La(c)&2147483647,n.round((new Date)[da]()/1E3)][H](\".\"))}mc(a)},Kc=function(a){var b=O[oa],c=O.screen,d=M[B];a.set(lb,va(a.get(ec)));if(d){var e=d.pathname||\"\";\"/\"!=e.charAt(0)&&(J(31),e=\"/\"+e);a.set(kb,d[E]+\"//\"+d[ma]+e+d[ga])}c&&a.set(qb,c.width+\"x\"+c.height);c&&a.set(pb,c.colorDepth+\"-bit\");var c=M.documentElement,\ng=(e=M.body)&&e[la]&&e[na],ca=[];c&&c[la]&&c[na]&&(\"CSS1Compat\"===M.compatMode||!g)?ca=[c[la],c[na]]:g&&(ca=[e[la],e[na]]);c=0>=ca[0]||0>=ca[1]?\"\":ca[H](\"x\");a.set(rb,c);a.set(tb,fc());a.set(ob,M.characterSet||M.charset);a.set(sb,b&&\"function\"===typeof b.javaEnabled&&b.javaEnabled()||!1);a.set(nb,(b&&(b.language||b.browserLanguage)||\"\")[I]());if(d&&a.get(cc)&&(b=M[B][h])){b=b[F](1);b=b[A](\"&\");d=[];for(c=0;c<b[y];++c)0!=b[c][t](\"utm_id\")&&0!=b[c][t](\"utm_campaign\")&&0!=b[c][t](\"utm_source\")&&0!=b[c][t](\"utm_medium\")&&\n0!=b[c][t](\"utm_term\")&&0!=b[c][t](\"utm_content\")||d[p](b[c]);0<d[y]&&(b=\"#\"+d[H](\"&\"),a.set(kb,a.get(kb)+b))}};pc[z].get=function(a){return this.b.get(a)};pc[z].set=function(a,b){this.b.set(a,b)};var qc={pageview:[mb],event:[ub,xb,yb,zb],social:[Bb,Cb,Db],timing:[Mb,Nb,Pb,Ob]};\npc[z].send=function(a){if(!(1>arguments[y])){var b,c;\"string\"===typeof arguments[0]?(b=arguments[0],c=[][ha][C](arguments,1)):(b=arguments[0]&&arguments[0][Va],c=arguments);b&&(c=wa(qc[b]||[],c),c[Va]=b,this.b.set(c,void 0,!0),this.filters.execute(this.b),\"pageview\"==b&&Lc(this),this.b[q].m={})}};var Lc=function(a){a.I||(a.I=!0,gc(a.b,function(b){a.send(\"timing\",b)}))};var rc=function(a){if(\"prerender\"==M.webkitVisibilityState)return!1;a();return!0},Mc=function(a){if(!rc(a)){J(16);var b=!1,c=function(){!b&&rc(a)&&(b=!0,ua(M,\"webkitvisibilitychange\",c))};ta(M,\"webkitvisibilitychange\",c)}};var Z={F:\"/plugins/ua/\",D:/^(?:(\\w+)\\.)?(?:(\\w+):)?(\\w+)$/};Z.k=new N;Z.f=[];\nvar sc=function(a){if(K(a[0]))this.u=a[0];else{var b=Z.D.exec(a[0]);null!=b&&4==b[y]&&(this.c=b[1]||\"t0\",this.e=b[2]||\"\",this.d=b[3],this.a=[][ha][C](a,1),this.e||(this.A=\"create\"==this.d,this.i=\"require\"==this.d,this.g=\"provide\"==this.d));if(!K(a[0])){b=a[1];a=a[2];if(!this.d)throw\"abort\";if(this.i&&(!qa(b)||\"\"==b))throw\"abort\";if(this.g&&(!qa(b)||\"\"==b||!K(a)))throw\"abort\";if(0<=this.c[t](\".\")||0<=this.c[t](\":\")||0<=this.e[t](\".\")||0<=this.e[t](\":\"))throw\"abort\";if(this.g&&\"t0\"!=this.c)throw\"abort\";\n}}};Z.B=function(a,b,c){var d=Z.k.get(a);if(!K(d))return!1;b.plugins_=b.plugins_||new N;b.plugins_.set(a,new d(b,c||{}));return!0};Z.C=function(a,b){Z.k.set(a,b)};Z.execute=function(a){var b=Z.J[G](Z,arguments),b=Z.f.concat(b);for(Z.f=[];0<b[y]&&!Z.v(b[0])&&!(b.shift(),0<Z.f[y]););Z.f=Z.f.concat(b)};\nZ.J=function(a){for(var b=[],c=0;c<arguments[y];c++)try{var d=new sc(arguments[c]);if(d.g)Z.v(d);else{if(d.i){var e=d.a[1];if(!K(Z.k.get(d.a[0]))&&!d.H&&e){var g=e+\"\",e=g&&0<=g[t](\"/\")?g:\"//www.google-analytics.com\"+Z.F+g;var ca=tc(\"\"+e),l;var k=ca[E],w=M[B][E];l=\"https:\"==k||k==w?!0:\"http:\"!=k?!1:\"http:\"==w;var s;if(s=l){var g=ca,D=tc(M[B][Ab]);if(g.G||0<=g.url[t](\"?\")||0<=g.path[t](\"://\"))s=!1;else if(g[x]==D[x]&&g[ja]==D[ja])s=!0;else{var vb=\"http:\"==g[E]?80:443;s=\"www.google-analytics.com\"==g[x]&&\n(g[ja]||vb)==vb&&0==g.path[t](\"/plugins/\")?!0:!1}}s&&(d.H=!!vc(ca.url))}}b[p](d)}}catch(wb){}return b};Z.v=function(a){try{if(a.u)a.u[C](O,$.j(\"t0\"));else if(a.g)Z.C(a.a[0],a.a[1]);else{var b=a.c==gb?$:$.j(a.c);if(a.A)\"t0\"==a.c&&$.create[G]($,a.a);else if(b)if(a.i){if(!Z.B(a.a[0],b,a.a[2]))return!0}else a.e&&(b=b.plugins_.get(a.e)),b[a.d][G](b,a.a)}}catch(c){}};\nfunction tc(a){function b(a){var c=(a[ma]||\"\")[A](\":\")[0][I](),b=(a[E]||\"\")[I](),b=1*a[ja]||(\"http:\"==b?80:\"https:\"==b?443:\"\");a=a.pathname||\"\";0==a[t](\"/\")||(a=\"/\"+a);return[c,\"\"+b,a]}var c=M[u](\"a\");Pc(c,M[B][Ab]);var d=(c[E]||\"\")[I](),e=b(c),g=c[ga]||\"\",ca=d+\"//\"+e[0]+(e[1]?\":\"+e[1]:\"\");0==a[t](\"//\")?a=d+a:0==a[t](\"/\")?a=ca+a:a&&0!=a[t](\"?\")?0>a[A](\"/\")[0][t](\":\")&&(a=ca+e[2][F](0,e[2].lastIndexOf(\"/\"))+\"/\"+a):a=ca+e[2]+(a||g);Pc(c,a);d=b(c);return{protocol:(c[E]||\"\")[I](),host:d[0],port:d[1],\npath:d[2],G:c[ga]||\"\",url:a||\"\"}};var $=function(a){J(1);Z.execute[G](Z,[arguments])};$.h={};$.P=[];$.L=0;$.answer=42;var uc=[Na,W,V];$.create=function(a){var b=wa(uc,[][ha][C](arguments));b[V]||(b[V]=\"t0\");var c=\"\"+b[V];if($.h[c])return $.h[c];b=new pc(b);$.h[c]=b;$.P[p](b);return b};$.j=function(a){return $.h[a]};$.K=function(){return $.P[ha](0)};$.N=function(){var a=O[gb];if(!a||42!=a.answer){$.L=a&&a.l;$.loaded=!0;O[gb]=$;Cc();var b=a&&a.q;\"[object Array]\"==Object[z].toString[C](Object(b))&&Mc(function(){Z.execute[G]($,b)})}};\n$.N();function La(a){var b=1,c=0,d;if(a)for(b=0,d=a[y]-1;0<=d;d--)c=a.charCodeAt(d),b=(b<<6&268435455)+c+(c<<14),c=b&266338304,b=0!=c?b^c>>21:b;return b};})(window);\n"
      },
      "https://ssl.google-analytics.com/ga.js": {
         "pageUrl": "https://zapier.com",
         "scriptUrl": "https://ssl.google-analytics.com/ga.js",
         "body": "(function(){var aa=encodeURIComponent,ba=Infinity,ca=setTimeout,da=isNaN,m=Math,ea=decodeURIComponent;function ha(a,b){return a.name=b}\nvar n=\"push\",ia=\"test\",ja=\"slice\",p=\"replace\",ka=\"load\",la=\"floor\",ma=\"charAt\",na=\"value\",q=\"indexOf\",oa=\"match\",pa=\"port\",qa=\"createElement\",ra=\"path\",r=\"name\",g=\"getTime\",u=\"host\",v=\"toString\",w=\"length\",x=\"prototype\",sa=\"clientWidth\",y=\"split\",ta=\"stopPropagation\",ua=\"scope\",z=\"location\",va=\"search\",A=\"protocol\",wa=\"clientHeight\",xa=\"href\",B=\"substring\",ya=\"apply\",za=\"navigator\",C=\"join\",D=\"toLowerCase\",E;function Aa(a,b){switch(b){case 0:return\"\"+a;case 1:return 1*a;case 2:return!!a;case 3:return 1E3*a}return a}function Ba(a){return\"function\"==typeof a}function Ca(a){return void 0!=a&&-1<(a.constructor+\"\")[q](\"String\")}function F(a,b){return void 0==a||\"-\"==a&&!b||\"\"==a}function Da(a){if(!a||\"\"==a)return\"\";for(;a&&-1<\" \\n\\r\\t\"[q](a[ma](0));)a=a[B](1);for(;a&&-1<\" \\n\\r\\t\"[q](a[ma](a[w]-1));)a=a[B](0,a[w]-1);return a}function Ea(){return m.round(2147483647*m.random())}function Fa(){}\nfunction G(a,b){if(aa instanceof Function)return b?encodeURI(a):aa(a);H(68);return escape(a)}function I(a){a=a[y](\"+\")[C](\" \");if(ea instanceof Function)try{return ea(a)}catch(b){H(17)}else H(68);return unescape(a)}var Ga=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,!!d):a.attachEvent&&a.attachEvent(\"on\"+b,c)},Ha=function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,!!d):a.detachEvent&&a.detachEvent(\"on\"+b,c)};\nfunction Ia(a,b){if(a){var c=J[qa](\"script\");c.type=\"text/javascript\";c.async=!0;c.src=a;c.id=b;var d=J.getElementsByTagName(\"script\")[0];d.parentNode.insertBefore(c,d);return c}}function K(a){return a&&0<a[w]?a[0]:\"\"}function L(a){var b=a?a[w]:0;return 0<b?a[b-1]:\"\"}var Ja=function(){this.prefix=\"ga.\";this.R={}};Ja[x].set=function(a,b){this.R[this.prefix+a]=b};Ja[x].get=function(a){return this.R[this.prefix+a]};Ja[x].contains=function(a){return void 0!==this.get(a)};function Ka(a){0==a[q](\"www.\")&&(a=a[B](4));return a[D]()}function La(a,b){var c,d={url:a,protocol:\"http\",host:\"\",path:\"\",d:new Ja,anchor:\"\"};if(!a)return d;c=a[q](\"://\");0<=c&&(d.protocol=a[B](0,c),a=a[B](c+3));c=a[va](\"/|\\\\?|#\");if(0<=c)d.host=a[B](0,c)[D](),a=a[B](c);else return d.host=a[D](),d;c=a[q](\"#\");0<=c&&(d.anchor=a[B](c+1),a=a[B](0,c));c=a[q](\"?\");0<=c&&(Na(d.d,a[B](c+1)),a=a[B](0,c));d.anchor&&b&&Na(d.d,d.anchor);a&&\"/\"==a[ma](0)&&(a=a[B](1));d.path=a;return d}\nfunction Oa(a,b){function c(a){var b=(a.hostname||\"\")[y](\":\")[0][D](),c=(a[A]||\"\")[D](),c=1*a[pa]||(\"http:\"==c?80:\"https:\"==c?443:\"\");a=a.pathname||\"\";0==a[q](\"/\")||(a=\"/\"+a);return[b,\"\"+c,a]}var d=b||J[qa](\"a\");d.href=J[z][xa];var e=(d[A]||\"\")[D](),f=c(d),Be=d[va]||\"\",k=e+\"//\"+f[0]+(f[1]?\":\"+f[1]:\"\");0==a[q](\"//\")?a=e+a:0==a[q](\"/\")?a=k+a:a&&0!=a[q](\"?\")?0>a[y](\"/\")[0][q](\":\")&&(a=k+f[2][B](0,f[2].lastIndexOf(\"/\"))+\"/\"+a):a=k+f[2]+(a||Be);d.href=a;e=c(d);return{protocol:(d[A]||\"\")[D](),host:e[0],\nport:e[1],path:e[2],Oa:d[va]||\"\",url:a||\"\"}}function Na(a,b){function c(b,c){a.contains(b)||a.set(b,[]);a.get(b)[n](c)}for(var d=Da(b)[y](\"&\"),e=0;e<d[w];e++)if(d[e]){var f=d[e][q](\"=\");0>f?c(d[e],\"1\"):c(d[e][B](0,f),d[e][B](f+1))}}function Pa(a,b){if(F(a)||\"[\"==a[ma](0)&&\"]\"==a[ma](a[w]-1))return\"-\";var c=J.domain;return a[q](c+(b&&\"/\"!=b?b:\"\"))==(0==a[q](\"http://\")?7:0==a[q](\"https://\")?8:0)?\"0\":a};var Qa=0;function Ra(a,b,c){1<=Qa||1<=100*m.random()||ld()||(a=[\"utmt=error\",\"utmerr=\"+a,\"utmwv=5.4.6\",\"utmn=\"+Ea(),\"utmsp=1\"],b&&a[n](\"api=\"+b),c&&a[n](\"msg=\"+G(c[B](0,100))),M.w&&a[n](\"aip=1\"),Sa(a[C](\"&\")),Qa++)};var Ta=0,Ua={};function N(a){return Va(\"x\"+Ta++,a)}function Va(a,b){Ua[a]=!!b;return a}\nvar Wa=N(),Xa=Va(\"anonymizeIp\"),Ya=N(),$a=N(),ab=N(),bb=N(),O=N(),P=N(),cb=N(),db=N(),eb=N(),fb=N(),gb=N(),hb=N(),ib=N(),jb=N(),kb=N(),lb=N(),nb=N(),ob=N(),pb=N(),qb=N(),rb=N(),sb=N(),tb=N(),ub=N(),vb=N(),wb=N(),xb=N(),yb=N(),zb=N(),Ab=N(),Bb=N(),Cb=N(),Db=N(),Eb=N(),Fb=N(!0),Gb=Va(\"currencyCode\"),Hb=Va(\"page\"),Ib=Va(\"title\"),Jb=N(),Kb=N(),Lb=N(),Mb=N(),Nb=N(),Ob=N(),Pb=N(),Qb=N(),Rb=N(),Q=N(!0),Sb=N(!0),Tb=N(!0),Ub=N(!0),Vb=N(!0),Wb=N(!0),Zb=N(!0),$b=N(!0),ac=N(!0),bc=N(!0),cc=N(!0),R=N(!0),dc=N(!0),\nec=N(!0),fc=N(!0),gc=N(!0),hc=N(!0),ic=N(!0),jc=N(!0),S=N(!0),kc=N(!0),lc=N(!0),mc=N(!0),nc=N(!0),oc=N(!0),pc=N(!0),qc=N(!0),rc=Va(\"campaignParams\"),sc=N(),tc=Va(\"hitCallback\"),uc=N();N();var vc=N(),wc=N(),xc=N(),yc=N(),zc=N(),Ac=N(),Bc=N(),Cc=N(),Dc=N(),Ec=N(),Fc=N(),Gc=N(),Hc=N(),Ic=N();N();var Mc=N(),Nc=N(),Oc=N(),Oe=Va(\"uaName\"),Pe=Va(\"uaDomain\"),Qe=Va(\"uaPath\");var Re=function(){function a(a,c,d){T($[x],a,c,d)}a(\"_createTracker\",$[x].r,55);a(\"_getTracker\",$[x].oa,0);a(\"_getTrackerByName\",$[x].u,51);a(\"_getTrackers\",$[x].pa,130);a(\"_anonymizeIp\",$[x].aa,16);a(\"_forceSSL\",$[x].la,125);a(\"_getPlugin\",Pc,120)},Se=function(){function a(a,c,d){T(U[x],a,c,d)}Qc(\"_getName\",$a,58);Qc(\"_getAccount\",Wa,64);Qc(\"_visitCode\",Q,54);Qc(\"_getClientInfo\",ib,53,1);Qc(\"_getDetectTitle\",lb,56,1);Qc(\"_getDetectFlash\",jb,65,1);Qc(\"_getLocalGifPath\",wb,57);Qc(\"_getServiceMode\",\nxb,59);V(\"_setClientInfo\",ib,66,2);V(\"_setAccount\",Wa,3);V(\"_setNamespace\",Ya,48);V(\"_setAllowLinker\",fb,11,2);V(\"_setDetectFlash\",jb,61,2);V(\"_setDetectTitle\",lb,62,2);V(\"_setLocalGifPath\",wb,46,0);V(\"_setLocalServerMode\",xb,92,void 0,0);V(\"_setRemoteServerMode\",xb,63,void 0,1);V(\"_setLocalRemoteServerMode\",xb,47,void 0,2);V(\"_setSampleRate\",vb,45,1);V(\"_setCampaignTrack\",kb,36,2);V(\"_setAllowAnchor\",gb,7,2);V(\"_setCampNameKey\",ob,41);V(\"_setCampContentKey\",tb,38);V(\"_setCampIdKey\",nb,39);V(\"_setCampMediumKey\",\nrb,40);V(\"_setCampNOKey\",ub,42);V(\"_setCampSourceKey\",qb,43);V(\"_setCampTermKey\",sb,44);V(\"_setCampCIdKey\",pb,37);V(\"_setCookiePath\",P,9,0);V(\"_setMaxCustomVariables\",yb,0,1);V(\"_setVisitorCookieTimeout\",cb,28,1);V(\"_setSessionCookieTimeout\",db,26,1);V(\"_setCampaignCookieTimeout\",eb,29,1);V(\"_setReferrerOverride\",Jb,49);V(\"_setSiteSpeedSampleRate\",Dc,132);a(\"_trackPageview\",U[x].Fa,1);a(\"_trackEvent\",U[x].F,4);a(\"_trackPageLoadTime\",U[x].Ea,100);a(\"_trackSocial\",U[x].Ga,104);a(\"_trackTrans\",U[x].Ia,\n18);a(\"_sendXEvent\",U[x].t,78);a(\"_createEventTracker\",U[x].ia,74);a(\"_getVersion\",U[x].qa,60);a(\"_setDomainName\",U[x].B,6);a(\"_setAllowHash\",U[x].va,8);a(\"_getLinkerUrl\",U[x].na,52);a(\"_link\",U[x].link,101);a(\"_linkByPost\",U[x].ua,102);a(\"_setTrans\",U[x].za,20);a(\"_addTrans\",U[x].$,21);a(\"_addItem\",U[x].Y,19);a(\"_clearTrans\",U[x].ea,105);a(\"_setTransactionDelim\",U[x].Aa,82);a(\"_setCustomVar\",U[x].wa,10);a(\"_deleteCustomVar\",U[x].ka,35);a(\"_getVisitorCustomVar\",U[x].ra,50);a(\"_setXKey\",U[x].Ca,83);\na(\"_setXValue\",U[x].Da,84);a(\"_getXKey\",U[x].sa,76);a(\"_getXValue\",U[x].ta,77);a(\"_clearXKey\",U[x].fa,72);a(\"_clearXValue\",U[x].ga,73);a(\"_createXObj\",U[x].ja,75);a(\"_addIgnoredOrganic\",U[x].W,15);a(\"_clearIgnoredOrganic\",U[x].ba,97);a(\"_addIgnoredRef\",U[x].X,31);a(\"_clearIgnoredRef\",U[x].ca,32);a(\"_addOrganic\",U[x].Z,14);a(\"_clearOrganic\",U[x].da,70);a(\"_cookiePathCopy\",U[x].ha,30);a(\"_get\",U[x].ma,106);a(\"_set\",U[x].xa,107);a(\"_addEventListener\",U[x].addEventListener,108);a(\"_removeEventListener\",\nU[x].removeEventListener,109);a(\"_addDevId\",U[x].V);a(\"_getPlugin\",Pc,122);a(\"_setPageGroup\",U[x].ya,126);a(\"_trackTiming\",U[x].Ha,124);a(\"_initData\",U[x].v,2);a(\"_setVar\",U[x].Ba,22);V(\"_setSessionTimeout\",db,27,3);V(\"_setCookieTimeout\",eb,25,3);V(\"_setCookiePersistence\",cb,24,1);a(\"_setAutoTrackOutbound\",Fa,79);a(\"_setTrackOutboundSubdomains\",Fa,81);a(\"_setHrefExamineLimit\",Fa,80)};function Pc(a){var b=this.plugins_;if(b)return b.get(a)}\nvar T=function(a,b,c,d){a[b]=function(){try{return void 0!=d&&H(d),c[ya](this,arguments)}catch(a){throw Ra(\"exc\",b,a&&a[r]),a;}}},Qc=function(a,b,c,d){U[x][a]=function(){try{return H(c),Aa(this.a.get(b),d)}catch(e){throw Ra(\"exc\",a,e&&e[r]),e;}}},V=function(a,b,c,d,e){U[x][a]=function(f){try{H(c),void 0==e?this.a.set(b,Aa(f,d)):this.a.set(b,e)}catch(Be){throw Ra(\"exc\",a,Be&&Be[r]),Be;}}},Te=function(a,b){return{type:b,target:a,stopPropagation:function(){throw\"aborted\";}}};var Rc=RegExp(/(^|\\.)doubleclick\\.net$/i),Sc=function(a,b){return Rc[ia](J[z].hostname)?!0:\"/\"!==b?!1:0!=a[q](\"www.google.\")&&0!=a[q](\".google.\")&&0!=a[q](\"google.\")||-1<a[q](\"google.org\")?!1:!0},Tc=function(a){var b=a.get(bb),c=a.c(P,\"/\");Sc(b,c)&&a[ta]()};var Zc=function(){var a={},b={},c=new Uc;this.g=function(a,b){c.add(a,b)};var d=new Uc;this.e=function(a,b){d.add(a,b)};var e=!1,f=!1,Be=!0;this.T=function(){e=!0};this.j=function(a){this[ka]();this.set(sc,a,!0);a=new Vc(this);e=!1;d.execute(this);e=!0;b={};this.n();a.Ja()};this.load=function(){e&&(e=!1,this.Ka(),Wc(this),f||(f=!0,c.execute(this),Xc(this),Wc(this)),e=!0)};this.n=function(){if(e)if(f)e=!1,Xc(this),e=!0;else this[ka]()};this.get=function(c){Ua[c]&&this[ka]();return void 0!==b[c]?b[c]:\na[c]};this.set=function(c,d,e){Ua[c]&&this[ka]();e?b[c]=d:a[c]=d;Ua[c]&&this.n()};this.Za=function(b){a[b]=this.b(b,0)+1};this.b=function(a,b){var c=this.get(a);return void 0==c||\"\"===c?b:1*c};this.c=function(a,b){var c=this.get(a);return void 0==c?b:c+\"\"};this.Ka=function(){if(Be){var b=this.c(bb,\"\"),c=this.c(P,\"/\");Sc(b,c)||(a[O]=a[hb]&&\"\"!=b?Yc(b):1,Be=!1)}}};Zc[x].stopPropagation=function(){throw\"aborted\";};\nvar Vc=function(a){var b=this;this.q=0;var c=a.get(tc);this.Ua=function(){0<b.q&&c&&(b.q--,b.q||c())};this.Ja=function(){!b.q&&c&&ca(c,10)};a.set(uc,b,!0)};function $c(a,b){b=b||[];for(var c=0;c<b[w];c++){var d=b[c];if(\"\"+a==d||0==d[q](a+\".\"))return d}return\"-\"}\nvar bd=function(a,b,c){c=c?\"\":a.c(O,\"1\");b=b[y](\".\");if(6!==b[w]||ad(b[0],c))return!1;c=1*b[1];var d=1*b[2],e=1*b[3],f=1*b[4];b=1*b[5];if(!(0<=c&&0<d&&0<e&&0<f&&0<=b))return!1;a.set(Q,c);a.set(Vb,d);a.set(Wb,e);a.set(Zb,f);a.set($b,b);return!0},cd=function(a){var b=a.get(Q),c=a.get(Vb),d=a.get(Wb),e=a.get(Zb),f=a.b($b,1);return[a.b(O,1),void 0!=b?b:\"-\",c||\"-\",d||\"-\",e||\"-\",f][C](\".\")},dd=function(a){return[a.b(O,1),a.b(cc,0),a.b(R,1),a.b(dc,0)][C](\".\")},ed=function(a,b,c){c=c?\"\":a.c(O,\"1\");var d=\nb[y](\".\");if(4!==d[w]||ad(d[0],c))d=null;a.set(cc,d?1*d[1]:0);a.set(R,d?1*d[2]:10);a.set(dc,d?1*d[3]:a.get(ab));return null!=d||!ad(b,c)},fd=function(a,b){var c=G(a.c(Tb,\"\")),d=[],e=a.get(Fb);if(!b&&e){for(var f=0;f<e[w];f++){var Be=e[f];Be&&1==Be[ua]&&d[n](f+\"=\"+G(Be[r])+\"=\"+G(Be[na])+\"=1\")}0<d[w]&&(c+=\"|\"+d[C](\"^\"))}return c?a.b(O,1)+\".\"+c:null},gd=function(a,b,c){c=c?\"\":a.c(O,\"1\");b=b[y](\".\");if(2>b[w]||ad(b[0],c))return!1;b=b[ja](1)[C](\".\")[y](\"|\");0<b[w]&&a.set(Tb,I(b[0]));if(1>=b[w])return!0;\nb=b[1][y](-1==b[1][q](\",\")?\"^\":\",\");for(c=0;c<b[w];c++){var d=b[c][y](\"=\");if(4==d[w]){var e={};ha(e,I(d[1]));e.value=I(d[2]);e.scope=1;a.get(Fb)[d[0]]=e}}return!0},hd=function(a,b){var c=Ue(a,b);return c?[a.b(O,1),a.b(ec,0),a.b(fc,1),a.b(gc,1),c][C](\".\"):\"\"},Ue=function(a){function b(b,e){if(!F(a.get(b))){var f=a.c(b,\"\"),f=f[y](\" \")[C](\"%20\"),f=f[y](\"+\")[C](\"%20\");c[n](e+\"=\"+f)}}var c=[];b(ic,\"utmcid\");b(nc,\"utmcsr\");b(S,\"utmgclid\");b(kc,\"utmgclsrc\");b(lc,\"utmdclid\");b(mc,\"utmdsid\");b(jc,\"utmccn\");\nb(oc,\"utmcmd\");b(pc,\"utmctr\");b(qc,\"utmcct\");return c[C](\"|\")},id=function(a,b,c){c=c?\"\":a.c(O,\"1\");b=b[y](\".\");if(5>b[w]||ad(b[0],c))return a.set(ec,void 0),a.set(fc,void 0),a.set(gc,void 0),a.set(ic,void 0),a.set(jc,void 0),a.set(nc,void 0),a.set(oc,void 0),a.set(pc,void 0),a.set(qc,void 0),a.set(S,void 0),a.set(kc,void 0),a.set(lc,void 0),a.set(mc,void 0),!1;a.set(ec,1*b[1]);a.set(fc,1*b[2]);a.set(gc,1*b[3]);Ve(a,b[ja](4)[C](\".\"));return!0},Ve=function(a,b){function c(a){return(a=b[oa](a+\"=(.*?)(?:\\\\|utm|$)\"))&&\n2==a[w]?a[1]:void 0}function d(b,c){c?(c=e?I(c):c[y](\"%20\")[C](\" \"),a.set(b,c)):a.set(b,void 0)}-1==b[q](\"=\")&&(b=I(b));var e=\"2\"==c(\"utmcvr\");d(ic,c(\"utmcid\"));d(jc,c(\"utmccn\"));d(nc,c(\"utmcsr\"));d(oc,c(\"utmcmd\"));d(pc,c(\"utmctr\"));d(qc,c(\"utmcct\"));d(S,c(\"utmgclid\"));d(kc,c(\"utmgclsrc\"));d(lc,c(\"utmdclid\"));d(mc,c(\"utmdsid\"))},ad=function(a,b){return b?a!=b:!/^\\d+$/[ia](a)};var Uc=function(){this.filters=[]};Uc[x].add=function(a,b){this.filters[n]({name:a,s:b})};Uc[x].execute=function(a){try{for(var b=0;b<this.filters[w];b++)this.filters[b].s.call(W,a)}catch(c){}};function jd(a){100!=a.get(vb)&&a.get(Q)%1E4>=100*a.get(vb)&&a[ta]()}function kd(a){ld(a.get(Wa))&&a[ta]()}function md(a){\"file:\"==J[z][A]&&a[ta]()}function Ge(a){He()&&a[ta]()}function nd(a){a.get(Ib)||a.set(Ib,J.title,!0);a.get(Hb)||a.set(Hb,J[z].pathname+J[z][va],!0)};var od=new function(){var a=[];this.set=function(b){a[b]=!0};this.Xa=function(){for(var b=[],c=0;c<a[w];c++)a[c]&&(b[m[la](c/6)]=b[m[la](c/6)]^1<<c%6);for(c=0;c<b[w];c++)b[c]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\"[ma](b[c]||0);return b[C](\"\")+\"~\"}};function H(a){od.set(a)};var W=window,J=document,ld=function(a){var b=W._gaUserPrefs;if(b&&b.ioo&&b.ioo()||a&&!0===W[\"ga-disable-\"+a])return!0;try{var c=W.external;if(c&&c._gaUserPrefs&&\"oo\"==c._gaUserPrefs)return!0}catch(d){}return!1},He=function(){return W[za]&&\"preview\"==W[za].loadPurpose},We=function(a,b){ca(a,b)},pd=function(a){var b=[],c=J.cookie[y](\";\");a=RegExp(\"^\\\\s*\"+a+\"=\\\\s*(.*?)\\\\s*$\");for(var d=0;d<c[w];d++){var e=c[d][oa](a);e&&b[n](e[1])}return b},X=function(a,b,c,d,e,f){e=ld(e)?!1:Sc(d,c)?!1:He()?!1:!0;if(e){if(b&&\n0<=W[za].userAgent[q](\"Firefox\")){b=b[p](/\\n|\\r/g,\" \");e=0;for(var Be=b[w];e<Be;++e){var k=b.charCodeAt(e)&255;if(10==k||13==k)b=b[B](0,e)+\"?\"+b[B](e+1)}}b&&2E3<b[w]&&(b=b[B](0,2E3),H(69));a=a+\"=\"+b+\"; path=\"+c+\"; \";f&&(a+=\"expires=\"+(new Date((new Date)[g]()+f)).toGMTString()+\"; \");d&&(a+=\"domain=\"+d+\";\");J.cookie=a}};var qd,rd,sd=function(){if(!qd){var a={},b=W[za],c=W.screen;a.Q=c?c.width+\"x\"+c.height:\"-\";a.P=c?c.colorDepth+\"-bit\":\"-\";a.language=(b&&(b.language||b.browserLanguage)||\"-\")[D]();a.javaEnabled=b&&b.javaEnabled()?1:0;a.characterSet=J.characterSet||J.charset||\"-\";try{var d;var e=J.documentElement,f=J.body,Be=f&&f[sa]&&f[wa],b=[];e&&e[sa]&&e[wa]&&(\"CSS1Compat\"===J.compatMode||!Be)?b=[e[sa],e[wa]]:Be&&(b=[f[sa],f[wa]]);d=0>=b[0]||0>=b[1]?\"\":b[C](\"x\");a.Wa=d}catch(k){H(135)}qd=a}},td=function(){sd();for(var a=\nqd,b=W[za],a=b.appName+b.version+a.language+b.platform+b.userAgent+a.javaEnabled+a.Q+a.P+(J.cookie?J.cookie:\"\")+(J.referrer?J.referrer:\"\"),b=a[w],c=W.history[w];0<c;)a+=c--^b++;return Yc(a)},ud=function(a){sd();var b=qd;a.set(Lb,b.Q);a.set(Mb,b.P);a.set(Pb,b.language);a.set(Qb,b.characterSet);a.set(Nb,b.javaEnabled);a.set(Rb,b.Wa);if(a.get(ib)&&a.get(jb)){if(!(b=rd)){var c,d,e;d=\"ShockwaveFlash\";if((b=(b=W[za])?b.plugins:void 0)&&0<b[w])for(c=0;c<b[w]&&!e;c++)d=b[c],-1<d[r][q](\"Shockwave Flash\")&&\n(e=d.description[y](\"Shockwave Flash \")[1]);else{d=d+\".\"+d;try{c=new ActiveXObject(d+\".7\"),e=c.GetVariable(\"$version\")}catch(f){}if(!e)try{c=new ActiveXObject(d+\".6\"),e=\"WIN 6,0,21,0\",c.AllowScriptAccess=\"always\",e=c.GetVariable(\"$version\")}catch(Be){}if(!e)try{c=new ActiveXObject(d),e=c.GetVariable(\"$version\")}catch(k){}e&&(e=e[y](\" \")[1][y](\",\"),e=e[0]+\".\"+e[1]+\" r\"+e[2])}b=e?e:\"-\"}rd=b;a.set(Ob,rd)}else a.set(Ob,\"-\")};var vd=function(a){if(Ba(a))this.s=a;else{var b=a[0],c=b.lastIndexOf(\":\"),d=b.lastIndexOf(\".\");this.h=this.i=this.l=\"\";-1==c&&-1==d?this.h=b:-1==c&&-1!=d?(this.i=b[B](0,d),this.h=b[B](d+1)):-1!=c&&-1==d?(this.l=b[B](0,c),this.h=b[B](c+1)):c>d?(this.i=b[B](0,d),this.l=b[B](d+1,c),this.h=b[B](c+1)):(this.i=b[B](0,d),this.h=b[B](d+1));this.k=a[ja](1);this.Ma=!this.l&&\"_require\"==this.h;this.J=!this.i&&!this.l&&\"_provide\"==this.h}},Y=function(){T(Y[x],\"push\",Y[x][n],5);T(Y[x],\"_getPlugin\",Pc,121);T(Y[x],\n\"_createAsyncTracker\",Y[x].Sa,33);T(Y[x],\"_getAsyncTracker\",Y[x].Ta,34);this.I=new Ja;this.p=[]};E=Y[x];E.Na=function(a,b,c){var d=this.I.get(a);if(!Ba(d))return!1;b.plugins_=b.plugins_||new Ja;b.plugins_.set(a,new d(b,c||{}));return!0};E.push=function(a){var b=Z.Va[ya](this,arguments),b=Z.p.concat(b);for(Z.p=[];0<b[w]&&!Z.O(b[0])&&!(b.shift(),0<Z.p[w]););Z.p=Z.p.concat(b);return 0};E.Va=function(a){for(var b=[],c=0;c<arguments[w];c++)try{var d=new vd(arguments[c]);d.J?this.O(d):b[n](d)}catch(e){}return b};\nE.O=function(a){try{if(a.s)a.s[ya](W);else if(a.J)this.I.set(a.k[0],a.k[1]);else{var b=\"_gat\"==a.i?M:\"_gaq\"==a.i?Z:M.u(a.i);if(a.Ma){if(!this.Na(a.k[0],b,a.k[2])){if(!a.Pa){var c=Oa(\"\"+a.k[1]);var d=c[A],e=J[z][A];var f;if(f=\"https:\"==d||d==e?!0:\"http:\"!=d?!1:\"http:\"==e){var Be;t:{var k=Oa(J[z][xa]);if(!(c.Oa||0<=c.url[q](\"?\")||0<=c[ra][q](\"://\")||c[u]==k[u]&&c[pa]==k[pa]))for(var s=\"http:\"==c[A]?80:443,t=M.S,b=0;b<t[w];b++)if(c[u]==t[b][0]&&(c[pa]||s)==(t[b][1]||s)&&0==c[ra][q](t[b][2])){Be=!0;break t}Be=\n!1}f=Be&&!ld()}f&&(a.Pa=Ia(c.url))}return!0}}else a.l&&(b=b.plugins_.get(a.l)),b[a.h][ya](b,a.k)}}catch(Za){}};E.Sa=function(a,b){return M.r(a,b||\"\")};E.Ta=function(a){return M.u(a)};var yd=function(){function a(a,b,c,d){void 0==f[a]&&(f[a]={});void 0==f[a][b]&&(f[a][b]=[]);f[a][b][c]=d}function b(a,b,c){if(void 0!=f[a]&&void 0!=f[a][b])return f[a][b][c]}function c(a,b){if(void 0!=f[a]&&void 0!=f[a][b]){f[a][b]=void 0;var c=!0,d;for(d=0;d<Be[w];d++)if(void 0!=f[a][Be[d]]){c=!1;break}c&&(f[a]=void 0)}}function d(a){var b=\"\",c=!1,d,e;for(d=0;d<Be[w];d++)if(e=a[Be[d]],void 0!=e){c&&(b+=Be[d]);for(var c=[],f=void 0,ga=void 0,ga=0;ga<e[w];ga++)if(void 0!=e[ga]){f=\"\";ga!=mb&&void 0==\ne[ga-1]&&(f+=ga[v]()+Za);for(var Cd=e[ga],Jc=\"\",Yb=void 0,Kc=void 0,Lc=void 0,Yb=0;Yb<Cd[w];Yb++)Kc=Cd[ma](Yb),Lc=Ma[Kc],Jc+=void 0!=Lc?Lc:Kc;f+=Jc;c[n](f)}b+=k+c[C](t)+s;c=!1}else c=!0;return b}var e=this,f=[],Be=[\"k\",\"v\"],k=\"(\",s=\")\",t=\"*\",Za=\"!\",Ma={\"'\":\"'0\"};Ma[s]=\"'1\";Ma[t]=\"'2\";Ma[Za]=\"'3\";var mb=1;e.Ra=function(a){return void 0!=f[a]};e.A=function(){for(var a=\"\",b=0;b<f[w];b++)void 0!=f[b]&&(a+=b[v]()+d(f[b]));return a};e.Qa=function(a){if(void 0==a)return e.A();for(var b=a.A(),c=0;c<f[w];c++)void 0==\nf[c]||a.Ra(c)||(b+=c[v]()+d(f[c]));return b};e.f=function(b,c,d){if(!wd(d))return!1;a(b,\"k\",c,d);return!0};e.o=function(b,c,d){if(!xd(d))return!1;a(b,\"v\",c,d[v]());return!0};e.getKey=function(a,c){return b(a,\"k\",c)};e.N=function(a,c){return b(a,\"v\",c)};e.L=function(a){c(a,\"k\")};e.M=function(a){c(a,\"v\")};T(e,\"_setKey\",e.f,89);T(e,\"_setValue\",e.o,90);T(e,\"_getKey\",e.getKey,87);T(e,\"_getValue\",e.N,88);T(e,\"_clearKey\",e.L,85);T(e,\"_clearValue\",e.M,86)};function wd(a){return\"string\"==typeof a}\nfunction xd(a){return!(\"number\"==typeof a||void 0!=Number&&a instanceof Number)||m.round(a)!=a||da(a)||a==ba?!1:!0};var zd=function(a){var b=W.gaGlobal;a&&!b&&(W.gaGlobal=b={});return b},Ad=function(){var a=zd(!0).hid;null==a&&(a=Ea(),zd(!0).hid=a);return a},Dd=function(a){a.set(Kb,Ad());var b=zd();if(b&&b.dh==a.get(O)){var c=b.sid;c&&(a.get(ac)?H(112):H(132),a.set(Zb,c),a.get(Sb)&&a.set(Wb,c));b=b.vid;a.get(Sb)&&b&&(b=b[y](\".\"),a.set(Q,1*b[0]),a.set(Vb,1*b[1]))}};var Ed,Fd=function(a,b,c,d){var e=a.c(bb,\"\"),f=a.c(P,\"/\");d=void 0!=d?d:a.b(cb,0);a=a.c(Wa,\"\");X(b,c,f,e,a,d)},Xc=function(a){var b=a.c(bb,\"\");a.b(O,1);var c=a.c(P,\"/\"),d=a.c(Wa,\"\");X(\"__utma\",cd(a),c,b,d,a.get(cb));X(\"__utmb\",dd(a),c,b,d,a.get(db));X(\"__utmc\",\"\"+a.b(O,1),c,b,d);var e=hd(a,!0);e?X(\"__utmz\",e,c,b,d,a.get(eb)):X(\"__utmz\",\"\",c,b,\"\",-1);(e=fd(a,!1))?X(\"__utmv\",e,c,b,d,a.get(cb)):X(\"__utmv\",\"\",c,b,\"\",-1)},Wc=function(a){var b=a.b(O,1);if(!bd(a,$c(b,pd(\"__utma\"))))return a.set(Ub,!0),!1;\nvar c=!ed(a,$c(b,pd(\"__utmb\")));a.set(bc,c);id(a,$c(b,pd(\"__utmz\")));gd(a,$c(b,pd(\"__utmv\")));Ed=!c;return!0},Gd=function(a){Ed||0<pd(\"__utmb\")[w]||(X(\"__utmd\",\"1\",a.c(P,\"/\"),a.c(bb,\"\"),a.c(Wa,\"\"),1E4),0==pd(\"__utmd\")[w]&&a[ta]())};var h=0,Jd=function(a){void 0==a.get(Q)?Hd(a):a.get(Ub)&&!a.get(Mc)?Hd(a):a.get(bc)&&(Id(a),h++,1<h&&H(137))},Kd=function(a){a.get(hc)&&!a.get(ac)&&(Id(a),a.set(fc,a.get($b)))},Hd=function(a){var b=a.get(ab);a.set(Sb,!0);a.set(Q,Ea()^td(a)&2147483647);a.set(Tb,\"\");a.set(Vb,b);a.set(Wb,b);a.set(Zb,b);a.set($b,1);a.set(ac,!0);a.set(cc,0);a.set(R,10);a.set(dc,b);a.set(Fb,[]);a.set(Ub,!1);a.set(bc,!1)},Id=function(a){a.set(Wb,a.get(Zb));a.set(Zb,a.get(ab));a.Za($b);a.set(ac,!0);a.set(cc,0);a.set(R,10);\na.set(dc,a.get(ab));a.set(bc,!1)};var Ld=\"daum:q eniro:search_word naver:query pchome:q images.google:q google:q yahoo:p yahoo:q msn:q bing:q aol:query aol:q lycos:q lycos:query ask:q netscape:query cnn:query about:terms mamma:q voila:rdata virgilio:qs live:q baidu:wd alice:qs yandex:text najdi:q seznam:q rakuten:qt biglobe:q goo.ne:MT wp:szukaj onet:qt yam:k kvasir:q ozu:q terra:query rambler:query conduit:q babylon:q search-results:q avg:q comcast:q incredimail:q startsiden:q go.mail.ru:q search.centrum.cz:q 360.cn:q\".split(\" \"),\nSd=function(a){if(a.get(kb)&&!a.get(Mc)){for(var b=!F(a.get(ic))||!F(a.get(nc))||!F(a.get(S))||!F(a.get(lc)),c={},d=0;d<Md[w];d++){var e=Md[d];c[e]=a.get(e)}(d=a.get(rc))?(H(149),e=new Ja,Na(e,d),d=e):d=La(J[z][xa],a.get(gb)).d;if(\"1\"!=L(d.get(a.get(ub)))||!b)if(d=Xe(a,d)||Qd(a),d||b||!a.get(ac)||(Pd(a,void 0,\"(direct)\",void 0,void 0,void 0,\"(direct)\",\"(none)\",void 0,void 0),d=!0),d&&(a.set(hc,Rd(a,c)),b=\"(direct)\"==a.get(nc)&&\"(direct)\"==a.get(jc)&&\"(none)\"==a.get(oc),a.get(hc)||a.get(ac)&&!b))a.set(ec,\na.get(ab)),a.set(fc,a.get($b)),a.Za(gc)}},Xe=function(a,b){function c(c,d){d=d||\"-\";var e=L(b.get(a.get(c)));return e&&\"-\"!=e?I(e):d}var d=L(b.get(a.get(nb)))||\"-\",e=L(b.get(a.get(qb)))||\"-\",f=L(b.get(a.get(pb)))||\"-\",Be=L(b.get(\"gclsrc\"))||\"-\",k=L(b.get(\"dclid\"))||\"-\",s=c(ob,\"(not set)\"),t=c(rb,\"(not set)\"),Za=c(sb),Ma=c(tb);if(F(d)&&F(f)&&F(k)&&F(e))return!1;var mb=!F(f)&&!F(Be),mb=F(e)&&(!F(k)||mb),Xb=F(Za);if(mb||Xb){var Bd=Nd(a),Bd=La(Bd,!0);(Bd=Od(a,Bd))&&!F(Bd[1]&&!Bd[2])&&(mb&&(e=Bd[0]),Xb&&\n(Za=Bd[1]))}Pd(a,d,e,f,Be,k,s,t,Za,Ma);return!0},Qd=function(a){var b=Nd(a),c=La(b,!0);if(!(void 0!=b&&null!=b&&\"\"!=b&&\"0\"!=b&&\"-\"!=b&&0<=b[q](\"://\"))||c&&-1<c[u][q](\"google\")&&c.d.contains(\"q\")&&\"cse\"==c[ra])return!1;if((b=Od(a,c))&&!b[2])return Pd(a,void 0,b[0],void 0,void 0,void 0,\"(organic)\",\"organic\",b[1],void 0),!0;if(b||!a.get(ac))return!1;t:{for(var b=a.get(Bb),d=Ka(c[u]),e=0;e<b[w];++e)if(-1<d[q](b[e])){a=!1;break t}Pd(a,void 0,d,void 0,void 0,void 0,\"(referral)\",\"referral\",void 0,\"/\"+c[ra]);\na=!0}return a},Od=function(a,b){for(var c=a.get(zb),d=0;d<c[w];++d){var e=c[d][y](\":\");if(-1<b[u][q](e[0][D]())){var f=b.d.get(e[1]);if(f&&(f=K(f),!f&&-1<b[u][q](\"google.\")&&(f=\"(not provided)\"),!e[3]||-1<b.url[q](e[3]))){t:{for(var c=f,d=a.get(Ab),c=I(c)[D](),Be=0;Be<d[w];++Be)if(c==d[Be]){c=!0;break t}c=!1}return[e[2]||e[0],f,c]}}}return null},Pd=function(a,b,c,d,e,f,Be,k,s,t){a.set(ic,b);a.set(nc,c);a.set(S,d);a.set(kc,e);a.set(lc,f);a.set(jc,Be);a.set(oc,k);a.set(pc,s);a.set(qc,t)},Md=[jc,ic,\nS,lc,nc,oc,pc,qc],Rd=function(a,b){function c(a){a=(\"\"+a)[y](\"+\")[C](\"%20\");return a=a[y](\" \")[C](\"%20\")}function d(c){var d=\"\"+(a.get(c)||\"\");c=\"\"+(b[c]||\"\");return 0<d[w]&&d==c}if(d(S)||d(lc))return H(131),!1;for(var e=0;e<Md[w];e++){var f=Md[e],Be=b[f]||\"-\",f=a.get(f)||\"-\";if(c(Be)!=c(f))return!0}return!1},Td=RegExp(/^https?:\\/\\/(www\\.)?google(\\.com?)?(\\.[a-z]{2}t?)?\\/?$/i),Nd=function(a){a=Pa(a.get(Jb),a.get(P));try{if(Td[ia](a))return H(136),a+\"?q=\"}catch(b){H(145)}return a};var Ud,Vd,Wd=function(a){Ud=a.c(S,\"\");Vd=a.c(kc,\"\")},Xd=function(a){var b=a.c(S,\"\"),c=a.c(kc,\"\");b!=Ud&&(-1<c[q](\"ds\")?a.set(mc,void 0):!F(Ud)&&-1<Vd[q](\"ds\")&&a.set(mc,Ud))};var Zd=function(a){Yd(a,J[z][xa])?(a.set(Mc,!0),H(12)):a.set(Mc,!1)},Yd=function(a,b){if(!a.get(fb))return!1;var c=La(b,a.get(gb)),d=K(c.d.get(\"__utma\")),e=K(c.d.get(\"__utmb\")),f=K(c.d.get(\"__utmc\")),Be=K(c.d.get(\"__utmx\")),k=K(c.d.get(\"__utmz\")),s=K(c.d.get(\"__utmv\")),c=K(c.d.get(\"__utmk\"));if(Yc(\"\"+d+e+f+Be+k+s)!=c){d=I(d);e=I(e);f=I(f);Be=I(Be);f=$d(d+e+f+Be,k,s,c);if(!f)return!1;k=f[0];s=f[1]}if(!bd(a,d,!0))return!1;ed(a,e,!0);id(a,k,!0);gd(a,s,!0);ae(a,Be,!0);return!0},ce=function(a,b,c){var d;\nd=cd(a)||\"-\";var e=dd(a)||\"-\",f=\"\"+a.b(O,1)||\"-\",Be=be(a)||\"-\",k=hd(a,!1)||\"-\";a=fd(a,!1)||\"-\";var s=Yc(\"\"+d+e+f+Be+k+a),t=[];t[n](\"__utma=\"+d);t[n](\"__utmb=\"+e);t[n](\"__utmc=\"+f);t[n](\"__utmx=\"+Be);t[n](\"__utmz=\"+k);t[n](\"__utmv=\"+a);t[n](\"__utmk=\"+s);d=t[C](\"&\");if(!d)return b;e=b[q](\"#\");if(c)return 0>e?b+\"#\"+d:b+\"&\"+d;c=\"\";f=b[q](\"?\");0<e&&(c=b[B](e),b=b[B](0,e));return 0>f?b+\"?\"+d+c:b+\"&\"+d+c},$d=function(a,b,c,d){for(var e=0;3>e;e++){for(var f=0;3>f;f++){if(d==Yc(a+b+c))return H(127),[b,c];\nvar Be=b[p](/ /g,\"%20\"),k=c[p](/ /g,\"%20\");if(d==Yc(a+Be+k))return H(128),[Be,k];Be=Be[p](/\\+/g,\"%20\");k=k[p](/\\+/g,\"%20\");if(d==Yc(a+Be+k))return H(129),[Be,k];try{var s=b[oa](\"utmctr=(.*?)(?:\\\\|utm|$)\");if(s&&2==s[w]&&(Be=b[p](s[1],G(I(s[1]))),d==Yc(a+Be+c)))return H(139),[Be,c]}catch(t){}b=I(b)}c=I(c)}};var de=\"|\",fe=function(a,b,c,d,e,f,Be,k,s){var t=ee(a,b);t||(t={},a.get(Cb)[n](t));t.id_=b;t.affiliation_=c;t.total_=d;t.tax_=e;t.shipping_=f;t.city_=Be;t.state_=k;t.country_=s;t.items_=t.items_||[];return t},ge=function(a,b,c,d,e,f,Be){a=ee(a,b)||fe(a,b,\"\",0,0,0,\"\",\"\",\"\");var k;t:{if(a&&a.items_){k=a.items_;for(var s=0;s<k[w];s++)if(k[s].sku_==c){k=k[s];break t}}k=null}s=k||{};s.transId_=b;s.sku_=c;s.name_=d;s.category_=e;s.price_=f;s.quantity_=Be;k||a.items_[n](s);return s},ee=function(a,b){for(var c=\na.get(Cb),d=0;d<c[w];d++)if(c[d].id_==b)return c[d];return null};var he,ie=function(a){if(!he){var b;b=J[z].hash;var c=W[r],d=/^#?gaso=([^&]*)/;if(c=(b=(b=b&&b[oa](d)||c&&c[oa](d))?b[1]:K(pd(\"GASO\")))&&b[oa](/^(?:!([-0-9a-z.]{1,40})!)?([-.\\w]{10,1200})$/i))Fd(a,\"GASO\",\"\"+b,0),M._gasoDomain=a.get(bb),M._gasoCPath=a.get(P),a=c[1],Ia(\"https://www.google.com/analytics/web/inpage/pub/inpage.js?\"+(a?\"prefix=\"+a+\"&\":\"\")+Ea(),\"_gasojs\");he=!0}};var ae=function(a,b,c){c&&(b=I(b));c=a.b(O,1);b=b[y](\".\");2>b[w]||!/^\\d+$/[ia](b[0])||(b[0]=\"\"+c,Fd(a,\"__utmx\",b[C](\".\"),void 0))},be=function(a,b){var c=$c(a.get(O),pd(\"__utmx\"));\"-\"==c&&(c=\"\");return b?G(c):c},Ye=function(a){try{var b=La(J[z][xa],!1),c=ea(L(b.d.get(\"utm_referrer\")))||\"\";c&&a.set(Jb,c);var d=ea(K(b.d.get(\"utm_expid\")))||\"\";d&&(d=d[y](\".\")[0],a.set(Oc,\"\"+d))}catch(e){H(146)}},l=function(a){var b=W.gaData&&W.gaData.expId;b&&a.set(Oc,\"\"+b)};var ke=function(a,b){var c=m.min(a.b(Dc,0),100);if(a.b(Q,0)%100>=c)return!1;c=Ze()||$e();if(void 0==c)return!1;var d=c[0];if(void 0==d||d==ba||da(d))return!1;0<d?af(c)?b(je(c)):b(je(c[ja](0,1))):Ga(W,\"load\",function(){ke(a,b)},!1);return!0},me=function(a,b,c,d){var e=new yd;e.f(14,90,b[B](0,500));e.f(14,91,a[B](0,150));e.f(14,92,\"\"+le(c));void 0!=d&&e.f(14,93,d[B](0,500));e.o(14,90,c);return e},af=function(a){for(var b=1;b<a[w];b++)if(da(a[b])||a[b]==ba||0>a[b])return!1;return!0},le=function(a){return da(a)||\n0>a?0:5E3>a?10*m[la](a/10):5E4>a?100*m[la](a/100):41E5>a?1E3*m[la](a/1E3):41E5},je=function(a){for(var b=new yd,c=0;c<a[w];c++)b.f(14,c+1,\"\"+le(a[c])),b.o(14,c+1,a[c]);return b},Ze=function(){var a=W.performance||W.webkitPerformance;if(a=a&&a.timing){var b=a.navigationStart;if(0==b)H(133);else return[a.loadEventStart-b,a.domainLookupEnd-a.domainLookupStart,a.connectEnd-a.connectStart,a.responseStart-a.requestStart,a.responseEnd-a.responseStart,a.fetchStart-b,a.domInteractive-b,a.domContentLoadedEventStart-\nb]}},$e=function(){if(W.top==W){var a=W.external,b=a&&a.onloadT;a&&!a.isValidLoadTime&&(b=void 0);2147483648<b&&(b=void 0);0<b&&a.setPageReadyTime();return void 0==b?void 0:[b]}};var cf=function(a){if(a.get(Sb))try{var b;t:{var c=pd(a.get(Oe)||\"_ga\");if(c&&!(1>c[w])){for(var d=[],e=0;e<c[w];e++){var f;var Be=c[e][y](\".\"),k=Be.shift();if((\"GA1\"==k||\"1\"==k)&&1<Be[w]){var s=Be.shift()[y](\"-\");1==s[w]&&(s[1]=\"1\");s[0]*=1;s[1]*=1;f={Ya:s,$a:Be[C](\".\")}}else f=void 0;f&&d[n](f)}if(1==d[w]){b=d[0].$a;break t}if(0!=d[w]){var t=a.get(Pe)||a.get(bb),d=bf(d,(0==t[q](\".\")?t.substr(1):t)[y](\".\")[w],0);if(1==d[w]){b=d[0].$a;break t}var Za=a.get(Qe)||a.get(P);(c=Za)?(1<c[w]&&\"/\"==c[ma](c[w]-\n1)&&(c=c.substr(0,c[w]-1)),0!=c[q](\"/\")&&(c=\"/\"+c),Za=c):Za=\"/\";d=bf(d,\"/\"==Za?1:Za[y](\"/\")[w],1);b=d[0].$a;break t}}b=void 0}if(b){var Ma=(\"\"+b)[y](\".\");2==Ma[w]&&/[0-9.]/[ia](Ma)&&(H(114),a.set(Q,Ma[0]),a.set(Vb,Ma[1]),a.set(Sb,!1))}}catch(mb){H(115)}},bf=function(a,b,c){for(var d=[],e=[],f=128,Be=0;Be<a[w];Be++){var k=a[Be];if(k.Ya[c]==b)d[n](k);else if(k.Ya[c]==f)e[n](k);else k.Ya[c]<f&&(e=[k],f=k.Ya[c])}return 0<d[w]?d:e};var U=function(a,b,c){function d(a){return function(b){if((b=b.get(Nc)[a])&&b[w])for(var c=Te(e,a),d=0;d<b[w];d++)b[d].call(e,c)}}var e=this;this.a=new Zc;this.get=function(a){return this.a.get(a)};this.set=function(a,b,c){this.a.set(a,b,c)};this.set(Wa,b||\"UA-XXXXX-X\");this.set($a,a||\"\");this.set(Ya,c||\"\");this.set(ab,m.round((new Date)[g]()/1E3));this.set(P,\"/\");this.set(cb,63072E6);this.set(eb,15768E6);this.set(db,18E5);this.set(fb,!1);this.set(yb,50);this.set(gb,!1);this.set(hb,!0);this.set(ib,\n!0);this.set(jb,!0);this.set(kb,!0);this.set(lb,!0);this.set(ob,\"utm_campaign\");this.set(nb,\"utm_id\");this.set(pb,\"gclid\");this.set(qb,\"utm_source\");this.set(rb,\"utm_medium\");this.set(sb,\"utm_term\");this.set(tb,\"utm_content\");this.set(ub,\"utm_nooverride\");this.set(vb,100);this.set(Dc,1);this.set(Ec,!1);this.set(wb,\"/__utm.gif\");this.set(xb,1);this.set(Cb,[]);this.set(Fb,[]);this.set(zb,Ld[ja](0));this.set(Ab,[]);this.set(Bb,[]);this.B(\"auto\");this.set(Jb,J.referrer);Ye(this.a);this.set(Nc,{hit:[],\nload:[]});this.a.g(\"0\",Zd);this.a.g(\"1\",Wd);this.a.g(\"2\",Jd);this.a.g(\"3\",cf);this.a.g(\"4\",Sd);this.a.g(\"5\",Xd);this.a.g(\"6\",Kd);this.a.g(\"7\",d(\"load\"));this.a.g(\"8\",ie);this.a.e(\"A\",kd);this.a.e(\"B\",md);this.a.e(\"C\",Ge);this.a.e(\"D\",Jd);this.a.e(\"E\",jd);this.a.e(\"F\",Tc);this.a.e(\"G\",ne);this.a.e(\"H\",Gd);this.a.e(\"I\",nd);this.a.e(\"J\",ud);this.a.e(\"K\",Dd);this.a.e(\"L\",l);this.a.e(\"M\",d(\"hit\"));this.a.e(\"N\",oe);this.a.e(\"O\",pe);0===this.get(ab)&&H(111);this.a.T();this.H=void 0};E=U[x];\nE.m=function(){var a=this.get(Db);a||(a=new yd,this.set(Db,a));return a};E.La=function(a){for(var b in a){var c=a[b];a.hasOwnProperty(b)&&this.set(b,c,!0)}};E.K=function(a){if(this.get(Ec))return!1;var b=this,c=ke(this.a,function(c){b.set(Hb,a,!0);b.t(c)});this.set(Ec,c);return c};E.Fa=function(a){a&&Ca(a)?(H(13),this.set(Hb,a,!0)):\"object\"===typeof a&&null!==a&&this.La(a);this.H=a=this.get(Hb);this.a.j(\"page\");this.K(a)};\nE.F=function(a,b,c,d,e){if(\"\"==a||!wd(a)||\"\"==b||!wd(b)||void 0!=c&&!wd(c)||void 0!=d&&!xd(d))return!1;this.set(wc,a,!0);this.set(xc,b,!0);this.set(yc,c,!0);this.set(zc,d,!0);this.set(vc,!!e,!0);this.a.j(\"event\");return!0};E.Ha=function(a,b,c,d,e){var f=this.a.b(Dc,0);1*e===e&&(f=e);if(this.a.b(Q,0)%100>=f)return!1;c=1*(\"\"+c);if(\"\"==a||!wd(a)||\"\"==b||!wd(b)||!xd(c)||da(c)||0>c||0>f||100<f||void 0!=d&&(\"\"==d||!wd(d)))return!1;this.t(me(a,b,c,d));return!0};\nE.Ga=function(a,b,c,d){if(!a||!b)return!1;this.set(Ac,a,!0);this.set(Bc,b,!0);this.set(Cc,c||J[z][xa],!0);d&&this.set(Hb,d,!0);this.a.j(\"social\");return!0};E.Ea=function(){this.set(Dc,10);this.K(this.H)};E.Ia=function(){this.a.j(\"trans\")};E.t=function(a){this.set(Eb,a,!0);this.a.j(\"event\")};E.ia=function(a){this.v();var b=this;return{_trackEvent:function(c,d,e){H(91);b.F(a,c,d,e)}}};E.ma=function(a){return this.get(a)};\nE.xa=function(a,b){if(a)if(Ca(a))this.set(a,b);else if(\"object\"==typeof a)for(var c in a)a.hasOwnProperty(c)&&this.set(c,a[c])};E.addEventListener=function(a,b){var c=this.get(Nc)[a];c&&c[n](b)};E.removeEventListener=function(a,b){for(var c=this.get(Nc)[a],d=0;c&&d<c[w];d++)if(c[d]==b){c.splice(d,1);break}};E.qa=function(){return\"5.4.6\"};E.B=function(a){this.get(hb);a=\"auto\"==a?Ka(J.domain):a&&\"-\"!=a&&\"none\"!=a?a[D]():\"\";this.set(bb,a)};E.va=function(a){this.set(hb,!!a)};\nE.na=function(a,b){return ce(this.a,a,b)};E.link=function(a,b){if(this.a.get(fb)&&a){var c=ce(this.a,a,b);J[z].href=c}};E.ua=function(a,b){this.a.get(fb)&&a&&a.action&&(a.action=ce(this.a,a.action,b))};\nE.za=function(){this.v();var a=this.a,b=J.getElementById?J.getElementById(\"utmtrans\"):J.utmform&&J.utmform.utmtrans?J.utmform.utmtrans:null;if(b&&b[na]){a.set(Cb,[]);for(var b=b[na][y](\"UTM:\"),c=0;c<b[w];c++){b[c]=Da(b[c]);for(var d=b[c][y](de),e=0;e<d[w];e++)d[e]=Da(d[e]);\"T\"==d[0]?fe(a,d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8]):\"I\"==d[0]&&ge(a,d[1],d[2],d[3],d[4],d[5],d[6])}}};E.$=function(a,b,c,d,e,f,Be,k){return fe(this.a,a,b,c,d,e,f,Be,k)};E.Y=function(a,b,c,d,e,f){return ge(this.a,a,b,c,d,e,f)};\nE.Aa=function(a){de=a||\"|\"};E.ea=function(){this.set(Cb,[])};E.wa=function(a,b,c,d){var e=this.a;if(0>=a||a>e.get(yb))a=!1;else if(!b||!c||128<b[w]+c[w])a=!1;else{1!=d&&2!=d&&(d=3);var f={};ha(f,b);f.value=c;f.scope=d;e.get(Fb)[a]=f;a=!0}a&&this.a.n();return a};E.ka=function(a){this.a.get(Fb)[a]=void 0;this.a.n()};E.ra=function(a){return(a=this.a.get(Fb)[a])&&1==a[ua]?a[na]:void 0};E.Ca=function(a,b,c){this.m().f(a,b,c)};E.Da=function(a,b,c){this.m().o(a,b,c)};\nE.sa=function(a,b){return this.m().getKey(a,b)};E.ta=function(a,b){return this.m().N(a,b)};E.fa=function(a){this.m().L(a)};E.ga=function(a){this.m().M(a)};E.ja=function(){return new yd};E.W=function(a){a&&this.get(Ab)[n](a[D]())};E.ba=function(){this.set(Ab,[])};E.X=function(a){a&&this.get(Bb)[n](a[D]())};E.ca=function(){this.set(Bb,[])};E.Z=function(a,b,c,d,e){if(a&&b){a=[a,b[D]()][C](\":\");if(d||e)a=[a,d,e][C](\":\");d=this.get(zb);d.splice(c?0:d[w],0,a)}};E.da=function(){this.set(zb,[])};\nE.ha=function(a){this.a[ka]();var b=this.get(P),c=be(this.a);this.set(P,a);this.a.n();ae(this.a,c);this.set(P,b)};E.ya=function(a,b){if(0<a&&5>=a&&Ca(b)&&\"\"!=b){var c=this.get(Fc)||[];c[a]=b;this.set(Fc,c)}};E.V=function(a){a=\"\"+a;if(a[oa](/^[A-Za-z0-9]{1,5}$/)){var b=this.get(Ic)||[];b[n](a);this.set(Ic,b)}};E.v=function(){this.a[ka]()};E.Ba=function(a){a&&\"\"!=a&&(this.set(Tb,a),this.a.j(\"var\"))};var ne=function(a){\"trans\"!==a.get(sc)&&500<=a.b(cc,0)&&a[ta]();if(\"event\"===a.get(sc)){var b=(new Date)[g](),c=a.b(dc,0),d=a.b(Zb,0),c=m[la]((b-(c!=d?c:1E3*c))/1E3*1);0<c&&(a.set(dc,b),a.set(R,m.min(10,a.b(R,0)+c)));0>=a.b(R,0)&&a[ta]()}},pe=function(a){\"event\"===a.get(sc)&&a.set(R,m.max(0,a.b(R,10)-1))};var qe=function(){var a=[];this.add=function(b,c,d){d&&(c=G(\"\"+c));a[n](b+\"=\"+c)};this.toString=function(){return a[C](\"&\")}},re=function(a,b){(b||2!=a.get(xb))&&a.Za(cc)},se=function(a,b){b.add(\"utmwv\",\"5.4.6\");b.add(\"utms\",a.get(cc));b.add(\"utmn\",Ea());var c=J[z].hostname;F(c)||b.add(\"utmhn\",c,!0);c=a.get(vb);100!=c&&b.add(\"utmsp\",c,!0)},te=function(a,b){b.add(\"utmht\",(new Date)[g]());b.add(\"utmac\",Da(a.get(Wa)));a.get(Oc)&&b.add(\"utmxkey\",a.get(Oc),!0);a.get(vc)&&b.add(\"utmni\",1);var c=a.get(Ic);\nc&&0<c[w]&&b.add(\"utmdid\",c[C](\".\"));ff(a,b);!1!==a.get(Xa)&&(a.get(Xa)||M.w)&&b.add(\"aip\",1);M.bb||(M.bb=a.get(Wa));(1<M.ab()||M.bb!=a.get(Wa))&&b.add(\"utmmt\",1);b.add(\"utmu\",od.Xa())},ue=function(a,b){for(var c=a.get(Fc)||[],d=[],e=1;e<c[w];e++)c[e]&&d[n](e+\":\"+G(c[e][p](/%/g,\"%25\")[p](/:/g,\"%3A\")[p](/,/g,\"%2C\")));d[w]&&b.add(\"utmpg\",d[C](\",\"))},ff=function(a,b){function c(a,b){b&&d[n](a+\"=\"+b+\";\")}var d=[];c(\"__utma\",cd(a));c(\"__utmz\",hd(a,!1));c(\"__utmv\",fd(a,!0));c(\"__utmx\",be(a));b.add(\"utmcc\",\nd[C](\"+\"),!0)},ve=function(a,b){a.get(ib)&&(b.add(\"utmcs\",a.get(Qb),!0),b.add(\"utmsr\",a.get(Lb)),a.get(Rb)&&b.add(\"utmvp\",a.get(Rb)),b.add(\"utmsc\",a.get(Mb)),b.add(\"utmul\",a.get(Pb)),b.add(\"utmje\",a.get(Nb)),b.add(\"utmfl\",a.get(Ob),!0))},we=function(a,b){a.get(lb)&&a.get(Ib)&&b.add(\"utmdt\",a.get(Ib),!0);b.add(\"utmhid\",a.get(Kb));b.add(\"utmr\",Pa(a.get(Jb),a.get(P)),!0);b.add(\"utmp\",G(a.get(Hb),!0),!0)},xe=function(a,b){for(var c=a.get(Db),d=a.get(Eb),e=a.get(Fb)||[],f=0;f<e[w];f++){var Be=e[f];Be&&\n(c||(c=new yd),c.f(8,f,Be[r]),c.f(9,f,Be[na]),3!=Be[ua]&&c.f(11,f,\"\"+Be[ua]))}F(a.get(wc))||F(a.get(xc),!0)||(c||(c=new yd),c.f(5,1,a.get(wc)),c.f(5,2,a.get(xc)),e=a.get(yc),void 0!=e&&c.f(5,3,e),e=a.get(zc),void 0!=e&&c.o(5,1,e));c?b.add(\"utme\",c.Qa(d),!0):d&&b.add(\"utme\",d.A(),!0)},ye=function(a,b,c){var d=new qe;re(a,c);se(a,d);d.add(\"utmt\",\"tran\");d.add(\"utmtid\",b.id_,!0);d.add(\"utmtst\",b.affiliation_,!0);d.add(\"utmtto\",b.total_,!0);d.add(\"utmttx\",b.tax_,!0);d.add(\"utmtsp\",b.shipping_,!0);d.add(\"utmtci\",\nb.city_,!0);d.add(\"utmtrg\",b.state_,!0);d.add(\"utmtco\",b.country_,!0);xe(a,d);ve(a,d);we(a,d);(b=a.get(Gb))&&d.add(\"utmcu\",b,!0);c||(ue(a,d),te(a,d));return d[v]()},ze=function(a,b,c){var d=new qe;re(a,c);se(a,d);d.add(\"utmt\",\"item\");d.add(\"utmtid\",b.transId_,!0);d.add(\"utmipc\",b.sku_,!0);d.add(\"utmipn\",b.name_,!0);d.add(\"utmiva\",b.category_,!0);d.add(\"utmipr\",b.price_,!0);d.add(\"utmiqt\",b.quantity_,!0);xe(a,d);ve(a,d);we(a,d);(b=a.get(Gb))&&d.add(\"utmcu\",b,!0);c||(ue(a,d),te(a,d));return d[v]()},\nAe=function(a,b){var c=a.get(sc);if(\"page\"==c)c=new qe,re(a,b),se(a,c),xe(a,c),ve(a,c),we(a,c),b||(ue(a,c),te(a,c)),c=[c[v]()];else if(\"event\"==c)c=new qe,re(a,b),se(a,c),c.add(\"utmt\",\"event\"),xe(a,c),ve(a,c),we(a,c),b||(ue(a,c),te(a,c)),c=[c[v]()];else if(\"var\"==c)c=new qe,re(a,b),se(a,c),c.add(\"utmt\",\"var\"),!b&&te(a,c),c=[c[v]()];else if(\"trans\"==c)for(var c=[],d=a.get(Cb),e=0;e<d[w];++e){c[n](ye(a,d[e],b));for(var f=d[e].items_,Be=0;Be<f[w];++Be)c[n](ze(a,f[Be],b))}else\"social\"==c?b?c=[]:(c=new qe,\nre(a,b),se(a,c),c.add(\"utmt\",\"social\"),c.add(\"utmsn\",a.get(Ac),!0),c.add(\"utmsa\",a.get(Bc),!0),c.add(\"utmsid\",a.get(Cc),!0),xe(a,c),ve(a,c),we(a,c),ue(a,c),te(a,c),c=[c[v]()]):\"feedback\"==c?b?c=[]:(c=new qe,re(a,b),se(a,c),c.add(\"utmt\",\"feedback\"),c.add(\"utmfbid\",a.get(Gc),!0),c.add(\"utmfbpr\",a.get(Hc),!0),xe(a,c),ve(a,c),we(a,c),ue(a,c),te(a,c),c=[c[v]()]):c=[];return c},oe=function(a){var b,c=a.get(xb),d=a.get(uc),e=d&&d.Ua,f=0;if(0==c||2==c){var Be=a.get(wb)+\"?\";b=Ae(a,!0);for(var k=0,s=b[w];k<\ns;k++)Sa(b[k],e,Be,!0),f++}if(1==c||2==c)for(b=Ae(a),k=0,s=b[w];k<s;k++)try{Sa(b[k],e),f++}catch(t){t&&Ra(t[r],void 0,t.message)}d&&(d.q=f)};var Ce=function(a){ha(this,\"len\");this.message=a+\"-8192\"},De=function(a){ha(this,\"ff2post\");this.message=a+\"-2036\"},Sa=function(a,b,c,d){b=b||Fa;if(d||2036>=a[w])gf(a,b,c);else if(8192>=a[w]){if(0<=W[za].userAgent[q](\"Firefox\")&&![].reduce)throw new De(a[w]);hf(a,b)||Ee(a,b)}else throw new Ce(a[w]);},gf=function(a,b,c){c=c||(\"https:\"==J[z][A]||M.G?\"https://ssl.google-analytics.com\":\"http://www.google-analytics.com\")+\"/__utm.gif?\";var d=new Image(1,1);d.src=c+a;d.onload=function(){d.onload=null;d.onerror=\nnull;b()};d.onerror=function(){d.onload=null;d.onerror=null;b()}},hf=function(a,b){var c,d=(\"https:\"==J[z][A]||M.G?\"https://ssl.google-analytics.com\":\"http://www.google-analytics.com\")+\"/p/__utm.gif\",e=W.XDomainRequest;if(e)c=new e,c.open(\"POST\",d);else if(e=W.XMLHttpRequest)e=new e,\"withCredentials\"in e&&(c=e,c.open(\"POST\",d,!0),c.setRequestHeader(\"Content-Type\",\"text/plain\"));if(c)return c.onreadystatechange=function(){4==c.readyState&&(b(),c=null)},c.send(a),!0},Ee=function(a,b){if(J.body){a=aa(a);\ntry{var c=J[qa]('<iframe name=\"'+a+'\"></iframe>')}catch(d){c=J[qa](\"iframe\"),ha(c,a)}c.height=\"0\";c.width=\"0\";c.style.display=\"none\";c.style.visibility=\"hidden\";var e=J[z],e=(\"https:\"==J[z][A]||M.G?\"https://ssl.google-analytics.com\":\"http://www.google-analytics.com\")+\"/u/post_iframe.html#\"+aa(e[A]+\"//\"+e[u]+\"/favicon.ico\"),f=function(){c.src=\"\";c.parentNode&&c.parentNode.removeChild(c)};Ga(W,\"beforeunload\",f);var Be=!1,k=0,s=function(){if(!Be){try{if(9<k||c.contentWindow[z][u]==J[z][u]){Be=!0;f();\nHa(W,\"beforeunload\",f);b();return}}catch(a){}k++;ca(s,200)}};Ga(c,\"load\",s);J.body.appendChild(c);c.src=e}else We(function(){Ee(a,b)},100)};var $=function(){this.G=this.w=!1;this.C={};this.D=[];this.U=0;this.S=[[\"www.google-analytics.com\",\"\",\"/plugins/\"]];this._gasoCPath=this._gasoDomain=this.bb=void 0;Re();Se()};E=$[x];E.oa=function(a,b){return this.r(a,void 0,b)};E.r=function(a,b,c){b&&H(23);c&&H(67);void 0==b&&(b=\"~\"+M.U++);a=new U(b,a,c);M.C[b]=a;M.D[n](a);return a};E.u=function(a){a=a||\"\";return M.C[a]||M.r(void 0,a)};E.pa=function(){return M.D[ja](0)};E.ab=function(){return M.D[w]};E.aa=function(){this.w=!0};\nE.la=function(){this.G=!0};var Fe=function(a){if(\"prerender\"==J.webkitVisibilityState)return!1;a();return!0};var M=new $;var Ie=W._gat;Ie&&Ba(Ie._getTracker)?M=Ie:W._gat=M;var Z=new Y;(function(a){if(!Fe(a)){H(123);var b=!1,c=function(){!b&&Fe(a)&&(b=!0,Ha(J,\"webkitvisibilitychange\",c))};Ga(J,\"webkitvisibilitychange\",c)}})(function(){var a=W._gaq,b=!1;if(a&&Ba(a[n])&&(b=\"[object Array]\"==Object[x][v].call(Object(a)),!b)){Z=a;return}W._gaq=Z;b&&Z[n][ya](Z,a)});function Yc(a){var b=1,c=0,d;if(a)for(b=0,d=a[w]-1;0<=d;d--)c=a.charCodeAt(d),b=(b<<6&268435455)+c+(c<<14),c=b&266338304,b=0!=c?b^c>>21:b;return b};})();\n"
      },
      "https://js-agent.newrelic.com/nr-100.js": {
         "pageUrl": "https://zapier.com",
         "scriptUrl": "https://js-agent.newrelic.com/nr-100.js",
         "body": "var NR_QUEUE=[];\"undefined\"!=typeof window.NREUMQ?NR_QUEUE=NREUMQ:\"undefined\"!=typeof window.EPISODES?NR_QUEUE=EPISODES.q:\"undefined\"!=typeof window.NREUM&&(NR_QUEUE=NREUM.q);var NREUM=NREUM||{};NREUM.q=NR_QUEUE,NREUM.targetOrigin=document.location.protocol+\"//\"+document.location.host,NREUM.version=42,NREUM.autorun=\"undefined\"!=typeof NREUM.autorun?NREUM.autorun:!0,NREUM.init=function(){NREUM.dataSent=!1,NREUM.jsonp=!1,NREUM.beaconToken=null,NREUM.navCookie=!0,NREUM.bDone=!1,NREUM.cycle=0,NREUM.logging=!1,NREUM.contentLoadFired=!1,NREUM.marks={},NREUM.measures={},NREUM.starts={},NREUM.findStartTime(),NREUM.load=null,NREUM.extra=null,NREUM.addEventListener(\"beforeunload\",NREUM.beforeUnload,!1),NREUM.addEventListener(\"pagehide\",NREUM.beforeUnload,!1),NREUM.processQ(),NREUM.beacon=null,NREUM.licenseKey=null,NREUM.applicationID=null,NREUM.transactionName=null,NREUM.agentToken=null,NREUM.txnParam=null,NREUM.unloaded=!1,\"complete\"===document.readyState?NREUM.domContentLoaded():\"undefined\"!=typeof document.addEventListener?document.addEventListener(\"DOMContentLoaded\",NREUM.domContentLoaded,!1):\"undefined\"!=typeof document.attachEvent&&document.attachEvent(\"onreadystatechange\",NREUM.readyStateChange),NREUM.load||document.loaded?NREUM.onload():NREUM.addEventListener(\"load\",NREUM.onload,!1)},NREUM.processQ=function(){var a,b,c,d=NREUM.q.length;for(c=0;d>c;c++){switch(a=NREUM.q[c],b=null,a[0]){case\"mark\":NREUM.mark(a[1],a[2]);break;case\"measure\":NREUM.measure(a[1],a[2],a[3]);break;case\"done\":NREUM.done(a[1]);break;case\"nrf\":case\"nrfinish\":b=\"t\";break;case\"nrf2\":case\"nrfinish2\":b=\"to\";break;case\"nrfj\":b=\"to\",NREUM.jsonp=parent==self;break;case\"nrfjx\":NREUM.jsonp=parent==self;case\"nrf2x\":NREUM.nrfinish(\"to\",a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],null,null,null,a[10]);break;case\"load\":NREUM.load=a[1];break;default:NREUM.dprint(\"Unknown queue command \"+a[0])}b&&NREUM.nrfinish(b,a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],null)}},NREUM.nrfinish=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){NREUM.dprint(\"NREUM: finish data received\"),NREUM.txnParam=a,NREUM.beacon=b,NREUM.licenseKey=c,NREUM.applicationID=d,NREUM.transactionName=e,NREUM.tt_guid=i,NREUM.user=k,NREUM.account=l,NREUM.product=m,NREUM.extra=n,NREUM.measures.qt=f,NREUM.measures.ap=g,NREUM.dom_end_time=h,NREUM.agentToken=j},NREUM.mark=function(a,b){return NREUM.dprint(\"NREUM.mark: \"+a+\", \"+b),a?(NREUM.marks[a]=parseInt(b||(new Date).getTime(),10),\"firstbyte\"===a?(NREUM.measure(\"be\",\"starttime\",\"firstbyte\"),NREUM.dom_start_time=NREUM.marks.firstbyte):\"onload\"===a?NREUM.measure(\"fe\",\"firstbyte\",\"onload\"):\"domContent\"===a&&NREUM.measure(\"dc\",\"firstbyte\",\"domContent\"),void 0):(NREUM.dprint(\"Error: markName is undefined in NREUM.mark.\"),void 0)},NREUM.measure=function(a,b,c){if(NREUM.dprint(\"NREUM.measure: \"+a+\", \"+b+\", \"+c),!a)return NREUM.dprint(\"Error: episodeName is undefined in NREUM.measure.\"),void 0;var d;if(\"undefined\"==typeof b)d=\"number\"==typeof NREUM.marks[a]?NREUM.marks[a]:(new Date).getTime();else if(\"number\"==typeof NREUM.marks[b])d=NREUM.marks[b];else{if(\"number\"!=typeof b)return NREUM.dprint(\"Error: unexpected startNameOrTime in NREUM.measure: \"+b),void 0;d=b}var e;if(\"undefined\"==typeof c)e=(new Date).getTime();else if(\"number\"==typeof NREUM.marks[c])e=NREUM.marks[c];else{if(\"number\"!=typeof c)return NREUM.dprint(\"NREUM: Error: unexpected endNameOrTime in NREUM.measure: \"+c),void 0;e=c}NREUM.starts[a]=parseInt(d,10),NREUM.measures[a]=parseInt(e-d,10)},NREUM.done=function(a){NREUM.bDone||(NREUM.bDone=!0,NREUM.mark(\"done\"),NREUM.autorun&&NREUM.sendBeacon(),\"function\"==typeof a&&a())},NREUM.getMarks=function(){return NREUM.marks},NREUM.getMeasures=function(){return NREUM.measures},NREUM.getStarts=function(){return NREUM.starts},NREUM.sendBeacon=function(){if(!NREUM.dataSent){if(NREUM.dataSent=!0,NREUM.processQ(),NREUM.domContentLoaded(),null===NREUM.licenseKey||null===NREUM.applicationID)return NREUM.dprint(\"NREUM: licenseKey or applicationID has not been set\"),void 0;NREUM.dom_end_time&&NREUM.dom_start_time&&(NREUM.dprint(\"NREUM: picking up DOM processing time from embedded JS\"),NREUM.mark(\"domContent\",NREUM.dom_end_time)),NREUM.load&&(NREUM.dprint(\"NREUM: picking up load event time from embedded JS\"),NREUM.mark(\"onload\",NREUM.load));var a,b=NREUM.getMeasures(),c=\"\";for(a in b)c+=\"&\"+a+\"=\"+b[a];var d;if(c){var e=\"1\";d=(\"http:\"===document.location.protocol?\"http:\":\"https:\")+\"//\"+NREUM.beacon+\"/\"+e+\"/\"+NREUM.licenseKey,d+=\"?a=\"+NREUM.applicationID,d+=c,d+=NREUM.getParam(NREUM.txnParam,NREUM.transactionName),d+=NREUM.getParam(\"tt\",NREUM.tt_guid),d+=NREUM.getParam(\"us\",NREUM.user),d+=NREUM.getParam(\"ac\",NREUM.account),d+=NREUM.getParam(\"pr\",NREUM.product),d+=NREUM.getParam(\"tk\",NREUM.agentToken),d+=\"&v=\"+NREUM.version,d+=NREUM.getParam(\"xx\",NREUM.extra),NREUM.jsonp&&(d+=\"&jsonp=NREUM.setToken\");var f=NREUM.getPerformance();if(f){var g={};g.timing=NREUM.addPT(f.timing,{}),g.navigation=NREUM.addPN(f.navigation,{}),d+=NREUM.getParam(\"perf\",NREUM.stringify(g))}if(NREUM.jsonp){var h=document.createElement(\"script\");h.type=\"text/javascript\",h.src=d,document.body.appendChild(h)}else{var i=new Image;i.src=d}NREUM.dprint(\"NREUM: (new) data sent\",d)}}},NREUM.getParam=function(a,b){return null!=b&&b.length>0?\"&\"+a+\"=\"+encodeURIComponent(b):\"\"},NREUM.addPT=function(a,b){var c=a.navigationStart;return b.of=c,NREUM.addRel(a.navigationStart,c,b,\"n\"),NREUM.addRel(a.unloadEventStart,c,b,\"u\"),NREUM.addRel(a.unloadEventEnd,c,b,\"ue\"),NREUM.addRel(a.domLoading,c,b,\"dl\"),NREUM.addRel(a.domInteractive,c,b,\"di\"),NREUM.addRel(a.domContentLoadedEventStart,c,b,\"ds\"),NREUM.addRel(a.domContentLoadedEventEnd,c,b,\"de\"),NREUM.addRel(a.domComplete,c,b,\"dc\"),NREUM.addRel(a.loadEventStart,c,b,\"l\"),NREUM.addRel(a.loadEventEnd,c,b,\"le\"),NREUM.addRT(a,b,c),b},NREUM.addPN=function(a,b){return NREUM.addRel(a.type,0,b,\"ty\"),NREUM.addRel(a.redirectCount,0,b,\"rc\"),b},NREUM.addRT=function(a,b,c){var d;return c?d=c:(d=a.startTime,b.of=d),NREUM.addRel(a.redirectStart,d,b,\"r\"),NREUM.addRel(a.redirectEnd,d,b,\"re\"),NREUM.addRel(a.fetchStart,d,b,\"f\"),NREUM.addRel(a.domainLookupStart,d,b,\"dn\"),NREUM.addRel(a.domainLookupEnd,d,b,\"dne\"),NREUM.addRel(a.connectStart,d,b,\"c\"),NREUM.addRel(a.connectEnd,d,b,\"ce\"),NREUM.addRel(a.secureConnectionStart,d,b,\"s\"),NREUM.addRel(a.requestStart,d,b,\"rq\"),NREUM.addRel(a.responseStart,d,b,\"rp\"),NREUM.addRel(a.responseEnd,d,b,\"rpe\"),c||(b.n=a.name,b.st=a.startTime-d,b.it=a.initiatorType,b.du=a.duration),b},NREUM.addRel=function(a,b,c,d){\"number\"==typeof a&&a>0&&(c[d]=a-b)},NREUM.setToken=function(a){NREUM.dprint(\"NREUM: trace \"+a),NREUM.beaconToken=a},NREUM.inlineHit=function(a,b,c,d,e,f){if(NREUM.cycle+=1,null===NREUM.licenseKey||null===NREUM.applicationID)return NREUM.dprint(\"NREUM: licenseKey or applicationID has not been set\"),void 0;var g=new Image,h=(\"http:\"===document.location.protocol?\"http:\":\"https:\")+\"//\"+NREUM.beacon+\"/1/\"+NREUM.licenseKey;h+=\"?a=\"+NREUM.applicationID+\"&\",h+=\"t=\"+a+\"&\",h+=\"qt=\"+b+\"&\",h+=\"ap=\"+c+\"&\",h+=\"be=\"+d+\"&\",h+=\"dc=\"+e+\"&\",h+=\"fe=\"+f+\"&\",h+=\"c=\"+NREUM.cycle,g.src=h,NREUM.dprint(\"NREUM Inline: \"+h)},NREUM.findStartTime=function(){var a=NREUM.findStartWebTiming()||NREUM.findStartGToolbar()||NREUM.findStartCookie();a?NREUM.mark(\"starttime\",a):NREUM.dprint(\"NREUM: Error: couldn't find a start time\")},NREUM.findStartWebTiming=function(){var a;if(/Firefox[\\/\\s](\\d+\\.\\d+)/.test(navigator.userAgent)){var b=new Number(RegExp.$1);if(9>b)return a}var c=NREUM.getPerformance();return c&&\"undefined\"!=typeof c.timing.navigationStart&&(a=c.timing.navigationStart,NREUM.dprint(\"NREUM.findStartWebTiming: startTime = \"+a)),a&&(NREUM.navCookie=!1),a},NREUM.getPerformance=function(){var a=window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance;return\"undefined\"!=typeof a&&\"undefined\"!=typeof a.timing?a:null},NREUM.findStartGToolbar=function(){var a,b;try{window.external&&window.external.pageT?a=window.external.pageT:window.gtbExternal&&window.gtbExternal.pageT?a=window.gtbExternal.pageT():window.chrome&&window.chrome.csi&&(a=window.chrome.csi().pageT),a&&6e4>a&&(b=(new Date).getTime()-a,NREUM.dprint(\"NREUM.findStartGToolbar: startTime = \"+b))}catch(c){}return b&&(NREUM.navCookie=!1),b},NREUM.findStartCookie=function(){var a,b,c=document.cookie.split(\" \");for(a=0;a<c.length;a++)if(0===c[a].indexOf(\"NREUM=\")){var d,e,f,g,h=c[a].substring(\"NREUM=\".length).split(\"&\");for(b=0;b<h.length;b++)0===h[b].indexOf(\"s=\")?f=h[b].substring(2):0===h[b].indexOf(\"h=\")?(f=h[b].substring(2),NREUM.measure(\"ph\",0,1)):0===h[b].indexOf(\"p=\")?(e=h[b].substring(2),\";\"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1))):0===h[b].indexOf(\"r=\")&&(d=h[b].substring(2),\";\"===d.charAt(d.length-1)&&(d=d.substr(0,d.length-1)));if(d){var i=NREUM.sHash(document.referrer);g=i==d,g||(g=NREUM.sHash(document.location.href)==d&&i==e)}if(g&&f){var j=(new Date).getTime();return j-f>6e4?(NREUM.dprint(\"NREUM.findStartCookie: startTime > 60s old - ignored\"),void 0):(NREUM.dprint(\"NREUM.findStartCookie: startTime = \"+f),f)}}return void 0},NREUM.beforeUnload=function(a){if(!NREUM.unloaded){var b=\"s\";\"pagehide\"===a.type&&(b=\"h\"),NREUM.navCookie&&(document.cookie=\"NREUM=\"+b+\"=\"+Number(new Date)+\"&r=\"+NREUM.sHash(document.location.href)+\"&p=\"+NREUM.sHash(document.referrer)+\"; path=/\"),NREUM.beaconToken&&(document.cookie=\"NRAGENT=tk=\"+NREUM.beaconToken+\"; max-age=1; path=/\"),NREUM.unloaded=!0}},NREUM.onload=function(){NREUM.mark(\"onload\"),NREUM.autorun&&NREUM.done()},NREUM.domContentLoaded=function(){NREUM.contentLoadFired||(NREUM.mark(\"domContent\",(new Date).getTime()),NREUM.contentLoadFired=!0)},NREUM.readyStateChange=function(){\"complete\"===document.readyState&&NREUM.domContentLoaded()},NREUM.addEventListener=function(a,b,c){return\"undefined\"!=typeof window.attachEvent?window.attachEvent(\"on\"+a,b):window.addEventListener?window.addEventListener(a,b,c):void 0},NREUM.sHash=function(a){var b,c=0;for(b=0;b<a.length;b++)c+=(b+1)*a.charCodeAt(b);return Math.abs(c)},NREUM.stringify=function(a){var b=typeof a;switch(b){case\"string\":return'\"'+a+'\"';case\"boolean\":case\"number\":return String(a);case\"object\":if(null===a)return\"null\";var c=!1,d=\"\";for(prop in a){var e=String(prop),f=NREUM.stringify(a[prop]);f.length>0&&(c?d+=\", \":c=!0,d+=a instanceof Array?f:'\"'+e+'\":'+f)}return a instanceof Array?\"[\"+d+\"]\":\"{\"+d+\"}\";default:return\"\"}},NREUM.dprint=\"undefined\"!=typeof console&&\"undefined\"!=typeof console.log?function(a){NREUM.logging&&console.log(a)}:function(){},NREUM.init();"
      },
      "/inline_4a1d832df13ce66b7f1a38dd41e1815e": {
         "body": "\n    var path = '/';\n    var mediaUrl = 'https://zapier.cachefly.net/static/CUEKpp/';\n    var preload = {};\n  \n    preload.account = {};\n  \n    var DEBUG = false;\n    var STRIPE_PUB_API_KEY = 'pk_phnG9Y3BlUIYXVpH1gkMOJ25RGbsI';\n    var TITLE_APPEND = ' - Zapier';\n    var PARTNER_ENVIRONMENT = null;\n    var PERSONAS = [\"Contractor\", \"Customer Support\", \"Designer\", \"Developer\", \"Freelancer\", \"Government\", \"Human Resource\", \"Information Technology\", \"Lawyer\", \"Marketer\", \"Non-Profit\", \"Real Estate\", \"Sales\", \"Small Business Owner\", \"Other\"];\n    \n  ",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_4a1d832df13ce66b7f1a38dd41e1815e"
      },
      "/inline_8173a2787cd541f0ca7b4ad13a2bb599": {
         "body": "\nwindow.tests = window.tests || {};\n\n// place test switches!\n// See if adding a guider on mapping step bumps signup to live zap %\nwindow.tests.editorMappingGuiders = true;\nwindow.tests.seeUserfillHelper = true;\nwindow.tests.canGetSuggestions = false;\n\n",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_8173a2787cd541f0ca7b4ad13a2bb599"
      },
      "/inline_78734dbb222eb2977ee4de50945555ba": {
         "body": "var NREUMQ=NREUMQ||[];NREUMQ.push([\"mark\",\"firstbyte\",new Date().getTime()]);",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_78734dbb222eb2977ee4de50945555ba"
      },
      "/inline_8711d4e5d5cb8aa2c222f8a4ed5f96f1": {
         "body": "\nsetTimeout(function() {\n  \n  var stylesheet = document.createElement('link');\n  stylesheet.href = 'https://zapier.cachefly.net/static/CUEKpp/build/service-sprites.css';\n  stylesheet.rel = 'stylesheet';\n  stylesheet.type = 'text/css';\n  document.getElementsByTagName('head')[0].appendChild(stylesheet);\n  \n\n  var stylesheet = document.createElement('link');\n  stylesheet.href = '/generated/sprites.css';\n  stylesheet.rel = 'stylesheet';\n  stylesheet.type = 'text/css';\n  document.getElementsByTagName('head')[0].appendChild(stylesheet);\n}, 0);\n",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_8711d4e5d5cb8aa2c222f8a4ed5f96f1"
      },
      "/inline_371b50b963f8274fdd6cef68cabb6a3c": {
         "body": "\n  var _gaq = _gaq || [];\n  _gaq.push(['_setAccount', 'UA-27002928-1']);\n  _gaq.push(['_setDomainName', 'zapier.com']);\n  // _gaq.push(['_trackPageview']); dont track pageload\n\n  (function() {\n    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\n    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\n  })();\n",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_371b50b963f8274fdd6cef68cabb6a3c"
      },
      "/inline_a5d5b8499e1cff27a06193bd1e80e785": {
         "body": "\n  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n  ga('create', 'UA-27002928-2', 'zapier.com');\n  // ga('send', 'pageview'); dont track page load\n\n",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_a5d5b8499e1cff27a06193bd1e80e785"
      },
      "/inline_9878bbefe1c567446031bb34c98b8a28": {
         "body": "\n    /* <![CDATA[ */\n    var google_conversion_id = 1002491550;\n    var google_conversion_language = \"en\";\n    var google_conversion_format = \"3\";\n    var google_conversion_color = \"ffffff\";\n    var google_conversion_label = \"pz-iCPqG7QIQnp2D3gM\";\n    var google_conversion_value = 0;\n    /* ]]> */\n    ",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_9878bbefe1c567446031bb34c98b8a28"
      },
      "/inline_611904ee8d2cc4bd34182b9c7f7a3217": {
         "body": "\n\n  window.onload = function() {\n\n    // viewportKey is basically from the account you create\n    window.viewportApiKey = 'd61ae0c0-704b-11e2-8d3a-f77f01b9c359';\n    \n      window.viewportUrl = 'https://viewport.zapier.com:8443';\n    \n\n    \n      window.viewportName = \"frontend Fair Alpaca\"; // set this to override default geolocation identifer\n    \n\n    (function() {\n      var s = document.createElement('script');\n      s.type = 'text/javascript';\n      s.async = true;\n\n      \n        s.src = 'https://viewport.zapier.com/assets/static/js/build.js?viewport=js';\n      \n\n      var x = document.getElementsByTagName('script')[0];\n      x.parentNode.insertBefore(s, x);\n     })();\n\n  }\n\n  ",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_611904ee8d2cc4bd34182b9c7f7a3217"
      },
      "/inline_d2abda3b1e57d92d88f3adea3853255e": {
         "body": "if(!NREUMQ.f){NREUMQ.f=function(){NREUMQ.push([\"load\",new Date().getTime()]);var e=document.createElement(\"script\");e.type=\"text/javascript\";e.src=((\"http:\"===document.location.protocol)?\"http:\":\"https:\")+\"//\"+\"js-agent.newrelic.com/nr-100.js\";document.body.appendChild(e);if(NREUMQ.a)NREUMQ.a();};NREUMQ.a=window.onload;window.onload=NREUMQ.f;};NREUMQ.push([\"nrfj\",\"beacon-5.newrelic.com\",\"c342879a4c\",\"1492474\",\"M1ZRYEQCXktZUkNdCgocdUFYAERRV18YRgoLR2xCXwZHSwJZWFkA\",0,90,new Date().getTime(),\"\",\"\",\"\",\"\",\"\"]);",
         "pageUrl": "https://zapier.com",
         "scriptUrl": "/inline_d2abda3b1e57d92d88f3adea3853255e"
      },
      "/inline_2d09ffa1ffc22182731fbaf9a8fba3cd": {
         "body": "\n    var path = '/zapbook/mailchimp/';\n    var mediaUrl = 'https://zapier.cachefly.net/static/CUEKpp/';\n    var preload = {};\n  \n    preload.account = {};\n  \n    var DEBUG = false;\n    var STRIPE_PUB_API_KEY = 'pk_phnG9Y3BlUIYXVpH1gkMOJ25RGbsI';\n    var TITLE_APPEND = ' - Zapier';\n    var PARTNER_ENVIRONMENT = null;\n    var PERSONAS = [\"Contractor\", \"Customer Support\", \"Designer\", \"Developer\", \"Freelancer\", \"Government\", \"Human Resource\", \"Information Technology\", \"Lawyer\", \"Marketer\", \"Non-Profit\", \"Real Estate\", \"Sales\", \"Small Business Owner\", \"Other\"];\n    \n  ",
         "pageUrl": "https://zapier.com/zapbook/mailchimp/",
         "scriptUrl": "/inline_2d09ffa1ffc22182731fbaf9a8fba3cd"
      },
      "https://zapier.cachefly.net/static/CUEKpp/build/templates.js": {
         "pageUrl": "https://zapier.com/app/signup",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEKpp/build/templates.js",
         "body": "(function(){window.JST=window.JST||{};window.JST[\"login\"]=JST('<h1>Login</h1>\\n<form id=\"login-form-static\" autocomplete=\"on\" action=\"/login/\" method=\"post\">\\n  <!-- the id of the form, login-form, is depended upon to sub in/out of the DOM -->\\n  <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\" />\\n  <input type=\"hidden\" name=\"next\" value=\"{{next}}\" />\\n  <input id=\"email\" name=\"email\" type=\"text\" class=\"account\" placeholder=\"Email\" autocomplete=\"on\" />\\n  <input id=\"password\" name=\"password\" type=\"password\" class=\"password\" placeholder=\"Password\" autocomplete=\"on\" />\\n  <input type=\"submit\" class=\"submit\" value=\"Log In\" />\\n  <span class=\"alt-cta\"><a href=\"/app/forgot\" data-nav=\"app/forgot\">Forgot password?</a></span>\\n  <p class=\"feedback error\">\\n    {{#equals status \"tryagain\"}}Incorrect email or password.{{/equals}}\\n  </p>\\n</form>\\n<div class=\"signup\">Don\\'t have a Zapier account yet? <em><a href=\"/app/signup{{#if next}}?next={{next}}{{/if}}\" data-nav=\"app/signup{{#if next}}?next={{next}}{{/if}}\">Signup Now!</a></em></div>');window.JST[\"test\"]=JST(\"<div>hello world</div>\");window.JST[\"preloader\"]=JST('<div class=\"preloader\">\\n  <div class=\"boundary\">\\n    <div class=\"progress\" src=\"{{mediaURL}}images/logo60orange.png\"></div>\\n    <div class=\"logo\" src=\"{{mediaURL}}images/logo60grey.png\"></div>\\n  </div>\\n  <div class=\"retry\">So sorry! Let\\'s try that again, shall we? <button>Refresh this page</button></div>\\n</div>');window.JST[\"dashboard_zaps\"]=JST('{{#hasAtLeastOne z.app.reads}}\\n\\n  <div class=\"live-block\">\\n    <h2>On</h2>\\n    <div class=\"empty-block\">You have no Zaps turned on. <a href=\"#\" data-nav=\"app/editor\">Make a new Zap</a>{{#unless isPartner}} or <a href=\"#\" data-nav=\"app/explore\">Explore Zap templates to start with</a>{{/unless}}.</div>\\n  </div>\\n\\n  <div class=\"paused-block\">\\n    <h2>Off</h2>\\n    <div class=\"empty-block\">You have no Zaps turned off.</div>\\n  </div>\\n\\n  <div class=\"unfinished-block\">\\n    <h2>Drafts</h2>\\n    <div class=\"empty-block\">You have no Unfinished Zaps.</div>\\n  </div>\\n\\n{{else}}\\n\\n<div class=\"no-zaps inlay\">\\n  <h2>You haven\\'t built any Zaps yet!</h2>\\n  <a class=\"pill-button orange huge\" href=\"/app/editor\" data-nav=\"app/editor\">Make your first Zap now</a>\\n</div>\\n\\n{{/hasAtLeastOne}}\\n');window.JST[\"dashboard_logs\"]=JST('<h3>Task History</h3>\\n{{#hasAtLeastOne logs}}\\n<a href=\"/app/history\" data-nav=\"app/history\" class=\"right-link\">See all</a>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"dashboard-log\">\\n{{#each logs max=8}}\\n  <div class=\"history\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\" title=\"Click for more details\">\\n    <div class=\"services\">\\n      <div class=\"service\">\\n        <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n      </div>\\n      <i class=\"fa fa-caret-right caret\"></i>\\n      <div class=\"service\">\\n        <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n      </div>\\n    </div>\\n    <div class=\"title\">{{this.object_title}}</div>\\n    <div class=\"timesince\">{{this.timesince}} ago</div>\\n    <div class=\"status-indicator {{this.data.status}}\"></div>\\n  </div>\\n{{else}}\\n  <div>\\n    <div class=\"empty\"><em>No recent activity.</em></div>\\n  </div>\\n{{/each}}\\n</div>\\n\\n{{#hasAtLeastOne logs}}\\n<p class=\"small more\"><a href=\"/app/history\" data-nav=\"app/history\">See all task history</a></p>\\n{{/hasAtLeastOne}}');window.JST[\"dashboard_search\"]=JST('<div class=\"tabs\">\\n{{#equals selected \\'dashboard\\'}}\\n  <h2>My Zaps <span class=\"link\">(see <a href=\"/app/dashboard/shared\" data-nav=\"app/dashboard/shared\">Shared</a>)</span></h2>\\n{{else}}\\n  <h2>Shared <span class=\"link\">(see <a href=\"/app/dashboard\" data-nav=\"app/dashboard\">My Zaps</a>)</span></h2>\\n{{/equals}}\\n</div>\\n<div class=\"search-bar\">\\n  <i class=\"fa fa-search\"></i>\\n  <input type=\"text\" placeholder=\"Filter my Zaps by name or app...\" value=\"{{search}}\" />\\n  <a href=\"#\" class=\"clear\"><i class=\"fa fa-times-circle\"></i></a>\\n</div>\\n<clear/>');window.JST[\"dashboard_bonus\"]=JST('<div class=\"top-hat\">\\n  Get Free Bonuses\\n  <div class=\"right\"><em><a class=\"blue\" href=\"/bonus\">learn more</a></em></div>\\n</div>\\n\\n<div class=\"content\">\\n  <ol>\\n  {{#each bonuses}}\\n    <li class=\"bonus {{#if earned}}earned{{/if}} {{#if partial_earned}}partial_earned{{/if}}\" id=\"{{this.id}}\">\\n\\n      <span class=\"description\">\\n        <i class=\"checkmark\"></i>\\n        <h5>\\n          {{#unless earned}}<a href=\"/bonus\">{{/unless}}\\n          {{title}}\\n          {{#unless earned}}</a>{{/unless}}\\n        </h5>\\n        <br />\\n        <span class=\"count\">\\n          {{#notequals limit \"1\"}}\\n          earned {{times_earned}} / {{#equals limit \"-1\"}}unlimited{{else}}{{limit}}{{/equals}} times\\n          {{/notequals}}\\n        </span>\\n      </span>\\n\\n      <div class=\"incentive\">\\n        <span class=\"number\">+{{action_limit_extra}}</span> tasks\\n      </div>\\n\\n    </li>\\n  {{/each}}\\n  </ol>\\n\\n</div>');window.JST[\"dashboard_shared_zap_menu\"]=JST('<ul class=\"zap-menu\">\\n  <li><a href=\"#\" class=\"rename\"><i class=\"fa fa-tag\"></i> Rename</a></li>\\n  <li><a href=\"#\" class=\"permalink\"><i class=\"fa fa-link\"></i> Permalink</a></li>\\n  <li>\\n  <a href=\"#\" class=\"delete\">\\n    <i class=\"fa fa-times-circle\"></i>\\n    <span class=\"default\">Delete</span>\\n    <span class=\"confirm\">Really delete?</span>\\n  </a>\\n  </li>\\n</ul>');window.JST[\"dashboard_zap\"]=JST('{{#greater read.held_items 0}}\\n<a class=\"held button\" title=\"This Zap has {{read.held_items}} waiting for your review before they can be processed.\" href=\"/engine/zaps/{{read.id}}/release\"><i class=\"fa fa-exclamation-circle\"></i></a>\\n{{else}}\\n{{#if unseen}}\\n<a class=\"count button\" title=\"View recent task history ({{unseen}}) for this Zap\" href=\"/app/history/?write_id={{write.id}}\" data-nav=\"app/history?write_id={{write.id}}\">{{unseen}}</a>\\n{{/if}}\\n{{/greater}}\\n\\n<div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n\\n<div class=\"twrapper\">\\n  <div class=\"services\">\\n    <div class=\"service {{ cssReadClass }}\" title=\"[Service name]\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{ cssWriteClass }}\" title=\"Connect {{ recipe.write_service.title }}\"></div>\\n  </div>\\n  <div class=\"title\">{{try title \"Unnamed Zap\"}}</div>\\n\\n  <div class=\"controls\">\\n    {{#unless errorString}}\\n    <div class=\"toggle\">\\n      <a href=\"#\" class=\"switch\" data-toggle=\"off\">Off</a>\\n      <div class=\"toggle-container{{#unless read.paused}} on{{/unless}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-toggle=\"on\">On</a>\\n    </div>\\n    {{/unless}}\\n    <div class=\"open-menu\">\\n      <div class=\"menu-button\">\\n        <i class=\"fa fa-cog\"></i>\\n      </div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"dashboard_limits\"]=JST('<h3>Account Usage</h3>\\n{{#each limits.allotment}}\\n  <div class=\"limit\" id=\"{{slugify name}}\">\\n    <div class=\"name\">{{name}}</div>\\n\\n    <div class=\"count\">{{this.count}} / {{limit}}</div>\\n\\n    <div class=\"progress-bar striped\">\\n      <div class=\"bar {{status}}\" style=\"width: {{percent}}%;\"></div>\\n    </div>\\n\\n  </div>\\n{{/each}}\\n\\n<p class=\"small cycle\">Monthly Usage Resets In: {{limits.billing_cycle_time_left}}</p>\\n\\n<p class=\"small\"><a href=\"#\" data-nav=\"/app/settings/plans\" title=\"See other available pricing plans\">Need more tasks or Zaps?</a></p>');window.JST[\"dashboard_collection\"]=JST('<a href=\"#\" class=\"button\">Create an embeddable widget</a>');window.JST[\"dashboard_shared_zap\"]=JST('<div class=\"title-narrow\">{{try description \"Unnamed Zap\"}}</div>\\n\\n<div class=\"twrapper\">\\n  <div class=\"services\">\\n    <div class=\"service {{ cssReadClass }}\" title=\"[Service name]\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{ cssWriteClass }}\" title=\"Connect {{ recipe.write_service.title }}\"></div>\\n  </div>\\n  <div class=\"title\">{{try description \"Unnamed Zap\"}}</div>\\n\\n  <div class=\"controls\">\\n    <div class=\"open-menu\">\\n      <div class=\"menu-button\">\\n        <i class=\"fa fa-cog\"></i>\\n      </div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"dashboard_partner_text\"]=JST('<div class=\"step\">\\n  <h1>Zapier enables you to connect {{service}} to hundreds of other web services!</h1>\\n  <a href=\"#\" class=\"button orange big\">Learn How &nbsp; <i class=\"fa fa-arrow-right \"></i></a>\\n</div>\\n\\n<div class=\"step hide\">\\n  <h1>Zaps automate common tasks.</h1>\\n  <h2>Here is an example:</h2>\\n  <div class=\"example\">\\n    <div class=\"zap-step\">\\n      <i class=\"img64 {{readService}}64x64\"></i> {{readAction}}\\n      <br />\\n      <img src=\"{{mediaURL}}images/arrows/trigger.png\"></img>\\n    </div>\\n\\n    <div class=\"zap-step\">\\n      <i class=\"img64 {{writeService}}64x64\"></i> {{writeAction}}\\n      <br />\\n      <img src=\"{{mediaURL}}images/arrows/action.png\"></img>\\n    </div>\\n  </div>\\n  <div class=\"clear\"></div>\\n  <a href=\"#\" class=\"button orange big\">Alright, let\\'s do this! &nbsp; <i class=\"fa fa-arrow-right \"></i></a>\\n</div>\\n\\n<div class=\"step hide\">\\n  <h1>Pick a Zap over here to get started!</h1>\\n  <br/>\\n  <img src=\"{{mediaURL}}images/arrows/right.png\" />\\n</div>');window.JST[\"dashboard_zap_menu\"]=JST('<ul class=\"zap-menu\">\\n{{#if canRun}}\\n  {{#unless errorString}}\\n  {{#unless read.paused}}\\n  <li><a href=\"#\" class=\"run\"><i class=\"fa fa-repeat\"></i> Run</a></li>\\n  {{/unless}}\\n  {{/unless}}\\n{{else}}\\n  {{#unless errorString}}\\n  {{#unless read.paused}}\\n  <li class=\"no-hover\"><a href=\"#\" class=\"instant\"><i class=\"fa fa-bolt\"></i> Instant!</a></li>\\n  {{/unless}}\\n  {{/unless}}\\n{{/if}}\\n<li>\\n  <a href=\"#\" class=\"edit\" data-nav=\"app/editor/{{read.id}}\">\\n    <i class=\"fa fa-edit\"></i> Edit\\n  </a>\\n</li>\\n<li><a href=\"#\" class=\"logs\" data-nav=\"app/history?write_id={{write.id}}\"><i class=\"fa fa-bars\"></i> History</a></li>\\n<li>\\n  <a href=\"#\" class=\"copy\">\\n    <i class=\"fa fa-copy\"></i>\\n    <span class=\"default\">Copy</span>\\n    <span class=\"working\">Copying...</span>\\n  </a>\\n</li>\\n<li><a href=\"#\" class=\"rename\"><i class=\"fa fa-tag\"></i> Rename</a></li>\\n<li><a href=\"#\" class=\"share\"><i class=\"fa fa-share\"></i> Share</a></li>\\n<li>\\n<a href=\"#\" class=\"delete\">\\n  <i class=\"fa fa-times-circle\"></i>\\n  <span class=\"default\">Delete</span>\\n  <span class=\"confirm\">Really delete?</span>\\n</a>\\n</li>\\n</ul>');window.JST[\"dashboard_subscribe\"]=JST('<span class=\"subscribe-info\">\\n<p class=\"small\">Want tips to help you become more efficient, productive, and awesome?</p>\\n<a href=\"#\" class=\"button\">Subscribe to the Zapier blog!</a>\\n</span>\\n\\n<span class=\"subscribe-message\">\\n<p>Want tips to help you become more efficient, productive, and awesome?</p>\\n<p class=\"success\"><i class=\"fa fa-check\"></i>&nbsp;Great, welcome inside!</p>\\n<p>Enjoy some of the best workplace productivity advice around.</p>\\n</span>');window.JST[\"dashboard_create\"]=JST('<a href=\"#\" class=\"orange button\" data-nav=\"app/editor\">Make a New Zap</a> {{#unless isPartner}}<span class=\"alt-cta\">or <a href=\"#\" data-nav=\"app/explore\" title=\"Explore Zap templates to start with\">Explore Zaps</a></span>{{/unless}}');window.JST[\"dashboard_partner_zaps\"]=JST('<h2>Select {{service}} Zaps</h2>\\n\\n{{#each recipes}}\\n  <div class=\"zap-mini\">\\n\\n    <div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n    <div class=\"twrapper\">\\n      <div class=\"services\">\\n        <div class=\"service {{this.read_service_selected_api}}32x32\"></div>\\n        <span class=\"fa fa-caret-right caret\"></span>\\n        <div class=\"service {{this.write_service_selected_api}}32x32\"></div>\\n      </div>\\n      <div class=\"title\">{{this.short_description}}</div>\\n\\n      <div class=\"controls\">\\n        <div class=\"use-this\">\\n          <button data-template-id=\"{{this.id}}\">Use This</button>\\n        </div>\\n      </div>\\n    </div>\\n\\n  </div>\\n{{/each}}\\n\\n<br/>\\n\\n{{#if button}}\\n  <button data-nav=\"app/edit\" class=\"large\">Or create your own {{service}} Zap!</button>\\n{{/if}}');window.JST[\"dashboard_base\"]=JST('<!-- <div class=\"row\">\\n  <div class=\"container shave\">\\n    <h1 class=\"shave\">Zap Dashboard</h1>\\n  </div>\\n</div> -->\\n\\n<div class=\"row dashboard\">\\n  <div class=\"container empty\">\\n    <!-- sorry, we\\'ll come back to it... -->\\n    <!-- empty dashboard on partner -->\\n    <div class=\"column one-half left\"></div>\\n    <div class=\"column one-half right\"></div>\\n    <div class=\"clear\"></div>\\n  </div>\\n\\n  <div class=\"container\">\\n    <div class=\"column two-thirds main-col\">\\n      <div class=\"search\"></div>\\n      <div class=\"zaps\"></div>\\n      <div class=\"start\"></div>\\n    </div>\\n    <div class=\"column one-third side-col\">\\n    </div>\\n  </div>\\n</div>\\n');window.JST[\"dashboard_shared_zaps\"]=JST('{{#hasAtLeastOne z.app.recipes}}\\n  <h2>Zap Templates Shared With Others</h2>\\n\\n  <div class=\"shared-zaps\"></div>\\n{{else}}\\n  <div class=\"no-zaps inlay\">\\n    <h2>You haven\\'t shared any Zaps yet!</h2>\\n    <a class=\"pill-button orange huge\" href=\"/app/dashboard\" data-nav=\"app/dashboard\">Share one from the dashboard now</a>\\n  </div>\\n{{/hasAtLeastOne}}\\n');window.JST[\"common_rename_modal\"]=JST('<form>\\n<input type=\"text\" value=\"{{value}}\" placeholder=\"Name\" />\\n<button class=\"save orange\">Save</button>\\n<button class=\"close\">Cancel</button>\\n</form>');window.JST[\"common_base_modal\"]=JST('<div class=\"modal-container\">{{#unless noX}}<div class=\"x\"><i class=\"fa fa-times-circle\"></i></div>{{/unless}}<div class=\"modal invisible\"></div></div>');window.JST[\"common_data_table_modal\"]=JST('<table class=\"fields-table table table-bordered table-striped\">\\n{{#each data}}\\n  {{#notequals this.value \"[object Object]\"}}\\n    <tr>\\n      <td class=\"key\"><strong>{{this.key}}</strong></td>\\n      <td class=\"value\"><pre>{{this.value}}</pre></td>\\n    </tr>\\n  {{/notequals}}\\n{{/each}}\\n</table>');window.JST[\"common_auth_edit_modal\"]=JST('<ul>\\n  <li class=\"rename\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-pencil\"></span> Rename this Account</a></li>\\n  {{#unless onEditor}}\\n  <li class=\"delete\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-trash\"></span> Delete this Account</a></li>\\n  {{else}}\\n  <li class=\"manage\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-th-list\"></span> Manage your Accounts</a></li>\\n  {{/unless}}\\n</ul>');window.JST[\"common_since_you_been_gone_modal\"]=JST('<div class=\"row border\">\\n  <h1 class=\"center\">Good To See You Again!</h1>\\n  <p>We\\'ve been working hard to make your life easier. Here\\'s what\\'s new since you last visited...</p>\\n</div>\\n\\n<div class=\"blog\">\\n\\n{{#each updates}}\\n  <div class=\"entry border\">\\n    <div class=\"title\">\\n      <div class=\"service\">\\n        <div class=\"service img64 {{selected_api}}64x64\"></div>\\n      </div>\\n      <h2><a href=\"{{link}}\">{{title}}</a></h2>\\n    </div>\\n\\n    <div class=\"date\">{{prettyISO date}} by {{added_by_name}}</div>\\n\\n    {{{description_trunc}}}\\n  </div><!-- entry -->\\n{{/each}}\\n\\n</div><!-- blog -->\\n<br />\\n<a href=\"/zapbook/updates\">See more updates <i class=\"fa fa-arrow-right\"></i></a>');window.JST[\"common_recipe\"]=JST('<div class=\"recipe\">\\n\\n  <div class=\"images\">\\n    <div class=\"read\"><div class=\"img32 {{this.read_service_selected_api}}32x32\"></div></div>\\n    <div class=\"arrow\">&#9658;</div>\\n    <div class=\"write\"><div class=\"img32 {{this.write_service_selected_api}}32x32\"></div></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    <div class=\"description\"><a class=\"underline\" href=\"#\" data-id=\"{{this.id}}\">{{this.short_description}}</a></div>\\n  </div>\\n\\n  <a href=\"#\" data-id=\"{{this.id}}\"><button>Use This!</button></a>\\n\\n</div>');window.JST[\"common_share_zap_modal\"]=JST('<h1>Share This Zap Template!</h1>\\n\\n<p>Help your friends and colleagues save time by allowing them to use your Zap as a template to start with.</p>\\n<p>You\\'ll instantly be rewarded with <strong>50 FREE tasks/month</strong> for sharing!</p>\\n\\n<div class=\"services\">\\n  <div class=\"service\">\\n    <div class=\"service-icon {{readClass}}\"></div>\\n  </div>\\n  <i class=\"fa fa-caret-right caret\"></i>\\n  <div class=\"service\">\\n    <div class=\"service-icon write {{writeClass}}\"></div>\\n  </div>\\n</div>\\n<div class=\"zap-title\">{{try zapTitle \"Unnamed Zap\"}}</div>\\n\\n<div class=\"loading\">Loading fields...</div>\\n\\n<form class=\"share-it\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Share Zap Template\" class=\"big orange submit\" /> <span class=\"alt-cta\"><a class=\"no-thanks close\" title=\"Skip and close this window\">Skip this for now</a></span>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_auth_create_modal\"]=JST('<form class=\"auth\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Continue\" class=\"submit orange\" onclick=\"{{onclick}}\" /> &nbsp; <small>Having trouble connecting? Try <a href=\"/help/search/?{{{serviceHelpQueryString}}}\" target=\"_blank\">searching our help docs!</a></small>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_auth_request_modal\"]=JST('<p>This will send an email asking for permission for you to access their <strong>{{call service.getName context=service}}</strong> account. We\\'ll email you when they finish.</p>\\n<form class=\"auth\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Request Access\" class=\"submit orange\" />\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_run_zap_modal\"]=JST('<h2>Manually Running Zap Now...</h2>\\n<ul>\\n  {{#each messages}}\\n  <li class=\"{{#contains this \"failed\"}}error{{/contains}}\">{{this}}</li>\\n  {{else}}\\n  <li>Running {{title}}...</li>\\n  {{/each}}\\n</ul>\\n{{#if noItemsFound}}\\n{{/if}}');window.JST[\"common_auth_error_modal\"]=JST('{{#equals type \"manual\"}}\\n<h2>We received an error while testing</h2>\\n{{else}}\\n<h2>We hit an error adding your new account</h2>\\n{{/equals}}\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  {{#equals type \"manual\"}}<li>Delete and re-add this Account</li>{{/equals}}\\n  {{#if hasUpfronts}}\\n    <li>Make sure the values you type in are correct</li>\\n    <li>Watch out for trailing-spaces on API Keys or Codes</li>\\n  {{else}}\\n    <li>Make sure you click \"Allow\" or \"Accept\" on the permission popup</li>\\n    <li>Double check your Account has the correct permissions</li>\\n  {{/if}}\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"common_menu_modal\"]=JST('<ul>\\n   <li class=\"menu-settings\"><a href=\"/app/settings\" data-nav=\"app/settings\"><i class=\"fa fa-cog\"></i>Settings</a></li>\\n   <li class=\"menu-history\"><a href=\"/app/history\" data-nav=\"app/history\"><i class=\"fa fa-clock-o\"></i>Task History</a></li>\\n   <li class=\"menu-connected-accounts\"><a href=\"/app/settings/authorizations\" data-nav=\"app/settings/authorizations\"><i class=\"fa fa-bolt\"></i>Connected Accounts</a></li>\\n   <li class=\"menu-help\"><a href=\"/help/\"><i class=\"fa fa-medkit\"></i>Support</a></li>\\n   <li class=\"menu-developer\"><a href=\"/developer\"><i class=\"fa fa-flask\"></i>Developers</a></li>\\n   <li class=\"menu-logout\"><a href=\"/logout\"><i class=\"fa fa-power-off\"></i>Logout</a></li>\\n</ul>');window.JST[\"common_select_modal\"]=JST('<ul>\\n  {{#each choices}}\\n    <li><a href=\"#\" data-key=\"{{key}}\" data-value=\"{{value}}\">{{#if value}}{{value}}{{else}}(empty){{/if}}</a></li>\\n    {{else}}\\n    <li><a href=\"#\">(No values to pick from)</a></li>\\n  {{/each}}\\n</ul>');window.JST[\"common_service_picker_modal\"]=JST('<div class=\"top\">\\n  <h1>Pick a Service</h1>\\n  <input class=\"search\" type=\"text\" placeholder=\"Search services by name...\" value=\"{{search}}\"></input>\\n  <clear></clear>\\n  <a class=\"reset\" href=\"#\">clear</a>\\n</div>\\n\\n<div class=\"container\">\\n  <div class=\"selector-bg\"><ul class=\"selector\"></ul></div>\\n  <div class=\"scroll\"></div>\\n</div>');window.JST[\"common_auth_delete_message\"]=JST('Delete {{appNameFromKey service}} Account {{#if title}}\"{{title}}\"{{/if}}');window.JST[\"common_share_thanks_modal\"]=JST('<div class=\"center\">\\n<h2>Thank you for sharing!</h2>\\n<p>Share this Zap, and for each person who clicks<br>and signs up, you <i>both</i> get <strong>100 free tasks/month</strong>!</p>\\n\\n\\n<p><a href=\"{{twitter_href}}\" data-record-click=\"share twitter\" target=\"_blank\" title=\"Share this Zap on Twitter\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/twitter.png\" alt=\"twitter share\"></a><a href=\"{{facebook_href}}\" data-record-click=\"share facebook\" target=\"_blank\" title=\"Share this Zap on Facebook\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/facebook.png\" alt=\"facebook share\"></a><a href=\"{{linkedin_href}}\" data-record-click=\"share linkedin\" target=\"_blank\" title=\"Share this Zap on LinkedIn\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/linkedin.png\" alt=\"linkedin share\"></a><a href=\"{{email_href}}\" data-record-click=\"share email\" target=\"_blank\" title=\"Share this Zap via Email\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/email.png\" alt=\"email share\"></a></p>\\n\\n<p><input class=\"share-link\" type=\"text\" onclick=\"this.select();\" value=\"{{ recipe.share_url }}\"></p>\\n<p class=\"small\"><a href=\"{{ recipe.share_url }}\" target=\"_blank\">Open this link in a new window</a></p>\\n</div>');window.JST[\"common_login_modal\"]=JST('<form id=\"login-form\" autocomplete=\"on\" action=\"/login/?next={{path}}\" method=\"post\">\\n  <!-- the id of the form, login-form, is depended upon to sub in/out of the DOM -->\\n  <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\" />\\n  <input id=\"email\" name=\"email\" type=\"text\" class=\"account\" placeholder=\"Email\" autocomplete=\"on\" />\\n  <input id=\"password\" name=\"password\" type=\"password\" class=\"password\" placeholder=\"Password\" autocomplete=\"on\" />\\n  <input type=\"submit\" value=\"Log In\" />\\n  <span class=\"alt-cta\"><a href=\"/app/forgot\" data-nav=\"app/forgot\">Forgot your password?</a></span>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_upgrade_modal\"]=JST('<h2><i class=\"\"></i> You\\'ll need to upgrade to do that!</h2>\\n{{#if hasErrors}}\\n<ul class=\"because\">\\n  {{#each errors}}\\n    <li>{{this}}</li>\\n  {{/each}}\\n</ul>\\n{{/if}}\\n<a class=\"pill-button larger\" href=\"/app/settings/plans\" data-nav=\"app/settings/plans\">Click here to see which plan best suites you</a>\\n\\n{{#if hasErrors}}\\n{{else}}\\n<br/> \\n<h3>Common reasons you may need to upgrade</h3>\\n<ol>\\n  <li>You\\'re trying to enable a Zap which includes a Premium Service</li>\\n  <li>You have maxed out the number of live Zaps for your current plan</li>\\n  <li>You\\'re over your task limit for the month</li>\\n  <li>You\\'re trying to enable a Zap which includes an invite-only Developer App</li>\\n</ol>\\n{{/if}}\\n');window.JST[\"common_unpause_error_modal\"]=JST('<h2>We received an error turning this Zap on</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Double check your accounts for this Zap work (test them)</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"common_collect_email_modal\"]=JST('<h2>Sorry! This App Isn\\'t Available Yet</h2>\\n<p>New apps are added to Zapier often and we need you to tell us which ones you want most.</p>\\n<p>Add your email below and we\\'ll notify you when this app is ready to use in your Zaps. Your vote helps this app become available sooner.</p>\\n\\n<form id=\"login-form\" autocomplete=\"on\">\\n  <input id=\"email\" name=\"email\" type=\"text\" placeholder=\"Your email...\" autocomplete=\"on\" />\\n  <input type=\"submit\" value=\"Vote for this app!\" class=\"orange\" />\\n  <p class=\"feedback hide\"></p>\\n</form>\\n');window.JST[\"common_create_collection_modal\"]=JST('<div class=\"row\">\\n    <div class=\"container shave center\">\\n        <h1>Make Your Own Zap Widget</h1>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <h3>1. Select Zaps To Include</h3>\\n        <p>Choose which shared Zaps below to include in your widget.</p>\\n        <div class=\"results\"></div>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <h3>2. Preview Your Zap Widget</h3>\\n        <p>This is how your Zap widget will look on your website or blog.</p>\\n        <div class=\"embed\"></div>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <p><a class=\"button close orange\">Close Window</a></p>\\n    </div>\\n</div>');window.JST[\"common_auth_row\"]=JST(' <div class=\"pill-row-wrapper\">\\n\\n  <li class=\"auth pill-row {{#if selected}}selected{{/if}}\" id=\"{{id}}\">\\n\\n    <div class=\"radio\"></div>\\n\\n    <div class=\"icon\"><div class=\"img16 {{service}}16x16\"></div></div>\\n\\n    <div class=\"text name\">\\n      {{appNameFromKey service}}\\n    </div>\\n\\n    <div class=\"text description\">\\n      {{title}}\\n    </div>\\n\\n    <div class=\"clear\"></div>\\n  </li>\\n\\n  <div class=\"test {{#equals testStatus \"success\"}}success{{/equals}} {{#equals testStatus \"error\"}}error{{/equals}}\" id=\"{{id}}\">\\n    <div class=\"text-container\"><div class=\"text\">\\n      {{#equals testStatus null}}Test this Account{{/equals}}\\n      {{#equals testStatus \"testing\"}}Testing...{{/equals}}\\n      {{#equals testStatus \"slow\"}}Still testing...{{/equals}}\\n      {{#equals testStatus \"success\"}}Account is working!{{/equals}}\\n      {{#equals testStatus \"error\"}}Account not working{{/equals}}\\n    </div></div>\\n  </div>\\n\\n  <div class=\"gear\" id=\"{{id}}\">\\n    <div class=\"text-container\"><div class=\"text\">\\n    <img src=\"{{mediaURL}}images/frontend/gear.png\"></img>\\n    </div></div>\\n  </div>\\n\\n  </div> <!-- pill-row-wrapper -->');window.JST[\"common_service_panel\"]=JST('<li class=\"panel {{#if selected}}selected{{/if}}\" id=\"{{service}}\">\\n<div class=\"img64 {{service}}64x64\"></div>\\n<span>{{name}}</span>\\n</li>');window.JST[\"common_confirm_modal\"]=JST('<form>\\n<h2>Are you sure you want to do that?</h2>\\n<h3>{{message}}</h3>\\n<br />\\n<button class=\"yes\">Yes</button>\\n<button class=\"no orange\">No</button>\\n</form>');window.JST[\"support_contact_modal\"]=JST('<div class=\"header\">\\n\t<h1>Questions? We\\'re here to help!</h1>\\n\t<div class=\"picture-small\" title=\"Micah!\"><img src=\"{{ mediaUrl }}images/team/micah-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Wade!\"><img src=\"{{ mediaUrl }}images/team/wade-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Mike!\"><img src=\"{{ mediaUrl }}images/team/mike-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Bryan!\"><img src=\"{{ mediaUrl }}images/team/bryan-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"James!\"><img src=\"{{ mediaUrl }}images/team/james-square.jpg\"></img></div>\\n    <div class=\"picture-small\" title=\"Cooksey!\"><img src=\"{{ mediaUrl }}images/team/cooksey-square.jpg\"></img></div>\\n    <div class=\"picture-small\" title=\"Danny!\"><img src=\"{{ mediaUrl }}images/team/danny-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Al!\"><img src=\"{{ mediaUrl }}images/team/al-square.jpg\"></img></div>\\n</div>\\n\\n<paramform></paramform>\\n\\n<p class=\"feedback\"></p>\\n<p class=\"small\">Average response time: <strong>2h 37m</strong> during business hours (M-F 9am-5pm PST).</p>\\n<button class=\"submit\">Send Request</button>');window.JST[\"support_definition\"]=JST('{{{ text }}}\\n\\n{{#if slug}}\\n<a class=\"read-more\" href=\"/help/{{slug}}\">Learn more...</a>\\n{{/if}}');window.JST[\"support_base\"]=JST(\"<div>{{label}}</div>\");window.JST[\"support_note\"]=JST('<div class=\"support-note{{#if first}} first{{/if}}\">\\n  {{#if title}}<h1>{{title}}</h1>{{/if}}\\n  \\n  {{{html}}}\\n\\n  {{#if isStaff}}\\n    <div style=\"text-align:right\"><small><a href=\"/admin/support/note/{{id}}/\">edit this note</a></small></div>\\n  {{/if}}\\n  {{#if first}}{{#if more}}<div class=\"more\">Not exactly what you were looking for? We have some other possibly related sections below.</div>{{/if}}{{/if}}\\n</div>');window.JST[\"pricing_plans\"]=JST('<div class=\"row\">\\n  <div class=\"container shave center\">\\n    <h1>Pricing Plans</h1>\\n\\n    <div class=\"toggle toggle-interval\">\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"month\">Monthly</a>\\n      <div class=\"toggle-container{{#if monthly}}{{else}} on{{/if}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"year\">Yearly (1 Month Free)</a>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"row border\">\\n  <div class=\"container center\">\\n    <div class=\"plans\">\\n    {{#each plans}}\\n      <div class=\"plan\" data-plan=\"true\">\\n        <h2>{{get this \"name\"}}</h2>\\n        <div class=\"price\">\\n          ${{dollars}}<span class=\"sup\">/ {{get this \"interval\"}}</span>\\n        </div>\\n        <div class=\"features\">\\n          <ul>\\n            <li class=\"important\" data-explain-highlight=\"zaps\"><strong>{{zaps}}</strong> Zaps</li>\\n            <li class=\"important\" data-explain-highlight=\"interval\">Zaps run every <strong>{{pollInterval}} {{pollIntervalTimeFrame}}</strong></li>\\n            <li class=\"important\" data-explain-highlight=\"tasks\"><strong>{{tasksMo}}</strong> Tasks/month</li>\\n            {{#hasExactly this.blacklistedServices 0}}\\n              <li class=\"important\" data-explain-highlight=\"services\">Premium Services</li>\\n            {{/hasExactly}}\\n            {{#each this.extraFeatures}}\\n              <li class=\"important\">{{{title_html}}}</li>\\n            {{/each}}\\n          </ul>\\n        </div>\\n        {{#if \"\"}}<div class=\"get\">\\n          <button class=\"larger\" data-nav=\"app/signup\">{{#equals dollars 0}}Signup For Free{{else}}Start 14 Day Trial{{/equals}}</button>\\n        </div>{{/if}}\\n        <a class=\"big orange button\" data-nav=\"app/signup\">Start FREE Trial</a>\\n      </div>\\n    {{/each}}\\n    </div>\\n\\n    <p>Need more? <a href=\"mailto:contact@zapier.com\">Send us a message</a> and we can let you in on our enterprise plans.</p>\\n\\n  </div>\\n</div>\\n\\n{{JST \"pricing_about\"}}\\n');window.JST[\"pricing_base\"]=JST('<div class=\"pricing\"></div>');window.JST[\"pricing_about\"]=JST('<div class=\"row pricing-about\">\\n  <div class=\"container\">\\n    <div class=\"column one-half\">\\n      <h2>Confused By Plan Terms?</h2>\\n      <div class=\"block\">\\n        <h3>What\\'s a Zap?</h3>\\n        <p>A Zap is a link between two services (a \"trigger\" and an \"action\"). Zaps run automatically in the background every few minutes to move and manage data on your behalf. Only live Zaps count against your limit &mdash; you can have as many paused and unfinished Zaps as you\\'d like. For example, one Zap might be \"Send me an SMS every time I get a new email\".</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <span class=\"explainable\" data-explain=\"tasks\"></span><h3>What are Tasks?</h3>\\n        <p>A Task is counted every time we move a piece of data or take some action on your behalf during a pay period or month. If you set up a filter, we don\\'t count filtered items against your Task limit.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <span class=\"explainable\" data-explain=\"services\"></span><h3>What are Services?</h3>\\n        <p>A Service is a web service or app, such as Facebook, Gmail, or SalesForce. Zapier integrates with over 193 services and counting and lets you move data between them.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>What are Premium services?</h3>\\n        <p>Some services on Zapier are marked as \\'Premium\\'. To use these services in your zaps, you\\'ll need to have a paid plan.</p>\\n      </div>\\n    </div>\\n\\n    <div class=\"column one-half\">\\n      <h2>Have Questions?</h2>\\n      <div class=\"block\">\\n        <h3>Can I change my plan later on?</h3>\\n        <p>Yes, you can upgrade or downgrade at any time. If you choose to upgrade you\\'ll pay a pro-rated amount for the rest of the month. If you choose to downgrade you\\'ll be credited on next month\\'s bill.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>What if I decide to cancel?</h3>\\n        <p>If you no longer wish to use Zapier, you can cancel at any time. You will receive a pro-rated credit with Zapier for the remainder of that month\\'s billing cycle.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>Is phone support available?</h3>\\n        <p>We offer phone support to our Business Plus plan members. You can schedule a phone call with us for personal-level support during regular business hours.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>Do I need to know how to code?</h3>\\n        <p>No! Zapier makes it easy for you to move data between your web services without being a developer. We may need you to locate information for certain accounts (things like API keys), but we\\'ll guide you through any additional steps required.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>I have more questions. Who do I ask?</h3>\\n        <p>Check out our <a href=\"/support\">support page</a>, or you can email us at <a href=\"mailto:contact@zapier.com\">contact@zapier.com</a>.</p>\\n      <div class=\"block\">\\n    </div>\\n  </div>\\n</div>\\n');\nwindow.JST[\"developer_app_trigger_settings\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Trigger Settings</h1>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_global_activation\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Request Global Activation</h1>\\n\\n<br />\\n\\n<div class=\"developer-app-audit\"></div>\\n\\n{{#unless hasErrors}}\\n   <p>Provide us a little bit of info about your organization and a test account we can use to review the service.</p>\\n   <form class=\"paramform\"></form>\\n{{/unless}}\\n\\n<clear/>\\n<div>\\n  {{#unless hasErrors}}<button class=\"save big orange\">Send Request</button>{{/unless}}\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_digest_auth_empty_section\"]=JST(\"<p>Now that we know you are using Digest Auth, define some authentication fields that will ask the user for their username and password.\\n</p>\\n\");window.JST[\"developer_app_edit_trigger\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if trigger.label}}Edit Trigger: {{trigger.label}}{{else}}Create Trigger{{/if}}</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'appearance\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">1. Name and Description</a>\\n      {{else}}\\n         1. Name and Description\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/fields\">2. Trigger Fields</a>\\n      {{else}}\\n         2. Trigger Fields\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'backend\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/backend\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/backend\">3. Where Data Comes From</a>\\n      {{else}}\\n         3. Where Data Comes From\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'sample\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/sample\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/sample\">4. Sample Result</a>\\n      {{else}}\\n         4. Sample Result\\n      {{/if}}\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');window.JST[\"developer_app_auth_api_key_empty_section\"]=JST(\"<p>Now that we know you are using API Keys, define an authentication field that will ask the user for their key.\\n</p>\\n\");window.JST[\"developer_app_clone_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service was cloned.</p>\\n   <button class=\"close\">Go to clone</button>\\n</div>\\n');window.JST[\"developer_app_scripting\"]=JST('<textarea>{{app.js}}</textarea>\\n<div class=\"buttons\">\\n  <button class=\"save orange\">Save</button>\\n  <button class=\"links\">Quick links</button>\\n  <button class=\"go-back\">Back</button>\\n</div>');window.JST[\"developer_app_trigger_sample_result\"]=JST('<form class=\"paramform\"></form>\\n{{#unless isNew}}\\n<div class=\"sep\"></div>\\n<div id=\"override-container\">\\n   <p>This lets you give friendly names to your sample result data, as well as hide \"unimportant\", or especially unlikely to be useful, fields.</p>\\n</div>\\n{{/unless}}\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">{{#if isNew}}Parse Sample{{else}}Save{{/if}}</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_actions_empty_section\"]=JST('<p>\\nActions send data to your API. An action creates or updates a record with data provided by a trigger.\\n</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/create\"><i class=\"fa fa-plus-circle\"></i> Add Your First Action</a></p>');window.JST[\"developer_dashboard\"]=JST('<h1>Your Apps</h1>\\n\\n<p></p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/create\" data-nav=\"{{devpath}}/app/create\"><i class=\"fa fa-plus-circle\"></i> Add New App</a></p>\\n\\n<h2>Active <small>(Useable by anyone)</small></h2>\\n{{#if activeCount}}\\n   <table class=\"table active-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any active services.</p>\\n{{/if}}\\n\\n<h2>Invite Only <small>(Useable by invited users)</small></h2>\\n{{#if inviteCount}}\\n   <table class=\"table invite-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any active services.</p>\\n{{/if}}\\n\\n<h2>Pending <small>(Being reviewed by Zapier)</small></h2>\\n{{#if pendingCount}}\\n   <table class=\"table pending-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any pending services.</p>\\n{{/if}}\\n\\n<h2>Private <small>(Only usable by you)</small></h2>\\n{{#if privateCount}}\\n   <table class=\"table private-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any private services. <a href=\"/{{devpath}}/app/create\" data-nav=\"{{devpath}}/app/create\">Make one</a>!</p>\\n{{/if}}\\n');window.JST[\"developer_app_trigger_field_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\">{{field.label}}</a></td>\\n<td><code>{{field.key}}</code></td>\\n<td>\\n   {{#if field.prefill}}\\n      <code>{{field.prefill}}</code>\\n   {{else}}\\n      <em class=\"empty\">None</em>\\n   {{/if}}\\n</td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_auth_field_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\">{{field.label}}</a></td>\\n<td><code>{{field.key}}</code></td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n  <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\">\\n    <i class=\"fa fa-pencil\"></i> Edit\\n  </a>\\n  <a href=\"#\" class=\"delete button\">\\n     <i class=\"fa fa-times-circle\"></i>\\n     <span class=\"default\">Delete</span>\\n     <span class=\"confirm\">Really?</span>\\n  </a>\\n</td>\\n');window.JST[\"developer_app_action_fields\"]=JST('<p>Action Fields are the fields users will map data into.<p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add New Action Field</a></p>\\n\\n{{#if action.fields.length}}\\n   <table class=\"table action-fields\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Prefill</th>\\n         <th>Required</th>\\n         <th class=\"sort-column\">Sort</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{/if}}\\n\\n<div>\\n   <button class=\"save big orange\">Next</button>&nbsp;\\n   <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n   <span class=\"sort-errors red\"></span> <!-- sort is the only thing that saves here -->\\n</div>\\n');window.JST[\"developer_app_table_row\"]=JST('<td class=\"image-place\"><img style=\"width:32px;height:32px\" src=\"{{#if app.cropped_image_urls}}{{app.cropped_image_urls.32x32}}{{else}}{{ z.cfg.mediaURL }}images/frontend/placeholder/32x32.png{{/if}}\" alt=\"{{app.title}}\"/></td>\\n<td><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a></td>\\n<td>{{prettyStatus}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/\" data-nav=\"{{devpath}}/app/{{app.id}}/\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_confirm_invite_modal\"]=JST('<form>\\n  <h2>Are you sure you want to do that?</h2>\\n  <p>Enabling Invite-Only mode means you will no longer be able to make changes to your service.</p>\\n  <p>If you are trying to test your service, it is available to you right now if you go <a href=\"/app/editor\" target=\"_blank\">make a zap</a>.</p>\\n  <br />\\n  <button class=\"yes\">Enable</button>&nbsp; <a href=\"#\" class=\"no orange\">Close</a>\\n</form>\\n');window.JST[\"developer_app_actions\"]=JST('<h2>Actions <small>(Zapier sending data out)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Important</th>\\n         <th>Visible</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/create\"><i class=\"fa fa-plus-circle\"></i> Add New Action</a></p>\\n</div>\\n');window.JST[\"developer_app_auth_empty_section\"]=JST('<p>Defining how to authenticate is the first step in building your service.</p>\\n\\n<p><button data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/scheme\">Get Started <i class=\"fa fa-chevron-right\"></i></button></p>\\n');window.JST[\"developer_app_trigger_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">{{trigger.label}}</a></td>\\n<td><code>{{trigger.key}}</code></td>\\n<td>{{prettySource}}</td>\\n<td>{{#if trigger.important}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td>{{#if trigger.hide}}<i class=\"fa fa-ban red\"></i>{{else}}<i class=\"fa fa-check green\"></i>{{/if}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_migrate_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service has been migrated.</p>\\n   <button class=\"close\">Back to Service</button>\\n</div>\\n');window.JST[\"developer_app_revert_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service is now private. Make any edits you need to and then request global activation again.</p>\\n   <button class=\"close\">Reload</button>\\n</div>\\n');window.JST[\"developer_app_auth\"]=JST('<h2>Authentication <small>(Values needed to confirm identity)</small></h2>\\n\\n{{#equals app.auth_type 5}}\\n  <p>Your OAuth redirect URI is <code>https://zapier.com/dashboard/auth/oauth/return/{{app.key}}/</code>.</p>\\n{{/equals}}\\n\\n{{#equals app.auth_type 6}}\\n  <p>Your OAuth redirect URI is <code>https://zapier.com/dashboard/auth/oauth/return/{{app.key}}/</code>.</p>\\n{{/equals}}\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n        <th>Label</th>\\n        <th>Key</th>\\n        <th>Required</th>\\n        <th class=\"sort-column\">Sort</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add Authentication Field</a> <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/settings\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/settings\"><i class=\"fa fa-cog\"></i> Manage Authentication Settings</a> <a class=\"button save-sortable orange\" style=\"display:none\">Save Sorting</a> <span class=\"sort-errors red\"></span></p>\\n\\n   {{#if warnings.length}}\\n      <div class=\"warning\">\\n         <p>Things to do for this section:</p>\\n         <ul>\\n         {{#each warnings}}\\n            <li class=\"alert\">{{this}}</li>\\n         {{/each}}\\n         </ul>\\n      </div>\\n   {{/if}}\\n</div>\\n');window.JST[\"developer_app_stats\"]=JST('<h2>Statistics <small>(Site wide counts of users)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n        <th>Type</th>\\n        <th>Label</th>\\n        <th>Live</th>\\n        <th>Paused</th>\\n        <th>Total</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n</div>');window.JST[\"developer_app_trigger_fields\"]=JST('<p>Trigger fields define the pre-requirements needed in order to make a request. Theses are things like parent objects or search strings.<p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add New Trigger Field</a></p>\\n\\n{{#if trigger.fields.length}}\\n   <table class=\"table trigger-fields\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Prefill</th>\\n         <th>Required</th>\\n         <th class=\"sort-column\">Sort</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{/if}}\\n\\n<clear/>\\n<div>\\n   <button class=\"save big orange\">Next</button>&nbsp;\\n   <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n   <span class=\"sort-errors red\"></span> <!-- sort is the only thing that saves here -->\\n</div>\\n');window.JST[\"developer_app_edit_trigger_form\"]=JST('<form class=\"paramform\"></form>\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save &amp; Next</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_settings\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Authentication Settings</h1>\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_confirm_revert_modal\"]=JST('<form>\\n<h2>Are you sure you want to do that?</h2>\\n<h3>Reverting your service back to being private means you will have to make a new request for global activation.</h3>\\n<h3>If you realize your service is not ready to be made global, you should revert so you can continue working on it.</h3>\\n<br />\\n<button class=\"yes\">Revert to Private</button>\\n<button class=\"no orange\">Close</button>\\n</form>\\n');window.JST[\"developer_app_auth_editor_fields\"]=JST('<p>This is our best guess at what fields you will need. You may customize them as needed.</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/edit/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add Another Authentication Field</a></p>\\n\\n\\n<table class=\"table\">\\n   <thead>\\n     <th>Label</th>\\n     <th>Key</th>\\n     <th>Required</th>\\n     <th class=\"sort-column\">Sort</th>\\n     <th class=\"action-header\">Actions</th>\\n   </thead>\\n   <tbody>\\n     <!-- render here -->\\n   </tbody>\\n</table>\\n\\n<div>\\n  <button class=\"save big orange\">Next</button>&nbsp;\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_action_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">{{action.label}}</a></td>\\n<td><code>{{action.key}}</code></td>\\n<td>{{#if trigger.important}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td>{{#if action.hide}}<i class=\"fa fa-ban red\"></i>{{else}}<i class=\"fa fa-check green\"></i>{{/if}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_trigger_sample_override_form\"]=JST('Field Key: <code>{{key}}</code>\\n<form class=\"paramform\"></form>\\n<div class=\"sep\"></div>\\n');window.JST[\"developer_app_edit_action_form\"]=JST('<form class=\"paramform\"></form>\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save {{#notequals section \\'backend\\'}}&amp; Next{{/notequals}}</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_empty_fields\"]=JST('<p>Now go make some fields!</p>\\n<p>TODO: bcooksey Write some real instructions</p>\\n<a href=\"/{{devpath}}/app/{{app.id}}/auth/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/create\"><i class=\"fa fa-plus-circle\"></i>Add Field</a>\\n<div>\\n  <button class=\"save big orange\">Next</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_action_field_table_row\"]=JST('<td>\\n   <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\">{{field.label}}</a>\\n</td>\\n<td><code>{{field.key}}</code></td>\\n<td>\\n   {{#if field.prefill}}\\n      <code>{{field.prefill}}</code>\\n   {{else}}\\n      <em class=\"empty\">None</em>\\n   {{/if}}\\n</td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_invite\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Email Invites</h1>\\n<br/>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Send</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_scripting_menu\"]=JST('<ul class=\"scripting-menu\">\\n  <li><a class=\"logs\" href=\"/{{devpath}}/app/{{app.id}}/requests\" data-nav=\"{{devpath}}/app/{{app.id}}/requests\">\\n    <i class=\"fa fa-bars\"></i> Request Logs\\n  </a></li>\\n  <li><a href=\"/developer/scripting/\" class=\"docs\" target=\"_new\">\\n    <i class=\"fa fa-question-circle\"></i> Scripting Docs\\n  </a></li>\\n</ul>');window.JST[\"developer_app_confirm_global_modal\"]=JST('<form>\\n  <h2>Are you sure you want to do that?</h2>\\n  <p>Requesting global activation means you will no longer be able to make changes.</p>\\n  <p>If you are trying to test your service, it is available to you right now if you go <a href=\"/app/editor\" target=\"_blank\">make a zap</a>.</p>\\n  <br />\\n  <button class=\"yes\">Continue to request form</button>&nbsp; <a href=\"#\" class=\"no orange\">Close</a>\\n</form>\\n');window.JST[\"developer_app_auth_choose_scheme\"]=JST('<p>Which authentication scheme does your your API use:</p>\\n<p>\\n   <button id=\"use-basic-auth\">Basic Auth</button>\\n   <button id=\"use-api-key\">API Keys</button>\\n   <button id=\"use-oauthv2\">OAuth v2</button>\\n   <button id=\"use-digest-auth\">Digest Auth</button>\\n</p>\\n\\n<div id=\"api-key-sub-type\" style=\"display: none;\">\\n   <p>Does the API Key go in the HTTP Headers or Querystring?</p>\\n   <p>\\n      <button value=\"3\">Headers</button>\\n      <button value=\"2\">Querystring</button>\\n   </p>\\n</div>\\n<div id=\"oauthv2-sub-type\" style=\"display: none;\">\\n   <p>Will Zapier need to refresh the access token on a regular basis?</p>\\n   <p>\\n      <button value=\"6\">Yes, setup refresh</button>\\n      <button value=\"5\">No, original will do</button>\\n   </p>\\n   <p>Your OAuth redirect URI is <code>https://zapier.com/dashboard/auth/oauth/return/{{app.key}}/</code>.</p>\\n</div>\\n\\n<br/>\\n\\n<div>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_triggers_empty_section\"]=JST('<p>\\nTriggers read data in from your API. A trigger focuses on a particular event that happens, say a new Contact or Order being created, and provides the relavant data so that users can take action on that event (like get an email notification with details about the newly created contact/order). \\n</p>\\n\\n<p>You will need one <strong>test trigger</strong> so we can test the credentials users provide in the authentication fields. Usually this is a <code>/ping</code> or <code>/user</code> endpoint.</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/create/test\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/create/test\"><i class=\"fa fa-plus-circle\"></i> Add Your First Test Trigger</a></p>');window.JST[\"developer_app_edit_auth_field\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if field.label}}Edit Auth Field: {{field.label}}{{else}}Create Auth Field{{/if}}</h1>\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}{{#if isWizard}}/auth/edit/fields{{/if}}\" data-nav=\"{{devpath}}/app/{{app.id}}{{#if isWizard}}/auth/edit/fields{{/if}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_auth_editor\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Setup Authentication</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'scheme\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/scheme\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/scheme\">1. Choose Authentication Scheme</a>\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/fields\">2. Create Auth Fields</a>\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'mapping\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/mapping\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/mapping\">3. Map Fields to Request Parameters</a>\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');window.JST[\"developer_app_requests\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Request Log</h1>\\n<br />\\n\\n<div id=\"request-log-controls\">\\n   <button>Refresh</button>\\n</div>\\n\\n<div id=\"request-log\"></div>\\n');window.JST[\"developer_app_meta\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; {{#if app.title}}<a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;{{/if}}</span> {{#if app.title}}Edit General Info{{else}}Create Service{{/if}}</h1>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/{{#if app.id}}app/{{app.id}}{{/if}}\" data-nav=\"{{devpath}}/{{#if app.id}}app/{{app.id}}{{/if}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_audit\"]=JST('{{#hasAtLeastOne errors}}\\n<p>Looks like your service has some errors. Look over the list below before you submit your service. They are automatically generated, so if you see something odd or unfixable, <a href=\"mailto:contact@zapier.com\">just contact us</a>!</p>\\n\\n<div id=\"app-errors\">\\n   <h3>Errors</h3>\\n   <ul>\\n   {{#each errors}}\\n      <li>\\n         <strong>{{name}}</strong>\\n         <ul>\\n         {{#each errors}}\\n            <li>{{message}}</li>\\n         {{/each}}\\n         </ul> \\n      </li>\\n   {{/each}}\\n   </ul>\\n</div>\\n{{/hasAtLeastOne}}\\n\\n{{#hasAtLeastOne warnings}}\\n<div id=\"app-warnings\">\\n   <h3>Warnings</h3>\\n   <ul>\\n   {{#each warnings}}\\n      <li>\\n         <strong>{{name}}</strong>\\n         <ul>\\n         {{#each warnings}}\\n            <li>{{message}}</li>\\n         {{/each}}\\n         </ul> \\n      </li>\\n   {{/each}}\\n   </ul>\\n</div>\\n{{/hasAtLeastOne}}\\n');window.JST[\"developer_app_triggers\"]=JST('<h2>Triggers <small>(Bringing data into Zapier)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Source</th>\\n         <th>Important</th>\\n         <th>Visible</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/create\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/create\"><i class=\"fa fa-plus-circle\"></i> Add New Trigger</a> <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/settings\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/settings\"><i class=\"fa fa-cog\"></i> Manage Trigger Settings</a></p>\\n\\n   {{#if app.warnings.test_trigger}}\\n      <div class=\"warning\">\\n         <p>Things to do for this section:</p>\\n         <ul>\\n            <li class=\"alert\">{{app.warnings.test_trigger}}</li>\\n         </ul>\\n      </div>\\n   {{/if}}\\n</div>');window.JST[\"developer_app_auth_basic_auth_empty_section\"]=JST(\"<p>Now that we know you are using Basic Auth, define some authentication fields that will ask the user for their username and password.\\n</p>\\n\");window.JST[\"developer_app_auth_editor_form\"]=JST('<form class=\"paramform\"></form>\\n<div>\\n  <button class=\"save big orange\">Save</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_edit_action_field\"]=JST('<h1>{{#if field.label}}Edit Action Field: {{field.label}}{{else}}Create Action Field{{/if}}</h1>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Done</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_migrate\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Service Migration</h1>\\n\\n<div class=\"developer-app-audit\"></div>\\n\\n{{#unless hasErrors}}\\n   <p>This app looks ready to become active!</p>\\n{{/unless}}\\n\\n<clear/>\\n<div>\\n  {{#unless hasErrors}}<button class=\"save big orange\">Migrate service</button>{{/unless}}\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}/migrate\" data-nav=\"{{devpath}}/app/{{app.id}}/migrate\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_edit_trigger_field\"]=JST('<h1>{{#if field.label}}Edit Trigger Field: {{field.label}}{{else}}Create Trigger Field{{/if}}</h1>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Done</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_global_activation_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. We\\'ll be in touch soon.</p>\\n   <button class=\"close\">Back to Service</button>\\n</div>\\n');window.JST[\"developer_app_invite_activation_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service is now Invite-only.</p>\\n   <button class=\"close\">Reload</button>\\n</div>\\n');window.JST[\"developer_app_edit_action\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if action.label}}Edit Action: {{action.label}}{{else}}Create Action{{/if}}</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'appearance\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">1. Name and Description</a>\\n      {{else}}\\n         1. Name and Description\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/fields\">2. Action Fields</a>\\n      {{else}}\\n         2. Action Fields\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'backend\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/backend\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/backend\">3. Where To Send Data</a>\\n      {{else}}\\n         3. Where To Send Data\\n      {{/if}}\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');\nwindow.JST[\"developer_app\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656;</span> {{app.title}}</h1>\\n\\n<div class=\"column two-thirds\" style=\"padding-left:0;\"> <!-- uuugh inline styles. unfortunately doing row/column in all developer views would be a *lot* -->\\n  <div class=\"section service-feature\">\\n    <div class=\"service-icon-large\">\\n      <img src=\"{{#if app.cropped_image_urls}}{{app.cropped_image_urls.64x64}}{{else}}{{ z.cfg.mediaURL }}images/frontend/placeholder/64x64.png{{/if}}\" alt=\"GitHub integration logo\">\\n    </div>\\n    <div class=\"description\">\\n      <p>{{app.description}}</p>\\n      <p><a {{#if isEditable}}class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/meta\" data-nav=\"{{devpath}}/app/{{app.id}}/meta\"{{else}}class=\"button disabled\"{{/if}}><i class=\"fa fa-cog\"></i> Edit Title, Image or Description</a></p>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"column one-third side-col\" style=\"padding-right:0;\"> <!-- uuugh inline styles?!? -->\\n  <div class=\"widget\">\\n    <h3>Status</h3>\\n    <p><strong>{{#equals app.status 0}}Private{{/equals}}{{#equals app.status 1}}Under Review{{/equals}}{{#equals app.status 2}}Invite Only{{/equals}}{{#equals app.status 3}}Global{{/equals}}</strong> - <em>{{#equals app.status 0}}private apps can be used just like any app on Zapier, except only you can see them{{/equals}}{{#equals app.status 1}}we\\'ll get back to your as soon as possible!{{/equals}}{{#equals app.status 2}}invite apps can be used just like any app on Zapier,\\n    but only by those who have the link{{/equals}}{{#equals app.status 3}}global apps are apps that anyone on Zapier can see and use{{/equals}}.</em></p>\\n  </div>\\n</div>\\n\\n<clear/>\\n<br/>\\n\\n<div class=\"all-wrapper\">\\n  <!-- stats/auths/triggers/actions rendered here! -->\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Scripting API <small>(Modify Zapier\\'s default behavior)</small></h2>\\n   <div class=\"section-content\">\\n      {{#if isActive}}\\n         <p>Scripting API is disabled for global or invite only services. <a href=\"#\">Read the docs.</a></p>\\n      {{else}}\\n         <p>You can write javascript code that can modify data that comes in and goes out of our system. <a href=\"#\">Read the docs.</a>\\n         </p>\\n      {{/if}}\\n      {{#if isEditable}}\\n         <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/scripting\" data-nav=\"{{devpath}}/app/{{app.id}}/scripting\"><i class=\"fa fa-code\"></i> Edit Code</a></p>\\n      {{else}}\\n         <button class=\"disabled\"><i class=\"fa fa-code\"></i> Edit Code</button>\\n      {{/if}}\\n   </div>\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Request Log <small>(A stream of all outbound and inbound HTTP)</small></h2>\\n   <div class=\"section-content\">\\n      {{#if isActive}}\\n         <p>Logs are disabled for active services. <a href=\"#logged-requests\">Read the docs.</a></p>\\n      {{else}}\\n         <p>A list of all recent development HTTP requests. <a href=\"#logged-requests\">Read the docs.</a></p>\\n      {{/if}}\\n      {{#if isEditable}}\\n         <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/requests\" data-nav=\"{{devpath}}/app/{{app.id}}/requests\"><i class=\"fa fa-clock-o\"></i> See HTTP Log</a></p>\\n      {{else}}\\n         <button class=\"disabled\"><i class=\"fa fa-clock-o\"></i> See HTTP Log</button>\\n      {{/if}}\\n   </div>\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Status <small>(Who can use your service)</small><a id=\"status-section\"></a></h2>\\n   <div class=\"section-content\">\\n      {{#equals app.status 0}}\\n      <p>Your service is currently private, which means only you can use it.</p>\\n      <p>To allow others access, you need to do one of the following:\\n        <ol>\\n           <li><a id=\"make-global\" href=\"#\">Request global activation</a></li>\\n           <li><a id=\"enable-invite\" href=\"#\">Enable invite-only activation</a></li>\\n           <li><a href=\"/{{devpath}}/app/{{app.id}}/migrate\" data-nav=\"{{devpath}}/app/{{app.id}}/migrate\">Migrate and replace an existing Service</a></li>\\n        </ol>\\n      </p>\\n      If at any time you want to make a copy of your service, you can <a id=\"clone-app\" href=\"#\">clone your service</a>.\\n      {{/equals}}\\n\\n      {{#equals app.status 1}}\\n         <p>Your service is waiting to be reviewed by Zapier. At this point, you can rest easy and wait for us to schedule a demo call with you. You can also get a head start thinking about your service\\'s launch by checking out these articles:</p>\\n         <ol>\\n             <li><a href=\"/help/partner-pre-launch-checklist/\">Five Prep Steps for Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-checklist/\">Three Ingredients of a Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-zapier/\">How Zapier Promotes the Launch</a></li>\\n         </ol>\\n         <p>If you need to make a change, you can <a id=\"revert-app\" href=\"#\">revert back to private</a>. You\\'ll make your changes, then submit for global activation again.</p>\\n      {{/equals}}\\n\\n      {{#equals app.status 2}}\\n         <p>Your service is invite-only. At this point, you can invite users to to use your service. Only people you have explicitly invited will be able to use your service on Zapier.</p>\\n         <!-- <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/invite\" data-nav=\"{{devpath}}/app/{{app.id}}/invite\"><i class=\"fa fa-share\"></i> Invite User via Bulk Email</a></p> -->\\n         <p>You can invite users by sharing this link:</p>\\n         <p><input type=\"text\" onclick=\"this.select();\" value=\"{{app.share_url}}\" style=\"width:570px\"></p>\\n         <p>To make changes to your service, you need to <a id=\"clone-app\" href=\"#\">clone this service</a> and then perform a migration. <a href=\"#\">Read the docs</a>.</p>\\n      {{/equals}}\\n\\n      {{#equals app.status 3}}\\n         <p>Your service is global, which means anyone can use it. If your service has not had its official Zapier launch, now is a good time to work on conent for the launch. Here are a few articles that explain the process:</p>\\n         <ol>\\n             <li><a href=\"/help/partner-pre-launch-checklist/\">Five Prep Steps for Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-checklist/\">Three Ingredients of a Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-zapier/\">How Zapier Promotes the Launch</a></li>\\n         </ol>\\n         <p>To make changes to your service, you need to <a id=\"clone-app\" href=\"#\">clone this service</a> and then perform a migration. <a href=\"#\">Read the docs</a>.</p>\\n      {{/equals}}\\n   </div>\\n</div>\\n');window.JST[\"developer_base\"]=JST('<div class=\"row developer\">\\n  <div class=\"container developer-content\">\\n      \\n  </div>\\n</div>\\n');window.JST[\"developer_app_invite_success_modal\"]=JST('<div class=\"center\">\\n   <p>{{numSent}} I{{#plural count=numSent}}nvite{{/plural}} Sent.</p>\\n   <button class=\"close\">Close</button>\\n</div>\\n');window.JST[\"developer_app_stats_table_row\"]=JST(\"<td>{{stat.Type}}</td>\\n<td>{{stat.Label}}</td>\\n<td>{{stat.Live}}</td>\\n<td>{{stat.Paused}}</td>\\n<td>{{stat.Total}}</td>\");window.JST[\"developer_app_migrate_choose_target\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Service Migration</h1>\\n\\n<p>A migration is the process used to deploy an updated versions of your app. If you think this app is ready to become the new active version, select an app for it to replace and click next.</p>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Next</button>&nbsp;\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"editor_userfill_modal\"]=JST('{{#if missing}}\\n  <div class=\"empty\">\\n    <button class=\"missing light smaller\"><i class=\"fa fa-exclamation-circle\"></i>\\n      We\\'re using <strong>fake</strong> data. Load real data here.\\n    </button>\\n  </div>\\n{{else}}\\n  {{#hasAtLeastOne choices}}\\n  <div class=\"search\">\\n    <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n  </div>\\n  {{/hasAtLeastOne}}\\n{{/if}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match...</div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n    {{#if this.type}}data-type=\"{{this.type}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">{{#ellipsis 50}}{{this.display}}{{/ellipsis}} <span class=\"sample\">{{this.val}}</span></a>\\n  </li>\\n  {{/each}}\\n</ul>');window.JST[\"editor_selectfill_modal\"]=JST('<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match <strong>{{search}}</strong></div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">\\n      {{#if ../fancychoices}}\\n        {{#ellipsis 30}}{{this.display}}{{/ellipsis}}\\n      {{else}}\\n        {{this.display}}\\n      {{/if}}\\n      {{#unless ../hideRawValue }}<span class=\"sample\">{{this.val}}</span>{{/unless}}\\n    </a>\\n  </li>\\n  {{/each}}\\n\\n  {{#if fancychoices}}\\n    <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n    <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value<span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n    <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/if}}\\n</ul>\\n');window.JST[\"editor_hook_error_modal\"]=JST('<h2>We received an error connecting to {{appNameFromKey key}}</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Make sure you have followed all on-screen directions, in order</li>\\n  <li>Test your {{serivce}} Account again</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"editor_service_action\"]=JST('{{#unless isPartner}}<p class=\"big\">Need inspiration? <a href=\"/app/explore\" data-nav=\"app/explore\">Explore existing Zap templates to get you started.</a></p>{{/unless}}\\n\\n<div class=\"picker\">\\n\\n  <div class=\"trigger\">\\n    <select id=\"trigger-service\" data-placeholder=\"Choose a Trigger service...\">\\n      <option></option> <!-- placeholder -->\\n      {{#each readServices}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n    <div class=\"picker actions\">\\n    <div class=\"trigger\">\\n      <select id=\"trigger\" data-placeholder=\"Choose a Trigger...\">\\n        <option></option> <!-- placeholder -->\\n        {{#each readActions}}\\n        <option value=\"{{key}}\" data-help=\"{{help_text_html}}\">{{label}}</option>\\n        {{/each}}\\n        {{#if showTriggerExpand}}<option value=\"showAll\">Show all triggers</option>{{/if}}\\n      </select>\\n      <img class=\"helper\" src=\"{{mediaURL}}images/arrows/trigger.png\" />\\n    </div>\\n    </div>\\n\\n  </div>\\n\\n  <div class=\"arrow\"><i class=\"fa fa-caret-right\"></i></div>\\n\\n  <div class=\"action\">\\n    <select id=\"action-service\" data-placeholder=\"Choose an Action service...\">\\n      <option></option> <!-- placeholder -->\\n      {{#each writeServices}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n\\n    <div class=\"actions\">\\n      <select id=\"action\" data-placeholder=\"Choose an Action...\">\\n        <option></option> <!-- placeholder -->\\n        {{#each writeActions}}\\n        <option value=\"{{key}}\" data-help=\"{{help_text_html}}\">{{label}}</option>\\n        {{/each}}\\n        {{#if showActionExpand}}<option value=\"showAll\">Show all actions</option>{{/if}}\\n      </select>\\n      <img class=\"helper\" src=\"{{mediaURL}}images/arrows/action.png\" />\\n    </div>\\n  </div>\\n\\n</div>\\n\\n{{#if flow}}\\n<button class=\"continue\">Continue</button>\\n\\n<span class=\"partner-feedback hide\">To create a Zap without {{partnerService}} in it, you\\'ll need to go to <a target=\"_new\" href=\"https://zapier.com/\">Zapier.com</a></span>\\n{{/if}}');window.JST[\"editor_enable\"]=JST('{{#if isHook}}\\n  <p class=\"big\">This Zap is instant. It will trigger immediately when we receive a new {{appNameFromKey readService.id}} {{call readService.getActionName read.action \"read\" \"true\" context=readService}}.</p>\\n{{else}}\\n  <p class=\"big\">This Zap will automatically check for new {{appNameFromKey readService.id}} {{#plural}}{{call readService.getActionName read.action \"read\" \"true\" context=readService}}{{/plural}} every <i class=\"fa fa-clock-o\"></i> {{polling}} minutes.</p>\\n{{/if}}\\n\\n<div class=\"paramform\">\\n  <div class=\"field\">\\n    <div class=\"label\">Name this Zap:</div>\\n    <div class=\"input\">\\n      <input class=\"xlarge title\" type=\"text\" name=\"title\" placeholder=\"Name this Zap...\" value=\"{{#unless flow}}{{title}}{{/unless}}\" />\\n    </div>\\n  </div>\\n</div>\\n\\n{{#hasAtLeastOne errors}}\\n  <h3>Please fix the following errors before enabling:</h3>\\n  <ul>\\n  {{#each ../errors}}<li class=\"error\">{{this}}</li>{{/each}}\\n  </ul>\\n{{/hasAtLeastOne}}\\n\\n<p><button class=\"enable big orange {{#hasAtLeastOne errors}}disabled{{/hasAtLeastOne}}\">Turn Zap on</button></p>\\n');window.JST[\"editor_custom_filter_row\"]=JST('<div class=\"index\" href=\"rule-{{index}}\">{{index}}</div>\\n\\n<paramform></paramform>\\n\\n<div class=\"stack add-or-remove\">\\n   <div class=\"add\" data-group=\"{{group}}\"></div>\\n   <div class=\"remove\"></div>\\n</div>\\n\\n<div class=\"stack\"></div>\\n\\n<div class=\"stack label\">\\n   <span class=\"and\">AND</span>\\n</div>');window.JST[\"editor_steps\"]=JST('<!-- none_visible title_visible all_visisble -->\\n\\n<step class=\"{{services-actions}}\" data-id=\"services-actions\">\\n  <div class=\"row\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"1\" disabled=\"disabled\"></input></span>\\n      <h2>Choose a trigger and action</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{trigger-auth}}\" data-id=\"trigger-auth\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"2\" disabled=\"disabled\"></input></span>\\n      <h2>Select a <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} account {{#equals read.selected_api write.selected_api}}(Trigger){{/equals}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{action-auth}}\" data-id=\"action-auth\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"3\" disabled=\"disabled\"></input></span>\\n      <h2>Select a <i class=\"img32 {{write.selected_api}}32x32\"></i> {{appNameFromKey write.selected_api}} account {{#equals read.selected_api write.selected_api}}(Action){{/equals}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{filters}}\" data-id=\"filters\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"4\" disabled=\"disabled\"></input></span>\\n      <h2>Filter <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} triggers</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{map}}\" data-id=\"map\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"5\" disabled=\"disabled\"></input></span>\\n      <h2>Match up <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} {{#if readAction}}{{readAction}}{{/if}} to <i class=\"img32 {{write.selected_api}}32x32\"></i> {{appNameFromKey write.selected_api}} {{#if writeAction}}{{writeAction}}{{/if}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{test}}\" data-id=\"test\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"6\" disabled=\"disabled\"></input></span>\\n      <h2>Test this Zap</i></h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{enable}}\" data-id=\"enable\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"7\" disabled=\"disabled\"></input></span>\\n      <h2>Name and turn this Zap on</i></h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n{{#unless flow}}{{#if ../read.paused}}\\n<div class=\"row paused\">\\n    <div class=\"container\">\\n      This Zap is off while you edit.\\n      {{#if ../hasErrors}}\\n        <i>Complete the steps above to turn it back on.</i>\\n      {{else}}\\n        <a href=\"#\" class=\"unpause button\">Turn it back on!</a>\\n      {{/if}}\\n  </div>\\n</div>\\n{{/if}}{{/unless}}');window.JST[\"editor_missing_data_modal\"]=JST('{{#initConnection}}\\n  <div class=\"loading\">Connecting to {{appNameFromKey read.selected_api}}...</div>\\n{{else}}\\n\\n  <div class=\"title\">\\n    <h2><i class=\"fa fa-exclamation-circle\"></i> We couldn\\'t get any samples from {{appNameFromKey read.selected_api}}</h2>\\n  </div>\\n\\n  <ol>\\n    {{#and isHook notSubHook}}\\n    <li class=\"{{#less step 1}}fade{{/less}} {{#equals step 1}}active{{/equals}}\">\\n      {{{call service.getWebhookDirections action \"read\" context=service}}}\\n\\n      <div class=\"label\">Make sure this is your Webhook URL:</div>\\n      <div class=\"table-wrapper fill\">\\n        <div class=\"table-cell column\">\\n          <input class=\"webhook-url\" type=\"text\" value=\"{{call service.getWebhookURL action \"read\" readModel context=service}}\" data-id=\"webhook-url\" readonly/>\\n        </div>\\n        <div class=\"table-cell vcenter\">\\n          <button class=\"copy-button\" data-clipboard-text=\"{{call service.getWebhookURL action \"read\" readModel context=service}}\">Copy to clipboard</button>\\n        </div>\\n      </div>\\n\\n      <button data-step=\"1\" class=\"continue {{#greater step 1}}disabled{{/greater}}\">Ok, I did this</button>\\n    </li>\\n    {{/and}}\\n\\n    <li class=\"{{#less step 2}}fade{{/less}} {{#equals step 2}}active{{/equals}}\">\\n      <p>{{#copyOverride service read.action \"read\" \"no_sample_dirs\"}}\\n      Go create a <em><strong>brand new</strong></em> {{call service.getActionName read.action \"read\" \"true\" context=service}} in {{appNameFromKey read.selected_api}}, then come back to Zapier. <em>Don\\'t close this popup!</em>\\n      {{/copyOverride}}</p>\\n\\n      {{#hasAtLeastOne filters}}\\n      <table class=\"fields-table table-bordered\">\\n        {{#each filters}}\\n        <tr>\\n          <td class=\"key\">{{this.k}}:</td>\\n          <td class=\"value\">{{this.v}}</td>\\n        </tr>\\n        {{/each}}\\n      </table>\\n      {{/hasAtLeastOne}}\\n\\n      <button data-step=\"2\" class=\"continue load {{#greater step 2}}disabled{{/greater}}\">Ok, I did this</button>\\n    </li>\\n\\n    <li class=\"{{#less step 3}}fade{{/less}} {{#equals step 3}}active{{/equals}}\">\\n\\n      {{#if isHook}}\\n      <p>Zapier is now waiting for your changes to make their way back to our server.</p>\\n      <span class=\"loading loading-samples\">Waiting anxiously...</span>\\n      <span class=\"found-samples success\"><i class=\"fa fa-check green\"></i>&nbsp;We found your changes!</span>\\n      {{else}}\\n      <p>Have Zapier get the {{call service.getActionName read.action \"read\" \"true\" context=service}} you just created.</p>\\n      <button data-step=\"3\" class=\"continue {{#greater step 3}}disabled{{/greater}}\">Get {{#plural}}{{call service.getActionName read.action \"read\" \"true\" context=service}}{{/plural}}</button>\\n      <span class=\"no-samples\"><i class=\"fa fa-exclamation-circle red\"></i> We couldn\\'t it yet! Please try again and <em>don\\'t close this popup!</em></span>\\n      {{/if}}\\n    </li>\\n\\n    <li class=\"{{#less step 4}}fade{{/less}} {{#equals step 4}}active{{/equals}}\">\\n      {{#unless isHook}}\\n      <p>Great, we found it!</p>\\n      {{/unless}}\\n      <button data-step=\"4\" class=\"submit\">All done!</button>\\n    </li>\\n  </ol>\\n{{/initConnection}}');window.JST[\"editor_givefill_modal\"]=JST('{{#hasAtLeastOne choices}}\\n<div class=\"search\">\\n  <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n</div>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match <strong>{{search}}</strong></div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">\\n      {{#if ../fancychoices}}\\n        {{#ellipsis 30}}{{this.display}}{{/ellipsis}}\\n      {{else}}\\n        {{this.display}}\\n      {{/if}}\\n      {{#unless ../hideRawValue }}<span class=\"sample\">{{this.val}}</span>{{/unless}}\\n    </a>\\n  </li>\\n  {{/each}}\\n\\n  {{#if fancychoices}}\\n    <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n    <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value<span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n    <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/if}}\\n</ul>\\n');window.JST[\"editor_filter\"]=JST('{{#if show}}\\n  <p class=\"big\">Only trigger a \"{{call service.getActionName read.action \"read\" \"false\" context=service}}\" from {{appNameFromKey read.selected_api}} when...</p>\\n\\n  <paramform class=\"top-margin\"></paramform>\\n\\n  <div class=\"loading-fields\">Loading fields...</div>\\n  <div class=\"loading-error\">\\n    <p><i class=\"fa fa-exclamation-circle\"></i> We had trouble loading some fields!</p>\\n    <button class=\"retry-fields\">Try again?</button>\\n  </div>\\n\\n  <p class=\"big custom-filter-helper\">Add filters based on other {{appNameFromKey read.selected_api}} fields.</p>\\n\\n  {{#hasExactly rules 0}}\\n    <div class=\"show-custom\"><button class=\"add\">Add custom filters</button></div>\\n    {{else}}\\n    <a id=\"custom-filters\"></a>\\n    <h3>Custom Filters</h3>\\n  {{/hasExactly}}\\n\\n  <div class=\"custom paramform\">\\n    <div class=\"groups\"></div>\\n    {{#hasAtLeastOne rules}}<button class=\"or\">Add OR Filter</button>{{/hasAtLeastOne}}\\n  </div>\\n\\n  {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_test\"]=JST('{{#if show}}\\n\\n  {{#hasAtLeastOne samples}}\\n  {{else}}\\n    <p class=\"big\">Click the button below to test your trigger and get sample data.</p>\\n    <p><button class=\"load {{#hasAtLeastOne samples}}orange{{/hasAtLeastOne}}\" href=\"#\">\\n      <span class=\"img16 {{#if readService}}{{readService.id}}16x16{{else}}placeholder{{/if}}\"></span> Test {{appNameFromKey readService.id}} trigger\\n    </button></p>\\n  {{/hasAtLeastOne}}\\n\\n  {{#hasAtLeastOne samples}}\\n  <p class=\"big\">Select a sample to test with.</p>\\n\\n      <div class=\"samples\">\\n        {{#each samples limit=3}}\\n          <div class=\"sample\">\\n            <h3>Sample #{{this.num}}</h3>\\n            <div class=\"sample-modal-link\">\\n              <div class=\"service {{../readService.id}}32x32\" title=\"[Service name]\"></div>\\n              <a href=\"#\" data-sample-read-id=\"{{this.[_idx]}}\">See trigger sample.</a>\\n            </div>\\n\\n            {{#if this.isFiltered}}\\n              <span class=\"filtered-out\">filtered via <a class=\"custom-filters\">custom filter</a> #{{call this.getWhyFiltered context=this}}</span>\\n            {{/if}}\\n          {{#and this.isFiltered context=this}}\\n          {{else}}\\n            <div class=\"sample-modal-link\">\\n              <div class=\"service {{../../writeService.id}}32x32\" title=\"[Service name]\"></div>\\n              <a href=\"#\" data-sample-write-id=\"{{this.[_idx]}}\">See action sample.</a>\\n            </div>\\n\\n            <button class=\"send\" data-send-sample-id=\"{{this.[_idx]}}\">Test Zap with this sample</button>\\n          {{/and}}\\n          </div>\\n        {{/each}}\\n      </div>\\n\\n      <p><a href=\"#\" class=\"load refresh\"><span class=\"img16 {{#if readService}}{{readService.id}}{{else}}placeholder{{/if}}\"></span> Refresh samples from {{appNameFromKey readService.id}}</a></p>\\n\\n    </div>\\n  {{/hasAtLeastOne}}\\n\\n\\n  {{#hasAtLeastOne samples}}\\n\\n    {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n  {{else}}\\n  {{/hasAtLeastOne}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}\\n');window.JST[\"editor_map\"]=JST('{{#if show}}\\n  <paramform></paramform>\\n\\n  <div class=\"loading-fields\">Loading fields...</div>\\n  <span class=\"loading-empty\">(This Action, {{call service.getActionName write.action \"write\" \"false\" context=service}}, does not have any fields)</span>\\n\\n  {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_prefill_modal\"]=JST('{{#hasAtLeastOne choices}}\\n<div class=\"search\">\\n  <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n</div>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">{{#ellipsis 50}}{{this.display}}{{/ellipsis}} <span class=\"sample\">{{this.val}}</span></a>\\n  </li>\\n  {{/each}}\\n\\n  <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n  <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n  {{#unless trigger}}\\n  <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/unless}}\\n\\n  <li class=\"load-more\" data-id=\"load-more\"><a class=\"display\" title=\"Load more choices\" alt=\"Load more choices\">Load more choices <span class=\"sample\"><i class=\"fa fa-ellipsis-horizontal\"></i></span></a></li>\\n</ul>');window.JST[\"editor_action_card\"]=JST(\"<h2>Available {{#plural}}{{which}}{{/plural}}</h2>\\n<ul>\\n  {{#each action}}\\n  <li>{{this.label}}</li>\\n  {{/each}}\\n</ul>\");window.JST[\"editor_auth\"]=JST('{{#if show}}\\n\\n  {{#if needsAuth}}\\n\\n    {{#if hasAtLeastOneAuth}}\\n      <div class=\"container table-wrapper\">\\n        <div class=\"column one-half table-cell\">\\n        <select class=\"auths\" data-placeholder=\"{{appNameFromKey key}} Account\">\\n          <option></option> <!-- placeholder -->\\n          {{#each auths}}\\n          <option value=\"{{this.id}}\" {{#equals this.id ../selected }}selected=\"selected\"{{/equals}}>{{call this.getName}}</option>\\n          {{/each}}\\n          <option value=\"new\">Connect a different {{appNameFromKey key}} Account</option>\\n        </select>\\n        </div>\\n        <div class=\"column one-half table-cell vcenter\">\\n      {{#if selected}}\\n        <button class=\"test\">Test this Account</button>\\n      {{/if}}\\n        </div>\\n      </div>\\n    {{else}}\\n      <a class=\"orange button add\" href=\"#\" data-id=\"add\">\\n        Connect {{#article}}{{appNameFromKey key}}{{/article}} Account\\n      </a>\\n    {{/if}}\\n  {{/if}}\\n\\n  {{#neither needsAuth isHook}}\\n    <p class=\"big\">You\\'re all set. Carry on!</p>\\n  {{/neither}}\\n\\n  {{#if isHook}}\\n    <div class=\"hook-dirs\">{{{call service.getWebhookDirections action which context=service}}}</div>\\n\\n    <p class=\"big\">Use this Webhook URL:</p>\\n\\n    <div class=\"table-wrapper fill\">\\n      <div class=\"table-cell column\">\\n        <input class=\"webhook-url\" type=\"text\" value=\"{{call service.getWebhookURL action which model context=service}}\" data-id=\"webhook-url\" readonly>\\n      </div>\\n      <div class=\"table-cell vcenter\">\\n        <button class=\"copy-button\" data-clipboard-text=\"{{call service.getWebhookURL action which model context=service}}\">Copy to clipboard</button>\\n      </div>\\n    </div>\\n\\n    {{#if showContinue}}<div><button class=\"continue\">Continue</button></div>{{/if}}\\n\\n  {{/if}}\\n\\n  {{#if showContinue}}{{#unless isHook}}<div><button class=\"continue\">Continue</button></div>{{/unless}}{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_action\"]=JST('{{#if show}}}\\n  <ul class=\"pill-list\"></ul>\\n  {{#if anyAdvanced}} {{#unless showall}} {{#hasAtLeastOne actions}}\\n    <a href=\"#\" class=\"showall\">Show advanced, less-used options</a>\\n  {{/hasAtLeastOne}} {{/unless}} {{/if}}\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_no_samples_modal\"]=JST('<h2>We could not find any <em>recent</em> {{#plural}}{{call service.getActionName action \"read\" \"true\" context=service}}{{/plural}} from {{appNameFromKey key}} {{#unless isHook}}matching your Filters{{/unless}}</span></h2>\\n\\n<pre class=\"error\">{{call service.getActionName action \"read\" \"true\" context=service}} response: empty</pre>\\n\\n<h3>What To Do Next</h3>\\n\\n<ol>\\n  {{#if isHook}}\\n  <li>Follow any on-screen instructions and make sure that you have recently <em>sent us</em> a {{call service.getActionName action \"read\" \"true\" context=service}}</li>\\n  {{else}}\\n\\n  <li>Create a new {{call service.getActionName action \"read\" \"true\" context=service}} in {{appNameFromKey key}} {{#unless isHook}}which matches your Filters{{/unless}}</li>\\n  {{/if}}\\n\\n  <li>Try reloading {{#plural}}{{call service.getActionName action \"read\" \"true\" context=service}}{{/plural}} again in a few seconds</li>\\n</ol>');window.JST[\"editor_action_row\"]=JST('<li class=\"action pill-row {{#if selected}}selected{{/if}}\" id=\"{{key}}\">\\n  <div class=\"radio\"></div>\\n  <div class=\"text name\">{{label}}</div>\\n  <div class=\"text description\">{{#if help_text_html}}{{{help_text_html}}}{{else}}{{help_text}}{{/if}}</div>\\n  <div class=\"clear\"></div>\\n</li>');\nwindow.JST[\"editor_base\"]=JST('<div class=\"editor\"></div>');window.JST[\"editor_api_error_modal\"]=JST('<h2>We received an error from {{appNameFromKey key}}</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Make sure you have followed all on-screen directions, in order</li>\\n  <li>Test your {{serivce}} Account again</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"share_shared\"]=JST('<div class=\"container\"></div>\\n\\n<div class=\"pagination\">\\n    <button class=\"light previous\" {{#unless this.pagination.prev }}disabled{{/unless}}>&nbsp; &larr; &nbsp;</button>\\n    {{! <button class=\"light\">1</button> }}\\n    {{! <button class=\"light\">2</button> }}\\n    {{! <button class=\"light\">3</button> }}\\n    <span><em>page <select class=\"page\">{{#range this.pagination.pages}}<option value=\"{{i}}\" {{#equals i this.pagination.page }}selected{{/equals}}>{{i}}</option>{{/range}}</select> of {{ this.pagination.pages }}</em></span>\\n    <button class=\"light next\" {{#unless this.pagination.next }}disabled{{/unless}}>&nbsp; &rarr; &nbsp;</button>\\n</div>\\n');window.JST[\"share_recipe\"]=JST('<div class=\"zap-mini\">\\n  <div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n  <div class=\"twrapper\">\\n    <div class=\"checkbox\">\\n      <input type=\"checkbox\" class=\"add-to-embed\" value=\"{{this.id}}\" {{#if checked}}checked=\"checked\"{{/if}}>\\n    </div>\\n    <div class=\"services\">\\n      <div class=\"service {{this.read_service_selected_api}}32x32\"></div>\\n      <span class=\"fa fa-caret-right caret\"></span>\\n      <div class=\"service {{this.write_service_selected_api}}32x32\"></div>\\n    </div>\\n    <div class=\"title\">{{this.short_description}}</div>\\n  </div>\\n</div>');window.JST[\"share_embed\"]=JST('<div class=\"sharer\"></div>\\n<h3>3. Embed Your Widget</h3>\\n<div class=\"share-link\">\\n  <p>Happy with your new widget?!</p>\\n  <p>Copy the code below and embed your widget on your website or anywhere that allows embedding.</p>\\n  <input type=\"text\" class=\"share-this\" readonly>\\n</div>');window.JST[\"share_base\"]=JST('<div class=\"row\">\\n    <div class=\"container shave center\">\\n        <h1>Make Your Own Zap Widget</h1>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <div class=\"column one-half\">\\n            <h3>1. Select Zaps To Include</h3>\\n            <p>Choose which shared Zaps below to include in your widget.</p>\\n            <div class=\"results\"></div>\\n        </div>\\n        <div class=\"column one-half\">\\n            <h3>2. Preview Your Zap Widget</h3>\\n            <p>This is how your Zap widget will look on your website or blog.</p>\\n            <div class=\"embed\"></div>\\n        </div>\\n    </div>\\n</div>');window.JST[\"history_filters\"]=JST('<div class=\"history-controls\">\\n  <div class=\"history-selects\">\\n    <label>Filter by: </label>\\n\\n    <paramform></paramform>\\n    \\n  </div>\\n\\n  <div class=\"history-buttons\">\\n    <button class=\"refresh light right\"><i class=\"fa fa-refresh left\"></i> Refresh</button>\\n    <button class=\"send-csv light right\"><i class=\"fa fa-download left\"></i> Export to CSV</button>\\n  </div>\\n</div>');window.JST[\"history_table\"]=JST('<table class=\"table table-striped\">\\n  <tr class=\"history\">\\n    <td class=\"empty\">\\n      <p>No tasks match this filter.</p>\\n      <p><a href=\"/app/editor/\">Make a new Zap</a>{{#unless isPartner}} or <a href=\"/app/explore\">Explore existing Zap templates</a>{{/unless}}.</p>\\n    </td>\\n  </tr>\\n</table>');window.JST[\"history_details\"]=JST('<table class=\"table history-single\">\\n  <tr class=\"history single\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\">\\n    <td class=\"status-column\">\\n      <div class=\"status-indicator {{this.data.status}}\"></div>\\n    </td>\\n    <td class=\"services\">\\n      <div class=\"service\">\\n        <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n      </div>\\n      <i class=\"fa fa-caret-right caret\"></i>\\n      <div class=\"service\">\\n        <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n      </div>\\n    </td>\\n    <td>\\n      <div class=\"title\">{{this.object_title}}</div>\\n    </td>\\n    <td>\\n      <button class=\"replay {{#notequals data.status \"success\"}}{{else}}invisible{{/notequals}}\"><i class=\"fa fa-repeat left\"></i> Replay</button>\\n    </td>\\n    <td>\\n      <div class=\"timesince\">{{this.timesince}} ago</div>\\n    </td>\\n  </tr>\\n</table>\\n\\n<h2>Details</h2>\\n<div class=\"task-details\">\\n  {{#each children}}\\n  <div class=\"task-detail\">\\n    <a href=\"#\" class=\"toggle-details\">Show detail</a>\\n    <div class=\"target {{#equals ../selected.id ../id}}{{#equals ../../selected.row ../_idx}}selected{{/equals}}{{/equals}}\"\\n    data-id=\"{{../id}}\" data-row=\"{{_idx}}\" data-type=\"{{type}}\">\\n      <div class=\"caret\">\\n        <i class=\"fa fa-caret-right\"></i>\\n      </div>\\n      <div class=\"status-container\">\\n        <div class=\"status-indicator {{status}}\"></div>\\n      </div>\\n      <div class=\"title\">{{message}}</div>\\n      <div class=\"date\">{{prettyISO date}}</div>\\n    </div>\\n\\n    <div class=\"details hide\">\\n      {{#if dataDetails}}\\n        <ul>\\n          {{#each dataDetails}}\\n          <li>\\n            <span class=\"detail-key\">{{key}}:</span>\\n            <pre class=\"detail-value\">{{value}}</pre>\\n          </li>\\n          {{/each}}\\n        </ul>\\n      {{else}}\\n        <div class=\"empty\">No details to show...</div>\\n      {{/if}}\\n    </div>\\n\\n  </div><!-- task-detail -->\\n  {{/each}}\\n</div><!-- task-details -->');window.JST[\"history_send_csv\"]=JST('<div class=\"the-content\">\\n  <h1>Generate Task History CSV</h1>\\n  <p>Customers on the Basic plan and up can export large amounts of task history as a CSV (5000 items is the default max, <a href=\"mailto:contact@zapier.com\">contact us</a> if you need to export more). This can take a few minutes so we\\'ll email you with a link when it is ready!</p>\\n  <ul>\\n      <li><strong>Selected Zap</strong>: <em>{{#if zapName}}{{zapName}}{{else}}any{{/if}}</em></li>\\n      <li><strong>Selected Status</strong>: <em>{{#if status}}{{status}}{{else}}any{{/if}}</em></li>\\n  </ul>\\n  <p class=\"feedback\"></p>\\n  <button class=\"submit send\">Generate &amp; Email CSV</button>\\n</div>');window.JST[\"history_pagination\"]=JST('{{#if pagination.pages }}\\n{{#greater pagination.pages 1}}\\n<div class=\"pagination\">\\n  <div class=\"page-nav\"><a href=\"#\" class=\"previous {{#unless pagination.hasPrev }}disabled{{/unless}}\"><i class=\"fa fa-chevron-left\"></i></a></div>\\n  <div class=\"page-numbers\"><span>{{ pagination.page }}</span> of <span>{{ pagination.pages }}</span></div>\\n  <div class=\"page-nav\"><a href=\"#\" class=\"next {{#unless pagination.hasNext }}disabled{{/unless}}\"><i class=\"fa fa-chevron-right\"></i></a></div>\\n</div>\\n{{/greater}}\\n{{/if}}');window.JST[\"history_base\"]=JST('<div class=\"row\">\\n  <div class=\"container shave\">\\n    {{#if id}}\\n      <h1 class=\"history-header shave\">Task Id: {{id}}</h1>\\n    {{else}}\\n      <div class=\"column one-half\">\\n        <h1 class=\"history-header shave\">Task History</h1>\\n      </div>\\n      <div class=\"column one-half\">\\n        <div class=\"history-key\"><span class=\"status-indicator success\"></span> success &nbsp; <span class=\"status-indicator error\"></span> error &nbsp; <span class=\"status-indicator halted\"></span> filtered</div>\\n      </div>\\n    {{/if}}\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container shave head\">\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container body\">\\n  </div>\\n</div>');window.JST[\"history_nav\"]=JST('<a data-nav=\"/app/history\" href=\"#\" class=\"history-back-link\"><i class=\"fa fa-angle-left\"></i> Back to Task History</a>');window.JST[\"history_row\"]=JST('<tr class=\"history\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\" title=\"Click for more details\">\\n  <td class=\"status-column\">\\n    <div class=\"status-indicator {{this.data.status}}\"></div>\\n  </td>\\n  <td class=\"services\">\\n    <div class=\"service\">\\n      <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n    </div>\\n    <i class=\"fa fa-caret-right caret\"></i>\\n    <div class=\"service\">\\n      <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n    </div>\\n  </td>\\n  <td>\\n    <div class=\"title\">{{this.object_title}}</div>\\n  </td>\\n  <td>\\n    <button class=\"replay {{#notequals data.status \"success\"}}{{else}}invisible{{/notequals}}\"><i class=\"fa fa-repeat left\"></i> Replay</button>\\n  </td>\\n  <td>\\n    <div class=\"timesince\">{{date}}</div>\\n  </td>\\n</tr>');window.JST[\"explore_recipe\"]=JST('<div class=\"zap\">\\n\\n  <div class=\"text-narrow\">\\n    <div class=\"title\"><a href=\"#\" class=\"use-this\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n    <div class=\"description\">{{this.short_description}}</div>\\n  </div>\\n\\n  <div class=\"services\">\\n    <div class=\"service {{this.read_service_selected_api}}64x64\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{this.write_service_selected_api}}64x64\"></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    {{#if this.generated}}\\n      <div class=\"title\"><a href=\"#\" class=\"use-this\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n    {{else}}\\n      {{#if z.app.partner.isPartnerSession context=z.app.partner}}\\n        <div class=\"title\">{{this.title}}</div>\\n      {{else}}\\n        <div class=\"title\"><a href=\"{{this.url}}\">{{this.title}}</a></div>\\n      {{/if}}\\n    {{/if}}\\n    <div class=\"description\">{{this.short_description}}</div>\\n  </div>\\n\\n  <div class=\"cta\"><a class=\"big button use-this\" data-id=\"{{this.id}}\">Use this Zap</a></div>\\n\\n</div>');window.JST[\"explore_recipe_classic\"]=JST('<div class=\"recipe classic\">\\n\\n  <div class=\"images\">\\n    <div class=\"read\"><div class=\"img64 {{this.read_service_selected_api}}64x64\"></div></div>\\n    <div class=\"arrow\">&#9658;</div>\\n    <div class=\"write\"><div class=\"img64 {{this.write_service_selected_api}}64x64\"></div></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    <div class=\"description\"><a class=\"underline\" href=\"#\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n\\n    <a href=\"#\" data-id=\"{{this.id}}\"><button>Use This!</button></a>\\n\\n    <div class=\"used-by\">\\n      <div class=\"count\">{{humanize this.used}} others use this</div>\\n    </div>\\n  </div>\\n\\n  <clear />\\n\\n</div>\\n');window.JST[\"explore_search\"]=JST('<div class=\"row\">\\n  <div class=\"column one-half\">\\n    <div class=\"involve services\">\\n      <select id=\"involve-service\" data-placeholder=\"Click here and select the apps you use...\">\\n        <option></option>\\n        {{#each services}}\\n          <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n        {{/each}}\\n      </select>\\n    </div>\\n  </div>\\n\\n  <div class=\"column one-half\">\\n    <div class=\"involved-services\">\\n      {{#each involvedServices}}\\n        <div class=\"involved-service\">\\n          <div class=\"img32 {{get this \"key\"}}32x32\">&nbsp;</div>\\n          <div class=\"remove\" data-remove-involve-service=\"{{get this \"slug\"}}\"><i class=\"fa fa-times\"></i></div>\\n        </div>\\n      {{/each}}\\n    </div>\\n\\n    {{#if anyFilters}}\\n      <button class=\"do-clear\">Reset all</button>\\n      <a class=\"direct-link\" href=\"{{directLink}}\" title=\"Click to get a direct link to this page in your browser\\'s address bar\"><i class=\"fa fa-external-link\" /></a>\\n    {{/if}}\\n  </div>\\n</div>');window.JST[\"explore_results\"]=JST('<div class=\"zaps\"></div>\\n\\n{{#greater this.pagination.pages 1}}\\n<div class=\"pagination\">\\n  <div class=\"page-nav\"><a href=\"#\" class=\"previous {{#unless this.pagination.prev }}disabled{{/unless}}\"><i class=\"fa fa-chevron-left\"></i></a></div>\\n  <div class=\"page-numbers\"><span>{{ this.pagination.page }}</span> of <span>{{ this.pagination.pages }}</span></div>\\n  <div class=\"page-nav\"><a href=\"#\" class=\"next {{#unless this.pagination.next }}disabled{{/unless}}\"><i class=\"fa fa-chevron-right\"></i></a></div>\\n</div>\\n{{/greater}}');window.JST[\"explore_base\"]=JST('<div class=\"row\">\\n\t<div class=\"container center shave\">\\n\t\t<h1>Explore Zaps!</h1>\\n\t\t<p>Pick from thousands of Zaps that other people have shared to use as a template.<br />A Zap is a connection between two apps that automates time-consuming tasks.</p>\\n\t</div>\\n</div>\\n<div class=\"row\">\\n\t<div class=\"container\">\\n\t\t<div class=\"explore\">\\n\t\t\t<div class=\"search\"></div>\\n\t\t\t<div class=\"results\"></div>\\n\t\t</div>\\n\t</div>\\n</div>');window.JST[\"signup_why\"]=JST('{{#if selectedPlan}}\\n  <div class=\"selected-plan\">\\n    <h2>{{get selectedPlan \"name\"}}</h2>\\n  </div>\\n{{else}}\\n  <div class=\"trialing\">\\n    <h1>Sign Up For Free</h1>\\n    <ul class=\"default\">\\n      <li><i class=\"fa fa-check green\"></i> Access to Premium Apps</li>\\n      <li><i class=\"fa fa-check green\"></i> Unlimited Tasks and Zaps</li>\\n      <li><i class=\"fa fa-check green\"></i> Upgrade, downgrade, or cancel at any time</li>\\n    </ul>\\n  </div>\\n{{/if}}\\n\\n{{#or readService writeService}}\\n  <div class=\"services\">\\n    <h3>You are seconds away from connecting...</h3>\\n\\n    {{#if readService}}\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          <img src=\"/generated/{{get readService \"key\" context=readService}}/128/\" />\\n        </div>\\n      </div>\\n    {{else}}\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          {{#each services}}\\n            <div class=\"gray img32 {{get this \"key\" context=this}}32x32\"></div>\\n          {{/each}}\\n        </div>\\n        <h3 class=\"no-service\">hundreds of apps!</h3>\\n      </div>\\n    {{/if}}\\n\\n    {{#if writeService}}\\n      <div class=\"connection\">\\n        <em>to</em>\\n      </div>\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          <img src=\"/generated/{{get writeService \"key\" context=writeService}}/128/\" />\\n        </div>\\n      </div>\\n    {{else}}\\n      <h3 class=\"no-service\">to hundreds of other apps!</h3>\\n    {{/if}}\\n  </div>\\n\\n{{else}}\\n\\n  <div class=\"ebook\">\\n    <div class=\"book\"><img src=\"{{mediaURL}}images/ebook.png\" /></div>\\n    <div class=\"description\">\\n      <h3>Sign up and get this E-book FREE!</h3>\\n      <p class=\"small\">You\\'ll get a download link in your inbox.</p>\\n      <img src=\"{{mediaURL}}images/arrows/right.png\" class=\"arrow\" />\\n    </div>\\n  </div>\\n\\n{{/or}}');window.JST[\"signup_persona_modal\"]=JST('<h1 class=\"center\">Get Better Zap Recommendations</h1>\\n<div class=\"subhead center\">Check one or more professions below that best match you to get the best Zap recommendations.</div>\\n<div class=\"line\"></div>\\n\\n<form method=\"post\">\\n    \\n    <div class=\"group left\">\\n        {{#each first_personas}}\\n            <label><input type=\"checkbox\" name=\"persona\" value=\"{{this}}\"> {{this}}</label> <br>\\n        {{/each}}\\n    </div> <!-- end of .group .left -->\\n\\n    <div class=\"group\">\\n        {{#each second_personas}}\\n            <label><input type=\"checkbox\" name=\"persona\" value=\"{{this}}\"> {{this}}</label> <br>\\n        {{/each}}\\n    </div> <!-- end of .group -->\\n    \\n    <div class=\"clear\"></div>\\n\\n    <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\">\\n\\n    <input type=\"submit\" value=\"Let\\'s get started!\" class=\"button light\">\\n</form>\\n');window.JST[\"signup_form\"]=JST('<h3>Signup Today - It\\'s Easy!</h3>\\n<signupform></signupform>\\n<div class=\"submit-row\">\\n  <button class=\"submit big orange\">Create Your New Zapier Account</button>\\n</div>\\n\\n<div class=\"errors hide\">\\n    <i class=\"fa fa-exclamation-circle\" /> <span>A user with that email already exists.</span>\\n</div>');window.JST[\"signup_base\"]=JST('<div class=\"row signup\">\\n\t<div class=\"container haircut\">\\n\t\t<div class=\"column one-half signup-why\">\\n\t\t\t<div class=\"selected-plan\"></div>\\n\t\t</div>\\n\t\t<div class=\"column one-half signup-form\"></div>\\n\t</div>\\n</div>');window.JST[\"forgot_password\"]=JST('<p>Reset the password for {{username}}.</p>\\n<form>\\n<input type=\"password\" class=\"password1\" placeholder=\"New Password\" />\\n<input type=\"password\" class=\"password2\" placeholder=\"Confirm New Password\" />\\n<button class=\"submit\">Set New Password</button>\\n<p class=\"feedback hide\"></p>\\n</form>');window.JST[\"forgot_base\"]=JST(\"<h1>Forgot Password</h1>\");window.JST[\"forgot_email\"]=JST('<p>Enter the email address you signed up with below. An email will be sent containing a link to reset your password.</p>\\n<p>Forgot your email address? Send <a href=\"mailto:contact@zapier.com\">an email to support</a> and we\\'ll track it down.</p>\\n<form>\\n<input type=\"text\" class=\"email\" placeholder=\"Email Address\" />\\n<button class=\"submit\">Send Reset Instructions</button>\\n<p class=\"feedback hide\"></p>\\n</form>');window.JST[\"settings_plans\"]=JST('<div class=\"row\">\\n  <div class=\"container\">\\n\\n    <h1>Pricing Plans</h1>\\n\\n    <div class=\"toggle toggle-interval\">\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"month\">Monthly</a>\\n      <div class=\"toggle-container{{#if monthly}}{{else}} on{{/if}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"year\">Yearly (1 Month Free)</a>\\n    </div>\\n\\n    {{#if account.isTrialing context=account}}\\n      <div class=\"extra-info\">\\n        <p>There are {{call ../account.trialDaysLeft context=../account}} days left in your current Zapier trial.</p>\\n        <h3 class=\"haircut\">Your trial includes:</h3>\\n        <ul class=\"default\">\\n          <li><i class=\"fa fa-check green\"></i> Access to all Regular + Premium Apps</li>\\n          <li><i class=\"fa fa-check green\"></i> Unlimited Tasks and Zaps</li>\\n          <li><i class=\"fa fa-check green\"></i> 5-minute Syncing</li>\\n        </ul>\\n        <p>If you don\\'t select a plan before your trial ends, we\\'ll automatically switch your account to the free plan for you. If you have more than 5 Zaps, 100 tasks, or are using any premium apps in your Zaps, please select a plan to avoid any service interruptions.</p>\\n      </div>\\n    {{/if}}\\n\\n  {{#if provider}}\\n    <div class=\"extra-info\">You have a Zapier account sponsored by {{provider.title}}! That means you get free access to lots of Zapier benefits without the costs. However, you can upgrade to a full Zapier to unlock more features.<!-- <a href=\"#\" data-support-tags=\"sponsored-account\">Click to learn more.</a>--></div>\\n  {{/if}}\\n\\n  {{#if coupon}}\\n    <div class=\"extra-info\">Coupon is active! {{coupon}}</div>\\n  {{/if}}\\n\\n    {{#if cached_coupon.description}}\\n      <div class=\"extra-info\">Coupon is ready for upgrade! {{cached_coupon.description}}</div>\\n    {{/if}}\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container table-fixed-width\">\\n    <div class=\"overflow-container\">\\n      <table class=\"table table-striped\">\\n        <thead>\\n          <tr class=\"table-header-row\">\\n            <th>Plan</th>\\n            <th>Price</th>\\n            <th style=\"width:150px;\">Premium Services</th>\\n            <th>Tasks/mo</th>\\n            <th>Zaps</th>\\n            <th>Zaps Run Every</th>\\n            <th class=\"change\">Action</th>\\n          </tr>\\n        </thead>\\n\\n        <tbody id=\"plans\">\\n          {{#each plans}}\\n            <tr>\\n              <td>{{get this \"name\"}}</td>\\n              <td>${{dollars}}/{{get this \"interval\"}}</td>\\n              <td class=\"center\">{{#hasExactly this.blacklistedServices 0}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-times\"></i>{{/hasExactly}}</td>\\n              <td>{{tasksMo}}</td>\\n              <td>{{zaps}}</td>\\n              <td>{{pollInterval}} {{pollIntervalTimeFrame}}</td>\\n              <td>\\n              {{#if current}}\\n                <a class=\"button disabled\">Your current plan</a>\\n              {{else}}\\n                {{#if ../../account.hasActiveCard context=../../account}}\\n                  <button class=\"light {{#if ../../isFree}}change-plan{{else}}add-card{{/if}}\" data-change-plan=\"{{../../id}}\">{{../../buttonText}}</button>\\n                {{else}}\\n                  <a class=\"add-card button\" data-change-plan=\"{{../../id}}\">Switch to this plan</a>\\n                {{/if}}\\n              {{/if}}\\n              </td>\\n            </tr>\\n          {{/each}}\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"row border\">\\n   <div class=\"container\">\\n\\n  {{#if showCoupon}}\\n    <div class=\"coupon-form\">\\n      <span class=\"feedback\"></span>\\n      <input class=\"coupon-code\" type=\"text\" name=\"coupon-code\" placeholder=\"Enter your coupon code...\">\\n      <button class=\"submit light\">Use Coupon</button>\\n    </div>\\n  {{/if}}\\n\\n  </div>\\n</div>\\n{{JST \"pricing_about\"}}');window.JST[\"settings_overview\"]=JST('<div class=\"picture\">\\n  <img src=\"https://secure.gravatar.com/avatar/{{email_hash}}.jpg?s=30&amp;d=mm\">\\n</div>\\n<div class=\"table left\">\\n<span class=\"key\">Email:</span><span class=\"val\">{{email}}</span><br />\\n<span class=\"key\">Joined:</span><span class=\"val\">{{since_signup}} ago</span><br />\\n</div>\\n<div class=\"table right\">\\n<span class=\"key\">Plan:</span><span class=\"val\">{{plan.name}}</span><br />\\n<span class=\"key\">Status:</span><span class=\"val\">{{status}}</span><br />\\n</div>');window.JST[\"settings_extra\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"advanced\"><i class=\"fa fa-wrench\"></i> Advanced Settings</a></h3>\\n    <p>Modify advanced or technical settings with your account</p>\\n    <p><a href=\"#\" class=\"advanced action left\">Monkey with advanced settings</a></p>\\n    <p><a href=\"#\" class=\"close\">Click here to permanently delete your account</a></p>\\n  </li>\\n</ul>');window.JST[\"settings_invoices\"]=JST('<div class=\"row\">\\n  <div class=\"container settings invoices\">\\n\\n    <h1>Invoices</h1>\\n    {{#if billing_period_start_date}}\\n      <h4>Your next billing period starts on {{billing_period_start_date}}</h4>\\n    {{/if}}\\n\\n    <table class=\"table\">\\n      <thead>\\n        <tr>\\n          <th>Billing Period Starting</th>\\n          <th>Subtotal</th>\\n          <th>Discount</th>\\n          <th>Amount</th>\\n          <th>Status</th>\\n          <th>Actions</th>\\n        </tr>\\n      </thead>\\n      <tbody id=\"invoices\">\\n        <tr>\\n          <td colspan=\"7\" class=\"center\"><em>No past invoices to see...</em></td>\\n        </tr>\\n      </tbody>\\n    </table>\\n\\n    <p><a data-nav=\"/app/settings\">Back to settings</a></p>\\n\\n  </div>\\n</div>');window.JST[\"settings_billing\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"plans\"><i class=\"fa fa-tag\"></i> Current Plan</a></h3>\\n    <p>{{plan_name}} {{plan_rate}} <a href=\"#\" class=\"plans action\">See other plans</a></p>\\n    <p>{{#if last4}}Credit Card Last Four: {{last4}} <a href=\"#\" class=\"card action left\">Update credit card</a>{{else}}<a href=\"#\" class=\"card action left\">Add credit card</a>{{/if}}</p>\\n    <p><a href=\"#\" class=\"invoice action left\">See invoices</a></p>\\n  </li>\\n</ul>');window.JST[\"settings_card\"]=JST('<table class=\"table table-bordered credit-card\">\\n  <thead>\\n    <tr>\\n      <th>Type</th>\\n      <th>Number</th>\\n      <th>Expiration</th>\\n    </tr>\\n  </thead>\\n\\n  <tbody>\\n    <tr>\\n      {{#if last4}}\\n        <td>{{type}}</td>\\n        <td>xxxx-xxxx-xxxx-{{last4}}</td>\\n        <td>{{expM}}/{{expY}}</td>\\n      {{else}}\\n        <td colspan=\"3\"><em>No card on file.</em></td>\\n      {{/if}}\\n    </tr>\\n  </tbody>\\n</table>');window.JST[\"settings_invoice\"]=JST('<tr>\\n  <td>{{period_end_pretty}}</td>\\n  <td>${{subtotal_pretty}}</td>\\n  <td>{{#if discount.coupon.percent_off}}\\n    {{discount.coupon.percent_off}}% off\\n  {{else}}\\n    {{#if discount.coupon.amount_off}}\\n      ${{discount.coupon.amount_off_pretty}} off\\n    {{/if}}\\n  {{/if}}</td>\\n  <td>${{total_pretty}}</td>\\n  <td>\\n    {{#if charge.refunded}}\\n      <i class=\"fa fa-check-circle green\"></i> Refunded\\n    {{else}}\\n      {{#if paid}}\\n        <i class=\"fa fa-check green\"></i> Paid\\n      {{else}}\\n        {{#if next_payment_attempt}}\\n          <i class=\"fa fa-calendar\"></i> Scheduled {{next_payment_attempt_pretty}}\\n        {{else}}\\n          <i class=\"fa fa-minus-circle\"></i> Balance Due\\n        {{/if}}\\n      {{/if}}\\n    {{/if}}\\n  </td>\\n  <td>\\n    <a class=\"button details\" id=\"{{cid}}\">View details</a>\\n    {{#if printable_url}}<a href=\"{{printable_url}}\" class=\"button\" target=\"_new\">Print</a>{{/if}}\\n  </td>\\n</tr>\\n<tr class=\"invoice-details\" id=\"{{cid}}\">\\n  <td class=\"holders\" colspan=\"7\">\\n    <table class=\"table table-bordered\">\\n      <thead>\\n        <tr>\\n          <th>Date</th>\\n          <th>Amount</th>\\n          <th>Description</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each lines.invoiceitems}}\\n        <tr>\\n          <td>{{date_pretty}}</td>\\n          <td>${{amount_pretty}}</td>\\n          <td>{{description}}</td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"3\" class=\"center\">\\n            <div class=\"no-results\">No line item information available.</div>\\n          </td>\\n        </tr>\\n      {{/each}}\\n      </tbody>\\n    </table>\\n\\n    <table class=\"table table-bordered\">\\n      <thead>\\n        <tr>\\n          <th>Plan Name</th>\\n          <th>Amount</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each lines.subscriptions}}\\n        <tr>\\n          <td>{{plan.name}}</td>\\n          <td>${{plan.amount_pretty}}</td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"1\" class=\"center\">\\n            <div class=\"no-results\">No plan information available.</div>\\n          </td>\\n        </tr>\\n      {{/each}}\\n    </table>\\n  </td>\\n</tr>');window.JST[\"settings_settings_modal\"]=JST('<h2>{{title}}</h2>\\n<paramform></paramform>\\n<clear />\\n<div>\\n  <button class=\"submit orange\">{{#if button}}{{button}}{{else}}Save changes{{/if}}</button>\\n  <span class=\"feedback\"></span>\\n</div>');window.JST[\"settings_auths\"]=JST('<div class=\"row\">\\n  <div class=\"container shave\">\\n    <h1 class=\"history-header shave\">Connected Accounts</h1>\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container shave\">\\n\\n  <div class=\"auth-select\">\\n    <select id=\"add\" data-placeholder=\"Connect new account\" data-which=\"add\">\\n      <option></option> <!-- placeholder -->\\n      {{#each services}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n  </div>\\n\\n\\n  <div class=\"auth-select\">\\n    <select id=\"request\" data-placeholder=\"Request access to a new account via email\" data-which=\"request\">\\n      <option></option> <!-- placeholder -->\\n      {{#each services}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n  </div>\\n\\n  </div><!-- container -->\\n</div><!-- row -->\\n\\n<div class=\"row\">\\n  <div class=\"container\">\\n\\n    <table class=\"auths-table table table-striped\">\\n      <thead>\\n        <tr>\\n          <th>Service</th>\\n          <th>Connected</th>\\n          <th class=\"center\">Zaps</th>\\n          <th></th>\\n          <th></th>\\n          <th></th>\\n          <th></th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each auths}}\\n        <tr data-id=\"{{this.id}}\">\\n          <td class=\"name\">\\n            <div class=\"service\">\\n              <div class=\"service-icon {{this.selected_api}}16x16\" title=\"{{appNameFromKey this.selected_api}}\"></div>\\n            </div>\\n            {{this.name}}\\n          </td>\\n          <td class=\"age\">{{this.prettyDate}}</td>\\n          <td class=\"used center\">{{this.used}}</td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller test\">Test</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller rename\">Rename</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller reconnect\">Reconnect</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller disconnect\">Disconnect</button>\\n          </td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"7\" class=\"empty\">You don\\'t have any conncted accounts!</td>\\n        </tr>\\n      {{/each}}\\n      </tbody>\\n    </table>\\n\\n  </div><!-- container -->\\n</div><!-- row -->');window.JST[\"settings_base\"]=JST('<div class=\"row\">\\n   <div class=\"container shave\">\\n      <h1 class=\"shave\">Settings</h1>\\n   </div>\\n</div>\\n\\n<div class=\"row settings\">\\n  <div class=\"container\">\\n    <div class=\"column one-half\">\\n      <div class=\"my-account\"></div>\\n    </div>\\n    <div class=\"column one-half\">\\n      <div class=\"billing\"></div>\\n      <div class=\"extra\"></div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"settings_my_account\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"user\"><i class=\"fa fa-user\"></i> Your Profile</a></h3>\\n    <div class=\"profile-image\">\\n      <div class=\"picture-small\">\\n        <img src=\"https://secure.gravatar.com/avatar/{{ account.email_hash }}.jpg?s=50&amp;d=mm\" />\\n      </div>\\n      <a href=\"#\" class=\"user action\">Change profile image</a>\\n    </div>\\n    {{#if account.provider}}\\n      <p><em>You signed up with a sponsored account, which doesn\\'t have the ability to modify an account\\'s email address. Please contact support for help.</em></h3>\\n    {{else}}\\n      <p>{{account.email}} <a href=\"#\" class=\"account action\">Change email</a></p>\\n      <p>* * * * <span class=\"info-hidden\">(hidden)</span> <a href=\"#\" class=\"account action\">Change password</a></p>\\n    {{/if}}\\n    <p>{{account.first_name}} {{account.last_name}} <a href=\"#\" class=\"user action\">Change name</a></p>\\n    {{#if account.company_name}}\\n    <p>{{account.company_name}} <a href=\"#\" class=\"user action\">Change company name</a></p>\\n    {{else}}\\n    <p><a href=\"#\" class=\"user action left\">Add a company name</a></p>\\n    {{/if}}\\n    {{#notequals account.timezone \"-----\"}}\\n    <p>{{account.timezone}} <a href=\"#\" class=\"user action\">Change timezone</a></p>\\n    {{else}}\\n    <p><a href=\"#\" class=\"user action left\">Set your timezone</a></p>\\n    {{/notequals}}\\n  </li>\\n  <li>\\n    <h3><a href=\"#\" class=\"email\"><i class=\"fa fa-envelope\"></i> Notification Settings</a></h3>\\n    <p>Activity summary email: {{account.summary_schedule}} <a href=\"#\" class=\"email action\">Change</a></p>\\n    <p>Send alerts on failed trigger: {{account.alert_triggers}} <a href=\"#\" class=\"email action\">Change</a></p>\\n    <p>Send alerts on failed action: {{account.alert_actions}} <a href=\"#\" class=\"email action\">Change</a></p>\\n  </li>\\n</ul>');window.JST[\"common_form_checkbox_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"checkbox\"\\n  {{#if val}}checked=\"checked\"{{/if}}\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>\\n\\n<label for=\"{{key}}\">{{#if help_text_html}}{{{help_text_html}}}{{else}}{{help_text}}{{/if}}</label>');window.JST[\"common_form_select_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_unicode_prettypill_row\"]=JST('{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[0] cid=cid ccode=ccode}}</span>\\n{{/if}}\\n\\n<textarea\\n  data-id=\"{{key}}\"\\n  data-type=\"unicode\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"{{#if input_format}} flanked{{/if}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n>{{val}}</textarea>\\n\\n\\n{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[2] cid=cid ccode=ccode}}</span>\\n  <button class=\"copy-button\" data-clipboard-text=\"{{render input_format.[0] cid=cid ccode=ccode}}{{value}}{{render input_format.[2] cid=cid ccode=ccode}}\">Copy to clipboard</button>\\n{{/if}}');\nwindow.JST[\"common_form_unicode_row\"]=JST('{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[0] cid=cid ccode=ccode}}</span>\\n{{/if}}\\n\\n<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"{{#if input_format}} flanked{{/if}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n/>\\n\\n\\n{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[2] cid=cid ccode=ccode}}</span>\\n  <button class=\"copy-button\" data-clipboard-text=\"{{render input_format.[2] cid=cid ccode=ccode}}\">Copy to clipboard</button>\\n{{/if}}');window.JST[\"common_form_prefill_empty_modal\"]=JST('<div class=\"prefill-error-modal\">\\n  <h2>{{sapi}} did not return any {{#plural}}{{sfield}}{{/plural}}</h2>\\n  <h3>What To Do Next</h3>\\n  <ol>\\n      <li>Log into {{sapi}} and create a new {{sfield}}</li>\\n      <li>Note: this field ({{#plural}}{{sfield}}{{/plural}}) may be filtered by fields above it</li>\\n      <li>Make sure you\\'ve followed all on-screen instructions in order</li>\\n      <li>Retry in a few seconds</li>\\n  </ol>\\n</div>');window.JST[\"common_form_prefill_error_modal\"]=JST('<div class=\"prefill-error-modal\">\\n  <h2>We received an error while accessing {{sapi}}</h2>\\n\\n  <pre class=\"error\">{{message}}</pre>\\n  <h3>What To Do Next</h3>\\n  <ol>\\n      <li>Make sure you complete fields in order they appear</li>\\n      <li>Make sure you\\'ve followed all on-screen instructions</li>\\n      <li>Retry in a few seconds</li>\\n      <li>Your {{sapi}} Account may not be working anymore, go back and test it</li>\\n  </ol>\\n</div>');window.JST[\"common_form_text_row\"]=JST('<textarea\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"multi-row\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n>{{val}}</textarea>');window.JST[\"common_form_upload_row\"]=JST('<div class=\"file-button-wrapper\">\\n   <span class=\"button\">Choose a file</span>\\n   <input\\n     data-id=\"{{key}}\"\\n     data-type=\"{{type}}\"\\n     data-input=\"true\"\\n     data-url=\"{{dataUrl}}\"\\n     name=\"image\"\\n\\n     {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n\\n     type=\"file\"\\n     autocomplete=\"off\"\\n\\n     {{#if disabled}}disabled=\"disabled\"{{/if}}\\n   />\\n</div>\\n\\n<div class=\"currently\">Currently: <a href=\"{{val}}\">{{val}}</a></div>\\n\\n<clear/>\\n');window.JST[\"common_form_confirmation_row\"]=JST('<a class=\"send-confirmation pill-button orange {{#if sentConfirmation}}hide{{/if}}\" data-id=\"{{key}}\">Send PIN</a>\\n\\n<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  class=\"input-confirmation {{#unless sentConfirmation}}hide{{/unless}} xlarge confirmation-width\"\\n  autocomplete=\"off\"\\n\\n  placeholder=\"Enter confirmation PIN\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_required_error\"]=JST(\"Please complete all required fields.\");window.JST[\"common_form_file_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  class=\"input-file\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_base_row\"]=JST('{{#unless hideLabel}}\\n<div class=\"label {{#if required}}required{{else}}not-required{{/if}}\">\\n  {{call model.getLabel context=model}}\\n  <span class=\"required-text\">{{#if required}}(required){{else}}(optional){{/if}}</span>\\n  <span class=\"extra\" data-extra=\"true\"></span></div>\\n  {{#if help_text_html}}\\n  <div class=\"helper\">{{{help_text_html}}}</div>\\n  {{else}}\\n  {{#if help_text}}<div class=\"helper\">{{help_text}}</div>{{/if}}\\n  {{/if}}\\n{{/unless}}\\n\\n<div class=\"input\">\\n  {{{row_html}}}\\n\\n  {{#if prefill}}<div class=\"fill-button {{#if busy}}busy{{/if}}\"></div>{{/if}}\\n\\n  {{#or choices givefill}}<div class=\"fill-button\"></div>{{/or}}\\n  \\n  {{#if userfill}}<div class=\"add-placeholder button\">Insert <span class=\"img16 {{#if userfillClass}}{{userfillClass}}{{else}}placeholder{{/if}}\"></span> fields</div>{{/if}}\\n\\n</div>\\n\\n\\n{{#if list}}\\n<div class=\"add-or-remove\">\\n  <div class=\"add\" title=\"Add or remove another field.\" data-id=\"{{key}}\"></div>\\n  <div class=\"remove\" title=\"Add or remove another field.\" data-id=\"{{key}}\"></div>\\n</div>\\n{{/if}}');window.JST[\"common_form_password_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"password\"\\n  value=\"{{val}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>')}).call(this);"
      },
      "https://zapier.cachefly.net/static/CUEKpp/build/external.js": {
         "pageUrl": "https://zapier.com/app/signup",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEKpp/build/external.js",
         "body": "(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!==\"undefined\"){if(typeof module!==\"undefined\"&&module.exports){exports=module.exports=_}exports._=_}else{root[\"_\"]=_}_.VERSION=\"1.4.2\";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return}}else{for(var key in obj){if(_.has(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError(\"Reduce of empty array with no initial value\");return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return arguments.length>2?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial)throw new TypeError(\"Reduce of empty array with no initial value\");return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){var results=[];if(obj==null)return results;each(obj,function(value,index,list){if(!iterator.call(context,value,index,list))results[results.length]=value});return results};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return!!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker});return!!result};_.contains=_.include=function(obj,target){var found=false;if(obj==null)return found;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;found=any(obj,function(value){return value===target});return found};_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs){if(_.isEmpty(attrs))return[];return _.filter(obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false}return true})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index<right.index?-1:1}),\"value\")};var group=function(obj,value,context,behavior){var result={};var iterator=lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)})};_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){if(!_.has(result,key))result[key]=0;result[key]++})};_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(obj.length===+obj.length)return slice.call(obj);return _.values(obj)};_.size=function(obj){return obj.length===+obj.length?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){if(n!=null&&!guard){return slice.call(array,Math.max(array.length-n,0))}else{return array[array.length-1]}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,function(value){return!!value})};var flatten=function(input,shallow,output){each(input,function(value){if(_.isArray(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?!index||seen[seen.length-1]!==value:!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(concat.apply(ArrayProto,arguments))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,\"length\"));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(args,\"\"+i)}return results};_.object=function(list,values){var result={};for(var i=0,l=list.length;i<l;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,l=array.length;if(isSorted){if(typeof isSorted==\"number\"){i=isSorted<0?Math.max(0,l+isSorted):isSorted}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<l;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=hasIndex?from:array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};var ctor=function(){};_.bind=function bind(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait){var context,args,timeout,throttling,more,result;var whenDone=_.debounce(function(){more=throttling=false},wait);return function(){context=this;args=arguments;var later=function(){timeout=null;if(more){result=func.apply(context,args)}whenDone()};if(!timeout)timeout=setTimeout(later,wait);if(throttling){more=true}else{throttling=true;result=func.apply(context,args)}whenDone();return result}};_.debounce=function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){if(times<=0)return func();return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError(\"Invalid object\");var keys=[];for(var key in obj)if(_.has(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){var values=[];for(var key in obj)if(_.has(obj,key))values.push(obj[key]);return values};_.pairs=function(obj){var pairs=[];for(var key in obj)if(_.has(obj,key))pairs.push([key,obj[key]]);return pairs};_.invert=function(obj){var result={};for(var key in obj)if(_.has(obj,key))result[obj[key]]=key;return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){obj[prop]=source[prop]}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key]});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key]}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(obj[prop]==null)obj[prop]=source[prop]}});return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case\"[object String]\":return a==String(b);case\"[object Number]\":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case\"[object Date]\":case\"[object Boolean]\":return+a==+b;case\"[object RegExp]\":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!=\"object\"||typeof b!=\"object\")return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b}aStack.push(a);bStack.push(b);var size=0,result=true;if(className==\"[object Array]\"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break}}}else{var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)){return false}for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}if(result){for(key in b){if(_.has(b,key)&&!size--)break}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==\"[object Array]\"};_.isObject=function(obj){return obj===Object(obj)};each([\"Arguments\",\"Function\",\"String\",\"Number\",\"Date\",\"RegExp\"],function(name){_[\"is\"+name]=function(obj){return toString.call(obj)==\"[object \"+name+\"]\"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,\"callee\"))}}if(typeof/./!==\"function\"){_.isFunction=function(obj){return typeof obj===\"function\"}}_.isFinite=function(obj){return _.isNumber(obj)&&isFinite(obj)};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==\"[object Boolean]\"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)};_.random=function(min,max){if(max==null){max=min;min=0}return min+(0|Math.random()*(max-min+1))};var entityMap={escape:{\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"/\":\"&#x2F;\"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp(\"[\"+_.keys(entityMap.escape).join(\"\")+\"]\",\"g\"),unescape:new RegExp(\"(\"+_.keys(entityMap.unescape).join(\"|\")+\")\",\"g\")};_.each([\"escape\",\"unescape\"],function(method){_[method]=function(string){if(string==null)return\"\";return(\"\"+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null)return null;var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};var noMatch=/(.)^/;var escapes={\"'\":\"'\",\"\\\\\":\"\\\\\",\"\\r\":\"r\",\"\\n\":\"n\",\"\t\":\"t\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"};var escaper=/\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;_.template=function(text,data,settings){settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join(\"|\")+\"|$\",\"g\");var index=0;var source=\"__p+='\";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return\"\\\\\"+escapes[match]});source+=escape?\"'+\\n((__t=(\"+escape+\"))==null?'':_.escape(__t))+\\n'\":interpolate?\"'+\\n((__t=(\"+interpolate+\"))==null?'':__t)+\\n'\":evaluate?\"';\\n\"+evaluate+\"\\n__p+='\":\"\";index=offset+match.length});source+=\"';\\n\";if(!settings.variable)source=\"with(obj||{}){\\n\"+source+\"}\\n\";source=\"var __t,__p='',__j=Array.prototype.join,\"+\"print=function(){__p+=__j.call(arguments,'');};\\n\"+source+\"return __p;\\n\";try{var render=new Function(settings.variable||\"obj\",\"_\",source)}catch(e){e.source=source;throw e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};template.source=\"function(\"+(settings.variable||\"obj\")+\"){\\n\"+source+\"}\";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==\"shift\"||name==\"splice\")&&obj.length===0)delete obj[0];return result.call(this,obj)}});each([\"concat\",\"join\",\"slice\"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p=\"1.9.1\",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,w=/\\S+/g,T=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,N=/^(?:(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,C=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,k=/^[\\],:{}\\s]*$/,E=/(?:^|:|,)(?:\\s*\\[)+/g,S=/\\\\(?:[\"\\\\\\/bfnrt]|u[\\da-fA-F]{4})/g,A=/\"[^\"\\\\\\r\\n]*\"|true|false|null|-?(?:\\d+\\.|)\\d+(?:[eE][+-]?\\d+|)/g,j=/^-ms-/,D=/-([\\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||\"load\"===e.type||\"complete\"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener(\"DOMContentLoaded\",H,!1),e.removeEventListener(\"load\",H,!1)):(o.detachEvent(\"onreadystatechange\",H),e.detachEvent(\"onload\",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e)return this;if(\"string\"==typeof e){if(i=\"<\"===e.charAt(0)&&\">\"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return r.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:\"\",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for(\"boolean\"==typeof s&&(c=s,s=arguments[1]||{},u=2),\"object\"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(o=arguments[u]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r));return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger(\"ready\").off(\"ready\"))}},isFunction:function(e){return\"function\"===b.type(e)},isArray:Array.isArray||function(e){return\"array\"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+\"\":\"object\"==typeof e||\"function\"==typeof e?l[m.call(e)]||\"object\":typeof e},isPlainObject:function(e){if(!e||\"object\"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,\"constructor\")&&!y.call(e.constructor.prototype,\"isPrototypeOf\"))return!1}catch(n){return!1}var r;for(r in e);return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||\"string\"!=typeof e)return null;\"boolean\"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:\"string\"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,\"@\").replace(A,\"]\").replace(E,\"\")))?Function(\"return \"+n)():(b.error(\"Invalid JSON: \"+n),t)},parseXML:function(n){var r,i;if(!n||\"string\"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,\"text/xml\")):(r=new ActiveXObject(\"Microsoft.XMLDOM\"),r.async=\"false\",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName(\"parsererror\").length||b.error(\"Invalid XML: \"+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,\"ms-\").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:v&&!v.call(\"\")?function(e){return null==e?\"\":v.call(e)}:function(e){return null==e?\"\":(e+\"\").replace(T,\"\")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,\"string\"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g)return g.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if(\"number\"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return\"string\"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if(\"object\"===b.type(r)){o=!0;for(u in r)b.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),\"complete\"===o.readyState)setTimeout(b.ready);else if(o.addEventListener)o.addEventListener(\"DOMContentLoaded\",H,!1),e.addEventListener(\"load\",H,!1);else{o.attachEvent(\"onreadystatechange\",H),e.attachEvent(\"onload\",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll(\"left\")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}return n.promise(t)},b.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),function(e,t){l[\"[object \"+t+\"]\"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:\"array\"===n||\"function\"!==n&&(0===t||\"number\"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e=\"string\"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);\"function\"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&\"string\"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1)u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return!u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},b.extend({Deferred:function(e){var t=[[\"resolve\",\"done\",b.Callbacks(\"once memory\"),\"resolved\"],[\"reject\",\"fail\",b.Callbacks(\"once memory\"),\"rejected\"],[\"notify\",\"progress\",b.Callbacks(\"memory\")]],n=\"pending\",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+\"With\"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+\"With\"](this===i?r:this,arguments),this},i[o[0]+\"With\"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1)for(s=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i;return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement(\"div\");if(d.setAttribute(\"className\",\"t\"),d.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",n=d.getElementsByTagName(\"*\"),r=d.getElementsByTagName(\"a\")[0],!n||!r||!n.length)return{};s=o.createElement(\"select\"),l=s.appendChild(o.createElement(\"option\")),a=d.getElementsByTagName(\"input\")[0],r.style.cssText=\"top:1px;float:left;opacity:.5\",t={getSetAttribute:\"t\"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName(\"tbody\").length,htmlSerialize:!!d.getElementsByTagName(\"link\").length,style:/top/.test(r.getAttribute(\"style\")),hrefNormalized:\"/a\"===r.getAttribute(\"href\"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement(\"form\").enctype,html5Clone:\"<:nav></:nav>\"!==o.createElement(\"nav\").cloneNode(!0).outerHTML,boxModel:\"CSS1Compat\"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement(\"input\"),a.setAttribute(\"value\",\"\"),t.input=\"\"===a.getAttribute(\"value\"),a.value=\"t\",a.setAttribute(\"type\",\"radio\"),t.radioValue=\"t\"===a.value,a.setAttribute(\"checked\",\"t\"),a.setAttribute(\"name\",\"t\"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent(\"onclick\",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c=\"on\"+f,\"t\"),t[f+\"Bubbles\"]=c in e||d.attributes[c].expando===!1;return d.style.backgroundClip=\"content-box\",d.cloneNode(!0).style.backgroundClip=\"\",t.clearCloneStyle=\"content-box\"===d.style.backgroundClip,b(function(){var n,r,a,s=\"padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;\",u=o.getElementsByTagName(\"body\")[0];u&&(n=o.createElement(\"div\"),n.style.cssText=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px\",u.appendChild(n).appendChild(d),d.innerHTML=\"<table><tr><td></td><td>t</td></tr></table>\",a=d.getElementsByTagName(\"td\"),a[0].style.cssText=\"padding:0;margin:0;border:0;display:none\",p=0===a[0].offsetHeight,a[0].style.display=\"\",a[1].style.display=\"none\",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML=\"\",d.style.cssText=\"box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;\",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition=\"1%\"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable=\"4px\"===(e.getComputedStyle(d,null)||{width:\"4px\"}).width,r=d.appendChild(o.createElement(\"div\")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width=\"0\",d.style.width=\"1px\",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML=\"\",d.style.cssText=s+\"width:1px;padding:1px;display:inline;zoom:1\",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display=\"block\",d.innerHTML=\"<div></div>\",d.firstChild.style.width=\"5px\",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)\n}),n=s=u=l=r=a=null,t}();var O=/(?:\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u=\"string\"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t)return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),(\"object\"==typeof n||\"function\"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(\" \"));for(r=0,i=t.length;i>r;r++)delete o[t[r]];if(!(n?$:b.isEmptyObject)(o))return}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:\"jQuery\"+(p+Math.random()).replace(/\\D/g,\"\"),noData:{embed:!0,object:\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute(\"classid\")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,\"parsedAttrs\"))){for(r=o.attributes;r.length>a;a++)i=r[a].name,i.indexOf(\"data-\")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]));b._data(o,\"parsedAttrs\",!0)}return s}return\"object\"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i=\"data-\"+n.replace(B,\"-$1\").toLowerCase();if(r=e.getAttribute(i),\"string\"==typeof r){try{r=\"true\"===r?!0:\"false\"===r?!1:\"null\"===r?null:+r+\"\"===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else r=t}return r}function $(e){var t;for(t in e)if((\"data\"!==t||!b.isEmptyObject(e[t]))&&\"toJSON\"!==t)return!1;return!0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||\"fx\")+\"queue\",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||\"fx\";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};\"inprogress\"===i&&(i=n.shift(),r--),o.cur=i,i&&(\"fx\"===t&&n.unshift(\"inprogress\"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+\"queueHooks\";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks(\"once memory\").add(function(){b._removeData(e,t+\"queue\"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return\"string\"!=typeof e&&(n=e,e=\"fx\",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),\"fx\"===e&&\"inprogress\"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||\"fx\",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||\"fx\",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};\"string\"!=typeof e&&(n=e,e=t),e=e||\"fx\";while(s--)r=b._data(a[s],e+\"queueHooks\"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var I,z,X=/[\\t\\r\\n]/g,U=/\\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=\"string\"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||\"\").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(\" \"+n.className+\" \").replace(X,\" \"):\" \")){o=0;while(i=t[o++])0>r.indexOf(\" \"+i+\" \")&&(r+=i+\" \");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||\"string\"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||\"\").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(\" \"+n.className+\" \").replace(X,\" \"):\"\")){o=0;while(i=t[o++])while(r.indexOf(\" \"+i+\" \")>=0)r=r.replace(\" \"+i+\" \",\" \");n.className=e?b.trim(r):\"\"}return this},toggleClass:function(e,t){var n=typeof e,r=\"boolean\"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(\"string\"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++])u=r?u:!s.hasClass(o),s[u?\"addClass\":\"removeClass\"](o)}else(n===i||\"boolean\"===n)&&(this.className&&b._data(this,\"__className__\",this.className),this.className=this.className||e===!1?\"\":b._data(this,\"__className__\")||\"\")})},hasClass:function(e){var t=\" \"+e+\" \",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(\" \"+this[n].className+\" \").replace(X,\" \").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o=\"\":\"number\"==typeof o?o+=\"\":b.isArray(o)&&(o=b.map(o,function(e){return null==e?\"\":e+\"\"})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&\"set\"in r&&r.set(this,o,\"value\")!==t||(this.value=o))});if(o)return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&\"get\"in r&&(n=r.get(o,\"value\"))!==t?n:(n=o.value,\"string\"==typeof n?n.replace(U,\"\"):null==n?\"\":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o=\"select-one\"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute(\"disabled\"))||n.parentNode.disabled&&b.nodeName(n.parentNode,\"optgroup\"))){if(t=b(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find(\"option\").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&\"get\"in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&\"set\"in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+\"\"),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase(\"default-\"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,\"\"),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&\"radio\"===t&&b.nodeName(e,\"input\")){var n=e.value;return e.setAttribute(\"type\",t),n&&(e.value=n),t}}}},propFix:{tabindex:\"tabIndex\",readonly:\"readOnly\",\"for\":\"htmlFor\",\"class\":\"className\",maxlength:\"maxLength\",cellspacing:\"cellSpacing\",cellpadding:\"cellPadding\",rowspan:\"rowSpan\",colspan:\"colSpan\",usemap:\"useMap\",frameborder:\"frameBorder\",contenteditable:\"contentEditable\"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&\"set\"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&\"get\"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode(\"tabindex\");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i=\"boolean\"==typeof r&&e.getAttribute(n),o=\"boolean\"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase(\"default-\"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase(\"default-\"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,\"input\")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,\"input\")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&(\"id\"===n||\"name\"===n||\"coords\"===n?\"\"!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+=\"\",\"value\"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,\"\"===t?!1:t,n)}},b.each([\"width\",\"height\"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return\"\"===r?(e.setAttribute(n,\"auto\"),r):t}})})),b.support.hrefNormalized||(b.each([\"href\",\"src\",\"width\",\"height\"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each([\"href\",\"src\"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+\"\"}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype=\"encoding\"),b.support.checkOn||b.each([\"radio\",\"checkbox\"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute(\"value\")?\"on\":e.value}}}),b.each([\"radio\",\"checkbox\"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\\.(.+)|)$/;function it(){return!0}function ot(){return!1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||\"\").match(w)||[\"\"],l=n.length;while(l--)s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||\"\").split(\".\").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(\".\")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent(\"on\"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0;e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||\"\").match(w)||[\"\"],l=t.length;while(l--)if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||\"\").split(\".\").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp(\"(^|\\\\.)\"+h.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),u=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&(\"**\"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,\"events\"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,\"type\")?n.type:n,m=y.call(n,\"namespace\")?n.namespace.split(\".\"):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(\".\")>=0&&(m=g.split(\".\"),g=m.shift(),m.sort()),u=0>g.indexOf(\":\")&&\"on\"+g,n=n[b.expando]?n:new b.Event(g,\"object\"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join(\".\"),n.namespace_re=n.namespace?RegExp(\"(^|\\\\.)\"+m.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode)h.push(l),f=l;f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(b._data(l,\"events\")||{})[n.type]&&b._data(l,\"handle\"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault();if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||\"click\"===g&&b.nodeName(i,\"a\")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,\"events\")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||\"click\"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||\"click\"!==e.type)){for(o=[],a=0;u>a;a++)i=n[a],r=i.selector+\" \",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--)n=r[t],e[n]=a[n];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:\"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),fixHooks:{},keyHooks:{props:\"char charCode key keyCode\".split(\" \"),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:\"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,\"input\")&&\"checkbox\"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:\"focusin\"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:\"focusout\"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r=\"on\"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,\"form\")?!1:(b.event.add(this,\"click._submit keypress._submit\",function(e){var n=e.target,r=b.nodeName(n,\"input\")||b.nodeName(n,\"button\")?n.form:t;r&&!b._data(r,\"submitBubbles\")&&(b.event.add(r,\"submit._submit\",function(e){e._submit_bubble=!0}),b._data(r,\"submitBubbles\",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate(\"submit\",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,\"form\")?!1:(b.event.remove(this,\"._submit\"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?((\"checkbox\"===this.type||\"radio\"===this.type)&&(b.event.add(this,\"propertychange._change\",function(e){\"checked\"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,\"click._change\",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate(\"change\",this,e,!0)})),!1):(b.event.add(this,\"beforeactivate._change\",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,\"changeBubbles\")&&(b.event.add(t,\"change._change\",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate(\"change\",this.parentNode,e,!0)}),b._data(t,\"changeBubbles\",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||\"radio\"!==n.type&&\"checkbox\"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,\"._change\"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:\"focusin\",blur:\"focusout\"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if(\"object\"==typeof e){\"string\"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&(\"string\"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+\".\"+i.namespace:i.origType,i.selector,i.handler),this;if(\"object\"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||\"function\"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,\"**\"):this.off(t,e||\"**\",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x=\"sizzle\"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},_=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",F=\"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",O=F.replace(\"w\",\"w#\"),B=\"([*^$|!~]?=)\",P=\"\\\\[\"+_+\"*(\"+F+\")\"+_+\"*(?:\"+B+_+\"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\"+O+\")|)|)\"+_+\"*\\\\]\",R=\":(\"+F+\")(?:\\\\(((['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\"+P.replace(3,8)+\")*)|.*)\\\\)|)\",W=RegExp(\"^\"+_+\"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\"+_+\"+$\",\"g\"),$=RegExp(\"^\"+_+\"*,\"+_+\"*\"),I=RegExp(\"^\"+_+\"*([\\\\x20\\\\t\\\\r\\\\n\\\\f>+~])\"+_+\"*\"),z=RegExp(R),X=RegExp(\"^\"+O+\"$\"),U={ID:RegExp(\"^#(\"+F+\")\"),CLASS:RegExp(\"^\\\\.(\"+F+\")\"),NAME:RegExp(\"^\\\\[name=['\\\"]?(\"+F+\")['\\\"]?\\\\]\"),TAG:RegExp(\"^(\"+F.replace(\"w\",\"w*\")+\")\"),ATTR:RegExp(\"^\"+P),PSEUDO:RegExp(\"^\"+R),CHILD:RegExp(\"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+_+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+_+\"*(?:([+-]|)\"+_+\"*(\\\\d+)|))\"+_+\"*\\\\)|)\",\"i\"),needsContext:RegExp(\"^\"+_+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+_+\"*((?:-\\\\d)?\\\\d*)\"+_+\"*\\\\)|)(?=[^-]|$)\",\"i\")},V=/[\\x20\\t\\r\\n\\f]*[+~]/,Y=/^[^{]+\\{\\s*\\[native code/,J=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\\d$/i,K=/'|\\\\/g,Z=/\\=[\\x20\\t\\r\\n\\f]*([^'\"\\]]*)[\\x20\\t\\r\\n\\f]*\\]/g,et=/\\\\([\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|.)/g,tt=function(e,t){var n=\"0x\"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}function rt(e){return Y.test(e+\"\")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=\" \")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement(\"div\");try{return e(t)}catch(n){return!1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||\"string\"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(!d&&!r){if(i=J.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return H.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((a=i[3])&&T.getByClassName&&t.getElementsByClassName)return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&\"object\"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute(\"id\"))?g=f.replace(K,\"\\\\$&\"):t.setAttribute(\"id\",g),g=\"[id='\"+g+\"'] \",u=l.length;while(u--)l[u]=g+dt(l[u]);m=V.test(e)&&t.parentNode||t,v=l.join(\",\")}if(v)try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute(\"id\")}}}return wt(e.replace(W,\"$1\"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?\"HTML\"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment(\"\")),!e.getElementsByTagName(\"*\").length}),T.attributes=at(function(e){e.innerHTML=\"<select></select>\";var t=typeof e.lastChild.getAttribute(\"multiple\");return\"boolean\"!==t&&\"string\"!==t}),T.getByClassName=at(function(e){return e.innerHTML=\"<div class='hidden e'></div><div class='hidden'></div>\",e.getElementsByClassName&&e.getElementsByClassName(\"e\").length?(e.lastChild.className=\"e\",2===e.getElementsByClassName(\"e\").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML=\"<a name='\"+x+\"'></a><div name='\"+x+\"'></div>\",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML=\"<a href='#'></a>\",e.firstChild&&typeof e.firstChild.getAttribute!==A&&\"#\"===e.firstChild.getAttribute(\"href\")})?{}:{href:function(e){return e.getAttribute(\"href\",2)},type:function(e){return e.getAttribute(\"type\")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute(\"id\")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode(\"id\").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode(\"id\");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if(\"*\"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[\":focus\"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML=\"<select><option selected=''></option></select>\",e.querySelectorAll(\"[selected]\").length||h.push(\"\\\\[\"+_+\"*(?:checked|disabled|ismap|multiple|readonly|selected|value)\"),e.querySelectorAll(\":checked\").length||h.push(\":checked\")}),at(function(e){e.innerHTML=\"<input type='hidden' i=''/>\",e.querySelectorAll(\"[i^='']\").length&&h.push(\"[*^$]=\"+_+\"*(?:\\\"\\\"|'')\"),e.querySelectorAll(\":enabled\").length||h.push(\":enabled\",\":disabled\"),e.querySelectorAll(\"*,:x\"),h.push(\",.*:\")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,\"div\"),m.call(e,\"[s!='']:x\"),g.push(\"!=\",R)}),h=RegExp(h.join(\"|\")),g=RegExp(g.join(\"|\")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return u=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return ut(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,\"='$1']\"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t)))try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error(\"Syntax error, unrecognized expression: \"+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return\"input\"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return(\"input\"===n||\"button\"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}o=st.getText=function(e){var t,n=\"\",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if(\"string\"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||\"\").replace(et,tt),\"~=\"===e[2]&&(e[3]=\" \"+e[3]+\" \"),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),\"nth\"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(\"even\"===e[3]||\"odd\"===e[3])),e[5]=+(e[7]+e[8]||\"odd\"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(\")\",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return\"*\"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+\" \"];return t||(t=RegExp(\"(^|\"+_+\")\"+e+\"(\"+_+\"|$)\"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute(\"class\")||\"\")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?\"!=\"===t:t?(i+=\"\",\"=\"===t?i===n:\"!=\"===t?i!==n:\"^=\"===t?n&&0===i.indexOf(n):\"*=\"===t?n&&i.indexOf(n)>-1:\"$=\"===t?n&&i.slice(-n.length)===n:\"~=\"===t?(\" \"+i+\" \").indexOf(n)>-1:\"|=\"===t?i===n||i.slice(0,n.length+1)===n+\"-\":!1):!0}},CHILD:function(e,t,n,r,i){var o=\"nth\"!==e.slice(0,3),a=\"last\"!==e.slice(-4),s=\"of-type\"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?\"nextSibling\":\"previousSibling\",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;\nh=g=\"only\"===e&&!h&&\"nextSibling\"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}else if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N)f=l[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error(\"unsupported pseudo: \"+e);return r[x]?r(t):r.length>1?(n=[e,e,\"\",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,\"$1\"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||\"\")||st.error(\"unsupported lang: \"+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=d?t.getAttribute(\"xml:lang\")||t.getAttribute(\"lang\"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+\"-\");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&!!e.checked||\"option\"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>\"@\"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&\"button\"===e.type||\"button\"===t},text:function(e){var t;return\"input\"===e.nodeName.toLowerCase()&&\"text\"===e.type&&(null==(t=e.getAttribute(\"type\"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=lt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=ct(n);function ft(e,t){var n,r,o,a,s,u,l,c=E[e+\" \"];if(c)return t?0:c.slice(0);s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W,\" \")}),s=s.slice(n.length));for(a in i.filter)!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r=\"\";for(;n>t;t++)r+=e[t].value;return r}function ht(e,t,n){var i=t.dir,o=n&&\"parentNode\"===i,a=C++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,s){var u,l,c,p=N+\" \"+a;if(s){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0)return!0}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||\"*\",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--)(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}else y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[\" \"],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++)if(n=i.relative[e[u].type])f=[ht(gt(f),n)];else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++)if(i.relative[e[r].type])break;return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,\"$1\"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b=\"0\",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG(\"*\",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,u,c)){f.push(h);break}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++])m(x,y,u,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=L.call(f));y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+\" \"];if(!o){t||(t=ft(e)),n=t.length;while(n--)o=vt(t[n]),o[x]?r.push(o):i.push(o);o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&\"ID\"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type])break;if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e)return H.apply(n,q.call(r,0)),n;break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[\":\"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\\[\\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if(\"string\"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+\" \":\"\")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return!!e&&(\"string\"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||\"string\"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?\"string\"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=\"string\"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,\"parentNode\")},parentsUntil:function(e,t,n){return b.dir(e,\"parentNode\",n)},next:function(e){return pt(e,\"nextSibling\")},prev:function(e){return pt(e,\"previousSibling\")},nextAll:function(e){return b.dir(e,\"nextSibling\")},prevAll:function(e){return b.dir(e,\"previousSibling\")},nextUntil:function(e,t,n){return b.dir(e,\"nextSibling\",n)},prevUntil:function(e,t,n){return b.dir(e,\"previousSibling\",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,\"iframe\")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&\"string\"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=\":not(\"+e+\")\"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if(\"string\"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split(\"|\"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht=\"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",gt=/ jQuery\\d+=\"(?:null|\\d+)\"/g,mt=RegExp(\"<(?:\"+ht+\")[\\\\s/>]\",\"i\"),yt=/^\\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,bt=/<([\\w:]+)/,xt=/<tbody/i,wt=/<|&#?\\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\\s*(?:[^=]|=\\s*.checked.)/i,kt=/^$|\\/(?:java|ecma)script/i,Et=/^true\\/(.*)/,St=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,At={option:[1,\"<select multiple='multiple'>\",\"</select>\"],legend:[1,\"<fieldset>\",\"</fieldset>\"],area:[1,\"<map>\",\"</map>\"],param:[1,\"<object>\",\"</object>\"],thead:[1,\"<table>\",\"</table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],col:[2,\"<table><tbody></tbody><colgroup>\",\"</colgroup></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],_default:b.support.htmlSerialize?[0,\"\",\"\"]:[1,\"X<div>\",\"</div>\"]},jt=dt(o),Dt=jt.appendChild(o.createElement(\"div\"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,\"body\")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,\"script\")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,\"select\")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,\"\"):t;if(!(\"string\"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||[\"\",\"\"])[1].toLowerCase()])){e=e.replace(vt,\"<$1></$2>\");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||\"string\"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||\"string\"!=typeof g||b.support.checkClone)&&Ct.test(g))return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)});if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,\"tr\"),s=b.map(Ot(l,\"script\"),Ht),a=s.length;p>c;c++)o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,\"script\"))),r.call(n&&b.nodeName(this[c],\"table\")?Lt(this[c],\"tbody\"):this[c],o,c);if(a)for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++)o=s[c],kt.test(o.type||\"\")&&!b._data(o,\"globalEval\")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:\"GET\",dataType:\"script\",async:!1,global:!1,\"throws\":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||\"\").replace(St,\"\")));l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode(\"type\");return e.type=(t&&t.specified)+\"/\"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute(\"type\"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,\"globalEval\",!t||b._data(t[r],\"globalEval\"))}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)b.event.add(t,n,s[n][r])}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}\"script\"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):\"object\"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):\"input\"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):\"option\"===n?t.defaultSelected=t.selected=e.defaultSelected:(\"input\"===n||\"textarea\"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||\"*\"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||\"*\"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test(\"<\"+e.nodeName+\">\")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a)r[a]&&Ft(i,r[a]);if(t)if(n)for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++)_t(i,r[a]);else _t(e,o);return r=Ot(o,\"script\"),r.length>0&&Mt(r,!u&&Ot(e,\"script\")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if(\"object\"===b.type(o))b.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement(\"div\")),u=(bt.exec(o)||[\"\",\"\"])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,\"<$1></$2>\")+c[2],i=c[0];while(i--)s=s.lastChild;if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o=\"table\"!==u||xt.test(o)?\"<table>\"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)b.nodeName(l=o.childNodes[i],\"tbody\")&&!l.childNodes.length&&o.removeChild(l)}b.merge(d,s.childNodes),s.textContent=\"\";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,\"input\"),Bt),h=0;while(o=d[h++])if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),\"script\"),a&&Mt(s),n)){i=0;while(o=s[i++])kt.test(o.type||\"\")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++)if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events)for(r in a.events)f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle);l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}});var Pt,Rt,Wt,$t=/alpha\\([^)]*\\)/i,It=/opacity\\s*=\\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp(\"^(\"+x+\")(.*)$\",\"i\"),Yt=RegExp(\"^(\"+x+\")(?!px)[a-z%]+$\",\"i\"),Jt=RegExp(\"^([+-])=(\"+x+\")\",\"i\"),Gt={BODY:\"block\"},Qt={position:\"absolute\",visibility:\"hidden\",display:\"block\"},Kt={letterSpacing:0,fontWeight:400},Zt=[\"Top\",\"Right\",\"Bottom\",\"Left\"],en=[\"Webkit\",\"O\",\"Moz\",\"ms\"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,\"none\"===b.css(e,\"display\")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=b._data(r,\"olddisplay\"),n=r.style.display,t?(o[a]||\"none\"!==n||(r.style.display=\"\"),\"\"===r.style.display&&nn(r)&&(o[a]=b._data(r,\"olddisplay\",un(r.nodeName)))):o[a]||(i=nn(r),(n&&\"none\"!==n||!i)&&b._data(r,\"olddisplay\",i?n:b.css(r,\"display\"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&\"none\"!==r.style.display&&\"\"!==r.style.display||(r.style.display=t?o[a]||\"\":\"none\"));return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=b.css(e,n[s],!1,o);return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t=\"boolean\"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,\"opacity\");return\"\"===n?\"1\":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":b.support.cssFloat?\"cssFloat\":\"styleFloat\"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t)return s&&\"get\"in s&&(o=s.get(e,!1,i))!==t?o:l[n];if(a=typeof r,\"string\"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a=\"number\"),!(null==r||\"number\"===a&&isNaN(r)||(\"number\"!==a||b.cssNumber[u]||(r+=\"px\"),b.support.clearCloneStyle||\"\"!==r||0!==n.indexOf(\"background\")||(l[n]=\"inherit\"),s&&\"set\"in s&&(r=s.set(e,r,i))===t)))try{l[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&\"get\"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),\"normal\"===a&&n in Kt&&(a=Kt[n]),\"\"===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(\"\"!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left=\"fontSize\"===n?\"1em\":u,u=l.pixelLeft+\"px\",l.left=i,a&&(o.left=a)),\"\"===u?\"auto\":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||\"px\"):t}function an(e,t,n,r,i){var o=n===(r?\"border\":\"content\")?4:\"width\"===t?1:0,a=0;for(;4>o;o+=2)\"margin\"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?(\"content\"===n&&(a-=b.css(e,\"padding\"+Zt[o],!0,i)),\"margin\"!==n&&(a-=b.css(e,\"border\"+Zt[o]+\"Width\",!0,i))):(a+=b.css(e,\"padding\"+Zt[o],!0,i),\"padding\"!==n&&(a+=b.css(e,\"border\"+Zt[o]+\"Width\",!0,i)));return a}function sn(e,t,n){var r=!0,i=\"width\"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&\"border-box\"===b.css(e,\"boxSizing\",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?\"border\":\"content\"),r,o)+\"px\"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),\"none\"!==n&&n||(Pt=(Pt||b(\"<iframe frameborder='0' width='0' height='0'/>\").css(\"cssText\",\"display:block !important\")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write(\"<!doctype html><html><body>\"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],\"display\");return n.remove(),r}b.each([\"height\",\"width\"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,\"display\"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&\"border-box\"===b.css(e,\"boxSizing\",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||\"\")?.01*parseFloat(RegExp.$1)+\"\":t?\"1\":\"\"},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?\"alpha(opacity=\"+100*t+\")\":\"\",o=r&&r.filter||n.filter||\"\";n.zoom=1,(t>=1||\"\"===t)&&\"\"===b.trim(o.replace($t,\"\"))&&n.removeAttribute&&(n.removeAttribute(\"filter\"),\"\"===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+\" \"+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:\"inline-block\"},Wt,[e,\"marginRight\"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each([\"top\",\"left\"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+\"px\":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&\"none\"===(e.style&&e.style.display||b.css(e,\"display\"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:\"\",padding:\"\",border:\"Width\"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o=\"string\"==typeof n?n.split(\" \"):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\\[\\]$/,fn=/\\r?\\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,\"elements\");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(\":disabled\")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,\"\\r\\n\")}}):{name:t.name,value:n.replace(fn,\"\\r\\n\")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?\"\":t,i[i.length]=encodeURIComponent(e)+\"=\"+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join(\"&\").replace(cn,\"+\")};function gn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+\"[\"+(\"object\"==typeof i?t:\"\")+\"]\",i,n,r)});else if(n||\"object\"!==b.type(t))r(e,t);else for(i in t)gn(e+\"[\"+i+\"]\",t[i],n,r)}b.each(\"blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu\".split(\" \"),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\\/\\//,En=/^([\\w.+-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn=\"*/\".concat(\"*\");try{yn=a.href}catch(Ln){yn=o.createElement(\"a\"),yn.href=\"\",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){\"string\"!=typeof t&&(n=t,t=\"*\");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n))while(r=o[i++])\"+\"===r[0]?(r=r.slice(1)||\"*\",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return\"string\"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o[\"*\"]&&s(\"*\")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if(\"string\"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(\" \");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&\"object\"==typeof n&&(a=\"POST\"),s.length>0&&b.ajax({url:e,type:a,dataType:\"html\",data:n}).done(function(e){o=arguments,s.html(i?b(\"<div>\").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each([\"get\",\"post\"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:\"GET\",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":Dn,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:\"responseXML\",text:\"responseText\"},converters:{\"* text\":e.String,\"text html\":!0,\"text json\":b.parseJSON,\"text xml\":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){\"object\"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks(\"once memory\"),m=p.statusCode||{},y={},v={},x=0,T=\"canceled\",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else N.always(e[N.status]);return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+\"\").replace(xn,\"\").replace(kn,mn[1]+\"//\"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||\"*\").toLowerCase().match(w)||[\"\"],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||(\"http:\"===r[1]?80:443))==(mn[3]||(\"http:\"===mn[1]?80:443)))),p.data&&p.processData&&\"string\"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x)return N;u=p.global,u&&0===b.active++&&b.event.trigger(\"ajaxStart\"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?\"&\":\"?\")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,\"$1_=\"+vn++):o+(bn.test(o)?\"&\":\"?\")+\"_=\"+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader(\"If-Modified-Since\",b.lastModified[o]),b.etag[o]&&N.setRequestHeader(\"If-None-Match\",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader(\"Content-Type\",p.contentType),N.setRequestHeader(\"Accept\",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+(\"*\"!==p.dataTypes[0]?\", \"+Dn+\"; q=0.01\":\"\"):p.accepts[\"*\"]);for(i in p.headers)N.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x))return N.abort();T=\"abort\";for(i in{success:1,error:1,complete:1})N[i](p[i]);if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger(\"ajaxSend\",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort(\"timeout\")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x))throw C;k(-1,C)}}else k(-1,\"No Transport\");function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||\"\",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader(\"Last-Modified\"),T&&(b.lastModified[o]=T),T=N.getResponseHeader(\"etag\"),T&&(b.etag[o]=T)),204===e?(c=!0,C=\"nocontent\"):304===e?(c=!0,C=\"notmodified\"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C=\"error\",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+\"\",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?\"ajaxSuccess\":\"ajaxError\",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger(\"ajaxComplete\",[N,p]),--b.active||b.event.trigger(\"ajaxStop\")))\n}return N},getScript:function(e,n){return b.get(e,t,n,\"script\")},getJSON:function(e,t,n){return b.get(e,t,n,\"json\")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c)s in r&&(n[c[s]]=r[s]);while(\"*\"===l[0])l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader(\"Content-Type\"));if(o)for(s in u)if(u[s]&&u[s].test(o)){l.unshift(s);break}if(l[0]in r)a=l[0];else{for(s in r){if(!l[0]||e.converters[s+\" \"+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1])for(i in e.converters)a[i.toLowerCase()]=e.converters[i];for(;r=u[++s];)if(\"*\"!==r){if(\"*\"!==l&&l!==r){if(i=a[l+\" \"+r]||a[\"* \"+r],!i)for(n in a)if(o=n.split(\" \"),o[1]===r&&(i=a[l+\" \"+o[0]]||a[\"* \"+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}if(i!==!0)if(i&&e[\"throws\"])t=i(t);else try{t=i(t)}catch(c){return{state:\"parsererror\",error:i?c:\"No conversion from \"+l+\" to \"+r}}}l=r}return{state:\"success\",data:t}}b.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/(?:java|ecma)script/},converters:{\"text script\":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter(\"script\",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type=\"GET\",e.global=!1)}),b.ajaxTransport(\"script\",function(e){if(e.crossDomain){var n,r=o.head||b(\"head\")[0]||o.documentElement;return{send:function(t,i){n=o.createElement(\"script\"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,\"success\"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\\?(?=&|$)|\\?\\?/;b.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var e=On.pop()||b.expando+\"_\"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter(\"json jsonp\",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?\"url\":\"string\"==typeof n.data&&!(n.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&Bn.test(n.data)&&\"data\");return u||\"jsonp\"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,\"$1\"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?\"&\":\"?\")+n.jsonp+\"=\"+o),n.converters[\"script json\"]=function(){return s||b.error(o+\" was not called\"),s[0]},n.dataTypes[0]=\"json\",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),\"script\"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject(\"Microsoft.XMLHTTP\")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&\"withCredentials\"in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)u[s]=n.xhrFields[s];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i[\"X-Requested-With\"]||(i[\"X-Requested-With\"]=\"XMLHttpRequest\");try{for(s in i)u.setRequestHeader(s,i[s])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState))if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i)4!==u.readyState&&u.abort();else{p={},s=u.status,l=u.getAllResponseHeaders(),\"string\"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=\"\"}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp(\"^(?:([+-])=|)(\"+x+\")([a-z%]*)$\",\"i\"),Jn=/queueHooks$/,Gn=[nr],Qn={\"*\":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?\"\":\"px\"),\"px\"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do u=u||\".5\",s/=u,b.style(i.elem,e,s+r);while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn[\"*\"]),i=0,o=r.length;for(;o>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++)if(r=Gn[o].call(l,e,c,l.opts))return r;return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e)if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&\"expand\"in a){n=a.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=o)}else t[r]=o}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=[\"*\"]):e=e.split(\" \");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,\"fx\"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,\"fx\").length||c.empty.fire()})})),1===e.nodeType&&(\"height\"in t||\"width\"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],\"inline\"===b.css(e,\"display\")&&\"none\"===b.css(e,\"float\")&&(b.support.inlineBlockNeedsLayout&&\"inline\"!==un(e.nodeName)?d.zoom=1:d.display=\"inline-block\")),n.overflow&&(d.overflow=\"hidden\",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||\"toggle\"===a,a===(m?\"hide\":\"show\"))continue;g.push(i)}if(o=g.length){s=b._data(e,\"fxshow\")||b._data(e,\"fxshow\",{}),\"hidden\"in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,\"fxshow\");for(t in h)b.style(e,t,h[t])});for(i=0;o>i;i++)r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start=\"width\"===r||\"height\"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||\"swing\",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?\"\":\"px\")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,\"\"),t&&\"auto\"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each([\"toggle\",\"show\",\"hide\"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||\"boolean\"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css(\"opacity\",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,\"finish\"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return\"string\"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||\"fx\",[]),this.each(function(){var t=!0,n=null!=e&&e+\"queueHooks\",o=b.timers,a=b._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||\"fx\"),this.each(function(){var t,n=b._data(this),r=n[e+\"queue\"],i=n[e+\"queueHooks\"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r[\"margin\"+n]=r[\"padding\"+n]=e;return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir(\"show\"),slideUp:ir(\"hide\"),slideToggle:ir(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&\"object\"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:\"number\"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue=\"fx\"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},b.offset={setOffset:function(e,t,n){var r=b.css(e,\"position\");\"static\"===r&&(e.style.position=\"relative\");var i=b(e),o=i.offset(),a=b.css(e,\"top\"),s=b.css(e,\"left\"),u=(\"absolute\"===r||\"fixed\"===r)&&b.inArray(\"auto\",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),\"using\"in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return\"fixed\"===b.css(r,\"position\")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],\"html\")||(n=e.offset()),n.top+=b.css(e[0],\"borderTopWidth\",!0),n.left+=b.css(e[0],\"borderLeftWidth\",!0)),{top:t.top-n.top-b.css(r,\"marginTop\",!0),left:t.left-n.left-b.css(r,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,\"html\")&&\"static\"===b.css(e,\"position\"))e=e.offsetParent;return e||o.documentElement})}}),b.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:\"height\",Width:\"width\"},function(e,n){b.each({padding:\"inner\"+e,content:n,\"\":\"outer\"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||\"boolean\"!=typeof i),s=r||(i===!0||o===!0?\"margin\":\"border\");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement[\"client\"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body[\"scroll\"+e],o[\"scroll\"+e],n.body[\"offset\"+e],o[\"offset\"+e],o[\"client\"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,\"function\"==typeof define&&define.amd&&define.amd.jQuery&&define(\"jquery\",[],function(){return b})})(window);(function(factory){if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(jQuery)}})(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler(\"remove\")}catch(e){}}_cleanData(elems)};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(\".\")[0];name=name.split(\".\")[1];fullName=namespace+\"-\"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[\":\"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+\".\"+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor)};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options===\"string\",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error(\"cannot call methods on \"+name+\" prior to initialization; \"+\"attempted to call method '\"+options+\"'\")}if(!$.isFunction(instance[options])||options.charAt(0)===\"_\"){return $.error(\"no such method '\"+options+\"' for \"+name+\" widget instance\")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init()}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:\"widget\",widgetEventPrefix:\"\",defaultElement:\"<div>\",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace=\".\"+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger(\"create\",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr(\"aria-disabled\").removeClass(this.widgetFullName+\"-disabled \"+\"ui-state-disabled\");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass(\"ui-state-hover\");this.focusable.removeClass(\"ui-state-focus\")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key===\"string\"){options={};parts=key.split(\".\");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key===\"disabled\"){this.widget().toggleClass(this.widgetFullName+\"-disabled ui-state-disabled\",!!value).attr(\"aria-disabled\",value);this.hoverable.removeClass(\"ui-state-hover\");this.focusable.removeClass(\"ui-state-focus\")}return this},enable:function(){return this._setOption(\"disabled\",false)},disable:function(){return this._setOption(\"disabled\",true)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!==\"boolean\"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass(\"ui-state-disabled\"))){return}return(typeof handler===\"string\"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!==\"string\"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^(\\w+)\\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||\"\").split(\" \").join(this.eventNamespace+\" \")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler===\"string\"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass(\"ui-state-hover\")},mouseleave:function(event){$(event.currentTarget).removeClass(\"ui-state-hover\")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass(\"ui-state-focus\")},focusout:function(event){$(event.currentTarget).removeClass(\"ui-state-focus\")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:\"fadeIn\",hide:\"fadeOut\"},function(method,defaultEffect){$.Widget.prototype[\"_\"+method]=function(element,options,callback){if(typeof options===\"string\"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options===\"number\"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options===\"number\"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}})});window.CodeMirror=function(){\"use strict\";var gecko=/gecko\\/\\d/i.test(navigator.userAgent);var ie=/MSIE \\d/.test(navigator.userAgent);var ie_lt8=ie&&(document.documentMode==null||document.documentMode<8);var ie_lt9=ie&&(document.documentMode==null||document.documentMode<9);var webkit=/WebKit\\//.test(navigator.userAgent);var qtwebkit=webkit&&/Qt\\/\\d+\\.\\d+/.test(navigator.userAgent);var chrome=/Chrome\\//.test(navigator.userAgent);var opera=/Opera\\//.test(navigator.userAgent);var safari=/Apple Computer/.test(navigator.vendor);var khtml=/KHTML\\//.test(navigator.userAgent);var mac_geLion=/Mac OS X 1\\d\\D([7-9]|\\d\\d)\\D/.test(navigator.userAgent);var mac_geMountainLion=/Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(navigator.userAgent);var phantom=/PhantomJS/.test(navigator.userAgent);var ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\\/\\w+/.test(navigator.userAgent);var mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var mac=ios||/Mac/.test(navigator.platform);var windows=/windows/i.test(navigator.platform);var opera_version=opera&&navigator.userAgent.match(/Version\\/(\\d*\\.\\d*)/);if(opera_version)opera_version=Number(opera_version[1]);var flipCtrlCmd=mac&&(qtwebkit||opera&&(opera_version==null||opera_version<12.11));var captureMiddleClick=gecko||ie&&!ie_lt9;var sawReadOnlySpans=false,sawCollapsedSpans=false;function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options||{};for(var opt in defaults)if(!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt))options[opt]=defaults[opt];setGuttersForLineNumbers(options);var docStart=typeof options.value==\"string\"?0:options.value.first;var display=this.display=makeDisplay(place,docStart);display.wrapper.CodeMirror=this;updateGutters(this);if(options.autofocus&&!mobile)focusInput(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,draggingText:false,highlight:new Delayed};themeChanged(this);if(options.lineWrapping)this.display.wrapper.className+=\" CodeMirror-wrap\";var doc=options.value;if(typeof doc==\"string\")doc=new Doc(options.value,options.mode);operation(this,attachDoc)(this,doc);if(ie)setTimeout(bind(resetInput,this,true),20);registerEventHandlers(this);var hasFocus;try{hasFocus=document.activeElement==display.input}catch(e){}if(hasFocus||options.autofocus&&!mobile)setTimeout(bind(onFocus,this),20);else onBlur(this);operation(this,function(){for(var opt in optionHandlers)if(optionHandlers.propertyIsEnumerable(opt))optionHandlers[opt](this,options[opt],Init);for(var i=0;i<initHooks.length;++i)initHooks[i](this)})()}function makeDisplay(place,docStart){var d={};var input=d.input=elt(\"textarea\",null,null,\"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;\");if(webkit)input.style.width=\"1000px\";else input.setAttribute(\"wrap\",\"off\");if(ios)input.style.border=\"1px solid black\";input.setAttribute(\"autocorrect\",\"off\");input.setAttribute(\"autocapitalize\",\"off\");input.setAttribute(\"spellcheck\",\"false\");d.inputDiv=elt(\"div\",[input],null,\"overflow: hidden; position: relative; width: 3px; height: 0px;\");d.scrollbarH=elt(\"div\",[elt(\"div\",null,null,\"height: 1px\")],\"CodeMirror-hscrollbar\");d.scrollbarV=elt(\"div\",[elt(\"div\",null,null,\"width: 1px\")],\"CodeMirror-vscrollbar\");d.scrollbarFiller=elt(\"div\",null,\"CodeMirror-scrollbar-filler\");d.gutterFiller=elt(\"div\",null,\"CodeMirror-gutter-filler\");d.lineDiv=elt(\"div\",null,\"CodeMirror-code\");d.selectionDiv=elt(\"div\",null,null,\"position: relative; z-index: 1\");d.cursor=elt(\"div\",\"\",\"CodeMirror-cursor\");d.otherCursor=elt(\"div\",\"\",\"CodeMirror-cursor CodeMirror-secondarycursor\");d.measure=elt(\"div\",null,\"CodeMirror-measure\");d.lineSpace=elt(\"div\",[d.measure,d.selectionDiv,d.lineDiv,d.cursor,d.otherCursor],null,\"position: relative; outline: none\");d.mover=elt(\"div\",[elt(\"div\",[d.lineSpace],\"CodeMirror-lines\")],null,\"position: relative\");d.sizer=elt(\"div\",[d.mover],\"CodeMirror-sizer\");d.heightForcer=elt(\"div\",null,null,\"position: absolute; height: \"+scrollerCutOff+\"px; width: 1px;\");d.gutters=elt(\"div\",null,\"CodeMirror-gutters\");d.lineGutter=null;d.scroller=elt(\"div\",[d.sizer,d.heightForcer,d.gutters],\"CodeMirror-scroll\");d.scroller.setAttribute(\"tabIndex\",\"-1\");d.wrapper=elt(\"div\",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.gutterFiller,d.scroller],\"CodeMirror\");if(ie_lt8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0}if(place.appendChild)place.appendChild(d.wrapper);else place(d.wrapper);if(ios)input.style.width=\"0px\";if(!webkit)d.scroller.draggable=true;if(khtml){d.inputDiv.style.height=\"1px\";d.inputDiv.style.position=\"absolute\"}else if(ie_lt8)d.scrollbarH.style.minWidth=d.scrollbarV.style.minWidth=\"18px\";d.viewOffset=d.lastSizeC=0;d.showingFrom=d.showingTo=docStart;d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;d.prevInput=\"\";d.alignWidgets=false;d.pollingFast=false;d.poll=new Delayed;d.cachedCharWidth=d.cachedTextHeight=null;d.measureLineCache=[];d.measureLineCachePos=0;d.inaccurateSelection=false;d.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;return d}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption);cm.doc.iter(function(line){if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null});cm.doc.frontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp)regChange(cm)}function wrappingChanged(cm){if(cm.options.lineWrapping){cm.display.wrapper.className+=\" CodeMirror-wrap\";cm.display.sizer.style.minWidth=\"\"}else{cm.display.wrapper.className=cm.display.wrapper.className.replace(\" CodeMirror-wrap\",\"\");computeMaxLength(cm)}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout(function(){updateScrollbars(cm)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;else if(wrapping)return(Math.ceil(line.text.length/perLine)||1)*th;else return th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);if(estHeight!=line.height)updateLineHeight(line,estHeight)})}function keyMapChanged(cm){var map=keyMap[cm.options.keyMap],style=map.style;cm.display.wrapper.className=cm.display.wrapper.className.replace(/\\s*cm-keymap-\\S+/g,\"\")+(style?\" cm-keymap-\"+style:\"\");if(map.disableInput)cm.doc.cantEdit|=cantEdit_keymap;else cm.doc.cantEdit&=~cantEdit_keymap}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g,\"\")+cm.options.theme.replace(/(^|\\s)\\s*/g,\" cm-s-\");clearCaches(cm)}function guttersChanged(cm){updateGutters(cm);regChange(cm);setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i];var gElt=gutters.appendChild(elt(\"div\",null,\"CodeMirror-gutter \"+gutterClass));if(gutterClass==\"CodeMirror-linenumbers\"){cm.display.lineGutter=gElt;gElt.style.width=(cm.display.lineNumWidth||1)+\"px\"}}gutters.style.display=i?\"\":\"none\"}function lineLength(doc,line){if(line.height==0)return 0;var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find();cur=getLine(doc,found.from.line);len+=found.from.ch-found.to.ch}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();len-=cur.text.length-found.from.ch;cur=getLine(doc,found.to.line);len+=cur.text.length-found.to.ch}return len}function computeMaxLength(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(doc,d.maxLine);d.maxLineChanged=true;doc.iter(function(line){var len=lineLength(doc,line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line}})}function setGuttersForLineNumbers(options){var found=false;for(var i=0;i<options.gutters.length;++i){if(options.gutters[i]==\"CodeMirror-linenumbers\"){if(options.lineNumbers)found=true;else options.gutters.splice(i--,1)}}if(!found&&options.lineNumbers)options.gutters.push(\"CodeMirror-linenumbers\")}function updateScrollbars(cm){var d=cm.display,docHeight=cm.doc.height;\nvar totalHeight=docHeight+paddingVert(d);d.sizer.style.minHeight=d.heightForcer.style.top=totalHeight+\"px\";d.gutters.style.height=Math.max(totalHeight,d.scroller.clientHeight-scrollerCutOff)+\"px\";var scrollHeight=Math.max(totalHeight,d.scroller.scrollHeight);var needsH=d.scroller.scrollWidth>d.scroller.clientWidth+1;var needsV=scrollHeight>d.scroller.clientHeight+1;if(needsV){d.scrollbarV.style.display=\"block\";d.scrollbarV.style.bottom=needsH?scrollbarWidth(d.measure)+\"px\":\"0\";d.scrollbarV.firstChild.style.height=scrollHeight-d.scroller.clientHeight+d.scrollbarV.clientHeight+\"px\"}else d.scrollbarV.style.display=\"\";if(needsH){d.scrollbarH.style.display=\"block\";d.scrollbarH.style.right=needsV?scrollbarWidth(d.measure)+\"px\":\"0\";d.scrollbarH.firstChild.style.width=d.scroller.scrollWidth-d.scroller.clientWidth+d.scrollbarH.clientWidth+\"px\"}else d.scrollbarH.style.display=\"\";if(needsH&&needsV){d.scrollbarFiller.style.display=\"block\";d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=scrollbarWidth(d.measure)+\"px\"}else d.scrollbarFiller.style.display=\"\";if(needsH&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter){d.gutterFiller.style.display=\"block\";d.gutterFiller.style.height=scrollbarWidth(d.measure)+\"px\";d.gutterFiller.style.width=d.gutters.offsetWidth+\"px\"}else d.gutterFiller.style.display=\"\";if(mac_geLion&&scrollbarWidth(d.measure)===0)d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=mac_geMountainLion?\"18px\":\"12px\"}function visibleLines(display,doc,viewPort){var top=display.scroller.scrollTop,height=display.wrapper.clientHeight;if(typeof viewPort==\"number\")top=viewPort;else if(viewPort){top=viewPort.top;height=viewPort.bottom-viewPort.top}top=Math.floor(top-paddingTop(display));var bottom=Math.ceil(top+height);return{from:lineAtHeight(doc,top),to:lineAtHeight(doc,bottom)}}function alignHorizontally(cm){var display=cm.display;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter))return;var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,l=comp+\"px\";for(var n=display.lineDiv.firstChild;n;n=n.nextSibling)if(n.alignable){for(var i=0,a=n.alignable;i<a.length;++i)a[i].style.left=l}if(cm.options.fixedGutter)display.gutters.style.left=comp+gutterW+\"px\"}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return false;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt(\"div\",[elt(\"div\",last)],\"CodeMirror-linenumber CodeMirror-gutter-elt\"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width=\"\";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding);display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+\"px\";return true}return false}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return getRect(display.scroller).left-getRect(display.sizer).left}function updateDisplay(cm,changes,viewPort){var oldFrom=cm.display.showingFrom,oldTo=cm.display.showingTo,updated;var visible=visibleLines(cm.display,cm.doc,viewPort);for(;;){if(!updateDisplayInner(cm,changes,visible))break;updated=true;updateSelection(cm);updateScrollbars(cm);if(viewPort)viewPort=Math.min(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,typeof viewPort==\"number\"?viewPort:viewPort.top);visible=visibleLines(cm.display,cm.doc,viewPort);if(visible.from>=cm.display.showingFrom&&visible.to<=cm.display.showingTo)break;changes=[]}if(updated){signalLater(cm,\"update\",cm);if(cm.display.showingFrom!=oldFrom||cm.display.showingTo!=oldTo)signalLater(cm,\"viewportChange\",cm,cm.display.showingFrom,cm.display.showingTo)}return updated}function updateDisplayInner(cm,changes,visible){var display=cm.display,doc=cm.doc;if(!display.wrapper.clientWidth){display.showingFrom=display.showingTo=doc.first;display.viewOffset=0;return}if(changes.length==0&&visible.from>display.showingFrom&&visible.to<display.showingTo)return;if(maybeUpdateLineNumberWidth(cm))changes=[{from:doc.first,to:doc.first+doc.size}];var gutterW=display.sizer.style.marginLeft=display.gutters.offsetWidth+\"px\";display.scrollbarH.style.left=cm.options.fixedGutter?gutterW:\"0\";var positionsChangedFrom=Infinity;if(cm.options.lineNumbers)for(var i=0;i<changes.length;++i)if(changes[i].diff){positionsChangedFrom=changes[i].from;break}var end=doc.first+doc.size;var from=Math.max(visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,visible.to+cm.options.viewportMargin);if(display.showingFrom<from&&from-display.showingFrom<20)from=Math.max(doc.first,display.showingFrom);if(display.showingTo>to&&display.showingTo-to<20)to=Math.min(end,display.showingTo);if(sawCollapsedSpans){from=lineNo(visualLine(doc,getLine(doc,from)));while(to<end&&lineIsHidden(doc,getLine(doc,to)))++to}var intact=[{from:Math.max(display.showingFrom,doc.first),to:Math.min(display.showingTo,end)}];if(intact[0].from>=intact[0].to)intact=[];else intact=computeIntact(intact,changes);if(sawCollapsedSpans)for(var i=0;i<intact.length;++i){var range=intact[i],merged;while(merged=collapsedSpanAtEnd(getLine(doc,range.to-1))){var newTo=merged.find().from.line;if(newTo>range.from)range.to=newTo;else{intact.splice(i--,1);break}}}var intactLines=0;for(var i=0;i<intact.length;++i){var range=intact[i];if(range.from<from)range.from=from;if(range.to>to)range.to=to;if(range.from>=range.to)intact.splice(i--,1);else intactLines+=range.to-range.from}if(intactLines==to-from&&from==display.showingFrom&&to==display.showingTo){updateViewOffset(cm);return}intact.sort(function(a,b){return a.from-b.from});try{var focused=document.activeElement}catch(e){}if(intactLines<(to-from)*.7)display.lineDiv.style.display=\"none\";patchDisplay(cm,from,to,intact,positionsChangedFrom);display.lineDiv.style.display=\"\";if(focused&&document.activeElement!=focused&&focused.offsetHeight)focused.focus();var different=from!=display.showingFrom||to!=display.showingTo||display.lastSizeC!=display.wrapper.clientHeight;if(different)display.lastSizeC=display.wrapper.clientHeight;display.showingFrom=from;display.showingTo=to;startWorker(cm,100);var prevBottom=display.lineDiv.offsetTop;for(var node=display.lineDiv.firstChild,height;node;node=node.nextSibling)if(node.lineObj){if(ie_lt8){var bot=node.offsetTop+node.offsetHeight;height=bot-prevBottom;prevBottom=bot}else{var box=getRect(node);height=box.bottom-box.top}var diff=node.lineObj.height-height;if(height<2)height=textHeight(display);if(diff>.001||diff<-.001){updateLineHeight(node.lineObj,height);var widgets=node.lineObj.widgets;if(widgets)for(var i=0;i<widgets.length;++i)widgets[i].height=widgets[i].node.offsetHeight}}updateViewOffset(cm);return true}function updateViewOffset(cm){var off=cm.display.viewOffset=heightAtLine(cm,getLine(cm.doc,cm.display.showingFrom));cm.display.mover.style.top=off+\"px\"}function computeIntact(intact,changes){for(var i=0,l=changes.length||0;i<l;++i){var change=changes[i],intact2=[],diff=change.diff||0;for(var j=0,l2=intact.length;j<l2;++j){var range=intact[j];if(change.to<=range.from&&change.diff){intact2.push({from:range.from+diff,to:range.to+diff})}else if(change.to<=range.from||change.from>=range.to){intact2.push(range)}else{if(change.from>range.from)intact2.push({from:range.from,to:change.from});if(change.to<range.to)intact2.push({from:change.to+diff,to:range.to+diff})}}intact=intact2}return intact}function getDimensions(cm){var d=cm.display,left={},width={};for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){left[cm.options.gutters[i]]=n.offsetLeft;width[cm.options.gutters[i]]=n.offsetWidth}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,from,to,intact,updateNumbersFrom){var dims=getDimensions(cm);var display=cm.display,lineNumbers=cm.options.lineNumbers;if(!intact.length&&(!webkit||!cm.display.currentWheelTarget))removeChildren(display.lineDiv);var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;if(webkit&&mac&&cm.display.currentWheelTarget==node){node.style.display=\"none\";node.lineObj=null}else{node.parentNode.removeChild(node)}return next}var nextIntact=intact.shift(),lineN=from;cm.doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==lineN)nextIntact=intact.shift();if(lineIsHidden(cm.doc,line)){if(line.height!=0)updateLineHeight(line,0);if(line.widgets&&cur.previousSibling)for(var i=0;i<line.widgets.length;++i){var w=line.widgets[i];if(w.showIfHidden){var prev=cur.previousSibling;if(/pre/i.test(prev.nodeName)){var wrap=elt(\"div\",null,null,\"position: relative\");prev.parentNode.replaceChild(wrap,prev);wrap.appendChild(prev);prev=wrap}var wnode=prev.appendChild(elt(\"div\",[w.node],\"CodeMirror-linewidget\"));if(!w.handleMouseEvents)wnode.ignoreEvents=true;positionLineWidget(w,wnode,prev,dims)}}}else if(nextIntact&&nextIntact.from<=lineN&&nextIntact.to>lineN){while(cur.lineObj!=line)cur=rm(cur);if(lineNumbers&&updateNumbersFrom<=lineN&&cur.lineNumber)setTextContent(cur.lineNumber,lineNumberFor(cm.options,lineN));cur=cur.nextSibling}else{if(line.widgets)for(var j=0,search=cur,reuse;search&&j<20;++j,search=search.nextSibling)if(search.lineObj==line&&/div/i.test(search.nodeName)){reuse=search;break}var lineNode=buildLineElement(cm,line,lineN,dims,reuse);if(lineNode!=reuse){container.insertBefore(lineNode,cur)}else{while(cur!=reuse)cur=rm(cur);cur=cur.nextSibling}lineNode.lineObj=line}++lineN});while(cur)cur=rm(cur)}function buildLineElement(cm,line,lineNo,dims,reuse){var lineElement=lineContent(cm,line);var markers=line.gutterMarkers,display=cm.display,wrap;if(!cm.options.lineNumbers&&!markers&&!line.bgClass&&!line.wrapClass&&!line.widgets)return lineElement;if(reuse){reuse.alignable=null;var isOk=true,widgetsSeen=0,insertBefore=null;for(var n=reuse.firstChild,next;n;n=next){next=n.nextSibling;if(!/\\bCodeMirror-linewidget\\b/.test(n.className)){reuse.removeChild(n)}else{for(var i=0,first=true;i<line.widgets.length;++i){var widget=line.widgets[i];if(!widget.above){insertBefore=n;first=false}if(widget.node==n.firstChild){positionLineWidget(widget,n,reuse,dims);++widgetsSeen;break}}if(i==line.widgets.length){isOk=false;break}}}reuse.insertBefore(lineElement,insertBefore);if(isOk&&widgetsSeen==line.widgets.length){wrap=reuse;reuse.className=line.wrapClass||\"\"}}if(!wrap){wrap=elt(\"div\",null,line.wrapClass,\"position: relative\");wrap.appendChild(lineElement)}if(line.bgClass)wrap.insertBefore(elt(\"div\",null,line.bgClass+\" CodeMirror-linebackground\"),wrap.firstChild);if(cm.options.lineNumbers||markers){var gutterWrap=wrap.insertBefore(elt(\"div\",null,null,\"position: absolute; left: \"+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+\"px\"),wrap.firstChild);if(cm.options.fixedGutter)(wrap.alignable||(wrap.alignable=[])).push(gutterWrap);if(cm.options.lineNumbers&&(!markers||!markers[\"CodeMirror-linenumbers\"]))wrap.lineNumber=gutterWrap.appendChild(elt(\"div\",lineNumberFor(cm.options,lineNo),\"CodeMirror-linenumber CodeMirror-gutter-elt\",\"left: \"+dims.gutterLeft[\"CodeMirror-linenumbers\"]+\"px; width: \"+display.lineNumInnerWidth+\"px\"));if(markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];if(found)gutterWrap.appendChild(elt(\"div\",[found],\"CodeMirror-gutter-elt\",\"left: \"+dims.gutterLeft[id]+\"px; width: \"+dims.gutterWidth[id]+\"px\"))}}if(ie_lt8)wrap.style.zIndex=2;if(line.widgets&&wrap!=reuse)for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt(\"div\",[widget.node],\"CodeMirror-linewidget\");if(!widget.handleMouseEvents)node.ignoreEvents=true;positionLineWidget(widget,node,wrap,dims);if(widget.above)wrap.insertBefore(node,cm.options.lineNumbers&&line.height!=0?gutterWrap:lineElement);else wrap.appendChild(node);signalLater(widget,\"redraw\")}return wrap}function positionLineWidget(widget,node,wrap,dims){if(widget.noHScroll){(wrap.alignable||(wrap.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+\"px\";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+\"px\"}node.style.width=width+\"px\"}if(widget.coverGutter){node.style.zIndex=5;node.style.position=\"relative\";if(!widget.noHScroll)node.style.marginLeft=-dims.gutterTotalWidth+\"px\"}}function updateSelection(cm){var display=cm.display;var collapsed=posEq(cm.doc.sel.from,cm.doc.sel.to);if(collapsed||cm.options.showCursorWhenSelecting)updateSelectionCursor(cm);else display.cursor.style.display=display.otherCursor.style.display=\"none\";if(!collapsed)updateSelectionRange(cm);else display.selectionDiv.style.display=\"none\";if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,cm.doc.sel.head,\"div\");var wrapOff=getRect(display.wrapper),lineOff=getRect(display.lineDiv);display.inputDiv.style.top=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top))+\"px\";display.inputDiv.style.left=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))+\"px\"}}function updateSelectionCursor(cm){var display=cm.display,pos=cursorCoords(cm,cm.doc.sel.head,\"div\");display.cursor.style.left=pos.left+\"px\";display.cursor.style.top=pos.top+\"px\";display.cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+\"px\";display.cursor.style.display=\"\";if(pos.other){display.otherCursor.style.display=\"\";display.otherCursor.style.left=pos.other.left+\"px\";display.otherCursor.style.top=pos.other.top+\"px\";display.otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+\"px\"}else{display.otherCursor.style.display=\"none\"}}function updateSelectionRange(cm){var display=cm.display,doc=cm.doc,sel=cm.doc.sel;var fragment=document.createDocumentFragment();var clientWidth=display.lineSpace.offsetWidth,pl=paddingLeft(cm.display);function add(left,top,width,bottom){if(top<0)top=0;fragment.appendChild(elt(\"div\",null,\"CodeMirror-selected\",\"position: absolute; left: \"+left+\"px; top: \"+top+\"px; width: \"+(width==null?clientWidth-left:width)+\"px; height: \"+(bottom-top)+\"px\"))}function drawForLine(line,fromArg,toArg,retTop){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length,rVal=retTop?Infinity:-Infinity;function coords(ch){return charCoords(cm,Pos(line,ch),\"div\",lineObj)}iterateBidiSections(getOrder(lineObj),fromArg||0,toArg==null?lineLen:toArg,function(from,to,dir){var leftPos=coords(from),rightPos,left,right;if(from==to){rightPos=leftPos;left=right=leftPos.left}else{rightPos=coords(to-1);if(dir==\"rtl\"){var tmp=leftPos;leftPos=rightPos;rightPos=tmp}left=leftPos.left;right=rightPos.right}if(rightPos.top-leftPos.top>3){add(left,leftPos.top,null,leftPos.bottom);left=pl;if(leftPos.bottom<rightPos.top)add(left,leftPos.bottom,null,rightPos.top)}if(toArg==null&&to==lineLen)right=clientWidth;if(fromArg==null&&from==0)left=pl;rVal=retTop?Math.min(rightPos.top,rVal):Math.max(rightPos.bottom,rVal);if(left<pl+1)left=pl;add(left,rightPos.top,right-left,rightPos.bottom)});return rVal}if(sel.from.line==sel.to.line){drawForLine(sel.from.line,sel.from.ch,sel.to.ch)}else{var fromObj=getLine(doc,sel.from.line);var cur=fromObj,merged,path=[sel.from.line,sel.from.ch],singleLine;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();path.push(found.from.ch,found.to.line,found.to.ch);if(found.to.line==sel.to.line){path.push(sel.to.ch);singleLine=true;break}cur=getLine(doc,found.to.line)}if(singleLine){for(var i=0;i<path.length;i+=3)drawForLine(path[i],path[i+1],path[i+2])}else{var middleTop,middleBot,toObj=getLine(doc,sel.to.line);if(sel.from.ch)middleTop=drawForLine(sel.from.line,sel.from.ch,null,false);else middleTop=heightAtLine(cm,fromObj)-display.viewOffset;if(!sel.to.ch)middleBot=heightAtLine(cm,toObj)-display.viewOffset;else middleBot=drawForLine(sel.to.line,collapsedSpanAtStart(toObj)?null:0,sel.to.ch,true);if(middleTop<middleBot)add(pl,middleTop,null,middleBot)}}removeChildrenAndAdd(display.selectionDiv,fragment);display.selectionDiv.style.display=\"\"}function restartBlink(cm){if(!cm.state.focused)return;var display=cm.display;clearInterval(display.blinker);var on=true;display.cursor.style.visibility=display.otherCursor.style.visibility=\"\";display.blinker=setInterval(function(){display.cursor.style.visibility=display.otherCursor.style.visibility=(on=!on)?\"\":\"hidden\"},cm.options.cursorBlinkRate)}function startWorker(cm,time){if(cm.doc.mode.startState&&cm.doc.frontier<cm.display.showingTo)cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first)doc.frontier=doc.first;if(doc.frontier>=cm.display.showingTo)return;var end=+new Date+cm.options.workTime;var state=copyState(doc.mode,getStateBefore(cm,doc.frontier));var changed=[],prevChange;doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.showingTo+500),function(line){if(doc.frontier>=cm.display.showingFrom){var oldStyles=line.styles;line.styles=highlightLine(cm,line,state);var ischange=!oldStyles||oldStyles.length!=line.styles.length;for(var i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];if(ischange){if(prevChange&&prevChange.end==doc.frontier)prevChange.end++;else changed.push(prevChange={start:doc.frontier,end:doc.frontier+1})}line.stateAfter=copyState(doc.mode,state)}else{processLine(cm,line,state);line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null}++doc.frontier;if(+new Date>end){startWorker(cm,cm.options.workDelay);return true}});if(changed.length)operation(cm,function(){for(var i=0;i<changed.length;++i)regChange(this,changed[i].start,changed[i].end)})()}function findStartLine(cm,n){var minindent,minline,doc=cm.doc;for(var search=n,lim=n-100;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter)return search;var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented}}return minline}function getStateBefore(cm,n){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return true;var pos=findStartLine(cm,n),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;if(!state)state=startState(doc.mode);else state=copyState(doc.mode,state);doc.iter(pos,n,function(line){processLine(cm,line,state);var save=pos==n-1||pos%5==0||pos>=display.showingFrom&&pos<display.showingTo;line.stateAfter=save?copyState(doc.mode,state):null;++pos});return state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingLeft(display){var e=removeChildrenAndAdd(display.measure,elt(\"pre\",null,null,\"text-align: left\")).appendChild(elt(\"span\",\"x\"));return e.offsetLeft}function measureChar(cm,line,ch,data){var dir=-1;data=data||measureLine(cm,line);for(var pos=ch;;pos+=dir){var r=data[pos];if(r)break;if(dir<0&&pos==0)dir=1}return{left:pos<ch?r.right:r.left,right:pos>ch?r.left:r.right,top:r.top,bottom:r.bottom}}function findCachedMeasurement(cm,line){var cache=cm.display.measureLineCache;for(var i=0;i<cache.length;++i){var memo=cache[i];if(memo.text==line.text&&memo.markedSpans==line.markedSpans&&cm.display.scroller.clientWidth==memo.width&&memo.classes==line.textClass+\"|\"+line.bgClass+\"|\"+line.wrapClass)return memo}}function clearCachedMeasurement(cm,line){var exists=findCachedMeasurement(cm,line);if(exists)exists.text=exists.measure=exists.markedSpans=null}function measureLine(cm,line){var cached=findCachedMeasurement(cm,line);if(cached)return cached.measure;var measure=measureLineInner(cm,line);var cache=cm.display.measureLineCache;var memo={text:line.text,width:cm.display.scroller.clientWidth,markedSpans:line.markedSpans,measure:measure,classes:line.textClass+\"|\"+line.bgClass+\"|\"+line.wrapClass};if(cache.length==16)cache[++cm.display.measureLineCachePos%16]=memo;else cache.push(memo);return measure}function measureLineInner(cm,line){var display=cm.display,measure=emptyArray(line.text.length);var pre=lineContent(cm,line,measure);if(ie&&!ie_lt8&&!cm.options.lineWrapping&&pre.childNodes.length>100){var fragment=document.createDocumentFragment();var chunk=10,n=pre.childNodes.length;for(var i=0,chunks=Math.ceil(n/chunk);i<chunks;++i){var wrap=elt(\"div\",null,null,\"display: inline-block\");for(var j=0;j<chunk&&n;++j){wrap.appendChild(pre.firstChild);--n}fragment.appendChild(wrap)}pre.appendChild(fragment)}removeChildrenAndAdd(display.measure,pre);var outer=getRect(display.lineDiv);var vranges=[],data=emptyArray(line.text.length),maxBot=pre.offsetHeight;if(ie_lt9&&display.measure.first!=pre)removeChildrenAndAdd(display.measure,pre);for(var i=0,cur;i<measure.length;++i)if(cur=measure[i]){var size=getRect(cur);var top=Math.max(0,size.top-outer.top),bot=Math.min(size.bottom-outer.top,maxBot);for(var j=0;j<vranges.length;j+=2){var rtop=vranges[j],rbot=vranges[j+1];if(rtop>bot||rbot<top)continue;if(rtop<=top&&rbot>=bot||top<=rtop&&bot>=rbot||Math.min(bot,rbot)-Math.max(top,rtop)>=bot-top>>1){vranges[j]=Math.min(top,rtop);vranges[j+1]=Math.max(bot,rbot);break}}if(j==vranges.length)vranges.push(top,bot);var right=size.right;if(cur.measureRight)right=getRect(cur.measureRight).left;data[i]={left:size.left-outer.left,right:right-outer.left,top:j}}for(var i=0,cur;i<data.length;++i)if(cur=data[i]){var vr=cur.top;cur.top=vranges[vr];cur.bottom=vranges[vr+1]}return data}function measureLineWidth(cm,line){var hasBadSpan=false;if(line.markedSpans)for(var i=0;i<line.markedSpans;++i){var sp=line.markedSpans[i];if(sp.collapsed&&(sp.to==null||sp.to==line.text.length))hasBadSpan=true}var cached=!hasBadSpan&&findCachedMeasurement(cm,line);if(cached)return measureChar(cm,line,line.text.length,cached.measure).right;var pre=lineContent(cm,line);var end=pre.appendChild(zeroWidthElement(cm.display.measure));removeChildrenAndAdd(cm.display.measure,pre);return getRect(end).right-getRect(cm.display.lineDiv).left}function clearCaches(cm){cm.display.measureLineCache.length=cm.display.measureLineCachePos=0;cm.display.cachedCharWidth=cm.display.cachedTextHeight=null;if(!cm.options.lineWrapping)cm.display.maxLineChanged=true;cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size;rect.bottom+=size}if(context==\"line\")return rect;if(!context)context=\"local\";var yOff=heightAtLine(cm,lineObj);if(context==\"local\")yOff+=paddingTop(cm.display);else yOff-=cm.display.viewOffset;if(context==\"page\"||context==\"window\"){var lOff=getRect(cm.display.lineSpace);yOff+=lOff.top+(context==\"window\"?0:pageScrollY());var xOff=lOff.left+(context==\"window\"?0:pageScrollX());rect.left+=xOff;rect.right+=xOff}rect.top+=yOff;rect.bottom+=yOff;return rect}function fromCoordSystem(cm,coords,context){if(context==\"div\")return coords;var left=coords.left,top=coords.top;if(context==\"page\"){left-=pageScrollX();top-=pageScrollY()}else if(context==\"local\"||!context){var localBox=getRect(cm.display.sizer);left+=localBox.left;top+=localBox.top}var lineSpaceBox=getRect(cm.display.lineSpace);return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj){if(!lineObj)lineObj=getLine(cm.doc,pos.line);return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch),context)}function cursorCoords(cm,pos,context,lineObj,measurement){lineObj=lineObj||getLine(cm.doc,pos.line);if(!measurement)measurement=measureLine(cm,lineObj);function get(ch,right){var m=measureChar(cm,lineObj,ch,measurement);if(right)m.left=m.right;else m.right=m.left;return intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;if(ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level){part=order[--partPos];ch=bidiRight(part)-(part.level%2?0:1);right=true}else if(ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level){part=order[++partPos];ch=bidiLeft(part)-part.level%2;right=false}if(right&&ch==part.to&&ch>part.from)return get(ch-1);return get(ch,right)}var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch);var val=getBidi(ch,partPos);if(bidiOther!=null)val.other=getBidi(ch,bidiOther);return val}function PosMaybeOutside(line,ch,outside){var pos=new Pos(line,ch);if(outside)pos.outside=true;return pos}function coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0)return PosMaybeOutside(doc.first,0,true);var lineNo=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineNo>last)return PosMaybeOutside(doc.first+doc.size-1,getLine(doc,last).text.length,true);if(x<0)x=0;for(;;){var lineObj=getLine(doc,lineNo);var found=coordsCharInner(cm,lineObj,lineNo,x,y);var merged=collapsedSpanAtEnd(lineObj);var mergedPos=merged&&merged.find();if(merged&&found.ch>=mergedPos.from.ch)lineNo=mergedPos.to.line;else return found}}function coordsCharInner(cm,lineObj,lineNo,x,y){var innerOff=y-heightAtLine(cm,lineObj);var wrongLine=false,adjust=2*cm.display.wrapper.clientWidth;var measurement=measureLine(cm,lineObj);function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),\"line\",lineObj,measurement);wrongLine=true;if(innerOff>sp.bottom)return sp.left-adjust;else if(innerOff<sp.top)return sp.left+adjust;else wrongLine=false;return sp.left}var bidi=getOrder(lineObj),dist=lineObj.text.length;var from=lineLeft(lineObj),to=lineRight(lineObj);var fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosMaybeOutside(lineNo,to,toOutside);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):to-from<=1){var after=x-fromX<toX-x,ch=after?from:to;while(isExtendingChar.test(lineObj.text.charAt(ch)))++ch;var pos=PosMaybeOutside(lineNo,ch,after?fromOutside:toOutside);pos.after=after;return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;if(toOutside=wrongLine)toX+=1e3;dist=step}else{from=middle;fromX=middleX;fromOutside=wrongLine;dist-=step}}}var measureText;function textHeight(display){if(display.cachedTextHeight!=null)return display.cachedTextHeight;if(measureText==null){measureText=elt(\"pre\");for(var i=0;i<49;++i){measureText.appendChild(document.createTextNode(\"x\"));measureText.appendChild(elt(\"br\"))}measureText.appendChild(document.createTextNode(\"x\"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3)display.cachedTextHeight=height;removeChildren(display.measure);return height||1}function charWidth(display){if(display.cachedCharWidth!=null)return display.cachedCharWidth;var anchor=elt(\"span\",\"x\");var pre=elt(\"pre\",[anchor]);removeChildrenAndAdd(display.measure,pre);var width=anchor.offsetWidth;if(width>2)display.cachedCharWidth=width;return width||10}var nextOpId=0;function startOperation(cm){cm.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:false,cursorActivity:false,updateMaxLine:false,updateScrollPos:false,id:++nextOpId};if(!delayedCallbackDepth++)delayedCallbacks=[]}function endOperation(cm){var op=cm.curOp,doc=cm.doc,display=cm.display;cm.curOp=null;if(op.updateMaxLine)computeMaxLength(cm);if(display.maxLineChanged&&!cm.options.lineWrapping&&display.maxLine){var width=measureLineWidth(cm,display.maxLine);display.sizer.style.minWidth=Math.max(0,width+3+scrollerCutOff)+\"px\";display.maxLineChanged=false;var maxScrollLeft=Math.max(0,display.sizer.offsetLeft+display.sizer.offsetWidth-display.scroller.clientWidth);if(maxScrollLeft<doc.scrollLeft&&!op.updateScrollPos)setScrollLeft(cm,Math.min(display.scroller.scrollLeft,maxScrollLeft),true)}var newScrollPos,updated;if(op.updateScrollPos){newScrollPos=op.updateScrollPos}else if(op.selectionChanged&&display.scroller.clientHeight){var coords=cursorCoords(cm,doc.sel.head);newScrollPos=calculateScrollPos(cm,coords.left,coords.top,coords.left,coords.bottom)}if(op.changes.length||newScrollPos&&newScrollPos.scrollTop!=null){updated=updateDisplay(cm,op.changes,newScrollPos&&newScrollPos.scrollTop);if(cm.display.scroller.offsetHeight)cm.doc.scrollTop=cm.display.scroller.scrollTop}if(!updated&&op.selectionChanged)updateSelection(cm);if(op.updateScrollPos){display.scroller.scrollTop=display.scrollbarV.scrollTop=doc.scrollTop=newScrollPos.scrollTop;display.scroller.scrollLeft=display.scrollbarH.scrollLeft=doc.scrollLeft=newScrollPos.scrollLeft;alignHorizontally(cm);if(op.scrollToPos)scrollPosIntoView(cm,clipPos(cm.doc,op.scrollToPos),op.scrollToPosMargin)}else if(newScrollPos){scrollCursorIntoView(cm)}if(op.selectionChanged)restartBlink(cm);if(cm.state.focused&&op.updateInput)resetInput(cm,op.userSelChange);var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)if(!hidden[i].lines.length)signal(hidden[i],\"hide\");if(unhidden)for(var i=0;i<unhidden.length;++i)if(unhidden[i].lines.length)signal(unhidden[i],\"unhide\");var delayed;if(!--delayedCallbackDepth){delayed=delayedCallbacks;delayedCallbacks=null}if(op.textChanged)signal(cm,\"change\",cm,op.textChanged);if(op.cursorActivity)signal(cm,\"cursorActivity\",cm);if(delayed)for(var i=0;i<delayed.length;++i)delayed[i]()}function operation(cm1,f){return function(){var cm=cm1||this,withOp=!cm.curOp;if(withOp)startOperation(cm);try{var result=f.apply(cm,arguments)}finally{if(withOp)endOperation(cm)}return result}}function docOperation(f){return function(){var withOp=this.cm&&!this.cm.curOp,result;if(withOp)startOperation(this.cm);try{result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}function runInOp(cm,f){var withOp=!cm.curOp,result;if(withOp)startOperation(cm);try{result=f()}finally{if(withOp)endOperation(cm)}return result}function regChange(cm,from,to,lendiff){if(from==null)from=cm.doc.first;if(to==null)to=cm.doc.first+cm.doc.size;cm.curOp.changes.push({from:from,to:to,diff:lendiff})}function slowPoll(cm){if(cm.display.pollingFast)return;cm.display.poll.set(cm.options.pollInterval,function(){readInput(cm);if(cm.state.focused)slowPoll(cm)})}function fastPoll(cm){var missed=false;cm.display.pollingFast=true;function p(){var changed=readInput(cm);if(!changed&&!missed){missed=true;cm.display.poll.set(60,p)}else{cm.display.pollingFast=false;slowPoll(cm)}}cm.display.poll.set(20,p)}function readInput(cm){var input=cm.display.input,prevInput=cm.display.prevInput,doc=cm.doc,sel=doc.sel;if(!cm.state.focused||hasSelection(input)||isReadOnly(cm))return false;var text=input.value;if(text==prevInput&&posEq(sel.from,sel.to))return false;if(ie&&!ie_lt9&&cm.display.inputHasSelection===text){resetInput(cm,true);return false}var withOp=!cm.curOp;if(withOp)startOperation(cm);sel.shift=false;var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same))++same;var from=sel.from,to=sel.to;if(same<prevInput.length)from=Pos(from.line,from.ch-(prevInput.length-same));else if(cm.state.overwrite&&posEq(from,to)&&!cm.state.pasteIncoming)to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+(text.length-same)));var updateInput=cm.curOp.updateInput;makeChange(cm.doc,{from:from,to:to,text:splitLines(text.slice(same)),origin:cm.state.pasteIncoming?\"paste\":\"+input\"},\"end\");cm.curOp.updateInput=updateInput;if(text.length>1e3||text.indexOf(\"\\n\")>-1)input.value=cm.display.prevInput=\"\";else cm.display.prevInput=text;\nif(withOp)endOperation(cm);cm.state.pasteIncoming=false;return true}function resetInput(cm,user){var minimal,selected,doc=cm.doc;if(!posEq(doc.sel.from,doc.sel.to)){cm.display.prevInput=\"\";minimal=hasCopyEvent&&(doc.sel.to.line-doc.sel.from.line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?\"-\":selected||cm.getSelection();cm.display.input.value=content;if(cm.state.focused)selectInput(cm.display.input);if(ie&&!ie_lt9)cm.display.inputHasSelection=content}else if(user){cm.display.prevInput=cm.display.input.value=\"\";if(ie&&!ie_lt9)cm.display.inputHasSelection=null}cm.display.inaccurateSelection=minimal}function focusInput(cm){if(cm.options.readOnly!=\"nocursor\"&&(!mobile||document.activeElement!=cm.display.input))cm.display.input.focus()}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function registerEventHandlers(cm){var d=cm.display;on(d.scroller,\"mousedown\",operation(cm,onMouseDown));if(ie)on(d.scroller,\"dblclick\",operation(cm,function(e){var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);var word=findWordAt(getLine(cm.doc,pos.line).text,pos);extendSelection(cm.doc,word.from,word.to)}));else on(d.scroller,\"dblclick\",e_preventDefault);on(d.lineSpace,\"selectstart\",function(e){if(!eventInWidget(d,e))e_preventDefault(e)});if(!captureMiddleClick)on(d.scroller,\"contextmenu\",function(e){onContextMenu(cm,e)});on(d.scroller,\"scroll\",function(){if(d.scroller.clientHeight){setScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,\"scroll\",cm)}});on(d.scrollbarV,\"scroll\",function(){if(d.scroller.clientHeight)setScrollTop(cm,d.scrollbarV.scrollTop)});on(d.scrollbarH,\"scroll\",function(){if(d.scroller.clientHeight)setScrollLeft(cm,d.scrollbarH.scrollLeft)});on(d.scroller,\"mousewheel\",function(e){onScrollWheel(cm,e)});on(d.scroller,\"DOMMouseScroll\",function(e){onScrollWheel(cm,e)});function reFocus(){if(cm.state.focused)setTimeout(bind(focusInput,cm),0)}on(d.scrollbarH,\"mousedown\",reFocus);on(d.scrollbarV,\"mousedown\",reFocus);on(d.wrapper,\"scroll\",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0});var resizeTimer;function onResize(){if(resizeTimer==null)resizeTimer=setTimeout(function(){resizeTimer=null;d.cachedCharWidth=d.cachedTextHeight=knownScrollbarWidth=null;clearCaches(cm);runInOp(cm,bind(regChange,cm))},100)}on(window,\"resize\",onResize);function unregister(){for(var p=d.wrapper.parentNode;p&&p!=document.body;p=p.parentNode){}if(p)setTimeout(unregister,5e3);else off(window,\"resize\",onResize)}setTimeout(unregister,5e3);on(d.input,\"keyup\",operation(cm,function(e){if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;if(e.keyCode==16)cm.doc.sel.shift=false}));on(d.input,\"input\",bind(fastPoll,cm));on(d.input,\"keydown\",operation(cm,onKeyDown));on(d.input,\"keypress\",operation(cm,onKeyPress));on(d.input,\"focus\",bind(onFocus,cm));on(d.input,\"blur\",bind(onBlur,cm));function drag_(e){if(cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_stop(e)}if(cm.options.dragDrop){on(d.scroller,\"dragstart\",function(e){onDragStart(cm,e)});on(d.scroller,\"dragenter\",drag_);on(d.scroller,\"dragover\",drag_);on(d.scroller,\"drop\",operation(cm,onDrop))}on(d.scroller,\"paste\",function(e){if(eventInWidget(d,e))return;focusInput(cm);fastPoll(cm)});on(d.input,\"paste\",function(){cm.state.pasteIncoming=true;fastPoll(cm)});function prepareCopy(){if(d.inaccurateSelection){d.prevInput=\"\";d.inaccurateSelection=false;d.input.value=cm.getSelection();selectInput(d.input)}}on(d.input,\"cut\",prepareCopy);on(d.input,\"copy\",prepareCopy);if(khtml)on(d.sizer,\"mouseup\",function(){if(document.activeElement==d.input)d.input.blur();focusInput(cm)})}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n||n.ignoreEvents||n.parentNode==display.sizer&&n!=display.mover)return true}}function posFromMouse(cm,e,liberal){var display=cm.display;if(!liberal){var target=e_target(e);if(target==display.scrollbarH||target==display.scrollbarH.firstChild||target==display.scrollbarV||target==display.scrollbarV.firstChild||target==display.scrollbarFiller||target==display.gutterFiller)return null}var x,y,space=getRect(display.lineSpace);try{x=e.clientX;y=e.clientY}catch(e){return null}return coordsChar(cm,x-space.left,y-space.top)}var lastClick,lastDoubleClick;function onMouseDown(e){var cm=this,display=cm.display,doc=cm.doc,sel=doc.sel;sel.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){display.scroller.draggable=false;setTimeout(function(){display.scroller.draggable=true},100)}return}if(clickInGutter(cm,e))return;var start=posFromMouse(cm,e);switch(e_button(e)){case 3:if(captureMiddleClick)onContextMenu.call(cm,cm,e);return;case 2:if(start)extendSelection(cm.doc,start);setTimeout(bind(focusInput,cm),20);e_preventDefault(e);return}if(!start){if(e_target(e)==display.scroller)e_preventDefault(e);return}if(!cm.state.focused)onFocus(cm);var now=+new Date,type=\"single\";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start)){type=\"triple\";e_preventDefault(e);setTimeout(bind(focusInput,cm),20);selectLine(cm,start.line)}else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type=\"double\";lastDoubleClick={time:now,pos:start};e_preventDefault(e);var word=findWordAt(getLine(doc,start.line).text,start);extendSelection(cm.doc,word.from,word.to)}else{lastClick={time:now,pos:start}}var last=start;if(cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&type==\"single\"){var dragEnd=operation(cm,function(e2){if(webkit)display.scroller.draggable=false;cm.state.draggingText=false;off(document,\"mouseup\",dragEnd);off(display.scroller,\"drop\",dragEnd);if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);extendSelection(cm.doc,start);focusInput(cm)}});if(webkit)display.scroller.draggable=true;cm.state.draggingText=dragEnd;if(display.scroller.dragDrop)display.scroller.dragDrop();on(document,\"mouseup\",dragEnd);on(display.scroller,\"drop\",dragEnd);return}e_preventDefault(e);if(type==\"single\")extendSelection(cm.doc,clipPos(doc,start));var startstart=sel.from,startend=sel.to,lastPos=start;function doSelect(cur){if(posEq(lastPos,cur))return;lastPos=cur;if(type==\"single\"){extendSelection(cm.doc,clipPos(doc,start),cur);return}startstart=clipPos(doc,startstart);startend=clipPos(doc,startend);if(type==\"double\"){var word=findWordAt(getLine(doc,cur.line).text,cur);if(posLess(cur,startstart))extendSelection(cm.doc,word.from,startend);else extendSelection(cm.doc,startstart,word.to)}else if(type==\"triple\"){if(posLess(cur,startstart))extendSelection(cm.doc,startend,clipPos(doc,Pos(cur.line,0)));else extendSelection(cm.doc,startstart,clipPos(doc,Pos(cur.line+1,0)))}}var editorSize=getRect(display.wrapper);var counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true);if(!cur)return;if(!posEq(cur,last)){if(!cm.state.focused)onFocus(cm);last=cur;doSelect(cur);var visible=visibleLines(display,doc);if(cur.line>=visible.to||cur.line<visible.from)setTimeout(operation(cm,function(){if(counter==curCount)extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside)setTimeout(operation(cm,function(){if(counter!=curCount)return;display.scroller.scrollTop+=outside;extend(e)}),50)}}function done(e){counter=Infinity;e_preventDefault(e);focusInput(cm);off(document,\"mousemove\",move);off(document,\"mouseup\",up)}var move=operation(cm,function(e){if(!ie&&!e_button(e))done(e);else extend(e)});var up=operation(cm,done);on(document,\"mousemove\",move);on(document,\"mouseup\",up)}function clickInGutter(cm,e){var display=cm.display;try{var mX=e.clientX,mY=e.clientY}catch(e){return false}if(mX>=Math.floor(getRect(display.gutters).right))return false;e_preventDefault(e);if(!hasHandler(cm,\"gutterClick\"))return true;var lineBox=getRect(display.lineDiv);if(mY>lineBox.bottom)return true;mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&getRect(g).right>=mX){var line=lineAtHeight(cm.doc,mY);var gutter=cm.options.gutters[i];signalLater(cm,\"gutterClick\",cm,line,gutter,e);break}}return true}var lastDrop=0;function onDrop(e){var cm=this;if(eventInWidget(cm.display,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_preventDefault(e);if(ie)lastDrop=+new Date;var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||isReadOnly(cm))return;if(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var loadFile=function(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result;if(++read==n){pos=clipPos(cm.doc,pos);makeChange(cm.doc,{from:pos,to:pos,text:splitLines(text.join(\"\\n\")),origin:\"paste\"},\"around\")}};reader.readAsText(file)};for(var i=0;i<n;++i)loadFile(files[i],i)}else{if(cm.state.draggingText&&!(posLess(pos,cm.doc.sel.from)||posLess(cm.doc.sel.to,pos))){cm.state.draggingText(e);setTimeout(bind(focusInput,cm),20);return}try{var text=e.dataTransfer.getData(\"Text\");if(text){var curFrom=cm.doc.sel.from,curTo=cm.doc.sel.to;setSelection(cm.doc,pos,pos);if(cm.state.draggingText)replaceRange(cm.doc,\"\",curFrom,curTo,\"paste\");cm.replaceSelection(text,null,\"paste\");focusInput(cm);onFocus(cm)}}catch(e){}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100)){e_stop(e);return}if(eventInWidget(cm.display,e))return;var txt=cm.getSelection();e.dataTransfer.setData(\"Text\",txt);if(e.dataTransfer.setDragImage&&!safari){var img=elt(\"img\",null,null,\"position: fixed; left: 0; top: 0;\");if(opera){img.width=img.height=1;cm.display.wrapper.appendChild(img);img._top=img.offsetTop}e.dataTransfer.setDragImage(img,0,0);if(opera)img.parentNode.removeChild(img)}}function setScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2)return;cm.doc.scrollTop=val;if(!gecko)updateDisplay(cm,[],val);if(cm.display.scroller.scrollTop!=val)cm.display.scroller.scrollTop=val;if(cm.display.scrollbarV.scrollTop!=val)cm.display.scrollbarV.scrollTop=val;if(gecko)updateDisplay(cm,[])}function setScrollLeft(cm,val,isScroller){if(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)return;val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth);cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val)cm.display.scroller.scrollLeft=val;if(cm.display.scrollbarH.scrollLeft!=val)cm.display.scrollbarH.scrollLeft=val}var wheelSamples=0,wheelPixelsPerUnit=null;if(ie)wheelPixelsPerUnit=-.53;else if(gecko)wheelPixelsPerUnit=15;else if(chrome)wheelPixelsPerUnit=-.7;else if(safari)wheelPixelsPerUnit=-1/3;function onScrollWheel(cm,e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS)dx=e.detail;if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS)dy=e.detail;else if(dy==null)dy=e.wheelDelta;var display=cm.display,scroll=display.scroller;if(!(dx&&scroll.scrollWidth>scroll.clientWidth||dy&&scroll.scrollHeight>scroll.clientHeight))return;if(dy&&mac&&webkit){for(var cur=e.target;cur!=scroll;cur=cur.parentNode){if(cur.lineObj){cm.display.currentWheelTarget=cur;break}}}if(dx&&!gecko&&!opera&&wheelPixelsPerUnit!=null){if(dy)setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight)));setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth)));e_preventDefault(e);display.wheelStartX=null;return}if(dy&&wheelPixelsPerUnit!=null){var pixels=dy*wheelPixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0)top=Math.max(0,top+pixels-50);else bot=Math.min(cm.doc.height,bot+pixels+50);updateDisplay(cm,[],{top:top,bottom:bot})}if(wheelSamples<20){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout(function(){if(display.wheelStartX==null)return;var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample)return;wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples},200)}else{display.wheelDX+=dx;display.wheelDY+=dy}}}function doHandleBinding(cm,bound,dropShift){if(typeof bound==\"string\"){bound=commands[bound];if(!bound)return false}if(cm.display.pollingFast&&readInput(cm))cm.display.pollingFast=false;var doc=cm.doc,prevShift=doc.sel.shift,done=false;try{if(isReadOnly(cm))cm.state.suppressEdits=true;if(dropShift)doc.sel.shift=false;done=bound(cm)!=Pass}finally{doc.sel.shift=prevShift;cm.state.suppressEdits=false}return done}function allKeyMaps(cm){var maps=cm.state.keyMaps.slice(0);if(cm.options.extraKeys)maps.push(cm.options.extraKeys);maps.push(cm.options.keyMap);return maps}var maybeTransition;function handleKeyBinding(cm,e){var startMap=getKeyMap(cm.options.keyMap),next=startMap.auto;clearTimeout(maybeTransition);if(next&&!isModifierKey(e))maybeTransition=setTimeout(function(){if(getKeyMap(cm.options.keyMap)==startMap)cm.options.keyMap=next.call?next.call(null,cm):next},50);var name=keyName(e,true),handled=false;if(!name)return false;var keymaps=allKeyMaps(cm);if(e.shiftKey){handled=lookupKey(\"Shift-\"+name,keymaps,function(b){return doHandleBinding(cm,b,true)})||lookupKey(name,keymaps,function(b){if(typeof b==\"string\"&&/^go[A-Z]/.test(b))return doHandleBinding(cm,b)})}else{handled=lookupKey(name,keymaps,function(b){return doHandleBinding(cm,b)})}if(handled){e_preventDefault(e);restartBlink(cm);if(ie_lt9){e.oldKeyCode=e.keyCode;e.keyCode=0}}return handled}function handleCharBinding(cm,e,ch){var handled=lookupKey(\"'\"+ch+\"'\",allKeyMaps(cm),function(b){return doHandleBinding(cm,b,true)});if(handled){e_preventDefault(e);restartBlink(cm)}return handled}var lastStoppedKey=null;function onKeyDown(e){var cm=this;if(!cm.state.focused)onFocus(cm);if(ie&&e.keyCode==27){e.returnValue=false}if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var code=e.keyCode;cm.doc.sel.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(opera){lastStoppedKey=handled?code:null;if(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey))cm.replaceSelection(\"\")}}function onKeyPress(e){var cm=this;if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var keyCode=e.keyCode,charCode=e.charCode;if(opera&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return}if((opera&&(!e.which||e.which<10)||khtml)&&handleKeyBinding(cm,e))return;var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!isReadOnly(this)&&this.doc.mode.electricChars.indexOf(ch)>-1)setTimeout(operation(cm,function(){indentLine(cm,cm.doc.sel.to.line,\"smart\")}),75);if(handleCharBinding(cm,e,ch))return;if(ie&&!ie_lt9)cm.display.inputHasSelection=null;fastPoll(cm)}function onFocus(cm){if(cm.options.readOnly==\"nocursor\")return;if(!cm.state.focused){signal(cm,\"focus\",cm);cm.state.focused=true;if(cm.display.wrapper.className.search(/\\bCodeMirror-focused\\b/)==-1)cm.display.wrapper.className+=\" CodeMirror-focused\";resetInput(cm,true)}slowPoll(cm);restartBlink(cm)}function onBlur(cm){if(cm.state.focused){signal(cm,\"blur\",cm);cm.state.focused=false;cm.display.wrapper.className=cm.display.wrapper.className.replace(\" CodeMirror-focused\",\"\")}clearInterval(cm.display.blinker);setTimeout(function(){if(!cm.state.focused)cm.doc.sel.shift=false},150)}var detectingSelectAll;function onContextMenu(cm,e){var display=cm.display,sel=cm.doc.sel;if(eventInWidget(display,e))return;var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||opera)return;if(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))operation(cm,setSelection)(cm.doc,pos,pos);var oldCSS=display.input.style.cssText;display.inputDiv.style.position=\"absolute\";display.input.style.cssText=\"position: fixed; width: 30px; height: 30px; top: \"+(e.clientY-5)+\"px; left: \"+(e.clientX-5)+\"px; z-index: 1000; background: white; outline: none;\"+\"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);\";focusInput(cm);resetInput(cm,true);if(posEq(sel.from,sel.to))display.input.value=display.prevInput=\" \";function prepareSelectAllHack(){if(display.input.selectionStart!=null){var extval=display.input.value=\" \"+(posEq(sel.from,sel.to)?\"\":display.input.value);display.prevInput=\" \";display.input.selectionStart=1;display.input.selectionEnd=extval.length}}function rehide(){display.inputDiv.style.position=\"relative\";display.input.style.cssText=oldCSS;if(ie_lt9)display.scrollbarV.scrollTop=display.scroller.scrollTop=scrollPos;slowPoll(cm);if(display.input.selectionStart!=null){if(!ie||ie_lt9)prepareSelectAllHack();clearTimeout(detectingSelectAll);var i=0,poll=function(){if(display.prevInput==\" \"&&display.input.selectionStart==0)operation(cm,commands.selectAll)(cm);else if(i++<10)detectingSelectAll=setTimeout(poll,500);else resetInput(cm)};detectingSelectAll=setTimeout(poll,200)}}if(ie&&!ie_lt9)prepareSelectAllHack();if(captureMiddleClick){e_stop(e);var mouseup=function(){off(window,\"mouseup\",mouseup);setTimeout(rehide,20)};on(window,\"mouseup\",mouseup)}else{setTimeout(rehide,50)}}function changeEnd(change){if(!change.text)return change.to;return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0))}function clipPostChange(doc,change,pos){if(!posLess(change.from,pos))return clipPos(doc,pos);var diff=change.text.length-1-(change.to.line-change.from.line);if(pos.line>change.to.line+diff){var preLine=pos.line-diff,lastLine=doc.first+doc.size-1;if(preLine>lastLine)return Pos(lastLine,getLine(doc,lastLine).text.length);return clipToLen(pos,getLine(doc,preLine).text.length)}if(pos.line==change.to.line+diff)return clipToLen(pos,lst(change.text).length+(change.text.length==1?change.from.ch:0)+getLine(doc,change.to.line).text.length-change.to.ch);var inside=pos.line-change.from.line;return clipToLen(pos,change.text[inside].length+(inside?0:change.from.ch))}function computeSelAfterChange(doc,change,hint){if(hint&&typeof hint==\"object\")return{anchor:clipPostChange(doc,change,hint.anchor),head:clipPostChange(doc,change,hint.head)};if(hint==\"start\")return{anchor:change.from,head:change.from};var end=changeEnd(change);if(hint==\"around\")return{anchor:change.from,head:end};if(hint==\"end\")return{anchor:end,head:end};var adjustPos=function(pos){if(posLess(pos,change.from))return pos;if(!posLess(change.to,pos))return end;var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line)ch+=end.ch-change.to.ch;return Pos(line,ch)};return{anchor:adjustPos(doc.sel.anchor),head:adjustPos(doc.sel.head)}}function filterChange(doc,change,update){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=true}};if(update)obj.update=function(from,to,text,origin){if(from)this.from=clipPos(doc,from);if(to)this.to=clipPos(doc,to);if(text)this.text=text;if(origin!==undefined)this.origin=origin};signal(doc,\"beforeChange\",doc,obj);if(doc.cm)signal(doc.cm,\"beforeChange\",doc.cm,obj);if(obj.canceled)return null;return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,selUpdate,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,selUpdate,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(hasHandler(doc,\"beforeChange\")||doc.cm&&hasHandler(doc.cm,\"beforeChange\")){change=filterChange(doc,change,true);if(!change)return}var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=1;--i)makeChangeNoReadonly(doc,{from:split[i].from,to:split[i].to,text:[\"\"]});if(split.length)makeChangeNoReadonly(doc,{from:split[0].from,to:split[0].to,text:change.text},selUpdate)}else{makeChangeNoReadonly(doc,change,selUpdate)}}function makeChangeNoReadonly(doc,change,selUpdate){var selAfter=computeSelAfterChange(doc,change,selUpdate);addToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}function makeChangeFromHistory(doc,type){if(doc.cm&&doc.cm.state.suppressEdits)return;var hist=doc.history;var event=(type==\"undo\"?hist.done:hist.undone).pop();if(!event)return;hist.dirtyCounter+=type==\"undo\"?-1:1;var anti={changes:[],anchorBefore:event.anchorAfter,headBefore:event.headAfter,anchorAfter:event.anchorBefore,headAfter:event.headBefore};(type==\"undo\"?hist.undone:hist.done).push(anti);var filter=hasHandler(doc,\"beforeChange\")||doc.cm&&hasHandler(doc.cm,\"beforeChange\");for(var i=event.changes.length-1;i>=0;--i){var change=event.changes[i];change.origin=type;if(filter&&!filterChange(doc,change,false)){(type==\"undo\"?hist.done:hist.undone).length=0;return}anti.changes.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change,null):{anchor:event.anchorBefore,head:event.headBefore};makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}function shiftDoc(doc,distance){function shiftPos(pos){return Pos(pos.line+distance,pos.ch)}doc.first+=distance;if(doc.cm)regChange(doc.cm,doc.first,doc.first,distance);doc.sel.head=shiftPos(doc.sel.head);doc.sel.anchor=shiftPos(doc.sel.anchor);doc.sel.from=shiftPos(doc.sel.from);doc.sel.to=shiftPos(doc.sel.to)}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return}if(change.from.line>doc.lastLine())return;if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}}change.removed=getBetween(doc,change.from,change.to);if(!selAfter)selAfter=computeSelAfterChange(doc,change,null);if(doc.cm)makeChangeSingleDocInEditor(doc.cm,change,spans,selAfter);else updateDoc(doc,change,spans,selAfter)}function makeChangeSingleDocInEditor(cm,change,spans,selAfter){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(doc,getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine){recomputeMaxLength=true;return true}})}if(!posLess(doc.sel.head,change.from)&&!posLess(change.to,doc.sel.head))cm.curOp.cursorActivity=true;updateDoc(doc,change,spans,selAfter,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(doc,line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false}});if(recomputeMaxLength)cm.curOp.updateMaxLine=true}doc.frontier=Math.min(doc.frontier,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;regChange(cm,from.line,to.line+1,lendiff);if(hasHandler(cm,\"change\")){var changeObj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(cm.curOp.textChanged){for(var cur=cm.curOp.textChanged;cur.next;cur=cur.next){}cur.next=changeObj}else cm.curOp.textChanged=changeObj}}function replaceRange(doc,code,from,to,origin){if(!to)to=from;if(posLess(to,from)){var tmp=to;to=from;from=tmp}if(typeof code==\"string\")code=splitLines(code);makeChange(doc,{from:from,to:to,text:code,origin:origin},null)}function Pos(line,ch){if(!(this instanceof Pos))return new Pos(line,ch);this.line=line;this.ch=ch}CodeMirror.Pos=Pos;function posEq(a,b){return a.line==b.line&&a.ch==b.ch}function posLess(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function copyPos(x){return Pos(x.line,x.ch)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;if(pos.line>last)return Pos(last,getLine(doc,last).text.length);return clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen)return Pos(pos.line,linelen);else if(ch<0)return Pos(pos.line,0);else return pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function extendSelection(doc,pos,other,bias){if(doc.sel.shift||doc.sel.extend){var anchor=doc.sel.anchor;if(other){var posBefore=posLess(pos,anchor);if(posBefore!=posLess(other,anchor)){anchor=pos;pos=other}else if(posBefore!=posLess(pos,other)){pos=other}}setSelection(doc,anchor,pos,bias)}else{setSelection(doc,pos,other||pos,bias)}if(doc.cm)doc.cm.curOp.userSelChange=true}function filterSelectionChange(doc,anchor,head){var obj={anchor:anchor,head:head};signal(doc,\"beforeSelectionChange\",doc,obj);if(doc.cm)signal(doc.cm,\"beforeSelectionChange\",doc.cm,obj);obj.anchor=clipPos(doc,obj.anchor);obj.head=clipPos(doc,obj.head);return obj}function setSelection(doc,anchor,head,bias,checkAtomic){if(!checkAtomic&&hasHandler(doc,\"beforeSelectionChange\")||doc.cm&&hasHandler(doc.cm,\"beforeSelectionChange\")){var filtered=filterSelectionChange(doc,anchor,head);head=filtered.head;anchor=filtered.anchor}var sel=doc.sel;sel.goalColumn=null;if(checkAtomic||!posEq(anchor,sel.anchor))anchor=skipAtomic(doc,anchor,bias,checkAtomic!=\"push\");if(checkAtomic||!posEq(head,sel.head))head=skipAtomic(doc,head,bias,checkAtomic!=\"push\");if(posEq(sel.anchor,anchor)&&posEq(sel.head,head))return;sel.anchor=anchor;sel.head=head;var inv=posLess(head,anchor);sel.from=inv?head:anchor;sel.to=inv?anchor:head;if(doc.cm)doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=doc.cm.curOp.cursorActivity=true;signalLater(doc,\"cursorActivity\",doc)}function reCheckSelection(cm){setSelection(cm.doc,cm.doc.sel.from,cm.doc.sel.to,null,\"push\")}function skipAtomic(doc,pos,bias,mayClear){var flipped=false,curPos=pos;var dir=bias||1;doc.cantEdit&=~cantEdit_inatomic;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((sp.from==null||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(sp.to==null||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear){signal(m,\"beforeCursorEnter\");if(m.explicitlyCleared){if(!line.markedSpans)break;else{--i;continue}}}if(!m.atomic)continue;var newPos=m.find()[dir<0?\"from\":\"to\"];if(posEq(newPos,curPos)){newPos.ch+=dir;if(newPos.ch<0){if(newPos.line>doc.first)newPos=clipPos(doc,Pos(newPos.line-1));else newPos=null}else if(newPos.ch>line.text.length){if(newPos.line<doc.first+doc.size-1)newPos=Pos(newPos.line+1,0);else newPos=null}if(!newPos){if(flipped){if(!mayClear)return skipAtomic(doc,pos,bias,true);doc.cantEdit|=cantEdit_inatomic;return Pos(doc.first,0)}flipped=true;newPos=pos;dir=-dir}}curPos=newPos;continue search}}}return curPos}}function scrollCursorIntoView(cm){var coords=scrollPosIntoView(cm,cm.doc.sel.head,cm.options.cursorScrollMargin);if(!cm.state.focused)return;var display=cm.display,box=getRect(display.sizer),doScroll=null;if(coords.top+box.top<0)doScroll=true;else if(coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight))doScroll=false;if(doScroll!=null&&!phantom){var hidden=display.cursor.style.display==\"none\";if(hidden){display.cursor.style.display=\"\";display.cursor.style.left=coords.left+\"px\";display.cursor.style.top=coords.top-display.viewOffset+\"px\"}display.cursor.scrollIntoView(doScroll);if(hidden)display.cursor.style.display=\"none\"}}function scrollPosIntoView(cm,pos,margin){if(margin==null)margin=0;for(;;){var changed=false,coords=cursorCoords(cm,pos);var scrollPos=calculateScrollPos(cm,coords.left,coords.top-margin,coords.left,coords.bottom+margin);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1)changed=true}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1)changed=true}if(!changed)return coords}}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);if(scrollPos.scrollTop!=null)setScrollTop(cm,scrollPos.scrollTop);if(scrollPos.scrollLeft!=null)setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);if(y1<0)y1=0;var screen=display.scroller.clientHeight-scrollerCutOff,screentop=display.scroller.scrollTop,result={};var docBottom=cm.doc.height+paddingVert(display);var atTop=y1<snapMargin,atBottom=y2>docBottom-snapMargin;if(y1<screentop){result.scrollTop=atTop?0:y1}else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);if(newTop!=screentop)result.scrollTop=newTop}var screenw=display.scroller.clientWidth-scrollerCutOff,screenleft=display.scroller.scrollLeft;x1+=display.gutters.offsetWidth;x2+=display.gutters.offsetWidth;var gutterw=display.gutters.offsetWidth;var atLeft=x1<gutterw+10;if(x1<screenleft+gutterw||atLeft){if(atLeft)x1=0;result.scrollLeft=Math.max(0,x1-10-gutterw)}else if(x2>screenw+screenleft-3){result.scrollLeft=x2+10-screenw}return result}function updateScrollPos(cm,left,top){cm.curOp.updateScrollPos={scrollLeft:left==null?cm.doc.scrollLeft:left,scrollTop:top==null?cm.doc.scrollTop:top}}function addToScrollPos(cm,left,top){var pos=cm.curOp.updateScrollPos||(cm.curOp.updateScrollPos={scrollLeft:cm.doc.scrollLeft,scrollTop:cm.doc.scrollTop});var scroll=cm.display.scroller;pos.scrollTop=Math.max(0,Math.min(scroll.scrollHeight-scroll.clientHeight,pos.scrollTop+top));pos.scrollLeft=Math.max(0,Math.min(scroll.scrollWidth-scroll.clientWidth,pos.scrollLeft+left))}function indentLine(cm,n,how,aggressive){var doc=cm.doc;if(!how)how=\"add\";if(how==\"smart\"){if(!cm.doc.mode.indent)how=\"prev\";else var state=getStateBefore(cm,n)}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);var curSpaceString=line.text.match(/^\\s*/)[0],indentation;if(how==\"smart\"){indentation=cm.doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass){if(!aggressive)return;how=\"prev\"}}if(how==\"prev\"){if(n>doc.first)indentation=countColumn(getLine(doc,n-1).text,null,tabSize);else indentation=0}else if(how==\"add\"){indentation=curSpace+cm.options.indentUnit}else if(how==\"subtract\"){indentation=curSpace-cm.options.indentUnit}indentation=Math.max(0,indentation);var indentString=\"\",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+=\"\t\"}if(pos<indentation)indentString+=spaceStr(indentation-pos);if(indentString!=curSpaceString)replaceRange(cm.doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),\"+input\");line.stateAfter=null}function changeLine(cm,handle,op){var no=handle,line=handle,doc=cm.doc;\nif(typeof handle==\"number\")line=getLine(doc,clipLine(doc,handle));else no=lineNo(handle);if(no==null)return null;if(op(line,no))regChange(cm,no,no+1);else return null;return line}function findPosH(doc,pos,dir,unit,visually){var line=pos.line,ch=pos.ch,origDir=dir;var lineObj=getLine(doc,line);var possible=true;function findNextLine(){var l=line+dir;if(l<doc.first||l>=doc.first+doc.size)return possible=false;line=l;return lineObj=getLine(doc,l)}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,true);if(next==null){if(!boundToLine&&findNextLine()){if(visually)ch=(dir<0?lineRight:lineLeft)(lineObj);else ch=dir<0?lineObj.text.length:0}else return possible=false}else ch=next;return true}if(unit==\"char\")moveOnce();else if(unit==\"column\")moveOnce(true);else if(unit==\"word\"||unit==\"group\"){var sawType=null,group=unit==\"group\";for(var first=true;;first=false){if(dir<0&&!moveOnce(!first))break;var cur=lineObj.text.charAt(ch)||\"\\n\";var type=isWordChar(cur)?\"w\":!group?null:/\\s/.test(cur)?null:\"p\";if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce()}break}if(type)sawType=type;if(dir>0&&!moveOnce(!first))break}}var result=skipAtomic(doc,Pos(line,ch),origDir,true);if(!possible)result.hitSide=true;return result}function findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit==\"page\"){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(dir<0?1.5:.5)*textHeight(cm.display))}else if(unit==\"line\"){y=dir>0?pos.bottom+3:pos.top-3}for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break}y+=dir*5}return target}function findWordAt(line,pos){var start=pos.ch,end=pos.ch;if(line){if(pos.after===false||end==line.length)--start;else++end;var startChar=line.charAt(start);var check=isWordChar(startChar)?isWordChar:/\\s/.test(startChar)?function(ch){return/\\s/.test(ch)}:function(ch){return!/\\s/.test(ch)&&!isWordChar(ch)};while(start>0&&check(line.charAt(start-1)))--start;while(end<line.length&&check(line.charAt(end)))++end}return{from:Pos(pos.line,start),to:Pos(pos.line,end)}}function selectLine(cm,line){extendSelection(cm.doc,Pos(line,0),clipPos(cm.doc,Pos(line+1,0)))}CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus();focusInput(this);onFocus(this);fastPoll(this)},setOption:function(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!=\"mode\")return;options[option]=value;if(optionHandlers.hasOwnProperty(option))operation(this,optionHandlers[option])(this,value,old)},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?\"push\":\"unshift\"](map)},removeKeyMap:function(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i)if((typeof map==\"string\"?maps[i].name:maps[i])==map){maps.splice(i,1);return true}},addOverlay:operation(null,function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error(\"Overlays may not be stateful.\");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque});this.state.modeGen++;regChange(this)}),removeOverlay:operation(null,function(spec){var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||typeof spec==\"string\"&&cur.name==spec){overlays.splice(i,1);this.state.modeGen++;regChange(this);return}}}),indentLine:operation(null,function(n,dir,aggressive){if(typeof dir!=\"string\"){if(dir==null)dir=this.options.smartIndent?\"smart\":\"prev\";else dir=dir?\"add\":\"subtract\"}if(isLine(this.doc,n))indentLine(this,n,dir,aggressive)}),indentSelection:operation(null,function(how){var sel=this.doc.sel;if(posEq(sel.from,sel.to))return indentLine(this,sel.from.line,how);var e=sel.to.line-(sel.to.ch?0:1);for(var i=sel.from.line;i<=e;++i)indentLine(this,i,how)}),getTokenAt:function(pos){var doc=this.doc;pos=clipPos(doc,pos);var state=getStateBefore(this,pos.line),mode=this.doc.mode;var line=getLine(doc,pos.line);var stream=new StringStream(line.text,this.options.tabSize);while(stream.pos<pos.ch&&!stream.eol()){stream.start=stream.pos;var style=mode.token(stream,state)}return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,type:style||null,state:state}},getStateAfter:function(line){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getStateBefore(this,line+1)},cursorCoords:function(start,mode){var pos,sel=this.doc.sel;if(start==null)pos=sel.head;else if(typeof start==\"object\")pos=clipPos(this.doc,start);else pos=start?sel.from:sel.to;return cursorCoords(this,pos,mode||\"page\")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||\"page\")},coordsChar:function(coords,mode){coords=fromCoordSystem(this,coords,mode||\"page\");return coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){height=fromCoordSystem(this,{top:height,left:0},mode||\"page\").top;return lineAtHeight(this.doc,height+this.display.viewOffset)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:operation(null,function(line,gutterID,value){return changeLine(this,line,function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers))line.gutterMarkers=null;return true})}),clearGutter:operation(null,function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){line.gutterMarkers[gutterID]=null;regChange(cm,i,i+1);if(isEmpty(line.gutterMarkers))line.gutterMarkers=null}++i})}),addLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where==\"text\"?\"textClass\":where==\"background\"?\"bgClass\":\"wrapClass\";if(!line[prop])line[prop]=cls;else if(new RegExp(\"\\\\b\"+cls+\"\\\\b\").test(line[prop]))return false;else line[prop]+=\" \"+cls;return true})}),removeLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where==\"text\"?\"textClass\":where==\"background\"?\"bgClass\":\"wrapClass\";var cur=line[prop];if(!cur)return false;else if(cls==null)line[prop]=null;else{var upd=cur.replace(new RegExp(\"^\"+cls+\"\\\\b\\\\s*|\\\\s*\\\\b\"+cls+\"\\\\b\"),\"\");if(upd==cur)return false;line[prop]=upd||null}return true})}),addLineWidget:operation(null,function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},lineInfo:function(line){if(typeof line==\"number\"){if(!isLine(this.doc,line))return null;var n=line;line=getLine(this.doc,line);if(!line)return null}else{var n=lineNo(line);if(n==null)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position=\"absolute\";display.sizer.appendChild(node);if(vert==\"over\"){top=pos.top}else if(vert==\"above\"||vert==\"near\"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);if((vert==\"above\"||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight)top=pos.top-node.offsetHeight;else if(pos.bottom+node.offsetHeight<=vspace)top=pos.bottom;if(left+node.offsetWidth>hspace)left=hspace-node.offsetWidth}node.style.top=top+\"px\";node.style.left=node.style.right=\"\";if(horiz==\"right\"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right=\"0px\"}else{if(horiz==\"left\")left=0;else if(horiz==\"middle\")left=(display.sizer.clientWidth-node.offsetWidth)/2;node.style.left=left+\"px\"}if(scroll)scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:operation(null,onKeyDown),execCommand:function(cmd){return commands[cmd](this)},findPosH:function(from,amount,unit,visually){var dir=1;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){cur=findPosH(this.doc,cur,dir,unit,visually);if(cur.hitSide)break}return cur},moveH:operation(null,function(dir,unit){var sel=this.doc.sel,pos;if(sel.shift||sel.extend||posEq(sel.from,sel.to))pos=findPosH(this.doc,sel.head,dir,unit,this.options.rtlMoveVisually);else pos=dir<0?sel.from:sel.to;extendSelection(this.doc,pos,pos,dir)}),deleteH:operation(null,function(dir,unit){var sel=this.doc.sel;if(!posEq(sel.from,sel.to))replaceRange(this.doc,\"\",sel.from,sel.to,\"+delete\");else replaceRange(this.doc,\"\",sel.from,findPosH(this.doc,sel.head,dir,unit,false),\"+delete\");this.curOp.userSelChange=true}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){var coords=cursorCoords(this,cur,\"div\");if(x==null)x=coords.left;else coords.left=x;cur=findPosV(this,coords,dir,unit);if(cur.hitSide)break}return cur},moveV:operation(null,function(dir,unit){var sel=this.doc.sel;var pos=cursorCoords(this,sel.head,\"div\");if(sel.goalColumn!=null)pos.left=sel.goalColumn;var target=findPosV(this,pos,dir,unit);if(unit==\"page\")addToScrollPos(this,0,charCoords(this,target,\"div\").top-pos.top);extendSelection(this.doc,target,target,dir);sel.goalColumn=pos.left}),toggleOverwrite:function(value){if(value!=null&&value==this.state.overwrite)return;if(this.state.overwrite=!this.state.overwrite)this.display.cursor.className+=\" CodeMirror-overwrite\";else this.display.cursor.className=this.display.cursor.className.replace(\" CodeMirror-overwrite\",\"\")},hasFocus:function(){return this.state.focused},scrollTo:operation(null,function(x,y){updateScrollPos(this,x,y)}),getScrollInfo:function(){var scroller=this.display.scroller,co=scrollerCutOff;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-co,width:scroller.scrollWidth-co,clientHeight:scroller.clientHeight-co,clientWidth:scroller.clientWidth-co}},scrollIntoView:operation(null,function(pos,margin){if(typeof pos==\"number\")pos=Pos(pos,0);if(!margin)margin=0;var coords=pos;if(!pos||pos.line!=null){this.curOp.scrollToPos=pos?clipPos(this.doc,pos):this.doc.sel.head;this.curOp.scrollToPosMargin=margin;coords=cursorCoords(this,this.curOp.scrollToPos)}var sPos=calculateScrollPos(this,coords.left,coords.top-margin,coords.right,coords.bottom+margin);updateScrollPos(this,sPos.scrollLeft,sPos.scrollTop)}),setSize:function(width,height){function interpret(val){return typeof val==\"number\"||/^\\d+$/.test(String(val))?val+\"px\":val}if(width!=null)this.display.wrapper.style.width=interpret(width);if(height!=null)this.display.wrapper.style.height=interpret(height);this.refresh()},on:function(type,f){on(this,type,f)},off:function(type,f){off(this,type,f)},operation:function(f){return runInOp(this,f)},refresh:operation(null,function(){clearCaches(this);updateScrollPos(this,this.doc.scrollLeft,this.doc.scrollTop);regChange(this)}),swapDoc:operation(null,function(doc){var old=this.doc;old.cm=null;attachDoc(this,doc);clearCaches(this);resetInput(this,true);updateScrollPos(this,doc.scrollLeft,doc.scrollTop);return old}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var optionHandlers=CodeMirror.optionHandlers={};var defaults=CodeMirror.defaults={};function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle)optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init)handle(cm,val,old)}:handle}var Init=CodeMirror.Init={toString:function(){return\"CodeMirror.Init\"}};option(\"value\",\"\",function(cm,val){cm.setValue(val)},true);option(\"mode\",null,function(cm,val){cm.doc.modeOption=val;loadMode(cm)},true);option(\"indentUnit\",2,loadMode,true);option(\"indentWithTabs\",false);option(\"smartIndent\",true);option(\"tabSize\",4,function(cm){loadMode(cm);clearCaches(cm);regChange(cm)},true);option(\"electricChars\",true);option(\"rtlMoveVisually\",!windows);option(\"theme\",\"default\",function(cm){themeChanged(cm);guttersChanged(cm)},true);option(\"keyMap\",\"default\",keyMapChanged);option(\"extraKeys\",null);option(\"onKeyEvent\",null);option(\"onDragEvent\",null);option(\"lineWrapping\",false,wrappingChanged,true);option(\"gutters\",[],function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option(\"fixedGutter\",true,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+\"px\":\"0\";cm.refresh()},true);option(\"coverGutterNextToScrollbar\",false,updateScrollbars,true);option(\"lineNumbers\",false,function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option(\"firstLineNumber\",1,guttersChanged,true);option(\"lineNumberFormatter\",function(integer){return integer},guttersChanged,true);option(\"showCursorWhenSelecting\",false,updateSelection,true);option(\"readOnly\",false,function(cm,val){if(val==\"nocursor\"){onBlur(cm);cm.display.input.blur()}else if(!val)resetInput(cm,true)});option(\"dragDrop\",true);option(\"cursorBlinkRate\",530);option(\"cursorScrollMargin\",0);option(\"cursorHeight\",1);option(\"workTime\",100);option(\"workDelay\",100);option(\"flattenSpans\",true);option(\"pollInterval\",100);option(\"undoDepth\",40,function(cm,val){cm.doc.history.undoDepth=val});option(\"historyEventDelay\",500);option(\"viewportMargin\",10,function(cm){cm.refresh()},true);option(\"maxHighlightLength\",1e4,function(cm){loadMode(cm);cm.refresh()},true);option(\"moveInputWithCursor\",true,function(cm,val){if(!val)cm.display.inputDiv.style.top=cm.display.inputDiv.style.left=0});option(\"tabindex\",null,function(cm,val){cm.display.input.tabIndex=val||\"\"});option(\"autofocus\",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(!CodeMirror.defaults.mode&&name!=\"null\")CodeMirror.defaults.mode=name;if(arguments.length>2){mode.dependencies=[];for(var i=2;i<arguments.length;++i)mode.dependencies.push(arguments[i])}modes[name]=mode};CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec};CodeMirror.resolveMode=function(spec){if(typeof spec==\"string\"&&mimeModes.hasOwnProperty(spec)){spec=mimeModes[spec]}else if(spec&&typeof spec.name==\"string\"&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];spec=createObj(found,spec);spec.name=found.name}else if(typeof spec==\"string\"&&/^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)){return CodeMirror.resolveMode(\"application/xml\")}if(typeof spec==\"string\")return{name:spec};else return spec||{name:\"null\"}};CodeMirror.getMode=function(options,spec){spec=CodeMirror.resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,\"text/plain\");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop))continue;if(modeObj.hasOwnProperty(prop))modeObj[\"_\"+prop]=modeObj[prop];modeObj[prop]=exts[prop]}}modeObj.name=spec.name;return modeObj};CodeMirror.defineMode(\"null\",function(){return{token:function(stream){stream.skipToEnd()}}});CodeMirror.defineMIME(\"text/plain\",\"null\");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)};CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func};CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};function copyState(mode,state){if(state===true)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];if(val instanceof Array)val=val.concat([]);nstate[n]=val}return nstate}CodeMirror.copyState=copyState;function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true}CodeMirror.startState=startState;CodeMirror.innerMode=function(mode,state){while(mode.innerMode){var info=mode.innerMode(state);state=info.state;mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()))},killLine:function(cm){var from=cm.getCursor(true),to=cm.getCursor(false),sel=!posEq(from,to);if(!sel&&cm.getLine(from.line).length==from.ch)cm.replaceRange(\"\",from,Pos(from.line+1,0),\"+delete\");else cm.replaceRange(\"\",from,sel?to:Pos(from.line),\"+delete\")},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange(\"\",Pos(l,0),Pos(l),\"+delete\")},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelection(lineStart(cm,cm.getCursor().line))},goLineStartSmart:function(cm){var cur=cm.getCursor(),start=lineStart(cm,cur.line);var line=cm.getLineHandle(start.line);var order=getOrder(line);if(!order||order[0].level==0){var firstNonWS=Math.max(0,line.text.search(/\\S/));var inWS=cur.line==start.line&&cur.ch<=firstNonWS&&cur.ch;cm.extendSelection(Pos(start.line,inWS?0:firstNonWS))}else cm.extendSelection(start)},goLineEnd:function(cm){cm.extendSelection(lineEnd(cm,cm.getCursor().line))},goLineRight:function(cm){var top=cm.charCoords(cm.getCursor(),\"div\").top+5;cm.extendSelection(cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},\"div\"))},goLineLeft:function(cm){var top=cm.charCoords(cm.getCursor(),\"div\").top+5;cm.extendSelection(cm.coordsChar({left:0,top:top},\"div\"))},goLineUp:function(cm){cm.moveV(-1,\"line\")},goLineDown:function(cm){cm.moveV(1,\"line\")},goPageUp:function(cm){cm.moveV(-1,\"page\")},goPageDown:function(cm){cm.moveV(1,\"page\")},goCharLeft:function(cm){cm.moveH(-1,\"char\")},goCharRight:function(cm){cm.moveH(1,\"char\")},goColumnLeft:function(cm){cm.moveH(-1,\"column\")},goColumnRight:function(cm){cm.moveH(1,\"column\")},goWordLeft:function(cm){cm.moveH(-1,\"word\")},goGroupRight:function(cm){cm.moveH(1,\"group\")},goGroupLeft:function(cm){cm.moveH(-1,\"group\")},goWordRight:function(cm){cm.moveH(1,\"word\")},delCharBefore:function(cm){cm.deleteH(-1,\"char\")},delCharAfter:function(cm){cm.deleteH(1,\"char\")},delWordBefore:function(cm){cm.deleteH(-1,\"word\")},delWordAfter:function(cm){cm.deleteH(1,\"word\")},delGroupBefore:function(cm){cm.deleteH(-1,\"group\")},delGroupAfter:function(cm){cm.deleteH(1,\"group\")},indentAuto:function(cm){cm.indentSelection(\"smart\")},indentMore:function(cm){cm.indentSelection(\"add\")},indentLess:function(cm){cm.indentSelection(\"subtract\")},insertTab:function(cm){cm.replaceSelection(\"\t\",\"end\",\"+input\")},defaultTab:function(cm){if(cm.somethingSelected())cm.indentSelection(\"add\");else cm.replaceSelection(\"\t\",\"end\",\"+input\")},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);if(cur.ch>0&&cur.ch<line.length-1)cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1))},newlineAndIndent:function(cm){operation(cm,function(){cm.replaceSelection(\"\\n\",\"end\",\"+input\");cm.indentLine(cm.getCursor().line,null,true)})()},toggleOverwrite:function(cm){cm.toggleOverwrite()}};var keyMap=CodeMirror.keyMap={};keyMap.basic={Left:\"goCharLeft\",Right:\"goCharRight\",Up:\"goLineUp\",Down:\"goLineDown\",End:\"goLineEnd\",Home:\"goLineStartSmart\",PageUp:\"goPageUp\",PageDown:\"goPageDown\",Delete:\"delCharAfter\",Backspace:\"delCharBefore\",Tab:\"defaultTab\",\"Shift-Tab\":\"indentAuto\",Enter:\"newlineAndIndent\",Insert:\"toggleOverwrite\"};keyMap.pcDefault={\"Ctrl-A\":\"selectAll\",\"Ctrl-D\":\"deleteLine\",\"Ctrl-Z\":\"undo\",\"Shift-Ctrl-Z\":\"redo\",\"Ctrl-Y\":\"redo\",\"Ctrl-Home\":\"goDocStart\",\"Alt-Up\":\"goDocStart\",\"Ctrl-End\":\"goDocEnd\",\"Ctrl-Down\":\"goDocEnd\",\"Ctrl-Left\":\"goGroupLeft\",\"Ctrl-Right\":\"goGroupRight\",\"Alt-Left\":\"goLineStart\",\"Alt-Right\":\"goLineEnd\",\"Ctrl-Backspace\":\"delGroupBefore\",\"Ctrl-Delete\":\"delGroupAfter\",\"Ctrl-S\":\"save\",\"Ctrl-F\":\"find\",\"Ctrl-G\":\"findNext\",\"Shift-Ctrl-G\":\"findPrev\",\"Shift-Ctrl-F\":\"replace\",\"Shift-Ctrl-R\":\"replaceAll\",\"Ctrl-[\":\"indentLess\",\"Ctrl-]\":\"indentMore\",fallthrough:\"basic\"};keyMap.macDefault={\"Cmd-A\":\"selectAll\",\"Cmd-D\":\"deleteLine\",\"Cmd-Z\":\"undo\",\"Shift-Cmd-Z\":\"redo\",\"Cmd-Y\":\"redo\",\"Cmd-Up\":\"goDocStart\",\"Cmd-End\":\"goDocEnd\",\"Cmd-Down\":\"goDocEnd\",\"Alt-Left\":\"goGroupLeft\",\"Alt-Right\":\"goGroupRight\",\"Cmd-Left\":\"goLineStart\",\"Cmd-Right\":\"goLineEnd\",\"Alt-Backspace\":\"delGroupBefore\",\"Ctrl-Alt-Backspace\":\"delGroupAfter\",\"Alt-Delete\":\"delGroupAfter\",\"Cmd-S\":\"save\",\"Cmd-F\":\"find\",\"Cmd-G\":\"findNext\",\"Shift-Cmd-G\":\"findPrev\",\"Cmd-Alt-F\":\"replace\",\"Shift-Cmd-Alt-F\":\"replaceAll\",\"Cmd-[\":\"indentLess\",\"Cmd-]\":\"indentMore\",fallthrough:[\"basic\",\"emacsy\"]};keyMap[\"default\"]=mac?keyMap.macDefault:keyMap.pcDefault;keyMap.emacsy={\"Ctrl-F\":\"goCharRight\",\"Ctrl-B\":\"goCharLeft\",\"Ctrl-P\":\"goLineUp\",\"Ctrl-N\":\"goLineDown\",\"Alt-F\":\"goWordRight\",\"Alt-B\":\"goWordLeft\",\"Ctrl-A\":\"goLineStart\",\"Ctrl-E\":\"goLineEnd\",\"Ctrl-V\":\"goPageDown\",\"Shift-Ctrl-V\":\"goPageUp\",\"Ctrl-D\":\"delCharAfter\",\"Ctrl-H\":\"delCharBefore\",\"Alt-D\":\"delWordAfter\",\"Alt-Backspace\":\"delWordBefore\",\"Ctrl-K\":\"killLine\",\"Ctrl-T\":\"transposeChars\"};function getKeyMap(val){if(typeof val==\"string\")return keyMap[val];else return val}function lookupKey(name,maps,handle){function lookup(map){map=getKeyMap(map);var found=map[name];if(found===false)return\"stop\";if(found!=null&&handle(found))return true;if(map.nofallthrough)return\"stop\";var fallthrough=map.fallthrough;if(fallthrough==null)return false;if(Object.prototype.toString.call(fallthrough)!=\"[object Array]\")return lookup(fallthrough);for(var i=0,e=fallthrough.length;i<e;++i){var done=lookup(fallthrough[i]);if(done)return done}return false}for(var i=0;i<maps.length;++i){var done=lookup(maps[i]);if(done)return done!=\"stop\"}}function isModifierKey(event){var name=keyNames[event.keyCode];return name==\"Ctrl\"||name==\"Alt\"||name==\"Shift\"||name==\"Mod\"}function keyName(event,noShift){if(opera&&event.keyCode==34&&event[\"char\"])return false;var name=keyNames[event.keyCode];if(name==null||event.altGraphKey)return false;if(event.altKey)name=\"Alt-\"+name;if(flipCtrlCmd?event.metaKey:event.ctrlKey)name=\"Ctrl-\"+name;if(flipCtrlCmd?event.ctrlKey:event.metaKey)name=\"Cmd-\"+name;if(!noShift&&event.shiftKey)name=\"Shift-\"+name;return name}CodeMirror.lookupKey=lookupKey;CodeMirror.isModifierKey=isModifierKey;CodeMirror.keyName=keyName;CodeMirror.fromTextArea=function(textarea,options){if(!options)options={};options.value=textarea.value;if(!options.tabindex&&textarea.tabindex)options.tabindex=textarea.tabindex;if(!options.placeholder&&textarea.placeholder)options.placeholder=textarea.placeholder;if(options.autofocus==null){var hasFocus=document.body;try{hasFocus=document.activeElement}catch(e){}options.autofocus=hasFocus==textarea||textarea.getAttribute(\"autofocus\")!=null&&hasFocus==document.body}function save(){textarea.value=cm.getValue()}if(textarea.form){on(textarea.form,\"submit\",save);if(!options.leaveSubmitMethodAlone){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save();form.submit=realSubmit;form.submit();form.submit=wrappedSubmit}}catch(e){}}}textarea.style.display=\"none\";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);cm.save=save;cm.getTextArea=function(){return textarea};cm.toTextArea=function(){save();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display=\"\";if(textarea.form){off(textarea.form,\"submit\",save);if(typeof textarea.form.submit==\"function\")textarea.form.submit=realSubmit}};return cm};function StringStream(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0}StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(match){var ch=this.string.charAt(this.pos);if(typeof match==\"string\")var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));if(ok){++this.pos;return ch}},eatWhile:function(match){var start=this.pos;while(this.eat(match)){}return this.pos>start},eatSpace:function(){var start=this.pos;while(/[\\s\\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true}},backUp:function(n){this.pos-=n},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue},indentation:function(){return countColumn(this.string,null,this.tabSize)},match:function(pattern,consume,caseInsensitive){if(typeof pattern==\"string\"){var cased=function(str){return caseInsensitive?str.toLowerCase():str};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false)this.pos+=pattern.length;return true}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0)return null;if(match&&consume!==false)this.pos+=match[0].length;return match}},current:function(){return this.string.slice(this.start,this.pos)}};CodeMirror.StringStream=StringStream;function TextMarker(doc,type){this.lines=[];this.type=type;this.doc=doc}CodeMirror.TextMarker=TextMarker;TextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp)startOperation(cm);var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.to!=null)max=lineNo(line);line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from!=null)min=lineNo(line);else if(this.collapsed&&!lineIsHidden(this.doc,line)&&cm)updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(cm.doc,this.lines[i]),len=lineLength(cm.doc,visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true}}if(min!=null&&cm)regChange(cm,min,max+1);this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit&cantEdit_inatomic){this.doc.cantEdit&=~cantEdit_inatomic;if(cm)reCheckSelection(cm)}if(withOp)endOperation(cm);signalLater(this,\"clear\")};TextMarker.prototype.find=function(){var from,to;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.from!=null||span.to!=null){var found=lineNo(line);if(span.from!=null)from=Pos(found,span.from);if(span.to!=null)to=Pos(found,span.to)}}if(this.type==\"bookmark\")return from;return from&&{from:from,to:to}};TextMarker.prototype.changed=function(){var pos=this.find(),cm=this.doc.cm;if(!pos||!cm)return;var line=getLine(this.doc,pos.from.line);clearCachedMeasurement(cm,line);if(pos.from.line>=cm.display.showingFrom&&pos.from.line<cm.display.showingTo){for(var node=cm.display.lineDiv.firstChild;node;node=node.nextSibling)if(node.lineObj==line){if(node.offsetHeight!=line.height)updateLineHeight(line,node.offsetHeight);break}runInOp(cm,function(){cm.curOp.selectionChanged=true})}};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1)(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type);if(type==\"range\"&&!posLess(from,to))return marker;if(options)copyObj(options,marker);if(marker.replacedWith){marker.collapsed=true;marker.replacedWith=elt(\"span\",[marker.replacedWith],\"CodeMirror-widget\");if(!options.handleMouseEvents)marker.replacedWith.ignoreEvents=true}if(marker.collapsed)sawCollapsedSpans=true;if(marker.addToHistory)addToHistory(doc,{from:from,to:to,origin:\"markText\"},{head:doc.sel.head,anchor:doc.sel.anchor},NaN);var curLine=from.line,size=0,collapsedAtStart,collapsedAtEnd,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(doc,line)==cm.display.maxLine)updateMaxLine=true;var span={from:null,to:null,marker:marker};size+=line.text.length;if(curLine==from.line){span.from=from.ch;size-=from.ch}if(curLine==to.line){span.to=to.ch;size-=line.text.length-to.ch}if(marker.collapsed){if(curLine==to.line)collapsedAtEnd=collapsedSpanAt(line,to.ch);if(curLine==from.line)collapsedAtStart=collapsedSpanAt(line,from.ch);else updateLineHeight(line,0)}addMarkedSpan(line,span);++curLine});if(marker.collapsed)doc.iter(from.line,to.line+1,function(line){if(lineIsHidden(doc,line))updateLineHeight(line,0)});if(marker.clearOnEnter)on(marker,\"beforeCursorEnter\",function(){marker.clear()});if(marker.readOnly){sawReadOnlySpans=true;if(doc.history.done.length||doc.history.undone.length)doc.clearHistory()}if(marker.collapsed){if(collapsedAtStart!=collapsedAtEnd)throw new Error(\"Inserting collapsed marker overlapping an existing one\");marker.size=size;marker.atomic=true}if(cm){if(updateMaxLine)cm.curOp.updateMaxLine=true;if(marker.className||marker.startStyle||marker.endStyle||marker.collapsed)regChange(cm,from.line,to.line+1);if(marker.atomic)reCheckSelection(cm)}return marker}function SharedTextMarker(markers,primary){this.markers=markers;this.primary=primary;for(var i=0,me=this;i<markers.length;++i){markers[i].parent=this;on(markers[i],\"clear\",function(){me.clear()})}}CodeMirror.SharedTextMarker=SharedTextMarker;SharedTextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,\"clear\")};SharedTextMarker.prototype.find=function(){return this.primary.find()};function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[markText(doc,from,to,options,type)],primary=markers[0];var widget=options.replacedWith;linkedDocs(doc,function(doc){if(widget)options.replacedWith=widget.cloneNode(true);markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)});return new SharedTextMarker(markers,primary)}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)if(spans[i]!=span)(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||marker.type==\"bookmark\"&&span.from==startCh&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);\n(nw||(nw=[])).push({from:span.from,to:endsAfter?null:span.to,marker:marker})}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||marker.type==\"bookmark\"&&span.from==endCh&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push({from:startsBefore?null:span.from-endCh,to:span.to==null?null:span.to-endCh,marker:marker})}}return nw}function stretchSpansOverChange(doc,change){var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=posEq(change.from,change.to);var first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);var sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){for(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found)span.to=startCh;else if(sameLine)span.to=found.to==null?null:found.to+offset}}}if(last){for(var i=0;i<last.length;++i){var span=last[i];if(span.to!=null)span.to+=offset;if(span.from==null){var found=getMarkedSpanFor(first,span.marker);if(!found){span.from=offset;if(sameLine)(first||(first=[])).push(span)}}else{span.from+=offset;if(sameLine)(first||(first=[])).push(span)}}}var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(gap>0&&first)for(var i=0;i<first.length;++i)if(first[i].to==null)(gapMarkers||(gapMarkers=[])).push({from:null,to:null,marker:first[i].marker});for(var i=0;i<gap;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}}else if(stretchCur){old[i]=stretchCur}}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1))(markers||(markers=[])).push(mark)}});if(!markers)return null;var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find();for(var j=0;j<parts.length;++j){var p=parts[j];if(posLess(p.to,m.from)||posLess(m.to,p.from))continue;var newParts=[j,1];if(posLess(p.from,m.from)||!mk.inclusiveLeft&&posEq(p.from,m.from))newParts.push({from:p.from,to:m.from});if(posLess(m.to,p.to)||!mk.inclusiveRight&&posEq(p.to,m.to))newParts.push({from:m.to,to:p.to});parts.splice.apply(parts,newParts);j+=newParts.length-1}}return parts}function collapsedSpanAt(line,ch){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if((sp.from==null||sp.from<ch)&&(sp.to==null||sp.to>ch)&&(!found||found.width<sp.marker.width))found=sp.marker}return found}function collapsedSpanAtStart(line){return collapsedSpanAt(line,-1)}function collapsedSpanAtEnd(line){return collapsedSpanAt(line,line.text.length+1)}function visualLine(doc,line){var merged;while(merged=collapsedSpanAtStart(line))line=getLine(doc,merged.find().from.line);return line}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if(sp.from==null)return true;if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return true}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find().to,endLine=getLine(doc,end.line);return lineIsHiddenInner(doc,endLine,getMarkedSpanFor(endLine.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return true;for(var sp,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&sp.from==span.to&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return true}}function detachMarkedSpans(line){var spans=line.markedSpans;if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}function attachMarkedSpans(line,spans){if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}var LineWidget=CodeMirror.LineWidget=function(cm,node,options){for(var opt in options)if(options.hasOwnProperty(opt))this[opt]=options[opt];this.cm=cm;this.node=node};function widgetOperation(f){return function(){var withOp=!this.cm.curOp;if(withOp)startOperation(this.cm);try{var result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}LineWidget.prototype.clear=widgetOperation(function(){var ws=this.line.widgets,no=lineNo(this.line);if(no==null||!ws)return;for(var i=0;i<ws.length;++i)if(ws[i]==this)ws.splice(i--,1);if(!ws.length)this.line.widgets=null;updateLineHeight(this.line,Math.max(0,this.line.height-widgetHeight(this)));regChange(this.cm,no,no+1)});LineWidget.prototype.changed=widgetOperation(function(){var oldH=this.height;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff)return;updateLineHeight(this.line,this.line.height+diff);var no=lineNo(this.line);regChange(this.cm,no,no+1)});function widgetHeight(widget){if(widget.height!=null)return widget.height;if(!widget.node.parentNode||widget.node.parentNode.nodeType!=1)removeChildrenAndAdd(widget.cm.display.measure,elt(\"div\",[widget.node],null,\"position: relative\"));return widget.height=widget.node.offsetHeight}function addLineWidget(cm,handle,node,options){var widget=new LineWidget(cm,node,options);if(widget.noHScroll)cm.display.alignWidgets=true;changeLine(cm,handle,function(line){(line.widgets||(line.widgets=[])).push(widget);widget.line=line;if(!lineIsHidden(cm.doc,line)||widget.showIfHidden){var aboveVisible=heightAtLine(cm,line)<cm.display.scroller.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible)addToScrollPos(cm,0,widget.height)}return true});return widget}function makeLine(text,markedSpans,estimateHeight){var line={text:text};attachMarkedSpans(line,markedSpans);line.height=estimateHeight?estimateHeight(line):1;return line}function updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null;if(line.order!=null)line.order=null;detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height)updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null;detachMarkedSpans(line)}function runMode(cm,text,mode,state,f){var flattenSpans=mode.flattenSpans;if(flattenSpans==null)flattenSpans=cm.options.flattenSpans;var curText=\"\",curStyle=null;var stream=new StringStream(text,cm.options.tabSize),style;if(text==\"\"&&mode.blankLine)mode.blankLine(state);while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;stream.pos=Math.min(text.length,stream.start+5e4);style=null}else{style=mode.token(stream,state)}var substr=stream.current();stream.start=stream.pos;if(!flattenSpans||curStyle!=style){if(curText)f(curText,curStyle);curText=substr;curStyle=style}else curText=curText+substr}if(curText)f(curText,curStyle)}function highlightLine(cm,line,state){var st=[cm.state.modeGen];runMode(cm,line.text,cm.doc.mode,state,function(txt,style){st.push(txt,style)});for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1;runMode(cm,line.text,overlay.mode,true,function(txt,style){var start=i,len=txt.length;while(len){var cur=st[i],len_=cur.length;if(len_<=len){len-=len_}else{st.splice(i,1,cur.slice(0,len),st[i+1],cur.slice(len));len=0}i+=2}if(!style)return;if(overlay.opaque){st.splice(start,i-start,txt,style);i=start+2}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=cur?cur+\" \"+style:style}}})}return st}function getLineStyles(cm,line){if(!line.styles||line.styles[0]!=cm.state.modeGen)line.styles=highlightLine(cm,line,line.stateAfter=getStateBefore(cm,lineNo(line)));return line.styles}function processLine(cm,line,state){var mode=cm.doc.mode;var stream=new StringStream(line.text,cm.options.tabSize);if(line.text==\"\"&&mode.blankLine)mode.blankLine(state);while(!stream.eol()&&stream.pos<=cm.options.maxHighlightLength){mode.token(stream,state);stream.start=stream.pos}}var styleToClassCache={};function styleToClass(style){if(!style)return null;return styleToClassCache[style]||(styleToClassCache[style]=\"cm-\"+style.replace(/ +/g,\" cm-\"))}function lineContent(cm,realLine,measure){var merged,line=realLine,lineBefore,sawBefore,empty=true;while(merged=collapsedSpanAtStart(line)){line=getLine(cm.doc,merged.find().from.line);if(!lineBefore)lineBefore=line}var builder={pre:elt(\"pre\"),col:0,pos:0,display:!measure,measure:null,addedOne:false,cm:cm};if(line.textClass)builder.pre.className=line.textClass;do{if(line.text)empty=false;builder.measure=line==realLine&&measure;builder.pos=0;builder.addToken=builder.measure?buildTokenMeasure:buildToken;if((ie||webkit)&&cm.getOption(\"lineWrapping\"))builder.addToken=buildTokenSplitSpaces(builder.addToken);if(measure&&sawBefore&&line!=realLine&&!builder.addedOne){measure[0]=builder.pre.appendChild(zeroWidthElement(cm.display.measure));builder.addedOne=true}var next=insertLineContent(line,builder,getLineStyles(cm,line));sawBefore=line==lineBefore;if(next)line=getLine(cm.doc,next.to.line)}while(next);if(measure&&!builder.addedOne)measure[0]=builder.pre.appendChild(empty?elt(\"span\",\"\"):zeroWidthElement(cm.display.measure));if(!builder.pre.firstChild&&!lineIsHidden(cm.doc,realLine))builder.pre.appendChild(document.createTextNode(\"\"));var order;if(measure&&ie&&(order=getOrder(line))){var l=order.length-1;if(order[l].from==order[l].to)--l;var last=order[l],prev=order[l-1];if(last.from+1==last.to&&prev&&last.level<prev.level){var span=measure[builder.pos-1];if(span)span.parentNode.insertBefore(span.measureRight=zeroWidthElement(cm.display.measure),span.nextSibling)}}signal(cm,\"renderLine\",cm,realLine,builder.pre);return builder.pre}var tokenSpecialChars=/[\\t\\u0000-\\u0019\\u00ad\\u200b\\u2028\\u2029\\uFEFF]/g;function buildToken(builder,text,style,startStyle,endStyle){if(!text)return;if(!tokenSpecialChars.test(text)){builder.col+=text.length;var content=document.createTextNode(text)}else{var content=document.createDocumentFragment(),pos=0;while(true){tokenSpecialChars.lastIndex=pos;var m=tokenSpecialChars.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){content.appendChild(document.createTextNode(text.slice(pos,pos+skipped)));builder.col+=skipped}if(!m)break;pos+=skipped+1;if(m[0]==\"\t\"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;content.appendChild(elt(\"span\",spaceStr(tabWidth),\"cm-tab\"));builder.col+=tabWidth}else{var token=elt(\"span\",\"\",\"cm-invalidchar\");token.title=\"\\\\u\"+m[0].charCodeAt(0).toString(16);content.appendChild(token);builder.col+=1}}}if(style||startStyle||endStyle||builder.measure){var fullStyle=style||\"\";if(startStyle)fullStyle+=startStyle;if(endStyle)fullStyle+=endStyle;return builder.pre.appendChild(elt(\"span\",[content],fullStyle))}builder.pre.appendChild(content)}function buildTokenMeasure(builder,text,style,startStyle,endStyle){var wrapping=builder.cm.options.lineWrapping;for(var i=0;i<text.length;++i){var ch=text.charAt(i),start=i==0;if(ch>=\"\"&&ch<\"\"&&i<text.length-1){ch=text.slice(i,i+2);++i}else if(i&&wrapping&&spanAffectsWrapping(text,i)){builder.pre.appendChild(elt(\"wbr\"))}var span=builder.measure[builder.pos]=buildToken(builder,ch,style,start&&startStyle,i==text.length-1&&endStyle);if(ie&&wrapping&&ch==\" \"&&i&&!/\\s/.test(text.charAt(i-1))&&i<text.length-1&&!/\\s/.test(text.charAt(i+1)))span.style.whiteSpace=\"normal\";builder.pos+=ch.length}if(text.length)builder.addedOne=true}function buildTokenSplitSpaces(inner){function split(old){var out=\" \";for(var i=0;i<old.length-2;++i)out+=i%2?\" \":\"\";out+=\" \";return out}return function(builder,text,style,startStyle,endStyle){return inner(builder,text.replace(/ {3,}/,split),style,startStyle,endStyle)}}function buildCollapsedSpan(builder,size,widget){if(widget){if(!builder.display)widget=widget.cloneNode(true);builder.pre.appendChild(widget);if(builder.measure&&size){builder.measure[builder.pos]=widget;builder.addedOne=true}}builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans;if(!spans){for(var i=1;i<styles.length;i+=2)builder.addToken(builder,styles[i],styleToClass(styles[i+1]));return}var allText=line.text,len=allText.length;var pos=0,i=1,text=\"\",style;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,collapsed;for(;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=\"\";collapsed=null;nextChange=Infinity;var foundBookmark=null;for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(sp.from<=pos&&(sp.to==null||sp.to>pos)){if(sp.to!=null&&nextChange>sp.to){nextChange=sp.to;spanEndStyle=\"\"}if(m.className)spanStyle+=\" \"+m.className;if(m.startStyle&&sp.from==pos)spanStartStyle+=\" \"+m.startStyle;if(m.endStyle&&sp.to==nextChange)spanEndStyle+=\" \"+m.endStyle;if(m.collapsed&&(!collapsed||collapsed.marker.width<m.width))collapsed=sp}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from}if(m.type==\"bookmark\"&&sp.from==pos&&m.replacedWith)foundBookmark=m.replacedWith}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len:collapsed.to)-pos,collapsed.from!=null&&collapsed.marker.replacedWith);if(collapsed.to==null)return collapsed.marker.find()}if(foundBookmark&&!collapsed)buildCollapsedSpan(builder,0,foundBookmark)}if(pos>=len)break;var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:\"\")}if(end>=upto){text=text.slice(upto-pos);pos=upto;break}pos=end;spanStartStyle=\"\"}text=styles[i++];style=styleToClass(styles[i++])}}}function updateDoc(doc,change,markedSpans,selAfter,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,\"change\",line,change)}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(from.ch==0&&to.ch==0&&lastText==\"\"){for(var i=0,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));update(lastLine,lastLine.text,lastSpans);if(nlines)doc.remove(from.line,nlines);if(added.length)doc.insert(from.line,added)}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans)}else{for(var added=[],i=1,e=text.length-1;i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));added.push(makeLine(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added)}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines)}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);for(var i=1,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));if(nlines>1)doc.remove(from.line+1,nlines-1);doc.insert(from.line+1,added)}signalLater(doc,\"change\",doc,change);setSelection(doc,selAfter.anchor,selAfter.head,null,true)}function LeafChunk(lines){this.lines=lines;this.parent=null;for(var i=0,e=lines.length,height=0;i<e;++i){lines[i].parent=this;height+=lines[i].height}this.height=height}LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;cleanUpLine(line);signalLater(line,\"delete\")}this.lines.splice(at,n)},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines))},insertInner:function(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;i<e;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;at<e;++at)if(op(this.lines[at]))return true}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0,e=children.length;i<e;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this}this.size=size;this.height=height;this.parent=null}BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null}if((n-=rm)==0)break;at=0}else at-=sz}if(this.size-n<25){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this}},collapse:function(lines){for(var i=0,e=this.children.length;i<e;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){while(child.lines.length>50){var spilled=child.lines.splice(child.lines.length-25,25);var newleaf=new LeafChunk(spilled);child.height-=newleaf.height;this.children.splice(i+1,0,newleaf);newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(this.children.length<=10)return;var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()},iterN:function(at,n,op){for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return true;if((n-=used)==0)break;at=0}else at-=sz}}};var cantEdit_inatomic=1,cantEdit_keymap=2;var nextDocId=0;var Doc=CodeMirror.Doc=function(text,mode,firstLine){if(!(this instanceof Doc))return new Doc(text,mode,firstLine);if(firstLine==null)firstLine=0;BranchChunk.call(this,[new LeafChunk([makeLine(\"\",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=0;this.history=makeHistory();this.frontier=firstLine;var start=Pos(firstLine,0);this.sel={from:start,to:start,head:start,anchor:start,shift:false,extend:false,goalColumn:null};this.id=++nextDocId;this.modeOption=mode;if(typeof text==\"string\")text=splitLines(text);updateDoc(this,{from:start,to:start,text:text},null,{head:start,anchor:start})};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){if(op)this.iterN(from-this.first,to-from,op);else this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){var height=0;for(var i=0,e=lines.length;i<e;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false)return lines;return lines.join(lineSep||\"\\n\")},setValue:function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:splitLines(code),origin:\"setValue\"},{head:top,anchor:top},true)},replaceRange:function(code,from,to,origin){from=clipPos(this,from);to=to?clipPos(this,to):from;replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));if(lineSep===false)return lines;return lines.join(lineSep||\"\\n\")},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},setLine:function(line,text){if(isLine(this,line))replaceRange(this,text,Pos(line,0),clipPos(this,Pos(line)))},removeLine:function(line){if(line)replaceRange(this,\"\",clipPos(this,Pos(line-1)),clipPos(this,Pos(line)));else replaceRange(this,\"\",Pos(0,0),clipPos(this,Pos(1,0)))},getLineHandle:function(line){if(isLine(this,line))return getLine(this,line)},getLineNumber:function(line){return lineNo(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var sel=this.sel,pos;if(start==null||start==\"head\")pos=sel.head;else if(start==\"anchor\")pos=sel.anchor;else if(start==\"end\"||start===false)pos=sel.to;else pos=sel.from;return copyPos(pos)},somethingSelected:function(){return!posEq(this.sel.head,this.sel.anchor)},setCursor:docOperation(function(line,ch,extend){var pos=clipPos(this,typeof line==\"number\"?Pos(line,ch||0):line);if(extend)extendSelection(this,pos);else setSelection(this,pos,pos)}),setSelection:docOperation(function(anchor,head){setSelection(this,clipPos(this,anchor),clipPos(this,head||anchor))}),extendSelection:docOperation(function(from,to){extendSelection(this,clipPos(this,from),to&&clipPos(this,to))}),getSelection:function(lineSep){return this.getRange(this.sel.from,this.sel.to,lineSep)},replaceSelection:function(code,collapse,origin){makeChange(this,{from:this.sel.from,to:this.sel.to,text:splitLines(code),origin:origin},collapse||\"around\")},undo:docOperation(function(){makeChangeFromHistory(this,\"undo\")}),redo:docOperation(function(){makeChangeFromHistory(this,\"redo\")}),setExtending:function(val){this.sel.extend=val},historySize:function(){var hist=this.history;return{undo:hist.done.length,redo:hist.undone.length}},clearHistory:function(){this.history=makeHistory()},markClean:function(){this.history.dirtyCounter=0;this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return this.history.dirtyCounter==0},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=makeHistory();hist.done=histData.done.slice(0);hist.undone=histData.undone.slice(0)},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,\"range\")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft};pos=clipPos(this,pos);return markText(this,pos,pos,realOpts,\"bookmark\")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch))markers.push(span.marker.parent||span.marker)}return markers},getAllMarks:function(){var markers=[];this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)if(sps[i].from!=null)markers.push(sps[i].marker)});return markers},posFromIndex:function(off){var ch,lineNo=this.first;this.iter(function(line){var sz=line.text.length+1;if(sz>off){ch=off;return true}off-=sz;++lineNo});return clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0)return 0;this.iter(this.first,coords.line,function(line){index+=line.text.length+1});return index},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:false,goalColumn:this.sel.goalColumn};if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory())}return doc},linkedDoc:function(options){if(!options)options={};var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from)from=options.from;if(options.to!=null&&options.to<to)to=options.to;var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from);if(options.sharedHist)copy.history=this.history;(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];return copy},unlinkDoc:function(other){if(other instanceof CodeMirror)other=other.doc;if(this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc!=other)continue;this.linked.splice(i,1);other.unlinkDoc(this);break}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},true);other.history=makeHistory();other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate=\"iter insert remove copy getEditor\".split(\" \");for(var prop in Doc.prototype)if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0)CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]);function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip)continue;var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared)continue;f(rel.doc,shared);propagate(rel.doc,doc,shared)}}propagate(doc,null,true)}function attachDoc(cm,doc){if(doc.cm)throw new Error(\"This document is already in use.\");cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);if(!cm.options.lineWrapping)computeMaxLength(cm);cm.options.mode=doc.modeOption;if(keyMap[cm.options.keyMap].disableInput)doc.cantEdit|=cantEdit_keymap;else doc.cantEdit&=~cantEdit_keymap;regChange(cm)}function getLine(chunk,n){n-=chunk.first;while(!chunk.lines){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,function(line){var text=line.text;if(n==end.line)text=text.slice(0,end.ch);if(n==start.line)text=text.slice(start.ch);out.push(text);++n});return out}function getLines(doc,from,to){var out=[];doc.iter(from,to,function(line){out.push(line.text)});return out}function updateLineHeight(line,height){var diff=height-line.height;for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(line.parent==null)return null;var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize()}}return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0,e=chunk.children.length;i<e;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch;n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0,e=chunk.lines.length;i<e;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh}return n+i}function heightAtLine(cm,lineObj){lineObj=visualLine(cm.doc,lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;else h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;else h+=cur.height}}return h}function getOrder(line){var order=line.order;if(order==null)order=line.order=bidiOrdering(line.text);return order}function makeHistory(){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function attachLocalSpans(doc,change,from,to){var existing=change[\"spans_\"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){if(line.markedSpans)(existing||(existing=change[\"spans_\"+doc.id]={}))[n]=line.markedSpans;++n})}function historyChangeFromChange(doc,change){var histChange={from:change.from,to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},true);return histChange}function addToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur=lst(hist.done);if(cur&&(hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)==\"+\"&&doc.cm&&hist.lastTime>time-doc.cm.options.historyEventDelay||change.origin.charAt(0)==\"*\"))){var last=lst(cur.changes);if(posEq(change.from,change.to)&&posEq(change.from,last.to)){last.to=changeEnd(change)}else{cur.changes.push(historyChangeFromChange(doc,change))}cur.anchorAfter=selAfter.anchor;cur.headAfter=selAfter.head}else{cur={changes:[historyChangeFromChange(doc,change)],anchorBefore:doc.sel.anchor,headBefore:doc.sel.head,anchorAfter:selAfter.anchor,headAfter:selAfter.head};hist.done.push(cur);while(hist.done.length>hist.undoDepth)hist.done.shift();if(hist.dirtyCounter<0)hist.dirtyCounter=NaN;else hist.dirtyCounter++}hist.lastTime=time;hist.lastOp=opId;hist.lastOrigin=change.origin}function removeClearedSpans(spans){if(!spans)return null;for(var i=0,out;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out)out=spans.slice(0,i)}else if(out)out.push(spans[i])}return!out?spans:out.length?out:null}function getOldSpans(doc,change){var found=change[\"spans_\"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup){for(var i=0,copy=[];i<events.length;++i){var event=events[i],changes=event.changes,newChanges=[];copy.push({changes:newChanges,anchorBefore:event.anchorBefore,headBefore:event.headBefore,anchorAfter:event.anchorAfter,headAfter:event.headAfter});for(var j=0;j<changes.length;++j){var change=changes[j],m;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup)for(var prop in change)if(m=prop.match(/^spans_(\\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop]}}}}return copy}function rebaseHistSel(pos,from,to,diff){if(to<pos.line){pos.line+=diff}else if(from<pos.line){pos.line=from;pos.ch=0}}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(!sub.copied){cur.from=copyPos(cur.from);cur.to=copyPos(cur.to)}if(to<cur.from.line){cur.from.line+=diff;cur.to.line+=diff}else if(from<=cur.to.line){ok=false;break}}if(!sub.copied){sub.anchorBefore=copyPos(sub.anchorBefore);sub.headBefore=copyPos(sub.headBefore);sub.anchorAfter=copyPos(sub.anchorAfter);\nsub.readAfter=copyPos(sub.headAfter);sub.copied=true}if(!ok){array.splice(0,i+1);i=0}else{rebaseHistSel(sub.anchorBefore);rebaseHistSel(sub.headBefore);rebaseHistSel(sub.anchorAfter);rebaseHistSel(sub.headAfter)}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff)}function stopMethod(){e_stop(this)}function addStop(event){if(!event.stop)event.stop=stopMethod;return event}function e_preventDefault(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false}function e_stopPropagation(e){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true}function e_stop(e){e_preventDefault(e);e_stopPropagation(e)}CodeMirror.e_stop=e_stop;CodeMirror.e_preventDefault=e_preventDefault;CodeMirror.e_stopPropagation=e_stopPropagation;function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;if(b==null){if(e.button&1)b=1;else if(e.button&2)b=3;else if(e.button&4)b=2}if(mac&&e.ctrlKey&&b==1)b=3;return b}function on(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,false);else if(emitter.attachEvent)emitter.attachEvent(\"on\"+type,f);else{var map=emitter._handlers||(emitter._handlers={});var arr=map[type]||(map[type]=[]);arr.push(f)}}function off(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,false);else if(emitter.detachEvent)emitter.detachEvent(\"on\"+type,f);else{var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;for(var i=0;i<arr.length;++i)if(arr[i]==f){arr.splice(i,1);break}}}function signal(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<arr.length;++i)arr[i].apply(null,args)}var delayedCallbacks,delayedCallbackDepth=0;function signalLater(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);if(!delayedCallbacks){++delayedCallbackDepth;delayedCallbacks=[];setTimeout(fireDelayed,0)}function bnd(f){return function(){f.apply(null,args)}}for(var i=0;i<arr.length;++i)delayedCallbacks.push(bnd(arr[i]))}function fireDelayed(){--delayedCallbackDepth;var delayed=delayedCallbacks;delayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function hasHandler(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];return arr&&arr.length>0}CodeMirror.on=on;CodeMirror.off=off;CodeMirror.signal=signal;var scrollerCutOff=30;var Pass=CodeMirror.Pass={toString:function(){return\"CodeMirror.Pass\"}};function Delayed(){this.id=null}Delayed.prototype={set:function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms)}};function countColumn(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\\s\\u00a0]/);if(end==-1)end=string.length}for(var i=startIndex||0,n=startValue||0;i<end;++i){if(string.charAt(i)==\"\t\")n+=tabSize-n%tabSize;else++n}return n}CodeMirror.countColumn=countColumn;var spaceStrs=[\"\"];function spaceStr(n){while(spaceStrs.length<=n)spaceStrs.push(lst(spaceStrs)+\" \");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function selectInput(node){if(ios){node.selectionStart=0;node.selectionEnd=node.value.length}else node.select()}function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;i<e;++i)if(collection[i]==elt)return i;return-1}function createObj(base,props){function Obj(){}Obj.prototype=base;var inst=new Obj;if(props)copyObj(props,inst);return inst}function copyObj(obj,target){if(!target)target={};for(var prop in obj)if(obj.hasOwnProperty(prop))target[prop]=obj[prop];return target}function emptyArray(size){for(var a=[],i=0;i<size;++i)a.push(undefined);return a}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}var nonASCIISingleCaseWordChar=/[\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;function isWordChar(ch){return/\\w/.test(ch)||ch>\"\"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return false;return true}var isExtendingChar=/[\\u0300-\\u036F\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1-\\u05C2\\u05C4-\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7-\\u06E8\\u06EA-\\u06ED\\uA66F\\uA670-\\uA672\\uA674-\\uA67D\\uA69F\\udc00-\\udfff]/;function elt(tag,content,className,style){var e=document.createElement(tag);if(className)e.className=className;if(style)e.style.cssText=style;if(typeof content==\"string\")setTextContent(e,content);else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function setTextContent(e,str){if(ie_lt9){e.innerHTML=\"\";e.appendChild(document.createTextNode(str))}else e.textContent=str}function getRect(node){return node.getBoundingClientRect()}CodeMirror.replaceGetRect=function(f){getRect=f};var dragAndDrop=function(){if(ie_lt9)return false;var div=elt(\"div\");return\"draggable\"in div||\"dragDrop\"in div}();function spanAffectsWrapping(){return false}if(gecko)spanAffectsWrapping=function(str,i){return str.charCodeAt(i-1)==36&&str.charCodeAt(i)==39};else if(safari&&!/Version\\/([6-9]|\\d\\d)\\b/.test(navigator.userAgent))spanAffectsWrapping=function(str,i){return/\\-[^ \\-?]|\\?[^ !\\'\\\"\\),.\\-\\/:;\\?\\]\\}]/.test(str.slice(i-1,i+1))};else if(webkit)spanAffectsWrapping=function(str,i){if(i>1&&str.charCodeAt(i-1)==45&&/\\w/.test(str.charAt(i-2))&&/[^\\-?\\.]/.test(str.charAt(i)))return true;return/[~!#%&*)=+}\\]|\\\"\\.>,:;][({[<]|-[^\\-?\\.\\u2010-\\u201f\\u2026]|\\?[\\w~`@#$%\\^&*(_=+{[|><]|[\\w~`@#$%\\^&*(_=+{[><]/.test(str.slice(i-1,i+1))};var knownScrollbarWidth;function scrollbarWidth(measure){if(knownScrollbarWidth!=null)return knownScrollbarWidth;var test=elt(\"div\",null,null,\"width: 50px; height: 50px; overflow-x: scroll\");removeChildrenAndAdd(measure,test);if(test.offsetWidth)knownScrollbarWidth=test.offsetHeight-test.clientHeight;return knownScrollbarWidth||0}var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt(\"span\",\"\");removeChildrenAndAdd(measure,elt(\"span\",[test,document.createTextNode(\"x\")]));if(measure.firstChild.offsetHeight!=0)zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!ie_lt8}if(zwspSupported)return elt(\"span\",\"\");else return elt(\"span\",\"\",null,\"display: inline-block; width: 1px; margin-right: -1px\")}var splitLines=\"\\n\\nb\".split(/\\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf(\"\\n\",pos);if(nl==-1)nl=string.length;var line=string.slice(pos,string.charAt(nl-1)==\"\\r\"?nl-1:nl);var rt=line.indexOf(\"\\r\");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1}else{result.push(line);pos=nl+1}}return result}:function(string){return string.split(/\\r\\n?|\\n/)};CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return false}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}if(!range||range.parentElement()!=te)return false;return range.compareEndPoints(\"StartToEnd\",range)!=0};var hasCopyEvent=function(){var e=elt(\"div\");if(\"oncopy\"in e)return true;e.setAttribute(\"oncopy\",\"return;\");return typeof e.oncopy==\"function\"}();var keyNames={3:\"Enter\",8:\"Backspace\",9:\"Tab\",13:\"Enter\",16:\"Shift\",17:\"Ctrl\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Esc\",32:\"Space\",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"Left\",38:\"Up\",39:\"Right\",40:\"Down\",44:\"PrintScrn\",45:\"Insert\",46:\"Delete\",59:\";\",91:\"Mod\",92:\"Mod\",93:\"Mod\",109:\"-\",107:\"=\",127:\"Delete\",186:\";\",187:\"=\",188:\",\",189:\"-\",190:\".\",191:\"/\",192:\"`\",219:\"[\",220:\"\\\\\",221:\"]\",222:\"'\",63276:\"PageUp\",63277:\"PageDown\",63275:\"End\",63273:\"Home\",63234:\"Left\",63232:\"Up\",63235:\"Right\",63233:\"Down\",63302:\"Insert\",63272:\"Delete\"};CodeMirror.keyNames=keyNames;(function(){for(var i=0;i<10;i++)keyNames[i+48]=String(i);for(var i=65;i<=90;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;i<=12;i++)keyNames[i+111]=keyNames[i+63235]=\"F\"+i})();function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,\"ltr\");for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from)f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?\"rtl\":\"ltr\")}}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);if(!order)return line.text.length;return bidiRight(lst(order))}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(cm.doc,line);if(visual!=line)lineN=lineNo(visual);var order=getOrder(visual);var ch=!order?0:order[0].level%2?lineRight(visual):lineLeft(visual);return Pos(lineN,ch)}function lineEnd(cm,lineN){var merged,line;while(merged=collapsedSpanAtEnd(line=getLine(cm.doc,lineN)))lineN=merged.find().to.line;var order=getOrder(line);var ch=!order?line.text.length:order[0].level%2?lineLeft(line):lineRight(line);return Pos(lineN,ch)}function compareBidiLevel(order,a,b){var linedir=order[0].level;if(a==linedir)return true;if(b==linedir)return false;return a<b}var bidiOther;function getBidiPartAt(order,pos){for(var i=0,found;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos){bidiOther=null;return i}if(cur.from==pos||cur.to==pos){if(found==null){found=i}else if(compareBidiLevel(order,cur.level,order[found].level)){bidiOther=found;return i}else{bidiOther=i;return found}}}bidiOther=null;return found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(pos>0&&isExtendingChar.test(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);var pos=getBidiPartAt(bidi,start),part=bidi[pos];var target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);for(;;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to){if(getBidiPartAt(bidi,target)==pos)return target;part=bidi[pos+=dir];return dir>0==part.level%2?part.to:part.from}else{part=bidi[pos+=dir];if(!part)return null;if(dir>0==part.level%2)target=moveInLine(line,part.to,-1,byUnit);else target=moveInLine(line,part.from,1,byUnit)}}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)while(target>0&&isExtendingChar.test(line.text.charAt(target)))target+=dir;return target<0||target>line.text.length?null:target}var bidiOrdering=function(){var lowTypes=\"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL\";var arabicTypes=\"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr\";function charType(code){if(code<=255)return lowTypes.charAt(code);else if(1424<=code&&code<=1524)return\"R\";else if(1536<=code&&code<=1791)return arabicTypes.charAt(code-1536);else if(1792<=code&&code<=2220)return\"r\";else return\"L\"}var bidiRE=/[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;var outerType=\"L\";return function(str){if(!bidiRE.test(str))return false;var len=str.length,types=[];for(var i=0,type;i<len;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;i<len;++i){var type=types[i];if(type==\"m\")types[i]=prev;else prev=type}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(type==\"1\"&&cur==\"r\")types[i]=\"n\";else if(isStrong.test(type)){cur=type;if(type==\"r\")types[i]=\"R\"}}for(var i=1,prev=types[0];i<len-1;++i){var type=types[i];if(type==\"+\"&&prev==\"1\"&&types[i+1]==\"1\")types[i]=\"1\";else if(type==\",\"&&prev==types[i+1]&&(prev==\"1\"||prev==\"n\"))types[i]=prev;prev=type}for(var i=0;i<len;++i){var type=types[i];if(type==\",\")types[i]=\"N\";else if(type==\"%\"){for(var end=i+1;end<len&&types[end]==\"%\";++end){}var replace=i&&types[i-1]==\"!\"||end<len-1&&types[end]==\"1\"?\"1\":\"N\";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(cur==\"L\"&&type==\"1\")types[i]=\"L\";else if(isStrong.test(type))cur=type}for(var i=0;i<len;++i){if(isNeutral.test(types[i])){for(var end=i+1;end<len&&isNeutral.test(types[end]);++end){}var before=(i?types[i-1]:outerType)==\"L\";var after=(end<len-1?types[end]:outerType)==\"L\";var replace=before||after?\"L\":\"R\";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}var order=[],m;for(var i=0;i<len;){if(countsAsLeft.test(types[i])){var start=i;for(++i;i<len&&countsAsLeft.test(types[i]);++i){}order.push({from:start,to:i,level:0})}else{var pos=i,at=order.length;for(++i;i<len&&types[i]!=\"L\";++i){}for(var j=pos;j<i;){if(countsAsNum.test(types[j])){if(pos<j)order.splice(at,0,{from:pos,to:j,level:1});var nstart=j;for(++j;j<i&&countsAsNum.test(types[j]);++j){}order.splice(at,0,{from:nstart,to:j,level:2});pos=j}else++j}if(pos<i)order.splice(at,0,{from:pos,to:i,level:1})}}if(order[0].level==1&&(m=str.match(/^\\s+/))){order[0].from=m[0].length;order.unshift({from:0,to:m[0].length,level:0})}if(lst(order).level==1&&(m=str.match(/\\s+$/))){lst(order).to-=m[0].length;order.push({from:len-m[0].length,to:len,level:0})}if(order[0].level!=lst(order).level)order.push({from:len,to:len,level:order[0].level});return order}}();CodeMirror.version=\"3.13 +\";return CodeMirror}();var Lawnchair=function(options,callback){if(!(this instanceof Lawnchair))return new Lawnchair(options,callback);if(!JSON)throw\"JSON unavailable! Include http://www.json.org/json2.js to fix.\";if(arguments.length<=2){callback=typeof arguments[0]===\"function\"?arguments[0]:arguments[1];options=typeof arguments[0]===\"function\"?{}:arguments[0]||{}}else{throw\"Incorrect # of ctor args!\"}this.record=options.record||\"record\";this.name=options.name||\"records\";var adapter;if(options.adapter){if(typeof options.adapter===\"string\"){options.adapter=[options.adapter]}for(var j=0,k=options.adapter.length;j<k;j++){for(var i=Lawnchair.adapters.length-1;i>=0;i--){if(Lawnchair.adapters[i].adapter===options.adapter[j]){adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:undefined;if(adapter)break}}if(adapter)break}}else{for(var i=0,l=Lawnchair.adapters.length;i<l;i++){adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:undefined;if(adapter)break}}if(!adapter)throw\"No valid adapter.\";for(var j in adapter)this[j]=adapter[j];for(var i=0,l=Lawnchair.plugins.length;i<l;i++)Lawnchair.plugins[i].call(this);this.init(options,callback)};Lawnchair.adapters=[];Lawnchair.adapter=function(id,obj){obj[\"adapter\"]=id;var implementing=\"adapter valid init keys save batch get exists all remove nuke\".split(\" \"),indexOf=this.prototype.indexOf;for(var i in obj){if(indexOf(implementing,i)===-1)throw\"Invalid adapter! Nonstandard method: \"+i}Lawnchair.adapters.splice(0,0,obj)};Lawnchair.plugins=[];Lawnchair.plugin=function(obj){for(var i in obj)i===\"init\"?Lawnchair.plugins.push(obj[i]):this.prototype[i]=obj[i]};Lawnchair.prototype={isArray:Array.isArray||function(o){return Object.prototype.toString.call(o)===\"[object Array]\"},indexOf:function(ary,item,i,l){if(ary.indexOf)return ary.indexOf(item);for(i=0,l=ary.length;i<l;i++)if(ary[i]===item)return i;return-1},lambda:function(callback){return this.fn(this.record,callback)},fn:function(name,callback){return typeof callback==\"string\"?new Function(name,callback):callback},uuid:function(){var S4=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4()},each:function(callback){var cb=this.lambda(callback);if(this.__results){for(var i=0,l=this.__results.length;i<l;i++)cb.call(this,this.__results[i],i)}else{this.all(function(r){for(var i=0,l=r.length;i<l;i++)cb.call(this,r[i],i)})}return this}};Lawnchair.adapter(\"window-name\",function(){if(typeof window===\"undefined\"){window={top:{}}}var data={};try{data=JSON.parse(window.top.name)}catch(e){}return{valid:function(){return typeof window.top.name!=\"undefined\"},init:function(options,callback){data[this.name]=data[this.name]||{index:[],store:{}};this.index=data[this.name].index;this.store=data[this.name].store;this.fn(this.name,callback).call(this,this);return this},keys:function(callback){this.fn(\"keys\",callback).call(this,this.index);return this},save:function(obj,cb){var key=obj.key||this.uuid();this.exists(key,function(exists){if(!exists){if(obj.key)delete obj.key;this.index.push(key)}this.store[key]=obj;try{window.top.name=JSON.stringify(data)}catch(e){if(!exists){this.index.pop();delete this.store[key]}throw e}if(cb){obj.key=key;this.lambda(cb).call(this,obj)}});return this},batch:function(objs,cb){var r=[];for(var i=0,l=objs.length;i<l;i++){this.save(objs[i],function(record){r.push(record)})}if(cb)this.lambda(cb).call(this,r);return this},get:function(keyOrArray,cb){var r;if(this.isArray(keyOrArray)){r=[];for(var i=0,l=keyOrArray.length;i<l;i++){r.push(this.store[keyOrArray[i]])}}else{r=this.store[keyOrArray];if(r)r.key=keyOrArray}if(cb)this.lambda(cb).call(this,r);return this},exists:function(key,cb){this.lambda(cb).call(this,!!this.store[key]);return this},all:function(cb){var r=[];for(var i=0,l=this.index.length;i<l;i++){var obj=this.store[this.index[i]];obj.key=this.index[i];r.push(obj)}this.fn(this.name,cb).call(this,r);return this},remove:function(keyOrArray,cb){var del=this.isArray(keyOrArray)?keyOrArray:[keyOrArray];for(var i=0,l=del.length;i<l;i++){var key=del[i].key?del[i].key:del[i];var where=this.indexOf(this.index,key);if(where<0)continue;delete this.store[key];this.index.splice(where,1)}window.top.name=JSON.stringify(data);if(cb)this.lambda(cb).call(this);return this},nuke:function(cb){this.store=data[this.name].store={};this.index=data[this.name].index=[];window.top.name=JSON.stringify(data);if(cb)this.lambda(cb).call(this);return this}}}());Lawnchair.adapter(\"dom\",function(){var storage=window.localStorage;var indexer=function(name){return{key:name+\"._index_\",all:function(){var a=storage.getItem(JSON.stringify(this.key));if(a){a=JSON.parse(a)}if(a===null)storage.setItem(JSON.stringify(this.key),JSON.stringify([]));return JSON.parse(storage.getItem(JSON.stringify(this.key)))},add:function(key){var a=this.all();a.push(key);storage.setItem(JSON.stringify(this.key),JSON.stringify(a))},del:function(key){var a=this.all(),r=[];for(var i=0,l=a.length;i<l;i++){if(a[i]!=key)r.push(a[i])}storage.setItem(JSON.stringify(this.key),JSON.stringify(r))},find:function(key){var a=this.all();for(var i=0,l=a.length;i<l;i++){if(key===a[i])return i}return false}}};return{valid:function(){return!!storage&&function(){var success=true;var value=Math.random();try{storage.setItem(value,value)}catch(e){success=false}storage.removeItem(value);return success}()},init:function(options,callback){this.indexer=indexer(this.name);if(callback)this.fn(this.name,callback).call(this,this)},save:function(obj,callback){var key=obj.key?this.name+\".\"+obj.key:this.name+\".\"+this.uuid();delete obj.key;storage.setItem(key,JSON.stringify(obj));if(this.indexer.find(key)===false)this.indexer.add(key);obj.key=key.slice(this.name.length+1);if(callback){this.lambda(callback).call(this,obj)}return this},batch:function(ary,callback){var saved=[];for(var i=0,l=ary.length;i<l;i++){this.save(ary[i],function(r){saved.push(r)})}if(callback)this.lambda(callback).call(this,saved);return this},keys:function(callback){if(callback){var name=this.name;var indices=this.indexer.all();var keys=[];if(Array.prototype.map){keys=indices.map(function(r){return r.replace(name+\".\",\"\")})}else{for(var key in indices){keys.push(key.replace(name+\".\",\"\"))}}this.fn(\"keys\",callback).call(this,keys)}return this},get:function(key,callback){if(this.isArray(key)){var r=[];for(var i=0,l=key.length;i<l;i++){var k=this.name+\".\"+key[i];var obj=storage.getItem(k);if(obj){obj=JSON.parse(obj);obj.key=key[i]}r.push(obj)}if(callback)this.lambda(callback).call(this,r)}else{var k=this.name+\".\"+key;var obj=storage.getItem(k);if(obj){obj=JSON.parse(obj);obj.key=key}if(callback)this.lambda(callback).call(this,obj)}return this},exists:function(key,cb){var exists=this.indexer.find(this.name+\".\"+key)===false?false:true;this.lambda(cb).call(this,exists);return this},all:function(callback){var idx=this.indexer.all(),r=[],o,k;for(var i=0,l=idx.length;i<l;i++){k=idx[i];o=JSON.parse(storage.getItem(k));o.key=k.replace(this.name+\".\",\"\");r.push(o)}if(callback)this.fn(this.name,callback).call(this,r);return this},remove:function(keyOrArray,callback){var self=this;if(this.isArray(keyOrArray)){var i,done=keyOrArray.length;var removeOne=function(i){self.remove(keyOrArray[i],function(){if(--done>0){return}if(callback){self.lambda(callback).call(self)}})};for(i=0;i<keyOrArray.length;i++)removeOne(i);return this}var key=this.name+\".\"+(keyOrArray.key?keyOrArray.key:keyOrArray);this.indexer.del(key);storage.removeItem(key);if(callback)this.lambda(callback).call(this);return this},nuke:function(callback){this.all(function(r){for(var i=0,l=r.length;i<l;i++){this.remove(r[i])}if(callback)this.lambda(callback).call(this)});return this}}}());(function(){var ie_lt8=/MSIE \\d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var Pos=CodeMirror.Pos;var matching={\"(\":\")>\",\")\":\"(<\",\"[\":\"]>\",\"]\":\"[<\",\"{\":\"}>\",\"}\":\"{<\"};function findMatchingBracket(cm){var maxScanLen=cm.state._matchBrackets.maxScanLineLength||1e4;var cur=cm.getCursor(),line=cm.getLineHandle(cur.line),pos=cur.ch-1;var match=pos>=0&&matching[line.text.charAt(pos)]||matching[line.text.charAt(++pos)];if(!match)return null;var forward=match.charAt(1)==\">\",d=forward?1:-1;var style=cm.getTokenAt(Pos(cur.line,pos+1)).type;var stack=[line.text.charAt(pos)],re=/[(){}[\\]]/;function scan(line,lineNo,start){if(!line.text)return;var pos=forward?0:line.text.length-1,end=forward?line.text.length:-1;if(line.text.length>maxScanLen)return null;var checkTokenStyles=line.text.length<1e3;if(start!=null)pos=start+d;for(;pos!=end;pos+=d){var ch=line.text.charAt(pos);if(re.test(ch)&&(!checkTokenStyles||cm.getTokenAt(Pos(lineNo,pos+1)).type==style)){var match=matching[ch];if(match.charAt(1)==\">\"==forward)stack.push(ch);else if(stack.pop()!=match.charAt(0))return{pos:pos,match:false};else if(!stack.length)return{pos:pos,match:true}}}}for(var i=cur.line,found,e=forward?Math.min(i+100,cm.lineCount()):Math.max(-1,i-100);i!=e;i+=d){if(i==cur.line)found=scan(line,i,pos);else found=scan(cm.getLineHandle(i),i);if(found)break}return{from:Pos(cur.line,pos),to:found&&Pos(i,found.pos),match:found&&found.match}}function matchBrackets(cm,autoclear){var maxHighlightLen=cm.state._matchBrackets.maxHighlightLineLength||1e3;var found=findMatchingBracket(cm);if(!found||cm.getLine(found.from.line).length>maxHighlightLen||found.to&&cm.getLine(found.to.line).length>maxHighlightLen)return;var style=found.match?\"CodeMirror-matchingbracket\":\"CodeMirror-nonmatchingbracket\";var one=cm.markText(found.from,Pos(found.from.line,found.from.ch+1),{className:style});var two=found.to&&cm.markText(found.to,Pos(found.to.line,found.to.ch+1),{className:style});if(ie_lt8&&cm.state.focused)cm.display.input.focus();var clear=function(){cm.operation(function(){one.clear();two&&two.clear()})};if(autoclear)setTimeout(clear,800);else return clear}var currentlyHighlighted=null;function doMatchBrackets(cm){cm.operation(function(){if(currentlyHighlighted){currentlyHighlighted();currentlyHighlighted=null}if(!cm.somethingSelected())currentlyHighlighted=matchBrackets(cm,false)})}CodeMirror.defineOption(\"matchBrackets\",false,function(cm,val,old){if(old&&old!=CodeMirror.Init)cm.off(\"cursorActivity\",doMatchBrackets);if(val){cm.state._matchBrackets=typeof val==\"object\"?val:{};cm.on(\"cursorActivity\",doMatchBrackets)}});CodeMirror.defineExtension(\"matchBrackets\",function(){matchBrackets(this,true)});CodeMirror.defineExtension(\"findMatchingBracket\",function(){return findMatchingBracket(this)})})();(function($){if(typeof $.fn.each2==\"undefined\"){$.fn.extend({each2:function(c){var j=$([0]),i=-1,l=this.length;while(++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==false);return this}})}})(jQuery);(function($,undefined){\"use strict\";if(window.Select2!==undefined){return}var KEY,AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer;KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){k=k.which?k.which:k;switch(k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return true}return false},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return true}if(e.metaKey)return true;return false},isFunctionKey:function(k){k=k.which?k.which:k;return k>=112&&k<=123}};nextUid=function(){var counter=1;return function(){return counter++}}();function indexOf(value,array){var i=0,l=array.length,v;if(typeof value===\"undefined\"){return-1}if(value.constructor===String){for(;i<l;i=i+1)if(value.localeCompare(array[i])===0)return i}else{for(;i<l;i=i+1){v=array[i];if(v.constructor===String){if(v.localeCompare(value)===0)return i}else{if(v===value)return i}}}return-1}function equal(a,b){if(a===b)return true;if(a===undefined||b===undefined)return false;if(a===null||b===null)return false;if(a.constructor===String)return a.localeCompare(b)===0;if(b.constructor===String)return b.localeCompare(a)===0;return false}function splitVal(string,separator){var val,i,l;if(string===null||string.length<1)return[];val=string.split(separator);for(i=0,l=val.length;i<l;i=i+1)val[i]=$.trim(val[i]);return val}function getSideBorderPadding(element){return element.outerWidth()-element.width()}function installKeyUpChangeEvent(element){var key=\"keyup-change-value\";element.bind(\"keydown\",function(){if($.data(element,key)===undefined){$.data(element,key,element.val())}});element.bind(\"keyup\",function(){var val=$.data(element,key);if(val!==undefined&&element.val()!==val){$.removeData(element,key);element.trigger(\"keyup-change\")}})}$(document).delegate(\"body\",\"mousemove\",function(e){$.data(document,\"select2-lastpos\",{x:e.pageX,y:e.pageY})});function installFilteredMouseMove(element){element.bind(\"mousemove\",function(e){var lastpos=$.data(document,\"select2-lastpos\");if(lastpos===undefined||lastpos.x!==e.pageX||lastpos.y!==e.pageY){$(e.target).trigger(\"mousemove-filtered\",e)}})}function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(ctx,args)},quietMillis)}}function thunk(formula){var evaluated=false,value;return function(){if(evaluated===false){value=formula();evaluated=true}return value}}function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger(\"scroll-debounced\",e)});element.bind(\"scroll\",function(e){if(indexOf(e.target,element.get())>=0)notify(e)})}function killEvent(event){event.preventDefault();event.stopPropagation()}function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$(\"<div></div>\").css({position:\"absolute\",left:\"-10000px\",top:\"-10000px\",display:\"none\",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:\"nowrap\"});$(\"body\").append(sizer)}sizer.text(e.val());return sizer.width()}function markMatch(text,term,markup){var match=text.toUpperCase().indexOf(term.toUpperCase()),tl=term.length;if(match<0){markup.push(text);return}markup.push(text.substring(0,match));markup.push(\"<span class='select2-match'>\");markup.push(text.substring(match,match+tl));markup.push(\"</span>\");markup.push(text.substring(match+tl,text.length))}function ajax(options){var timeout,requestSequence=0,handler=null,quietMillis=options.quietMillis||100;return function(query){window.clearTimeout(timeout);timeout=window.setTimeout(function(){requestSequence+=1;var requestNumber=requestSequence,data=options.data,transport=options.transport||$.ajax,traditional=options.traditional||false,type=options.type||\"GET\";data=data.call(this,query.term,query.page,query.context);if(null!==handler){handler.abort()}handler=transport.call(null,{url:options.url,dataType:options.dataType,data:data,type:type,traditional:traditional,success:function(data){if(requestNumber<requestSequence){return}var results=options.results(data,query.page);query.callback(results)}})},quietMillis)}}function local(options){var data=options,dataText,text=function(item){return\"\"+item.text};if(!$.isArray(data)){text=data.text;if(!$.isFunction(text)){dataText=data.text;text=function(item){return item[dataText]}}data=data.results}return function(query){var t=query.term,filtered={results:[]},process;if(t===\"\"){query.callback({results:data});return}process=function(datum,collection){var group,attr;datum=datum[0];if(datum.children){group={};for(attr in datum){if(datum.hasOwnProperty(attr))group[attr]=datum[attr]}group.children=[];$(datum.children).each2(function(i,childDatum){process(childDatum,group.children)});if(group.children.length){collection.push(group)}}else{if(query.matcher(t,text(datum))){collection.push(datum)}}};$(data).each2(function(i,datum){process(datum,filtered.results)});query.callback(filtered)}}function tags(data){if($.isFunction(data)){return data}return function(query){var t=query.term,filtered={results:[]};$(data).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;if(t===\"\"||query.matcher(t,text)){filtered.results.push(isObject?this:{id:this,text:this})}});query.callback(filtered)}}function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return true;if(!formatter)return false;throw new Error(\"formatterName must be a function or a falsy value\")}function evaluate(val){return $.isFunction(val)?val():val}function countResults(results){var count=0;$.each(results,function(i,item){if(item.children){count+=countResults(item.children)}else{count++}});return count}function defaultTokenizer(input,selection,selectCallback,opts){var original=input,dupe=false,token,index,i,l,separator;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;while(true){index=-1;for(i=0,l=opts.tokenSeparators.length;i<l;i++){separator=opts.tokenSeparators[i];index=input.indexOf(separator);if(index>=0)break}if(index<0)break;token=input.substring(0,index);input=input.substring(index+separator.length);if(token.length>0){token=opts.createSearchChoice(token,selection);if(token!==undefined&&token!==null&&opts.id(token)!==undefined&&opts.id(token)!==null){dupe=false;for(i=0,l=selection.length;i<l;i++){if(equal(opts.id(token),opts.id(selection[i]))){dupe=true;break}}if(!dupe)selectCallback(token)}}}if(original.localeCompare(input)!=0)return input}$(document).ready(function(){$(document).delegate(\"body\",\"mousedown touchend\",function(e){var target=$(e.target).closest(\"div.select2-container\").get(0),attr;if(target){$(document).find(\"div.select2-container-active\").each(function(){if(this!==target)$(this).data(\"select2\").blur()})}else{target=$(e.target).closest(\"div.select2-drop\").get(0);$(document).find(\"div.select2-drop-active\").each(function(){if(this!==target)$(this).data(\"select2\").blur()})}target=$(e.target);attr=target.attr(\"for\");if(\"LABEL\"===e.target.tagName&&attr&&attr.length>0){target=$(\"#\"+attr);\ntarget=target.data(\"select2\");if(target!==undefined){target.focus();e.preventDefault()}}})});function clazz(SuperClass,methods){var constructor=function(){};constructor.prototype=new SuperClass;constructor.prototype.constructor=constructor;constructor.prototype.parent=SuperClass.prototype;constructor.prototype=$.extend(constructor.prototype,methods);return constructor}AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments)}},init:function(opts){var results,search,resultsSelector=\".select2-results\";this.opts=opts=this.prepareOpts(opts);this.id=opts.id;if(opts.element.data(\"select2\")!==undefined&&opts.element.data(\"select2\")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId=\"s2id_\"+(opts.element.attr(\"id\")||\"autogen\"+nextUid());this.containerSelector=\"#\"+this.containerId.replace(/([;&,\\.\\+\\*\\~':\"\\!\\^#$%@\\[\\]\\(\\)=>\\|])/g,\"\\\\$1\");this.container.attr(\"id\",this.containerId);this.body=thunk(function(){return opts.element.closest(\"body\")});if(opts.element.attr(\"class\")!==undefined){this.container.addClass(opts.element.attr(\"class\").replace(/validate\\[[\\S ]+] ?/,\"\"))}this.container.css(evaluate(opts.containerCss));this.container.addClass(evaluate(opts.containerCssClass));this.opts.element.data(\"select2\",this).hide().before(this.container);this.container.data(\"select2\",this);this.dropdown=this.container.find(\".select2-drop\");this.dropdown.addClass(evaluate(opts.dropdownCssClass));this.dropdown.data(\"select2\",this);this.results=results=this.container.find(resultsSelector);this.search=search=this.container.find(\"input.select2-input\");search.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();installFilteredMouseMove(this.results);this.dropdown.delegate(resultsSelector,\"mousemove-filtered\",this.bind(this.highlightUnderEvent));installDebouncedScroll(80,this.results);this.dropdown.delegate(resultsSelector,\"scroll-debounced\",this.bind(this.loadMoreIfNeeded));if($.fn.mousewheel){results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop(),height;if(deltaY>0&&top-deltaY<=0){results.scrollTop(0);killEvent(e)}else if(deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()){results.scrollTop(results.get(0).scrollHeight-results.height());killEvent(e)}})}installKeyUpChangeEvent(search);search.bind(\"keyup-change\",this.bind(this.updateResults));search.bind(\"focus\",function(){search.addClass(\"select2-focused\");if(search.val()===\" \")search.val(\"\")});search.bind(\"blur\",function(){search.removeClass(\"select2-focused\")});this.dropdown.delegate(resultsSelector,\"mouseup\",this.bind(function(e){if($(e.target).closest(\".select2-result-selectable:not(.select2-disabled)\").length>0){this.highlightUnderEvent(e);this.selectHighlighted(e)}else{this.focusSearch()}killEvent(e)}));this.dropdown.bind(\"click mouseup mousedown\",function(e){e.stopPropagation()});if($.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(opts.element.is(\":disabled\")||opts.element.is(\"[readonly='readonly']\"))this.disable()},destroy:function(){var select2=this.opts.element.data(\"select2\");if(select2!==undefined){select2.container.remove();select2.dropdown.remove();select2.opts.element.removeData(\"select2\").unbind(\".select2\").show()}},prepareOpts:function(opts){var element,select,idKey,ajaxUrl;element=opts.element;if(element.get(0).tagName.toLowerCase()===\"select\"){this.select=select=opts.element}if(select){$.each([\"id\",\"multiple\",\"ajax\",\"query\",\"createSearchChoice\",\"initSelection\",\"data\",\"tags\"],function(){if(this in opts){throw new Error(\"Option '\"+this+\"' is not allowed for Select2 when attached to a <select> element.\")}})}opts=$.extend({},{populateResults:function(container,results,query){var populate,data,result,children,id=this.opts.id,self=this;populate=function(results,container,depth){var i,l,result,selectable,compound,node,label,innerContainer,formatted;for(i=0,l=results.length;i<l;i=i+1){result=results[i];selectable=id(result)!==undefined;compound=result.children&&result.children.length>0;node=$(\"<li></li>\");node.addClass(\"select2-results-dept-\"+depth);node.addClass(\"select2-result\");node.addClass(selectable?\"select2-result-selectable\":\"select2-result-unselectable\");if(compound){node.addClass(\"select2-result-with-children\")}node.addClass(self.opts.formatResultCssClass(result));label=$(\"<div></div>\");label.addClass(\"select2-result-label\");formatted=opts.formatResult(result,label,query);if(formatted!==undefined){label.html(self.opts.escapeMarkup(formatted))}node.append(label);if(compound){innerContainer=$(\"<ul></ul>\");innerContainer.addClass(\"select2-result-sub\");populate(result.children,innerContainer,depth+1);node.append(innerContainer)}node.data(\"select2-data\",result);container.append(node)}};populate(results,container,0)}},$.fn.select2.defaults,opts);if(typeof opts.id!==\"function\"){idKey=opts.id;opts.id=function(e){return e[idKey]}}if(select){opts.query=this.bind(function(query){var data={results:[],more:false},term=query.term,children,firstChild,process;process=function(element,collection){var group;if(element.is(\"option\")){if(query.matcher(term,element.text(),element)){collection.push({id:element.attr(\"value\"),text:element.text(),element:element.get(),css:element.attr(\"class\")})}}else if(element.is(\"optgroup\")){group={text:element.attr(\"label\"),children:[],element:element.get(),css:element.attr(\"class\")};element.children().each2(function(i,elm){process(elm,group.children)});if(group.children.length>0){collection.push(group)}}};children=element.children();if(this.getPlaceholder()!==undefined&&children.length>0){firstChild=children[0];if($(firstChild).text()===\"\"){children=children.not(firstChild)}}children.each2(function(i,elm){process(elm,data.results)});query.callback(data)});opts.id=function(e){return e.id};opts.formatResultCssClass=function(data){return data.css}}else{if(!(\"query\"in opts)){if(\"ajax\"in opts){ajaxUrl=opts.element.data(\"ajax-url\");if(ajaxUrl&&ajaxUrl.length>0){opts.ajax.url=ajaxUrl}opts.query=ajax(opts.ajax)}else if(\"data\"in opts){opts.query=local(opts.data)}else if(\"tags\"in opts){opts.query=tags(opts.tags);opts.createSearchChoice=function(term){return{id:term,text:term}};opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator)).each(function(){var id=this,text=this,tags=opts.tags;if($.isFunction(tags))tags=tags();$(tags).each(function(){if(equal(this.id,id)){text=this.text;return false}});data.push({id:id,text:text})});callback(data)}}}}if(typeof opts.query!==\"function\"){throw\"query function not defined for Select2 \"+opts.element.attr(\"id\")}return opts},monitorSource:function(){this.opts.element.bind(\"change.select2\",this.bind(function(e){if(this.opts.element.data(\"select2-change-triggered\")!==true){this.initSelection()}}))},triggerChange:function(details){details=details||{};details=$.extend({},details,{type:\"change\",val:this.val()});this.opts.element.data(\"select2-change-triggered\",true);this.opts.element.trigger(details);this.opts.element.data(\"select2-change-triggered\",false);this.opts.element.click();if(this.opts.blurOnChange)this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass(\"select2-container-disabled\")},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass(\"select2-container-disabled\")},opened:function(){return this.container.hasClass(\"select2-dropdown-open\")},positionDropdown:function(){var offset=this.container.offset(),height=this.container.outerHeight(),width=this.container.outerWidth(),dropHeight=this.dropdown.outerHeight(),viewportBottom=$(window).scrollTop()+document.documentElement.clientHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=offset.top-dropHeight>=this.body().scrollTop(),aboveNow=this.dropdown.hasClass(\"select2-drop-above\"),bodyOffset,above,css;if(this.body().css(\"position\")!==\"static\"){bodyOffset=this.body().offset();dropTop-=bodyOffset.top;dropLeft-=bodyOffset.left}if(aboveNow){above=true;if(!enoughRoomAbove&&enoughRoomBelow)above=false}else{above=false;if(!enoughRoomBelow&&enoughRoomAbove)above=true}if(above){dropTop=offset.top-dropHeight;this.container.addClass(\"select2-drop-above\");this.dropdown.addClass(\"select2-drop-above\")}else{this.container.removeClass(\"select2-drop-above\");this.dropdown.removeClass(\"select2-drop-above\")}css=$.extend({top:dropTop,left:dropLeft,width:width},evaluate(this.opts.dropdownCss));this.dropdown.css(css)},shouldOpen:function(){var event;if(this.opened())return false;event=$.Event(\"open\");this.opts.element.trigger(event);return!event.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass(\"select2-drop-above\");this.dropdown.removeClass(\"select2-drop-above\")},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var cid=this.containerId,selector=this.containerSelector,scroll=\"scroll.\"+cid,resize=\"resize.\"+cid;this.container.parents().each(function(){$(this).bind(scroll,function(){var s2=$(selector);if(s2.length==0){$(this).unbind(scroll)}s2.select2(\"close\")})});$(window).bind(resize,function(){var s2=$(selector);if(s2.length==0){$(window).unbind(resize)}s2.select2(\"close\")});this.clearDropdownAlignmentPreference();if(this.search.val()===\" \"){this.search.val(\"\")}this.container.addClass(\"select2-dropdown-open\").addClass(\"select2-container-active\");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.dropdown.show();this.positionDropdown();this.dropdown.addClass(\"select2-drop-active\");this.ensureHighlightVisible();this.focusSearch()},close:function(){if(!this.opened())return;var self=this;this.container.parents().each(function(){$(this).unbind(\"scroll.\"+self.containerId)});$(window).unbind(\"resize.\"+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass(\"select2-dropdown-open\").removeClass(\"select2-container-active\");this.results.empty();this.clearSearch();this.opts.element.trigger($.Event(\"close\"))},clearSearch:function(){},ensureHighlightVisible:function(){var results=this.results,children,index,child,hb,rb,y,more;index=this.highlight();if(index<0)return;if(index==0){results.scrollTop(0);return}children=results.find(\".select2-result-selectable\");child=$(children[index]);hb=child.offset().top+child.outerHeight();if(index===children.length-1){more=results.find(\"li.select2-more-results\");if(more.length>0){hb=more.offset().top+more.outerHeight()}}rb=results.offset().top+results.outerHeight();if(hb>rb){results.scrollTop(results.scrollTop()+(hb-rb))}y=child.offset().top-results.offset().top;if(y<0){results.scrollTop(results.scrollTop()+y)}},moveHighlight:function(delta){var choices=this.results.find(\".select2-result-selectable\"),index=this.highlight();while(index>-1&&index<choices.length){index+=delta;var choice=$(choices[index]);if(choice.hasClass(\"select2-result-selectable\")&&!choice.hasClass(\"select2-disabled\")){this.highlight(index);break}}},highlight:function(index){var choices=this.results.find(\".select2-result-selectable\").not(\".select2-disabled\");if(arguments.length===0){return indexOf(choices.filter(\".select2-highlighted\")[0],choices.get())}if(index>=choices.length)index=choices.length-1;if(index<0)index=0;choices.removeClass(\"select2-highlighted\");$(choices[index]).addClass(\"select2-highlighted\");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(\".select2-result-selectable\").not(\".select2-disabled\").length},highlightUnderEvent:function(event){var el=$(event.target).closest(\".select2-result-selectable\");if(el.length>0&&!el.is(\".select2-highlighted\")){var choices=this.results.find(\".select2-result-selectable\");this.highlight(choices.index(el))}else if(el.length==0){this.results.find(\".select2-highlighted\").removeClass(\"select2-highlighted\")}},loadMoreIfNeeded:function(){var results=this.results,more=results.find(\"li.select2-more-results\"),below,offset=-1,page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;if(more.length===0)return;below=more.offset().top-results.offset().top-results.height();if(below<=0){more.addClass(\"select2-active\");this.opts.query({term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){if(!self.opened())return;self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context});if(data.more===true){more.detach().appendTo(results).text(self.opts.formatLoadMore(page+1));window.setTimeout(function(){self.loadMoreIfNeeded()},10)}else{more.remove()}self.positionDropdown();self.resultsPage=page})})}},tokenize:function(){},updateResults:function(initial){var search=this.search,results=this.results,opts=this.opts,data,self=this,input;if(initial!==true&&(this.showSearchInput===false||!this.opened())){return}search.addClass(\"select2-active\");function postRender(){results.scrollTop(0);search.removeClass(\"select2-active\");self.positionDropdown()}function render(html){results.html(self.opts.escapeMarkup(html));postRender()}if(opts.maximumSelectionSize>=1){data=this.data();if($.isArray(data)&&data.length>=opts.maximumSelectionSize&&checkFormatter(opts.formatSelectionTooBig,\"formatSelectionTooBig\")){render(\"<li class='select2-selection-limit'>\"+opts.formatSelectionTooBig(opts.maximumSelectionSize)+\"</li>\");return}}if(search.val().length<opts.minimumInputLength&&checkFormatter(opts.formatInputTooShort,\"formatInputTooShort\")){render(\"<li class='select2-no-results'>\"+opts.formatInputTooShort(search.val(),opts.minimumInputLength)+\"</li>\");return}else{render(\"<li class='select2-searching'>\"+opts.formatSearching()+\"</li>\")}input=this.tokenize();if(input!=undefined&&input!=null){search.val(input)}this.resultsPage=1;opts.query({term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;if(!this.opened())return;this.context=data.context===undefined?null:data.context;if(this.opts.createSearchChoice&&search.val()!==\"\"){def=this.opts.createSearchChoice.call(null,search.val(),data.results);if(def!==undefined&&def!==null&&self.id(def)!==undefined&&self.id(def)!==null){if($(data.results).filter(function(){return equal(self.id(this),self.id(def))}).length===0){data.results.unshift(def)}}}if(data.results.length===0&&checkFormatter(opts.formatNoMatches,\"formatNoMatches\")){render(\"<li class='select2-no-results'>\"+opts.formatNoMatches(search.val())+\"</li>\");return}results.empty();self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null});if(data.more===true&&checkFormatter(opts.formatLoadMore,\"formatLoadMore\")){results.append(\"<li class='select2-more-results'>\"+self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage))+\"</li>\");window.setTimeout(function(){self.loadMoreIfNeeded()},10)}this.postprocessResults(data,initial);postRender()})})},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass(\"select2-container-active\");this.dropdown.removeClass(\"select2-drop-active\");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\")},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var index=this.highlight(),highlighted=this.results.find(\".select2-highlighted\").not(\".select2-disabled\"),data=highlighted.closest(\".select2-result-selectable\").data(\"select2-data\");if(data){highlighted.addClass(\"select2-disabled\");this.highlight(index);this.onSelect(data)}},getPlaceholder:function(){return this.opts.element.attr(\"placeholder\")||this.opts.element.attr(\"data-placeholder\")||this.opts.element.data(\"placeholder\")||this.opts.placeholder},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l;if(this.opts.width===\"off\"){return null}else if(this.opts.width===\"element\"){return this.opts.element.outerWidth()===0?\"auto\":this.opts.element.outerWidth()+\"px\"}else if(this.opts.width===\"copy\"||this.opts.width===\"resolve\"){style=this.opts.element.attr(\"style\");if(style!==undefined){attrs=style.split(\";\");for(i=0,l=attrs.length;i<l;i=i+1){matches=attrs[i].replace(/\\s/g,\"\").match(/width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(matches!==null&&matches.length>=1)return matches[1]}}if(this.opts.width===\"resolve\"){style=this.opts.element.css(\"width\");if(style.indexOf(\"%\")>0)return style;return this.opts.element.outerWidth()===0?\"auto\":this.opts.element.outerWidth()+\"px\"}return null}else if($.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}var width=resolveContainerWidth.call(this);if(width!==null){this.container.attr(\"style\",\"width: \"+width)}}});SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(\"<div></div>\",{\"class\":\"select2-container\"}).html([\"    <a href='#' onclick='return false;' class='select2-choice'>\",\"   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>\",\"   <div><b></b></div>\",\"</a>\",\"    <div class='select2-drop select2-offscreen'>\",\"   <div class='select2-search'>\",\"       <input type='text' autocomplete='off' class='select2-input' placeholder='search...'/>\",\"   </div>\",\"   <ul class='select2-results'>\",\"   </ul>\",\"</div>\"].join(\"\"));return container},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass(\"select2-offscreen\")},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.dropdown.removeAttr(\"style\").addClass(\"select2-offscreen\").insertAfter(this.selection).show()},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var selection,container=this.container,dropdown=this.dropdown,clickingInside=false;this.selection=selection=container.find(\".select2-choice\");this.search.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return}if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:case KEY.RIGHT:case KEY.LEFT:this.moveHighlight(e.which===KEY.UP||e.which===KEY.LEFT?-1:1);killEvent(e);return;case KEY.TAB:case KEY.ENTER:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return}}else{if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}this.open();if(e.which===KEY.ENTER){return}}}));this.search.bind(\"focus\",this.bind(function(){this.selection.attr(\"tabIndex\",\"-1\")}));this.search.bind(\"blur\",this.bind(function(){if(!this.opened())this.container.removeClass(\"select2-container-active\");window.setTimeout(this.bind(function(){this.selection.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"))}),10)}));selection.bind(\"mousedown\",this.bind(function(e){clickingInside=true;if(this.opened()){this.close();this.selection.focus()}else if(this.enabled){this.open()}clickingInside=false}));dropdown.bind(\"mousedown\",this.bind(function(){this.search.focus()}));selection.bind(\"focus\",this.bind(function(){this.container.addClass(\"select2-container-active\");this.search.attr(\"tabIndex\",\"-1\")}));selection.bind(\"blur\",this.bind(function(){if(!this.opened()){this.container.removeClass(\"select2-container-active\")}window.setTimeout(this.bind(function(){this.search.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"))}),10)}));selection.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return}if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}if(e.which==KEY.DELETE){if(this.opts.allowClear){this.clear()}return}this.open();if(e.which===KEY.ENTER){killEvent(e);return}if(e.which<48){killEvent(e);return}var keyWritten=String.fromCharCode(e.which).toLowerCase();if(e.shiftKey){keyWritten=keyWritten.toUpperCase()}this.search.focus();this.search.val(keyWritten);killEvent(e)}));selection.delegate(\"abbr\",\"mousedown\",this.bind(function(e){if(!this.enabled)return;this.clear();killEvent(e);this.close();this.triggerChange();this.selection.focus()}));this.setPlaceholder();this.search.bind(\"focus\",this.bind(function(){this.container.addClass(\"select2-container-active\")}))},clear:function(){this.opts.element.val(\"\");this.selection.find(\"span\").empty();this.selection.removeData(\"select2-data\");this.setPlaceholder()},initSelection:function(){var selected;if(this.opts.element.val()===\"\"){this.close();this.setPlaceholder()}else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){if(selected!==undefined&&selected!==null){self.updateSelection(selected);self.close();self.setPlaceholder()}})}},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){opts.initSelection=function(element,callback){var selected=element.find(\":selected\");if($.isFunction(callback))callback({id:selected.attr(\"value\"),text:selected.text()})}}return opts},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.opts.element.val()===\"\"&&placeholder!==undefined){if(this.select&&this.select.find(\"option:first\").text()!==\"\")return;this.selection.find(\"span\").html(this.opts.escapeMarkup(placeholder));this.selection.addClass(\"select2-default\");this.selection.find(\"abbr\").hide()}},postprocessResults:function(data,initial){var selected=0,self=this,showSearchInput=true;this.results.find(\".select2-result-selectable\").each2(function(i,elm){if(equal(self.id(elm.data(\"select2-data\")),self.opts.element.val())){selected=i;return false}});this.highlight(selected);if(initial===true){showSearchInput=this.showSearchInput=countResults(data.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(\".select2-search\")[showSearchInput?\"removeClass\":\"addClass\"](\"select2-search-hidden\");$(this.dropdown,this.container)[showSearchInput?\"addClass\":\"removeClass\"](\"select2-with-searchbox\")}},onSelect:function(data){var old=this.opts.element.val();this.opts.element.val(this.id(data));this.updateSelection(data);this.close();this.selection.focus();if(!equal(old,this.id(data))){this.triggerChange()}},updateSelection:function(data){var container=this.selection.find(\"span\"),formatted;this.selection.data(\"select2-data\",data);container.empty();formatted=this.opts.formatSelection(data,container);if(formatted!==undefined){container.append(this.opts.escapeMarkup(formatted))}this.selection.removeClass(\"select2-default\");if(this.opts.allowClear&&this.getPlaceholder()!==undefined){this.selection.find(\"abbr\").show()}},val:function(){var val,data=null,self=this;if(arguments.length===0){return this.opts.element.val()}val=arguments[0];if(this.select){this.select.val(val).find(\":selected\").each2(function(i,elm){data={id:elm.attr(\"value\"),text:elm.text()};return false});this.updateSelection(data);this.setPlaceholder()}else{if(this.opts.initSelection===undefined){throw new Error(\"cannot call val() if initSelection() is not defined\")}if(!val){this.clear();return}this.opts.element.val(val);this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(!data?\"\":self.id(data));self.updateSelection(data);self.setPlaceholder()})}},clearSearch:function(){this.search.val(\"\")},data:function(value){var data;if(arguments.length===0){data=this.selection.data(\"select2-data\");if(data==undefined)data=null;return data}else{if(!value||value===\"\"){this.clear()}else{this.opts.element.val(!value?\"\":this.id(value));this.updateSelection(value)}}}});MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(\"<div></div>\",{\"class\":\"select2-container select2-container-multi\"}).html([\"    <ul class='select2-choices'>\",\"  <li class='select2-search-field'>\",\"    <input type='text' autocomplete='off' class='select2-input'>\",\"  </li>\",\"</ul>\",\"<div class='select2-drop select2-drop-multi' style='display:none;'>\",\"   <ul class='select2-results'>\",\"   </ul>\",\"</div>\"].join(\"\"));return container},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){opts.initSelection=function(element,callback){var data=[];element.find(\":selected\").each2(function(i,elm){data.push({id:elm.attr(\"value\"),text:elm.text()})});if($.isFunction(callback))callback(data)}}return opts},initContainer:function(){var selector=\".select2-choices\",selection;this.searchContainer=this.container.find(\".select2-search-field\");this.selection=selection=this.container.find(selector);this.search.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.BACKSPACE&&this.search.val()===\"\"){this.close();var choices,selected=selection.find(\".select2-search-choice-focus\");if(selected.length>0){this.unselect(selected.first());this.search.width(10);killEvent(e);return}choices=selection.find(\".select2-search-choice\");if(choices.length>0){choices.last().addClass(\"select2-search-choice-focus\")}}else{selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\")}if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight(e.which===KEY.UP?-1:1);killEvent(e);return;case KEY.ENTER:case KEY.TAB:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return}}if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.BACKSPACE||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}this.open();if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e)}}));this.search.bind(\"keyup\",this.bind(this.resizeSearch));this.search.bind(\"blur\",this.bind(function(e){this.container.removeClass(\"select2-container-active\");this.search.removeClass(\"select2-focused\");this.clearSearch();e.stopImmediatePropagation()}));this.container.delegate(selector,\"mousedown\",this.bind(function(e){if(!this.enabled)return;if($(e.target).closest(\".select2-search-choice\").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();e.preventDefault()}));this.container.delegate(selector,\"focus\",this.bind(function(){if(!this.enabled)return;this.container.addClass(\"select2-container-active\");this.dropdown.addClass(\"select2-drop-active\");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr(\"disabled\")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr(\"disabled\",true)},initSelection:function(){var data;if(this.opts.element.val()===\"\"){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==\"\"){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){if(data!==undefined&&data!==null){self.updateSelection(data);self.close();self.clearSearch()}})}},clearSearch:function(){var placeholder=this.getPlaceholder();if(placeholder!==undefined&&this.getVal().length===0&&this.search.hasClass(\"select2-focused\")===false){this.search.val(placeholder).addClass(\"select2-default\");this.resizeSearch()}else{this.search.val(\" \").width(10)}},clearPlaceholder:function(){if(this.search.hasClass(\"select2-default\")){this.search.val(\"\").removeClass(\"select2-default\")}else{if(this.search.val()===\" \")this.search.val(\"\")}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass(\"select2-focused\")},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each(function(){if(indexOf(self.id(this),ids)<0){ids.push(self.id(this));filtered.push(this)}});data=filtered;this.selection.find(\".select2-search-choice\").remove();$(data).each(function(){self.addSelectedChoice(this)});self.postprocessResults()},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer(input,this.data(),this.bind(this.onSelect),this.opts);if(input!=null&&input!=undefined){this.search.val(input);if(input.length>0){this.open()}}},onSelect:function(data){this.addSelectedChoice(data);if(this.select){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown()}else{this.close()}}this.triggerChange({added:data});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(data){var choice=$(\"<li class='select2-search-choice'>\"+\"    <div></div>\"+\"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>\"+\"</li>\"),id=this.id(data),val=this.getVal(),formatted;formatted=this.opts.formatSelection(data,choice);choice.find(\"div\").replaceWith(\"<div>\"+this.opts.escapeMarkup(formatted)+\"</div>\");choice.find(\".select2-search-choice-close\").bind(\"mousedown\",killEvent).bind(\"click dblclick\",this.bind(function(e){if(!this.enabled)return;$(e.target).closest(\".select2-search-choice\").fadeOut(\"fast\",this.bind(function(){this.unselect($(e.target));this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\");this.close();this.focusSearch()})).dequeue();killEvent(e)})).bind(\"focus\",this.bind(function(){if(!this.enabled)return;this.container.addClass(\"select2-container-active\");this.dropdown.addClass(\"select2-drop-active\")}));choice.data(\"select2-data\",data);choice.insertBefore(this.searchContainer);val.push(id);this.setVal(val)},unselect:function(selected){var val=this.getVal(),data,index;selected=selected.closest(\".select2-search-choice\");if(selected.length===0){throw\"Invalid argument: \"+selected+\". Must be .select2-search-choice\"}data=selected.data(\"select2-data\");index=indexOf(this.id(data),val);if(index>=0){val.splice(index,1);this.setVal(val);if(this.select)this.postprocessResults()}selected.remove();this.triggerChange({removed:data})},postprocessResults:function(){var val=this.getVal(),choices=this.results.find(\".select2-result-selectable\"),compound=this.results.find(\".select2-result-with-children\"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data(\"select2-data\"));if(indexOf(id,val)>=0){choice.addClass(\"select2-disabled\").removeClass(\"select2-result-selectable\")}else{choice.removeClass(\"select2-disabled\").addClass(\"select2-result-selectable\")}});compound.each2(function(i,e){if(e.find(\".select2-result-selectable\").length==0){e.addClass(\"select2-disabled\")}else{e.removeClass(\"select2-disabled\")}});choices.each2(function(i,choice){if(!choice.hasClass(\"select2-disabled\")&&choice.hasClass(\"select2-result-selectable\")){self.highlight(0);return false}})},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10;left=this.search.offset().left;maxWidth=this.selection.width();containerLeft=this.selection.offset().left;searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding;if(searchWidth<minimumWidth){searchWidth=maxWidth-sideBorderPadding}if(searchWidth<40){searchWidth=maxWidth-sideBorderPadding}this.search.width(searchWidth)},getVal:function(){var val;\nif(this.select){val=this.select.val();return val===null?[]:val}else{val=this.opts.element.val();return splitVal(val,this.opts.separator)}},setVal:function(val){var unique;if(this.select){this.select.val(val)}else{unique=[];$(val).each(function(){if(indexOf(this,unique)<0)unique.push(this)});this.opts.element.val(unique.length===0?\"\":unique.join(this.opts.separator))}},val:function(){var val,data=[],self=this;if(arguments.length===0){return this.getVal()}val=arguments[0];if(!val){this.opts.element.val(\"\");this.updateSelection([]);this.clearSearch();return}this.setVal(val);if(this.select){this.select.find(\":selected\").each(function(){data.push({id:$(this).attr(\"value\"),text:$(this).text()})});this.updateSelection(data)}else{if(this.opts.initSelection===undefined){throw new Error(\"val() cannot be called if initSelection() is not defined\")}this.opts.initSelection(this.opts.element,function(data){var ids=$(data).map(self.id);self.setVal(ids);self.updateSelection(data);self.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error(\"Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.\")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var val=[],self=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(\".select2-search-choice\").each(function(){val.push(self.opts.id($(this).data(\"select2-data\")))});this.setVal(val);this.triggerChange()},data:function(values){var self=this,ids;if(arguments.length===0){return this.selection.find(\".select2-search-choice\").map(function(){return $(this).data(\"select2-data\")}).get()}else{if(!values){values=[]}ids=$.map(values,function(e){return self.opts.id(e)});this.setVal(ids);this.updateSelection(values);this.clearSearch()}}});$.fn.select2=function(){var args=Array.prototype.slice.call(arguments,0),opts,select2,value,multiple,allowedMethods=[\"val\",\"destroy\",\"opened\",\"open\",\"close\",\"focus\",\"isFocused\",\"container\",\"onSortStart\",\"onSortEnd\",\"enable\",\"disable\",\"positionDropdown\",\"data\"];this.each(function(){if(args.length===0||typeof args[0]===\"object\"){opts=args.length===0?{}:$.extend({},args[0]);opts.element=$(this);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){multiple=opts.element.attr(\"multiple\")}else{multiple=opts.multiple||false;if(\"tags\"in opts){opts.multiple=multiple=true}}select2=multiple?new MultiSelect2:new SingleSelect2;select2.init(opts)}else if(typeof args[0]===\"string\"){if(indexOf(args[0],allowedMethods)<0){throw\"Unknown method: \"+args[0]}value=undefined;select2=$(this).data(\"select2\");if(select2===undefined)return;if(args[0]===\"container\"){value=select2.container}else{value=select2[args[0]].apply(select2,args.slice(1))}if(value!==undefined){return false}}else{throw\"Invalid arguments to select2 plugin: \"+args}});return value===undefined?this:value};$.fn.select2.defaults={width:\"copy\",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:\"\",dropdownCssClass:\"\",formatResult:function(result,container,query){var markup=[];markMatch(result.text,query.term,markup);return markup.join(\"\")},formatSelection:function(data,container){return data?data.text:undefined},formatResultCssClass:function(data){return undefined},formatNoMatches:function(){return\"No matches found\"},formatInputTooShort:function(input,min){return\"Please enter \"+(min-input.length)+\" more characters\"},formatSelectionTooBig:function(limit){return\"You can only select \"+limit+\" item\"+(limit==1?\"\":\"s\")},formatLoadMore:function(pageNumber){return\"Loading more results...\"},formatSearching:function(){return\"Searching...\"},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(term,text){return text.toUpperCase().indexOf(term.toUpperCase())>=0},separator:\",\",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:function(markup){if(markup&&typeof markup===\"string\"){return markup.replace(/&/g,\"&amp;\")}return markup},blurOnChange:false};window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch},\"class\":{\"abstract\":AbstractSelect2,single:SingleSelect2,multi:MultiSelect2}}})(jQuery);(function(){var window=this;if(!window.localStorage){if(window.globalStorage){try{window.localStorage=window.globalStorage}catch(e){}return}var div=document.createElement(\"div\"),attrKey=\"localStorage\";div.style.display=\"none\";document.getElementsByTagName(\"head\")[0].appendChild(div);if(div.addBehavior){div.addBehavior(\"#default#userdata\");var localStorage=window[\"localStorage\"]={length:0,setItem:function(key,value){div.load(attrKey);key=cleanKey(key);if(!div.getAttribute(key)){this.length++}div.setAttribute(key,value);div.save(attrKey)},getItem:function(key){div.load(attrKey);key=cleanKey(key);return div.getAttribute(key)},removeItem:function(key){div.load(attrKey);key=cleanKey(key);div.removeAttribute(key);div.save(attrKey);this.length--;if(this.length<0){this.length=0}},clear:function(){div.load(attrKey);var i=0;while(attr=div.XMLDocument.documentElement.attributes[i++]){div.removeAttribute(attr.name)}div.save(attrKey);this.length=0},key:function(key){div.load(attrKey);return div.XMLDocument.documentElement.attributes[key]}},cleanKey=function(key){return key.replace(/[^-._0-9A-Za-z\\xb7\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u037d\\u37f-\\u1fff\\u200c-\\u200d\\u203f\\u2040\\u2070-\\u218f]/g,\"-\")};div.load(attrKey);localStorage[\"length\"]=div.XMLDocument.documentElement.attributes.length}}})();!function(root,String){\"use strict\";var nativeTrim=String.prototype.trim;var nativeTrimRight=String.prototype.trimRight;var nativeTrimLeft=String.prototype.trimLeft;var parseNumber=function(source){return source*1||0};var strRepeat=function(str,qty){if(qty<1)return\"\";var result=\"\";while(qty>0){if(qty&1)result+=str;qty>>=1,str+=str}return result};var slice=[].slice;var defaultToWhiteSpace=function(characters){if(characters==null)return\"\\\\s\";else if(characters.source)return characters.source;else return\"[\"+_s.escapeRegExp(characters)+\"]\"};var escapeChars={lt:\"<\",gt:\">\",quot:'\"',apos:\"'\",amp:\"&\"};var reversedEscapeChars={};for(var key in escapeChars){reversedEscapeChars[escapeChars[key]]=key}var sprintf=function(){function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}var str_repeat=strRepeat;var str_format=function(){if(!str_format.cache.hasOwnProperty(arguments[0])){str_format.cache[arguments[0]]=str_format.parse(arguments[0])}return str_format.format.call(null,str_format.cache[arguments[0]],arguments)};str_format.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type=\"\",arg,output=[],i,k,match,pad,pad_character,pad_length;for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i]);if(node_type===\"string\"){output.push(parse_tree[i])}else if(node_type===\"array\"){match=parse_tree[i];if(match[2]){arg=argv[cursor];for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k])){throw new Error(sprintf('[_.sprintf] property \"%s\" does not exist',match[2][k]))}arg=arg[match[2][k]]}}else if(match[1]){arg=argv[match[1]]}else{arg=argv[cursor++]}if(/[^s]/.test(match[8])&&get_type(arg)!=\"number\"){throw new Error(sprintf(\"[_.sprintf] expecting number but found %s\",get_type(arg)))}switch(match[8]){case\"b\":arg=arg.toString(2);break;case\"c\":arg=String.fromCharCode(arg);break;case\"d\":arg=parseInt(arg,10);break;case\"e\":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case\"f\":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case\"o\":arg=arg.toString(8);break;case\"s\":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case\"u\":arg=Math.abs(arg);break;case\"x\":arg=arg.toString(16);break;case\"X\":arg=arg.toString(16).toUpperCase();break}arg=/[def]/.test(match[8])&&match[3]&&arg>=0?\"+\"+arg:arg;pad_character=match[4]?match[4]==\"0\"?\"0\":match[4].charAt(1):\" \";pad_length=match[6]-String(arg).length;pad=match[6]?str_repeat(pad_character,pad_length):\"\";output.push(match[5]?arg+pad:pad+arg)}}return output.join(\"\")};str_format.cache={};str_format.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=[],arg_names=0;while(_fmt){if((match=/^[^\\x25]+/.exec(_fmt))!==null){parse_tree.push(match[0])}else if((match=/^\\x25{2}/.exec(_fmt))!==null){parse_tree.push(\"%\")}else if((match=/^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt))!==null){if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if((field_match=/^([a-z_][a-z_\\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1]);while((replacement_field=replacement_field.substring(field_match[0].length))!==\"\"){if((field_match=/^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1])}else if((field_match=/^\\[(\\d+)\\]/.exec(replacement_field))!==null){field_list.push(field_match[1])}else{throw new Error(\"[_.sprintf] huh?\")}}}else{throw new Error(\"[_.sprintf] huh?\")}match[2]=field_list}else{arg_names|=2}if(arg_names===3){throw new Error(\"[_.sprintf] mixing positional and named placeholders is not (yet) supported\")}parse_tree.push(match)}else{throw new Error(\"[_.sprintf] huh?\")}_fmt=_fmt.substring(match[0].length)}return parse_tree};return str_format}();var _s={VERSION:\"2.3.0\",isBlank:function(str){if(str==null)str=\"\";return/^\\s*$/.test(str)},stripTags:function(str){if(str==null)return\"\";return String(str).replace(/<\\/?[^>]+>/g,\"\")},capitalize:function(str){str=str==null?\"\":String(str);return str.charAt(0).toUpperCase()+str.slice(1)},chop:function(str,step){if(str==null)return[];str=String(str);step=~~step;return step>0?str.match(new RegExp(\".{1,\"+step+\"}\",\"g\")):[str]},clean:function(str){return _s.strip(str).replace(/\\s+/g,\" \")},count:function(str,substr){if(str==null||substr==null)return 0;return String(str).split(substr).length-1},chars:function(str){if(str==null)return[];return String(str).split(\"\")},swapCase:function(str){if(str==null)return\"\";return String(str).replace(/\\S/g,function(c){return c===c.toUpperCase()?c.toLowerCase():c.toUpperCase()})},escapeHTML:function(str){if(str==null)return\"\";return String(str).replace(/[&<>\"']/g,function(m){return\"&\"+reversedEscapeChars[m]+\";\"})},unescapeHTML:function(str){if(str==null)return\"\";return String(str).replace(/\\&([^;]+);/g,function(entity,entityCode){var match;if(entityCode in escapeChars){return escapeChars[entityCode]}else if(match=entityCode.match(/^#x([\\da-fA-F]+)$/)){return String.fromCharCode(parseInt(match[1],16))}else if(match=entityCode.match(/^#(\\d+)$/)){return String.fromCharCode(~~match[1])}else{return entity}})},escapeRegExp:function(str){if(str==null)return\"\";return String(str).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g,\"\\\\$1\")},splice:function(str,i,howmany,substr){var arr=_s.chars(str);arr.splice(~~i,~~howmany,substr);return arr.join(\"\")},insert:function(str,i,substr){return _s.splice(str,i,0,substr)},include:function(str,needle){if(needle===\"\")return true;if(str==null)return false;return String(str).indexOf(needle)!==-1},join:function(){var args=slice.call(arguments),separator=args.shift();if(separator==null)separator=\"\";return args.join(separator)},lines:function(str){if(str==null)return[];return String(str).split(\"\\n\")},reverse:function(str){return _s.chars(str).reverse().join(\"\")},startsWith:function(str,starts){if(starts===\"\")return true;if(str==null||starts==null)return false;str=String(str);starts=String(starts);return str.length>=starts.length&&str.slice(0,starts.length)===starts},endsWith:function(str,ends){if(ends===\"\")return true;if(str==null||ends==null)return false;str=String(str);ends=String(ends);return str.length>=ends.length&&str.slice(str.length-ends.length)===ends},succ:function(str){if(str==null)return\"\";str=String(str);return str.slice(0,-1)+String.fromCharCode(str.charCodeAt(str.length-1)+1)},titleize:function(str){if(str==null)return\"\";return String(str).replace(/(?:^|\\s)\\S/g,function(c){return c.toUpperCase()})},camelize:function(str){return _s.trim(str).replace(/[-_\\s]+(.)?/g,function(match,c){return c.toUpperCase()})},underscored:function(str){return _s.trim(str).replace(/([a-z\\d])([A-Z]+)/g,\"$1_$2\").replace(/[-\\s]+/g,\"_\").toLowerCase()},dasherize:function(str){return _s.trim(str).replace(/([A-Z])/g,\"-$1\").replace(/[-_\\s]+/g,\"-\").toLowerCase()},classify:function(str){return _s.titleize(String(str).replace(/_/g,\" \")).replace(/\\s/g,\"\")},humanize:function(str){return _s.capitalize(_s.underscored(str).replace(/_id$/,\"\").replace(/_/g,\" \"))},trim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrim)return nativeTrim.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(\"^\"+characters+\"+|\"+characters+\"+$\",\"g\"),\"\")},ltrim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrimLeft)return nativeTrimLeft.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(\"^\"+characters+\"+\"),\"\")},rtrim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrimRight)return nativeTrimRight.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(characters+\"+$\"),\"\")},truncate:function(str,length,truncateStr){if(str==null)return\"\";str=String(str);truncateStr=truncateStr||\"...\";length=~~length;return str.length>length?str.slice(0,length)+truncateStr:str},prune:function(str,length,pruneStr){if(str==null)return\"\";str=String(str);length=~~length;pruneStr=pruneStr!=null?String(pruneStr):\"...\";if(str.length<=length)return str;var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?\"A\":\" \"},template=str.slice(0,length+1).replace(/.(?=\\W*\\w*$)/g,tmpl);if(template.slice(template.length-2).match(/\\w\\w/))template=template.replace(/\\s*\\S+$/,\"\");else template=_s.rtrim(template.slice(0,template.length-1));return(template+pruneStr).length>str.length?str:str.slice(0,template.length)+pruneStr},words:function(str,delimiter){if(_s.isBlank(str))return[];return _s.trim(str,delimiter).split(delimiter||/\\s+/)},pad:function(str,length,padStr,type){str=str==null?\"\":String(str);length=~~length;var padlen=0;if(!padStr)padStr=\" \";else if(padStr.length>1)padStr=padStr.charAt(0);switch(type){case\"right\":padlen=length-str.length;return str+strRepeat(padStr,padlen);case\"both\":padlen=length-str.length;return strRepeat(padStr,Math.ceil(padlen/2))+str+strRepeat(padStr,Math.floor(padlen/2));default:padlen=length-str.length;return strRepeat(padStr,padlen)+str}},lpad:function(str,length,padStr){return _s.pad(str,length,padStr)},rpad:function(str,length,padStr){return _s.pad(str,length,padStr,\"right\")},lrpad:function(str,length,padStr){return _s.pad(str,length,padStr,\"both\")},sprintf:sprintf,vsprintf:function(fmt,argv){argv.unshift(fmt);return sprintf.apply(null,argv)},toNumber:function(str,decimals){if(str==null||str==\"\")return 0;str=String(str);var num=parseNumber(parseNumber(str).toFixed(~~decimals));return num===0&&!str.match(/^0+$/)?Number.NaN:num},numberFormat:function(number,dec,dsep,tsep){if(isNaN(number)||number==null)return\"\";number=number.toFixed(~~dec);tsep=tsep||\",\";var parts=number.split(\".\"),fnums=parts[0],decimals=parts[1]?(dsep||\".\")+parts[1]:\"\";return fnums.replace(/(\\d)(?=(?:\\d{3})+$)/g,\"$1\"+tsep)+decimals},strRight:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str},strRightBack:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.lastIndexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str},strLeft:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(0,pos):str},strLeftBack:function(str,sep){if(str==null)return\"\";str+=\"\";sep=sep!=null?\"\"+sep:sep;var pos=str.lastIndexOf(sep);return~pos?str.slice(0,pos):str},toSentence:function(array,separator,lastSeparator,serial){separator=separator||\", \";lastSeparator=lastSeparator||\" and \";var a=array.slice(),lastMember=a.pop();if(array.length>2&&serial)lastSeparator=_s.rtrim(separator)+lastSeparator;return a.length?a.join(separator)+lastSeparator+lastMember:lastMember},toSentenceSerial:function(){var args=slice.call(arguments);args[3]=true;return _s.toSentence.apply(_s,args)},slugify:function(str){if(str==null)return\"\";var from=\" \",to=\"aaaaaaaaceeeeeiiiilnoooooouuuunczz\",regex=new RegExp(defaultToWhiteSpace(from),\"g\");str=String(str).toLowerCase().replace(regex,function(c){var index=from.indexOf(c);return to.charAt(index)||\"-\"});return _s.dasherize(str.replace(/[^\\w\\s-]/g,\"\"))},surround:function(str,wrapper){return[wrapper,str,wrapper].join(\"\")},quote:function(str){return _s.surround(str,'\"')},exports:function(){var result={};for(var prop in this){if(!this.hasOwnProperty(prop)||prop.match(/^(?:include|contains|reverse)$/))continue;result[prop]=this[prop]}return result},repeat:function(str,qty,separator){if(str==null)return\"\";qty=~~qty;if(separator==null)return strRepeat(String(str),qty);for(var repeat=[];qty>0;repeat[--qty]=str){}return repeat.join(separator)},levenshtein:function(str1,str2){if(str1==null&&str2==null)return 0;if(str1==null)return String(str2).length;if(str2==null)return String(str1).length;str1=String(str1);str2=String(str2);var current=[],prev,value;for(var i=0;i<=str2.length;i++)for(var j=0;j<=str1.length;j++){if(i&&j)if(str1.charAt(j-1)===str2.charAt(i-1))value=prev;else value=Math.min(current[j],current[j-1],prev)+1;else value=i+j;prev=current[j];current[j]=value}return current.pop()}};_s.strip=_s.trim;_s.lstrip=_s.ltrim;_s.rstrip=_s.rtrim;_s.center=_s.lrpad;_s.rjust=_s.lpad;_s.ljust=_s.rpad;_s.contains=_s.include;_s.q=_s.quote;if(typeof exports!==\"undefined\"){if(typeof module!==\"undefined\"&&module.exports){module.exports=_s}exports._s=_s}else if(typeof define===\"function\"&&define.amd){define(\"underscore.string\",[],function(){return _s})}else{root._=root._||{};root._.string=root._.str=_s}}(this,String);(function(){\"use strict\";var _camelizeCssPropName=function(){var matcherRegex=/\\-([a-z])/g,replacerFn=function(match,group){return group.toUpperCase()};return function(prop){return prop.replace(matcherRegex,replacerFn)}}();var _getStyle=function(el,prop){var value,camelProp,tagName,possiblePointers,i,len;if(window.getComputedStyle){value=window.getComputedStyle(el,null).getPropertyValue(prop)}else{camelProp=_camelizeCssPropName(prop);if(el.currentStyle){value=el.currentStyle[camelProp]}else{value=el.style[camelProp]}}if(prop===\"cursor\"){if(!value||value===\"auto\"){tagName=el.tagName.toLowerCase();possiblePointers=[\"a\"];for(i=0,len=possiblePointers.length;i<len;i++){if(tagName===possiblePointers[i]){return\"pointer\"}}}}return value};var _elementMouseOver=function(event){if(!ZeroClipboard.prototype._singleton)return;if(!event){event=window.event}var target;if(this!==window){target=this}else if(event.target){target=event.target}else if(event.srcElement){target=event.srcElement}ZeroClipboard.prototype._singleton.setCurrent(target)};var _addEventHandler=function(element,method,func){if(element.addEventListener){element.addEventListener(method,func,false)}else if(element.attachEvent){element.attachEvent(\"on\"+method,func)}};var _removeEventHandler=function(element,method,func){if(element.removeEventListener){element.removeEventListener(method,func,false)}else if(element.detachEvent){element.detachEvent(\"on\"+method,func)}};var _addClass=function(element,value){if(element.addClass){element.addClass(value);return element}if(value&&typeof value===\"string\"){var classNames=(value||\"\").split(/\\s+/);if(element.nodeType===1){if(!element.className){element.className=value}else{var className=\" \"+element.className+\" \",setClass=element.className;for(var c=0,cl=classNames.length;c<cl;c++){if(className.indexOf(\" \"+classNames[c]+\" \")<0){setClass+=\" \"+classNames[c]}}element.className=setClass.replace(/^\\s+|\\s+$/g,\"\")}}}return element};var _removeClass=function(element,value){if(element.removeClass){element.removeClass(value);return element}if(value&&typeof value===\"string\"||value===undefined){var classNames=(value||\"\").split(/\\s+/);if(element.nodeType===1&&element.className){if(value){var className=(\" \"+element.className+\" \").replace(/[\\n\\t]/g,\" \");for(var c=0,cl=classNames.length;c<cl;c++){className=className.replace(\" \"+classNames[c]+\" \",\" \")}element.className=className.replace(/^\\s+|\\s+$/g,\"\")}else{element.className=\"\"}}}return element};var _getZoomFactor=function(){var rect,physicalWidth,logicalWidth,zoomFactor=1;if(typeof document.body.getBoundingClientRect===\"function\"){rect=document.body.getBoundingClientRect();physicalWidth=rect.right-rect.left;logicalWidth=document.body.offsetWidth;zoomFactor=Math.round(physicalWidth/logicalWidth*100)/100}return zoomFactor};var _getDOMObjectPosition=function(obj){var info={left:0,top:0,width:0,height:0,zIndex:999999999};var zi=_getStyle(obj,\"z-index\");if(zi&&zi!==\"auto\"){info.zIndex=parseInt(zi,10)}if(obj.getBoundingClientRect){var rect=obj.getBoundingClientRect();var pageXOffset,pageYOffset,zoomFactor;if(\"pageXOffset\"in window&&\"pageYOffset\"in window){pageXOffset=window.pageXOffset;pageYOffset=window.pageYOffset}else{zoomFactor=_getZoomFactor();pageXOffset=Math.round(document.documentElement.scrollLeft/zoomFactor);pageYOffset=Math.round(document.documentElement.scrollTop/zoomFactor)}var leftBorderWidth=document.documentElement.clientLeft||0;var topBorderWidth=document.documentElement.clientTop||0;info.left=rect.left+pageXOffset-leftBorderWidth;info.top=rect.top+pageYOffset-topBorderWidth;info.width=\"width\"in rect?rect.width:rect.right-rect.left;info.height=\"height\"in rect?rect.height:rect.bottom-rect.top}return info};var _noCache=function(path,options){var useNoCache=!(options&&options.useNoCache===false);if(useNoCache){return(path.indexOf(\"?\")===-1?\"?\":\"&\")+\"nocache=\"+(new Date).getTime()}else{return\"\"}};var _vars=function(options){var str=[];var origins=[];if(options.trustedOrigins){if(typeof options.trustedOrigins===\"string\"){origins.push(options.trustedOrigins)}else if(typeof options.trustedOrigins===\"object\"&&\"length\"in options.trustedOrigins){origins=origins.concat(options.trustedOrigins)}}if(options.trustedDomains){if(typeof options.trustedDomains===\"string\"){origins.push(options.trustedDomains)}else if(typeof options.trustedDomains===\"object\"&&\"length\"in options.trustedDomains){origins=origins.concat(options.trustedDomains)}}if(origins.length){str.push(\"trustedOrigins=\"+encodeURIComponent(origins.join(\",\")))}if(typeof options.amdModuleId===\"string\"&&options.amdModuleId){str.push(\"amdModuleId=\"+encodeURIComponent(options.amdModuleId))}if(typeof options.cjsModuleId===\"string\"&&options.cjsModuleId){str.push(\"cjsModuleId=\"+encodeURIComponent(options.cjsModuleId))}return str.join(\"&\")};var _inArray=function(elem,array){if(array.indexOf){return array.indexOf(elem)}for(var i=0,length=array.length;i<length;i++){if(array[i]===elem){return i}}return-1};var _prepGlue=function(elements){if(typeof elements===\"string\")throw new TypeError(\"ZeroClipboard doesn't accept query strings.\");if(!elements.length)return[elements];return elements};var _dispatchCallback=function(func,element,instance,args,async){if(async){window.setTimeout(function(){func.call(element,instance,args)},0)}else{func.call(element,instance,args)}};var ZeroClipboard=function(elements,options){if(elements)(ZeroClipboard.prototype._singleton||this).glue(elements);if(ZeroClipboard.prototype._singleton)return ZeroClipboard.prototype._singleton;ZeroClipboard.prototype._singleton=this;this.options={};for(var kd in _defaults)this.options[kd]=_defaults[kd];for(var ko in options)this.options[ko]=options[ko];this.handlers={};if(ZeroClipboard.detectFlashSupport())_bridge()};var currentElement,gluedElements=[];ZeroClipboard.prototype.setCurrent=function(element){currentElement=element;this.reposition();var titleAttr=element.getAttribute(\"title\");if(titleAttr){this.setTitle(titleAttr)}var useHandCursor=this.options.forceHandCursor===true||_getStyle(element,\"cursor\")===\"pointer\";_setHandCursor.call(this,useHandCursor);return this};ZeroClipboard.prototype.setText=function(newText){if(newText&&newText!==\"\"){this.options.text=newText;if(this.ready())this.flashBridge.setText(newText)}return this};ZeroClipboard.prototype.setTitle=function(newTitle){if(newTitle&&newTitle!==\"\")this.htmlBridge.setAttribute(\"title\",newTitle);return this};ZeroClipboard.prototype.setSize=function(width,height){if(this.ready())this.flashBridge.setSize(width,height);return this};ZeroClipboard.prototype.setHandCursor=function(enabled){enabled=typeof enabled===\"boolean\"?enabled:!!enabled;_setHandCursor.call(this,enabled);this.options.forceHandCursor=enabled;return this};var _setHandCursor=function(enabled){if(this.ready())this.flashBridge.setHandCursor(enabled)};ZeroClipboard.version=\"1.2.3\";var _defaults={moviePath:\"ZeroClipboard.swf\",trustedOrigins:null,text:null,hoverClass:\"zeroclipboard-is-hover\",activeClass:\"zeroclipboard-is-active\",allowScriptAccess:\"sameDomain\",useNoCache:true,forceHandCursor:false};ZeroClipboard.setDefaults=function(options){for(var ko in options)_defaults[ko]=options[ko]};ZeroClipboard.destroy=function(){ZeroClipboard.prototype._singleton.unglue(gluedElements);var bridge=ZeroClipboard.prototype._singleton.htmlBridge;bridge.parentNode.removeChild(bridge);delete ZeroClipboard.prototype._singleton};ZeroClipboard.detectFlashSupport=function(){var hasFlash=false;if(typeof ActiveXObject===\"function\"){try{if(new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")){hasFlash=true}}catch(error){}}if(!hasFlash&&navigator.mimeTypes[\"application/x-shockwave-flash\"]){hasFlash=true}return hasFlash};var _amdModuleId=null;var _cjsModuleId=null;var _bridge=function(){var flashBridge,len;var client=ZeroClipboard.prototype._singleton;var container=document.getElementById(\"global-zeroclipboard-html-bridge\");if(!container){var opts={};for(var ko in client.options)opts[ko]=client.options[ko];opts.amdModuleId=_amdModuleId;opts.cjsModuleId=_cjsModuleId;var flashvars=_vars(opts);var html='      <object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" id=\"global-zeroclipboard-flash-bridge\" width=\"100%\" height=\"100%\">         <param name=\"movie\" value=\"'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'\"/>         <param name=\"allowScriptAccess\" value=\"'+client.options.allowScriptAccess+'\"/>         <param name=\"scale\" value=\"exactfit\"/>         <param name=\"loop\" value=\"false\"/>         <param name=\"menu\" value=\"false\"/>         <param name=\"quality\" value=\"best\" />         <param name=\"bgcolor\" value=\"#ffffff\"/>         <param name=\"wmode\" value=\"transparent\"/>         <param name=\"flashvars\" value=\"'+flashvars+'\"/>         <embed src=\"'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'\"           loop=\"false\" menu=\"false\"           quality=\"best\" bgcolor=\"#ffffff\"           width=\"100%\" height=\"100%\"           name=\"global-zeroclipboard-flash-bridge\"           allowScriptAccess=\"always\"           allowFullScreen=\"false\"           type=\"application/x-shockwave-flash\"           wmode=\"transparent\"           pluginspage=\"http://www.macromedia.com/go/getflashplayer\"           flashvars=\"'+flashvars+'\"           scale=\"exactfit\">         </embed>       </object>';container=document.createElement(\"div\");container.id=\"global-zeroclipboard-html-bridge\";container.setAttribute(\"class\",\"global-zeroclipboard-container\");container.setAttribute(\"data-clipboard-ready\",false);container.style.position=\"absolute\";container.style.left=\"-9999px\";container.style.top=\"-9999px\";container.style.width=\"15px\";container.style.height=\"15px\";container.style.zIndex=\"9999\";container.innerHTML=html;document.body.appendChild(container)}client.htmlBridge=container;flashBridge=document[\"global-zeroclipboard-flash-bridge\"];if(flashBridge&&(len=flashBridge.length)){flashBridge=flashBridge[len-1]}client.flashBridge=flashBridge||container.children[0].lastElementChild};ZeroClipboard.prototype.resetBridge=function(){this.htmlBridge.style.left=\"-9999px\";this.htmlBridge.style.top=\"-9999px\";this.htmlBridge.removeAttribute(\"title\");this.htmlBridge.removeAttribute(\"data-clipboard-text\");_removeClass(currentElement,this.options.activeClass);currentElement=null;this.options.text=null;return this};ZeroClipboard.prototype.ready=function(){var ready=this.htmlBridge.getAttribute(\"data-clipboard-ready\");return ready===\"true\"||ready===true};ZeroClipboard.prototype.reposition=function(){if(!currentElement)return false;var pos=_getDOMObjectPosition(currentElement);this.htmlBridge.style.top=pos.top+\"px\";this.htmlBridge.style.left=pos.left+\"px\";this.htmlBridge.style.width=pos.width+\"px\";this.htmlBridge.style.height=pos.height+\"px\";this.htmlBridge.style.zIndex=pos.zIndex+1;this.setSize(pos.width,pos.height);return this};ZeroClipboard.dispatch=function(eventName,args){ZeroClipboard.prototype._singleton.receiveEvent(eventName,args)};ZeroClipboard.prototype.on=function(eventName,func){var events=eventName.toString().split(/\\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,\"\");if(!this.handlers[eventName])this.handlers[eventName]=func}if(this.handlers.noflash&&!ZeroClipboard.detectFlashSupport()){this.receiveEvent(\"onNoFlash\",null)}return this};ZeroClipboard.prototype.addEventListener=ZeroClipboard.prototype.on;ZeroClipboard.prototype.off=function(eventName,func){var events=eventName.toString().split(/\\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,\"\");for(var event in this.handlers){if(event===eventName&&this.handlers[event]===func){delete this.handlers[event]}}}return this};ZeroClipboard.prototype.removeEventListener=ZeroClipboard.prototype.off;ZeroClipboard.prototype.receiveEvent=function(eventName,args){eventName=eventName.toString().toLowerCase().replace(/^on/,\"\");var element=currentElement;var performCallbackAsync=true;switch(eventName){case\"load\":if(args&&parseFloat(args.flashVersion.replace(\",\",\".\").replace(/[^0-9\\.]/gi,\"\"))<10){this.receiveEvent(\"onWrongFlash\",{flashVersion:args.flashVersion});return}this.htmlBridge.setAttribute(\"data-clipboard-ready\",true);break;case\"mouseover\":_addClass(element,this.options.hoverClass);break;case\"mouseout\":_removeClass(element,this.options.hoverClass);this.resetBridge();break;case\"mousedown\":_addClass(element,this.options.activeClass);break;case\"mouseup\":_removeClass(element,this.options.activeClass);break;case\"datarequested\":var targetId=element.getAttribute(\"data-clipboard-target\"),targetEl=!targetId?null:document.getElementById(targetId);if(targetEl){var textContent=targetEl.value||targetEl.textContent||targetEl.innerText;if(textContent)this.setText(textContent)}else{var defaultText=element.getAttribute(\"data-clipboard-text\");if(defaultText)this.setText(defaultText)}performCallbackAsync=false;break;case\"complete\":this.options.text=null;break}if(this.handlers[eventName]){var func=this.handlers[eventName];if(typeof func===\"string\"&&typeof window[func]===\"function\"){func=window[func]}if(typeof func===\"function\"){_dispatchCallback(func,element,this,args,performCallbackAsync)}}};ZeroClipboard.prototype.glue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){if(_inArray(elements[i],gluedElements)==-1){gluedElements.push(elements[i]);_addEventHandler(elements[i],\"mouseover\",_elementMouseOver)}}return this};ZeroClipboard.prototype.unglue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){_removeEventHandler(elements[i],\"mouseover\",_elementMouseOver);var arrayIndex=_inArray(elements[i],gluedElements);if(arrayIndex!=-1)gluedElements.splice(arrayIndex,1)}return this};if(typeof define===\"function\"&&define.amd){define([\"require\",\"exports\",\"module\"],function(require,exports,module){_amdModuleId=module&&module.id||null;\nreturn ZeroClipboard})}else if(typeof module===\"object\"&&module&&typeof module.exports===\"object\"&&module.exports){_cjsModuleId=module.id||null;module.exports=ZeroClipboard}else{window.ZeroClipboard=ZeroClipboard}})();var Handlebars={};(function(Handlebars,undefined){Handlebars.VERSION=\"1.0.0\";Handlebars.COMPILER_REVISION=4;Handlebars.REVISION_CHANGES={1:\"<= 1.0.rc.2\",2:\"== 1.0.0-rc.3\",3:\"== 1.0.0-rc.4\",4:\">= 1.0.0\"};Handlebars.helpers={};Handlebars.partials={};var toString=Object.prototype.toString,functionType=\"[object Function]\",objectType=\"[object Object]\";Handlebars.registerHelper=function(name,fn,inverse){if(toString.call(name)===objectType){if(inverse||fn){throw new Handlebars.Exception(\"Arg not supported with multiple helpers\")}Handlebars.Utils.extend(this.helpers,name)}else{if(inverse){fn.not=inverse}this.helpers[name]=fn}};Handlebars.registerPartial=function(name,str){if(toString.call(name)===objectType){Handlebars.Utils.extend(this.partials,name)}else{this.partials[name]=str}};Handlebars.registerHelper(\"helperMissing\",function(arg){if(arguments.length===2){return undefined}else{throw new Error(\"Missing helper: '\"+arg+\"'\")}});Handlebars.registerHelper(\"blockHelperMissing\",function(context,options){var inverse=options.inverse||function(){},fn=options.fn;var type=toString.call(context);if(type===functionType){context=context.call(this)}if(context===true){return fn(this)}else if(context===false||context==null){return inverse(this)}else if(type===\"[object Array]\"){if(context.length>0){return Handlebars.helpers.each(context,options)}else{return inverse(this)}}else{return fn(context)}});Handlebars.K=function(){};Handlebars.createFrame=Object.create||function(object){Handlebars.K.prototype=object;var obj=new Handlebars.K;Handlebars.K.prototype=null;return obj};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:\"debug\",1:\"info\",2:\"warn\",3:\"error\"},log:function(level,obj){if(Handlebars.logger.level<=level){var method=Handlebars.logger.methodMap[level];if(typeof console!==\"undefined\"&&console[method]){console[method].call(console,obj)}}}};Handlebars.log=function(level,obj){Handlebars.logger.log(level,obj)};Handlebars.registerHelper(\"each\",function(context,options){var fn=options.fn,inverse=options.inverse;var i=0,ret=\"\",data;var type=toString.call(context);if(type===functionType){context=context.call(this)}if(options.data){data=Handlebars.createFrame(options.data)}if(context&&typeof context===\"object\"){if(context instanceof Array){for(var j=context.length;i<j;i++){if(data){data.index=i}ret=ret+fn(context[i],{data:data})}}else{for(var key in context){if(context.hasOwnProperty(key)){if(data){data.key=key}ret=ret+fn(context[key],{data:data});i++}}}}if(i===0){ret=inverse(this)}return ret});Handlebars.registerHelper(\"if\",function(conditional,options){var type=toString.call(conditional);if(type===functionType){conditional=conditional.call(this)}if(!conditional||Handlebars.Utils.isEmpty(conditional)){return options.inverse(this)}else{return options.fn(this)}});Handlebars.registerHelper(\"unless\",function(conditional,options){return Handlebars.helpers[\"if\"].call(this,conditional,{fn:options.inverse,inverse:options.fn})});Handlebars.registerHelper(\"with\",function(context,options){var type=toString.call(context);if(type===functionType){context=context.call(this)}if(!Handlebars.Utils.isEmpty(context))return options.fn(context)});Handlebars.registerHelper(\"log\",function(context,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;Handlebars.log(level,context)});var handlebars=function(){var parser={trace:function trace(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:\"error\",5:\"EOF\",14:\"CONTENT\",15:\"COMMENT\",16:\"OPEN_BLOCK\",18:\"CLOSE\",19:\"OPEN_INVERSE\",20:\"OPEN_ENDBLOCK\",22:\"OPEN\",23:\"OPEN_UNESCAPED\",24:\"CLOSE_UNESCAPED\",25:\"OPEN_PARTIAL\",31:\"STRING\",32:\"INTEGER\",33:\"BOOLEAN\",36:\"ID\",37:\"EQUALS\",38:\"DATA\",40:\"SEP\"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];break;case 2:this.$=new yy.ProgramNode([],$$[$0]);break;case 3:this.$=new yy.ProgramNode($$[$0-2],$$[$0]);break;case 4:this.$=new yy.ProgramNode($$[$0-1],[]);break;case 5:this.$=new yy.ProgramNode($$[$0]);break;case 6:this.$=new yy.ProgramNode([],[]);break;case 7:this.$=new yy.ProgramNode([]);break;case 8:this.$=[$$[$0]];break;case 9:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 10:this.$=new yy.BlockNode($$[$0-2],$$[$0-1].inverse,$$[$0-1],$$[$0]);break;case 11:this.$=new yy.BlockNode($$[$0-2],$$[$0-1],$$[$0-1].inverse,$$[$0]);break;case 12:this.$=$$[$0];break;case 13:this.$=$$[$0];break;case 14:this.$=new yy.ContentNode($$[$0]);break;case 15:this.$=new yy.CommentNode($$[$0]);break;case 16:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1]);break;case 17:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1]);break;case 18:this.$=$$[$0-1];break;case 19:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],$$[$0-2][2]===\"&\");break;case 20:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],true);break;case 21:this.$=new yy.PartialNode($$[$0-1]);break;case 22:this.$=new yy.PartialNode($$[$0-2],$$[$0-1]);break;case 23:break;case 24:this.$=[[$$[$0-2]].concat($$[$0-1]),$$[$0]];break;case 25:this.$=[[$$[$0-1]].concat($$[$0]),null];break;case 26:this.$=[[$$[$0-1]],$$[$0]];break;case 27:this.$=[[$$[$0]],null];break;case 28:this.$=[[$$[$0]],null];break;case 29:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 30:this.$=[$$[$0]];break;case 31:this.$=$$[$0];break;case 32:this.$=new yy.StringNode($$[$0]);break;case 33:this.$=new yy.IntegerNode($$[$0]);break;case 34:this.$=new yy.BooleanNode($$[$0]);break;case 35:this.$=$$[$0];break;case 36:this.$=new yy.HashNode($$[$0]);break;case 37:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 38:this.$=[$$[$0]];break;case 39:this.$=[$$[$0-2],$$[$0]];break;case 40:this.$=[$$[$0-2],new yy.StringNode($$[$0])];break;case 41:this.$=[$$[$0-2],new yy.IntegerNode($$[$0])];break;case 42:this.$=[$$[$0-2],new yy.BooleanNode($$[$0])];break;case 43:this.$=[$$[$0-2],$$[$0]];break;case 44:this.$=new yy.PartialNameNode($$[$0]);break;case 45:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0]));break;case 46:this.$=new yy.PartialNameNode(new yy.IntegerNode($$[$0]));break;case 47:this.$=new yy.DataNode($$[$0]);break;case 48:this.$=new yy.IdNode($$[$0]);break;case 49:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]});this.$=$$[$0-2];break;case 50:this.$=[{part:$$[$0]}];break}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function parseError(str,hash){throw new Error(str)},parse:function parse(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext=\"\",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc==\"undefined\")this.lexer.yylloc={};var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError===\"function\")this.parseError=this.yy.parseError;function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n}function lex(){var token;token=self.lexer.lex()||1;if(typeof token!==\"number\"){token=self.symbols_[token]||token}return token}var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state]}else{if(symbol===null||typeof symbol==\"undefined\"){symbol=lex()}action=table[state]&&table[state][symbol]}if(typeof action===\"undefined\"||!action.length||!action[0]){var errStr=\"\";if(!recovering){expected=[];for(p in table[state])if(this.terminals_[p]&&p>2){expected.push(\"'\"+this.terminals_[p]+\"'\")}if(this.lexer.showPosition){errStr=\"Parse error on line \"+(yylineno+1)+\":\\n\"+this.lexer.showPosition()+\"\\nExpecting \"+expected.join(\", \")+\", got '\"+(this.terminals_[symbol]||symbol)+\"'\"}else{errStr=\"Parse error on line \"+(yylineno+1)+\": Unexpected \"+(symbol==1?\"end of input\":\"'\"+(this.terminals_[symbol]||symbol)+\"'\")}this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1){throw new Error(\"Parse Error: multiple actions possible at state: \"+state+\", token: \"+symbol)}switch(action[0]){case 1:stack.push(symbol);vstack.push(this.lexer.yytext);lstack.push(this.lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=this.lexer.yyleng;yytext=this.lexer.yytext;yylineno=this.lexer.yylineno;yyloc=this.lexer.yylloc;if(recovering>0)recovering--}else{symbol=preErrorSymbol;preErrorSymbol=null}break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]}r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!==\"undefined\"){return r}if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len)}stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true}}return true}};var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash)}else{throw new Error(str)}},setInput:function(input){this._input=input;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match=\"\";this.conditionStack=[\"INITIAL\"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\\r\\n?|\\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return ch},unput:function(ch){var len=ch.length;var lines=ch.split(/(?:\\r\\n?|\\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len-1);this.offset-=len;var oldLines=this.match.split(/(?:\\r\\n?|\\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1)this.yylineno-=lines.length-1;var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len]}return this},more:function(){this._more=true;return this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?\"...\":\"\")+past.substr(-20).replace(/\\n/g,\"\")},upcomingInput:function(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length)}return(next.substr(0,20)+(next.length>20?\"...\":\"\")).replace(/\\n/g,\"\")},showPosition:function(){var pre=this.pastInput();var c=new Array(pre.length+1).join(\"-\");return pre+this.upcomingInput()+\"\\n\"+c+\"^\"},next:function(){if(this.done){return this.EOF}if(!this._input)this.done=true;var token,match,tempMatch,index,col,lines;if(!this._more){this.yytext=\"\";this.match=\"\"}var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(!this.options.flex)break}}if(match){lines=match[0].match(/(?:\\r\\n?|\\n).*/g);if(lines)this.yylineno+=lines.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\\r?\\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(token)return token;else return}if(this._input===\"\"){return this.EOF}else{return this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". Unrecognized text.\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})}},lex:function lex(){var r=this.next();if(typeof r!==\"undefined\"){return r}else{return this.lex()}},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){return this.conditionStack.pop()},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function begin(condition){this.begin(condition)}};lexer.options={};lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:yy_.yytext=\"\\\\\";return 14;break;case 1:if(yy_.yytext.slice(-1)!==\"\\\\\")this.begin(\"mu\");if(yy_.yytext.slice(-1)===\"\\\\\")yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-1),this.begin(\"emu\");if(yy_.yytext)return 14;break;case 2:return 14;break;case 3:if(yy_.yytext.slice(-1)!==\"\\\\\")this.popState();if(yy_.yytext.slice(-1)===\"\\\\\")yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-1);return 14;break;case 4:yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-4);this.popState();return 15;break;case 5:return 25;break;case 6:return 16;break;case 7:return 20;break;case 8:return 19;break;case 9:return 19;break;case 10:return 23;break;case 11:return 22;break;case 12:this.popState();this.begin(\"com\");break;case 13:yy_.yytext=yy_.yytext.substr(3,yy_.yyleng-5);this.popState();return 15;break;case 14:return 22;break;case 15:return 37;break;case 16:return 36;break;case 17:return 36;break;case 18:return 40;break;case 19:break;case 20:this.popState();return 24;break;case 21:this.popState();return 18;break;case 22:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2).replace(/\\\\\"/g,'\"');return 31;break;case 23:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2).replace(/\\\\'/g,\"'\");return 31;break;case 24:return 38;break;case 25:return 33;break;case 26:return 33;break;case 27:return 32;break;case 28:return 36;break;case 29:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2);return 36;break;case 30:return\"INVALID\";break;case 31:return 5;break}};lexer.rules=[/^(?:\\\\\\\\(?=(\\{\\{)))/,/^(?:[^\\x00]*?(?=(\\{\\{)))/,/^(?:[^\\x00]+)/,/^(?:[^\\x00]{2,}?(?=(\\{\\{|$)))/,/^(?:[\\s\\S]*?--\\}\\})/,/^(?:\\{\\{>)/,/^(?:\\{\\{#)/,/^(?:\\{\\{\\/)/,/^(?:\\{\\{\\^)/,/^(?:\\{\\{\\s*else\\b)/,/^(?:\\{\\{\\{)/,/^(?:\\{\\{&)/,/^(?:\\{\\{!--)/,/^(?:\\{\\{![\\s\\S]*?\\}\\})/,/^(?:\\{\\{)/,/^(?:=)/,/^(?:\\.(?=[}\\/ ]))/,/^(?:\\.\\.)/,/^(?:[\\/.])/,/^(?:\\s+)/,/^(?:\\}\\}\\})/,/^(?:\\}\\})/,/^(?:\"(\\\\[\"]|[^\"])*\")/,/^(?:'(\\\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\\s]))/,/^(?:false(?=[}\\s]))/,/^(?:-?[0-9]+(?=[}\\s]))/,/^(?:[^\\s!\"#%-,\\.\\/;->@\\[-\\^`\\{-~]+(?=[=}\\s\\/.]))/,/^(?:\\[[^\\]]*\\])/,/^(?:.)/,/^(?:$)/];lexer.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:false},emu:{rules:[3],inclusive:false},com:{rules:[4],inclusive:false},INITIAL:{rules:[0,1,2,31],inclusive:true}};return lexer}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();Handlebars.Parser=handlebars;Handlebars.parse=function(input){if(input.constructor===Handlebars.AST.ProgramNode){return input}Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(input)};Handlebars.AST={};Handlebars.AST.ProgramNode=function(statements,inverse){this.type=\"program\";this.statements=statements;if(inverse){this.inverse=new Handlebars.AST.ProgramNode(inverse)}};Handlebars.AST.MustacheNode=function(rawParams,hash,unescaped){this.type=\"mustache\";this.escaped=!unescaped;this.hash=hash;var id=this.id=rawParams[0];var params=this.params=rawParams.slice(1);var eligibleHelper=this.eligibleHelper=id.isSimple;this.isHelper=eligibleHelper&&(params.length||hash)};Handlebars.AST.PartialNode=function(partialName,context){this.type=\"partial\";this.partialName=partialName;this.context=context};Handlebars.AST.BlockNode=function(mustache,program,inverse,close){var verifyMatch=function(open,close){if(open.original!==close.original){throw new Handlebars.Exception(open.original+\" doesn't match \"+close.original)}};verifyMatch(mustache.id,close);this.type=\"block\";this.mustache=mustache;this.program=program;this.inverse=inverse;if(this.inverse&&!this.program){this.isInverse=true}};Handlebars.AST.ContentNode=function(string){this.type=\"content\";this.string=string};Handlebars.AST.HashNode=function(pairs){this.type=\"hash\";this.pairs=pairs};Handlebars.AST.IdNode=function(parts){this.type=\"ID\";var original=\"\",dig=[],depth=0;for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part;original+=(parts[i].separator||\"\")+part;if(part===\"..\"||part===\".\"||part===\"this\"){if(dig.length>0){throw new Handlebars.Exception(\"Invalid path: \"+original)}else if(part===\"..\"){depth++}else{this.isScoped=true}}else{dig.push(part)}}this.original=original;this.parts=dig;this.string=dig.join(\".\");this.depth=depth;this.isSimple=parts.length===1&&!this.isScoped&&depth===0;this.stringModeValue=this.string};Handlebars.AST.PartialNameNode=function(name){this.type=\"PARTIAL_NAME\";this.name=name.original};Handlebars.AST.DataNode=function(id){this.type=\"DATA\";this.id=id};Handlebars.AST.StringNode=function(string){this.type=\"STRING\";this.original=this.string=this.stringModeValue=string};Handlebars.AST.IntegerNode=function(integer){this.type=\"INTEGER\";this.original=this.integer=integer;this.stringModeValue=Number(integer)};Handlebars.AST.BooleanNode=function(bool){this.type=\"BOOLEAN\";this.bool=bool;this.stringModeValue=bool===\"true\"};Handlebars.AST.CommentNode=function(comment){this.type=\"comment\";this.comment=comment};var errorProps=[\"description\",\"fileName\",\"lineNumber\",\"message\",\"name\",\"number\",\"stack\"];Handlebars.Exception=function(message){var tmp=Error.prototype.constructor.apply(this,arguments);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]]}};Handlebars.Exception.prototype=new Error;Handlebars.SafeString=function(string){this.string=string};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};var escape={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"};var badChars=/[&<>\"'`]/g;var possible=/[&<>\"'`]/;var escapeChar=function(chr){return escape[chr]||\"&amp;\"};Handlebars.Utils={extend:function(obj,value){for(var key in value){if(value.hasOwnProperty(key)){obj[key]=value[key]}}},escapeExpression:function(string){if(string instanceof Handlebars.SafeString){return string.toString()}else if(string==null||string===false){return\"\"}string=string.toString();if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)},isEmpty:function(value){if(!value&&value!==0){return true}else if(toString.call(value)===\"[object Array]\"&&value.length===0){return true}else{return false}}};var Compiler=Handlebars.Compiler=function(){};var JavaScriptCompiler=Handlebars.JavaScriptCompiler=function(){};Compiler.prototype={compiler:Compiler,disassemble:function(){var opcodes=this.opcodes,opcode,out=[],params,param;for(var i=0,l=opcodes.length;i<l;i++){opcode=opcodes[i];if(opcode.opcode===\"DECLARE\"){out.push(\"DECLARE \"+opcode.name+\"=\"+opcode.value)}else{params=[];for(var j=0;j<opcode.args.length;j++){param=opcode.args[j];if(typeof param===\"string\"){param='\"'+param.replace(\"\\n\",\"\\\\n\")+'\"'}params.push(param)}out.push(opcode.opcode+\" \"+params.join(\" \"))}}return out.join(\"\\n\")},equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len){return false}for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||opcode.args.length!==otherOpcode.args.length){return false}for(var j=0;j<opcode.args.length;j++){if(opcode.args[j]!==otherOpcode.args[j]){return false}}}len=this.children.length;if(other.children.length!==len){return false}for(i=0;i<len;i++){if(!this.children[i].equals(other.children[i])){return false}}return true},guid:0,compile:function(program,options){this.children=[];this.depths={list:[]};this.options=options;var knownHelpers=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,\"if\":true,unless:true,\"with\":true,log:true};if(knownHelpers){for(var name in knownHelpers){this.options.knownHelpers[name]=knownHelpers[name]}}return this.program(program)},accept:function(node){return this[node.type](node)},program:function(program){var statements=program.statements,statement;this.opcodes=[];for(var i=0,l=statements.length;i<l;i++){statement=statements[i];this[statement.type](statement)}this.isSimple=l===1;this.depths.list=this.depths.list.sort(function(a,b){return a-b});return this},compileProgram:function(program){var result=(new this.compiler).compile(program,this.options);var guid=this.guid++,depth;this.usePartial=this.usePartial||result.usePartial;this.children[guid]=result;for(var i=0,l=result.depths.list.length;i<l;i++){depth=result.depths.list[i];if(depth<2){continue}else{this.addDepth(depth-1)}}return guid},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;if(program){program=this.compileProgram(program)}if(inverse){inverse=this.compileProgram(inverse)}var type=this.classifyMustache(mustache);if(type===\"helper\"){this.helperMustache(mustache,program,inverse)}else if(type===\"simple\"){this.simpleMustache(mustache);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"emptyHash\");this.opcode(\"blockValue\")}else{this.ambiguousMustache(mustache,program,inverse);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"emptyHash\");this.opcode(\"ambiguousBlockValue\")}this.opcode(\"append\")},hash:function(hash){var pairs=hash.pairs,pair,val;this.opcode(\"pushHash\");for(var i=0,l=pairs.length;i<l;i++){pair=pairs[i];val=pair[1];if(this.options.stringParams){if(val.depth){this.addDepth(val.depth)}this.opcode(\"getContext\",val.depth||0);this.opcode(\"pushStringParam\",val.stringModeValue,val.type)}else{this.accept(val)}this.opcode(\"assignToHash\",pair[0])}this.opcode(\"popHash\")},partial:function(partial){var partialName=partial.partialName;this.usePartial=true;if(partial.context){this.ID(partial.context)}else{this.opcode(\"push\",\"depth0\")}this.opcode(\"invokePartial\",partialName.name);this.opcode(\"append\")},content:function(content){this.opcode(\"appendContent\",content.string)},mustache:function(mustache){var options=this.options;var type=this.classifyMustache(mustache);if(type===\"simple\"){this.simpleMustache(mustache)}else if(type===\"helper\"){this.helperMustache(mustache)}else{this.ambiguousMustache(mustache)}if(mustache.escaped&&!options.noEscape){this.opcode(\"appendEscaped\")}else{this.opcode(\"append\")}},ambiguousMustache:function(mustache,program,inverse){var id=mustache.id,name=id.parts[0],isBlock=program!=null||inverse!=null;this.opcode(\"getContext\",id.depth);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"invokeAmbiguous\",name,isBlock)},simpleMustache:function(mustache){var id=mustache.id;if(id.type===\"DATA\"){this.DATA(id)}else if(id.parts.length){this.ID(id)}else{this.addDepth(id.depth);this.opcode(\"getContext\",id.depth);this.opcode(\"pushContext\")}this.opcode(\"resolvePossibleLambda\")},helperMustache:function(mustache,program,inverse){var params=this.setupFullMustacheParams(mustache,program,inverse),name=mustache.id.parts[0];if(this.options.knownHelpers[name]){this.opcode(\"invokeKnownHelper\",params.length,name)}else if(this.options.knownHelpersOnly){throw new Error(\"You specified knownHelpersOnly, but used the unknown helper \"+name)}else{this.opcode(\"invokeHelper\",params.length,name)}},ID:function(id){this.addDepth(id.depth);this.opcode(\"getContext\",id.depth);var name=id.parts[0];if(!name){this.opcode(\"pushContext\")}else{this.opcode(\"lookupOnContext\",id.parts[0])}for(var i=1,l=id.parts.length;i<l;i++){this.opcode(\"lookup\",id.parts[i])}},DATA:function(data){this.options.data=true;if(data.id.isScoped||data.id.depth){throw new Handlebars.Exception(\"Scoped data references are not supported: \"+data.original)}this.opcode(\"lookupData\");var parts=data.id.parts;for(var i=0,l=parts.length;i<l;i++){this.opcode(\"lookup\",parts[i])}},STRING:function(string){this.opcode(\"pushString\",string.string)},INTEGER:function(integer){this.opcode(\"pushLiteral\",integer.integer)},BOOLEAN:function(bool){this.opcode(\"pushLiteral\",bool.bool)},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:[].slice.call(arguments,1)})},declare:function(name,value){this.opcodes.push({opcode:\"DECLARE\",name:name,value:value})},addDepth:function(depth){if(isNaN(depth)){throw new Error(\"EWOT\")}if(depth===0){return}if(!this.depths[depth]){this.depths[depth]=true;this.depths.list.push(depth)}},classifyMustache:function(mustache){var isHelper=mustache.isHelper;var isEligible=mustache.eligibleHelper;var options=this.options;if(isEligible&&!isHelper){var name=mustache.id.parts[0];if(options.knownHelpers[name]){isHelper=true}else if(options.knownHelpersOnly){isEligible=false}}if(isHelper){return\"helper\"}else if(isEligible){return\"ambiguous\"}else{return\"simple\"}},pushParams:function(params){var i=params.length,param;while(i--){param=params[i];if(this.options.stringParams){if(param.depth){this.addDepth(param.depth)}this.opcode(\"getContext\",param.depth||0);this.opcode(\"pushStringParam\",param.stringModeValue,param.type)}else{this[param.type](param)}}},setupMustacheParams:function(mustache){var params=mustache.params;this.pushParams(params);if(mustache.hash){this.hash(mustache.hash)}else{this.opcode(\"emptyHash\")}return params},setupFullMustacheParams:function(mustache,program,inverse){var params=mustache.params;this.pushParams(params);this.opcode(\"pushProgram\",program);\nthis.opcode(\"pushProgram\",inverse);if(mustache.hash){this.hash(mustache.hash)}else{this.opcode(\"emptyHash\")}return params}};var Literal=function(value){this.value=value};JavaScriptCompiler.prototype={nameLookup:function(parent,name){if(/^[0-9]+$/.test(name)){return parent+\"[\"+name+\"]\"}else if(JavaScriptCompiler.isValidJavaScriptVariableName(name)){return parent+\".\"+name}else{return parent+\"['\"+name+\"']\"}},appendToBuffer:function(string){if(this.environment.isSimple){return\"return \"+string+\";\"}else{return{appendToBuffer:true,content:string,toString:function(){return\"buffer += \"+string+\";\"}}}},initializeBuffer:function(){return this.quotedString(\"\")},namespace:\"Handlebars\",compile:function(environment,options,context,asObject){this.environment=environment;this.options=options||{};Handlebars.log(Handlebars.logger.DEBUG,this.environment.disassemble()+\"\\n\\n\");this.name=this.environment.name;this.isChild=!!context;this.context=context||{programs:[],environments:[],aliases:{}};this.preamble();this.stackSlot=0;this.stackVars=[];this.registers={list:[]};this.compileStack=[];this.inlineStack=[];this.compileChildren(environment,options);var opcodes=environment.opcodes,opcode;this.i=0;for(l=opcodes.length;this.i<l;this.i++){opcode=opcodes[this.i];if(opcode.opcode===\"DECLARE\"){this[opcode.name]=opcode.value}else{this[opcode.opcode].apply(this,opcode.args)}}return this.createFunctionContext(asObject)},nextOpcode:function(){var opcodes=this.environment.opcodes;return opcodes[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var out=[];if(!this.isChild){var namespace=this.namespace;var copies=\"helpers = this.merge(helpers, \"+namespace+\".helpers);\";if(this.environment.usePartial){copies=copies+\" partials = this.merge(partials, \"+namespace+\".partials);\"}if(this.options.data){copies=copies+\" data = data || {};\"}out.push(copies)}else{out.push(\"\")}if(!this.environment.isSimple){out.push(\", buffer = \"+this.initializeBuffer())}else{out.push(\"\")}this.lastContext=0;this.source=out},createFunctionContext:function(asObject){var locals=this.stackVars.concat(this.registers.list);if(locals.length>0){this.source[1]=this.source[1]+\", \"+locals.join(\", \")}if(!this.isChild){for(var alias in this.context.aliases){if(this.context.aliases.hasOwnProperty(alias)){this.source[1]=this.source[1]+\", \"+alias+\"=\"+this.context.aliases[alias]}}}if(this.source[1]){this.source[1]=\"var \"+this.source[1].substring(2)+\";\"}if(!this.isChild){this.source[1]+=\"\\n\"+this.context.programs.join(\"\\n\")+\"\\n\"}if(!this.environment.isSimple){this.source.push(\"return buffer;\")}var params=this.isChild?[\"depth0\",\"data\"]:[\"Handlebars\",\"depth0\",\"helpers\",\"partials\",\"data\"];for(var i=0,l=this.environment.depths.list.length;i<l;i++){params.push(\"depth\"+this.environment.depths.list[i])}var source=this.mergeSource();if(!this.isChild){var revision=Handlebars.COMPILER_REVISION,versions=Handlebars.REVISION_CHANGES[revision];source=\"this.compilerInfo = [\"+revision+\",'\"+versions+\"'];\\n\"+source}if(asObject){params.push(source);return Function.apply(this,params)}else{var functionSource=\"function \"+(this.name||\"\")+\"(\"+params.join(\",\")+\") {\\n  \"+source+\"}\";Handlebars.log(Handlebars.logger.DEBUG,functionSource+\"\\n\\n\");return functionSource}},mergeSource:function(){var source=\"\",buffer;for(var i=0,len=this.source.length;i<len;i++){var line=this.source[i];if(line.appendToBuffer){if(buffer){buffer=buffer+\"\\n    + \"+line.content}else{buffer=line.content}}else{if(buffer){source+=\"buffer += \"+buffer+\";\\n  \";buffer=undefined}source+=line+\"\\n  \"}}return source},blockValue:function(){this.context.aliases.blockHelperMissing=\"helpers.blockHelperMissing\";var params=[\"depth0\"];this.setupParams(0,params);this.replaceStack(function(current){params.splice(1,0,current);return\"blockHelperMissing.call(\"+params.join(\", \")+\")\"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing=\"helpers.blockHelperMissing\";var params=[\"depth0\"];this.setupParams(0,params);var current=this.topStack();params.splice(1,0,current);params[params.length-1]=\"options\";this.source.push(\"if (!\"+this.lastHelper+\") { \"+current+\" = blockHelperMissing.call(\"+params.join(\", \")+\"); }\")},appendContent:function(content){this.source.push(this.appendToBuffer(this.quotedString(content)))},append:function(){this.flushInline();var local=this.popStack();this.source.push(\"if(\"+local+\" || \"+local+\" === 0) { \"+this.appendToBuffer(local)+\" }\");if(this.environment.isSimple){this.source.push(\"else { \"+this.appendToBuffer(\"''\")+\" }\")}},appendEscaped:function(){this.context.aliases.escapeExpression=\"this.escapeExpression\";this.source.push(this.appendToBuffer(\"escapeExpression(\"+this.popStack()+\")\"))},getContext:function(depth){if(this.lastContext!==depth){this.lastContext=depth}},lookupOnContext:function(name){this.push(this.nameLookup(\"depth\"+this.lastContext,name,\"context\"))},pushContext:function(){this.pushStackLiteral(\"depth\"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='\"function\"';this.replaceStack(function(current){return\"typeof \"+current+\" === functionType ? \"+current+\".apply(depth0) : \"+current})},lookup:function(name){this.replaceStack(function(current){return current+\" == null || \"+current+\" === false ? \"+current+\" : \"+this.nameLookup(current,name,\"context\")})},lookupData:function(id){this.push(\"data\")},pushStringParam:function(string,type){this.pushStackLiteral(\"depth\"+this.lastContext);this.pushString(type);if(typeof string===\"string\"){this.pushString(string)}else{this.pushStackLiteral(string)}},emptyHash:function(){this.pushStackLiteral(\"{}\");if(this.options.stringParams){this.register(\"hashTypes\",\"{}\");this.register(\"hashContexts\",\"{}\")}},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var hash=this.hash;this.hash=undefined;if(this.options.stringParams){this.register(\"hashContexts\",\"{\"+hash.contexts.join(\",\")+\"}\");this.register(\"hashTypes\",\"{\"+hash.types.join(\",\")+\"}\")}this.push(\"{\\n    \"+hash.values.join(\",\\n    \")+\"\\n  }\")},pushString:function(string){this.pushStackLiteral(this.quotedString(string))},push:function(expr){this.inlineStack.push(expr);return expr},pushLiteral:function(value){this.pushStackLiteral(value)},pushProgram:function(guid){if(guid!=null){this.pushStackLiteral(this.programExpression(guid))}else{this.pushStackLiteral(null)}},invokeHelper:function(paramSize,name){this.context.aliases.helperMissing=\"helpers.helperMissing\";var helper=this.lastHelper=this.setupHelper(paramSize,name,true);var nonHelper=this.nameLookup(\"depth\"+this.lastContext,name,\"context\");this.push(helper.name+\" || \"+nonHelper);this.replaceStack(function(name){return name+\" ? \"+name+\".call(\"+helper.callParams+\") \"+\": helperMissing.call(\"+helper.helperMissingParams+\")\"})},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+\".call(\"+helper.callParams+\")\")},invokeAmbiguous:function(name,helperCall){this.context.aliases.functionType='\"function\"';this.pushStackLiteral(\"{}\");var helper=this.setupHelper(0,name,helperCall);var helperName=this.lastHelper=this.nameLookup(\"helpers\",name,\"helper\");var nonHelper=this.nameLookup(\"depth\"+this.lastContext,name,\"context\");var nextStack=this.nextStack();this.source.push(\"if (\"+nextStack+\" = \"+helperName+\") { \"+nextStack+\" = \"+nextStack+\".call(\"+helper.callParams+\"); }\");this.source.push(\"else { \"+nextStack+\" = \"+nonHelper+\"; \"+nextStack+\" = typeof \"+nextStack+\" === functionType ? \"+nextStack+\".apply(depth0) : \"+nextStack+\"; }\")},invokePartial:function(name){var params=[this.nameLookup(\"partials\",name,\"partial\"),\"'\"+name+\"'\",this.popStack(),\"helpers\",\"partials\"];if(this.options.data){params.push(\"data\")}this.context.aliases.self=\"this\";this.push(\"self.invokePartial(\"+params.join(\", \")+\")\")},assignToHash:function(key){var value=this.popStack(),context,type;if(this.options.stringParams){type=this.popStack();context=this.popStack()}var hash=this.hash;if(context){hash.contexts.push(\"'\"+key+\"': \"+context)}if(type){hash.types.push(\"'\"+key+\"': \"+type)}hash.values.push(\"'\"+key+\"': (\"+value+\")\")},compiler:JavaScriptCompiler,compileChildren:function(environment,options){var children=environment.children,child,compiler;for(var i=0,l=children.length;i<l;i++){child=children[i];compiler=new this.compiler;var index=this.matchExistingProgram(child);if(index==null){this.context.programs.push(\"\");index=this.context.programs.length;child.index=index;child.name=\"program\"+index;this.context.programs[index]=compiler.compile(child,options,this.context);this.context.environments[index]=child}else{child.index=index;child.name=\"program\"+index}}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child)){return i}}},programExpression:function(guid){this.context.aliases.self=\"this\";if(guid==null){return\"self.noop\"}var child=this.environment.children[guid],depths=child.depths.list,depth;var programParams=[child.index,child.name,\"data\"];for(var i=0,l=depths.length;i<l;i++){depth=depths[i];if(depth===1){programParams.push(\"depth0\")}else{programParams.push(\"depth\"+(depth-1))}}return(depths.length===0?\"self.program(\":\"self.programWithDepth(\")+programParams.join(\", \")+\")\"},register:function(name,val){this.useRegister(name);this.source.push(name+\" = \"+val+\";\")},useRegister:function(name){if(!this.registers[name]){this.registers[name]=true;this.registers.list.push(name)}},pushStackLiteral:function(item){return this.push(new Literal(item))},pushStack:function(item){this.flushInline();var stack=this.incrStack();if(item){this.source.push(stack+\" = \"+item+\";\")}this.compileStack.push(stack);return stack},replaceStack:function(callback){var prefix=\"\",inline=this.isInline(),stack;if(inline){var top=this.popStack(true);if(top instanceof Literal){stack=top.value}else{var name=this.stackSlot?this.topStackName():this.incrStack();prefix=\"(\"+this.push(name)+\" = \"+top+\"),\";stack=this.topStack()}}else{stack=this.topStack()}var item=callback.call(this,stack);if(inline){if(this.inlineStack.length||this.compileStack.length){this.popStack()}this.push(\"(\"+prefix+item+\")\")}else{if(!/^stack/.test(stack)){stack=this.nextStack()}this.source.push(stack+\" = (\"+prefix+item+\");\")}return stack},nextStack:function(){return this.pushStack()},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push(\"stack\"+this.stackSlot)}return this.topStackName()},topStackName:function(){return\"stack\"+this.stackSlot},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];if(entry instanceof Literal){this.compileStack.push(entry)}else{this.pushStack(entry)}}}},isInline:function(){return this.inlineStack.length},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal){return item.value}else{if(!inline){this.stackSlot--}return item}},topStack:function(wrapped){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];if(!wrapped&&item instanceof Literal){return item.value}else{return item}},quotedString:function(str){return'\"'+str.replace(/\\\\/g,\"\\\\\\\\\").replace(/\"/g,'\\\\\"').replace(/\\n/g,\"\\\\n\").replace(/\\r/g,\"\\\\r\").replace(/\\u2028/g,\"\\\\u2028\").replace(/\\u2029/g,\"\\\\u2029\")+'\"'},setupHelper:function(paramSize,name,missingParams){var params=[];this.setupParams(paramSize,params,missingParams);var foundHelper=this.nameLookup(\"helpers\",name,\"helper\");return{params:params,name:foundHelper,callParams:[\"depth0\"].concat(params).join(\", \"),helperMissingParams:missingParams&&[\"depth0\",this.quotedString(name)].concat(params).join(\", \")}},setupParams:function(paramSize,params,useRegister){var options=[],contexts=[],types=[],param,inverse,program;options.push(\"hash:\"+this.popStack());inverse=this.popStack();program=this.popStack();if(program||inverse){if(!program){this.context.aliases.self=\"this\";program=\"self.noop\"}if(!inverse){this.context.aliases.self=\"this\";inverse=\"self.noop\"}options.push(\"inverse:\"+inverse);options.push(\"fn:\"+program)}for(var i=0;i<paramSize;i++){param=this.popStack();params.push(param);if(this.options.stringParams){types.push(this.popStack());contexts.push(this.popStack())}}if(this.options.stringParams){options.push(\"contexts:[\"+contexts.join(\",\")+\"]\");options.push(\"types:[\"+types.join(\",\")+\"]\");options.push(\"hashContexts:hashContexts\");options.push(\"hashTypes:hashTypes\")}if(this.options.data){options.push(\"data:data\")}options=\"{\"+options.join(\",\")+\"}\";if(useRegister){this.register(\"options\",options);params.push(\"options\")}else{params.push(options)}return params.join(\", \")}};var reservedWords=(\"break else new var\"+\" case finally return void\"+\" catch for switch while\"+\" continue function this with\"+\" default if throw\"+\" delete in try\"+\" do instanceof typeof\"+\" abstract enum int short\"+\" boolean export interface static\"+\" byte extends long super\"+\" char final native synchronized\"+\" class float package throws\"+\" const goto private transient\"+\" debugger implements protected volatile\"+\" double import public let yield\").split(\" \");var compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++){compilerWords[reservedWords[i]]=true}JavaScriptCompiler.isValidJavaScriptVariableName=function(name){if(!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(name)){return true}return false};Handlebars.precompile=function(input,options){if(input==null||typeof input!==\"string\"&&input.constructor!==Handlebars.AST.ProgramNode){throw new Handlebars.Exception(\"You must pass a string or Handlebars AST to Handlebars.precompile. You passed \"+input)}options=options||{};if(!(\"data\"in options)){options.data=true}var ast=Handlebars.parse(input);var environment=(new Compiler).compile(ast,options);return(new JavaScriptCompiler).compile(environment,options)};Handlebars.compile=function(input,options){if(input==null||typeof input!==\"string\"&&input.constructor!==Handlebars.AST.ProgramNode){throw new Handlebars.Exception(\"You must pass a string or Handlebars AST to Handlebars.compile. You passed \"+input)}options=options||{};if(!(\"data\"in options)){options.data=true}var compiled;function compile(){var ast=Handlebars.parse(input);var environment=(new Compiler).compile(ast,options);var templateSpec=(new JavaScriptCompiler).compile(environment,options,undefined,true);return Handlebars.template(templateSpec)}return function(context,options){if(!compiled){compiled=compile()}return compiled.call(this,context,options)}};Handlebars.VM={template:function(templateSpec){var container={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(i,fn,data){var programWrapper=this.programs[i];if(data){programWrapper=Handlebars.VM.program(i,fn,data)}else if(!programWrapper){programWrapper=this.programs[i]=Handlebars.VM.program(i,fn)}return programWrapper},merge:function(param,common){var ret=param||common;if(param&&common){ret={};Handlebars.Utils.extend(ret,common);Handlebars.Utils.extend(ret,param)}return ret},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop,compilerInfo:null};return function(context,options){options=options||{};var result=templateSpec.call(container,Handlebars,context,options.helpers,options.partials,options.data);var compilerInfo=container.compilerInfo||[],compilerRevision=compilerInfo[0]||1,currentRevision=Handlebars.COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=Handlebars.REVISION_CHANGES[currentRevision],compilerVersions=Handlebars.REVISION_CHANGES[compilerRevision];throw\"Template was precompiled with an older version of Handlebars than the current runtime. \"+\"Please update your precompiler to a newer version (\"+runtimeVersions+\") or downgrade your runtime to an older version (\"+compilerVersions+\").\"}else{throw\"Template was precompiled with a newer version of Handlebars than the current runtime. \"+\"Please update your runtime to a newer version (\"+compilerInfo[1]+\").\"}}return result}},programWithDepth:function(i,fn,data){var args=Array.prototype.slice.call(arguments,3);var program=function(context,options){options=options||{};return fn.apply(this,[context,options.data||data].concat(args))};program.program=i;program.depth=args.length;return program},program:function(i,fn,data){var program=function(context,options){options=options||{};return fn(context,options.data||data)};program.program=i;program.depth=0;return program},noop:function(){return\"\"},invokePartial:function(partial,name,context,helpers,partials,data){var options={helpers:helpers,partials:partials,data:data};if(partial===undefined){throw new Handlebars.Exception(\"The partial \"+name+\" could not be found\")}else if(partial instanceof Function){return partial(context,options)}else if(!Handlebars.compile){throw new Handlebars.Exception(\"The partial \"+name+\" could not be compiled when running in runtime-only mode\")}else{partials[name]=Handlebars.compile(partial,{data:data!==undefined});return partials[name](context,options)}}};Handlebars.template=Handlebars.VM.template})(Handlebars);function printStackTrace(options){options=options||{guess:true};var ex=options.e||null,guess=!!options.guess;var p=new printStackTrace.implementation,result=p.run(ex);return guess?p.guessAnonymousFunctions(result):result}if(typeof module!==\"undefined\"&&module.exports){module.exports=printStackTrace}printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(ex,mode){ex=ex||this.createException();mode=mode||this.mode(ex);if(mode===\"other\"){return this.other(arguments.callee)}else{return this[mode](ex)}},createException:function(){try{this.undef()}catch(e){return e}},mode:function(e){if(e[\"arguments\"]&&e.stack){return\"chrome\"}else if(e.stack&&e.sourceURL){return\"safari\"}else if(e.stack&&e.number){return\"ie\"}else if(typeof e.message===\"string\"&&typeof window!==\"undefined\"&&window.opera){if(!e.stacktrace){return\"opera9\"}if(e.message.indexOf(\"\\n\")>-1&&e.message.split(\"\\n\").length>e.stacktrace.split(\"\\n\").length){return\"opera9\"}if(!e.stack){return\"opera10a\"}if(e.stacktrace.indexOf(\"called from line\")<0){return\"opera10b\"}return\"opera11\"}else if(e.stack&&!e.fileName){return\"chrome\"}else if(e.stack){return\"firefox\"}return\"other\"},instrumentFunction:function(context,functionName,callback){context=context||window;var original=context[functionName];context[functionName]=function instrumented(){callback.call(this,printStackTrace().slice(4));return context[functionName]._instrumented.apply(this,arguments)};context[functionName]._instrumented=original},deinstrumentFunction:function(context,functionName){if(context[functionName].constructor===Function&&context[functionName]._instrumented&&context[functionName]._instrumented.constructor===Function){context[functionName]=context[functionName]._instrumented}},chrome:function(e){var stack=(e.stack+\"\\n\").replace(/^\\S[^\\(]+?[\\n$]/gm,\"\").replace(/^\\s+(at eval )?at\\s+/gm,\"\").replace(/^([^\\(]+?)([\\n$])/gm,\"{anonymous}()@$1$2\").replace(/^Object.<anonymous>\\s*\\(([^\\)]+)\\)/gm,\"{anonymous}()@$1\").split(\"\\n\");stack.pop();return stack},safari:function(e){return e.stack.replace(/\\[native code\\]\\n/m,\"\").replace(/^(?=\\w+Error\\:).*$\\n/m,\"\").replace(/^@/gm,\"{anonymous}()@\").split(\"\\n\")},ie:function(e){var lineRE=/^.*at (\\w+) \\(([^\\)]+)\\)$/gm;return e.stack.replace(/at Anonymous function /gm,\"{anonymous}()@\").replace(/^(?=\\w+Error\\:).*$\\n/m,\"\").replace(lineRE,\"$1@$2\").split(\"\\n\")},firefox:function(e){return e.stack.replace(/(?:\\n@:0)?\\s+$/m,\"\").replace(/^[\\(@]/gm,\"{anonymous}()@\").split(\"\\n\")},opera11:function(e){var ANON=\"{anonymous}\",lineRE=/^.*line (\\d+), column (\\d+)(?: in (.+))? in (\\S+):$/;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var location=match[4]+\":\"+match[1]+\":\"+match[2];var fnName=match[3]||\"global code\";fnName=fnName.replace(/<anonymous function: (\\S+)>/,\"$1\").replace(/<anonymous function>/,ANON);result.push(fnName+\"@\"+location+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},opera10b:function(e){var lineRE=/^(.*)@(.+):(\\d+)$/;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i++){var match=lineRE.exec(lines[i]);if(match){var fnName=match[1]?match[1]+\"()\":\"global code\";result.push(fnName+\"@\"+match[2]+\":\"+match[3])}}return result},opera10a:function(e){var ANON=\"{anonymous}\",lineRE=/Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var fnName=match[3]||ANON;result.push(fnName+\"()@\"+match[2]+\":\"+match[1]+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},opera9:function(e){var ANON=\"{anonymous}\",lineRE=/Line (\\d+).*script (?:in )?(\\S+)/i;var lines=e.message.split(\"\\n\"),result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(ANON+\"()@\"+match[2]+\":\"+match[1]+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},other:function(curr){var ANON=\"{anonymous}\",fnRE=/function\\s*([\\w\\-$]+)?\\s*\\(/i,stack=[],fn,args,maxStackSize=10;while(curr&&curr[\"arguments\"]&&stack.length<maxStackSize){fn=fnRE.test(curr.toString())?RegExp.$1||ANON:ANON;args=Array.prototype.slice.call(curr[\"arguments\"]||[]);stack[stack.length]=fn+\"(\"+this.stringifyArguments(args)+\")\";curr=curr.caller}return stack},stringifyArguments:function(args){var result=[];var slice=Array.prototype.slice;for(var i=0;i<args.length;++i){var arg=args[i];if(arg===undefined){result[i]=\"undefined\"}else if(arg===null){result[i]=\"null\"}else if(arg.constructor){if(arg.constructor===Array){if(arg.length<3){result[i]=\"[\"+this.stringifyArguments(arg)+\"]\"}else{result[i]=\"[\"+this.stringifyArguments(slice.call(arg,0,1))+\"...\"+this.stringifyArguments(slice.call(arg,-1))+\"]\"}}else if(arg.constructor===Object){result[i]=\"#object\"}else if(arg.constructor===Function){result[i]=\"#function\"}else if(arg.constructor===String){result[i]='\"'+arg+'\"'}else if(arg.constructor===Number){result[i]=arg}}}return result.join(\",\")},sourceCache:{},ajax:function(url){var req=this.createXMLHTTPObject();if(req){try{req.open(\"GET\",url,false);req.send(null);return req.responseText}catch(e){}}return\"\"},createXMLHTTPObject:function(){var xmlhttp,XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject(\"Msxml2.XMLHTTP\")},function(){return new ActiveXObject(\"Msxml3.XMLHTTP\")},function(){return new ActiveXObject(\"Microsoft.XMLHTTP\")}];for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]();this.createXMLHTTPObject=XMLHttpFactories[i];return xmlhttp}catch(e){}}},isSameDomain:function(url){return typeof location!==\"undefined\"&&url.indexOf(location.hostname)!==-1},getSource:function(url){if(!(url in this.sourceCache)){this.sourceCache[url]=this.ajax(url).split(\"\\n\")}return this.sourceCache[url]},guessAnonymousFunctions:function(stack){for(var i=0;i<stack.length;++i){var reStack=/\\{anonymous\\}\\(.*\\)@(.*)/,reRef=/^(.*?)(?::(\\d+))(?::(\\d+))?(?: -- .+)?$/,frame=stack[i],ref=reStack.exec(frame);if(ref){var m=reRef.exec(ref[1]);if(m){var file=m[1],lineno=m[2],charno=m[3]||0;if(file&&this.isSameDomain(file)&&lineno){var functionName=this.guessAnonymousFunction(file,lineno,charno);stack[i]=frame.replace(\"{anonymous}\",functionName)}}}}return stack},guessAnonymousFunction:function(url,lineNo,charNo){var ret;try{ret=this.findFunctionName(this.getSource(url),lineNo)}catch(e){ret=\"getSource failed with url: \"+url+\", exception: \"+e.toString()}return ret},findFunctionName:function(source,lineNo){var reFunctionDeclaration=/function\\s+([^(]*?)\\s*\\(([^)]*)\\)/;var reFunctionExpression=/['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*function\\b/;var reFunctionEvaluation=/['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*(?:eval|new Function)\\b/;var code=\"\",line,maxLines=Math.min(lineNo,20),m,commentPos;for(var i=0;i<maxLines;++i){line=source[lineNo-i-1];commentPos=line.indexOf(\"//\");if(commentPos>=0){line=line.substr(0,commentPos)}if(line){code=line+code;m=reFunctionExpression.exec(code);if(m&&m[1]){return m[1]}m=reFunctionDeclaration.exec(code);if(m&&m[1]){return m[1]}m=reFunctionEvaluation.exec(code);if(m&&m[1]){return m[1]}}}return\"(?)\"}};if(!window.maxkir)maxkir={};maxkir.SelectionRange=function(element){this.element=element};maxkir.SelectionRange.prototype.get_selection_range=function(){var get_sel_range=function(element){if(typeof element.selectionStart==\"undefined\"&&document.selection){var range=document.selection.createRange();var stored_range=range.duplicate();if(element.type==\"text\"){stored_range.moveStart(\"character\",-element.value.length);stored_range.moveEnd(\"character\",element.value.length)}else{stored_range.moveToElementText(element)}stored_range.setEndPoint(\"EndToEnd\",range);var selectionStart=stored_range.text.length-range.text.length;var selectionEnd=selectionStart+range.text.length;return[selectionStart,selectionEnd]}return[element.selectionStart,element.selectionEnd]};try{return get_sel_range(this.element)}catch(e){return[0,0]}};maxkir.SelectionRange.prototype.get_selection_text=function(){var r=this.get_selection_range();return this.element.value.substring(r[0],r[1])};if(!window.maxkir)maxkir={};maxkir.StringSplitter=function(width_provider_function){this.get_width=width_provider_function};maxkir.StringSplitter.prototype.splitString=function(s,max_width){if(s.length==0)return[\"\"];var prev_space_pos=-1;var width_exceeded=false;var that=this;var cut_off=function(idx){var remaining=s.substr(idx+1);if(remaining.length>0){return[s.substr(0,idx+1)].concat(that.splitString(remaining,max_width))}return[s.substr(0,idx+1)]};for(var i=0;i<s.length;i++){if(s.charAt(i)==\" \"){width_exceeded=this.get_width(s.substr(0,i))>max_width;if(width_exceeded&&prev_space_pos>0){return cut_off(prev_space_pos)}if(width_exceeded){return cut_off(i)}prev_space_pos=i}if(s.charAt(i)==\"\\n\"){return cut_off(i)}}if(prev_space_pos>0&&this.get_width(s)>max_width){return cut_off(prev_space_pos)}return[s]};if(!window.maxkir)maxkir={};maxkir.FF=/Firefox/i.test(navigator.userAgent);if(typeof document.defaultView==\"undefined\"){document.defaultView={};document.defaultView.getComputedStyle=function(element){return element.currentStyle}}maxkir.CursorPosition=function(element,padding){this.element=element;this.padding=padding;this.selection_range=new maxkir.SelectionRange(element);var that=this;this.get_string_metrics=function(s){return maxkir.CursorPosition.getTextMetrics(element,s,padding)};var splitter=new maxkir.StringSplitter(function(s){var metrics=that.get_string_metrics(s);return metrics[0]});this.split_to_lines=function(){var innerAreaWidth=element.scrollWidth;if(maxkir.FF){innerAreaWidth-=4}var pos=that.selection_range.get_selection_range()[0];return splitter.splitString(element.value.substr(0,pos),innerAreaWidth)}};maxkir.CursorPosition.prototype.getCursorCoordinates=function(){var lines=this.split_to_lines();return[lines[lines.length-1].length,lines.length]};maxkir.CursorPosition.prototype.getPixelCoordinates=function(){var lines=this.split_to_lines();var m=this.get_string_metrics(lines[lines.length-1]);var w=m[0];var h=m[1]*lines.length-this.element.scrollTop+this.padding;return[w,h]};maxkir.CursorPosition.getTextMetrics=function(styledElement,s,padding){var element=styledElement;var clone_css_style=function(target,styleName){var val=element.style[styleName];if(!val){var css=document.defaultView.getComputedStyle(element,null);val=css?css[styleName]:null}if(val){target.style[styleName]=val}};var widthElementId=\"__widther\";var div=document.getElementById(widthElementId);if(!div){div=document.createElement(\"div\");document.body.appendChild(div);div.id=widthElementId;div.style.position=\"absolute\";div.style.left=\"-10000px\"}clone_css_style(div,\"fontSize\");clone_css_style(div,\"fontFamily\");clone_css_style(div,\"fontWeight\");clone_css_style(div,\"fontVariant\");clone_css_style(div,\"fontStyle\");clone_css_style(div,\"textTransform\");clone_css_style(div,\"lineHeight\");div.style.width=\"0\";div.style.paddingLeft=padding+\"px\";div.innerHTML=s.replace(\" \",\"&nbsp;\");div.style.width=\"auto\";return[div.offsetWidth,div.offsetHeight]};(function($){$.fn.caretpixelpos=function(){if(typeof this.positioner==\"undefined\"){this.positioner=new maxkir.CursorPosition(this[0],7)}var child_pos=this.positioner.getPixelCoordinates();var t_pos=this.offset();return{left:t_pos.left+child_pos[0],top:t_pos.top+child_pos[1],childPos:{left:child_pos[0],top:child_pos[1]}}}}).call(this,jQuery);(function($){\"use strict\";var k={},max=Math.max,min=Math.min;k.c={};k.c.d=$(document);k.c.t=function(e){return e.originalEvent.touches.length-1};k.o=function(){var s=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.run=function(){var cf=function(e,conf){var k;for(k in conf){s.o[k]=conf[k]}s.init();s._configure()._draw()};if(this.$.data(\"kontroled\"))return;this.$.data(\"kontroled\",true);this.extend();this.o=$.extend({min:this.$.data(\"min\")||0,max:this.$.data(\"max\")||100,stopper:true,readOnly:this.$.data(\"readonly\"),cursor:this.$.data(\"cursor\")===true&&30||this.$.data(\"cursor\")||0,thickness:this.$.data(\"thickness\")||.35,lineCap:this.$.data(\"linecap\")||\"butt\",width:this.$.data(\"width\")||200,height:this.$.data(\"height\")||200,displayInput:this.$.data(\"displayinput\")==null||this.$.data(\"displayinput\"),displayPrevious:this.$.data(\"displayprevious\"),fgColor:this.$.data(\"fgcolor\")||\"#87CEEB\",inputColor:this.$.data(\"inputcolor\")||this.$.data(\"fgcolor\")||\"#87CEEB\",inline:false,step:this.$.data(\"step\")||1,draw:null,change:null,cancel:null,release:null},this.o);if(this.$.is(\"fieldset\")){this.v={};this.i=this.$.find(\"input\");this.i.each(function(k){var $this=$(this);s.i[k]=$this;s.v[k]=$this.val();$this.bind(\"change\",function(){var val={};val[k]=$this.val();s.val(val)})});this.$.find(\"legend\").remove()}else{this.i=this.$;this.v=this.$.val();this.v==\"\"&&(this.v=this.o.min);this.$.bind(\"change\",function(){s.val(s._validate(s.$.val()))})}!this.o.displayInput&&this.$.hide();this.$c=$('<canvas width=\"'+this.o.width+'px\" height=\"'+this.o.height+'px\"></canvas>');this.c=this.$c[0].getContext(\"2d\");this.$.wrap($('<div style=\"'+(this.o.inline?\"display:inline;\":\"\")+\"width:\"+this.o.width+\"px;height:\"+this.o.height+'px;\"></div>')).before(this.$c);if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else{this.cv=this.v}this.$.bind(\"configure\",cf).parent().bind(\"configure\",cf);this._listen()._configure()._xy().init();this.isInit=true;this._draw();return this};this._draw=function(){var d=true,c=document.createElement(\"canvas\");c.width=s.o.width;c.height=s.o.height;s.g=c.getContext(\"2d\");s.clear();s.dH&&(d=s.dH());d!==false&&s.draw();s.c.drawImage(c,0,0);c=null};this._touch=function(e){var touchMove=function(e){var v=s.xy2val(e.originalEvent.touches[s.t].pageX,e.originalEvent.touches[s.t].pageY);if(v==s.cv)return;if(s.cH&&s.cH(v)===false)return;s.change(s._validate(v));s._draw()};this.t=k.c.t(e);touchMove(e);k.c.d.bind(\"touchmove.k\",touchMove).bind(\"touchend.k\",function(){k.c.d.unbind(\"touchmove.k touchend.k\");if(s.rH&&s.rH(s.cv)===false)return;s.val(s.cv)});return this};this._mouse=function(e){var mouseMove=function(e){var v=s.xy2val(e.pageX,e.pageY);if(v==s.cv)return;if(s.cH&&s.cH(v)===false)return;s.change(s._validate(v));s._draw()};mouseMove(e);k.c.d.bind(\"mousemove.k\",mouseMove).bind(\"keyup.k\",function(e){if(e.keyCode===27){k.c.d.unbind(\"mouseup.k mousemove.k keyup.k\");if(s.eH&&s.eH()===false)return;s.cancel()}}).bind(\"mouseup.k\",function(e){k.c.d.unbind(\"mousemove.k mouseup.k keyup.k\");if(s.rH&&s.rH(s.cv)===false)return;\ns.val(s.cv)});return this};this._xy=function(){var o=this.$c.offset();this.x=o.left;this.y=o.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind(\"mousedown\",function(e){e.preventDefault();s._xy()._mouse(e)}).bind(\"touchstart\",function(e){e.preventDefault();s._xy()._touch(e)});this.listen()}else{this.$.attr(\"readonly\",\"readonly\")}return this};this._configure=function(){if(this.o.draw)this.dH=this.o.draw;if(this.o.change)this.cH=this.o.change;if(this.o.cancel)this.eH=this.o.cancel;if(this.o.release)this.rH=this.o.release;if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,\"0.4\");this.fgColor=this.h2rgba(this.o.fgColor,\"0.6\")}else{this.fgColor=this.o.fgColor}return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(v){return~~((v<0?-.5:.5)+v/this.o.step)*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(v){};this.val=function(v){};this.xy2val=function(x,y){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(h,a){var rgb;h=h.substring(1,7);rgb=[parseInt(h.substring(0,2),16),parseInt(h.substring(2,4),16),parseInt(h.substring(4,6),16)];return\"rgba(\"+rgb[0]+\",\"+rgb[1]+\",\"+rgb[2]+\",\"+a+\")\"};this.copy=function(f,t){for(var i in f){t[i]=f[i]}}};k.Dial=function(){k.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=$.extend({bgColor:this.$.data(\"bgcolor\")||\"#EEEEEE\",angleOffset:this.$.data(\"angleoffset\")||0,angleArc:this.$.data(\"anglearc\")||360,inline:true},this.o)};this.val=function(v){if(null!=v){this.cv=this.o.stopper?max(min(v,this.o.max),this.o.min):v;this.v=this.cv;this.$.val(this.v);this._draw()}else{return this.v}};this.xy2val=function(x,y){var a,ret;a=Math.atan2(x-(this.x+this.w2),-(y-this.y-this.w2))-this.angleOffset;if(this.angleArc!=this.PI2&&a<0&&a>-.5){a=0}else if(a<0){a+=this.PI2}ret=~~(.5+a*(this.o.max-this.o.min)/this.angleArc)+this.o.min;this.o.stopper&&(ret=max(min(ret,this.o.max),this.o.min));return ret};this.listen=function(){var s=this,mw=function(e){e.preventDefault();var ori=e.originalEvent,deltaX=ori.detail||ori.wheelDeltaX,deltaY=ori.detail||ori.wheelDeltaY,v=parseInt(s.$.val())+(deltaX>0||deltaY>0?s.o.step:deltaX<0||deltaY<0?-s.o.step:0);if(s.cH&&s.cH(v)===false)return;s.val(v)},kval,to,m=1,kv={37:-s.o.step,38:s.o.step,39:s.o.step,40:-s.o.step};this.$.bind(\"keydown\",function(e){var kc=e.keyCode;if(kc>=96&&kc<=105){kc=e.keyCode=kc-48}kval=parseInt(String.fromCharCode(kc));if(isNaN(kval)){kc!==13&&kc!==8&&kc!==9&&kc!==189&&e.preventDefault();if($.inArray(kc,[37,38,39,40])>-1){e.preventDefault();var v=parseInt(s.$.val())+kv[kc]*m;s.o.stopper&&(v=max(min(v,s.o.max),s.o.min));s.change(v);s._draw();to=window.setTimeout(function(){m*=2},30)}}}).bind(\"keyup\",function(e){if(isNaN(kval)){if(to){window.clearTimeout(to);to=null;m=1;s.val(s.$.val())}}else{s.$.val()>s.o.max&&s.$.val(s.o.max)||s.$.val()<s.o.min&&s.$.val(s.o.min)}});this.$c.bind(\"mousewheel DOMMouseScroll\",mw);this.$.bind(\"mousewheel DOMMouseScroll\",mw)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.o.width/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var s=max(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.o.width/2+4>>0)+\"px\",height:(this.o.width/3>>0)+\"px\",position:\"absolute\",\"vertical-align\":\"middle\",\"margin-top\":(this.o.width/3>>0)+\"px\",\"margin-left\":\"-\"+(this.o.width*3/4+2>>0)+\"px\",border:0,background:\"none\",font:\"bold \"+(this.o.width/s>>0)+\"px Arial\",\"text-align\":\"center\",color:this.o.inputColor||this.o.fgColor,padding:\"0px\",\"-webkit-appearance\":\"none\"})||this.i.css({width:\"0px\",visibility:\"hidden\"})};this.change=function(v){this.cv=v;this.$.val(v)};this.angle=function(v){return(v-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.draw=function(){var c=this.g,a=this.angle(this.cv),sat=this.startAngle,eat=sat+a,sa,ea,r=1;c.lineWidth=this.lineWidth;c.lineCap=this.lineCap;this.o.cursor&&(sat=eat-this.cursorExt)&&(eat=eat+this.cursorExt);c.beginPath();c.strokeStyle=this.o.bgColor;c.arc(this.xy,this.xy,this.radius,this.endAngle,this.startAngle,true);c.stroke();if(this.o.displayPrevious){ea=this.startAngle+this.angle(this.v);sa=this.startAngle;this.o.cursor&&(sa=ea-this.cursorExt)&&(ea=ea+this.cursorExt);c.beginPath();c.strokeStyle=this.pColor;c.arc(this.xy,this.xy,this.radius,sa,ea,false);c.stroke();r=this.cv==this.v}c.beginPath();c.strokeStyle=r?this.o.fgColor:this.fgColor;c.arc(this.xy,this.xy,this.radius,sat,eat,false);c.stroke()};this.cancel=function(){this.val(this.v)}};$.fn.dial=$.fn.knob=function(o){return this.each(function(){var d=new k.Dial;d.o=o;d.$=$(this);d.run()}).parent()}})(jQuery);(function(factory){\"use strict\";if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(window.jQuery)}})(function($){\"use strict\";var counter=0;$.ajaxTransport(\"iframe\",function(options){if(options.async){var form,iframe,addParamChar;return{send:function(_,completeCallback){form=$('<form style=\"display:none;\"></form>');form.attr(\"accept-charset\",options.formAcceptCharset);addParamChar=/\\?/.test(options.url)?\"&\":\"?\";if(options.type===\"DELETE\"){options.url=options.url+addParamChar+\"_method=DELETE\";options.type=\"POST\"}else if(options.type===\"PUT\"){options.url=options.url+addParamChar+\"_method=PUT\";options.type=\"POST\"}else if(options.type===\"PATCH\"){options.url=options.url+addParamChar+\"_method=PATCH\";options.type=\"POST\"}counter+=1;iframe=$('<iframe src=\"javascript:false;\" name=\"iframe-transport-'+counter+'\"></iframe>').bind(\"load\",function(){var fileInputClones,paramNames=$.isArray(options.paramName)?options.paramName:[options.paramName];iframe.unbind(\"load\").bind(\"load\",function(){var response;try{response=iframe.contents();if(!response.length||!response[0].firstChild){throw new Error}}catch(e){response=undefined}completeCallback(200,\"success\",{iframe:response});$('<iframe src=\"javascript:false;\"></iframe>').appendTo(form);window.setTimeout(function(){form.remove()},0)});form.prop(\"target\",iframe.prop(\"name\")).prop(\"action\",options.url).prop(\"method\",options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type=\"hidden\"/>').prop(\"name\",field.name).val(field.value).appendTo(form)})}if(options.fileInput&&options.fileInput.length&&options.type===\"POST\"){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index]});if(options.paramName){options.fileInput.each(function(index){$(this).prop(\"name\",paramNames[index]||options.paramName)})}form.append(options.fileInput).prop(\"enctype\",\"multipart/form-data\").prop(\"encoding\",\"multipart/form-data\")}form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop(\"name\",clone.prop(\"name\"));clone.replaceWith(input)})}});form.append(iframe).appendTo(document.body)},abort:function(){if(iframe){iframe.unbind(\"load\").prop(\"src\",\"javascript\".concat(\":false;\"))}if(form){form.remove()}}}}});$.ajaxSetup({converters:{\"iframe text\":function(iframe){return iframe&&$(iframe[0].body).text()},\"iframe json\":function(iframe){return iframe&&$.parseJSON($(iframe[0].body).text())},\"iframe html\":function(iframe){return iframe&&$(iframe[0].body).html()},\"iframe xml\":function(iframe){var xmlDoc=iframe&&iframe[0];return xmlDoc&&$.isXMLDoc(xmlDoc)?xmlDoc:$.parseXML(xmlDoc.XMLDocument&&xmlDoc.XMLDocument.xml||$(xmlDoc.body).html())},\"iframe script\":function(iframe){return iframe&&$.globalEval($(iframe[0].body).text())}}})});(function(factory){if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(jQuery)}})(function($){var pluses=/\\+/g;function raw(s){return s}function decoded(s){return decodeURIComponent(s.replace(pluses,\" \"))}function converted(s){if(s.indexOf('\"')===0){s=s.slice(1,-1).replace(/\\\\\"/g,'\"').replace(/\\\\\\\\/g,\"\\\\\")}try{return config.json?JSON.parse(s):s}catch(er){}}var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(typeof options.expires===\"number\"){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}value=config.json?JSON.stringify(value):String(value);return document.cookie=[config.raw?key:encodeURIComponent(key),\"=\",config.raw?value:encodeURIComponent(value),options.expires?\"; expires=\"+options.expires.toUTCString():\"\",options.path?\"; path=\"+options.path:\"\",options.domain?\"; domain=\"+options.domain:\"\",options.secure?\"; secure\":\"\"].join(\"\")}var decode=config.raw?raw:decoded;var cookies=document.cookie.split(\"; \");var result=key?undefined:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split(\"=\");var name=decode(parts.shift());var cookie=decode(parts.join(\"=\"));if(key&&key===name){result=converted(cookie);break}if(!key){result[name]=converted(cookie)}}return result};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==undefined){$.cookie(key,\"\",$.extend({},options,{expires:-1}));return true}return false}});(function($){var $scrollTo=$.scrollTo=function(target,duration,settings){$(window).scrollTo(target,duration,settings)};$scrollTo.defaults={axis:\"xy\",duration:parseFloat($.fn.jquery)>=1.3?0:1,limit:true};$scrollTo.window=function(scope){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var elem=this,isWin=!elem.nodeName||$.inArray(elem.nodeName.toLowerCase(),[\"iframe\",\"#document\",\"html\",\"body\"])!=-1;if(!isWin)return elem;var doc=(elem.contentWindow||elem).document||elem.ownerDocument||elem;return/webkit/.test(navigator.userAgent.toLowerCase())||doc.compatMode==\"BackCompat\"?doc.body:doc.documentElement})};$.fn.scrollTo=function(target,duration,settings){if(typeof duration==\"object\"){settings=duration;duration=0}if(typeof settings==\"function\")settings={onAfter:settings};if(target==\"max\")target=9e9;settings=$.extend({},$scrollTo.defaults,settings);duration=duration||settings.duration;settings.queue=settings.queue&&settings.axis.length>1;if(settings.queue)duration/=2;settings.offset=both(settings.offset);settings.over=both(settings.over);return this._scrollable().each(function(){var elem=this,$elem=$(elem),targ=target,toff,attr={},win=$elem.is(\"html,body\");switch(typeof targ){case\"number\":case\"string\":if(/^([+-]=)?\\d+(\\.\\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}targ=$(targ,this);if(!targ.length)return;case\"object\":if(targ.is||targ.style)toff=(targ=$(targ)).offset()}$.each(settings.axis.split(\"\"),function(i,axis){var Pos=axis==\"x\"?\"Left\":\"Top\",pos=Pos.toLowerCase(),key=\"scroll\"+Pos,old=elem[key],max=$scrollTo.max(elem,axis);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(settings.margin){attr[key]-=parseInt(targ.css(\"margin\"+Pos))||0;attr[key]-=parseInt(targ.css(\"border\"+Pos+\"Width\"))||0}attr[key]+=settings.offset[pos]||0;if(settings.over[pos])attr[key]+=targ[axis==\"x\"?\"width\":\"height\"]()*settings.over[pos]}else{var val=targ[pos];attr[key]=val.slice&&val.slice(-1)==\"%\"?parseFloat(val)/100*max:val}if(settings.limit&&/^\\d+$/.test(attr[key]))attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&settings.queue){if(old!=attr[key])animate(settings.onAfterFirst);delete attr[key]}});animate(settings.onAfter);function animate(callback){$elem.animate(attr,duration,settings.easing,callback&&function(){callback.call(this,target,settings)})}}).end()};$scrollTo.max=function(elem,axis){var Dim=axis==\"x\"?\"Width\":\"Height\",scroll=\"scroll\"+Dim;if(!$(elem).is(\"html,body\"))return elem[scroll]-$(elem)[Dim.toLowerCase()]();var size=\"client\"+Dim,html=elem.ownerDocument.documentElement,body=elem.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[size],body[size])};function both(val){return typeof val==\"object\"?val:{top:val,left:val}}})(jQuery);(function(factory){\"use strict\";if(typeof define===\"function\"&&define.amd){define([\"jquery\",\"jquery.ui.widget\"],factory)}else{factory(window.jQuery)}})(function($){\"use strict\";$.support.fileInput=!(new RegExp(\"(Android (1\\\\.[0156]|2\\\\.[01]))\"+\"|(Windows Phone (OS 7|8\\\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)\"+\"|(w(eb)?OSBrowser)|(webOS)\"+\"|(Kindle/(1\\\\.0|2\\\\.[05]|3\\\\.0))\").test(window.navigator.userAgent)||$('<input type=\"file\">').prop(\"disabled\"));$.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);$.widget(\"blueimp.fileupload\",{options:{dropZone:$(document),pasteZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:\"Uploaded bytes exceed file size\"},i18n:function(message,context){message=this.messages[message]||message.toString();if(context){$.each(context,function(key,value){message=message.replace(\"{\"+key+\"}\",value)})}return message},formData:function(form){return form.serializeArray()},add:function(e,data){if(data.autoUpload||data.autoUpload!==false&&$(this).fileupload(\"option\",\"autoUpload\")){data.process().done(function(){data.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:[\"fileInput\",\"dropZone\",\"pasteZone\",\"multipart\",\"forceIframeTransport\"],_blobSlice:$.support.blobSlice&&function(){var slice=this.slice||this.webkitSlice||this.mozSlice;return slice.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1e3/timeDiff)*8;this.loaded=loaded;this.timestamp=now}return this.bitrate}},_isXHRUpload:function(options){return!options.forceIframeTransport&&(!options.multipart&&$.support.xhrFileUpload||$.support.xhrFormDataFileUpload)},_getFormData:function(options){var formData;if(typeof options.formData===\"function\"){return options.formData(options.form)}if($.isArray(options.formData)){return options.formData}if($.type(options.formData)===\"object\"){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value})});return formData}return[]},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1});return total},_initProgressObject:function(obj){var progress={loaded:0,total:0,bitrate:0};if(obj._progress){$.extend(obj._progress,progress)}else{obj._progress=progress}},_initResponseObject:function(obj){var prop;if(obj._response){for(prop in obj._response){if(obj._response.hasOwnProperty(prop)){delete obj._response[prop]}}}else{obj._response={}}},_onProgress:function(e,data){if(e.lengthComputable){var now=Date.now?Date.now():(new Date).getTime(),loaded;if(data._time&&data.progressInterval&&now-data._time<data.progressInterval&&e.loaded!==e.total){return}data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=loaded-data._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger(\"progress\",e,data);this._trigger(\"progressall\",e,this._progress)}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind(\"progress\",function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options)});options.xhr=function(){return xhr}}},_isInstanceOf:function(type,obj){return Object.prototype.toString.call(obj)===\"[object \"+type+\"]\"},_initXHRData:function(options){var that=this,formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=options.paramName[0];options.headers=$.extend({},options.headers);if(options.contentRange){options.headers[\"Content-Range\"]=options.contentRange}if(!multipart||options.blob||!this._isInstanceOf(\"File\",file)){options.headers[\"Content-Disposition\"]='attachment; filename=\"'+encodeURI(file.name)+'\"'}if(!multipart){options.contentType=file.type;options.data=options.blob||file}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob})}else{$.each(options.files,function(index,file){formData.push({name:options.paramName[index]||paramName,value:file})})}}else{if(that._isInstanceOf(\"FormData\",options.formData)){formData=options.formData}else{formData=new FormData;$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value)})}if(options.blob){formData.append(paramName,options.blob,file.name)}else{$.each(options.files,function(index,file){if(that._isInstanceOf(\"File\",file)||that._isInstanceOf(\"Blob\",file)){formData.append(options.paramName[index]||paramName,file,file.name)}})}}options.data=formData}options.blob=null},_initIframeSettings:function(options){var targetHost=$(\"<a></a>\").prop(\"href\",options.url).prop(\"host\");options.dataType=\"iframe \"+(options.dataType||\"\");options.formData=this._getFormData(options);if(options.redirect&&targetHost&&targetHost!==location.host){options.formData.push({name:options.redirectParamName||\"redirect\",value:options.redirect})}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options)}this._initProgressListener(options)}if(options.postMessage){options.dataType=\"postmessage \"+(options.dataType||\"\")}}else{this._initIframeSettings(options)}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop(\"name\")||\"files[]\",i=(input.prop(\"files\")||[1]).length;while(i){paramName.push(name);i-=1}});if(!paramName.length){paramName=[fileInput.prop(\"name\")||\"files[]\"]}}else if(!$.isArray(paramName)){paramName=[paramName]}return paramName},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop(\"form\"));if(!options.form.length){options.form=$(this.options.fileInput.prop(\"form\"))}}options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop(\"action\")||location.href}options.type=(options.type||$.type(options.form.prop(\"method\"))===\"string\"&&options.form.prop(\"method\")||\"\").toUpperCase();if(options.type!==\"POST\"&&options.type!==\"PUT\"&&options.type!==\"PATCH\"){options.type=\"POST\"}if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr(\"accept-charset\")}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options},_getDeferredState:function(deferred){if(deferred.state){return deferred.state()}if(deferred.isResolved()){return\"resolved\"}if(deferred.isRejected()){return\"rejected\"}return\"pending\"},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args)}else if(resolveOrReject===false){dfd.rejectWith(context,args)}promise.abort=dfd.promise;return this._enhancePromise(promise)},_addConvenienceMethods:function(e,data){var that=this,getPromise=function(data){return $.Deferred().resolveWith(that,[data]).promise()};data.process=function(resolveFunc,rejectFunc){if(resolveFunc||rejectFunc){data._processQueue=this._processQueue=(this._processQueue||getPromise(this)).pipe(resolveFunc,rejectFunc)}return this._processQueue||getPromise(this)};data.submit=function(){if(this.state()!==\"pending\"){data.jqXHR=this.jqXHR=that._trigger(\"submit\",e,this)!==false&&that._onSend(e,this)}return this.jqXHR||that._getXHRPromise()};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}return that._getXHRPromise()};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR)}if(this._processQueue){return that._getDeferredState(this._processQueue)}};data.progress=function(){return this._progress};data.response=function(){return this._response}},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader(\"Range\"),parts=range&&range.split(\"-\"),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1},_chunkedUpload:function(options,testOnly){options.uploadedBytes=options.uploadedBytes||0;var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes,mcs=options.maxChunkSize||fs,slice=this._blobSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false}if(testOnly){return true}if(ub>=fs){file.error=options.i18n(\"uploadedBytes\");return this._getXHRPromise(false,options.context,[null,\"error\",file.error])}upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange=\"bytes \"+ub+\"-\"+(ub+o.chunkSize-1)+\"/\"+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=(that._trigger(\"chunksend\",null,o)!==false&&$.ajax(o)||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||ub+o.chunkSize;if(currentLoaded+o.chunkSize-o._progress.loaded){that._onProgress($.Event(\"progress\",{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o)}options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger(\"chunkdone\",null,o);that._trigger(\"chunkalways\",null,o);if(ub<fs){upload()}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR])}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger(\"chunkfail\",null,o);that._trigger(\"chunkalways\",null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown])})};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort()};upload();return promise},_beforeSend:function(e,data){if(this._active===0){this._trigger(\"start\");this._bitrateTimer=new this._BitrateTimer;this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(data);this._initProgressObject(data);data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total,response=options._response;if(options._progress.loaded<total){this._onProgress($.Event(\"progress\",{lengthComputable:true,loaded:total,total:total}),options)}response.result=options.result=result;response.textStatus=options.textStatus=textStatus;response.jqXHR=options.jqXHR=jqXHR;this._trigger(\"done\",null,options)},_onFail:function(jqXHR,textStatus,errorThrown,options){var response=options._response;if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total}response.jqXHR=options.jqXHR=jqXHR;response.textStatus=options.textStatus=textStatus;response.errorThrown=options.errorThrown=errorThrown;this._trigger(\"fail\",null,options)},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._trigger(\"always\",null,options)},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data)}var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer;jqXHR=jqXHR||((aborted||that._trigger(\"send\",e,options)===false)&&that._getXHRPromise(false,options.context,aborted)||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options)}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options)}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);that._sending-=1;that._active-=1;if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)===\"pending\"){nextSlot.resolve();break}nextSlot=that._slots.shift()}}if(that._active===0){that._trigger(\"stop\")}});return jqXHR};this._beforeSend(e,options);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send)}else{this._sequence=this._sequence.pipe(send,send);pipe=this._sequence}pipe.abort=function(){aborted=[undefined,\"abort\",\"abort\"];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted)}return send()}return jqXHR.abort()};return this._enhancePromise(pipe)}return send()},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),limit=options.limitMultiFileUploads,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i;if(!(options.singleFileUploads||limit)||!this._isXHRUpload(options)){fileSet=[data.files];paramNameSet=[paramName]}else if(!options.singleFileUploads&&limit){fileSet=[];paramNameSet=[];for(i=0;i<data.files.length;i+=limit){fileSet.push(data.files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName}paramNameSet.push(paramNameSlice)}}else{paramNameSet=paramName}data.originalFiles=data.files;$.each(fileSet||data.files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initResponseObject(newData);that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger(\"add\",e,newData);return result});return result},_replaceFileInput:function(input){var inputClone=input.clone(true);$(\"<form></form>\").append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind(\"remove\"));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0]}return el});if(input[0]===this.element[0]){this.element=inputClone}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry}dfd.resolve([e])},dirReader;path=path||\"\";if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file)}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file)},errorHandler)}}else if(entry.isDirectory){dirReader=entry.createReader();dirReader.readEntries(function(entries){that._handleFileTreeEntries(entries,path+entry.name+\"/\").done(function(files){dfd.resolve(files)}).fail(errorHandler)},errorHandler)}else{dfd.resolve([])}return dfd.promise()},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile()}return entry}return item.getAsEntry()}))}return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise()},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop(\"webkitEntries\")||fileInput.prop(\"entries\"),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries)}files=$.makeArray(fileInput.prop(\"files\"));if(!files.length){value=fileInput.prop(\"value\");if(!value){return $.Deferred().resolve([]).promise()}files=[{name:value.replace(/^.*\\\\/,\"\")}]}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize})}return $.Deferred().resolve(files).promise()},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput)}return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput)}if(that._trigger(\"change\",e,data)!==false){that._onAdd(e,data)}})},_onPaste:function(e){var items=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,data={files:[]};if(items&&items.length){$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file)}});if(this._trigger(\"paste\",e,data)!==false){this._onAdd(e,data)}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var that=this,dataTransfer=e.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger(\"drop\",e,data)!==false){that._onAdd(e,data)}})}},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var dataTransfer=e.dataTransfer,data={dropEffect:\"copy\",preventDefault:true};if(dataTransfer&&$.inArray(\"Files\",dataTransfer.types)!==-1&&this._trigger(\"dragover\",e,data)!==false){dataTransfer.dropEffect=data.dropEffect;if(data.preventDefault){e.preventDefault()}}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,\"dragover drop\");this._off(this.options.pasteZone,\"paste\");this._off(this.options.fileInput,\"change\")},_setOption:function(key,value){var reinit=$.inArray(key,this._specialOptions)!==-1;if(reinit){this._destroyEventHandlers()}this._super(key,value);if(reinit){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type=\"file\"]')?this.element:this.element.find('input[type=\"file\"]')\n}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput)}if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone)}if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone)}},_getRegExp:function(str){var parts=str.split(\"/\"),modifiers=parts.pop();parts.shift();return new RegExp(parts.join(\"/\"),modifiers)},_isRegExpOption:function(key,value){return key!==\"url\"&&$.type(value)===\"string\"&&/^\\/.*\\/[igm]{0,3}$/.test(value)},_initDataAttributes:function(){var that=this,options=this.options;$.each($(this.element[0].cloneNode(false)).data(),function(key,value){if(that._isRegExpOption(key,value)){value=that._getRegExp(value)}options[key]=value})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(data){var that=this;if(!data||this.options.disabled){return}if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data)})}else{data.files=$.makeArray(data.files);this._onAdd(null,data)}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort()}dfd.reject(null,\"abort\",\"abort\");return promise};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return}if(!files.length){dfd.reject();return}data.files=files;jqXHR=that._onSend(null,data).then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR)},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown)})});return this._enhancePromise(promise)}data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data)}}return this._getXHRPromise(false,data&&data.context)}})});jQuery.extend(jQuery,{escapeSel:function(){return function(selector){return typeof selector!==\"undefined\"&&selector!==null?selector.replace(/([ #;?&,.+*~\\':\"!^$[\\]()=>|\\/@])/g,\"\\\\$1\"):void 0}}()});(function(f,h,$){var a=\"placeholder\"in h.createElement(\"input\"),d=\"placeholder\"in h.createElement(\"textarea\"),i=$.fn,c=$.valHooks,k,j;if(a&&d){j=i.placeholder=function(){return this};j.input=j.textarea=true}else{j=i.placeholder=function(){var l=this;l.filter((a?\"textarea\":\":input\")+\"[placeholder]\").not(\".placeholder\").bind({\"focus.placeholder\":b,\"blur.placeholder\":e}).data(\"placeholder-enabled\",true).trigger(\"blur.placeholder\");return l};j.input=a;j.textarea=d;k={get:function(m){var l=$(m);return l.data(\"placeholder-enabled\")&&l.hasClass(\"placeholder\")?\"\":m.value},set:function(m,n){var l=$(m);if(!l.data(\"placeholder-enabled\")){return m.value=n}if(n==\"\"){m.value=n;if(m!=h.activeElement){e.call(m)}}else{if(l.hasClass(\"placeholder\")){b.call(m,true,n)||(m.value=n)}else{m.value=n}}return l}};a||(c.input=k);d||(c.textarea=k);$(function(){$(h).delegate(\"form\",\"submit.placeholder\",function(){var l=$(\".placeholder\",this).each(b);setTimeout(function(){l.each(e)},10)})});$(f).bind(\"beforeunload.placeholder\",function(){$(\".placeholder\").each(function(){this.value=\"\"})})}function g(m){var l={},n=/^jQuery\\d+$/;$.each(m.attributes,function(p,o){if(o.specified&&!n.test(o.name)){l[o.name]=o.value}});return l}function b(m,n){var l=this,o=$(l);if(l.value==o.attr(\"placeholder\")&&o.hasClass(\"placeholder\")){if(o.data(\"placeholder-password\")){o=o.hide().next().show().attr(\"id\",o.removeAttr(\"id\").data(\"placeholder-id\"));if(m===true){return o[0].value=n}o.focus()}else{l.value=\"\";o.removeClass(\"placeholder\");l==h.activeElement&&l.select()}}}function e(){var q,l=this,p=$(l),m=p,o=this.id;if(l.value==\"\"){if(l.type==\"password\"){if(!p.data(\"placeholder-textinput\")){try{q=p.clone().attr({type:\"text\"})}catch(n){q=$(\"<input>\").attr($.extend(g(this),{type:\"text\"}))}q.removeAttr(\"name\").data({\"placeholder-password\":true,\"placeholder-id\":o}).bind(\"focus.placeholder\",b);p.data({\"placeholder-textinput\":q,\"placeholder-id\":o}).before(q)}p=p.removeAttr(\"id\").hide().prev().attr(\"id\",o).show()}p.addClass(\"placeholder\");p[0].value=p.attr(\"placeholder\")}else{p.removeClass(\"placeholder\")}}})(this,document,jQuery);jQuery.fn.outerHTML=function(){return $(\"<div>\").append(this.eq(0).clone()).html()};window.mobilecheck=function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){return true}else{return false}};window.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||\"an unknown browser\";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||\"an unknown version\";this.OS=this.searchString(this.dataOS)||\"an unknown OS\"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)return data[i].identity}else if(dataProp)return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:\"Chrome\",identity:\"Chrome\"},{string:navigator.userAgent,subString:\"OmniWeb\",versionSearch:\"OmniWeb/\",identity:\"OmniWeb\"},{string:navigator.vendor,subString:\"Apple\",identity:\"Safari\",versionSearch:\"Version\"},{prop:window.opera,identity:\"Opera\",versionSearch:\"Version\"},{string:navigator.vendor,subString:\"iCab\",identity:\"iCab\"},{string:navigator.vendor,subString:\"KDE\",identity:\"Konqueror\"},{string:navigator.userAgent,subString:\"Firefox\",identity:\"Firefox\"},{string:navigator.vendor,subString:\"Camino\",identity:\"Camino\"},{string:navigator.userAgent,subString:\"Netscape\",identity:\"Netscape\"},{string:navigator.userAgent,subString:\"MSIE\",identity:\"Explorer\",versionSearch:\"MSIE\"},{string:navigator.userAgent,subString:\"Gecko\",identity:\"Mozilla\",versionSearch:\"rv\"},{string:navigator.userAgent,subString:\"Mozilla\",identity:\"Netscape\",versionSearch:\"Mozilla\"}],dataOS:[{string:navigator.platform,subString:\"Win\",identity:\"Windows\"},{string:navigator.platform,subString:\"Mac\",identity:\"Mac\"},{string:navigator.userAgent,subString:\"iPhone\",identity:\"iPhone/iPod\"},{string:navigator.platform,subString:\"Linux\",identity:\"Linux\"}]};window.BrowserDetect.init();window.log=function(){if((typeof global!==\"undefined\"&&global!==null?global.debug:void 0)!=null&&!global.debug||window.debug!=null&&!window.debug){return}if(this.console){arguments.callee=arguments.callee.caller;var newarr=[].slice.call(arguments);typeof console.log===\"object\"?log.apply.call(console.log,console,newarr):console.log.apply(console,newarr)}};(function(b){function c(){}for(var d=\"assert,clear,count,debug,dir,dirxml,error,exception,firebug,group,groupCollapsed,groupEnd,info,log,memoryProfile,memoryProfileEnd,profile,profileEnd,table,time,timeEnd,timeStamp,trace,warn\".split(\",\"),a;a=d.pop();){b[a]=b[a]||c}})(function(){try{console.log();return window.console}catch(err){return window.console={}}}());Lawnchair.adapter(\"indexed-db\",function(){function fail(e,i){console.error(\"error in indexed-db adapter!\",e,i)}var STORE_VERSION=3;var getIDB=function(){return window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB};var getIDBTransaction=function(){return window.IDBTransaction||window.webkitIDBTransaction||window.mozIDBTransaction||window.oIDBTransaction||window.msIDBTransaction};var getIDBKeyRange=function(){return window.IDBKeyRange||window.webkitIDBKeyRange||window.mozIDBKeyRange||window.oIDBKeyRange||window.msIDBKeyRange};var getIDBDatabaseException=function(){return window.IDBDatabaseException||window.webkitIDBDatabaseException||window.mozIDBDatabaseException||window.oIDBDatabaseException||window.msIDBDatabaseException||window.DOMException};var useAutoIncrement=function(){return!!window.indexedDB};var READ_WRITE=getIDBTransaction()&&\"READ_WRITE\"in getIDBTransaction()?getIDBTransaction().READ_WRITE:\"readwrite\";return{valid:function(){return!!getIDB()},init:function(options,callback){this.idb=getIDB();this.waiting=[];this.useAutoIncrement=useAutoIncrement();var request=this.idb.open(this.name,STORE_VERSION);var self=this;var cb=self.fn(self.name,callback);if(cb&&typeof cb!=\"function\")throw\"callback not valid\";var win=function(){request.onupgradeneeded=request.onsuccess=request.error=null;if(cb)return cb.call(self,self)};var upgrade=function(from,to){try{self.db.deleteObjectStore(\"teststore\")}catch(e1){}try{self.db.deleteObjectStore(self.record)}catch(e2){}var params={};if(self.useAutoIncrement){params.autoIncrement=true}self.db.createObjectStore(self.record,params);self.store=true};request.onupgradeneeded=function(event){self.db=request.result;self.transaction=request.transaction;upgrade(event.oldVersion,event.newVersion)};request.onsuccess=function(event){self.db=event.target.result;if(self.db.version!=\"\"+STORE_VERSION){var oldVersion=self.db.version;var setVrequest=self.db.setVersion(\"\"+STORE_VERSION);setVrequest.onsuccess=function(event){var transaction=setVrequest.result;setVrequest.onsuccess=setVrequest.onerror=null;upgrade(oldVersion,STORE_VERSION);transaction.oncomplete=function(){for(var i=0;i<self.waiting.length;i++){self.waiting[i].call(self)}self.waiting=[];win()}};setVrequest.onerror=function(e){setVrequest.onsuccess=setVrequest.onerror=null;console.error(\"Failed to create objectstore \"+e);fail(e)}}else{self.store=true;for(var i=0;i<self.waiting.length;i++){self.waiting[i].call(self)}self.waiting=[];win()}};request.onerror=function(ev){if(request.errorCode===getIDBDatabaseException().VERSION_ERR){self.idb.deleteDatabase(self.name);if(!options.recursing){options.recursing=true;return self.init(options,callback)}}console.error(\"Failed to open database\")}},save:function(obj,callback){var self=this;if(!this.store){this.waiting.push(function(){this.save(obj,callback)});return}var objs=(this.isArray(obj)?obj:[obj]).map(function(o){if(!o.key){o.key=self.uuid()}return o});var win=function(e){if(callback){self.lambda(callback).call(self,self.isArray(obj)?objs:objs[0])}};var trans=this.db.transaction(this.record,READ_WRITE);var store=trans.objectStore(this.record);for(var i=0;i<objs.length;i++){var o=objs[i];store.put(o,o.key)}store.transaction.oncomplete=win;store.transaction.onabort=fail;return this},batch:function(objs,callback){return this.save(objs,callback)},get:function(key,callback){if(!this.store){this.waiting.push(function(){this.get(key,callback)});return}var self=this;var win=function(e){var r=e.target.result;if(callback){if(r){r.key=key}self.lambda(callback).call(self,r)}};if(!this.isArray(key)){var req=this.db.transaction(this.record).objectStore(this.record).get(key);req.onsuccess=function(event){req.onsuccess=req.onerror=null;win(event)};req.onerror=function(event){req.onsuccess=req.onerror=null;fail(event)}}else{var results=[],done=key.length,keys=key;var getOne=function(i){self.get(keys[i],function(obj){results[i]=obj;if(--done>0){return}if(callback){self.lambda(callback).call(self,results)}})};for(var i=0,l=keys.length;i<l;i++)getOne(i)}return this},exists:function(key,callback){if(!this.store){this.waiting.push(function(){this.exists(key,callback)});return}var self=this;var req=this.db.transaction(self.record).objectStore(this.record).openCursor(getIDBKeyRange().only(key));req.onsuccess=function(event){req.onsuccess=req.onerror=null;var undef;self.lambda(callback).call(self,event.target.result!==null&&event.target.result!==undef)};req.onerror=function(event){req.onsuccess=req.onerror=null;fail(event)};return this},all:function(callback){if(!this.store){this.waiting.push(function(){this.all(callback)});return}var cb=this.fn(this.name,callback)||undefined;var self=this;var objectStore=this.db.transaction(this.record).objectStore(this.record);var toReturn=[];objectStore.openCursor().onsuccess=function(event){var cursor=event.target.result;if(cursor){toReturn.push(cursor.value);cursor[\"continue\"]()}else{if(cb)cb.call(self,toReturn)}};return this},keys:function(callback){if(!this.store){this.waiting.push(function(){this.keys(callback)});return}var cb=this.fn(this.name,callback)||undefined;var self=this;var objectStore=this.db.transaction(this.record).objectStore(this.record);var toReturn=[];objectStore.openCursor().onsuccess=function(event){var cursor=event.target.result;if(cursor){toReturn.push(cursor.key);cursor[\"continue\"]()}else{if(cb)cb.call(self,toReturn)}};return this},remove:function(keyOrArray,callback){if(!this.store){this.waiting.push(function(){this.remove(keyOrArray,callback)});return}var self=this;var toDelete=keyOrArray;if(!this.isArray(keyOrArray)){toDelete=[keyOrArray]}var win=function(){if(callback)self.lambda(callback).call(self)};var os=this.db.transaction(this.record,READ_WRITE).objectStore(this.record);var key=keyOrArray.key?keyOrArray.key:keyOrArray;for(var i=0;i<toDelete.length;i++){var key=toDelete[i].key?toDelete[i].key:toDelete[i];os[\"delete\"](key)}os.transaction.oncomplete=win;os.transaction.onabort=fail;return this},nuke:function(callback){if(!this.store){this.waiting.push(function(){this.nuke(callback)});return}var self=this,win=callback?function(){self.lambda(callback).call(self)}:function(){};try{var os=this.db.transaction(this.record,READ_WRITE).objectStore(this.record);os.clear();os.transaction.oncomplete=win;os.transaction.onabort=fail}catch(e){if(e.name==\"NotFoundError\")win();else fail(e)}return this}}}());window.PrettyPills=function(){var CodeMirror=window.CodeMirror;function PrettyPills(textarea,options){if(!(this instanceof PrettyPills))return new PrettyPills(place,options);this.editor=CodeMirror.fromTextArea(textarea[0]||textarea,options);var editor=this.editor;var wrapper=$(editor.getWrapperElement());var emitter=this.emitter=$(\"<div />\");wrapper.wrap(\"<div class='PrettyPills' />\");this.container=wrapper.parent();this.textarea=$(this.editor.getTextArea());this.options=options=options||{};for(var opt in defaults){if(!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt)){options[opt]=defaults[opt]}}editor.setOption(\"lineNumbers\",false);editor.setOption(\"lineWrapping\",true);wrapper.on(\"click\",\".pill\",bind(function(e){this.setActivePill(e.target)},this));var debounceCursorActivity=debounce(bind(function(){var cursorHead=editor.getCursor(\"head\");var cursorAnchor=editor.getCursor(\"anchor\");var isCollapsed=cursorHead.line===cursorAnchor.line&&cursorHead.ch===cursorAnchor.ch;if(!this._active||isCollapsed||this._active.ch!=cursorHead.ch||this._active.line!=cursorHead.line){this.clearActivePills()}},this),200,true);var debounceChange=debounce(bind(function(){editor.getTextArea().value=editor.getValue();this.parseReplacements()},this),200);editor.on(\"cursorActivity\",debounceCursorActivity);editor.on(\"change\",debounceChange);this.refresh();var inValue=null;editor.on(\"change\",function(){emitter.trigger(\"input\",{value:editor.getValue()})});editor.on(\"focus\",function(){inValue=editor.getValue()});wrapper.on(\"mousedown\",function(){emitter.trigger(\"mousedown\",{value:editor.getValue()})});wrapper.on(\"mouseup\",function(){emitter.trigger(\"mouseup\",{value:editor.getValue()})});editor.on(\"blur\",function(){if(inValue!==editor.getValue()){emitter.trigger(\"change\",{value:editor.getValue()})}inValue=null});this.enable()}PrettyPills.prototype={enabled:false,disable:function(){if(this.enabled){this.container.remove();this.textarea.show();this.enabled=false}},enable:function(){if(!this.enabled){this.setValue(this.textarea.val());this.container.insertAfter(this.textarea);this.textarea.hide();this.enabled=true}},refresh:function(){this.editor.refresh()},setActivePill:function(pill){var editor=this.editor;var emitter=this.emitter;this.clearActivePills();var replacedWith=pill.parentNode;var active=null;var pos=null;var text=null;var ch=null;var line=null;var marker=null;editor.getAllMarks().forEach(function(m){if(m.replacedWith===replacedWith){marker=m;active=m.replacedWith;pos=m.find()}});this.refresh();if(pos){text=editor.getRange(pos.from,pos.to);if(pos.from){line=pos.from.line;ch=pos.from.ch}}editor.focus();editor.setSelection(pos.from,pos.to);$(pill).addClass(\"active\");emitter.trigger(\"pillenter\",{coords:editor.cursorCoords(true),text:text,line:line,ch:ch});this._active=editor.getCursor()},clearActivePills:function(){var editor=this.editor;var emitter=this.emitter;this.container.find(\".pill.active\").removeClass(\"active\");if(this._active){emitter.trigger(\"pillleave\");delete this._active}},setOption:function(name,val){this.options[name]=val;this.parseReplacements()},getOption:function(name){return this.options[name]},setValue:function(val){this.editor.setValue(val);this.parseReplacements()},getValue:function(val){return this.editor.getValue()},getCursorCoords:function(name){return this.editor.cursorCoords(true)},on:function(type,f){this.emitter.on(type,f)},off:function(type,f){this.emitter.off(type,f)},getPill:function(text,className){var pill=document.createElement(\"span\");pill.textContent=text;pill.className=trim(\"pill \"+(className||\"\"));return pill},insertText:function(key,start){var editor=this.editor;start=start||editor.getCursor(\"start\");editor.focus();editor.replaceRange(key,start);this.parseReplacements()},replaceText:function(key,start,length){var editor=this.editor;start=start||editor.getCursor(\"start\");var to={line:start.line,ch:start.ch+length};editor.focus();editor.replaceRange(key,start,to);this.parseReplacements()},parseReplacements:function(){var editor=this.editor;var value=editor.getValue().split(\"\\n\");var replacements=this.options.replacements||{};var sel=editor.getCursor();var clearPillsOnEnter=this.options.clearPillsOnEnter;forEach(editor.getAllMarks(),function(m){m.clear()});if(!this.options.showPills){return}for(var i=0;i<value.length;i++){for(var j in replacements){var options=typeof replacements[j]===\"object\"?replacements[j]:{replaceWith:replacements[j]};var matchRegex=options.allowRegex?j:escapeRegExp(j);var matches=allMatches(value[i],matchRegex);for(var k=0;k<matches.length;k++){var match=matches[k][0];var replace=matches[k][1];var replaceWith=typeof options.replaceWith===\"function\"?options.replaceWith(replace):options.replaceWith;var p=getPillDOM(replaceWith,options.className);var insideSelection=sel.line===i&&sel.ch>=match&&sel.ch<match+replace.length;if(clearPillsOnEnter&&insideSelection){continue}var m=editor.markText({line:i,ch:match},{line:i,ch:match+replace.length},{replacedWith:p,clearOnEnter:clearPillsOnEnter,handleMouseEvents:true})}}}}};var defaults=PrettyPills.defaults={};defaults.showPills=true;defaults.clearPillsOnEnter=false;PrettyPills.fromTextArea=function(textarea,options,cmOptions){return new PrettyPills(textarea,options)};PrettyPills.MUSTACHE_MATCH=\"{{(?:(?!{{).)+}}\";function allMatches(str,regex){var reg=new RegExp(\"\"+regex+\"\",\"g\");var match;var params=[];while(match=reg.exec(str)){params.push([match.index,match[0]])}return params}function getPillDOM(text,className){var pill=document.createElement(\"span\");pill.textContent=text;pill.className=trim(\"pill \"+(className||\"\"));return pill}function debounce(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}}function escapeRegExp(str){return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,\"\\\\$&\")}function forEach(arr,fn){for(var i=0;i<arr.length;i++){fn.apply(arr[i],[arr[i],i])}}function trim(str){return $.trim(str)}function bind(fn,ctx){return $.proxy(fn,ctx)}function log(){if(window.console){if(Function.prototype.bind)log=Function.prototype.bind.call(console.log,console);else log=function(){Function.prototype.apply.call(console.log,console,arguments)};log.apply(this,arguments)}}PrettyPills.version=\"0.0.1+\";return PrettyPills}();(function(){var e=this;this.Stripe=function(){function e(){}return e.version=2,e.endpoint=\"https://api.stripe.com/v1\",e.validateCardNumber=function(t){return t=(t+\"\").replace(/\\s+|-/g,\"\"),t.length>=10&&t.length<=16&&e.luhnCheck(t)},e.validateCVC=function(t){return t=e.trim(t),/^\\d+$/.test(t)&&t.length>=3&&t.length<=4},e.validateExpiry=function(t,n){var r,i;return t=e.trim(t),n=e.trim(n),/^\\d+$/.test(t)?/^\\d+$/.test(n)?parseInt(t,10)<=12?(i=new Date(n,t),r=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>r):!1:!1:!1},e.cardType=function(t){return e.cardTypes[t.slice(0,2)]||\"Unknown\"},e.setPublishableKey=function(t){e.key=t},e.createToken=function(t,n,r){var i,s,o;n==null&&(n={});if(!t)throw\"card required\";if(typeof t!=\"object\")throw\"card invalid\";typeof n==\"function\"?(r=n,n={}):typeof n!=\"object\"&&(i=parseInt(n,10),n={},i>0&&(n.amount=i));for(s in t)o=t[s],delete t[s],t[e.underscore(s)]=o;return n.card=t,n.key||(n.key=e.key||e.publishableKey),e.validateKey(n.key),e.ajaxJSONP({url:\"\"+e.endpoint+\"/tokens\",data:n,method:\"POST\",success:function(e,t){return typeof r==\"function\"?r(t,e):void 0},complete:e.complete(r),timeout:4e4})},e.getToken=function(t,n){if(!t)throw\"token required\";return e.validateKey(e.key),e.ajaxJSONP({url:\"\"+e.endpoint+\"/tokens/\"+t,data:{key:e.key},success:function(e,t){return typeof n==\"function\"?n(t,e):void 0},complete:e.complete(n),timeout:4e4})},e.complete=function(e){return function(t,n,r){if(t!==\"success\")return typeof e==\"function\"?e(500,{error:{code:t,type:t,message:\"An unexpected error has occured.\\nWe have been notified of the problem.\"}}):void 0}},e.validateKey=function(e){if(!e||typeof e!=\"string\")throw new Error(\"You did not set a valid publishable key.\\nCall Stripe.setPublishableKey() with your publishable key.\\nFor more info, see https://stripe.com/docs/stripe.js\");if(/^sk_/.test(e))throw new Error(\"You are using a secret key with Stripe.js, instead of the publishable one.\\nFor more info, see https://stripe.com/docs/stripe.js\")},e}.call(this),typeof module!=\"undefined\"&&module!==null&&(module.exports=this.Stripe),typeof define==\"function\"&&define(\"stripe\",[],function(){return e.Stripe})}).call(this),function(){var e,t,n,r=[].slice;e=encodeURIComponent,t=(new Date).getTime(),n=function(t,r,i){var s,o;r==null&&(r=[]);for(s in t)o=t[s],i&&(s=\"\"+i+\"[\"+s+\"]\"),typeof o==\"object\"?n(o,r,s):r.push(\"\"+s+\"=\"+e(o));return r.join(\"&\").replace(/%20/g,\"+\")},this.Stripe.ajaxJSONP=function(e){var i,s,o,u,a,f;return e==null&&(e={}),o=\"sjsonp\"+ ++t,a=document.createElement(\"script\"),s=null,i=function(){var t;return(t=a.parentNode)!=null&&t.removeChild(a),o in window&&(window[o]=function(){}),typeof e.complete==\"function\"?e.complete(\"abort\",f,e):void 0},f={abort:i},a.onerror=function(){return f.abort(),typeof e.error==\"function\"?e.error(f,e):void 0},window[o]=function(){var t;t=1<=arguments.length?r.call(arguments,0):[],clearTimeout(s),a.parentNode.removeChild(a);try{delete window[o]}catch(n){window[o]=void 0}return typeof e.success==\"function\"&&e.success.apply(e,t),typeof e.complete==\"function\"?e.complete(\"success\",f,e):void 0},e.data||(e.data={}),e.data.callback=o,e.method&&(e.data._method=e.method),a.src=e.url+\"?\"+n(e.data),u=document.getElementsByTagName(\"head\")[0],u.appendChild(a),e.timeout>0&&(s=setTimeout(function(){return f.abort(),typeof e.complete==\"function\"?e.complete(\"timeout\",f,e):void 0},e.timeout)),f}}.call(this),function(){this.Stripe.trim=function(e){return(e+\"\").replace(/^\\s+|\\s+$/g,\"\")},this.Stripe.underscore=function(e){return(e+\"\").replace(/([A-Z])/g,function(e){return\"_\"+e.toLowerCase()})},this.Stripe.luhnCheck=function(e){var t,n,r,i,s,o;r=!0,i=0,n=(e+\"\").split(\"\").reverse();for(s=0,o=n.length;s<o;s++){t=n[s],t=parseInt(t,10);if(r=!r)t*=2;t>9&&(t-=9),i+=t}return i%10===0},this.Stripe.cardTypes=function(){var e,t,n,r;t={};for(e=n=40;n<=49;e=++n)t[e]=\"Visa\";for(e=r=50;r<=59;e=++r)t[e]=\"MasterCard\";return t[34]=t[37]=\"American Express\",t[60]=t[62]=t[64]=t[65]=\"Discover\",t[35]=\"JCB\",t[30]=t[36]=t[38]=t[39]=\"Diners Club\",t}()}.call(this);(function(root,factory){if(typeof exports===\"object\"&&exports){module.exports=factory}else if(typeof define===\"function\"&&define.amd){define(factory)}else{root.Mustache=factory}})(this,function(){var exports={};exports.name=\"mustache.js\";exports.version=\"0.7.2\";exports.tags=[\"{{\",\"}}\"];exports.Scanner=Scanner;exports.Context=Context;exports.Writer=Writer;var whiteRe=/\\s*/;var spaceRe=/\\s+/;var nonSpaceRe=/\\S/;var eqRe=/\\s*=/;var curlyRe=/\\s*\\}/;var tagRe=/#|\\^|\\/|>|\\{|&|=|!/;var _test=RegExp.prototype.test;var _toString=Object.prototype.toString;function testRe(re,string){return _test.call(re,string)}function isWhitespace(string){return!testRe(nonSpaceRe,string)}var isArray=Array.isArray||function(obj){return _toString.call(obj)===\"[object Array]\"};function escapeRe(string){return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\")}var entityMap={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"/\":\"&#x2F;\"};function escapeHtml(string){return String(string).replace(/[&<>\"'\\/]/g,function(s){return entityMap[s]})}exports.escape=escapeHtml;function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function(){return this.tail===\"\"};Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(match&&match.index===0){this.tail=this.tail.substring(match[0].length);this.pos+=match[0].length;return match[0]}return\"\"};Scanner.prototype.scanUntil=function(re){var match,pos=this.tail.search(re);switch(pos){case-1:match=this.tail;this.pos+=this.tail.length;this.tail=\"\";break;case 0:match=\"\";break;default:match=this.tail.substring(0,pos);this.tail=this.tail.substring(pos);this.pos+=pos}return match};function Context(view,parent){this.view=view;this.parent=parent;this._cache={}}Context.make=function(view){return view instanceof Context?view:new Context(view)};Context.prototype.push=function(view){return new Context(view,this)};Context.prototype.lookup=function(name){var value=this._cache[name];if(!value){if(name==\".\"){value=this.view}else{var context=this;while(context){if(name.indexOf(\".\")>0){value=context.view;var names=name.split(\".\"),i=0;while(value&&i<names.length){value=value[names[i++]]}}else{value=context.view[name]}if(value!=null)break;context=context.parent}}this._cache[name]=value}if(typeof value===\"function\")value=value.call(this.view);return value};function Writer(){this.clearCache()}Writer.prototype.clearCache=function(){this._cache={};this._partialCache={}};Writer.prototype.compile=function(template,tags){var fn=this._cache[template];if(!fn){var tokens=exports.parse(template,tags);fn=this._cache[template]=this.compileTokens(tokens,template)}return fn};Writer.prototype.compilePartial=function(name,template,tags){var fn=this.compile(template,tags);this._partialCache[name]=fn;return fn};Writer.prototype.getPartial=function(name){if(!(name in this._partialCache)&&this._loadPartial){this.compilePartial(name,this._loadPartial(name))}return this._partialCache[name]};Writer.prototype.compileTokens=function(tokens,template){var self=this;return function(view,partials){if(partials){if(typeof partials===\"function\"){self._loadPartial=partials}else{for(var name in partials){self.compilePartial(name,partials[name])}}}return renderTokens(tokens,self,Context.make(view),template)}};Writer.prototype.render=function(template,view,partials){return this.compile(template)(view,partials)};function renderTokens(tokens,writer,context,template){var buffer=\"\";var token,tokenValue,value;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];tokenValue=token[1];switch(token[0]){case\"#\":value=context.lookup(tokenValue);if(typeof value===\"object\"){if(isArray(value)){for(var j=0,jlen=value.length;j<jlen;++j){buffer+=renderTokens(token[4],writer,context.push(value[j]),template)}}else if(value){buffer+=renderTokens(token[4],writer,context.push(value),template)}}else if(typeof value===\"function\"){var text=template==null?null:template.slice(token[3],token[5]);value=value.call(context.view,text,function(template){return writer.render(template,context)});if(value!=null)buffer+=value}else if(value){buffer+=renderTokens(token[4],writer,context,template)}break;case\"^\":value=context.lookup(tokenValue);if(!value||isArray(value)&&value.length===0){buffer+=renderTokens(token[4],writer,context,template)}break;case\">\":value=writer.getPartial(tokenValue);if(typeof value===\"function\")buffer+=value(context);break;case\"&\":value=context.lookup(tokenValue);if(value!=null)buffer+=value;break;case\"name\":value=context.lookup(tokenValue);if(value!=null)buffer+=exports.escape(value);break;case\"text\":buffer+=tokenValue;break}}return buffer}function nestTokens(tokens){var tree=[];var collector=tree;var sections=[];var token;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];switch(token[0]){case\"#\":case\"^\":sections.push(token);collector.push(token);collector=token[4]=[];break;case\"/\":var section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:tree;break;default:collector.push(token)}}return tree}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];if(token){if(token[0]===\"text\"&&lastToken&&lastToken[0]===\"text\"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{lastToken=token;squashedTokens.push(token)}}}return squashedTokens}function escapeTags(tags){return[new RegExp(escapeRe(tags[0])+\"\\\\s*\"),new RegExp(\"\\\\s*\"+escapeRe(tags[1]))]}exports.parse=function(template,tags){template=template||\"\";tags=tags||exports.tags;if(typeof tags===\"string\")tags=tags.split(spaceRe);if(tags.length!==2)throw new Error(\"Invalid tags: \"+tags.join(\", \"));var tagRes=escapeTags(tags);var scanner=new Scanner(template);var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length){delete tokens[spaces.pop()]}}else{spaces=[]}hasTag=false;nonSpace=false}var start,type,value,chr,token;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(tagRes[0]);if(value){for(var i=0,len=value.length;i<len;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push([\"text\",chr,start,start+1]);start+=1;if(chr==\"\\n\")stripSpace()}}if(!scanner.scan(tagRes[0]))break;hasTag=true;type=scanner.scan(tagRe)||\"name\";scanner.scan(whiteRe);if(type===\"=\"){value=scanner.scanUntil(eqRe);scanner.scan(eqRe);scanner.scanUntil(tagRes[1])}else if(type===\"{\"){value=scanner.scanUntil(new RegExp(\"\\\\s*\"+escapeRe(\"}\"+tags[1])));scanner.scan(curlyRe);scanner.scanUntil(tagRes[1]);type=\"&\"}else{value=scanner.scanUntil(tagRes[1])}if(!scanner.scan(tagRes[1]))throw new Error(\"Unclosed tag at \"+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type===\"#\"||type===\"^\"){sections.push(token)}else if(type===\"/\"){if(sections.length===0)throw new Error('Unopened section \"'+value+'\" at '+start);var openSection=sections.pop();if(openSection[1]!==value)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+start)}else if(type===\"name\"||type===\"{\"||type===\"&\"){nonSpace=true}else if(type===\"=\"){tags=value.split(spaceRe);if(tags.length!==2)throw new Error(\"Invalid tags at \"+start+\": \"+tags.join(\", \"));tagRes=escapeTags(tags)}}var openSection=sections.pop();if(openSection)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+scanner.pos);tokens=squashTokens(tokens);return nestTokens(tokens)};var _writer=new Writer;exports.clearCache=function(){return _writer.clearCache()};exports.compile=function(template,tags){return _writer.compile(template,tags)};exports.compilePartial=function(name,template,tags){return _writer.compilePartial(name,template,tags)};exports.compileTokens=function(tokens,template){return _writer.compileTokens(tokens,template)\n};exports.render=function(template,view,partials){return _writer.render(template,view,partials)};exports.to_html=function(template,view,partials,send){var result=exports.render(template,view,partials);if(typeof send===\"function\"){send(result)}else{return result}};return exports}());if(typeof owl===\"undefined\")owl={};owl.pluralize=function(){var userDefined={};function capitalizeSame(word,sampleWord){if(sampleWord.match(/^[A-Z]/)){return word.charAt(0).toUpperCase()+word.slice(1)}else{return word}}function toKeys(keys){keys=keys.split(\",\");var keysLength=keys.length;var table={};for(var i=0;i<keysLength;i++){table[keys[i]]=1}return table}var uninflected=toKeys(\"aircraft,advice,blues,corn,molasses,equipment,gold,information,cotton,jewelry,kin,legislation,luck,luggage,moose,music,offspring,rice,silver,trousers,wheat,bison,bream,breeches,britches,carp,chassis,clippers,cod,contretemps,corps,debris,diabetes,djinn,eland,elk,flounder,gallows,graffiti,headquarters,herpes,high,homework,innings,jackanapes,mackerel,measles,mews,mumps,news,pincers,pliers,proceedings,rabies,salmon,scissors,sea,series,shears,species,swine,trout,tuna,whiting,wildebeest,pike,oats,tongs,dregs,snuffers,victuals,tweezers,vespers,pinchers,bellows,cattle\");var irregular={I:\"we\",you:\"you\",he:\"they\",it:\"they\",me:\"us\",you:\"you\",him:\"them\",them:\"them\",myself:\"ourselves\",yourself:\"yourselves\",himself:\"themselves\",herself:\"themselves\",itself:\"themselves\",themself:\"themselves\",oneself:\"oneselves\",child:\"children\",dwarf:\"dwarfs\",mongoose:\"mongooses\",mythos:\"mythoi\",ox:\"oxen\",soliloquy:\"soliloquies\",trilby:\"trilbys\",person:\"people\",forum:\"forums\",syllabus:\"syllabi\",alumnus:\"alumni\",genus:\"genera\",viscus:\"viscera\",stigma:\"stigmata\"};var suffixRules=[[/man$/i,\"men\"],[/([lm])ouse$/i,\"$1ice\"],[/tooth$/i,\"teeth\"],[/goose$/i,\"geese\"],[/foot$/i,\"feet\"],[/zoon$/i,\"zoa\"],[/([tcsx])is$/i,\"$1es\"],[/ix$/i,\"ices\"],[/^(cod|mur|sil|vert)ex$/i,\"$1ices\"],[/^(agend|addend|memorand|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi)um$/i,\"$1a\"],[/^(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|\\w+hedr)on$/i,\"$1a\"],[/^(alumn|alg|vertebr)a$/i,\"$1ae\"],[/([cs]h|ss|x)$/i,\"$1es\"],[/([aeo]l|[^d]ea|ar)f$/i,\"$1ves\"],[/([nlw]i)fe$/i,\"$1ves\"],[/([aeiou])y$/i,\"$1ys\"],[/(^[A-Z][a-z]*)y$/,\"$1ys\"],[/y$/i,\"ies\"],[/([aeiou])o$/i,\"$1os\"],[/^(pian|portic|albin|generalissim|manifest|archipelag|ghett|medic|armadill|guan|octav|command|infern|phot|ditt|jumb|pr|dynam|ling|quart|embry|lumbag|rhin|fiasc|magnet|styl|alt|contralt|sopran|bass|crescend|temp|cant|sol|kimon)o$/i,\"$1os\"],[/o$/i,\"oes\"],[/s$/i,\"ses\"]];function pluralize(word,count,plural){if(word===\"\")return\"\";if(count===1)return word;if(typeof plural===\"string\")return plural;var lowerWord=word.toLowerCase();if(lowerWord in userDefined){return capitalizeSame(userDefined[lowerWord],word)}if(word.match(/^[A-Z]$/))return word+\"'s\";if(word.match(/fish$|ois$|sheep$|deer$|pox$|itis$/i))return word;if(word.match(/^[A-Z][a-z]*ese$/))return word;if(lowerWord in uninflected)return word;if(lowerWord in irregular){return capitalizeSame(irregular[lowerWord],word)}var suffixRulesLength=suffixRules.length;for(var i=0;i<suffixRulesLength;i++){var rule=suffixRules[i];if(word.match(rule[0])){return word.replace(rule[0],rule[1])}}return word+\"s\"}pluralize.define=function(word,plural){userDefined[word.toLowerCase()]=plural};return pluralize}();owl.pluralize.define(\"emacs\",\"emacsen\");(function(){var async={};var root,previous_async;root=this;if(root!=null){previous_async=root.async}async.noConflict=function(){root.async=previous_async;return async};function only_once(fn){var called=false;return function(){if(called)throw new Error(\"Callback was already called.\");called=true;fn.apply(root,arguments)}}var _each=function(arr,iterator){if(arr.forEach){return arr.forEach(iterator)}for(var i=0;i<arr.length;i+=1){iterator(arr[i],i,arr)}};var _map=function(arr,iterator){if(arr.map){return arr.map(iterator)}var results=[];_each(arr,function(x,i,a){results.push(iterator(x,i,a))});return results};var _reduce=function(arr,iterator,memo){if(arr.reduce){return arr.reduce(iterator,memo)}_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)});return memo};var _keys=function(obj){if(Object.keys){return Object.keys(obj)}var keys=[];for(var k in obj){if(obj.hasOwnProperty(k)){keys.push(k)}}return keys};if(typeof process===\"undefined\"||!process.nextTick){if(typeof setImmediate===\"function\"){async.setImmediate=setImmediate;async.nextTick=setImmediate}else{async.setImmediate=async.nextTick;async.nextTick=function(fn){setTimeout(fn,0)}}}else{async.nextTick=process.nextTick;async.setImmediate=setImmediate}async.each=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;_each(arr,function(x){iterator(x,only_once(function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}}}))})};async.forEach=async.each;async.eachSeries=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;var iterate=function(){iterator(arr[completed],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}else{iterate()}}})};iterate()};async.forEachSeries=async.eachSeries;async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])};async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){callback=callback||function(){};if(!arr.length||limit<=0){return callback()}var completed=0;var started=0;var running=0;(function replenish(){if(completed>=arr.length){return callback()}while(running<limit&&started<arr.length){started+=1;running+=1;iterator(arr[started-1],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;running-=1;if(completed>=arr.length){callback()}else{replenish()}}})}})()}};var doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}};var doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}};var doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}};var _asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v;callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap);async.mapSeries=doSeries(_asyncMap);async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v;callback(err)})},function(err){callback(err,memo)})};async.inject=async.reduce;async.foldl=async.reduce;async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)};async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter);async.filterSeries=doSeries(_filter);async.select=async.filter;async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(!v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject);async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){if(result){main_callback(x);main_callback=function(){}}else{callback()}})},function(err){main_callback()})};async.detect=doParallel(_detect);async.detectSeries=doSeries(_detect);async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(v){main_callback(true);main_callback=function(){}}callback()})},function(err){main_callback(false)})};async.any=async.some;async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(!v){main_callback(false);main_callback=function(){}}callback()})},function(err){main_callback(true)})};async.all=async.every;async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){if(err){callback(err)}else{callback(null,{value:x,criteria:criteria})}})},function(err,results){if(err){return callback(err)}else{var fn=function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))}})};async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length){return callback(null)}var results={};var listeners=[];var addListener=function(fn){listeners.unshift(fn)};var removeListener=function(fn){for(var i=0;i<listeners.length;i+=1){if(listeners[i]===fn){listeners.splice(i,1);return}}};var taskComplete=function(){_each(listeners.slice(0),function(fn){fn()})};addListener(function(){if(_keys(results).length===keys.length){callback(null,results);callback=function(){}}});_each(keys,function(k){var task=tasks[k]instanceof Function?[tasks[k]]:tasks[k];var taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}if(err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]});safeResults[k]=args;callback(err,safeResults);callback=function(){}}else{results[k]=args;async.setImmediate(taskComplete)}};var requires=task.slice(0,Math.abs(task.length-1))||[];var ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},true)&&!results.hasOwnProperty(k)};if(ready()){task[task.length-1](taskCallback,results)}else{var listener=function(){if(ready()){removeListener(listener);task[task.length-1](taskCallback,results)}};addListener(listener)}})};async.waterfall=function(tasks,callback){callback=callback||function(){};if(tasks.constructor!==Array){var err=new Error(\"First argument to waterfall must be an array of functions\");return callback(err)}if(!tasks.length){return callback()}var wrapIterator=function(iterator){return function(err){if(err){callback.apply(null,arguments);callback=function(){}}else{var args=Array.prototype.slice.call(arguments,1);var next=iterator.next();if(next){args.push(wrapIterator(next))}else{args.push(callback)}async.setImmediate(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){eachfn.map(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)};async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)};async.series=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){async.mapSeries(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){if(tasks.length){tasks[index].apply(null,arguments)}return fn.next()};fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null};return fn};return makeCallback(0)};async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]);cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat);async.concatSeries=doSeries(_concat);async.whilst=function(test,iterator,callback){if(test()){iterator(function(err){if(err){return callback(err)}async.whilst(test,iterator,callback)})}else{callback()}};async.doWhilst=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(test()){async.doWhilst(iterator,test,callback)}else{callback()}})};async.until=function(test,iterator,callback){if(!test()){iterator(function(err){if(err){return callback(err)}async.until(test,iterator,callback)})}else{callback()}};async.doUntil=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(!test()){async.doUntil(iterator,test,callback)}else{callback()}})};async.queue=function(worker,concurrency){if(concurrency===undefined){concurrency=1}function _insert(q,data,pos,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){var item={data:task,callback:typeof callback===\"function\"?callback:null};if(pos){q.tasks.unshift(item)}else{q.tasks.push(item)}if(q.saturated&&q.tasks.length===concurrency){q.saturated()}async.setImmediate(q.process)})}var workers=0;var q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,push:function(data,callback){_insert(q,data,false,callback)},unshift:function(data,callback){_insert(q,data,true,callback)},process:function(){if(workers<q.concurrency&&q.tasks.length){var task=q.tasks.shift();if(q.empty&&q.tasks.length===0){q.empty()}workers+=1;var next=function(){workers-=1;if(task.callback){task.callback.apply(task,arguments)}if(q.drain&&q.tasks.length+workers===0){q.drain()}q.process()};var cb=only_once(next);worker(task.data,cb)}},length:function(){return q.tasks.length},running:function(){return workers}};return q};async.cargo=function(worker,payload){var working=false,tasks=[];var cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,push:function(data,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){tasks.push({data:task,callback:typeof callback===\"function\"?callback:null});if(cargo.saturated&&tasks.length===payload){cargo.saturated()}});async.setImmediate(cargo.process)},process:function process(){if(working)return;if(tasks.length===0){if(cargo.drain)cargo.drain();return}var ts=typeof payload===\"number\"?tasks.splice(0,payload):tasks.splice(0);var ds=_map(ts,function(task){return task.data});if(cargo.empty)cargo.empty();working=true;worker(ds,function(){working=false;var args=arguments;_each(ts,function(data){if(data.callback){data.callback.apply(null,args)}});process()})},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);if(typeof console!==\"undefined\"){if(err){if(console.error){console.error(err)}}else if(console[name]){_each(args,function(x){console[name](x)})}}}]))}};async.log=_console_fn(\"log\");async.dir=_console_fn(\"dir\");async.memoize=function(fn,hasher){var memo={};var queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments);var callback=args.pop();var key=hasher.apply(null,args);if(key in memo){callback.apply(null,memo[key])}else if(key in queues){queues[key].push(callback)}else{queues[key]=[callback];fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;i<l;i++){q[i].apply(null,arguments)}}]))}};memoized.memo=memo;memoized.unmemoized=fn;return memoized};async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}};async.times=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.map(counter,iterator,callback)};async.timesSeries=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.mapSeries(counter,iterator,callback)};async.compose=function(){var fns=Array.prototype.reverse.call(arguments);return function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0];var nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}};var _applyEach=function(eachfn,fns){var go=function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();return eachfn(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return go.apply(this,args)}else{return go}};async.applyEach=doParallel(_applyEach);async.applyEachSeries=doSeries(_applyEach);async.forever=function(fn,callback){function next(err){if(err){if(callback){return callback(err)}throw err}fn(next)}next()};if(typeof define!==\"undefined\"&&define.amd){define([],function(){return async})}else if(typeof module!==\"undefined\"&&module.exports){module.exports=async}else{root.async=async}})();(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!==\"undefined\"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION=\"0.9.10\";var _=root._;if(!_&&typeof require!==\"undefined\")_=require(\"underscore\");Backbone.$=root.jQuery||root.Zepto||root.ender;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var eventSplitter=/\\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name===\"object\"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}}else if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}}else{return true}};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args)}};var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,\"on\",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,\"once\",name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,\"off\",name,[callback,context]))return this;if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context){retain.push(ev)}}}if(!retain.length)delete this._events[name]}}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,\"trigger\",name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners)return this;if(obj){obj.off(name,typeof name===\"object\"?this:callback,this);if(!name&&!callback)delete listeners[obj._listenerId]}else{if(typeof name===\"object\")callback=this;for(var id in listeners){listeners[id].off(name,callback,this)}this._listeners={}}return this}};var listenMethods={listenTo:\"on\",listenToOnce:\"once\"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={});var id=obj._listenerId||(obj._listenerId=_.uniqueId(\"l\"));listeners[id]=obj;obj[implementation](name,typeof name===\"object\"?this:callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults;var attrs=attributes||{};this.cid=_.uniqueId(\"c\");this.attributes={};if(options&&options.collection)this.collection=options.collection;if(options&&options.parse)attrs=this.parse(attrs,options)||{};if(defaults=_.result(this,\"defaults\")){attrs=_.defaults({},attrs,defaults)}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:\"id\",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key===\"object\"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length)this._pending=true;for(var i=0,l=changes.length;i<l;i++){this.trigger(\"change:\"+changes[i],this,current[changes[i]],options)}}if(changing)return this;if(!silent){while(this._pending){this._pending=false;this.trigger(\"change\",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],val=diff[attr]))continue;(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;options.success=function(model,resp,options){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options)};return this.sync(\"read\",this,options)},save:function(key,val,options){var attrs,success,method,xhr,attributes=this.attributes;if(key==null||typeof key===\"object\"){attrs=key;options=val}else{(attrs={})[key]=val}if(attrs&&(!options||!options.wait)&&!this.set(attrs,options))return false;options=_.extend({validate:true},options);if(!this._validate(attrs,options))return false;if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0)options.parse=true;success=options.success;options.success=function(model,resp,options){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success)success(model,resp,options)};method=this.isNew()?\"create\":options.patch?\"patch\":\"update\";if(method===\"patch\")options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger(\"destroy\",model,model.collection,options)};options.success=function(model,resp,options){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options)};if(this.isNew()){options.success(this,null,options);return false}var xhr=this.sync(\"delete\",this,options);if(!options.wait)destroy();return xhr},url:function(){var base=_.result(this,\"urlRoot\")||_.result(this.collection,\"url\")||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)===\"/\"?\"\":\"/\")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger(\"invalid\",this,error,options||{});return false}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.url)this.url=options.url;if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options))};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,model,attrs,existing,doSort,add,at,sort,sortAttr;add=[];at=options.at;sort=this.comparator&&at==null&&options.sort!==false;sortAttr=_.isString(this.comparator)?this.comparator:null;for(i=0,l=models.length;i<l;i++){if(!(model=this._prepareModel(attrs=models[i],options))){this.trigger(\"invalid\",this,attrs,options);continue}if(existing=this.get(model)){if(options.merge){existing.set(attrs===model?model.attributes:attrs,options);if(sort&&!doSort&&existing.hasChanged(sortAttr))doSort=true}continue}add.push(model);model.on(\"all\",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model}if(add.length){if(sort)doSort=true;this.length+=add.length;if(at!=null){splice.apply(this.models,[at,0].concat(add))}else{push.apply(this.models,add)}}if(doSort)this.sort({silent:true});if(options.silent)return this;for(i=0,l=add.length;i<l;i++){(model=add[i]).trigger(\"add\",model,this,options)}if(doSort)this.trigger(\"sort\",this,options);return this},remove:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger(\"remove\",model,this,options)}this._removeReference(model)}return this},push:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:this.length},options));return model},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:0},options));return model},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){if(obj==null)return void 0;this._idAttr||(this._idAttr=this.model.prototype.idAttribute);return this._byId[obj.id||obj.cid||obj[this._idAttr]||obj]},at:function(index){return this.models[index]},where:function(attrs){if(_.isEmpty(attrs))return[];return this.filter(function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false}return true})},sort:function(options){if(!this.comparator){throw new Error(\"Cannot sort a set without a comparator\")}options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent)this.trigger(\"sort\",this,options);return this},pluck:function(attr){return _.invoke(this.models,\"get\",attr)},update:function(models,options){options=_.extend({add:true,merge:true,remove:true},options);if(options.parse)models=this.parse(models,options);var model,i,l,existing;var add=[],remove=[],modelMap={};if(!_.isArray(models))models=models?[models]:[];if(options.add&&!options.remove)return this.add(models,options);for(i=0,l=models.length;i<l;i++){model=models[i];existing=this.get(model);if(options.remove&&existing)modelMap[existing.cid]=true;if(options.add&&!existing||options.merge&&existing){add.push(model)}}if(options.remove){for(i=0,l=this.models.length;i<l;i++){model=this.models[i];if(!modelMap[model.cid])remove.push(model)}}if(remove.length)this.remove(remove,options);if(add.length)this.add(add,options);return this},reset:function(models,options){options||(options={});if(options.parse)models=this.parse(models,options);for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();if(models)this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger(\"reset\",this,options);return this},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;options.success=function(collection,resp,options){var method=options.update?\"update\":\"reset\";collection[method](resp,options);if(success)success(collection,resp,options)};return this.sync(\"read\",this,options)},create:function(model,options){options=options?_.clone(options):{};\nif(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(model,resp,options){if(options.wait)collection.add(model,options);if(success)success(model,resp,options)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection)attrs.collection=this;return attrs}options||(options={});options.collection=this;var model=new this.model(attrs,options);if(!model._validate(attrs,options))return false;return model},_removeReference:function(model){if(this===model.collection)delete model.collection;model.off(\"all\",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event===\"add\"||event===\"remove\")&&collection!==this)return;if(event===\"destroy\")this.remove(model,options);if(model&&event===\"change:\"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model}this.trigger.apply(this,arguments)},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)}});var methods=[\"forEach\",\"each\",\"map\",\"collect\",\"reduce\",\"foldl\",\"inject\",\"reduceRight\",\"foldr\",\"find\",\"detect\",\"filter\",\"select\",\"reject\",\"every\",\"all\",\"some\",\"any\",\"include\",\"contains\",\"invoke\",\"max\",\"min\",\"toArray\",\"size\",\"first\",\"head\",\"take\",\"initial\",\"rest\",\"tail\",\"drop\",\"last\",\"without\",\"indexOf\",\"shuffle\",\"lastIndexOf\",\"isEmpty\",\"chain\"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=[\"groupBy\",\"countBy\",\"sortBy\"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\\((.*?)\\)/g;var namedParam=/(\\(\\?)?:\\w+/g;var splatParam=/\\*\\w+/g;var escapeRegExp=/[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(!callback)callback=this[name];Backbone.history.route(route,_.bind(function(fragment){var args=this._extractParameters(route,fragment);callback&&callback.apply(this,args);this.trigger.apply(this,[\"route:\"+name].concat(args));this.trigger(\"route\",name,args);Backbone.history.trigger(\"route\",this,name,args)},this));return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes)return;var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,\"\\\\$&\").replace(optionalParam,\"(?:$1)?\").replace(namedParam,function(match,optional){return optional?match:\"([^/]+)\"}).replace(splatParam,\"(.*?)\");return new RegExp(\"^\"+route+\"$\")},_extractParameters:function(route,fragment){return route.exec(fragment).slice(1)}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,\"checkUrl\");if(typeof window!==\"undefined\"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\\/]|\\s+$/g;var rootStripper=/^\\/+|\\/+$/g;var isExplorer=/msie [\\w.]+/;var trailingSlash=/\\/$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:\"\"},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,\"\");if(!fragment.indexOf(root))fragment=fragment.substr(root.length)}else{fragment=this.getHash()}}return fragment.replace(routeStripper,\"\")},start:function(options){if(History.started)throw new Error(\"Backbone.history has already been started\");History.started=true;this.options=_.extend({},{root:\"/\"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);this.root=(\"/\"+this.root+\"/\").replace(rootStripper,\"/\");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src=\"javascript:0\" tabindex=\"-1\" />').hide().appendTo(\"body\")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on(\"popstate\",this.checkUrl)}else if(this._wantsHashChange&&\"onhashchange\"in window&&!oldIE){Backbone.$(window).on(\"hashchange\",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\\/]$/,\"$&/\")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+\"#\"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,\"\");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){Backbone.$(window).off(\"popstate\",this.checkUrl).off(\"hashchange\",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:options};fragment=this.getFragment(fragment||\"\");if(this.fragment===fragment)return;this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState){this.history[options.replace?\"replaceState\":\"pushState\"]({},document.title,url)}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}if(options.trigger)this.loadUrl(fragment)},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,\"\");location.replace(href+\"#\"+fragment)}else{location.hash=\"#\"+fragment}}});Backbone.history=new History;var View=Backbone.View=function(options){this.cid=_.uniqueId(\"view\");this._configure(options||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\\S+)\\s*(.*)$/;var viewOptions=[\"model\",\"collection\",\"el\",\"id\",\"attributes\",\"className\",\"tagName\",\"events\"];_.extend(View.prototype,Events,{tagName:\"div\",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this},delegateEvents:function(events){if(!(events||(events=_.result(this,\"events\"))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)throw new Error('Method \"'+events[key]+'\" does not exist');var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=\".delegateEvents\"+this.cid;if(selector===\"\"){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(\".delegateEvents\"+this.cid);return this},_configure:function(options){if(this.options)options=_.extend({},_.result(this,\"options\"),options);_.extend(this,_.pick(options,viewOptions));this.options=options},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,\"attributes\"));if(this.id)attrs.id=_.result(this,\"id\");if(this.className)attrs[\"class\"]=_.result(this,\"className\");var $el=Backbone.$(\"<\"+_.result(this,\"tagName\")+\">\").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,\"el\"),false)}}});var methodMap={create:\"POST\",update:\"PUT\",patch:\"PATCH\",\"delete\":\"DELETE\",read:\"GET\"};Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:\"json\"};if(!options.url){params.url=_.result(model,\"url\")||urlError()}if(options.data==null&&model&&(method===\"create\"||method===\"update\"||method===\"patch\")){params.contentType=\"application/json\";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType=\"application/x-www-form-urlencoded\";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type===\"PUT\"||type===\"DELETE\"||type===\"PATCH\")){params.type=\"POST\";if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader(\"X-HTTP-Method-Override\",type);if(beforeSend)return beforeSend.apply(this,arguments)}}if(params.type!==\"GET\"&&!options.emulateJSON){params.processData=false}var success=options.success;options.success=function(resp){if(success)success(model,resp,options);model.trigger(\"sync\",model,resp,options)};var error=options.error;options.error=function(xhr){if(error)error(model,xhr,options);model.trigger(\"error\",model,xhr,options)};var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger(\"request\",model,xhr,options);return xhr};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,\"constructor\")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A \"url\" property or function must be specified')}}).call(this);var Showdown={};Showdown.converter=function(){var g_urls;var g_titles;var g_html_blocks;var g_list_level=0;this.makeHtml=function(text){g_urls=new Array;g_titles=new Array;g_html_blocks=new Array;text=text.replace(/~/g,\"~T\");text=text.replace(/\\$/g,\"~D\");text=text.replace(/\\r\\n/g,\"\\n\");text=text.replace(/\\r/g,\"\\n\");text=\"\\n\\n\"+text+\"\\n\\n\";text=_Detab(text);text=text.replace(/^[ \\t]+$/gm,\"\");text=_HashHTMLBlocks(text);text=_StripLinkDefinitions(text);text=_RunBlockGamut(text);text=_UnescapeSpecialChars(text);text=text.replace(/~D/g,\"$$\");text=text.replace(/~T/g,\"~\");return text};var _StripLinkDefinitions=function(text){var text=text.replace(/^[ ]{0,3}\\[(.+)\\]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"(](.+?)[\")][ \\t]*)?(?:\\n+|\\Z)/gm,function(wholeMatch,m1,m2,m3,m4){m1=m1.toLowerCase();g_urls[m1]=_EncodeAmpsAndAngles(m2);if(m3){return m3+m4}else if(m4){g_titles[m1]=m4.replace(/\"/g,\"&quot;\")}return\"\"});return text};var _HashHTMLBlocks=function(text){text=text.replace(/\\n/g,\"\\n\\n\");var block_tags_a=\"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del\";var block_tags_b=\"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math\";text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\\b[^\\r]*?\\n<\\/\\2>[ \\t]*(?=\\n+))/gm,hashElement);text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\\b[^\\r]*?.*<\\/\\2>[ \\t]*(?=\\n+)\\n)/gm,hashElement);text=text.replace(/(\\n[ ]{0,3}(<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/(\\n\\n[ ]{0,3}<!(--[^\\r]*?--\\s*)+>[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/(?:\\n\\n)([ ]{0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/\\n\\n/g,\"\\n\");return text};var hashElement=function(wholeMatch,m1){var blockText=m1;blockText=blockText.replace(/\\n\\n/g,\"\\n\");blockText=blockText.replace(/^\\n/,\"\");blockText=blockText.replace(/\\n+$/g,\"\");blockText=\"\\n\\n~K\"+(g_html_blocks.push(blockText)-1)+\"K\\n\\n\";return blockText};var _RunBlockGamut=function(text){text=_DoHeaders(text);var key=hashBlock(\"<hr />\");text=text.replace(/^[ ]{0,2}([ ]?\\*[ ]?){3,}[ \\t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\\-[ ]?){3,}[ \\t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\\_[ ]?){3,}[ \\t]*$/gm,key);text=_DoLists(text);text=_DoCodeBlocks(text);text=_DoBlockQuotes(text);text=_HashHTMLBlocks(text);text=_FormParagraphs(text);return text};var _RunSpanGamut=function(text){text=_DoCodeSpans(text);text=_EscapeSpecialCharsWithinTagAttributes(text);text=_EncodeBackslashEscapes(text);text=_DoImages(text);text=_DoAnchors(text);text=_DoAutoLinks(text);text=_EncodeAmpsAndAngles(text);text=_DoItalicsAndBold(text);text=text.replace(/  +\\n/g,\" <br />\\n\");return text};var _EscapeSpecialCharsWithinTagAttributes=function(text){var regex=/(<[a-z\\/!$](\"[^\"]*\"|'[^']*'|[^'\">])*>|<!(--.*?--\\s*)+>)/gi;text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\\/?code>(?=.)/g,\"$1`\");tag=escapeCharacters(tag,\"\\\\`*_\");return tag});return text};var _DoAnchors=function(text){text=text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g,writeAnchorTag);text=text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\]\\([ \\t]*()<?(.*?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g,writeAnchorTag);text=text.replace(/(\\[([^\\[\\]]+)\\])()()()()()/g,writeAnchorTag);return text};var writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){if(m7==undefined)m7=\"\";var whole_match=m1;var link_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(url==\"\"){if(link_id==\"\"){link_id=link_text.toLowerCase().replace(/ ?\\n/g,\" \")}url=\"#\"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{if(whole_match.search(/\\(\\s*\\)$/m)>-1){url=\"\"}else{return whole_match}}}url=escapeCharacters(url,\"*_\");var result='<a href=\"'+url+'\"';if(title!=\"\"){title=title.replace(/\"/g,\"&quot;\");title=escapeCharacters(title,\"*_\");result+=' title=\"'+title+'\"'}result+=\">\"+link_text+\"</a>\";return result};var _DoImages=function(text){text=text.replace(/(!\\[(.*?)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g,writeImageTag);text=text.replace(/(!\\[(.*?)\\]\\s?\\([ \\t]*()<?(\\S+?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g,writeImageTag);return text};var writeImageTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1;var alt_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(!title)title=\"\";if(url==\"\"){if(link_id==\"\"){link_id=alt_text.toLowerCase().replace(/ ?\\n/g,\" \")}url=\"#\"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{return whole_match}}alt_text=alt_text.replace(/\"/g,\"&quot;\");url=escapeCharacters(url,\"*_\");var result='<img src=\"'+url+'\" alt=\"'+alt_text+'\"';title=title.replace(/\"/g,\"&quot;\");title=escapeCharacters(title,\"*_\");result+=' title=\"'+title+'\"';result+=\" />\";return result};var _DoHeaders=function(text){text=text.replace(/^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,function(wholeMatch,m1){return hashBlock('<h1 id=\"'+headerId(m1)+'\">'+_RunSpanGamut(m1)+\"</h1>\")});text=text.replace(/^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm,function(matchFound,m1){return hashBlock('<h2 id=\"'+headerId(m1)+'\">'+_RunSpanGamut(m1)+\"</h2>\")});text=text.replace(/^(\\#{1,6})[ \\t]*(.+?)[ \\t]*\\#*\\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return hashBlock(\"<h\"+h_level+' id=\"'+headerId(m2)+'\">'+_RunSpanGamut(m2)+\"</h\"+h_level+\">\")});function headerId(m){return m.replace(/[^\\w]/g,\"\").toLowerCase()}return text};var _ProcessListItems;var _DoLists=function(text){text+=\"~0\";var whole_list=/^(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;if(g_list_level){text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1;var list_type=m2.search(/[*+-]/g)>-1?\"ul\":\"ol\";list=list.replace(/\\n{2,}/g,\"\\n\\n\\n\");var result=_ProcessListItems(list);result=result.replace(/\\s+$/,\"\");result=\"<\"+list_type+\">\"+result+\"</\"+list_type+\">\\n\";return result})}else{whole_list=/(\\n\\n|^\\n?)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/g;text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1;var list=m2;var list_type=m3.search(/[*+-]/g)>-1?\"ul\":\"ol\";var list=list.replace(/\\n{2,}/g,\"\\n\\n\\n\");var result=_ProcessListItems(list);result=runup+\"<\"+list_type+\">\\n\"+result+\"</\"+list_type+\">\\n\";return result})}text=text.replace(/~0/,\"\");return text};_ProcessListItems=function(list_str){g_list_level++;list_str=list_str.replace(/\\n{2,}$/,\"\\n\");list_str+=\"~0\";list_str=list_str.replace(/(\\n)?(^[ \\t]*)([*+-]|\\d+[.])[ \\t]+([^\\r]+?(\\n{1,2}))(?=\\n*(~0|\\2([*+-]|\\d+[.])[ \\t]+))/gm,function(wholeMatch,m1,m2,m3,m4){var item=m4;var leading_line=m1;var leading_space=m2;if(leading_line||item.search(/\\n{2,}/)>-1){item=_RunBlockGamut(_Outdent(item))}else{item=_DoLists(_Outdent(item));item=item.replace(/\\n$/,\"\");item=_RunSpanGamut(item)}return\"<li>\"+item+\"</li>\\n\"});list_str=list_str.replace(/~0/g,\"\");g_list_level--;return list_str};var _DoCodeBlocks=function(text){text+=\"~0\";text=text.replace(/(?:\\n\\n|^)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1;var nextChar=m2;codeblock=_EncodeCode(_Outdent(codeblock));codeblock=_Detab(codeblock);codeblock=codeblock.replace(/^\\n+/g,\"\");codeblock=codeblock.replace(/\\n+$/g,\"\");codeblock=\"<pre><code>\"+codeblock+\"\\n</code></pre>\";return hashBlock(codeblock)+nextChar});text=text.replace(/~0/,\"\");return text};var hashBlock=function(text){text=text.replace(/(^\\n+|\\n+$)/g,\"\");return\"\\n\\n~K\"+(g_html_blocks.push(text)-1)+\"K\\n\\n\"};var _DoCodeSpans=function(text){text=text.replace(/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,function(wholeMatch,m1,m2,m3,m4){var c=m3;c=c.replace(/^([ \\t]*)/g,\"\");c=c.replace(/[ \\t]*$/g,\"\");c=_EncodeCode(c);return m1+\"<code>\"+c+\"</code>\"});return text};var _EncodeCode=function(text){text=text.replace(/&/g,\"&amp;\");text=text.replace(/</g,\"&lt;\");text=text.replace(/>/g,\"&gt;\");text=escapeCharacters(text,\"*_{}[]\\\\\",false);return text};var _DoItalicsAndBold=function(text){text=text.replace(/(\\*\\*|__)(?=\\S)([^\\r]*?\\S[*_]*)\\1/g,\"<strong>$2</strong>\");text=text.replace(/(\\*|_)(?=\\S)([^\\r]*?\\S)\\1/g,\"<em>$2</em>\");return text};var _DoBlockQuotes=function(text){text=text.replace(/((^[ \\t]*>[ \\t]?.+\\n(.+\\n)*\\n*)+)/gm,function(wholeMatch,m1){var bq=m1;bq=bq.replace(/^[ \\t]*>[ \\t]?/gm,\"~0\");bq=bq.replace(/~0/g,\"\");bq=bq.replace(/^[ \\t]+$/gm,\"\");bq=_RunBlockGamut(bq);bq=bq.replace(/(^|\\n)/g,\"$1  \");bq=bq.replace(/(\\s*<pre>[^\\r]+?<\\/pre>)/gm,function(wholeMatch,m1){var pre=m1;pre=pre.replace(/^  /gm,\"~0\");pre=pre.replace(/~0/g,\"\");return pre});return hashBlock(\"<blockquote>\\n\"+bq+\"\\n</blockquote>\")});return text};var _FormParagraphs=function(text){text=text.replace(/^\\n+/g,\"\");text=text.replace(/\\n+$/g,\"\");var grafs=text.split(/\\n{2,}/g);var grafsOut=new Array;var end=grafs.length;for(var i=0;i<end;i++){var str=grafs[i];if(str.search(/~K(\\d+)K/g)>=0){grafsOut.push(str)}else if(str.search(/\\S/)>=0){str=_RunSpanGamut(str);str=str.replace(/^([ \\t]*)/g,\"<p>\");str+=\"</p>\";grafsOut.push(str)}}end=grafsOut.length;for(var i=0;i<end;i++){while(grafsOut[i].search(/~K(\\d+)K/)>=0){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\\$/g,\"$$$$\");grafsOut[i]=grafsOut[i].replace(/~K\\d+K/,blockText)}}return grafsOut.join(\"\\n\\n\")};var _EncodeAmpsAndAngles=function(text){text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g,\"&amp;\");text=text.replace(/<(?![a-z\\/?\\$!])/gi,\"&lt;\");return text};var _EncodeBackslashEscapes=function(text){text=text.replace(/\\\\(\\\\)/g,escapeCharacters_callback);text=text.replace(/\\\\([`*_{}\\[\\]()>#+-.!])/g,escapeCharacters_callback);return text};var _DoAutoLinks=function(text){text=text.replace(/<((https?|ftp|dict):[^'\">\\s]+)>/gi,'<a href=\"$1\">$1</a>');text=text.replace(/<(?:mailto:)?([-.\\w]+\\@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi,function(wholeMatch,m1){return _EncodeEmailAddress(_UnescapeSpecialChars(m1))});return text};var _EncodeEmailAddress=function(addr){function char2hex(ch){var hexDigits=\"0123456789ABCDEF\";var dec=ch.charCodeAt(0);return hexDigits.charAt(dec>>4)+hexDigits.charAt(dec&15)}var encode=[function(ch){return\"&#\"+ch.charCodeAt(0)+\";\"},function(ch){return\"&#x\"+char2hex(ch)+\";\"},function(ch){return ch}];addr=\"mailto:\"+addr;addr=addr.replace(/./g,function(ch){if(ch==\"@\"){ch=encode[Math.floor(Math.random()*2)](ch)}else if(ch!=\":\"){var r=Math.random();ch=r>.9?encode[2](ch):r>.45?encode[1](ch):encode[0](ch)}return ch});addr='<a href=\"'+addr+'\">'+addr+\"</a>\";addr=addr.replace(/\">.+:/g,'\">');return addr};var _UnescapeSpecialChars=function(text){text=text.replace(/~E(\\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace)});return text};var _Outdent=function(text){text=text.replace(/^(\\t|[ ]{1,4})/gm,\"~0\");text=text.replace(/~0/g,\"\");return text};var _Detab=function(text){text=text.replace(/\\t(?=\\t)/g,\"    \");text=text.replace(/\\t/g,\"~A~B\");text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1,m2){var leadingText=m1;var numSpaces=4-leadingText.length%4;for(var i=0;i<numSpaces;i++)leadingText+=\" \";return leadingText});text=text.replace(/~A/g,\"    \");text=text.replace(/~B/g,\"\");return text};var escapeCharacters=function(text,charsToEscape,afterBackslash){var regexString=\"([\"+charsToEscape.replace(/([\\[\\]\\\\])/g,\"\\\\$1\")+\"])\";if(afterBackslash){regexString=\"\\\\\\\\\"+regexString}var regex=new RegExp(regexString,\"g\");text=text.replace(regex,escapeCharacters_callback);return text};var escapeCharacters_callback=function(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return\"~E\"+charCodeToEscape+\"E\"}};if(typeof exports!=\"undefined\")exports.Showdown=Showdown;CodeMirror.defineMode(\"javascript\",function(config,parserConfig){var indentUnit=config.indentUnit;var statementIndent=parserConfig.statementIndent;var jsonMode=parserConfig.json;var isTS=parserConfig.typescript;var keywords=function(){function kw(type){return{type:type,style:\"keyword\"}}var A=kw(\"keyword a\"),B=kw(\"keyword b\"),C=kw(\"keyword c\");var operator=kw(\"operator\"),atom={type:\"atom\",style:\"atom\"};var jsKeywords={\"if\":kw(\"if\"),\"while\":A,\"with\":A,\"else\":B,\"do\":B,\"try\":B,\"finally\":B,\"return\":C,\"break\":C,\"continue\":C,\"new\":C,\"delete\":C,\"throw\":C,\"var\":kw(\"var\"),\"const\":kw(\"var\"),let:kw(\"var\"),\"function\":kw(\"function\"),\"catch\":kw(\"catch\"),\"for\":kw(\"for\"),\"switch\":kw(\"switch\"),\"case\":kw(\"case\"),\"default\":kw(\"default\"),\"in\":operator,\"typeof\":operator,\"instanceof\":operator,\"true\":atom,\"false\":atom,\"null\":atom,undefined:atom,NaN:atom,Infinity:atom,\"this\":kw(\"this\"),module:kw(\"module\"),\"class\":kw(\"class\"),\"super\":kw(\"atom\"),yield:C,\"export\":kw(\"export\"),\"import\":kw(\"import\"),\"extends\":C};if(isTS){var type={type:\"variable\",style:\"variable-3\"};var tsKeywords={\"interface\":kw(\"interface\"),\"extends\":kw(\"extends\"),constructor:kw(\"constructor\"),\"public\":kw(\"public\"),\"private\":kw(\"private\"),\"protected\":kw(\"protected\"),\"static\":kw(\"static\"),string:type,number:type,bool:type,any:type};for(var attr in tsKeywords){jsKeywords[attr]=tsKeywords[attr]}}return jsKeywords}();var isOperatorChar=/[+\\-*&%=<>!?|~^]/;function nextUntilUnescaped(stream,end){var escaped=false,next;while((next=stream.next())!=null){if(next==end&&!escaped)return false;escaped=!escaped&&next==\"\\\\\"}return escaped}var type,content;function ret(tp,style,cont){type=tp;content=cont;return style}function tokenBase(stream,state){var ch=stream.next();if(ch=='\"'||ch==\"'\"){state.tokenize=tokenString(ch);return state.tokenize(stream,state)}else if(ch==\".\"&&stream.match(/^\\d+(?:[eE][+\\-]?\\d+)?/)){return ret(\"number\",\"number\")}else if(ch==\".\"&&stream.match(\"..\")){return ret(\"spread\",\"meta\")}else if(/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)){return ret(ch)}else if(ch==\"=\"&&stream.eat(\">\")){return ret(\"=>\")}else if(ch==\"0\"&&stream.eat(/x/i)){stream.eatWhile(/[\\da-f]/i);return ret(\"number\",\"number\")}else if(/\\d/.test(ch)){stream.match(/^\\d*(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/);return ret(\"number\",\"number\")}else if(ch==\"/\"){if(stream.eat(\"*\")){state.tokenize=tokenComment;return tokenComment(stream,state)}else if(stream.eat(\"/\")){stream.skipToEnd();return ret(\"comment\",\"comment\")}else if(state.lastType==\"operator\"||state.lastType==\"keyword c\"||state.lastType==\"sof\"||/^[\\[{}\\(,;:]$/.test(state.lastType)){nextUntilUnescaped(stream,\"/\");stream.eatWhile(/[gimy]/);return ret(\"regexp\",\"string-2\")}else{stream.eatWhile(isOperatorChar);return ret(\"operator\",null,stream.current())}}else if(ch==\"`\"){state.tokenize=tokenQuasi;return tokenQuasi(stream,state)}else if(ch==\"#\"){stream.skipToEnd();return ret(\"error\",\"error\")}else if(isOperatorChar.test(ch)){stream.eatWhile(isOperatorChar);return ret(\"operator\",null,stream.current())}else{stream.eatWhile(/[\\w\\$_]/);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return known&&state.lastType!=\".\"?ret(known.type,known.style,word):ret(\"variable\",\"variable\",word)}}function tokenString(quote){return function(stream,state){if(!nextUntilUnescaped(stream,quote))state.tokenize=tokenBase;return ret(\"string\",\"string\")}}function tokenComment(stream,state){var maybeEnd=false,ch;while(ch=stream.next()){if(ch==\"/\"&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd=ch==\"*\"}return ret(\"comment\",\"comment\")}function tokenQuasi(stream,state){var escaped=false,next;while((next=stream.next())!=null){if(!escaped&&(next==\"`\"||next==\"$\"&&stream.eat(\"{\"))){state.tokenize=tokenBase;break}escaped=!escaped&&next==\"\\\\\"}return ret(\"quasi\",\"string-2\",stream.current())}var brackets=\"([{}])\";function findFatArrow(stream,state){if(state.fatArrowAt)state.fatArrowAt=null;var arrow=stream.string.indexOf(\"=>\",stream.start);if(arrow<0)return;var depth=0,sawSomething=false;for(var pos=arrow-1;pos>=0;--pos){var ch=stream.string.charAt(pos);var bracket=brackets.indexOf(ch);if(bracket>=0&&bracket<3){if(!depth){++pos;break}if(--depth==0)break}else if(bracket>=3&&bracket<6){++depth}else if(/[$\\w]/.test(ch)){sawSomething=true}else if(sawSomething&&!depth){++pos;break}}if(sawSomething&&!depth)state.fatArrowAt=pos}var atomicTypes={atom:true,number:true,variable:true,string:true,regexp:true,\"this\":true};function JSLexical(indented,column,type,align,prev,info){this.indented=indented;this.column=column;this.type=type;this.prev=prev;this.info=info;if(align!=null)this.align=align}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return true;for(var cx=state.context;cx;cx=cx.prev){for(var v=cx.vars;v;v=v.next)if(v.name==varname)return true}}function parseJS(state,style,type,content,stream){var cc=state.cc;cx.state=state;cx.stream=stream;cx.marked=null,cx.cc=cc;if(!state.lexical.hasOwnProperty(\"align\"))state.lexical.align=true;while(true){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){while(cc.length&&cc[cc.length-1].lex)cc.pop()();if(cx.marked)return cx.marked;if(type==\"variable\"&&inScope(state,content))return\"variable-2\";return style}}}var cx={state:null,column:null,marked:null,cc:null};function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){pass.apply(null,arguments);return true}function register(varname){function inList(list){for(var v=list;v;v=v.next)if(v.name==varname)return true;return false}var state=cx.state;if(state.context){cx.marked=\"def\";if(inList(state.localVars))return;state.localVars={name:varname,next:state.localVars}}else{if(inList(state.globalVars))return;if(parserConfig.globalVars)state.globalVars={name:varname,next:state.globalVars}}}var defaultVars={name:\"this\",next:{name:\"arguments\"}};function pushcontext(){cx.state.context={prev:cx.state.context,vars:cx.state.localVars};cx.state.localVars=defaultVars}function popcontext(){cx.state.localVars=cx.state.context.vars;cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;if(state.lexical.type==\"stat\")indent=state.lexical.indented;state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};result.lex=true;return result}function poplex(){var state=cx.state;if(state.lexical.prev){if(state.lexical.type==\")\")state.indented=state.lexical.indented;state.lexical=state.lexical.prev}}poplex.lex=true;function expect(wanted){return function(type){if(type==wanted)return cont();else if(wanted==\";\")return pass();else return cont(arguments.callee)}}function statement(type,value){if(type==\"var\")return cont(pushlex(\"vardef\",value.length),vardef,expect(\";\"),poplex);if(type==\"keyword a\")return cont(pushlex(\"form\"),expression,statement,poplex);if(type==\"keyword b\")return cont(pushlex(\"form\"),statement,poplex);if(type==\"{\")return cont(pushlex(\"}\"),block,poplex);if(type==\";\")return cont();if(type==\"if\")return cont(pushlex(\"form\"),expression,statement,poplex,maybeelse);if(type==\"function\")return cont(functiondef);if(type==\"for\")return cont(pushlex(\"form\"),forspec,poplex,statement,poplex);if(type==\"variable\")return cont(pushlex(\"stat\"),maybelabel);if(type==\"switch\")return cont(pushlex(\"form\"),expression,pushlex(\"}\",\"switch\"),expect(\"{\"),block,poplex,poplex);if(type==\"case\")return cont(expression,expect(\":\"));if(type==\"default\")return cont(expect(\":\"));if(type==\"catch\")return cont(pushlex(\"form\"),pushcontext,expect(\"(\"),funarg,expect(\")\"),statement,poplex,popcontext);if(type==\"module\")return cont(pushlex(\"form\"),pushcontext,afterModule,popcontext,poplex);if(type==\"class\")return cont(pushlex(\"form\"),className,objlit,poplex);if(type==\"export\")return cont(pushlex(\"form\"),afterExport,poplex);if(type==\"import\")return cont(pushlex(\"form\"),afterImport,poplex);return pass(pushlex(\"stat\"),expression,expect(\";\"),poplex)}function expression(type){return expressionInner(type,false)}function expressionNoComma(type){return expressionInner(type,true)}function expressionInner(type,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if(type==\"(\")return cont(pushcontext,commasep(pattern,\")\"),expect(\"=>\"),body,popcontext);else if(type==\"variable\")return pass(pushcontext,pattern,expect(\"=>\"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;if(atomicTypes.hasOwnProperty(type))return cont(maybeop);if(type==\"function\")return cont(functiondef);\nif(type==\"keyword c\")return cont(noComma?maybeexpressionNoComma:maybeexpression);if(type==\"(\")return cont(pushlex(\")\"),maybeexpression,comprehension,expect(\")\"),poplex,maybeop);if(type==\"operator\"||type==\"spread\")return cont(noComma?expressionNoComma:expression);if(type==\"[\")return cont(pushlex(\"]\"),expressionNoComma,maybeArrayComprehension,poplex,maybeop);if(type==\"{\")return cont(commasep(objprop,\"}\"),maybeop);return cont()}function maybeexpression(type){if(type.match(/[;\\}\\)\\],]/))return pass();return pass(expression)}function maybeexpressionNoComma(type){if(type.match(/[;\\}\\)\\],]/))return pass();return pass(expressionNoComma)}function maybeoperatorComma(type,value){if(type==\",\")return cont(expression);return maybeoperatorNoComma(type,value,false)}function maybeoperatorNoComma(type,value,noComma){var me=noComma==false?maybeoperatorComma:maybeoperatorNoComma;var expr=noComma==false?expression:expressionNoComma;if(value==\"=>\")return cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext);if(type==\"operator\"){if(/\\+\\+|--/.test(value))return cont(me);if(value==\"?\")return cont(expression,expect(\":\"),expr);return cont(expr)}if(type==\"quasi\"){cx.cc.push(me);return quasi(value)}if(type==\";\")return;if(type==\"(\")return cont(commasep(expressionNoComma,\")\",\"call\"),me);if(type==\".\")return cont(property,me);if(type==\"[\")return cont(pushlex(\"]\"),maybeexpression,expect(\"]\"),poplex,me)}function quasi(value){if(!value)debugger;if(value.slice(value.length-2)!=\"${\")return cont();return cont(expression,continueQuasi)}function continueQuasi(type){if(type==\"}\"){cx.marked=\"string-2\";cx.state.tokenize=tokenQuasi;return cont()}}function arrowBody(type){findFatArrow(cx.stream,cx.state);if(type==\"{\")return pass(statement);return pass(expression)}function arrowBodyNoComma(type){findFatArrow(cx.stream,cx.state);if(type==\"{\")return pass(statement);return pass(expressionNoComma)}function maybelabel(type){if(type==\":\")return cont(poplex,statement);return pass(maybeoperatorComma,expect(\";\"),poplex)}function property(type){if(type==\"variable\"){cx.marked=\"property\";return cont()}}function objprop(type,value){if(type==\"variable\"){cx.marked=\"property\";if(value==\"get\"||value==\"set\")return cont(getterSetter)}else if(type==\"number\"||type==\"string\"){cx.marked=type+\" property\"}else if(type==\"[\"){return cont(expression,expect(\"]\"),afterprop)}if(atomicTypes.hasOwnProperty(type))return cont(afterprop)}function getterSetter(type){if(type!=\"variable\")return pass(afterprop);cx.marked=\"property\";return cont(functiondef)}function afterprop(type){if(type==\":\")return cont(expressionNoComma);if(type==\"(\")return pass(functiondef)}function commasep(what,end,info){function proceed(type){if(type==\",\"){var lex=cx.state.lexical;if(lex.info==\"call\")lex.pos=(lex.pos||0)+1;return cont(what,proceed)}if(type==end)return cont();return cont(expect(end))}return function(type){if(type==end)return cont();if(info===false)return pass(what,proceed);return pass(pushlex(end,info),what,proceed,poplex)}}function block(type){if(type==\"}\")return cont();return pass(statement,block)}function maybetype(type){if(isTS&&type==\":\")return cont(typedef)}function typedef(type){if(type==\"variable\"){cx.marked=\"variable-3\";return cont()}}function vardef(){return pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){if(type==\"variable\"){register(value);return cont()}if(type==\"[\")return cont(commasep(pattern,\"]\"));if(type==\"{\")return cont(commasep(proppattern,\"}\"))}function proppattern(type,value){if(type==\"variable\"&&!cx.stream.match(/^\\s*:/,false)){register(value);return cont(maybeAssign)}if(type==\"variable\")cx.marked=\"property\";return cont(expect(\":\"),pattern,maybeAssign)}function maybeAssign(_type,value){if(value==\"=\")return cont(expressionNoComma)}function vardefCont(type){if(type==\",\")return cont(vardef)}function maybeelse(type,value){if(type==\"keyword b\"&&value==\"else\")return cont(pushlex(\"form\"),statement,poplex)}function forspec(type){if(type==\"(\")return cont(pushlex(\")\"),forspec1,expect(\")\"))}function forspec1(type){if(type==\"var\")return cont(vardef,expect(\";\"),forspec2);if(type==\";\")return cont(forspec2);if(type==\"variable\")return cont(formaybeinof);return pass(expression,expect(\";\"),forspec2)}function formaybeinof(_type,value){if(value==\"in\"||value==\"of\"){cx.marked=\"keyword\";return cont(expression)}return cont(maybeoperatorComma,forspec2)}function forspec2(type,value){if(type==\";\")return cont(forspec3);if(value==\"in\"||value==\"of\"){cx.marked=\"keyword\";return cont(expression)}return pass(expression,expect(\";\"),forspec3)}function forspec3(type){if(type!=\")\")cont(expression)}function functiondef(type,value){if(value==\"*\"){cx.marked=\"keyword\";return cont(functiondef)}if(type==\"variable\"){register(value);return cont(functiondef)}if(type==\"(\")return cont(pushcontext,commasep(funarg,\")\"),statement,popcontext)}function funarg(type){if(type==\"spread\")return cont(funarg);return pass(pattern,maybetype)}function className(type,value){if(type==\"variable\"){register(value);return cont(classNameAfter)}}function classNameAfter(_type,value){if(value==\"extends\")return cont(expression)}function objlit(type){if(type==\"{\")return cont(commasep(objprop,\"}\"))}function afterModule(type,value){if(type==\"string\")return cont(statement);if(type==\"variable\"){register(value);return cont(maybeFrom)}}function afterExport(_type,value){if(value==\"*\"){cx.marked=\"keyword\";return cont(maybeFrom,expect(\";\"))}if(value==\"default\"){cx.marked=\"keyword\";return cont(expression,expect(\";\"))}return pass(statement)}function afterImport(type){if(type==\"string\")return cont();return pass(importSpec,maybeFrom)}function importSpec(type,value){if(type==\"{\")return cont(commasep(importSpec,\"}\"));if(type==\"variable\")register(value);return cont()}function maybeFrom(_type,value){if(value==\"from\"){cx.marked=\"keyword\";return cont(expression)}}function maybeArrayComprehension(type){if(type==\"for\")return pass(comprehension);if(type==\",\")return cont(commasep(expressionNoComma,\"]\",false));return pass(commasep(expressionNoComma,\"]\",false))}function comprehension(type){if(type==\"for\")return cont(forspec,comprehension);if(type==\"if\")return cont(expression,comprehension)}return{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:\"sof\",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,\"block\",false),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:0};if(parserConfig.globalVars)state.globalVars=parserConfig.globalVars;return state},token:function(stream,state){if(stream.sol()){if(!state.lexical.hasOwnProperty(\"align\"))state.lexical.align=false;state.indented=stream.indentation();findFatArrow(stream,state)}if(state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);if(type==\"comment\")return style;state.lastType=type==\"operator\"&&(content==\"++\"||content==\"--\")?\"incdec\":type;return parseJS(state,style,type,content,stream)},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical;for(var i=state.cc.length-1;i>=0;--i){var c=state.cc[i];if(c==poplex)lexical=lexical.prev;else if(c!=maybeelse)break}if(lexical.type==\"stat\"&&firstChar==\"}\")lexical=lexical.prev;if(statementIndent&&lexical.type==\")\"&&lexical.prev.type==\"stat\")lexical=lexical.prev;var type=lexical.type,closing=firstChar==type;if(type==\"vardef\")return lexical.indented+(state.lastType==\"operator\"||state.lastType==\",\"?lexical.info+1:0);else if(type==\"form\"&&firstChar==\"{\")return lexical.indented;else if(type==\"form\")return lexical.indented+indentUnit;else if(type==\"stat\")return lexical.indented+(state.lastType==\"operator\"||state.lastType==\",\"?statementIndent||indentUnit:0);else if(lexical.info==\"switch\"&&!closing&&parserConfig.doubleIndentSwitch!=false)return lexical.indented+(/^(?:case|default)\\b/.test(textAfter)?indentUnit:2*indentUnit);else if(lexical.align)return lexical.column+(closing?0:1);else return lexical.indented+(closing?0:indentUnit)},electricChars:\":{}\",blockCommentStart:jsonMode?null:\"/*\",blockCommentEnd:jsonMode?null:\"*/\",lineComment:jsonMode?null:\"//\",fold:\"brace\",helperType:jsonMode?\"json\":\"javascript\",jsonMode:jsonMode}});CodeMirror.defineMIME(\"text/javascript\",\"javascript\");CodeMirror.defineMIME(\"text/ecmascript\",\"javascript\");CodeMirror.defineMIME(\"application/javascript\",\"javascript\");CodeMirror.defineMIME(\"application/ecmascript\",\"javascript\");CodeMirror.defineMIME(\"application/json\",{name:\"javascript\",json:true});CodeMirror.defineMIME(\"application/x-json\",{name:\"javascript\",json:true});CodeMirror.defineMIME(\"text/typescript\",{name:\"javascript\",typescript:true});CodeMirror.defineMIME(\"application/typescript\",{name:\"javascript\",typescript:true});\n/*\n//@ sourceMappingURL=https://zapier.cachefly.net/static/CUEKpp/build/external.js.map\n*/"
      },
      "https://zapier.cachefly.net/static/CUEKpp/build/app.js": {
         "pageUrl": "https://zapier.com/app/signup",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEKpp/build/app.js",
         "body": "window.z={};z.cfg={};z.model={};z.ui={};z.controllers={};z.app={};z.jst={};z.useful={};z.store={};z.tests=window.tests;z.cfg.api=\"/api/v2\";z.cfg.newapi=\"/api/v2\";z.cfg.devapi=\"/api/developer/v1\";z.cfg.devpath=\"developer/v2/builder\";if(typeof DEBUG!==\"undefined\"&&DEBUG!==null)z.cfg.debug=DEBUG;if(typeof mediaUrl!==\"undefined\"&&mediaUrl!==null){z.cfg.mediaURL=mediaUrl}if(typeof path!==\"undefined\"&&path!==null)z.cfg.path=path;z.cfg.hasPushState=window.history.pushState!=null;if(typeof STRIPE_PUB_API_KEY!==\"undefined\"&&STRIPE_PUB_API_KEY!==null){z.cfg.stripePubApiKey=STRIPE_PUB_API_KEY}z.cfg.pubSub={};_.extend(z.cfg.pubSub,Backbone.Events);if(typeof TITLE_APPEND!==\"undefined\"&&TITLE_APPEND!==null){z.cfg.title=TITLE_APPEND}z.cfg.cursorLoadAnimTimeout=0;z.cfg.location=window.location;z.cfg.defaultSupportTags=\"default\";z.useful.pluralize=typeof owl!==\"undefined\"&&owl!==null?owl.pluralize:void 0;z.cfg.userfillOTag=\"{{\";z.cfg.userfillETag=\"}}\";if(typeof PARTNER_ENVIRONMENT!==\"undefined\"&&PARTNER_ENVIRONMENT!==null){z.cfg.partner=PARTNER_ENVIRONMENT}window.$(document).ready(function(){var $el,csrfSafeMethod,invalidatePersist,loadModels,postSizeEvents,sameOrigin,start,track,url,_this=this;if(!$.cookie(\"csrftoken\")){$.ajax(\"\"+z.cfg.api+\"/csrf\",{success:function(){var csrf;csrf=$.cookie(\"csrftoken\");z.cfg.renderContext.csrf=csrf;return $('input[name=\"csrfmiddlewaretoken\"]',document).val(csrf)}})}csrfSafeMethod=function(method){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(method)};sameOrigin=function(url){var host,origin,protocol,sr_origin;host=document.location.host;protocol=document.location.protocol;sr_origin=\"//\"+host;origin=protocol+sr_origin;return url===origin||url.slice(0,origin.length+1)===origin+\"/\"||url===sr_origin||url.slice(0,sr_origin.length+1)===sr_origin+\"/\"||!/^(\\/\\/|http:|https:).*/.test(url)};window.$(document).ajaxSend(function(event,xhr,settings){if(!csrfSafeMethod(settings.type)&&sameOrigin(settings.url)){return xhr.setRequestHeader(\"X-CSRFToken\",$.cookie(\"csrftoken\"))}});_.extend(z.app,Backbone.Events);z.cfg.browser=window.BrowserDetect.browser;z.cfg.isMobile=window.mobilecheck(0);z.cfg.renderContext={mediaURL:z.cfg.mediaURL,csrf:$.cookie(\"csrftoken\"),path:z.cfg.path,devpath:z.cfg.devpath,tests:z.tests};_.mixin(_.str.exports());_.str.include(\"Underscore.string\",\"string\");z.stripe=window.Stripe;z.stripe.setPublishableKey(z.cfg.stripePubApiKey);_.templateSettings={interpolate:/\\{\\{(.+?)\\}\\}/g};if(window.JST!=null)z.jst=window.JST;z.useful.clipboard=window.ZeroClipboard;z.useful.clipboard.setDefaults({moviePath:\"\"+z.cfg.mediaURL+\"images/flash/ZeroClipboard.swf\",trustedOrigins:[window.location.protocol+\"//\"+window.location.host],hoverClass:\"hover\",activeClass:\"active\",allowScriptAccess:\"always\"});$(\"img.retina\").retina();$(\".video\").loadYoutubeVideo();$el=$(z.useful.render(JST.common_login_modal({}))).addClass(\"hide\");$el.appendTo($(\"body\"));if(typeof preload!==\"undefined\"&&preload!==null?preload.account:void 0){url=_.result(z.model.Account.prototype,\"url\");Backbone.cache.set(url,typeof preload!==\"undefined\"&&preload!==null?preload.account:void 0);url=_.result(z.model.AccountLimits.prototype,\"url\");Backbone.cache.set(url,typeof preload!==\"undefined\"&&preload!==null?preload.account.limits:void 0)}z.app.errorHandler=new z.model.ErrorHandler;z.app.track=new z.model.Track;z.app.simple=new z.controllers.Simple;z.app.home=new z.controllers.Home;z.app.server=new z.controllers.Server;z.app.dashboard=new z.controllers.Dashboard;z.app.editor=new z.controllers.Editor;z.app.explore=new z.controllers.Explore;z.app.pricing=new z.controllers.Pricing;z.app.signup=new z.controllers.SignUp;z.app.zapbook=new z.controllers.Zapbook;z.app.status=new z.controllers.Status;z.app.settings=new z.controllers.Settings;z.app.history=new z.controllers.History;z.app.support=new z.controllers.Support;z.app.sharedzaps=new z.controllers.SharedZaps;z.app.developer=new z.controllers.Developer;z.app.topbar=new z.ui.TopBar({el:$(\".topbar\")});z.app.viewport=new z.ui.Viewport({el:$(\"body\")});z.app.support.view=new z.ui.Support({el:$(\"#support\")});z.app.preloader=new z.ui.Preloader({el:$(\"#app\")});z.app.partner=new z.model.Partner(z.cfg.partner);window.partnerChecks(window.location.pathname);if(z.app.partner.isPartnerSession()){postSizeEvents=function(){return _.defer(function(){var e,_ref;if(z.app.partner.hasIframeJs){e={event:\"resize\",height:$(\"body\").outerHeight(),width:$(\"body\").outerWidth()};return(_ref=window.top)!=null?_ref.postMessage(JSON.stringify(e),\"*\"):void 0}})};z.app.on(\"render\",postSizeEvents)}loadModels=function(cb){var _this=this;return async.parallel({account:async.fetch(new z.model.Account),accountLimits:async.fetch(new z.model.AccountLimits)},function(err,models){_.extend(z.app,models);if(err!=null)log(\"error: \",err,models);if(z.app.account.id!=null){$(\"#header .logo a\").attr(\"data-nav\",\"app/dashboard\")}z.app.topbar.render();z.app.support.view.render();return typeof cb===\"function\"?cb():void 0})};invalidatePersist=function(cb){var _this=this;return Backbone.cache.lawnchair.get(\"user\",function(obj){var callback,id;id=obj!=null?obj.id:void 0;callback=function(){return cb()};if(z.app.account.id!=null&&id!=null&&z.app.account.id!==id){return async.parallel([function(cb){return Backbone.cache.clear(\"user\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/account\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/read\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/write\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/stream\",cb,true)}],function(err,results){return Backbone.cache.set(null,null,callback,false,{key:\"user\",id:z.app.account.id})})}else if(z.app.account.id!=null){return async.parallel([function(cb){return Backbone.cache.clear(\"user\",cb,true)}],function(err,results){return Backbone.cache.set(null,null,callback,false,{key:\"user\",id:z.app.account.id})})}else{return typeof cb===\"function\"?cb():void 0}},true)};start=function(cb){var found;found=Backbone.history.start({hashChange:false,pushState:true,root:\"/\"});log(\"global environment `z`: \",z);if(!found&&_.str.startsWith(Backbone.history.fragment,\"app/\")){z.useful.goto(\"/404\")}return typeof cb===\"function\"?cb():void 0};track=function(cb){var cookie,count,haystack,name,referrer,route;haystack=window.location.pathname;referrer=document.referrer;name=\"zapier-visit\";cookie=z.store.get(name);if(!(cookie!=null)){z.store.set(name,\"true\");z.app.track[\"new\"](\"Visit Zapier (all)\",{referrer:referrer})}name=\"zapier-landing\";cookie=z.store.get(name);if(!(cookie!=null)){count=haystack.split(\"/\").length-1;if(count===0){route=\"home\"}else if(count===1){route=\"home\"}else if(_.str.include(haystack,\"zapbook\")&&count===2){route=\"zb no service\"}else if(_.str.include(haystack,\"zapbook\")&&count===3){route=\"zb one service\"}else if(_.str.include(haystack,\"zapbook\")&&count===4){route=\"zb two service\"}else if(_.str.include(haystack,\"zapbook\")&&count===5){route=\"zb recipe\"}else if(_.str.include(haystack,\"zapbook\")&&count===6){route=\"zb recipe\"}else{route=\"other\"}if(route!=null){z.store.set(name,\"true\");return z.app.track[\"new\"](\"Landing Page: \"+route,{path:haystack,referrer:referrer})}}};return async.series([loadModels,invalidatePersist,start,track])});var $,methods;$=jQuery;methods={insert:function(value){var after,before,o,pos;o=this[0];pos=methods[\"getCaretPosition\"].apply(this);before=o.value.substring(0,pos);after=o.value.substring(pos,o.value.length);$(o).val(before+value+after);pos+=value.length;methods[\"setCaretPosition\"].apply(this,[pos]);return pos},getCaretPosition:function(){var caretPos,o,sel;o=this[0];caretPos=0;if(document.selection){o.focus();sel=document.selection.createRange();sel.moveStart(\"character\",-o.value.length);caretPos=sel.text.length}else if(o.selectionStart||o.selectionStart===\"0\"){caretPos=o.selectionStart}return caretPos},setCaretPosition:function(pos){var f,o,_this=this;o=this[0];if(o.setSelectionRange){o.focus();return o.setSelectionRange(pos,pos)}else if(o.createTextRange){f=function(){return o.focus()};setTimeout(f,10);f=function(o,pos){var range;range=o.createTextRange();range.collapse(true);range.moveEnd(\"character\",pos);range.moveStart(\"character\",pos);return range.select()};setTimeout(function(){return f(o,pos)},20);return pos}}};$.fn.atCaret=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method===\"object\"||!method){return methods.init.apply(this,arguments)}else{return $.error(\"Method \"+method+\" does not exist on jQuery.atCaret\")}};z.store={length:function(){return window.localStorage.length},remove:_.bind(window.localStorage.removeItem,window.localStorage),clear:_.bind(window.localStorage.clear,window.localStorage),get:function(key){var expire,getItem,item,val;getItem=_.bind(window.localStorage.getItem,window.localStorage);item=getItem(key);try{item=JSON.parse(item);expire=item[0];try{val=JSON.parse(item[1])}catch(e){val=val}if(expire<(new Date).getTime()){val=null;z.store.remove(key)}}catch(e){val=null}return val},set:function(key,val,options){var expire,setItem;if(options==null)options={};expire=options!=null?options.expire:void 0;if(!(expire!=null))expire=1e3*60*60*24*365*100;expire+=(new Date).getTime();if(_.isObject(val))val=JSON.stringify(val);setItem=_.bind(window.localStorage.setItem,window.localStorage);return setItem(key,JSON.stringify([expire,val]))}};var getValue,indexedDBValid,methodMap,_this=this;if(!((typeof Backbone!==\"undefined\"&&Backbone!==null?Backbone.sync:void 0)!=null)){throw\"Backbone not ready yet\"}Backbone.cache={};Backbone.cache.store={};Backbone.cache.queue={};Backbone.cache.pending={};Backbone.cache.persistPending=0;Backbone.cache.lawnchair=new Lawnchair({},function(){});indexedDBValid=function(callback){var idb,request;try{idb=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB;if(!idb)return callback(false,1);request=idb.open(\"test\",3);request.onsuccess=function(){var lawnchair;try{lawnchair=new Lawnchair({},function(){});return lawnchair.save({key:\"test\",val:\"testy\"},function(){return lawnchair.get(\"test\",function(item){if(item[\"val\"]!==\"testy\"){return callback(false,5)}else{return callback(true)}})})}catch(e){return callback(false,5,e)}};return request.onerror=function(){return callback(false,3)}}catch(e){return callback(false,4,e)}};indexedDBValid(function(valid,why,e){var adapters;if(!valid){log(\"* Falling back to not using indexed-db adapater (is not available error code \"+why+\")\",e);adapters=_.filter(Lawnchair.adapters,function(adpt){return adpt.adapter!==\"indexed-db\"});adapters=_.map(adapters,function(adpt){return adpt.adapter});return Backbone.cache.lawnchair=new Lawnchair({adapter:adapters},function(){})}});_.extend(Backbone.cache,Backbone.Events);Backbone.cache.defaults={expiry:10*60*1e3};Backbone.cache.sync=Backbone.sync;methodMap={create:\"POST\",update:\"PUT\",\"delete\":\"DELETE\",read:\"GET\",patch:\"PATCH\"};getValue=function(object,prop){if(!(object!=null)||!(object[prop]!=null))return null;if(_.isFunction(object[prop]))return object[prop]();return object[prop]};Backbone.cache.set=function(key,resp,cb,noPersist,json){var error,message;if(noPersist==null)noPersist=false;if(json==null)json=null;key=_.str.trim(key);if(!(json!=null)){json={key:key,resp:resp}}if(key!=null)Backbone.cache.store[key]=json;try{if(!noPersist)return Backbone.cache.lawnchair.save(json,cb)}catch(e){message=\"CAUGHT: \"+e;error={message:message,url:window.path,linenumber:null,trace:null};return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:error}),url:z.cfg.api+\"/events/errors\",contentType:\"application/json\",dataType:\"json\"})}};Backbone.cache.get=function(key,cb,persist){key=_.str.trim(key);if(persist){if(key===\"all\"){return Backbone.cache.lawnchair.all(cb)}else{return Backbone.cache.lawnchair.get(key,cb)}}else{if(key===\"all\"){return typeof cb===\"function\"?cb(Backbone.cache.store):void 0}else{return typeof cb===\"function\"?cb(Backbone.cache.store[key]):void 0}}};Backbone.cache.clear=function(key,cb,persist,loose){if(loose==null)loose=true;key=_.str.trim(key);return Backbone.cache.get(\"all\",function(all){var deletes,filtered,item,_i,_len,_this=this;filtered=_.filter(all,function(item){if(loose){return _.str.include(item!=null?item.key:void 0,key)}else{return(item!=null?item.key:void 0)===key}});deletes=[];for(_i=0,_len=filtered.length;_i<_len;_i++){item=filtered[_i];deletes.push(function(cb){return Backbone.cache.lawnchair.remove(item.key,cb)});delete Backbone.cache.store[item.key]}return async.parallel(deletes,function(err,results){return typeof cb===\"function\"?cb():void 0})},persist)};Backbone.sync=function(method,model,options){var bc,cUrl,clearing,copyOptions,loose,type,url,_ref;if(options==null)options={};copyOptions=_.clone(options);type=methodMap[method];url=options.url!=null?options.url:getValue(model,\"url\");loose=options.loose;if(type===\"GET\"&&url!=null&&(options!=null?options.data:void 0)!=null&&!_.isEmpty(options!=null?options.data:void 0)){url+=_.str.include(url,\"?\")?\"&\":\"?\";url+=$.param(options.data)}if(options.cache===false||_.contains([\"PUT\",\"POST\",\"PATCH\",\"DELETE\"],type)){if(!options.persist){clearing=true;bc=options.cache===false?\"cache=false\":type;log(\"  clearing cache b/c \"+bc,url);if(url!=null)Backbone.cache.clear(url,null,null,loose);if(_.contains([\"DELETE\",\"PUT\"],type)&&(model!=null?(_ref=model.collection)!=null?_ref.url:void 0:void 0)!=null){cUrl=getValue(model.collection,\"url\");log(\"  also clearing cache b/c coll\",cUrl);Backbone.cache.clear(cUrl,null,null,loose)}if(options.cache!=null)delete options.cache}}return Backbone.cache.get(url,function(obj){var error,pending,queue,success,_ref2,_this=this;if(_.contains([\"GET\"],type)){if(obj!=null&&!clearing){log(\"+ from cache:\",url);options.success(model,obj.resp,options);if(options.persist){_.defer(function(){log(\"~ backgrounding real request\",url);copyOptions.cache=true;copyOptions.persist=false;copyOptions.update=true;copyOptions.success=function(){log(\"~~ background synced\",url);Backbone.cache.persistPending-=1;if(Backbone.cache.persistPending===0){return Backbone.cache.trigger(\"synced\")}};copyOptions.error=function(){Backbone.cache.persistPending-=1;if(Backbone.cache.persistPending===0){return Backbone.cache.trigger(\"synced\")}};Backbone.cache.persistPending+=1;if(Backbone.cache.persistPending===1){Backbone.cache.trigger(\"syncing\")}copyOptions.headers=_.extend({},copyOptions!=null?copyOptions.headers:void 0,{\"X-Can-304\":true});return model.fetch(copyOptions)})}model.trigger(\"sync\",model,obj.resp,options);return}if((pending=Backbone.cache.pending[url])!=null){pending.unshift({method:method,model:model,options:options});return}success=options!=null?options.success:void 0;options.success=function(model,resp,opts){var item,_ref2,_ref3;Backbone.cache.set(url,resp,function(){},model.noPersist);opts.success=success;pending=(_ref2=Backbone.cache.pending[url])!=null?_ref2:[{method:method,model:model,options:opts}];_.each(pending,function(item){var _base;return typeof(_base=item.options).success===\"function\"?_base.success(item.model,resp,item.options):void 0});delete Backbone.cache.pending[url];item=(_ref3=Backbone.cache.queue[url])!=null?_ref3.shift():void 0;if(item!=null){model.set(item.json);return Backbone.sync(method,model,item.options)}};error=options!=null?options.error:void 0;options.error=function(model,resp,opts){var item,_ref2,_ref3;opts.error=error;pending=(_ref2=Backbone.cache.pending[url])!=null?_ref2:[{method:method,model:model,options:opts}];_.each(pending,function(item){var _base;return typeof(_base=item.options).error===\"function\"?_base.error(item.model,resp,item.options):void 0});delete Backbone.cache.pending[url];item=(_ref3=Backbone.cache.queue[url])!=null?_ref3.shift():void 0;if(item!=null){model.set(item.json);return Backbone.sync(method,model,item.options)}}}if(_.contains([\"PUT\"],type)){if((pending=Backbone.cache.pending[url])!=null){queue=(_ref2=Backbone.cache.queue[url])!=null?_ref2:[];queue.push({options:options,json:model.toJSON()});Backbone.cache.queue[url]=queue;log(\"? locking request for later\",url);return}}log(\"- \"+type+\" request:\",url);return Backbone.cache.sync(method,model,options)},options!=null?options.persist:void 0)};_.mixin({compactObject:function(obj){_.each(obj,function(v,k){if(!v)return delete obj[k]});return obj},superHumanize:function(string){var humanize,out,subs,words;humanize=function(str){return _.str.capitalize(_.str.underscored(str).replace(/_/g,\" \"))};out=_.str.titleize(humanize(string));words=_.str.words(out);subs={Url:\"URL\",Uri:\"URI\",Html:\"HTML\",Id:\"ID\",id:\"ID\"};_.each(subs,function(v,k){var index;index=words.indexOf(k);if(index!==-1)return words[index]=v});return words.join(\" \")},wordenshtein:function(str1,str2){str1=str1.toLowerCase().replace(/[^\\w ]/g,\" \");str1=_.str.words(str1).sort().join(\" \");str2=str2.toLowerCase().replace(/[^\\w ]/g,\" \");str2=_.str.words(str2).sort().join(\" \");return _.str.levenshtein(str1,str2)},flattenObj:function(input,splitter){var flatObject,k,output,x;if(splitter==null)splitter=\"__\";output={};for(k in input){if(!input.hasOwnProperty(k))continue;if(typeof input[k]===\"object\"){flatObject=this.flattenObj(input[k],splitter);for(x in flatObject){if(!flatObject.hasOwnProperty(x))continue;output[k+splitter+x]=flatObject[x]}}else{output[k]=input[k]}}return output},unflatten:function(input,splitter){var k,key,output,part,parts,t;if(splitter==null)splitter=\"__\";output={};for(k in input){t=output;parts=k.split(splitter);key=parts.pop();while(parts.length){part=parts.shift();t=t[part]=t[part]||{}}t[key]=input[k]}return output}});var $;$=jQuery;$.fn.extend({setMode:function(state,group){var mode,re;group=group||\"mode\";re=new RegExp(\"\\\\w+_\"+group+\"(\\\\s|$)\",\"g\");mode=!(state!=null)?\"\":state+\"_\"+group;this.each(function(){return this.className=(this.className.replace(re,\"\")+\" \"+mode).replace(/\\s\\s/g,\" \")});return mode},hasMode:function(state,group){var has,mode,re;group=group||\"mode\";re=new RegExp(\"\\\\w+_\"+group+\"(\\\\s|$)\",\"g\");mode=!(state!=null)?\"\":state+\"_\"+group;has=$(this).hasClass(mode);return has}});$.fn.retina=function(retina_part){var settings;settings={retina_part:\"@2x\"};if(retina_part){jQuery.extend(settings,{retina_part:retina_part})}if(window.devicePixelRatio>=2){this.each(function(index,el){var checkForRetina,new_image_src;el=$(el);if(!el.attr(\"src\"))return;checkForRetina=new RegExp(\"(.+)(\"+settings[\"retina_part\"]+\"\\\\.\\\\w{3,4})\");if(checkForRetina.test(el.attr(\"src\")))return;new_image_src=el.attr(\"src\").replace(/(.+)(\\.\\w{3,4})$/,\"$1\"+settings[\"retina_part\"]+\"$2\");return $.ajax({url:new_image_src,type:\"HEAD\",success:function(){el.attr(\"height\",el.height());el.attr(\"width\",el.width());return el.attr(\"src\",new_image_src)}})})}return this};$.fn.loadYoutubeVideo=function(){var t,youtubeId;t=$(this);youtubeId=t.attr(\"data-youtubeid\");t.on(\"click\",function(){t.removeClass(\"video\");return t.html('<iframe class=\"\" width=\"460\" height=\"259\" src=\"https://www.youtube.com/embed/'+youtubeId+'?rel=0&amp;wmode=transparent&amp;showinfo=0&amp;theme=light&amp;autohide=1&amp;autoplay=1\" frameborder=\"0\" allowfullscreen></iframe>')});return this};var __slice=Array.prototype.slice;Handlebars.registerHelper(\"render\",function(templateString,options){var c,rendered;if(!(templateString!=null))return;c=_.extend({},options!=null?options.hash:void 0,options!=null?options.hash.context:void 0);rendered=Handlebars.compile(templateString)(c);return rendered});Handlebars.registerHelper(\"JST\",function(name,options){var rendered,_ref;rendered=JST[name](options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0);return new Handlebars.SafeString(rendered)});Handlebars.registerHelper(\"slugify\",function(string){return _.str.slugify(string)});Handlebars.registerHelper(\"try\",function(){var options,tries,value,_i,_this=this;tries=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.find(tries,function(each,i){value=_.result(tries,i);if(value!=null&&value!==\"\")return true});if(!(value!=null))value=_.last(tries);value=_.result([value],0);return value});Handlebars.registerHelper(\"filter\",function(array,filter,options){var buffer,context,render,_ref,_this=this;buffer=\"\";if(array instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;array=array.apply(context,null)}if((array!=null?array.length:void 0)>0){render=function(each){if(context=filter(each))return buffer+=options.fn(context)};if(array instanceof Backbone.Collection){array.each(function(each){return render(each)})}else if(array instanceof Array){_.each(array,function(each){return render(each)})}return buffer}else{return options.inverse(this)}});Handlebars.registerHelper(\"each\",function(array,options){var buffer,context,count,max,meta,renderArray,renderHash,_ref,_ref2,_this=this;buffer=\"\";count=0;max=options!=null?(_ref=options.hash)!=null?_ref.max:void 0:void 0;meta=function(each){if(count%2===0)each._even=true;if(count%2!==0)each._odd=true;each._idx=count;count=count+1;return each};renderArray=function(each){each=meta(each);if(max!=null&&count>max)return;return buffer+=options.fn(each)};renderHash=function(value,key){var each;each={key:key,value:value};each=meta(each);if(max!=null&&count>max)return;return buffer+=options.fn(each)};if(array instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;array=array.apply(context,null)}if(array instanceof Backbone.Collection&&(array!=null?array.length:void 0)>0){array.each(function(each){return renderArray(each)})}else if(array instanceof Array&&(array!=null?array.length:void 0)>0){_.each(array,function(each){return renderArray(each)})}else if(array instanceof Object){_.each(array,function(val,key){return renderHash(val,key)})}if(buffer!==\"\")return buffer;return options.inverse(this)});Handlebars.registerHelper(\"paginate\",function(coll,options){var buffer,onCurrentPage,render,_this=this;buffer=\"\";onCurrentPage=function(index,page,perPage){if((page-1)*perPage<=index&&index<page*perPage)return true;return false};render=function(each,index){var page,perPage;page=coll.frontendPagination.page;if(!(page!=null))page=1;perPage=coll.frontendPagination.perPage;if(!(perPage!=null))perPage=100;if(onCurrentPage(index,page,perPage))return buffer+=options.fn(each)};if((coll!=null?coll.length:void 0)>0?coll instanceof Backbone.Collection:void 0){coll.each(function(each,idx){return render(each,idx)})}if(buffer!==\"\")return buffer;return options.inverse(this)});Handlebars.registerHelper(\"log\",function(thing){log(\"(from template): \",thing);return\"\"});Handlebars.registerHelper(\"get\",function(model,key,options){var context,_ref,_ref2;context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;return model!=null?(_ref2=model.get)!=null?_ref2.call(context,key):void 0:void 0});Handlebars.registerHelper(\"call\",function(){var args,context,func,options,_i,_ref;func=arguments[0],args=3<=arguments.length?__slice.call(arguments,1,_i=arguments.length-1):(_i=1,[]),options=arguments[_i++];context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;return func!=null?func.apply(context,args):void 0});Handlebars.registerHelper(\"humanize\",function(string,key,options){return _.str.humanize(string)});Handlebars.registerHelper(\"ellipsis\",function(max,options){var string;string=options.fn(this);string=_.truncate(string,max,\"...\");return string});Handlebars.registerHelper(\"plural\",function(options){var plural,string,_ref;string=options.fn(this);plural=z.useful.pluralize(string.toLowerCase(),(_ref=options.hash)!=null?_ref.count:void 0);return plural});Handlebars.registerHelper(\"article\",function(options){var article,letter,string,v,vowel,vowels,_i,_len,_ref;string=options.fn(this);vowels=[\"a\",\"e\",\"i\",\"o\",\"u\"];vowel=false;letter=string.toLowerCase()[0];for(_i=0,_len=vowels.length;_i<_len;_i++){v=vowels[_i];if(letter===v)vowel=true}if(vowel)article=\"an \";if(!vowel)article=\"a \";if((_ref=options.hash)!=null?_ref.capitalize:void 0){article=_.str.capitalize(article)}return article+string});Handlebars.registerHelper(\"if\",function(value,options){var context,_ref;if(value instanceof Handlebars.SafeString)value=value.string;if(value instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value=value.apply(context,null)}value=Boolean(value);if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"unless\",function(value,options){var context,_ref;if(value instanceof Handlebars.SafeString)value=value.string;if(value instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value=value.apply(context,null)}value=Boolean(value);if(value!=null&&value){return options.inverse(this)}else{return options.fn(this)}});Handlebars.registerHelper(\"and\",function(){var ands,options,value,_i,_this=this;ands=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.all(ands,function(each,i){var context,_ref;if(each instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||_this;each=each.apply(context,null)}if(each!=null&&each)return true});if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"neither\",function(){var neithers,options,value,_i,_this=this;neithers=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.all(neithers,function(each,i){value=_.result(neithers,i);if(value!=null&&!value)return true});if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"or\",function(value1,value2,options){var context,_ref,_ref2;if(value1 instanceof Handlebars.SafeString)value1=value1.string;if(value2 instanceof Handlebars.SafeString)value2=value2.string;if(value1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value1=value1.apply(context,null)}if(value2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;value2=value2.apply(context,null)}if(value1!=null&&value1||value2!=null&&value2){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"hasAtLeastOne\",function(object,options){var context,_ref;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if(object instanceof Backbone.Collection&&(object!=null?object.length:void 0)>0){return options.fn(this)}else if(object instanceof Array&&(object!=null?object.length:void 0)>0){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"range\",function(number,options){var buffer,i,_ref;buffer=\"\";for(i=1,_ref=Number(number)+1;1<=_ref?i<_ref:i>_ref;1<=_ref?i++:i--){buffer+=options.fn(_.extend(this,{i:i}))}return buffer});Handlebars.registerHelper(\"hasExactly\",function(object,count,options){var context,_ref;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if(object instanceof Backbone.Collection&&(object!=null?object.length:void 0)===count){return options.fn(this)}else if(object instanceof Array&&(object!=null?object.length:void 0)===count){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"equals\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(val1===val2||String(val1)===String(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"notequals\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(val1!==val2&&String(val1)!==String(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"greater\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(Number(val1)>Number(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"less\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(Number(val1)<Number(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"contains\",function(haystack,needle,options){var context,_ref,_ref2;if(haystack instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;haystack=haystack.apply(context,null)}if(needle instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;needle=needle.apply(context,null)}if(_.isArray(haystack)){if(_.any(haystack,function(each){return each===needle})){return options.fn(this)}else{return options.inverse(this)}}if(_.isString(haystack)){if(_.str.include(haystack,needle)){return options.fn(this)}else{return options.inverse(this)}}});Handlebars.registerHelper(\"count\",function(object,options){var context,filtered,_ref,_ref2;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if((options!=null?(_ref2=options.hash)!=null?_ref2.filter:void 0:void 0)!=null){filtered=_.filter(object,function(each){return options!=null?options.hash.filter(each):void 0})}else{filtered=object}if(filtered!=null)return filtered.length;return\"0\"});Handlebars.registerHelper(\"appNameFromKey\",function(key){var s;s=z.app.services.get(key);if((s!=null?s.getName:void 0)!=null)return s.getName();return\"\"});Handlebars.registerHelper(\"prettyISO\",function(string){return z.useful.prettyISO(string)});Handlebars.registerHelper(\"toDollars\",function(int){var cents,dollars;int=Number(int);if(int>0){dollars=Math.floor(int/100)}else if(int<0){dollars=Math.ceil(int/100)}else{dollars=0}cents=\"0\"+(int-dollars*100);return dollars+\".\"+cents.substr(cents.length-2)});Handlebars.registerHelper(\"copyOverride\",function(service,action,which,copy,options){var override;override=service!=null?service.getCopyOverride(action,which,copy):void 0;if(override!=null)return override;return options.fn(this)});var useful,__indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};useful={QueryString:function(){function _Class(queryString){var pair,_ref;this.queryString=queryString;this.queryString||(this.queryString=(_ref=window.document.location.search)!=null?_ref.substr(1):void 0);this.pairs=Array();this.object={};if(__indexOf.call(this.queryString,\"=\")>=0){this.variables=this.queryString.split(\"&\");this.pairs=function(){var _i,_len,_ref2,_results;_ref2=this.variables;_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++){pair=_ref2[_i];_results.push(pair.split(\"=\"))}return _results\n}.call(this);this.object=_.object(this.pairs||Array())}}return _Class}(),prettyISO:function(string){var dt;dt=new Date(string);return dt.toLocaleDateString()+\" \"+dt.toLocaleTimeString()},summarize:function(data,max){var pos,s;if(max==null)max=50;if(!(data!=null)||data.length<max)return data;pos=Math.round(data.length/2)-Math.round(max/2);s=String(data).substr(pos,max).replace(/(\\r\\n|\\n|\\r)/gm,\"\");data=\"... \"+s+\" ...\";return data},whatPage:function(haystack,needle,perPage){var idx;idx=1;_.each(haystack,function(each,i){if(each===needle)return idx=i+1});return Math.ceil(idx/perPage)},maxPage:function(haystack,perPage){return Math.ceil(haystack.length/perPage)},errors:function(xhr){var body,error,_ref,_ref2,_ref3;try{body=JSON.parse(xhr.responseText);error=(body!=null?(_ref=body.error)!=null?_ref.join(\" \"):void 0:void 0)||(body!=null?(_ref2=body.errors)!=null?_ref2.join(\" \"):void 0:void 0)}catch(_error){}if(!error){if(xhr.status!=null&&xhr.statusText!=null){error=xhr.status+\": \"+xhr.statusText}else{error=(_ref3=xhr.responseText)!=null?_ref3.substring(0,150):void 0}}return error},open:function(url,target,options){var win;if(target==null)target=\"_blank\";win=typeof window!==\"undefined\"&&window!==null?window.open(url,target,options):void 0;win.focus();return win},\"goto\":function(url){return typeof window!==\"undefined\"&&window!==null?window.location.href=url:void 0},template:function(templateString){var _this=this;return function(){var context;if(arguments[0]===false)return templateString;z.app.trigger(\"render\");context=_.defaults({},z.cfg.renderContext,{z:z},arguments[0]);return z.useful.render(templateString,context)}},render:function(templateString,context,options){var rendered;rendered=Handlebars.compile(templateString,options).call(this,context);return rendered},chunks:function(array,chunkSize){return[].concat.apply([],_.map(array,function(item,i){return i%chunkSize?[]:[array.slice(i,i+chunkSize)]}))},equalChunks:function(array,chunks){var chunked;chunked=this.chunks(array,Math.ceil(array.length/chunks));return[].concat.apply([],_.map(_.range(chunks),function(item,i){return[chunked[i]||[]]}))},markdown:function(string){var converter;converter=new Showdown.converter;return converter.makeHtml(string)},placeholders:function($el){var _this=this;return _.defer(function(){var _ref;return $el!=null?(_ref=$el.find(\"input, textarea\"))!=null?_ref.placeholder():void 0:void 0})},viewportSize:function(){var viewPortHeight,viewPortWidth;if(typeof window.innerWidth!==\"undefined\"){viewPortWidth=window.innerWidth;viewPortHeight=window.innerHeight}else if(typeof document.documentElement!==\"undefined\"&&typeof document.documentElement.clientWidth!==\"undefined\"&&document.documentElement.clientWidth!==0){viewPortWidth=document.documentElement.clientWidth;viewPortHeight=document.documentElement.clientHeight}else{viewPortWidth=document.getElementsByTagName(\"body\")[0].clientWidth;viewPortHeight=document.getElementsByTagName(\"body\")[0].clientHeight}return[viewPortWidth,viewPortHeight]},viewportScroll:function(){var scrollx,scrolly;scrollx=$(window).scrollLeft();scrolly=$(window).scrollTop();return[scrollx,scrolly]},elClippedByScreenBottom:function(el){var edges,offset,size,viewport;offset=$(el).offset();offset.left=offset.left-z.useful.viewportScroll()[0];offset.top=offset.top-z.useful.viewportScroll()[1];size={width:$(el).outerWidth(),height:$(el).outerHeight()};viewport=z.useful.viewportSize();edges=[];edges.push(offset.top+size.height>viewport[1]);return _.any(edges,function(edge){return edge})},squish:function(string){return string.replace(/\\s/g,\"\")},noBGScroll:function(el){z.useful.noBGScrollOff(el);return $(el).on(\"mousewheel DOMMouseScroll\",function(e){var scrollTo;scrollTo=null;if(e.type===\"mousewheel\"){scrollTo=e.originalEvent.wheelDelta*-1}else if(e.type===\"DOMMouseScroll\"){scrollTo=40*e.originalEvent.detail}if(scrollTo){e.preventDefault();return $(this).scrollTop(scrollTo+$(this).scrollTop())}})},noBGScrollOff:function(el){return el.off(\"mousewheel DOMMouseScroll\")},refreshChrome:function(options){var _this=this;return $.ajax(\"/chrome.html\",{success:function(html){var $dom,$footer,$header;$dom=$(\"<div>\").html(html);$header=$dom.find(\"#header\");$footer=$dom.find(\"#footer\");$(\"#header\").replaceWith($header);$(\"#footer\").replaceWith($footer);return options!=null?options.success.apply(_this,arguments):void 0},error:function(){return options!=null?options.error.apply(_this,arguments):void 0}})},orderRelative:function(fullSeries,partialSeries){var orderRelative,orderedFullSeries;orderedFullSeries=_.sortBy(fullSeries,function(){return arguments[0]});orderRelative=_.map(partialSeries,function(i){return _.indexOf(orderedFullSeries,i)});if(_.any(orderRelative,function(i){return i===-1})){return false}orderRelative=_.map(orderRelative,function(i){return i+1});return orderRelative},getUserTimezone:function(){return this._calculateTimeZone()+\"\"},_calculateTimeZone:function(){var daylightTimeOffset,dst,hemisphere,jan1,jan2,june1,june2,rightNow,stdTimeOffset,temp;rightNow=new Date;jan1=new Date(rightNow.getFullYear(),0,1,0,0,0,0);june1=new Date(rightNow.getFullYear(),6,1,0,0,0,0);temp=jan1.toGMTString();jan2=new Date(temp.substring(0,temp.lastIndexOf(\" \")-1));temp=june1.toGMTString();june2=new Date(temp.substring(0,temp.lastIndexOf(\" \")-1));stdTimeOffset=(jan1-jan2)/(1e3*60*60);daylightTimeOffset=(june1-june2)/(1e3*60*60);dst=void 0;if(stdTimeOffset===!daylightTimeOffset){hemisphere=stdTimeOffset-daylightTimeOffset;if(hemisphere>=0)stdTimeOffset=daylightTimeOffset}return this._convert(stdTimeOffset)},_convert:function(value){var displayHours,hours,mins,secs;hours=parseInt(value);value-=parseInt(value);value*=60;mins=parseInt(value);value-=parseInt(value);value*=60;secs=parseInt(value);displayHours=hours;if(hours===0){displayHours=\"00\"}else if(hours>0){displayHours=hours<10?\"+0\"+hours:\"+\"+hours}else{displayHours=hours>-10?\"-0\"+Math.abs(hours):hours}mins=mins<10?\"0\"+mins:mins;return parseInt(displayHours).toFixed(1)}};_.extend(z.useful,useful);window.JST=useful.template;async.fetch=function(model,options){return function(callback){return model.fetch({cache:(options!=null?options.cache:void 0)!=null?options.cache:true,persist:(options!=null?options.persist:void 0)!=null?options.persist:false,success:function(results){return callback(null,model)},error:function(err){if(options!=null?options.canFail:void 0){return callback(null,model)}else{return callback(err,model)}}})}};Backbone.View.prototype.setMode=function(mode,group,el){if(this.state.get(group)===mode&&!(el!=null))return;if(!(mode!=null))return;if(mode===true)mode=\"is\";if(mode===false)mode=\"not\";$(el||this.el).setMode(mode,group);if(!(el!=null))this.state.set(group,mode);return z.app.trigger(\"render\")};Backbone.View.prototype.hasMode=function(mode,group,el){return $(el||this.el).hasMode(mode,group)};Backbone.View.prototype._remove=Backbone.View.prototype.remove;Backbone.View.prototype.remove=function(){this.trigger(\"remove\");this.off();this.$el.off();this._remove();return this};Backbone.Events._on=Backbone.Events.on;Backbone.Events.on=function(events,callback,context){this._on.apply(this,arguments);if(_.isObject(context)&&context.listenTo!=null){context.listenTo.call(context,this,name,callback)}return this};Backbone.Events.listenTo=function(object,events,callback){var listeners=this._listeners||(this._listeners={});var id=object._listenerId||(object._listenerId=_.uniqueId(\"l\"));listeners[id]=object;return this};_.extend(Backbone.View.prototype,Backbone.Events);_.extend(Backbone.Model.prototype,Backbone.Events);_.extend(Backbone.Collection.prototype,Backbone.Events);_.extend(Backbone.Router.prototype,Backbone.Events);z.model.Base=Backbone.Model.extend({initialize:function(attrs,options){var _this=this;this.loaded=attrs!=null;this.once(\"sync\",function(){return _this.loaded=true});if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}if(attrs!=null)arguments[0]=this.parse(attrs);return Backbone.Model.prototype.initialize.apply(this,arguments)}});z.model.BaseSet=Backbone.Collection.extend({initialize:function(models,options){var _this=this;this.loaded=models!=null;this.once(\"sync\",function(){return _this.loaded=true});if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}if(models!=null&&_.any(models,function(model){return!(model instanceof Backbone.Model)})){arguments[0]=this.parse(models)}return Backbone.Collection.prototype.initialize.apply(this,arguments)},parse:function(response){return response.objects||response}});z.model.Store=Backbone.Collection.extend({retrieve:function(model,Model,strict){var found,id,v,_this=this;if(strict==null)strict=false;id=Number(model.id);v=this.find(function(v){if(id===v.get(\"id\")||!strict&&v.get(\"model\")instanceof Model){return true}});found=v!=null?v.get(\"model\"):void 0;if(found!=null&&found instanceof Backbone.Model){found.set(_.extend(found.toJSON(),model.toJSON()));if(model.collection!=null)found.collection=model.collection}return found},inject:function(model,Model){var v;v=new Backbone.Model({id:Number(model.id),Model:model,model:model});this.add(v);return v!=null?v.get(\"model\"):void 0}});z.model.Singleton=function(Model,options){var Singleton,construct,store;construct=function(){var child;child=function(args){return Model.apply(this,args)};child.prototype=Model.prototype;return function(args){return new child(args)}};Model.prototype.store=new z.model.Store;store=Model.prototype.store;return Singleton=function(){function Singleton(){var model,single;model=construct()(arguments);single=store.retrieve(model,Model,options!=null?options.strict:void 0)||store.inject(model,Model);return single}return Singleton}()};z.model.StrictSingleton=function(Model){return z.model.Singleton(Model,{strict:true})};z.model.PaginationSet=z.model.BaseSet.extend({initialize:function(attrs,options){var pagination,_this=this;z.model.BaseSet.prototype.initialize.apply(this,arguments);pagination=(options!=null?options.pagination:void 0)||{};pagination=_.defaults(pagination,{perPage:15,page:1,pages:void 0,total:void 0,prev:void 0,next:void 0});this.pagination=new z.model.Base(pagination);this.paginationStore=this.pagination.toJSON();return this.pagination.on(\"change reset\",function(){_this.paginationStore=_this.pagination.toJSON();return _this.fetch()},this)},parse:function(response){var pagination;if(_.isArray(response))return response;pagination={perPage:response.per_page,page:response.page,pages:response.pages,total:response.total,prev:response.prev_url,next:response.next_url};this.pagination.set(pagination,{silent:true});this.pagination.set({hasPrev:this.hasPrev(),hasNext:this.hasNext()},{silent:true});return response.objects},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,{per_page:this.pagination.get(\"perPage\"),page:this.pagination.get(\"page\")});return z.model.BaseSet.prototype.fetch.call(this,options)},serverPrev:function(options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([_.max([page-1,1]),pages]),options)},serverNext:function(options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([page+1,pages]),options)},serverPage:function(target,options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([_.max([target,1]),pages]),options)},serverPageReset:function(options){if(options==null)options={};return this.pagination.set(\"page\",1,options)},hasPrev:function(){return this.pagination.get(\"page\")>1},hasNext:function(){return this.pagination.get(\"page\")<this.pagination.get(\"pages\")},count:function(){var count,total;total=this.pagination.get(\"total\");count=total!=null?total:this.length;return count}});z.model.Node=z.model.Base.extend({initialize:function(attrs,options){},getService:function(){return z.app.services.get(this.get(\"selected_api\"))},serviceImageClass:function(key){var _ref;if(key==null)key=\"32x32\";return(_ref=this.getService(z.app.services))!=null?_ref.getImageClass(key):void 0},serviceImageStyle:function(key){var _ref;if(key==null)key=\"32x32\";return(_ref=this.getService(z.app.services))!=null?_ref.getImageStyle(key):void 0},getParams:function(){return this.get(\"params\")},needsAuth:function(){var needsAuth,upfronts,_ref;upfronts=(_ref=z.app.services.get(this.get(\"selected_api\")))!=null?_ref.get(\"upfront_fields\"):void 0;needsAuth=upfronts!=null&&upfronts.length>0?true:false;return needsAuth},hasAuth:function(){if(!this.needsAuth())return true;if(this.needsAuth()&&this.get(\"authentication_id\")!=null)return true},isRead:function(){return this.get(\"write_ids\")!=null},isWrite:function(){return this.get(\"read_id\")!=null}});z.model.NodeSet=z.model.BaseSet.extend({model:z.model.Node});z.model.Write=z.model.StrictSingleton(z.model.Node.extend({urlRoot:z.cfg.api+\"/writes\",customNeeds:[],customGives:[],initialize:function(attrs,options){return z.model.Node.prototype.initialize.apply(this,arguments)},parse:function(response){if(response[\"lastchanged\"]!=null)delete response[\"lastchanged\"];if(response[\"date\"]!=null){this.date=new Date(response[\"date\"]);delete response[\"date\"]}return response},isComplete:function(){if(this.id!=null&&this.get(\"selected_api\")!=null&&this.get(\"action\")!=null&&this.get(\"read_id\")!=null&&this.get(\"errors\").length===0){return true}else{return false}},getActionMeta:function(){var _ref;return(_ref=this.getService())!=null?_ref.getActionMeta(this.get(\"action\"),\"write\"):void 0},getActionNoun:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s.getActionName(this.get(\"action\"),\"write\",\"true\");return noun},getActionLabel:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s.getActionName(this.get(\"action\"),\"write\",\"false\");return noun},write:function(action,data,options){var syncOptions,_this=this;syncOptions={url:\"\"+this.url()+\"/write/\"+action,type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)},canShare:function(){var globalService,_ref;globalService=(_ref=this.getService())!=null?_ref.get(\"public\"):void 0;return globalService}}));z.model.WriteSet=z.model.Singleton(z.model.NodeSet.extend({model:z.model.Write,url:z.cfg.api+\"/writes\"}));z.model.SavableSortSet=z.model.BaseSet.extend({saveSort:function(options){var syncOptions;syncOptions={type:\"PUT\",url:\"\"+this.url()+\"/sort\",data:JSON.stringify({ordering:this.map(function(field){return field.id})}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0,cache:false};return Backbone.sync(\"update\",this,syncOptions)}});z.model.DeveloperApp=z.model.Base.extend({urlRoot:z.cfg.devapi+\"/apps\",isEditable:function(){return z.app.account.get(\"is_staff\")===true||this.get(\"status\")===0},parse:function(json){this.authFields=new z.model.DeveloperAppAuthFieldSet(json.auth_fields,{app:this});this.triggers=new z.model.DeveloperAppTriggerSet(json.triggers,{app:this});this.actions=new z.model.DeveloperAppActionSet(json.actions,{app:this});return json},stats:function(){var stats;stats=[];_.each(this.get(\"stats\"),function(items,type){return _.each(items,function(values,label){var item;item={Type:type,Label:label};return stats.push(_.extend(item,values))})});stats=new z.model.BaseSet(stats,{model:z.model.Base});return stats}});z.model.DeveloperAppSet=z.model.BaseSet.extend({model:z.model.DeveloperApp,url:z.cfg.devapi+\"/apps\"});z.model.DeveloperAppAuthField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/auth_fields\";z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppAuthFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppAuthField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/auth_fields\"}});z.model.DeveloperAppTrigger=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/triggers\";z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(json){this.fields=new z.model.DeveloperAppTriggerFieldSet(json.fields,{app:this.app,trigger:this});return json}});z.model.DeveloperAppTriggerSet=z.model.BaseSet.extend({model:z.model.DeveloperAppTrigger,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/triggers\"},comparator:function(item){var index;index=1;if(item.get(\"important\"))index=0;if(item.get(\"hide\"))index=2;return index}});z.model.DeveloperAppTriggerField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+(\"/apps/\"+this.app.get(\"id\")+\"/triggers/\"+options.trigger.get(\"id\")+\"/fields\");z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppTriggerFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppTriggerField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/triggers/\"+this.options.trigger.id+\"/fields\"}});z.model.DeveloperAppTriggerSampleResult=z.model.Base.extend({idAttribute:\"sample\",initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+(\"/apps/\"+this.options.appId+\"/triggers/\"+this.options.triggerId+\"/sample_result\")}});z.model.DeveloperAppAction=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/actions\";z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(json){this.fields=new z.model.DeveloperAppActionFieldSet(json.fields,{app:this.app,action:this});return json}});z.model.DeveloperAppActionSet=z.model.BaseSet.extend({model:z.model.DeveloperAppAction,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/actions\"},comparator:function(item){var index;index=1;if(item.get(\"important\"))index=0;if(item.get(\"hide\"))index=2;return index}});z.model.DeveloperAppActionField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+(\"/apps/\"+this.app.get(\"id\")+\"/actions/\"+options.action.get(\"id\")+\"/fields\");z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppActionFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppActionField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/actions/\"+this.options.action.id+\"/fields\"}});z.model.DeveloperAppActivationRequest=z.model.Base.extend({initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/activation\"}});z.model.DeveloperAppAudit=z.model.Base.extend({initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},hasErrors:function(){return!$.isEmptyObject(this.get(\"errors\"))},url:function(){var url,_ref;url=z.cfg.devapi+\"/apps/\"+this.options.appId+\"/audit\";if((_ref=this.options)!=null?_ref.compareTo:void 0){url+=\"?compare_to=\"+this.options.compareTo}return url}});z.model.Recipe=z.model.Base.extend({urlRoot:z.cfg.api+\"/recipes\",noPersist:true,createRead:function(cb){var _this=this;this.read=new z.model.Read;return this.read.save(this.get(\"read_data\"),{success:function(){return typeof cb===\"function\"?cb():void 0}})},createWrite:function(cb){var data,_this=this;this.write=new z.model.Write;data=_.clone(this.get(\"write_data\"));data.read_id=this.read.id;return this.write.save(data,{success:function(){return typeof cb===\"function\"?cb():void 0}})},startUsing:function(options){var _this=this;if(options==null)options={};return async.series([function(cb){return _this.createRead(cb)},function(cb){return _this.createWrite(cb)}],function(err,models){if(err!=null){if(options!=null){if(typeof options.error===\"function\")options.error(err)}}(new z.model.ReadSet).fetch({cache:false,add:true});(new z.model.WriteSet).fetch({cache:false,add:true});return options!=null?typeof options.success===\"function\"?options.success(_this.read,_this.write):void 0:void 0})},readService:function(){var _ref;if((_ref=this.get(\"read_data\"))!=null?_ref.selected_api:void 0){return z.app.services.get(this.get(\"read_data\").selected_api)}return null},writeService:function(){var _ref;if((_ref=this.get(\"write_data\"))!=null?_ref.selected_api:void 0){return z.app.services.get(this.get(\"write_data\").selected_api)}return null}});z.model.RecipeSet=z.model.PaginationSet.extend({model:z.model.Recipe,url:z.cfg.api+\"/recipes\",noPersist:true,initialize:function(models,options){var filters,_this=this;z.model.PaginationSet.prototype.initialize.apply(this,arguments);this.services=this.format(options!=null?options.services:void 0);this.userid=this.format(options!=null?options.userid:void 0);this.categories=this.format(options!=null?options.categories:void 0);filters=(options!=null?options.filters:void 0)||{};filters=_.defaults(filters,{read_service:null,read_action:null,write_service:null,write_action:null,services:null,userid:null,categories:null});this.filters=new z.model.Base(filters);return this.filters.on(\"change reset\",function(){_this.serverPageReset({silent:true});return _this.fetch()},this)},format:function(rawList,location){var list;if(rawList!=null)list=_.compact(rawList);if((list!=null?list.length:void 0)>0)location=list.join(\",\");return location},applyServicesFilter:function(services,options){if(options==null)options={};return this.filters.set(\"services\",this.format(services),options)},getServicesFilter:function(){var _ref;return((_ref=this.filters.get(\"services\"))!=null?_ref.split(\",\"):void 0)||[]},applyUserFilter:function(userid,options){if(options==null)options={};return this.filters.set(\"userid\",this.format(userid),options)},applyCategoryFilter:function(categories,options){if(options==null)options={};return this.filters.set(\"categories\",this.format(categories),options)},clearFilters:function(){return this.filters.set({read_service:null,read_action:null,write_service:null,write_action:null,services:null,userid:null,categories:null})},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,_.compactObject(this.filters.toJSON()));this.trigger(\"fetch\");return z.model.PaginationSet.prototype.fetch.call(this,options)},comparator:function(model){return-model.get(\"used\")||0}});z.model.Auth=z.model.Base.extend({urlRoot:z.cfg.api+\"/auths\",validateModel:function(){if(!(this.get(\"key\")!=null))return false;return true},getService:function(services){var _ref;return(_ref=z.app.services)!=null?_ref.get(this.get(\"selected_api\")):void 0},getName:function(services){var base,name,_ref;base=(_ref=this.getService(services))!=null?_ref.getName():void 0;if(this.get(\"title\")!=null){name=this.get(\"title\")}else{name=\"\"+base+\" (\"+this.get(\"timesince\")+\" ago)\"}return name},test:function(options){var syncOptions,_this=this;if(options==null)options={};syncOptions={url:\"\"+this.url()+\"/test\",type:\"post\",data:\"{}\",dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)},destroy:function(options){return Backbone.Model.prototype.destroy.call(this,options)},swap:function(newAuthId,options){var syncOptions,_this=this;if(options==null)options={};syncOptions={url:\"\"+this.url()+\"/swap/\"+newAuthId,type:\"post\",data:\"{}\",dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.trigger(\"destroy\",_this,_this.collection,options);return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)}});z.model.AuthSet=z.model.BaseSet.extend({model:z.model.Auth,url:z.cfg.api+\"/auths\",comparator:function(auth){var d;d=new Date(auth.get(\"date\"));return-d.getTime()},getByKey:function(key){var match;if(!(key!=null))return null;match=[];this.each(function(model){if(model.get(\"selected_api\")===key)return match.push(model)});return match},hasAtLeastOneAuth:function(key){var auth;auth=this.getByKey(key);if(auth!=null&&auth.length>0)return true;return false},create:function(data,options){var syncOptions;syncOptions={url:this.url,type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",statusCode:{200:options!=null?options.s200:void 0,201:options!=null?options.s201:void 0,202:options!=null?options.s202:void 0},error:function(e){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(this,arguments):void 0:void 0}};return Backbone.sync(\"create\",this,syncOptions)},request:function(data,options){var syncOptions;syncOptions={url:this.url+\"/request\",type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},pollForNewAuth:function(interval,iters,id,options){var i,match,poll,_this=this;i=0;match=false;poll=function(){var error,success,syncOptions,_ref;success=function(model,resp){var status,_ref,_ref2;status=resp[\"status\"];log(\"oauth poll status: \",status);if(status===\"success\"){log(\"oauth success\",resp);clearInterval(poll);return(_ref=options.success)!=null?_ref.call(_this,resp):void 0}else if(status===\"error\"){log(\"oauth error\",resp);clearInterval(poll);return(_ref2=options.error)!=null?_ref2.call(_this,resp[\"message\"]):void 0}};error=function(model,xhr){};syncOptions={url:_this.url+(\"/oauth/\"+id),cache:false,type:\"get\",success:success,error:error};Backbone.sync(\"read\",_this,syncOptions);i=i+1;if(i===iters){log(\"oauth poll stopping, max iter\");clearInterval(poll);return(_ref=options.maxIter)!=null?_ref.call(_this):void 0}};poll=setInterval(poll,interval);return poll}});z.model.Stream=z.model.Base.extend({urlRoot:z.cfg.api+\"/stream\",getReadService:function(){var _ref,_ref2;return(_ref=z.app.services)!=null?_ref.get((_ref2=this.get(\"data\"))!=null?_ref2[\"read_selected_api\"]:void 0):void 0},getWriteService:function(){var _ref,_ref2;return(_ref=z.app.services)!=null?_ref.get((_ref2=this.get(\"data\"))!=null?_ref2[\"write_selected_api\"]:void 0):void 0},getRead:function(reads,writes){var write;if(this.get(\"type\")===\"write\"&&reads&&writes){write=writes!=null?writes.get(this.get(\"legacy_object_id\")||this.get(\"object_id\")):void 0;return reads!=null?reads.get(write!=null?write.get(\"read_id\"):void 0):void 0}return null},getTitle:function(){var data,read,read_action,title,write,write_action,_ref,_ref2;data=this.get(\"data\");if(data.message!=null){title=data.message}else{write=(_ref=z.app.writes)!=null?_ref.get(this.get(\"legacy_object_id\")||this.get(\"object_id\")):void 0;read=(_ref2=z.app.reads)!=null?_ref2.get(write!=null?write.get(\"read_id\"):void 0):void 0;if(read!=null){title=read.getTitle()}else{read_action=_.superHumanize(data.read_action);write_action=_.superHumanize(data.write_action);title=\"\"+read_action+\" to \"+write_action}}return title},buildChildren:function(){var action,children,jmessage,json,message,name,service,status,_ref,_ref2;json=this.toJSON();if(!(json!=null?json.data:void 0))return[];children=[];if(json.data.manual!=null&&json.data.manual===true){children.push({status:\"success\",message:\"Manually ran from dashboard\",date:json.date,type:\"manual\"})}status=((_ref=_.keys(json.data.write_raw_data))!=null?_ref.length:void 0)>0?\"success\":\"error\";service=z.app.services.get(json.data.read_selected_api);name=(service!=null?service.getName():void 0)||json.data.read_selected_api;action=(service!=null?service.getActionName(json.data.read_action,\"read\",\"true\"):void 0)||json.data.read_action;if(status===\"success\")message=\"Found 1 new \"+action+\" from \"+name;if(status===\"error\"){message=\"Error getting \"+action+\" from \"+name;if(json.data.message!=null)message=json.data.message}children.push({status:status,message:message,date:json.date,type:\"trigger_summary\"});if(json.data.message!=null)message=json.data.message;if(!(json.data.message!=null)){service=z.app.services.get(json.data.write_selected_api);name=(service!=null?service.getName():void 0)||json.data.write_selected_api;action=(service!=null?service.getActionName(json.data.write_action,\"write\",\"true\"):void 0)||json.data.write_action;if(json.data.status===\"success\"){message=\"Sent 1 \"+action+\" to \"+name}if(json.data.status===\"halted\"){jmessage=\"Advanced Filters halted 1 \"+action}if(json.data.status===\"error\"){message=\"Error sending 1 \"+action+\" to \"+name}}if(((_ref2=_.keys(json.data.write_raw_data))!=null?_ref2.length:void 0)>0){children.push({status:json.data.status,message:message,date:json.date,type:\"action_summary\"})}return children}});z.model.StreamSet=z.model.PaginationSet.extend({model:z.model.Stream,url:z.cfg.api+\"/stream\",initialize:function(models,options){var filters,_this=this;this.filterStore={};this.paginationStore={};z.model.PaginationSet.prototype.initialize.apply(this,arguments);filters=_.extend({},options!=null?options.filters:void 0);this.filters=new z.model.Base(filters);this.updateFilterStore();return this.filters.on(\"change reset\",function(){_this.serverPageReset({silent:true});_this.updateFilterStore();return _this.fetch()},this)},updateFilterStore:function(){return this.filterStore=this.filters.toJSON()},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,_.compactObject(this.filters.toJSON()));this.trigger(\"fetch\");return z.model.PaginationSet.prototype.fetch.call(this,options)},unseen:function(objectId){var all,cookie,unseen,_this=this;all=this.where({object_id:objectId});cookie=z.store.get(\"logs-seen\");unseen=_.filter(all,function(item){var seen;seen=cookie!=null?cookie[objectId]:void 0;if(!(seen!=null))return true;if(new Date(seen).getTime()>new Date(item.get(\"date\")).getTime()){return true}return false});return unseen!=null?unseen.length:void 0},comparator:function(model){var _ref;return-((_ref=new Date(model.get(\"date\")))!=null?_ref.getTime():void 0)}});z.model.Plan=z.model.Base.extend({urlRoot:function(){return z.cfg.api+\"/accounts/plans\"\n},getName:function(){return this.get(\"name\")},dollarsMo:function(){if(this.get(\"interval\")===\"year\")return this.dollars()/12;return this.dollars()},dollars:function(){return Math.floor(this.get(\"amount\")/100)},andCents:function(){return this.get(\"amount\")-this.dollars()*100},tasksMo:function(){var actions;actions=this.get(\"actions\");if(actions===-1)return new Handlebars.SafeString(\"&infin;\");return actions.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\")},zaps:function(){var zaps;zaps=this.get(\"zaps\")===-1?new Handlebars.SafeString(\"&infin;\"):this.get(\"zaps\");return zaps},pollInterval:function(){var interval_minutes;interval_minutes=this.get(\"polling_interval_minutes\");if(interval_minutes>=1440)return interval_minutes/1440;if(interval_minutes>60)return interval_minutes/60;return interval_minutes},pollIntervalTimeFrame:function(){var interval_minutes;interval_minutes=this.get(\"polling_interval_minutes\");if(interval_minutes>=1440)return\"Day\";if(interval_minutes>60)return\"Hour\";return\"Minute\"},pollSpeed:function(){var minutes;minutes=this.get(\"polling_interval_minutes\");if(minutes<10)return\"Fastest\";if(minutes<60)return\"Fast\";if(minutes>59)return\"Slow\"},blacklistedServices:function(key){var blacklisted_apps,_ref;if(key==null)key=\"blacklisted_apps\";blacklisted_apps=this.get(key);if(blacklisted_apps!=null?blacklisted_apps.length:void 0){return(_ref=z.app.services)!=null?_ref.filter(function(service){return blacklisted_apps.indexOf(service.get(\"key\"))!==-1}):void 0}else{return[]}},extraFeatures:function(){return this.get(\"meta\")},isYearly:function(){return this.get(\"interval\"===\"year\")},isMonthly:function(){return this.get(\"interval\"===\"month\")},isFree:function(){return this.dollars()===0}});z.model.PlanSet=z.model.BaseSet.extend({model:z.model.Plan,url:function(){var readId,_ref;readId=(_ref=this.read)!=null?_ref.id:void 0;return z.cfg.api+\"/accounts/plans\"},getFreePlan:function(){var plan,_this=this;plan=this.find(function(plan){if(plan.get(\"amount\")===0)return true});return plan},getCancelPlan:function(){return this.getFreePlan()},getTrialPlan:function(){var _this=this;this.comparator=function(model){return-model.get(\"amount\")};this.sort({silent:true});return this.at(1)},getIntervalPlans:function(which){var _this=this;if(which==null)which=\"month\";return this.filter(function(plan){return plan.get(\"interval\")===which||plan.get(\"amount\")===0})}});z.model.FormRow=z.model.Base.extend({TYPES:[\"password\",\"text\",\"copy\",\"datetime\",\"confirmation\",\"file\",\"unicode\",\"select\",\"bool\",\"checkbox\",\"string\",\"upload\",\"json\"],idAttribute:\"key\",isSoftRemoved:false,initialize:function(options){var _this=this;this.options=options;z.model.Base.prototype.initialize.apply(this,arguments);this.on(\"change:value\",function(){return _this.set({valid:_this.isValid()})});this.baseline();return this.originalCopy=this.toJSON()},reset:function(key){if(key){return this.set(key,this.originalCopy[key])}else{return this.set(this.originalCopy)}},baseline:function(){var choices,def,key,rawChoices,value,_ref,_ref2;_ref=this.toJSON();for(key in _ref){value=_ref[key];if(value!=null&&value===\"\")this.unset(key)}if(this.get(\"display\")!=null&&!(this.get(\"prefill\")!=null)){this.unset(\"display\")}if(!(this.get(\"required\")!=null)){this.set({required:!((_ref2=this.collection)!=null?_ref2.anyRequired():void 0)})}if(this.get(\"type\")===\"bool\"){this.set({choices:[\"yes\",\"no\"]})}def=this.get(\"default\");if(def!=null&&def!==\"\"&&!(this.getValue()!=null)){this.set({value:def})}if(_.isString(this.get(\"choices\"))){rawChoices=this.get(\"choices\");choices=rawChoices.split(\",\");choices=_.map(choices,function(choice){return choice=_.str.trim(choice)});if(_.every(choices,function(choice){return _.str.contains(choice,\"|\")})){choices=_.object(_.map(choices,function(choice){return choice.split(\"|\",2)}))}return this.set({choices:choices})}},save:function(attrs,options){return this.set(attrs,options)},validate:function(attrs,options){var isValid,value,_base;if(this.isSoftRemoved)return null;value=this.getValue();if(this.get(\"validator\")!=null){isValid=typeof(_base=this.get(\"validator\"))===\"function\"?_base(this,this.collection):void 0}else if(this.get(\"regex\")!=null){isValid=RegExp(this.get(\"regex\")).test(value)}else if(this.get(\"choices\")){if((value!=null?value.toString().length:void 0)>0){isValid=true}else{isValid=false}}else{isValid=!this.get(\"required\")||Boolean(value)}if(isValid){return null}else if(this.get(\"required\")){if((value!=null?value.toString().length:void 0)>0){return\"Invalid value\"}else{return\"Missing value\"}}else{return null}},getLabel:function(){if(this.get(\"label\")!=null)return this.get(\"label\");return _.superHumanize(this.get(\"key\"))},getDisplay:function(){if(this.get(\"display\")!=null)return this.get(\"display\");return this.get(\"value\")},getValue:function(){return this.get(\"value\")}});z.model.FormSet=z.model.BaseSet.extend({TYPES:z.model.FormRow.prototype.TYPES,model:z.model.FormRow,isValid:function(){var complete,errors,_this=this;complete=true;errors={};this.each(function(row){var valid;valid=row.isValid();complete=complete&&valid;if(!valid)errors[row.get(\"key\")]=[row.validationError]});if(!complete)this.trigger(\"invalid\",this,errors,null);return complete},getValues:function(){var data,_this=this;data={};this.each(function(each){var value;value=each.getValue();if(value!=null&&value&&value!==\"undefined\"){return data[each.get(\"key\")]=value}});return data},anyRequired:function(){return this.any(function(item){return item.get(\"required\")!=null})},softAdd:function(model){model.isSoftRemoved=false},softRemove:function(model){model.isSoftRemoved=true}});z.model.ParamFormRow=z.model.FormRow.extend({initialize:function(options){var onCollectionInit,_this=this;this.options=options;z.model.FormRow.prototype.initialize.apply(this,arguments);this.node=this.collection.node;this.state.set({busy:true});this.on(\"loaded\",this._baseline);onCollectionInit=function(state){var _ref,_ref2;if((_ref=_this.collection)!=null?(_ref2=_ref.state)!=null?_ref2.get(\"init\"):void 0:void 0){if(!_this.state.get(\"busy\")){return _this.state.set({busy:true})}}else{if(_this.state.get(\"busy\")){_this.state.set({busy:false})}return _this.trigger(\"loaded\")}};this.collection.state.on(\"change:init\",onCollectionInit,this);return this.collection.on(\"reset\",function(collection){if(!(_this.collection!=null)){return collection.state.off(null,null,_this)}})},baseline:function(){},_baseline:function(){z.model.FormRow.prototype.baseline.apply(this,arguments);if(this.get(\"prefill\")!=null&&!(this.getValue()!=null)&&this.get(\"display\")!=null){this.set({display:\"\"})}if(this.get(\"prefill\")!=null&&this.getValue()!=null&&!(this.get(\"display\")!=null)){return this.loadDisplay()}},save:function(attrs,options){var error,opts,success,_this=this;if(options==null)options={};if(!(this.collection!=null))return;if(attrs!=null)this.set(attrs);this.state.set({busy:true});success=function(){var _ref;_this.state.set({busy:false});return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(){var _ref;_this.state.set({busy:false});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};opts=_.extend({},options,{success:success,error:error});return this.collection.save(opts)},loadDisplay:function(){var options,samples,_this=this;if(!(this.collection!=null))return;this.state.set({busy:true});options={success:function(map){_this.state.set({busy:false});if(map[_this.getValue()]!=null){return _this.save({display:map[_this.getValue()]},{wait:true})}},error:function(model,xhr){return _this.state.set({busy:false})}};samples=new z.model.SampleSet([],{node:this.node,action:this.node.get(\"action\")});samples.prefillMap(this.get(\"prefill\"),this.collection.getValues(),options);return{hasTags:function(){var eTag,oTag,val;oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;val=this.getValue()||\"\";return val.indexOf(oTag)!==-1&&val.indexOf(eTag)!==-1}}},isUserfill:function(){if(this.get(\"prefill\")!=null&&this.get(\"prefill\")!==\"\")return false;if(this.get(\"choices\")!=null&&this.get(\"choice\")!==\"\")return false;if(this.get(\"type\")===\"checkbox\")return false;if(this.get(\"type\")===\"confirmation\")return false;if(this.get(\"type\")===\"copy\")return false;return true},isListParent:function(){return this.get(\"list\")&&!this.get(\"parent\")}});z.model.ParamFormSet=z.model.FormSet.extend({model:z.model.ParamFormRow,url:function(){return this.node.url()+\"/needs\"},initialize:function(models,options){z.model.FormSet.prototype.initialize.apply(this,arguments);this.node=options!=null?options.node:void 0;return this.once(\"sync\",this.initData)},stripMissing:function(params){var k,v,_ref;if(params==null)params={};for(k in params){v=params[k];if(!(((_ref=this.where({key:k}))!=null?_ref[0]:void 0)!=null)){delete params[k]}}return params},stripEmpty:function(params){var key,out,value;if(params==null)params={};out={};for(key in params){value=params[key];if(value!=null&&value!==\"\")out[key]=value}return out},applyPartner:function(params){var defaultKey,defaultVal,defaults,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(params==null)params={};if(this.node.get(\"selected_api\")!==((_ref=z.app.partner.get(\"zap\"))!=null?_ref.selected_api:void 0)){return params}if(this.node.isRead()){defaults=(_ref2=z.app.partner.get(\"zap\"))!=null?(_ref3=_ref2.defaults)!=null?(_ref4=_ref3.read)!=null?_ref4.params:void 0:void 0:void 0}else{defaults=(_ref5=z.app.partner.get(\"zap\"))!=null?(_ref6=_ref5.defaults)!=null?(_ref7=_ref6.write)!=null?_ref7.params:void 0:void 0:void 0}if(defaults){for(defaultKey in defaults){defaultVal=defaults[defaultKey];if(!(params[defaultKey]!=null)&&this.get(defaultKey)!=null){params[defaultKey]=defaultVal}}}return params},initData:function(options){var _this=this;this.state.set({init:true});return async.parallel([_.bind(this.loadFields,this)],function(err,results){var display,key,meta,model,params,value,_ref,_ref2,_ref3;params=_this.node.get(\"params\");meta=(_ref=_this.node.get(\"meta\"))!=null?_ref.parammap:void 0;if(!(meta!=null))meta={};if(!(params!=null))params={};params=_this.applyPartner(params);params=_this.unpackLists(params);meta=_this.unpackLists(meta,{update:true});for(key in params){value=params[key];model=_this.get(key);display=meta!=null?meta[key]:void 0;if(model!=null){model.set({value:value,display:display})}}_this.state.set({init:false});_.defer(function(){return _this.applyPartner()});if(err!=null){if(options!=null){if((_ref2=options.error)!=null)_ref2.apply(_this,err)}}if(results!=null){return options!=null?(_ref3=options.success)!=null?_ref3.apply(_this,results):void 0:void 0}})},loadFields:function(cb){var _this=this;if(!(this.node!=null))return cb();return this.node.fetch({success:function(){return cb()}})},save:function(options){var data,meta,oldParams,params,_ref,_ref2,_ref3,_this=this;if(!(this.node!=null))return;data={};oldParams=_.extend({},this.node.get(\"params\"));params={};this.each(function(row){return params[row.id]=row.get(\"value\")});params=this.packLists(params);params=this.stripEmpty(params);if(!_.isEqual(oldParams,params)){data=_.extend(data,{params:params})}oldParams=_.extend({},(_ref=this.node.get(\"meta\"))!=null?_ref.parammap:void 0);params={};this.each(function(row){return params[row.id]=row.get(\"display\")});params=this.packLists(params);params=this.stripEmpty(params);if(!_.isEqual(oldParams,params)){meta={parammap:params,fieldmap:(_ref2=this.node.get(\"meta\"))!=null?_ref2.fieldmap:void 0};data=_.extend(data,{meta:meta})}if(_.keys(data).length>0){return this.node.save(data,{success:function(){var _ref3;return options!=null?(_ref3=options.success)!=null?_ref3.apply(_this,arguments):void 0:void 0},error:function(){var _ref3;return options!=null?(_ref3=options.error)!=null?_ref3.apply(_this,arguments):void 0:void 0}})}else{return options!=null?(_ref3=options.success)!=null?_ref3.apply(this,{noop:true}):void 0:void 0}},unpackLists:function(params,options){var clone,i,key,model,models,skip,value,values,_len,_this=this;if(params==null)params={};if(options==null)options={};params=_.clone(params);this.each(function(model){var def,val;if(model.get(\"list\")){if(!(params[model.id]!=null)||!_.isArray(params[model.id])){def=(options!=null?options.update:void 0)?null:[null];val=params[model.id]!=null?[params[model.id]]:def;if(val!=null&&(val!=null?val[0]:void 0)!=null){if(_.isString(val[0]))val=val[0].split(\",\")}return params[model.id]=val}}});for(key in params){values=params[key];if(_.isArray(values)){for(i=0,_len=values.length;i<_len;i++){value=values[i];if(this.any(function(m){return m.get(\"parent\")===key&&m.getValue()===value})){if(options!=null)options.update=true}if(options!=null?options.update:void 0){models=this.where({parent:key});model=models[i];if((model!=null?model.id:void 0)!=null){params[model.id]=value}}else{if(this.get(key)!=null){skip=_.startsWith(key,\"__\")?true:false;if(!skip){clone=this.listAdd(key);params[clone.id]=value}}}}}}return params},packLists:function(params){var _this=this;if(params==null)params={};params=_.clone(params);this.each(function(model){var childs,values;if(model.get(\"list\")&&!model.get(\"parent\")){childs=_this.where({parent:model.id});childs=_.sortBy(childs,function(child){return child.get(\"order\")});values=[];_.each(childs,function(child){var val;val=params[child.id];if(val!=null)values.push(params[child.id]);return delete params[child.id]});values=values.join();return params[model.id]=values}});return params},listLength:function(parent){var childs;childs=this.where({parent:parent});return childs.length},listAdd:function(parent){var at,clone,i,json,model,newKey;model=this.get(parent);i=_.uniqueId();newKey=\"__\"+parent+i;if(!(this.get(newKey)!=null)){json=model.toJSON();json.key=newKey;json.value=null;json.display=null;json.order=i;json.parent=parent;clone=new this.model(json,{collection:this});clone.state.set(model.state.toJSON());at=1+this.indexOf(model)+this.listLength(parent);this.add(clone,{at:at})}return clone},listRemove:function(child,parent){var model;model=this.get(child);this.remove(model);if(parent!=null&&this.listLength(parent)===0){return this.listAdd(parent)}}});z.model.DeveloperAppFormRow=z.model.FormRow.extend({validate:function(attrs,options){var choices,isValid,value;if(this.isSoftRemoved)return null;value=this.getValue();if(this.get(\"choices\")){choices=this.get(\"choices\");if($.isArray(choices)&&choices.indexOf(value)>=0){isValid=true}else if($.isPlainObject(choices)&&choices[value]!=null){isValid=true}else{isValid=false}}else{return z.model.FormRow.prototype.validate.apply(this,arguments)}if(isValid){return null}else if(this.get(\"required\")){if((value!=null?value.toString().length:void 0)>0){return\"Invalid value\"}else{return\"Missing value\"}}else{return null}}});z.model.DeveloperAppFormSet=z.model.FormSet.extend({model:z.model.DeveloperAppFormRow,wrappedModel:null,fileToUpload:null,initialize:function(formRowModels,options){z.model.FormSet.prototype.initialize.apply(this,arguments);if(options!=null?options.model:void 0){return this.setWrappedModel(options!=null?options.model:void 0)}},setWrappedModel:function(model){this.wrappedModel=model;return this.initData()},setFileUpload:function(file){return this.fileToUpload=file},initData:function(){var _this=this;this.each(function(field){var currentValue;currentValue=_this.wrappedModel.get(field.id);return field.set(\"value\",currentValue)})},getValues:function(){var data,_this=this;data={};this.each(function(each){var value;value=each.getValue();if(value===\"null\")value=null;return data[each.get(\"key\")]=value});return data},save:function(){var _this=this;if(this.isValid()){if(this.fileToUpload){return this.fileToUpload.submit().done(function(data){_this.fileToUpload=null;return _this._saveForm()}).fail(function(xhr,textStatus,errorThrown){return _this._handleErrors(xhr)})}else{return this._saveForm()}}},_saveForm:function(){var values,_this=this;values=this.getValues();return this.wrappedModel.save(values,{wait:true,error:function(model,xhr,options){return _this._handleErrors(xhr)},success:function(model,response,options){_this.trigger(\"saveSuccess\",model,response,options)}})},_handleErrors:function(xhr){var errors,_ref;try{errors=JSON.parse(xhr.responseText).errors}catch(_error){}if(errors&&xhr.status===403){this.trigger(\"error\",this,errors,null)}else if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}});z.model.Invoice=z.model.Base.extend({getDateFormat:function(date){var day,month,year;if(typeof date===\"number\")date=new Date(date*1e3);day=date.getDate();month=date.getMonth()+1;year=date.getFullYear();return\"\"+month+\"/\"+day+\"/\"+year},getDollarFormat:function(int){var cents,dollars;if(int>0){dollars=Math.floor(int/100)}else if(int<0){dollars=Math.ceil(int/100)}else{dollars=0}cents=\"0\"+(int-dollars*100);return dollars+\".\"+cents.substr(cents.length-2)},toFancyJSON:function(obj){var isTimestamp,key,val;if(typeof obj!==\"object\")obj=this.toJSON();isTimestamp=function(num){return num>1318851380};for(key in obj){val=obj[key];if(typeof val===\"number\"){if(isTimestamp(val)){obj[key+\"_pretty\"]=this.getDateFormat(val)}else{obj[key+\"_pretty\"]=this.getDollarFormat(val)}}if(typeof val===\"object\"&&val)obj[key]=this.toFancyJSON(val)}return obj}});z.model.InvoiceSet=z.model.BaseSet.extend({model:z.model.Invoice,url:z.cfg.api+\"/accounts/me/invoices\"});z.model.SupportDefinition=z.model.Base.extend({url:z.cfg.api});z.model.SupportDefinitionSet=z.model.BaseSet.extend({model:z.model.SupportDefinition,url:z.cfg.api});z.model.Embed=z.model.Base.extend({url:\"\"+z.cfg.api+\"/embedded\"});z.model.Update=z.model.Base.extend({urlRoot:z.cfg.api+\"/updates\"});z.model.UpdateSet=z.model.PaginationSet.extend({model:z.model.Update,url:z.cfg.api+\"/updates\"});z.model.Rule=z.model.Base.extend({urlRoot:function(){var readId,_ref,_ref2,_ref3;readId=((_ref=this.collection)!=null?(_ref2=_ref.read)!=null?_ref2.id:void 0:void 0)||((_ref3=this.read)!=null?_ref3.id:void 0);return z.cfg.api+\"/reads/\"+readId+\"/rules\"},setRead:function(read){this.read=read;return this.set({read_id:read.id})}});z.model.RuleSet=z.model.BaseSet.extend({model:z.model.Rule,url:function(){var id,_ref;id=(_ref=this.read)!=null?_ref.id:void 0;return z.cfg.api+(\"/reads/\"+id+\"/rules\")},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);return this.setRead(options.read)},setRead:function(read){var _this=this;this.read=read;return this.each(function(rule){return rule.set({read_id:read.id})})},getGroups:function(){var groups;groups=_.map(this.toJSON(),function(rule){return Number(rule.group)});groups=_.uniq(groups).sort();return groups},getMaxGroup:function(){var max;max=_.max(this.getGroups());if(!(max!=null)||max===-Infinity)max=0;return Number(max)}});z.model.Sample=z.model.Base.extend({initialize:function(options){this.options=options;return z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(resp){var id,_ref;if((id=(_ref=this.collection)!=null?_ref.idAttribute:void 0)!=null){this.idAttribute=id}return resp},summary:function(params,options){var key,s;if(params==null)params={};s=\"Sample Data\";if(options!=null?options[\"default\"]:void 0)s=options[\"default\"];if((key=this.collection.displayKey(params))!=null&&params[key]!=null){s=params[key]}return s},buildRead:function(data){if(!(data!=null))data=this.toJSON();data=this.sanitize(data);return data},buildWrite:function(params,options){var context,data,_this=this;data={};context=this.toJSON();_.each(params,function(tmpl,key){var render,value;render=function(tmpl,context){var value;try{value=_this.render(tmpl,context)}catch(e){value=\"(Error: mismatched {{}})\"}return value};if(_.isArray(tmpl)){value=_.map(tmpl,function(each){return render(each,context)})}else{value=render(tmpl,context)}return data[key]=value});if((options!=null?options.sanitize:void 0)!==false){data=this.sanitize(data)}return data},sanitize:function(data){var k,out,v;out={};for(k in data){v=data[k];if(_.str.include(k,\"zap_meta\"))continue;if(_.str.include(v,\"hydrate|||\"))v=\"(Exists but not shown)\";out[k]=v}return out},isFiltered:function(){return this.get(\"zap_meta_filter\")},getWhyFiltered:function(){var allIds,ids,ordered,_ref;ids=(_ref=this.get(\"zap_meta_filter\"))!=null?_ref.rule_ids:void 0;allIds=z.app.rules.map(function(rule){return rule.id});ordered=z.useful.orderRelative(allIds,ids);return _.str.toSentenceSerial(ordered)},render:function(tmpl,context){var k,regex,rendered,v;rendered=tmpl.toString();for(k in context){v=context[k];regex=new RegExp((\"{{\"+k+\"}}\").replace(/([.?*+^$[\\]\\\\(){}|-])/g,\"\\\\$1\"),\"g\");rendered=rendered.replace(regex,v)}return rendered.replace(\"{{}}\",\"\")}});z.model.SampleSet=z.model.BaseSet.extend({model:z.model.Sample,url:function(){var action;action=this.action!=null?\"/\"+this.action:\"\";return this.node.url()+\"/samples\"+action},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);this.node=options!=null?options.node:void 0;return this.action=options!=null?options.action:void 0},setIDKey:function(id){return this.idAttribute=id},prefillMap:function(prefill,data,options){var action,displayKeys,opts,payloadData,pfdata,targetKey,_this=this;pfdata=this.splitPrefill(prefill);action=pfdata[\"action\"];displayKeys=pfdata[\"displayKeys\"];targetKey=pfdata[\"targetKey\"];this.setIDKey(targetKey);this.action=action;payloadData=_.extend({zap_meta_limit:-1,zap_meta_hydrate:false,zap_meta_page:this.getPage(),zap_meta_prefill:true},data);if($.param(payloadData).length>4096){payloadData=_.map(payloadData,function(value,key){if(value.toString().length>256)return null;return[key,value]});payloadData=_.object(_.filter(payloadData,function(pair){return pair}))}opts={data:payloadData,update:true,remove:false,success:function(model,resp){var map,_ref;map=_this.doPrefillMap(model.toJSON(),displayKeys,targetKey);return options!=null?(_ref=options.success)!=null?_ref.call(_this,map):void 0:void 0},error:function(model,xhr){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}};return this.fetch(opts)},splitPrefill:function(prefillPath){var action,displayKeys,pfdata,targetKey,_ref;pfdata=prefillPath!=null?prefillPath.split(\".\"):void 0;action=pfdata!=null?pfdata[0]:void 0;targetKey=pfdata!=null?pfdata[1]:void 0;displayKeys=pfdata!=null?(_ref=pfdata[2])!=null?_ref.split(\",\"):void 0:void 0;return{action:action,targetKey:targetKey,displayKeys:displayKeys}},doPrefillMap:function(data,displayKeys,targetKey){var mapping,_this=this;mapping={};_.each(data,function(each){var displayKey,fallback,key,value,values,_i,_len;key=each[targetKey];value=\"\";if(displayKeys!=null){values=[];for(_i=0,_len=displayKeys.length;_i<_len;_i++){displayKey=displayKeys[_i];fallback=value.length>0?false:targetKey;values.push(each[_this.displayKey(each,displayKey,fallback)])}value=values.join(\" \")}else{value=each[_this.displayKey(each,null,targetKey)]}return mapping[key]=value});return mapping},displayKey:function(data,preferredKey,fallback){var defaults,key,_this=this;defaults=[\"name\",\"Name\",\"display\",\"Display\",\"title\",\"Title\",\"subject\",\"Subject\"];if(preferredKey!=null&&data[preferredKey]!=null&&data[preferredKey]!==\"\"){return preferredKey}if((typeof options!==\"undefined\"&&options!==null?options.fallback:void 0)===false){return null}key=_.find(defaults,function(key){if(data[key]!=null&&data[key]!==\"\")return true});if(key!=null)return key;return fallback;return displayKey},getPage:function(){var page;page=this.page!=null?this.page:0;return page},setPage:function(page){return this.page=page}});z.model.AccountLimits=z.model.Base.extend({url:z.cfg.api+\"/accounts/me/limits\"});z.model.AccountBonusSet=z.model.BaseSet.extend({url:z.cfg.api+\"/accounts/me/bonuses\"});z.model.Account=z.model.Base.extend({url:z.cfg.api+\"/accounts/me\",initialize:function(){var _this=this;z.model.Base.prototype.initialize.apply(this,arguments);return this.on(\"sync error\",function(){return _this.loaded=true})},isLoggedIn:function(){return this.id!=null},isStaff:function(){return this.get(\"is_staff\")},isDeveloper:function(){return this.get(\"is_developer\")},login:function(username,password,options){var data,_this=this;data={username:username,password:password};return $.ajax({url:z.cfg.api+\"/accounts/session\",type:\"PUT\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.fetch({cache:false});return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0},error:options!=null?options.error:void 0})},logout:function(options){var _this=this;return $.ajax({url:z.cfg.api+\"/accounts/session\",type:\"DELETE\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;if(options!=null){if((_ref=options.success)!=null)_ref.apply(_this,arguments)}return global.router.goto(\"/\")},error:options!=null?options.error:void 0})},hasActiveCard:function(){var _ref;return((_ref=this.get(\"billing\"))!=null?_ref.active_card:void 0)!=null},switchPlan:function(planId,coupon,why,options){var error,opts,success,_this=this;if(coupon==null)coupon=null;if(why==null)why=null;if(options==null)options={};success=function(){var args,done;_this.unset(\"coupon\",{silent:true});args=arguments;done=_.after(2,function(){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,args):void 0:void 0});if(!z.app.plans)z.app.plans=new z.model.PlanSet;z.app.plans.fetch({cache:false,update:true,success:done,error:done});return _this.fetch({success:done,error:done})};error=function(){var _ref;_this.unset(\"coupon\",{silent:true});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};opts=_.extend(_.clone(options),{success:success,error:error,wait:true});return this.save({plan_id:planId,coupon:coupon,why:why},opts)},checkCoupon:function(coupon,options){return $.ajax({url:z.cfg.api+\"/accounts/coupon\",type:\"POST\",data:JSON.stringify({coupon:coupon}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},saveCard:function(token,options){var error,success,_this=this;success=function(){var _ref;_this.unset(\"card_token\",{silent:true});_this.fetch();return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(){var _ref;_this.unset(\"card_token\",{silent:true});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};this.set({card_token:token},{silent:true});return this.save({},{success:success,error:error,wait:true})},deleteAccount:function(password,options){if(options==null)options={};options.data={password:password};return this.destroy(options)},accountCreated:function(){z.store.set(\"showPersonaModal\",true);z.store.set(\"guiderPreferences\",{editorMapping:z.tests.editorMappingGuiders});z.app.track.gaPageTrack(\"/app/signup/success\")},checkUsernameAvailable:_.throttle(this._checkUsernameAvailable,200),_checkUsernameAvailable:function(username,options){var data,error,success;data={username:username};return $.ajax({type:\"GET\",url:z.cfg.api+(\"/accounts/username?\"+$.param(data)),dataType:\"json\",contentType:\"application/json\"},success=options!=null?options.success:void 0,error=options!=null?options.error:void 0)},sendForgotPasswordEmail:function(email,options){return $.ajax({type:\"POST\",data:JSON.stringify({email:email}),url:z.cfg.api+\"/accounts/password/forgot\",dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},resetPassword:function(username,code,password1,password2,options){return $.ajax({type:\"POST\",data:JSON.stringify({username:username,code:code,password1:password1,password2:password2}),url:z.cfg.api+\"/accounts/password/reset\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},sendEmailConfirmation:function(options){var syncOptions;syncOptions={url:z.cfg.api+\"/accounts/me/confirm\",type:\"post\",data:JSON.stringify({}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},trialDaysLeft:function(){var end,now;if(!this.isTrialing())return null;now=Math.round((new Date).getTime()/1e3);end=this.get(\"trial_end_date\");if(!(end!=null))return null;if(end<now)return 0;return Math.round((end-now)/(60*60*24))},isTrialing:function(){return!!this.get(\"trial_end_date\")},isFree:function(){return this.getCurrentPlanAmount()===0},getCurrentPlan:function(){var _ref;if(!z.app.plans)z.app.plans=new z.model.PlanSet;if(this.get(\"plan_id\")){return(_ref=z.app.plans)!=null?_ref.get(this.get(\"plan_id\")):void 0}return null},getCurrentPlanAmount:function(){var amount,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;amount=null;if(!(((_ref=this.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.plan:void 0:void 0)!=null)){amount=0}else if(((_ref3=this.get(\"billing\"))!=null?(_ref4=_ref3.subscription)!=null?(_ref5=_ref4.plan)!=null?_ref5.amount:void 0:void 0:void 0)!=null){amount=(_ref6=this.get(\"billing\"))!=null?(_ref7=_ref6.subscription)!=null?(_ref8=_ref7.plan)!=null?_ref8.amount:void 0:void 0:void 0}return amount},planId:function(){return this.get(\"plan_id\")},hasCard:function(){var card,_ref;card=(_ref=this.get(\"billing\"))!=null?_ref.active_card:void 0;return card!=null},isUnlimited:function(){var unlimited;unlimited=this.get(\"is_unlimited\");return unlimited!=null&&unlimited},isPaying:function(){var paying;paying=this.isTrialing()&&this.hasCard();return paying!=null&&paying}});z.model.Partner=z.model.Base.extend({initialize:function(){var _ref,_this=this;this.hasIframeJs=false;window.addEventListener(\"message\",function(e){var json;try{json=JSON.parse(e.data)}catch(e){return}if((json!=null?json.event:void 0)===\"exist\"){_this.hasIframeJs=true;return z.app.trigger(\"render\")}});if((_ref=window.top)!=null){_ref.postMessage(JSON.stringify({event:\"exist\"}),\"*\")}},isPartnerSession:function(){var _ref;return((_ref=_.keys(this.toJSON()))!=null?_ref.length:void 0)>0}});z.model.Cache=Backbone.Model.extend({url:function(){var url;url=\"/cache/\";if(this.key!=null)url+=this.key+\"/\";if(this.expiry!=null)url+=this.expiry;return z.cfg.api+url},setKey:function(key){return this.key=key},setExpiry:function(expiry){return this.expiry=expiry},parse:function(response){var filtered,_this=this;filtered={};_.each(response,function(v,k){if(_.isObject(v)&&_.keys(v)===0)return;if(_.isString(v)&&v===\"\")return;if(_.isArray(v)&&v.length===0)return;return filtered[k]=v});return filtered}});z.model.State=Backbone.Model.extend();z.model.SupportNote=z.model.Base.extend({urlRoot:z.cfg.api+\"/support/notes\",vote:function(options,helpful){var syncOptions;if(helpful==null)helpful=\"yes\";syncOptions={type:\"post\",data:JSON.stringify({helpful:helpful}),url:\"\"+this.url(),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)}});z.model.SupportNoteSet=z.model.BaseSet.extend({model:z.model.SupportNote,url:z.cfg.api+\"/support/notes\"});z.model.Field=z.model.Base.extend({initialize:function(options){this.options=options;return z.model.Base.prototype.initialize.apply(this,arguments)},getKey:function(){return this.get(\"key\")},getLabel:function(){if(this.get(\"label\")!=null)return this.get(\"label\");return _.superHumanize(this.get(\"key\"))},getSample:function(){return this.get(\"zap_meta_sample\")}});z.model.FieldSet=z.model.BaseSet.extend({model:z.model.Field,url:function(){return this.node.url()+\"/gives\"},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);return this.node=options!=null?options.node:void 0},exportMeta:function(){var humanize,meta;meta={};humanize=function(match){match=match.replace(/\\{\\{/g,\"\");match=match.replace(/\\}\\}/g,\"\");\nreturn _.superHumanize(match)};this.each(function(field){var key,label;key=z.cfg.userfillOTag+field.get(\"key\")+z.cfg.userfillETag;label=field.get(\"label\");if(!(label!=null))label=humanize(key);return meta[key]=label});return meta}});z.model.Read=z.model.StrictSingleton(z.model.Node.extend({urlRoot:z.cfg.api+\"/reads\",customNeeds:[],customGives:[],initialize:function(attrs,options){return z.model.Node.prototype.initialize.apply(this,arguments)},parse:function(response){if(response[\"lastchanged\"]!=null)delete response[\"lastchanged\"];if(response[\"date\"]!=null){this.date=new Date(response[\"date\"]);delete response[\"date\"]}if(response[\"fancy_title\"]!=null&&!(response[\"title\"]!=null)){response[\"title\"]=response[\"fancy_title\"]}delete response[\"fancy_title\"];return response},getFiltersIds:function(){return this.get(\"filter_ids\")},isComplete:function(){return this.id!=null&&this.get(\"selected_api\")!=null&&this.get(\"action\")!=null&&this.get(\"write_ids\").length>0&&this.get(\"collect_errors\").length===0},run:function(options){var syncOptions;syncOptions={type:\"get\",url:\"\"+this.url()+\"/run\",dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0,cache:false};return Backbone.sync(\"read\",this,syncOptions)},runStatus:function(options){var syncOptions;syncOptions={type:\"get\",cache:false,url:\"\"+this.url()+\"/run/status\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"read\",this,syncOptions)},hasErrors:function(){var _ref;return((_ref=this.get(\"collect_errors\"))!=null?_ref.length:void 0)>0},getActionNoun:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s!=null?s.getActionName(this.get(\"action\"),\"read\",\"true\"):void 0;return noun},getActionLabel:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s!=null?s.getActionName(this.get(\"action\"),\"read\",\"false\"):void 0;return noun},isLive:function(){return!this.get(\"paused\")},canShare:function(){var globalService,hasShared,_ref;globalService=(_ref=this.getService())!=null?_ref.get(\"public\"):void 0;hasShared=this.get(\"has_shared\");return globalService&&!hasShared},share:function(data,options){var error,success,syncOptions,_this=this;success=function(model,resp,opts){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(model,xhr,opts){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};syncOptions={type:\"post\",cache:false,url:\"\"+this.url()+\"/share\",contentType:\"application/json\",dataType:\"json\",data:JSON.stringify(data),success:success,error:error};return Backbone.sync(\"create\",this,syncOptions)},getTitle:function(){return this.get(\"fancy_title\")||this.get(\"title\")},copy:function(options){var reqOptions,_this=this;reqOptions={type:\"post\",url:\"\"+this.url()+\"/copy\",contentType:\"application/json\",dataType:\"json\",success:function(){(new z.model.ReadSet).fetch({update:true,cache:false});(new z.model.WriteSet).fetch({update:true,cache:false});return options!=null?options.success.apply(_this,arguments):void 0},error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,reqOptions)},subscribeHook:function(options){var syncOptions;syncOptions={type:\"post\",url:\"\"+this.url()+\"/subscription\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},tearDownHook:function(options){var syncOptions;syncOptions={type:\"delete\",url:\"\"+this.url()+\"/subscription\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"destroy\",this,syncOptions)},pause:function(options){return this.save({paused:true},options)},unpause:function(options){var error,success,syncOptions,_this=this;success=function(model,resp,opts){success=function(){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};return _this.fetch({cache:false,success:success})};error=function(model,xhr,opts){var _ref;if(xhr.status===409)return success();return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};syncOptions={type:\"put\",cache:false,url:\"\"+this.url()+\"/unpause\",contentType:\"application/json\",dataType:\"json\",success:success,error:error};return Backbone.sync(\"update\",this,syncOptions)}}));z.model.ReadSet=z.model.Singleton(z.model.NodeSet.extend({model:z.model.Read,url:z.cfg.api+\"/reads\"}));var __hasProp=Object.prototype.hasOwnProperty;z.model.Service=z.model.Base.extend({url:z.cfg.api+\"/services\",idAttribute:\"key\",getName:function(){if(this.get(\"meta\").human_readable_key!=null){return this.get(\"meta\").human_readable_key}return this.get(\"key\")},getNameArticle:function(){var letter,v,vowel,vowels,_i,_len;vowels=[\"a\",\"e\",\"i\",\"o\",\"u\"];vowel=false;letter=this.getName().toLowerCase()[0];for(_i=0,_len=vowels.length;_i<_len;_i++){v=vowels[_i];if(letter===v)vowel=true}if(vowel)return\"an\";return\"a\"},isPremium:function(){return this.get(\"premium\")},hasReads:function(){if(this.countActions(this.get(\"read\"))>0)return true;return false},hasWrites:function(){if(this.countActions(this.get(\"write\"))>0)return true;return false},countActions:function(actions){var action,isEmpty;isEmpty=function(object){var key,value;if(object!=null?object.hide:void 0)return true;for(key in object){if(!__hasProp.call(object,key))continue;value=object[key];return false}return true};actions=function(){var _i,_len,_results;_results=[];for(_i=0,_len=actions.length;_i<_len;_i++){action=actions[_i];if(!isEmpty(action))_results.push(action)}return _results}();return actions.length},hasUpfronts:function(){var _ref;if(((_ref=this.get(\"upfront_fields\"))!=null?_ref.length:void 0)>1){return true}return false},needsAuth:function(){var _ref;if(((_ref=this.getUpfronts())!=null?_ref.length:void 0)>0){return true}if(this.get(\"oauth\"))return true;return false},getUpfronts:function(){var context,upfronts;upfronts=[];context={service:this.getName()};_.each(this.get(\"upfront_fields\"),function(field){var newField;newField={};_.each(field,function(v,k){if(_.isString(v))v=z.useful.render(v,context);return newField[k]=v});return upfronts.push(newField)});return upfronts},isHook:function(action,which,needsURL){var meta;if(which==null)which=\"read\";if(needsURL==null)needsURL=true;meta=this.getActionMeta(action,which);if(!(meta!=null))return;return Boolean(meta.hook)&&(!needsURL||meta.hook_url!=null)},isSubHook:function(action,which){var meta;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!(meta!=null))return;return Boolean(meta.hook_subscription)},getWebhookURL:function(action,which,object){var meta,template;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!((meta!=null?meta.hook_url:void 0)!=null))return;template=_.template(meta.hook_url);return template({cid:z.app.account.get(\"id\"),ccode:z.app.account.get(\"code\"),sid:object!=null?object.id:void 0,scode:object!=null?object.get(\"code\"):void 0,code:object!=null?object.get(\"code\"):void 0})},getWebhookDirections:function(action,which){var meta;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!((meta!=null?meta.hook_url:void 0)!=null))return;return meta.hook_directions_html},getImageClass:function(size){var css,_ref;if(size==null)size=\"64x64\";if(((_ref=this.get(\"css\"))!=null?_ref[size]:void 0)!=null){css=this.get(\"css\")[size]}else{css=\"placeholder\"}return css},getCategories:function(){return this.get(\"categories\")},parseActions:function(actions,currentSelection){var filtered,_this=this;if(!_.any(actions,function(action){if((action!=null?action.important:void 0)===true)return true})){_.each(actions,function(action){action[\"important\"]=true;if(!(action.label!=null)){return action[\"label\"]=_.superHumanize(action.key)}})}filtered=_.filter(actions,function(action){return(action!=null?action.key:void 0)===currentSelection||!(action!=null?action.hide:void 0)});return filtered},getActionName:function(action,which,noverb){var meta,name,words,_this=this;if(which==null)which=\"read\";if(noverb==null)noverb=\"false\";noverb=noverb===\"true\";meta=this.getActionMeta(action,which);if(!(meta!=null))return;name=_.superHumanize(meta.key);if(meta.label!=null)name=meta.label;words=_.words(name);_.each([\"New\",\"Updated\",\"Update\",\"Changed\",\"Delete\",\"Create\",\"Add\",\"Added\",\"Set\",\"Send\",\"Submit\",\"Call\",\"Order\",\"Catch\",\"Copy\",\"Append\",\"/\",\"Move\",\"Remove\",\"Change\"],function(search){words[0]=words[0].replace(search,\"\");return words[0]=words[0].replace(search.toLowerCase(),\"\")});words[0]=words[0].replace(/^to$/i,\"\");if(noverb)name=words.join(\" \");if(noverb)name=name.replace(/\\((.+?)\\)/,\"\");name=_.trim(name);return name},getActions:function(which,currentSelection){if(which==null)which=\"read\";return this.parseActions(this.get(which),currentSelection)},getActionMeta:function(action,which){var each,_i,_len,_ref;if(which==null)which=\"read\";_ref=this.parseActions(this.get(which),action);for(_i=0,_len=_ref.length;_i<_len;_i++){each=_ref[_i];if(each.key===action)return each}},getCopyOverride:function(action,which,copy){var meta,_ref;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);return meta!=null?(_ref=meta.editor_copy)!=null?_ref[copy]:void 0:void 0},isActionImportant:function(which,action){var actions,important,_this=this;if(which==null)which=\"read\";actions=this.getActions(which);important=_.any(actions,function(each){return each.key===action&&each.important!=null&&each.important});return important},anyImportantActions:function(which){var action,_i,_len,_ref;if(which==null)which=\"read\";_ref=this.get(which);for(_i=0,_len=_ref.length;_i<_len;_i++){action=_ref[_i];if(action.important!=null&&action.important)return true}return false},getNeeds:function(which,action){var allNeeds,need,needs,_this=this;if(which==null)which=\"read\";allNeeds=this.get(which);need=_.find(allNeeds,function(need){if(need.key===action)return true});needs=need!=null?need.needs:void 0;return needs}});z.model.ServiceSet=z.model.BaseSet.extend({model:z.model.Service,url:z.cfg.api+\"/services\",comparator:function(service){return service.getName()},visibleList:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true})},hasReads:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.hasReads())return false;return true})},hasWrites:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.hasWrites())return false;return true})},sortPageAlpha:function(perPage){var group,grouped,ordered,sorted,_i,_len,_ref,_this=this;ordered=this.sortBy(function(service){return service.get(\"order\")});grouped=_.groupBy(ordered,function(service,i){return Math.floor(i/perPage)});sorted=[];_ref=_.toArray(grouped);for(_i=0,_len=_ref.length;_i<_len;_i++){group=_ref[_i];sorted=sorted.concat(_.sortBy(group,function(service){return service.getName()}))}return this.reset(sorted)},sortOrder:function(perPage){var sorted,_this=this;sorted=this.sortBy(function(service){return service.get(\"order\")});return this.reset(sorted)}});z.model.Track=z.model.Base.extend({url:z.cfg.api+\"/events\",dupe:{},initialize:function(){var _this=this;z.model.Base.prototype.initialize.apply(this,arguments);_.bindAll(this);return Backbone.history.on(\"route\",function(){var path;path=Backbone.history.location.pathname;_this[\"new\"](\"navigate\",{path:path});if(!z.cfg.debug)return _this.gaPageTrack()})},\"new\":function(message,data){if(!(this.dupe[message]!=null)){this.dupe[message]=_.debounce(this.send,50)}return this.dupe[message](message,data)},send:function(message,data){if(z.cfg.debug){return log(\"tracking an event:\",message,data)}else{return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:data}),url:this.url,contentType:\"application/json\",dataType:\"json\"})}},gaPageTrack:function(path){var title;if(!(path!=null))path=Backbone.history.location.pathname;title=typeof document!==\"undefined\"&&document!==null?document.title:void 0;log(\"GA:\",title,path);if(typeof _gaq!==\"undefined\"&&_gaq!==null){_gaq.push([\"_trackPageview\",path])}return typeof ga===\"function\"?ga(\"send\",\"pageview\",{page:path,title:title}):void 0}});window.onerrordupe={};window.onerror=function(message,url,linenumber){var send,trace,_ref,_this=this;trace=(_ref=printStackTrace())!=null?_ref.join(\"\\n\\n\"):void 0;send=function(message,url,linenumber,trace){var error;error={message:message,url:url,linenumber:linenumber,trace:trace};return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:error}),url:z.cfg.api+\"/events/errors\",contentType:\"application/json\",dataType:\"json\"})};if(!(window.onerrordupe[message]!=null)){window.onerrordupe[message]=_.debounce(send,50)}return window.onerrordupe[message](message,url,linenumber,trace)};var partnerChecks;z.controllers.Base=Backbone.Router.extend({constructor:function(options){var _this=this;Backbone.Router.prototype.constructor.apply(this,arguments);_.bindAll(this);Backbone.history.on(\"route\",this._route,this);Backbone.history.on(\"route\",function(){var _ref;if(((_ref=Backbone.history.getHash())!=null?_ref.length:void 0)<1){return $.scrollTo({top:0,left:0,duration:0})}},this)},_route:function(){var fragment,route;route=arguments[1];fragment=Backbone.history.fragment;if(!(route!=null))return;Backbone.history.last=fragment;if(!_.any(this.routes,function(v,k){return v===route})){if(typeof this.remove===\"function\")this.remove(route,fragment)}if(_.any(this.routes,function(v,k){return v===route})){return typeof this.match===\"function\"?this.match(route,fragment):void 0}},requireLogin:function(){var redirect,_this=this;redirect=function(){z.useful.goto(\"/app/login?next=/\"+Backbone.history.fragment);throw\"Login required!\"};if(z.app.account.loaded&&!z.app.account.isLoggedIn()){return redirect()}else{return z.app.account.once(\"sync\",function(){if(z.app.account.loaded&&!z.app.account.isLoggedIn())return redirect()})}}});partnerChecks=function(route,options){var allowed,iframed,pass,_this=this;if(options==null)options={};iframed=window!==(typeof window!==\"undefined\"&&window!==null?window.top:void 0);route=_.ltrim(route,\"/\");allowed=[\"app/edit\",\"app/explore\",\"app/dashboard\",\"app/history\",\"app/settings/authorizations\"];pass=true;if(z.app.partner.isPartnerSession()){pass=false;pass=_.any(allowed,function(allow){return _.str.include(route,allow)})}return pass};Backbone.history._navigate=Backbone.history.navigate;Backbone.history.navigate=function(){if(partnerChecks.apply(this,arguments)){return Backbone.history._navigate.apply(this,arguments)}};z.controllers.Settings=z.controllers.Base.extend({routes:{\"app/settings\":\"overview\",\"app/settings/\":\"overview\",\"app/settings/plans\":\"plans\",\"app/settings/plans/\":\"plans\",\"app/settings/plans/:showCoupon\":\"plans\",\"app/settings/invoices\":\"invoices\",\"app/settings/invoices/\":\"invoices\",\"app/settings/card\":\"card\",\"app/settings/card/\":\"card\",\"app/settings/authorizations\":\"auths\",\"app/settings/authorizations/\":\"auths\",\"app/settings/authorizations/:key\":\"auths\",\"app/settings/authorizations/replace/:key\":\"auths\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"settings\"},remove:function(){var _this=this;_.each(this.views,function(view){return view.remove()})},card:function(){this.options={card:true};return this.overview()},overview:function(options){this.requireLogin();z.app.viewport.title(\"Account Settings\");async.series([this.loadOverviewModels,this.loadOverview,this.renderOverview])},loadOverviewModels:function(cb){var _this=this;z.app.preloader.start(2);return async.parallel({accountBonuses:async.fetch(new z.model.AccountBonusSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadOverview:function(cb){$(\"#app\").html(JST.settings_base({}));this.$myAccount=$(\"#app .my-account\");this.$billing=$(\"#app .billing\");this.$extra=$(\"#app .extra\");this.views.myAccount=new z.ui.MyAccountSettings(this.options);this.views.billing=new z.ui.BillingSettings(this.options);this.views.extra=new z.ui.ExtraSettings(this.options);return typeof cb===\"function\"?cb():void 0},renderOverview:function(cb){this.$myAccount.html(this.views.myAccount.render().el);this.$billing.html(this.views.billing.render().el);this.$extra.html(this.views.extra.render().el);return typeof cb===\"function\"?cb():void 0},plans:function(showCoupon){this.showCoupon=showCoupon===\"coupon\";this.requireLogin();z.app.viewport.title(\"Plans\");async.series([this.loadPlanModels,this.loadPlans,this.renderPlans])},loadPlanModels:function(cb){var _this=this;z.app.preloader.start(1);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadPlans:function(cb){this.views.plans=new z.ui.PlanSelect({showCoupon:this.showCoupon});return typeof cb===\"function\"?cb():void 0},renderPlans:function(cb){$(\"#app\").html(this.views.plans.render().el);return typeof cb===\"function\"?cb():void 0},invoices:function(){this.requireLogin();z.app.viewport.title(\"Invoices\");async.series([this.loadInvoiceModels,this.loadInvoices,this.renderInvoices])},loadInvoiceModels:function(cb){var _this=this;z.app.preloader.start(1);return async.parallel({invoices:async.fetch(new z.model.InvoiceSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadInvoices:function(cb){this.views.invoices=new z.ui.Invoices({});return typeof cb===\"function\"?cb():void 0},renderInvoices:function(cb){$(\"#app\").html(this.views.invoices.render().el);return typeof cb===\"function\"?cb():void 0},auths:function(key){this.requireLogin();z.app.viewport.title(\"Connected Accounts\");this.addService=key;async.series([this.loadAuthModels,this.loadAuths,this.renderAuths])},loadAuthModels:function(cb){var _this=this;z.app.preloader.start(4);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),auths:async.fetch(new z.model.AuthSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadAuths:function(cb){this.views.auths=new z.ui.Auths({addService:this.addService});return typeof cb===\"function\"?cb():void 0},renderAuths:function(cb){$(\"#app\").html(this.views.auths.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.Explore=z.controllers.Base.extend({routes:{\"app/explore\":\"explore\",\"app/explore*qs\":\"explore\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"explore\"},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.search)!=null)_ref.off();return(_ref2=this.recipes)!=null?_ref2.off():void 0},explore:function(){z.app.track[\"new\"](\"Visit Page: explore\",{path:window.location.pathname});z.app.viewport.title(\"Explore\");async.series([this.loadModels,this.loadViews,this.renderViews])},storeFilters:function(filters){return z.store.set(\"recipe-filters\",filters,{expires:60*15})},restoreFilters:function(){var filters;filters={};filters=z.store.get(\"recipe-filters\")||{};_.extend(filters,_.object((new z.useful.QueryString).pairs||Array()));return filters},loadModels:function(cb){var recipeOptions,_this=this;z.app.preloader.start(3);recipeOptions={filters:this.restoreFilters(),pagination:{perPage:15}};return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),recipes:async.fetch(new z.model.RecipeSet([],recipeOptions),{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();z.app.recipes.filters.on(\"change\",function(){return _this.storeFilters(z.app.recipes.filters.toJSON())},_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={recipes:z.app.recipes};$(\"#app\").html(JST.explore_base({}));this.$search=$(\"#app .search\");this.$results=$(\"#app .results\");this.views.search=new z.ui.ExploreSearch(options);this.views.results=new z.ui.ExploreResults(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$search.html(this.views.search.render().el);this.$results.html(this.views.results.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.SignUp=z.controllers.Base.extend({routes:{\"app/signup\":\"signup\",\"app/signup?*querystring\":\"signup\"},views:{},match:function(){z.cfg.defaultSupportTags=\"signup\";if(!z.app.account.isLoggedIn()){return $(\"#header .hiring, #header .links-container, #header .menu-account, #header .menu-login\").addClass(\"hide\")}},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.sidebar)!=null)_ref.off();if((_ref2=this.recipes)!=null)_ref2.off();return $(\"#header .hiring, #header .links-container, #header .menu-account, #header .menu-login\").removeClass(\"hide\")},signup:function(){z.app.track[\"new\"](\"Visit Page: signup\",{path:window.location.pathname});z.app.viewport.title(\"Signup\");this.querystring=_.object((new z.useful.QueryString).pairs||Array());async.series([this.loadRecipe,this.loadModels,this.loadViews,this.renderViews])},loadRecipe:function(cb){var service,_this=this;z.app.preloader.start(3);this.recipe=null;if(this.querystring.recipe_id){return(this.recipe=new z.model.Recipe({id:this.querystring.recipe_id})).fetch({success:function(){return typeof cb===\"function\"?cb():void 0},error:function(){_this.recipe=null;return typeof cb===\"function\"?cb():void 0}})}else if(this.querystring.read_service||this.querystring.write_service){this.recipe=new z.model.Recipe({id:\"fake\",generated:true,read_data:{selected_api:this.querystring.read_service,action:this.querystring.read_action},write_data:{selected_api:this.querystring.write_service,action:this.querystring.write_action}});return typeof cb===\"function\"?cb():void 0}else if(this.querystring.next!=null&&_.str.include(this.querystring.next,\"API\")){service=this.querystring.next.match(\"(.*/)?(.*API)(.*)?\")[2];this.recipe=new z.model.Recipe({id:\"fake\",generated:true,read_data:{selected_api:service,action:null},write_data:{selected_api:null,action:null}});return typeof cb===\"function\"?cb():void 0}else{return typeof cb===\"function\"?cb():void 0}},loadModels:function(cb){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={querystring:this.querystring,recipe:this.recipe};$(\"#app\").html(JST.signup_base({}));this.$signUpWhy=$(\"#app .signup-why\");this.$signUpForm=$(\"#app .signup-form\");this.views.signUpWhy=new z.ui.SignUpWhy(options);this.views.signUpForm=new z.ui.SignUpForm(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$signUpWhy.html(this.views.signUpWhy.render().el);this.$signUpForm.html(this.views.signUpForm.render().el);this.$signUpForm.find(\"br\").first().remove();return typeof cb===\"function\"?cb():void 0}});z.controllers.Support=z.controllers.Base.extend({routes:{help:\"support\",\"help/\":\"support\",\"help/:qs\":\"support\",\"help/:qs/\":\"support\"},remove:function(route,fragment){return $(\".vote a\").off(\"click\",this.vote)},support:function(){var $el,para,paras,replaced,text,_i,_len,_this=this;if(Backbone.history.last!=null)Backbone.history.location.reload();z.app.supportDefinitions=new z.model.SupportDefinitionSet(typeof preload!==\"undefined\"&&preload!==null?preload.definitions:void 0);paras=$(\".content > p\");for(_i=0,_len=paras.length;_i<_len;_i++){para=paras[_i];$el=$(para);text=$el.html();replaced=text;z.app.supportDefinitions.each(function(def){var regex,replace,slug,title,word;word=def.get(\"word\");title=def.get(\"text\");slug=def.get(\"read_more\");return regex=slug!=null?(replace=$(\"<a class='def' href='/help/\"+slug+\"' data-title='\"+title+\"'>\"+word+\"</a>\")[0],_this.highlightWord($el[0],word,replace)):(replace=$(\"<span class='def' data-title='\"+title+\"'>\"+word+\"</span>\")[0],_this.highlightWord($el[0],word,replace))});$el.find(\".def\").each(function(){$el=$(this);if($el.position().left>=$el.parent().width()/2){return $el.addClass(\"left\")}})}return $(\".vote a\").on(\"click\",this.vote)},vote:function(e){var $el,helpful,id,url,_ref;if(e!=null)e.preventDefault();$el=$(e.currentTarget);if(!($el!=null))return;id=$el.attr(\"data-id\");helpful=(_ref=$(e.currentTarget))!=null?_ref.attr(\"data-option\"):void 0;$el.closest(\".option-container\").text(\"Thanks!\");url=\"\"+z.cfg.api+\"/support/notes/\"+id;return $.ajax({type:\"POST\",url:url,data:JSON.stringify({helpful:helpful})})},highlightWord:function(root,word,replace){var cut,highlightWords,textNodesUnder;textNodesUnder=function(root){var a,n,w;n=void 0;a=[];w=document.createTreeWalker(root,NodeFilter.SHOW_TEXT,null,false);while(n=w.nextNode()){a.push(n)}return a};cut=function(str,cutStart,cutEnd){return str.substr(0,cutStart)+str.substr(cutEnd+1)};highlightWords=function(n){var after,insert,match,next,_results;match=new RegExp(\"\\\\b\"+word+\"\\\\b\",\"g\").exec(n.nodeValue);_results=[];while(match!==null){insert=replace.cloneNode(true);after=n.splitText(match.index+match[0].length);n.nodeValue=cut(n.nodeValue,match.index,match.index+match[0].length);after.parentNode.insertBefore(insert,after);n=after;next=new RegExp(\"\\\\b\"+word+\"\\\\b\",\"g\").exec(n.nodeValue);_results.push(match=next)}return _results};return textNodesUnder(root).forEach(highlightWords)}});z.controllers.Server=z.controllers.Base.extend({routes:{\"referral*q\":\"nothing\",\"support*q\":\"nothing\",\"partner*q\":\"nothing\",\"developer*q\":\"nothing\",\"users*q\":\"nothing\",\"about*q\":\"nothing\",\"privacy*q\":\"nothing\",\"terms*q\":\"nothing\",\"support*q\":\"nothing\",\"engine*q\":\"nothing\",\"marketing/*q\":\"nothing\",\"zapbook/updates*q\":\"nothing\",\"zapbook/share*q\":\"nothing\",\"checks*q\":\"nothing\",\"login*q\":\"nothing\",\"subscription*q\":\"nothing\",\"blog*q\":\"nothing\",\"comments*q\":\"nothing\"},nothing:function(){if(Backbone.history.last!=null)Backbone.history.location.reload()}});z.controllers.Simple=z.controllers.Base.extend({routes:{\"app/forgot\":\"forgot\",\"app/forgot/\":\"forgot\",\"app/forgot/:username/:code\":\"forgot\",\"app/forgot/:username/:code/\":\"forgot\",\"app/login\":\"login\",\"app/login/\":\"login\",\"app/login?*qs\":\"login\",\"app/login/?*qs\":\"login\",\"app/login/:status\":\"login\",\"app/login/:status/\":\"login\",bonus:\"rewards\",\"bonus/\":\"rewards\"},remove:function(){var _ref;return(_ref=this.view)!=null?_ref.remove():void 0},forgot:function(username,code){z.app.viewport.title(\"Forgot Password\");this.view=new z.ui.ForgotPassword({username:username,code:code});$(\"#app\").html(this.view.render().el)},login:function(status){var querystring;z.app.viewport.title(\"Login\");querystring=_.object((new z.useful.QueryString).pairs||Array());this.view=new z.ui.Login({status:status,querystring:querystring});return $(\"#app\").html(this.view.render().el)},rewards:function(){if(Backbone.history.last!=null)return Backbone.history.location.reload()}});z.controllers.Home=z.controllers.Base.extend({routes:{\"\":\"home\",\"/\":\"home\"},remove:function(){var _this=this;$(window).off(\"focus\");$(window).off(\"blur\");_.each(this.views,function(view){return view.remove()});return this.views={}},home:function(){if(Backbone.history.last!=null)Backbone.history.location.reload();z.app.viewport.title(\"Automate the Web\");async.series([this.loadViews]);this.preload()},loadViews:function(cb){this.view=new z.ui.Home({el:$(\"#app\")});return typeof cb===\"function\"?cb():void 0},preload:function(){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){return typeof cb===\"function\"?cb():void 0})}});z.controllers.SharedZaps=z.controllers.Base.extend({routes:{\"app/share\":\"explore\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"explore\"},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.search)!=null)_ref.off();return(_ref2=this.recipes)!=null?_ref2.off():void 0},explore:function(){z.app.track[\"new\"](\"Visit Page: share\",{path:window.location.pathname});z.app.viewport.title(\"Explore\");return async.series([this.loadModels,this.loadViews,this.renderViews])},storeFilters:function(filters){return z.store.set(\"recipe-filters\",filters,{expires:60*15})},restoreFilters:function(){var filters;filters={};filters=z.store.get(\"recipe-filters\")||{};_.extend(filters,_.object((new z.useful.QueryString).pairs||Array()));return null},loadModels:function(cb){var recipeOptions,_this=this;z.app.preloader.start(3);recipeOptions={filters:{userid:z.app.account.id},pagination:{perPage:10}};return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),recipes:async.fetch(new z.model.RecipeSet([],recipeOptions),{persist:true}),embed:async.fetch(new z.model.Embed,{persist:false,cache:false})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();z.app.recipes.filters.on(\"change\",function(){return _this.storeFilters(z.app.recipes.filters.toJSON())},_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={recipes:z.app.recipes};$(\"#app\").html(JST.share_base({}));this.$shared=$(\"#app .results\");this.$embed=$(\"#app .embed\");this.views.embed=new z.ui.EmbededZaps({embed:z.app.embed});this.views.sharedZapsView=new z.ui.EmbedSharedZaps(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){console.log(\"render views got called!\");this.$shared.html(this.views.sharedZapsView.render().el);this.$embed.html(this.views.embed.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.Zapbook=z.controllers.Base.extend({routes:{\"zapbook(/)\":\"zapbook\",\"zapbook/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug(/)\":\"zapbook\",\"zapbook/:serviceOneSlug/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug(/)\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:recipeId/:recipeSlug(/)\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:recipeId/:recipeSlug/:qs\":\"zapbook\"},zapbook:function(s1,s2,recipe,recipeSlug){if(Backbone.history.last!=null)Backbone.history.location.reload();this.view=new z.ui.Zapbook({el:$(\"#app\"),s1:s1,s2:s2,recipe:recipe,recipeSlug:recipeSlug});this.preload()},preload:function(){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){return typeof cb===\"function\"?cb():void 0})}});z.controllers.Status=z.controllers.Base.extend({routes:{\"status/\":\"status\"},sizeTable:function(){return $(\".overflow-container\").css({maxWidth:$(\"body\").width()})},status:function(){if(Backbone.history.last!=null)Backbone.history.location.reload();this.view=new z.ui.Status({el:$(\"#app\")});this.sizeTable()}});z.controllers.Editor=z.controllers.Base.extend({routes:{\"app/edit\":\"redirect\",\"app/edit/:id\":\"redirect\",\"app/editor\":\"create\",\"app/editor/\":\"create\",\"app/editor/recipe/:id\":\"fromRecipe\",\"app/editor/recipe/:id/\":\"fromRecipe\",\"app/editor/:id\":\"edit\",\"app/editor/:id/\":\"edit\",\"app/editor/:id/:step\":\"edit\",\"app/editor/:id/:step/\":\"edit\"},views:{},seen:[],redirect:function(id){var url;\nurl=id!=null?\"app/editor/\"+id:\"app/editor\";return Backbone.history.navigate(url,{trigger:true,replace:true})},fromRecipe:function(id){var recipe;recipe=new z.model.Recipe({id:id});return recipe.fetch({success:function(recipe,resp){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}})},match:function(){return z.cfg.defaultSupportTags=\"editor\"},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});this.views={};this.seen=[];this.id=null;this.step=null;if((_ref=z.app.read)!=null)_ref.off();if((_ref2=z.app.write)!=null)_ref2.off();return window.onbeforeunload=null},create:function(){this.flow=true;z.app.viewport.title(\"Create New Zap\");z.app.preloader.start(7);return async.series([this.createModels,this.load,z.app.preloader.done])},edit:function(id,step){this.flow=false;this.id=id;this.step=step;z.app.viewport.title(\"Editor\");z.app.preloader.start(4);return async.series([this.load,z.app.preloader.done])},createModels:function(cb){var createRead,createWrite,navigate,read,updateRead,write,_this=this;read=new z.model.Read;write=new z.model.Write;createRead=function(cb){return read.save({},{success:function(){return cb()}})};createWrite=function(cb){return write.save({read_id:read.id},{success:function(){return cb()}})};updateRead=function(cb){return read.save({write_ids:[write.id]},{success:function(){return cb()}})};navigate=function(cb){_this.id=read.id;Backbone.history.navigate(\"app/editor/\"+_this.id,{replace:true});return cb()};return async.series([createRead,createWrite,updateRead,navigate,function(){return cb()}])},load:function(cb){var _this=this;return async.series([this.loadModels,this.loadViews,this.renderViews,function(){return cb()}])},loadModels:function(cb){var loginRedirect,models,_this=this;z.app.read=new z.model.Read({id:this.id});z.app.write=new z.model.Write;models={services:async.fetch(new z.model.ServiceSet,{persist:true}),auths:async.fetch(new z.model.AuthSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})};if(this.id!=null){models.read=async.fetch(z.app.read,{persist:true})}loginRedirect=_.once(function(){return z.useful.goto(\"/app/login?next=/\"+Backbone.history.fragment)});return async.parallel(models,function(err,models){var id,next,_ref;if(err!=null)return loginRedirect();_.extend(z.app,models);next=[];id=(_ref=z.app.read.get(\"write_ids\"))!=null?_ref[0]:void 0;if(id!=null){z.app.write.set({id:id})}if(id!=null){next.push(async.fetch(z.app.write,{persist:true}))}z.app.readNeeds=new z.model.ParamFormSet([],{node:z.app.read});z.app.writeNeeds=new z.model.ParamFormSet([],{node:z.app.write});z.app.rules=new z.model.RuleSet([],{read:z.app.read});id=z.app.read.id;if(id!=null){next.push(async.fetch(z.app.rules,{persist:true}))}next.push(function(){if(z.app.reads!=null&&z.app.writes!=null){if(!(z.app.reads.get(z.app.read.id)!=null)){z.app.reads.add(z.app.read)}if(!(z.app.reads.get(z.app.write.id)!=null)){z.app.writes.add(z.app.write)}}return typeof cb===\"function\"?cb():void 0});if(z.app.read.hasErrors())_this.flow=true;next.push(function(){return cb()});return async.series(next)})},loadViews:function(cb){var options;options={read:z.app.read,write:z.app.write,rules:z.app.rules,readNeeds:z.app.readNeeds,writeNeeds:z.app.writeNeeds,flow:this.flow};this.views.steps=new z.ui.Steps(_.extend({},options,{}));this.views.servicesActions=new z.ui.ServiceActionStep(_.extend({},options,{}));this.views.triggerAuth=new z.ui.AuthStep(_.extend({},options,{isTrigger:true}));this.views.filters=new z.ui.FilterStep(_.extend({},options,{}));this.views.actionAuth=new z.ui.AuthStep(_.extend({},options,{isTrigger:false}));this.views.map=new z.ui.MapStep(_.extend({},options,{isTrigger:false}));this.views.test=new z.ui.TestStep(_.extend({},options,{}));this.views.enable=new z.ui.EnableStep(_.extend({},options,{}));return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){var options;options={read:z.app.read,write:z.app.write};$(\"#app\").html(JST.editor_base(options));this.views.steps.renderSteps();$(\"#app .editor\").html(this.views.steps.render().el);if(!this.flow)this.views.steps.showAllSteps();if(this.flow)this.next();return typeof cb===\"function\"?cb():void 0},next:function(view){var step,_ref,_this=this;if(view!=null){step=view.$el.closest(\"[data-id]\").attr(\"data-id\");if(_.contains(this.seen,step)||!(step!=null))return;this.seen.push(step)}if(((_ref=this.seen)!=null?_ref.length:void 0)>0){window.onbeforeunload=function(){return\"This Zap is not done yet! Are you sure you want to leave?\"}}return this.views.steps.showNext()}});z.controllers.Pricing=z.controllers.Base.extend({routes:{\"app/pricing\":\"pricing\",\"app/pricing/\":\"pricing\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"pricing\"},remove:function(){var _ref,_this=this;_.each(this.views,function(view){return view.remove()});return(_ref=this.plans)!=null?_ref.off():void 0},pricing:function(){z.app.track[\"new\"](\"Visit Page: pricing\",{path:window.location.pathname});z.app.viewport.title(\"Pricing\");async.series([this.loadModels,this.loadViews,this.renderViews,this.normalizePlanHeight])},loadModels:function(cb){var _this=this;z.app.preloader.start(2);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){$(\"#app\").html(JST.pricing_base({}));this.$plans=$(\"#app .pricing\");this.views.plans=new z.ui.Plans({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$plans.html(this.views.plans.render().el);this.views.plans.normalizePlanHeight();return typeof cb===\"function\"?cb():void 0}});z.controllers.Dashboard=z.controllers.Base.extend({routes:{\"app/dashboard\":\"dashboard\",\"app/dashboard/shared\":\"shared\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"dashboard\"},remove:function(route,fragment){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});this.views={};if((_ref=this.modal)!=null)_ref.close();return(_ref2=z.app.updates)!=null?_ref2.off():void 0},shared:function(){return this.dashboard(true)},dashboard:function(shared){var _this=this;this.requireLogin();z.app.viewport.title(\"Dashboard\");async.series([function(cb){return _this.loadModels(cb,shared!=null)},function(cb){return _this.loadViews(cb,shared!=null)},function(cb){return _this.renderViews(cb,shared!=null)}])},loadModels:function(cb,shared){var calls,_ref,_ref2,_ref3,_this=this;z.app.preloader.start(3);this.search=new z.model.Base({search:(_ref=z.app.partner.get(\"dashboard\"))!=null?_ref.search:void 0});calls={accountBonuses:async.fetch(new z.model.AccountBonusSet,{persist:true}),services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{cache:false,persist:true}),writes:async.fetch(new z.model.WriteSet,{cache:false,persist:true}),stream:async.fetch(new z.model.StreamSet([],{pagination:{perPage:50},filters:{}}),{cache:false,persist:true}),updates:async.fetch(new z.model.UpdateSet,{persist:true})};if((_ref2=z.app.partner)!=null?_ref2.isPartnerSession():void 0){calls.recipes=async.fetch(new z.model.RecipeSet([],{pagination:{page:1},filters:{partner:(_ref3=z.app.account.get(\"provider\"))!=null?_ref3.public_key:void 0}}),{persist:true})}else if(shared){calls.recipes=async.fetch(new z.model.RecipeSet([],{pagination:{page:1,perPage:100},filters:{userid:z.app.account.id,status:\"all\"}}),{persist:true});calls.embed=async.fetch(new z.model.Embed,{persist:false,cache:false})}return async.parallel(calls,function(err,models){_.extend(z.app,models);z.app.preloader.done();z.app.updates.on(\"change\",_this.showAnyUpdates,_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb,shared){$(\"#app\").html(JST.dashboard_base({}));if(z.app.partner.isPartnerSession()&&z.app.reads.length===0){$(\"#app .dashboard .empty\").show();this.$partnerText=$(\"#app .dashboard .empty .left\");this.$partnerZaps=$(\"#app .dashboard .empty .right\");this.views.partnerText=new z.ui.PartnerText({el:this.$partnerText});this.views.partnerZaps=new z.ui.PartnerZaps({el:this.$partnerZaps,button:true});return typeof cb===\"function\"?cb():void 0}if(z.app.partner.isPartnerSession()){this.$start=$(\"#app .main-col .start\");this.views.partnerStart=new z.ui.PartnerZaps({button:false})}this.$zaps=$(\"#app .main-col .zaps\");this.$search=$(\"#app .main-col .search\");this.$side=$(\"#app .side-col\");this.views.search=new z.ui.DashboardSearch({model:this.search,shared:shared});if(shared){this.views.zaps=new z.ui.SharedZaps({search:this.search});this.views.collectionBlock=new z.ui.CollectionBlock({})}else{this.views.zaps=new z.ui.Zaps({search:this.search})}this.views.create=new z.ui.CreateBlock({});this.views.subscribe=new z.ui.SubscribeBlock({});this.views.limits=new z.ui.LimitsBlock({});this.views.logs=new z.ui.LogsBlock({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb,shared){var showPersona;if(z.app.partner.isPartnerSession()&&z.app.reads.length===0){this.views.partnerText.render();this.views.partnerZaps.render();return typeof cb===\"function\"?cb():void 0}if(z.app.partner.isPartnerSession()){this.$start.html(this.views.partnerStart.render().el)}this.$search.html(this.views.search.render().el);this.$zaps.html(this.views.zaps.render().el);this.$side.append(this.views.create.render().el);if(shared)this.$side.append(this.views.collectionBlock.render().el);if(!z.app.account.get(\"is_subscribed_to_blog\")){this.$side.append(this.views.subscribe.render().el)}this.$side.append(this.views.limits.render().el);this.$side.append(this.views.logs.render().el);showPersona=z.store.get(\"showPersonaModal\");if(showPersona){new z.ui.Modal({view:new z.ui.PersonaFormModal})}this.showAnyUpdates();return typeof cb===\"function\"?cb():void 0},showAnyUpdates:function(){var updates;updates=this.newUpdates();if(!_.isEmpty(updates)){return new z.ui.Modal({view:new z.ui.SinceYouBeenGoneModal({model:updates})})}},newUpdates:function(){var last;last=z.store.get(\"lastUpdateViewedDatetime\");z.store.set(\"lastUpdateViewedDatetime\",Date.now());if(!last)last=Date.parse(z.app.account.get(\"last_login\"));this.recentUpdates=_.filter(z.app.updates.toJSON(),function(update){return Date.parse(update.date)>last});return this.recentUpdates}});z.controllers.History=z.controllers.Base.extend({routes:{\"app/history\":\"all\",\"app/history/:id\":\"single\",\"app/history*qs\":\"all\"},views:{},remove:function(){var _this=this;_.each(this.views,function(view){return view.remove()});return this.views={}},all:function(){this.requireLogin();this.querystring=_.object((new z.useful.QueryString).pairs||Array());z.app.viewport.title(\"Task History\");async.series([this.loadModels,this.loadViews,this.renderViews])},loadModels:function(cb){var filters,pagination,_ref,_ref2,_this=this;z.app.preloader.start(4);filters=_.extend({},_.compactObject((_ref=z.app.stream)!=null?_ref.filterStore:void 0),this.querystring);pagination=((_ref2=z.app.stream)!=null?_ref2.paginationStore:void 0)||{};pagination.perPage=25;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true}),stream:async.fetch(new z.model.StreamSet([],{pagination:pagination,filters:filters},{persist:true}))},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){$(\"#app\").html(JST.history_base({}));this.$filters=$(\"#app .head\");this.$all=$(\"#app .body\");this.views.filters=new z.ui.HistoryFilters({});this.views.all=new z.ui.History({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$filters.html(this.views.filters.render().el);this.$all.html(this.views.all.render().el);return typeof cb===\"function\"?cb():void 0},single:function(id){this.id=id;this.requireLogin();this.querystring=_.object((new z.useful.QueryString).pairs||Array());z.app.viewport.title(\"Task History \"+this.id);async.series([this.loadSingleModels,this.loadSingleViews,this.renderSingleViews])},loadSingleModels:function(cb){var _this=this;z.app.preloader.start(4);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true}),streamItem:async.fetch(new z.model.Stream({id:this.id},{persist:true}))},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadSingleViews:function(cb){$(\"#app\").html(JST.history_base({id:this.id}));this.$nav=$(\"#app .head\");this.$details=$(\"#app .body\");this.views.nav=new z.ui.HistoryNav({id:this.id});this.views.details=new z.ui.HistoryDetails({streamItem:z.app.streamItem});return typeof cb===\"function\"?cb():void 0},renderSingleViews:function(cb){this.$nav.html(this.views.nav.render().el);this.$details.html(this.views.details.render().el);return typeof cb===\"function\"?cb():void 0}});var DEVELOPER_ROUTES,_DEVELOPER_ROUTES;_DEVELOPER_ROUTES={\"(/)\":\"dashboard\",\"/app/create(/)\":\"create\",\"/app/:id(/)\":\"viewApp\",\"/app/:id/meta(/)\":\"meta\",\"/app/:id/requests(/)\":\"requests\",\"/app/:id/activate(/)\":\"activate\",\"/app/:id/invite(/)\":\"invite\",\"/app/:id/migrate/:old_id\":\"migrate\",\"/app/:id/migrate(/)\":\"chooseMigrationTarget\",\"/app/:id/scripting(/)\":\"scripting\",\"/app/:id/auth/edit/fields/create(/)\":\"createAuthFieldWizard\",\"/app/:id/auth/edit/fields/:fieldId(/)\":\"editAuthFieldWizard\",\"/app/:id/auth/edit/:section(/)\":\"authWizard\",\"/app/:id/auth/settings(/)\":\"authSettings\",\"/app/:id/auth/fields/create(/)\":\"createAuthField\",\"/app/:id/auth/fields/:fieldId/edit(/)\":\"editAuthField\",\"/app/:id/triggers(/)\":\"triggers\",\"/app/:id/triggers/create(/)\":\"createTrigger\",\"/app/:id/triggers/create/test(/)\":\"createTestTrigger\",\"/app/:id/triggers/settings(/)\":\"triggerSettings\",\"/app/:id/triggers/:trigger/edit(/)\":\"editTrigger\",\"/app/:id/triggers/:trigger/edit/fields(/)\":\"triggerFields\",\"/app/:id/triggers/:trigger/edit/sample(/)\":\"editTriggerSample\",\"/app/:id/triggers/:trigger/edit/:section(/)\":\"editTrigger\",\"/app/:id/triggers/:trigger/fields(/)\":\"triggerFields\",\"/app/:id/triggers/:trigger/fields/create(/)\":\"createTriggerField\",\"/app/:id/triggers/:trigger/fields/:field(/)\":\"editTriggerField\",\"/app/:id/actions(/)\":\"actions\",\"/app/:id/actions/create(/)\":\"createAction\",\"/app/:id/actions/:action/edit(/)\":\"editAction\",\"/app/:id/actions/:action/edit/fields(/)\":\"actionFields\",\"/app/:id/actions/:action/edit/:section(/)\":\"editAction\",\"/app/:id/actions/:action/fields(/)\":\"actionFields\",\"/app/:id/actions/:action/fields/create(/)\":\"createActionField\",\"/app/:id/actions/:action/fields/:field(/)\":\"editActionField\"};DEVELOPER_ROUTES=_.object(_.map(_.keys(_DEVELOPER_ROUTES),function(r){return z.cfg.devpath+r}),_.values(_DEVELOPER_ROUTES));z.controllers.Developer=z.controllers.Base.extend({routes:DEVELOPER_ROUTES,views:{},isAppCacheStale:false,isAppSetCacheStale:false,remove:function(){var _this=this;return _.each(this.views,function(view){return view.remove()})},loadApp:function(appId,cb,additionalModels){var models,_this=this;if(additionalModels==null)additionalModels={};if(!(z.app.developer.app!=null)||z.app.developer.app.get(\"id\")!==Number(appId)||z.app.developer.isAppCacheStale){z.app.developer.isAppCacheStale=false;models={app:async.fetch(new z.model.DeveloperApp({id:appId}),{cache:false,persist:false})}}else{models={}}_.extend(models,additionalModels);z.app.preloader.start(_.keys(models).length);return async.parallel(models,function(err,model){var allowedUrls;_.extend(z.app.developer,model);z.app.viewport.title(z.app.developer.app.get(\"title\")+\" - Dev Platform\");z.app.preloader.done();if(!z.app.developer.app.isEditable()){allowedUrls=[\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),\"/\"+z.cfg.devpath+\"/\"+z.app.developer.app.get(\"id\")+\"/invite\"];if(!_.contains(allowedUrls,Backbone.history.location.pathname)){Backbone.history.navigate(allowedUrls[0],{trigger:true});return}}return typeof cb===\"function\"?cb():void 0})},placeInWrapper:function(view){$(\"#app\").html(JST.developer_base({}));return $(\"#app .developer-content\").html(view.render().el)},dashboard:function(){var loadModels,renderViews,_this=this;this.requireLogin();z.app.viewport.title(\"Dashboard - Dev Platform\");loadModels=function(cb){var options;z.app.preloader.start(1);options={};if(z.app.developer.isAppSetCacheStale){z.app.developer.isAppSetCacheStale=false;options.cache=false;options.persist=false}return async.parallel({apps:async.fetch(new z.model.DeveloperAppSet,options)},function(err,models){if(!(z.app.developer!=null))z.app.developer={};_.extend(z.app.developer,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})};renderViews=function(cb){var supportContainer;_this.views.dashboard=new z.ui.DeveloperDashboard({});if($(\"#app\").length===0){supportContainer=$(\"#app .support.container\");supportContainer.find(\".search\").after('<div class=\"column three-quarters developer\" id=\"developer\"></div>').remove();supportContainer.find(\".content\").remove()}$(\"#app\").html(JST.developer_base({}));$(\"#app .developer-nav\").hide();$(\"#app .developer-content\").html(_this.views.dashboard.render().el);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},viewApp:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app=new z.ui.DeveloperApp({subViews:{stats:new z.ui.DeveloperAppStats({}),auth:new z.ui.DeveloperAppAuth({}),triggers:new z.ui.DeveloperAppTriggers({}),actions:new z.ui.DeveloperAppActions({})}});_this.placeInWrapper(_this.views.app);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},create:function(){this.meta(null)},meta:function(id){var app,formLoader,linkModels,loadModels,renderViews,_this=this;this.requireLogin();formLoader={form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/meta\"}))};if(id!=null){loadModels=function(cb){return _this.loadApp(id,cb,formLoader)}}else{z.app.viewport.title(\"Create Service - Dev Platform\");loadModels=function(cb){z.app.preloader.start(1);return async.parallel(formLoader,function(err,models){_.extend(z.app.developer,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})}}app=null;linkModels=function(cb){if(id!=null){app=z.app.developer.app}else{app=new z.model.DeveloperApp}z.app.developer.form.setWrappedModel(app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_meta=new z.ui.DeveloperAppMeta({app:app});_this.placeInWrapper(_this.views.app_meta);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},authWizard:function(id,section){var extraModels,loadModels,renderViews,_this=this;if(section==null)section=\"scheme\";this.requireLogin();extraModels={};if(section===\"mapping\"){extraModels.form=async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-settings\"}))}loadModels=function(cb){return _this.loadApp(id,cb,extraModels)};renderViews=function(cb){var options;options={section:section};if(section===\"scheme\"){options.sectionView=new z.ui.DeveloperAppAuthEditorScheme}else if(section===\"fields\"){options.sectionView=new z.ui.DeveloperAppAuthEditorFields}else{z.app.developer.form.setWrappedModel(z.app.developer.app);options.sectionView=new z.ui.DeveloperAppAuthEditorForm(options)}_this.views.app_auth_editor=new z.ui.DeveloperAppAuthEditor(options);_this.placeInWrapper(_this.views.app_auth_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},authSettings:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-settings\"}))})};linkModels=function(cb){z.app.developer.form.setWrappedModel(z.app.developer.app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_auth_settings=new z.ui.DeveloperAppAuthSettings({});_this.placeInWrapper(_this.views.app_auth_settings);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},createAuthFieldWizard:function(id){return this.editAuthField(id,null,true)},editAuthFieldWizard:function(id,fieldId){return this.editAuthField(id,fieldId,true)},createAuthField:function(id){return this.editAuthField(id,null)},editAuthField:function(id,fieldId,isWizard){var field,linkModels,loadModels,renderViews,_this=this;if(isWizard==null)isWizard=false;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-field\"}))})};field=null;linkModels=function(cb){if(fieldId!=null){field=z.app.developer.app.authFields.get(fieldId)}else{field=new z.model.DeveloperAppAuthField({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_auth_field_editor=new z.ui.DeveloperAppAuthFieldEditor({field:field,isWizard:isWizard});_this.placeInWrapper(_this.views.app_auth_field_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggers:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app_triggers=new z.ui.DeveloperAppTriggers({});_this.placeInWrapper(_this.views.app_triggers);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createTrigger:function(id){return this.editTrigger(id,null,\"appearance\")},createTestTrigger:function(id){return this.editTrigger(id,null,\"appearance\",true)},editTrigger:function(id,triggerId,section,asTest){var formName,linkModels,loadModels,renderViews,sectionToFormNameMap,trigger,_this=this;if(section==null)section=\"appearance\";if(asTest==null)asTest=false;this.requireLogin();sectionToFormNameMap={appearance:\"trigger\",backend:\"trigger-source\"};formName=sectionToFormNameMap[section];loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/\"+formName}))})};trigger=null;linkModels=function(cb){if(triggerId!=null){trigger=z.app.developer.app.triggers.get(triggerId)}else if(asTest){trigger=new z.model.DeveloperAppTrigger({hide:true,important:false,test_trigger:true},{app:z.app.developer.app})}else{trigger=new z.model.DeveloperAppTrigger({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(trigger);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var options;options={trigger:trigger,section:section};options.sectionView=new z.ui.DeveloperAppTriggerEditorForm(options);_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor(options);_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},editTriggerSample:function(id,triggerId){var linkModels,loadModels,renderViews,triggerSample,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/sample\"})),triggerSample:async.fetch(new z.model.DeveloperAppTriggerSampleResult({},{appId:id,triggerId:triggerId}))})};triggerSample=null;linkModels=function(cb){triggerSample=z.app.developer.triggerSample;delete z.app.developer.triggerSample;z.app.developer.form.setWrappedModel(triggerSample);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView,trigger;trigger=z.app.developer.app.triggers.get(triggerId);sectionView=new z.ui.DeveloperAppTriggerSampleResult({trigger:trigger,triggerSample:triggerSample});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"sample\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggerFields:function(id,triggerId){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){var sectionView,trigger;trigger=z.app.developer.app.triggers.get(triggerId);sectionView=new z.ui.DeveloperAppTriggerFields({trigger:trigger});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createTriggerField:function(id,triggerId){return this.editTriggerField(id,triggerId,null)},editTriggerField:function(id,triggerId,fieldId){var field,linkModels,loadModels,renderViews,trigger,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/trigger-field\"}))})};field=null;trigger=null;linkModels=function(cb){trigger=z.app.developer.app.triggers.get(triggerId);if(fieldId!=null){field=trigger.fields.get(fieldId)}else{field=new z.model.DeveloperAppTriggerField({},{app:z.app.developer.app,trigger:trigger})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView;sectionView=new z.ui.DeveloperAppTriggerFieldEditor({field:field,trigger:trigger});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggerSettings:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/trigger-settings?app_id=\"+id}))})};linkModels=function(cb){z.app.developer.form.setWrappedModel(z.app.developer.app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_trigger_settings=new z.ui.DeveloperAppTriggerSettings({});_this.placeInWrapper(_this.views.app_trigger_settings);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},actions:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app_actions=new z.ui.DeveloperAppActions({});_this.placeInWrapper(_this.views.app_actions);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createAction:function(id){return this.editAction(id,null,\"appearance\")},editAction:function(id,actionId,section){var action,formName,linkModels,loadModels,renderViews,sectionToFormNameMap,_this=this;if(section==null)section=\"appearance\";this.requireLogin();sectionToFormNameMap={appearance:\"action\",backend:\"action-source\"};formName=sectionToFormNameMap[section];loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/\"+formName}))})};action=null;linkModels=function(cb){if(actionId!=null){action=z.app.developer.app.actions.get(actionId)}else{action=new z.model.DeveloperAppAction({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(action);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var options;options={action:action,section:section};options.sectionView=new z.ui.DeveloperAppActionEditorForm(options);_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor(options);_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},actionFields:function(id,actionId){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){var action,sectionView;action=z.app.developer.app.actions.get(actionId);sectionView=new z.ui.DeveloperAppActionFields({action:action});_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor({action:action,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createActionField:function(id,actionId){return this.editActionField(id,actionId,null)},editActionField:function(id,actionId,fieldId){var action,field,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/action-field\"}))})};field=null;action=null;linkModels=function(cb){action=z.app.developer.app.actions.get(actionId);if(fieldId!=null){field=action.fields.get(fieldId)}else{field=new z.model.DeveloperAppActionField({},{app:z.app.developer.app,action:action})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView;sectionView=new z.ui.DeveloperAppActionFieldEditor({field:field,action:action});_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor({action:action,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},requests:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{})};renderViews=function(cb){_this.views.app_requests=new z.ui.DeveloperAppRequests;_this.placeInWrapper(_this.views.app_requests);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},activate:function(id){var activationRequest,audit,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/request-global\"})),audit:async.fetch(new z.model.DeveloperAppAudit([],{appId:id}),{cache:false,persist:false})})};audit=null;activationRequest=null;linkModels=function(cb){audit=z.app.developer.audit;delete z.app.developer.audit;activationRequest=new z.model.DeveloperAppActivationRequest([],{app:z.app.developer.app});z.app.developer.form.setWrappedModel(activationRequest);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_activation=new z.ui.DeveloperAppActivation({activationRequest:activationRequest,audit:audit});_this.placeInWrapper(_this.views.app_activation);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},invite:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/email-invite\"}))})};linkModels=function(cb){var model;model=new z.model.Base;model.urlRoot=z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/invites\");z.app.developer.form.setWrappedModel(model);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_invite=new z.ui.DeveloperAppInvite;_this.placeInWrapper(_this.views.app_invite);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},chooseMigrationTarget:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.FormSet([],{url:z.cfg.devapi+\"/forms/migration-request\"}))})};renderViews=function(cb){_this.views.app_migrate_choose_target=new z.ui.DeveloperAppChooseMigrationTarget({form:z.app.developer.form});\n_this.placeInWrapper(_this.views.app_migrate_choose_target);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},migrate:function(id,oldAppId){var audit,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.FormSet([],{url:z.cfg.devapi+\"/forms/migration-request\"})),audit:async.fetch(new z.model.DeveloperAppAudit([],{appId:id,compareTo:oldAppId}),{cache:false,persist:false})})};audit=null;linkModels=function(cb){audit=z.app.developer.audit;delete z.app.developer.audit;return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_migrate=new z.ui.DeveloperAppMigrate({audit:audit,oldAppId:oldAppId});_this.placeInWrapper(_this.views.app_migrate);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},scripting:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{})};renderViews=function(cb){_this.views.app_scripting=new z.ui.DeveloperAppScripting;_this.placeInWrapper(_this.views.app_scripting);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])}});z.ui.Base=Backbone.View.extend({constructor:function(options){if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}Backbone.View.prototype.constructor.apply(this,arguments)}});z.ui.Store=Backbone.Collection.extend({retrieve:function(View){var v,_this=this;v=this.find(function(v){if(v.get(\"view\")instanceof View)return true});return v!=null?v.get(\"view\"):void 0},inject:function(view,View){var v;v=new Backbone.Model({view:view,View:view});this.add(v);return v!=null?v.get(\"view\"):void 0}});z.ui.Singleton=function(View){var Singleton,construct,store;construct=function(){var child;child=function(args){return View.apply(this,args)};child.prototype=View.prototype;return function(args){return new child(args)}};View.prototype.store=new z.ui.Store;store=View.prototype.store;return Singleton=function(){function Singleton(){var single;single=store.retrieve(View)||store.inject(construct()(arguments),View);return single}return Singleton}()};z.ui.UpgradeModal=z.ui.Base.extend({className:\"upgrade\",events:{\"click a\":\"close\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var _ref,_ref2;return{errors:(_ref=this.options)!=null?_ref.errors:void 0,hasErrors:((_ref2=this.options)!=null?_ref2.errors:void 0)!=null}},render:function(){this.$el.html(JST.common_upgrade_modal(this.context()));return this},close:function(e){var _ref;return(_ref=this.modal)!=null?_ref.close():void 0}});z.ui.ErrorModal=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},render:function(){var view;view={statusCode:this.options.statusCode,statusText:this.options.statusText,responseText:this.options.responseText};this.$el.html(\"<div style='padding: 0 50px;'>\"+view.statusCode+\" Error</div>\");return this}});z.ui.RestartModal=z.ui.Base.extend({initialize:function(options){return _.bindAll(this)},render:function(){var view;view={};this.$el.html(\"<div style='padding: 0 50px;'>Server is restarting (502 error).</div>\");return this}});z.model.ErrorHandler=z.model.Base.extend({initialize:function(){var _this=this;_.bindAll(this);this.registerAjaxHandler();this.tripwire=_.after(10,this.leave);return setInterval(function(){return _this.tripwire=_.after(10,_this.leave)},60*1e3)},leave:function(){return window.location.href=\"/wtf\"},registerAjaxHandler:function(){var _this=this;return $(document).ajaxError(function(e,xhr,settings){var msg,responseText,statusCode,statusText,url,_ref,_ref2;statusCode=xhr.status;statusText=xhr.statusText;responseText=xhr.responseText;url=settings.url;if(_this.filterForUpgrade(statusCode))_this.showUpgradeMessage(xhr);if(_this.filterForRestartMessage(statusCode))_this.showRestartMessage();if(_this.filterForErrorMessage(statusCode)){_this.tripwire();_this.showErrorMessage(statusCode,statusText,responseText)}if(_this.filterForTracking(statusCode)){try{return msg=(_ref=JSON.parse(responseText))!=null?(_ref2=_ref.errors)!=null?_ref2.join(\", \"):void 0:void 0}catch(error){return msg=responseText}}})},showErrorMessage:function(statusCode,statusText,responseText){var modal,options;options={statusCode:statusCode,statusText:statusText,responseText:responseText};return modal=new z.ui.Modal({view:new z.ui.ErrorModal(options)})},showRestartMessage:function(){var modal;return modal=new z.ui.Modal({view:new z.ui.RestartModal({})})},showUpgradeMessage:function(xhr){var modal,_ref;return modal=new z.ui.Modal({view:new z.ui.UpgradeModal({errors:((_ref=JSON.parse(xhr.responseText))!=null?_ref.errors:void 0)||[]})})},filterForRestartMessage:function(statusCode){if(statusCode===502)return true},filterForErrorMessage:function(statusCode){if(statusCode===502)return false;if(statusCode===503)return false;if(500<=statusCode&&statusCode<600)return true},filterForTracking:function(statusCode){if(405<=statusCode&&statusCode<600)return true},filterForUpgrade:function(statusCode){if(statusCode===426)return true}});z.ui.RenameModal=z.ui.Base.extend({className:\"rename\",events:{\"click .save\":\"submit\",\"submit .name\":\"submit\"},initialize:function(options){this.options=options;if(!(options.save!=null))throw\"save required\";return _.bindAll(this)},context:function(){var context;context={value:this.options.value};return context},render:function(){this.$el.html(JST.common_rename_modal(this.context()));this.$(\"input\").first().focus();return this},submit:function(e){if(e!=null)e.preventDefault();this.options.save(this.$el.find(\"input\").val());return this.modal.close()}});z.ui.ShareZapModal=z.ui.Base.extend({className:\"share-zap\",events:{\"click .submit\":\"submit\",\"submit form\":\"submit\",\"change .disabler\":\"disabler\"},initialize:function(options){var renderSubmit;this.options=options;_.bindAll(this);renderSubmit=_.debounce(this.renderSubmit,40);this.form=new z.model.FormSet({});this.form.on(\"change:valid\",renderSubmit,this);this.read=this.options.read;this.write=this.options.write;this.recipe=null;this.readNeeds=new z.model.ParamFormSet([],{node:this.read});this.writeNeeds=new z.model.ParamFormSet([],{node:this.write});if(this.read.id){return z.store.set(this.read.id+\"-shared\",\"yes\",{expires:1})}},context:function(){var context;context={};context.zapTitle=this.read.getTitle();context.readClass=this.read.serviceImageClass();context.writeClass=this.write.serviceImageClass();return context},render:function(){var context;context=this.context();this.$el.html(JST.common_share_zap_modal(context));this.$paramform=this.$(\"paramform\");this.renderForm();return this},thanksContext:function(){var declaration,e,out,read_service,what_is_zapier,write_service,zapier_image,_ref;out={};out.recipe=(_ref=this.recipe)!=null?_ref.toJSON():void 0;if(out.recipe){e=encodeURIComponent;read_service=z.app.services.get(this.read.get(\"selected_api\"));write_service=z.app.services.get(this.write.get(\"selected_api\"));zapier_image=z.cfg.mediaURL+\"images/frontend/placeholder/128x128.png\";declaration=\"I just connected \"+read_service.getName()+\" to \"+write_service.getName()+\" with Zapier!\";what_is_zapier=\"Zapier makes it easy to integrate hundreds of business web applications without writing a single line of code.\";out.twitter_href=\"https://twitter.com/intent/tweet?text=\"+e(declaration)+\"+\"+e(\"Check it out!\")+\"+\"+e(out.recipe.share_url);out.facebook_href=\"https://www.facebook.com/dialog/feed?app_id=234230510040096&redirect_uri=\"+e(\"https://zapier.com/\")+\"&link=\"+e(out.recipe.share_url_raw)+\"&name=\"+e(declaration)+\"&description=\"+e(what_is_zapier)+\"&picture=\"+e(zapier_image);out.linkedin_href=\"http://www.linkedin.com/shareArticle?mini=true&url=\"+e(out.recipe.share_url_raw)+\"&title=\"+e(declaration)+\"&summary=\"+e(what_is_zapier)+\"&source=\"+e(\"Zapier\");out.email_href=\"mailto:your@friend.com?subject=\"+e(declaration)+\"&body=\"+e(what_is_zapier)+\"+\"+e(out.recipe.share_url)}return out},renderThanks:function(){this.$el.html(JST.common_share_thanks_modal(this.thanksContext()));this.modal.reposition();return this},prunePrefillsAndEmpty:function(fields){var thing;return thing=6},renderForm:function(){var fields,loadReads,loadWrites,_this=this;fields=[{key:\"description\",label:\"What problem does this Zap solve?\",type:\"text\",required:true,help_text:\"Briefly describe what problem this Zap solves for you, and how it solves it.\"},{key:\"directions\",type:\"copy\",required:false,help_text_html:'<h3>Customize Template Fields</h3><span class=\"arr\">&darr;</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checked fields below will be shared.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Changes made here <strong>will not</strong> affect your zap.'}];loadReads=function(cb){return _this.readNeeds.fetch({cache:false,success:function(){return cb()},error:function(){return cb()}})};loadWrites=function(cb){return _this.writeNeeds.fetch({cache:false,success:function(){return cb()},error:function(){return cb()}})};this.setMode(\"loading\",\"fields\");return async.series([loadReads,loadWrites],function(err,result){_this.setMode(\"loaded\",\"fields\");_this.readNeeds.each(function(field){field=field.toJSON();if(field.list!=null)delete field.list;return _.each(_this.read.get(\"params\"),function(value,key,list){if(field.key===key&&value&&!field.prefill){field.label=\"Trigger: \"+(field.label||_.superHumanize(field.key));field.key=\"read_data__params__\"+field.key;field.required=false;field.value=value;return fields.push(field)}})});_this.writeNeeds.each(function(field){field=field.toJSON();if(field.list!=null)delete field.list;return _.each(_this.write.get(\"params\"),function(value,key,list){if(field.key===key&&value&&!field.prefill){field.label=\"Action: \"+(field.label||_.superHumanize(field.key));field.key=\"write_data__params__\"+field.key;field.required=false;field.value=value;return fields.push(field)}})});_this.form.reset(fields);_this.paramform=new z.ui.ParamForm({form:_this.form,prettypills:true});_this.$paramform.html(_this.paramform.render().el);_.each(_this.$paramform.find(\".field\").not(\".field-description,.field-directions\"),function(el){var input,name;el=$(el);name=el.find(\"[data-id]\").attr(\"data-id\");input=$(\"<input />\").attr({name:\"hide__\"+name,\"org-name\":name,type:\"checkbox\",\"class\":\"disabler\",checked:\"true\",title:\"Uncheck to not share this field with your Zap.\"});el.prepend($('<small class=\"\">'));return el.prepend(input)});_this.modal.reposition();return _this.renderSubmit()})},disabler:function(e){var referenced,sel;if(e!=null)e.preventDefault();sel=$.escapeSel($(e.currentTarget).attr(\"org-name\"));referenced=this.$paramform.find(\"[data-id=\"+sel+\"]\").parent().parent();if($(e.currentTarget).is(\":checked\")){return referenced.removeClass(\"disabled\")}else{return referenced.addClass(\"disabled\")}},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},submit:function(e){var data,disabled_names,error,success,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");data=this.form.getValues();success=function(model,resp,opts){var _ref;_this.recipe=new z.model.Recipe(resp);_this.read.set({has_shared:true});z.app.track[\"new\"](\"Shared Zap\",{path:window.location.pathname});if((_ref=_this.options.success)!=null)_ref.call(_this,_this.recipe);return _this.renderThanks()};error=function(model,xhr,opts){var errors,_ref;_this.setMode(\"enable\",\"submit\");errors=z.useful.errors(xhr);_this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(errors);return(_ref=_this.options.error)!=null?_ref.apply(_this,arguments):void 0};disabled_names=_.map(this.$paramform.find(\".disabler:not(:checked)\"),function(el){return $(el).attr(\"org-name\")});_.each(disabled_names,function(disabled_name){return delete data[disabled_name]});data=_.unflatten(_.compactObject(data));return this.options.read.share(data,{success:success,error:error})}});z.ui.AuthErrorModal=z.ui.Base.extend({className:\"raw-error\",initialize:function(options){this.options=options;_.bindAll(this);if(this.options.auth!=null){return this.service=z.app.services.get(this.options.auth.get(\"selected_api\"))}},context:function(){var context,_ref;return context={type:this.options.type,hasUpfronts:(_ref=this.service)!=null?_ref.hasUpfronts():void 0,message:this.options.message}},render:function(){this.$el.html(JST.common_auth_error_modal(this.context()));return this}});z.ui.CollectEmailModal=z.ui.Base.extend({className:\"collect-email\",events:{\"submit form\":\"submit\",\"click input[type=submit]\":\"submit\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){},render:function(){this.$el.html(JST.common_collect_email_modal(this.context()));z.useful.placeholders(this.$el);return this},submit:function(e){var email,options,s1,s2,_this=this;if(e!=null)e.preventDefault();this.$(\".feedback\").removeClass(\"success error hide\").addClass(\"hide\");email=this.$(\"#email\").val();s1=this.options.s1;s2=this.options.s2;options={url:\"/api/v2/email/\"+s1+\"/\"+s2,type:\"post\",dataType:\"json\",data:JSON.stringify({email:email}),success:function(model,resp){var _ref;_this.$(\".feedback\").addClass(\"success\").removeClass(\"hide\").text(\"Thank you! We will email you when we have news.\");_.delay(function(){return _this.modal.close()},3e3);return(_ref=_this.options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(model,xhr){return this.$(\".feedback\").addClass(\"error\").removeClass(\"hide\").text(z.useful.errors(xhr))}};return Backbone.sync(\"create\",this,options)}});z.ui.AuthRequestModal=z.ui.Base.extend({className:\"request-auth\",events:{\"click .submit\":\"submit\",\"submit form\":\"submit\"},initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,options);this.form=new z.model.FormSet({});return this.form.on(\"change:valid\",this.renderSubmit,this)},context:function(){var context;context={service:this.options.service};return context},render:function(){this.$el.html(JST.common_auth_request_modal(this.context()));this.$paramform=this.$(\"paramform\");this.renderForm();return this},renderForm:function(){var fields;fields=[{key:\"email\",label:\"Email Address\",type:\"unicode\",required:true,help_text:\"The person you need access from.\"}];this.form.reset(fields);this.paramform=new z.ui.ParamForm({form:this.form});return this.$paramform.html(this.paramform.render().el)},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},submit:function(e){var data,error,success,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");data=this.form.getValues();data[\"selected_api\"]=this.options.service.get(\"key\");success=function(model,resp){_this.$(\".feedback\").removeClass(\"hide\").text(\"Request has been sent!\");return _.delay(function(){return _this.modal.close()},3500)};error=function(model,xhr){var errors;errors=z.useful.errors(xhr);return _this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(errors)};return z.app.auths.request(data,{success:success,error:error})}});z.ui.AuthEditModal=z.ui.Base.extend({className:\"menu with-hover\",events:{\"click .rename\":\"rename\",\"click .manage\":\"manage\",\"click .delete\":\"delete\"},initialize:function(options){this.options=options;if(!(options.auth!=null))throw\"auth required\";return _.bindAll(this)},context:function(){var context;context={onEditor:this.options.onEditor,od:this.options.auth.id};return context},render:function(){this.$el.html(JST.common_auth_edit_modal(this.context()));return this},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.options.auth.save({title:value})};this.modal.close();return modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.options.auth.get(\"title\"),save:save})})},manage:function(e){if(e!=null)e.preventDefault();this.modal.close();return Backbone.history.navigate(\"app/settings/authorizations\",{trigger:true})},\"delete\":function(e){var context,destroy,message,modal,_this=this;if(e!=null)e.preventDefault();destroy=function(value){return _this.options.auth.destroy()};context={service:this.options.auth.get(\"selected_api\"),title:this.options.auth.get(\"title\")};message=new Handlebars.SafeString(JST.common_auth_delete_message(context));this.modal.close();return modal=new z.ui.Modal({view:new z.ui.ConfirmModal({message:message,yes:destroy})})}});z.ui.DataTableModal=z.ui.Base.extend({className:\"data-table\",events:{\"click td.value\":\"clickValue\"},initialize:function(options){this.options=options;if(!(options.data!=null))throw\"data required\";return _.bindAll(this)},render:function(){this.$el.html(JST.common_data_table_modal({data:this.options.data}));return this},clickValue:function(e){return this.$(e.currentTarget).toggleClass(\"nomax\")}});z.ui.MenuModal=z.ui.Base.extend({className:\"menu with-hover\",events:{\"click a\":\"close\",\"click [data-nav=logout]\":\"logout\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={email:z.app.account.get(\"email\"),developer:z.app.account.isDeveloper()};return context},render:function(){this.$el.html(JST.common_menu_modal(this.context()));this.$(\"input\").first().focus();return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},logout:function(e){if(e!=null)e.preventDefault();Backbone.cache.lawnchair.nuke();return z.useful.goto(\"/logout\")}});z.ui.ModalContentHTML=z.ui.Base.extend({html:null,className:\"plain-html\",initialize:function(options){this.options=options;_.bindAll(this);return this.html=options.view},render:function(){this.$el.html(this.html);this.$el.addClass(this.options[\"class\"]);return this}});z.ui.Modal=z.ui.Base.extend({tagName:\"div\",className:\"modal-layer\",events:{click:\"click\",\"click .close\":\"close\",\"click .x\":\"close\"},initialize:function(options){var _this=this;this.options=options;if(!(options.view!=null))throw\"view required\";_.bindAll(this);if(!(this.options.autoFocus!=null))this.options.autoFocus=true;if(!(this.options.shortenToFit!=null))this.options.shortenToFit=false;this.delegateEvents(_.extend(this.events,this.options.events));this.view=this.options.view;if(_.isString(this.options.view)){this.view=new z.ui.ModalContentHTML(this.options)}this.view.modal=this;this.reposition=_.bind(_.throttle(this.position,50),this);this.on(\"remove\",function(){var _ref,_ref2;_this.view.remove();if((_ref=$(window))!=null)_ref.off(\"resize\",_this.reposition);if((_ref2=$(window))!=null)_ref2.off(\"scroll\",_this.reposition);z.app.off(\"render\",_this.reposition);Backbone.history.off(\"route\",_this.clearClicks);return z.app.off(\"click\",_this.addClick)});return this.render()},render:function(){var target,_ref,_ref2,_this=this;this.clicks=_.clone(z.app.clicks);$(window).on(\"resize\",this.reposition);$(window).on(\"scroll\",this.reposition);z.app.on(\"click\",this.addClick);Backbone.history.on(\"route\",this.clearClicks);z.app.on(\"render\",this.reposition);this.setMode(\"is\",\"open\");this.$el.html(JST.common_base_modal(this.options));this.$container=this.$(\".modal-container\");this.$modal=this.$(\".modal\");this.$modal.html(this.view.render().el);target=$(\"body .modal-layer\").last();if(target.length>0){this.$el.insertAfter(target)}else{this.$el.appendTo($(\"body\"))}if(!this.haveTarget()){this.$el.removeClass(\"with-dim\").addClass(\"with-dim\");this.renderDim()}if((_ref=this.options)!=null?_ref.noLayer:void 0){this.$el.removeClass(\"no-layer\").addClass(\"no-layer\")}if((_ref2=this.options)!=null?_ref2.noBackgroundClose:void 0){this.$el.addClass(\"no-bg-close\")}if(this.options.width!=null){this.$container.css(\"width\",this.options.width)}if(this.options.width!=null)this.$modal.css(\"width\",this.options.width);_.defer(function(){return _this.position()});if(z.cfg.browser!==\"Explorer\"&&this.options.autoFocus){_.defer(function(){return _this.$(\"input\").first().focus()})}if(this.options.shortenToFit){_.defer(function(){return _this.shortenToFit()})}return this},setLayerSize:function(){return this.$el.css(\"height\",$(\"body\").height())},addClick:function(e){this.clicks.unshift(e);return this.clicks=this.clicks.slice(0,10)},clearClicks:function(){return this.clicks=[]},position:function(){var bheight,bwidth,click,height,width,x,y,_ref,_ref2,_ref3,_ref4,_this=this;if(!(this.$modal!=null))return;if(this.haveTarget()){x=$(this.options.target).offset().left;y=$(this.options.target).offset().top;this.setMode(\"not\",\"global\")}else if(((_ref=z.app.partner)!=null?_ref.isPartnerSession():void 0)&&((_ref2=z.app.partner)!=null?_ref2.hasIframeJs:void 0)){click=_.find(this.clicks,function(click){return click.clientY!=null});_ref3=z.useful.viewportSize(),bwidth=_ref3[0],bheight=_ref3[1];width=this.$modal.outerWidth(true);height=this.$modal.outerHeight(true);x=bwidth/2-width/2;y=click!=null?click.clientY-height/2:50;this.setMode(\"is\",\"global\")}else{_ref4=z.useful.viewportSize(),bwidth=_ref4[0],bheight=_ref4[1];width=this.$modal.outerWidth(true);height=this.$modal.outerHeight(true);x=bwidth/2-width/2;y=bheight*(9/20)-height/2;if(y<40){y=40;bheight-=60}this.setMode(\"is\",\"global\")}if(this.options.x!=null)x+=Number(this.options.x);if(this.options.y!=null)y+=Number(this.options.y);if(this.haveTarget()){this.$container.css(\"left\",x);this.$container.css(\"top\",y)}else{this.$modal.css(\"maxHeight\",bheight);if(this.$modal.height()>=$(\".modal-container\").height()){this.$modal.css(\"padding-bottom\",\"60px\")}}return this.$modal.removeClass(\"invisible\")},haveTarget:function(){return this.options.target!=null&&this.options.target.length>0},targetWidth:function(){var _ref;return(_ref=$(this.options.target))!=null?_ref.outerWidth():void 0},renderDim:function(){var open;open=this.countOpen(true);$(\".header, .app, .footer\").removeClass(\"dim\");$(\".modal-container\").removeClass(\"dim\").addClass(\"dim\");return $(\".modal-container\").last().removeClass(\"dim\")},countOpen:function(withDim){var search;if(withDim==null)withDim=false;search=\"body .modal-layer\";if(withDim)search+=\".with-dim\";return $(search).length},click:function(e){if(e!=null&&$(e.target).hasClass(\"modal-container\")){return this.close()}if(e!=null&&$(e.target).hasClass(\"modal-layer\"))return this.close()},close:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if(!this.isOpen())return;this.setMode(\"not\",\"open\");if((_ref=this.options)!=null){if(typeof _ref.close===\"function\")_ref.close()}this.remove();return this.renderDim()},isOpen:function(){return this.hasMode(\"is\",\"open\")},detach:function(){return this.$el.detach()},attach:function(){this.$el.appendTo($(\"body\"));return this.renderDim()},shortenToFit:function($el,i){var height;if(i==null)i=0;if(!($el!=null))$el=this.$(\".modal\").children().first();if(z.useful.elClippedByScreenBottom($el[0])&&i<50){height=$el.outerHeight();$el.css(\"height\",height-10);return this.shortenToFit($el,i+1)}}});z.ui.SelectModal=z.ui.Base.extend({className:\"select with-hover\",events:{\"click [data-key]\":\"click\",\"click a\":\"close\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){return _this.$el.off(\"mousewheel DOMMouseScroll\")})},context:function(){var context;context={choices:this.options.choices};return context},render:function(){var context;context=this.context();this.$el.html(JST.common_select_modal(context));z.useful.noBGScroll(this.$el);return this},click:function(e){var key,value;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();key=$(e.currentTarget).attr(\"data-key\");value=$(e.currentTarget).attr(\"data-value\");this.options.choose(key,value);return this.modal.close()},close:function(e){if(e!=null)e.preventDefault();return this.modal.close()}});z.ui.SinceYouBeenGoneModal=z.ui.Base.extend({className:\"since-you-been-gone\",initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.updates=this.options.model;return this.on(\"remove\",function(){return z.useful.noBGScrollOff(_this.modal.$el.find(\"div.modal\"))})},context:function(){var context;context={};context.updates=this.updates;return context},render:function(){this.$el.html(JST.common_since_you_been_gone_modal(this.context()));z.useful.noBGScroll(this.modal.$el.find(\"div.modal\"));return this},close:function(e){return this.modal.close()}});z.ui.ConfirmModal=z.ui.Base.extend({className:\"confirm\",events:{\"click .yes\":\"clickYes\",\"click .no\":\"clickNo\"},initialize:function(options){var _this=this;this.options=options;if(!(options.message!=null)&&!(options.jst!=null)){throw\"message or JST required\"}_.bindAll(this);$(document).on(\"keyup\",this.keyup);return this.on(\"remove\",function(){return $(document).off(\"keyup\",_this.keyup)})},context:function(){return{message:this.options.message}},render:function(){if(this.options.jst!=null){this.$el.html(this.options.jst())}else{this.$el.html(JST.common_confirm_modal(this.context()))}return this},clickYes:function(e){var _ref;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.yes)!=null?_ref.call(this):void 0},clickNo:function(e){var _ref;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.no)!=null?_ref.call(this):void 0},keyup:function(e){if(e.keyCode!=null&&e.keyCode===13)return this.clickYes()}});z.ui.AuthCreateModal=z.ui.Base.extend({className:\"new-auth\",events:{\"click .send-confirmation\":\"confirmation\",\"click .submit\":\"submit\",\"submit form\":\"submit\"},initialize:function(options){var _this=this;this.options=options;if(!(options.service!=null))throw\"service required\";_.bindAll(this);_.defaults(this,options);this.setMode(\"disable\",\"submit\");this.form=new z.model.FormSet(this.service.getUpfronts());this.setDefaultTitle();this.form.on(\"change:valid\",this.renderSubmit,this);this.on(\"remove\",function(){_this.stopPoll();return _this.paramform.remove()});this.oauthId=_.random(1e6,9999999);return z.oauth=function(url){var data,_ref;if(!_this.form.isValid())return;if(_this.hasMode(\"disable\",\"submit\"))return;if(!((_ref=_this.service.get(\"meta\"))!=null?_ref.oauth:void 0)){return}data=_this.form.getValues();data[\"id\"]=_this.oauthId;url=url+\"?\"+$.param(data);return z.useful.open(url,true,\"New Auth\")}},setDefaultTitle:function(){var name,row,service;row=this.form.get(\"title\");name=z.app.account.get(\"partner_email\")||z.app.account.get(\"email\");service=this.options.service.getName();return row.set({value:\"\"+name+\"'s \"+service+\" account\"})},context:function(){var context,url,_ref,_ref2;url=(_ref=this.service.get(\"meta\"))!=null?_ref.oauth_302_url:void 0;context={onclick:\"z.oauth('\"+url+\"');\",serviceHelpQueryString:$.param({q:\"How To Get Started with \"+((_ref2=this.service)!=null?_ref2.getName():void 0)})};return context},render:function(){this.$el.html(JST.common_auth_create_modal(this.context()));this.$paramform=this.$(\"paramform\");this.renderForm();this.renderSubmit();return this},renderForm:function(){this.paramform=new z.ui.ParamForm({form:this.form,prettypills:true});return this.$paramform.html(this.paramform.render().el)},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},confirmation:function(e){var data,error,key,row,s200,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"confirm\"))return;key=$(e.target).attr(\"data-id\");row=this.form.find(function(row){return row.get(\"key\")===key});row.set({sentConfirmation:true});s200=function(){_this.setMode(\"enable\",\"confirm\");return _this.confirmationButtonToText(key)};error=function(){_this.setMode(\"enable\",\"confirm\");return _this.$(\".send-confirmation\").text(\"Error sending PIN\")};this.filtered=this.form.filter(function(row){if(row.get(\"type\")===\"confirmation\")return false;return true});this.filtered=new z.model.FormSet(this.filtered);data=this.filtered.getValues();data.selected_api=this.service.get(\"key\");this.setMode(\"disable\",\"confirm\");this.$(\".feedback\").removeClass(\"error hide\").addClass(\"hide\");$(\".send-confirmation\").text(\"Sending PIN...\");return z.app.auths.create(data,{s200:s200,error:error})},confirmationButtonToText:function(key){this.$(\".input-confirmation\").removeClass(\"hide\");return this.$(\".send-confirmation\").removeClass(\"hide\").addClass(\"hide\")},confirmationTextToButton:function(){this.$(\".input-confirmation\").removeClass(\"hide\").addClass(\"hide\");return this.$(\".send-confirmation\").removeClass(\"hide\")},submit:function(e){var auth,authError,data,errorAdding,foundNewAuth,oauthError,oauthSuccess,successAdding,_ref,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");authError=function(message){var context,modal;context={service:_this.service,message:message,type:\"automatic\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context),force:true})};foundNewAuth=function(auth){var id,testError,testSuccess;id=auth.id;_this.$(\".feedback\").removeClass(\"hide\").text(\"Testing for problems...\");testSuccess=function(){var _base;z.app.auths.add(auth);if(typeof(_base=_this.options).success===\"function\"){_base.success(auth)}return _this.modal.close()};testError=function(model,xhr){_this.setMode(\"enable\",\"submit\");_this.$(\".feedback\").addClass(\"hide\").text(\"\");authError(z.useful.errors(xhr));return auth!=null?auth.destroy():void 0};return auth.test({success:testSuccess,error:testError})};oauthSuccess=function(json){var auth;_this.stopPoll();auth=new z.model.Auth({id:json.auth_id});auth.fetch();return foundNewAuth(auth)};oauthError=function(message){_this.stopPoll();_this.modal.close();return authError(message)};this.startPoll(1e3,360,this.oauthId,{success:oauthSuccess,error:oauthError});if((_ref=this.service.get(\"meta\"))!=null?_ref.oauth:void 0){return this.$(\".feedback\").removeClass(\"hide\").text(\"Looking for new Account...\")}else{successAdding=function(model,resp){_this.stopPoll();z.app.auths.add(model);return foundNewAuth(model)};errorAdding=function(model,xhr){var errors;_this.stopPoll();_this.setMode(\"enable\",\"submit\");errors=z.useful.errors(xhr);if(_.str.include(errors,\"Confirmation code did not match.\")){_this.$(\".send-confirmation\").text(\"Send PIN again\");_this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(\"Confirmation PIN did not match. Try again.\");return _this.confirmationTextToButton()}};data=this.form.getValues();data[\"selected_api\"]=this.service.get(\"key\");this.$(\".feedback\").removeClass(\"hide\").text(\"Working...\");return auth=new z.model.Auth(data).save({},{success:successAdding,error:errorAdding})}},startPoll:function(interval,maxiter,oauthId,options){return this.poll=z.app.auths.pollForNewAuth(1e3,360,this.oauthId,options)},stopPoll:function(){return clearInterval(this.poll)}});z.ui.CreateCollectionModal=z.ui.Base.extend({className:\"create-collection\",events:{\"click .save\":\"submit\",\"submit .name\":\"submit\"},initialize:function(options){var paginatedRecipes;this.options=options;_.bindAll(this);paginatedRecipes=new z.model.RecipeSet([],{pagination:{page:1,perPage:3},filters:{userid:z.app.account.id,status:\"all\"}});paginatedRecipes.fetch();options={recipes:paginatedRecipes};this.embedView=new z.ui.EmbededZaps({embed:z.app.embed});return this.sharedZapsView=new z.ui.EmbedSharedZaps(options)},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.common_create_collection_modal(this.context()));this.$shared=this.$(\".results\");this.$embed=this.$(\".embed\");this.$shared.html(this.sharedZapsView.render().el);this.$embed.html(this.embedView.render().el);return this},submit:function(e){if(e!=null)e.preventDefault();this.options.save(this.$el.find(\"input\").val());\nreturn this.modal.close()}});z.ui.UnpauseErrorModal=z.ui.Base.extend({className:\"raw-error\",initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;return context={message:this.options.message}},render:function(){this.$el.html(JST.common_unpause_error_modal(this.context()));return this}});z.ui.ServicePickerModal=z.ui.Base.extend({className:\"service-picker services\",PER_PAGE:21,SCROLL_TARGET:\".selector\",events:{\"click .reset\":\"reset\",\"keyup .search\":\"search\",\"click .selector .panel\":\"select\",\"mousedown .scroll\":\"beginManualScroll\"},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.setMode(\"cannot\",\"reset\");return this.on(\"remove\",function(){_this.$el.off(\"mousewheel DOMMouseScroll\");return _this.$(\".selector\").off()},this)},context:function(){var context;context={search:this.state.get(\"search\")};return context},render:function(){this.$el.html(JST.common_service_picker_modal(this.context()));this.renderSelector();this.renderModes();this.$(this.SCROLL_TARGET).on(\"scroll\",this.scroll);z.useful.noBGScroll(this.$(\"ul.selector\"));return this},renderSelector:function(){var html,search,services,_this=this;search=this.getSearch().toLowerCase().replace(\" \",\"\");html=\"\";services=z.app.services.filter(function(service){var key,name;name=z.useful.squish(service.getName().toLowerCase());key=service.get(\"key\");if(!_.str.include(name,search))return false;return true});_.each(services,function(service){var context,key;key=service.get(\"key\");context={name:service.getName(),service:key,selected:false};return html+=JST.common_service_panel(context)});this.$(\".selector\").html(html);this.renderSelected();return _.defer(function(){return _this.renderScroll()})},renderSelected:function(){var _this=this;this.$(\".selected\").removeClass(\"selected\");return _.defer(function(){return _this.$(\".selector\").scrollTop(_this.state.get(\"scroll\"))})},renderModes:function(){var _ref;if(((_ref=this.getSearch())!=null?_ref.length:void 0)>0){return this.setMode(\"can\",\"reset\")}else{return this.setMode(\"cannot\",\"reset\")}},rerenderSelector:function(){this.renderSelector();return this.renderModes()},search:function(e){var _ref;if(e.keyCode!=null&&e.keyCode===13){if((_ref=this.$(\".selector .panel\").first())!=null){_ref.trigger(\"click\")}}this.state.set(\"search\",this.getSearch());this.rerenderSelector();return this.resetScroll()},reset:function(e){if(e!=null)e.preventDefault();this.$(\".search\").val(\"\");this.state.set(\"search\",\"\");this.rerenderSelector();return this.resetScroll()},getSearch:function(){return this.$(\".search\").val()},select:function(e){var key;if(e!=null)e.preventDefault();key=this.$(e.currentTarget).attr(\"id\");this.options.choose(key);return this.modal.close()},scroll:function(e){var barHeight,contentHeight,max,percent,pos,visualHeight;pos=this.$(this.SCROLL_TARGET).scrollTop();contentHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;visualHeight=this.$(this.SCROLL_TARGET).innerHeight();percent=pos/(contentHeight-visualHeight);barHeight=this.$(\".scroll\").innerHeight();max=visualHeight-barHeight;pos=Math.round(max*percent);this.$(\".scroll\").css(\"top\",pos+\"px\");if(e!=null){return this.state.set(\"scroll\",this.$(this.SCROLL_TARGET).scrollTop())}},renderScroll:function(){var height,percent,scrollHeight;height=this.$(this.SCROLL_TARGET).innerHeight();scrollHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;percent=height/scrollHeight;this.$(\".scroll\").css(\"height\",Math.round(height*percent)+\"px\");return this.scroll()},resetScroll:function(){this.$(\".scroll\").css(\"top\",\"0px\");return this.state.set(\"scroll\",this.$(this.SCROLL_TARGET).scrollTop())},beginManualScroll:function(e){if(e!=null)e.preventDefault();this.manualScroll=true;this.setMode(\"manual\",\"scroll\");this.scrollOffset=e.pageY-this.$(\".scroll\").offset().top;$(window).on(\"mouseup\",this.endManualScroll);return $(window).on(\"mousemove\",this.updateManualScroll)},updateManualScroll:function(e){var height,percent,rawPos,scrollHeight,top,y;if(!(e!=null))return;y=e.pageY-this.scrollOffset;top=this.$(this.SCROLL_TARGET).offset().top;height=this.$(this.SCROLL_TARGET).innerHeight();scrollHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;percent=(y-top)/height;rawPos=Math.round(scrollHeight*percent);return this.$(this.SCROLL_TARGET).scrollTop(rawPos)},endManualScroll:function(e){if(e!=null)e.preventDefault();this.setMode(\"no\",\"scroll\");$(window).off(\"mouseup\",this.endManualScroll);return $(window).off(\"mousemove\",this.updateManualScroll)}});z.ui.RunZap=z.ui.Base.extend({className:\"run-zap\",initialize:function(options){var _this=this;this.options=options;if(!(options.read!=null))throw\"read required\";_.bindAll(this);this.messages=[];this.on(\"remove\",function(){return clearInterval(_this.interval)});return this.run()},context:function(){var context;context={title:this.options.read.getTitle(),messages:this.messages,noItemsFound:this.noItemsFound};return context},render:function(){this.$el.html(JST.common_run_zap_modal(this.context()));return this},run:function(){var success,_this=this;this.noItemsFound=false;success=function(){_this.interval=setInterval(_this.status,1e3);return _.delay(function(){return clearInterval(_this.interval)},3e4)};return this.options.read.run({success:success})},status:function(){var complete,_this=this;complete=function(model,resp){_this.messages=resp.messages;_.each(_this.messages,function(message){if(_.str.include(message,\"Found 0\"))_this.noItemsFound=true;if(_.str.include(message,\"failed:\"))clearInterval(_this.interval);if(_.str.include(message,\"success:\")){return clearInterval(_this.interval)}});return _this.render()};return this.options.read.runStatus({success:complete,error:complete})}});z.ui.LoginModal=z.ui.Base.extend({className:\"login\",events:{\"click a\":\"close\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){return _this.$(\"form\").addClass(\"hide\").appendTo($(\"body\"))})},context:function(){},render:function(){var $el;$el=$(\"#login-form\");if(($el!=null?$el.length:void 0)>0){this.$el.html($el.removeClass(\"hide\"))}else{this.$el.html(JST.common_login_modal(this.context()))}z.useful.placeholders(this.$el);return this},close:function(e){return this.modal.close()}});z.ui.ParamForm=z.ui.Base.extend({className:\"paramform\",initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.views=[];this.options.form.on(\"add\",this.insertAdd);return this.on(\"remove\",function(){return _.each(_this.views,function(view){return view.remove()})},this)},render:function(){var _this=this;this.$el.empty();this.options.form.each(function(row){var view;view=new z.ui.ParamFormRow({model:row,form:_this.options.form,options:_this.options});_this.views.push(view);return _this.$el.append(view.render().el)});return this},insertAdd:function(model){var index,view;index=this.options.form.indexOf(model);view=new z.ui.ParamFormRow({model:model,form:this.options.form,options:this.options});this.views.push(view);return this.$(\".field\").eq(index-1).after(view.render().el)},refreshPrettypills:function(){var _this=this;return _.each(this.views,function(view){var _ref;if(view!=null)if((_ref=view.prettypill)!=null)_ref.refresh();return view!=null?view.prettypillHeight():void 0})}});z.ui.DeveloperAppParamForm=z.ui.ParamForm.extend({clearErrors:function(){this.$(\".field .errorlist\").empty().hide();return this.$el.parent().find(\".paramform > ul.errorlist\").empty().hide()},renderErrors:function(errors){var feedback,_this=this;this.clearErrors();_.each(errors,function(fieldErrors,fieldKey){var feedback,field;field=_this.$(\".field.field-\"+_.slugify(fieldKey));if(field.find(\".errorlist\").length>0){feedback=field.find(\".errorlist\").show()}else{feedback=$('<ul class=\"errorlist\"/>').appendTo(field)}return _.each(fieldErrors,function(error){return feedback.append($(\"<li/>\").html(error))})});if(errors!=null?errors.general:void 0){if(this.$el.parent().find(\".paramform > ul.errorlist\").length>0){feedback=this.$el.parent().find(\".paramform > ul.errorlist\").show()}else{feedback=$('<ul class=\"errorlist\"/>').appendTo(this.$el)}_.each(errors.general,function(error){return feedback.append($(\"<li/>\").html(error))})}}});var __indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};z.ui.ParamFormRow=z.ui.Base.extend({events:{\"change [data-input]\":\"hardChange\",\"input [data-input]\":\"softChange\",\"mousedown [data-input]\":\"fillButton\",\"mousedown .fill-button\":\"fillButton\",\"mousedown .add-placeholder\":\"addPlaceholder\",\"click .add\":\"listAdd\",\"click .remove\":\"listRemove\"},className:function(){var key,name,type,_ref,_ref2,_ref3;name=\"field\";if(type=this.model.get(\"type\"))name+=\" \"+type;if(((_ref=this.model)!=null?_ref.get(\"prefill\"):void 0)!=null){name+=\" prefill\"}if(this.model.get(\"choices\")||this.model.get(\"givefill\")){name+=\" selectfill\"}if(((_ref2=this.model)!=null?_ref2.get(\"list\"):void 0)!=null){name+=\" list\"}if(((_ref3=this.model)!=null?_ref3.get(\"input_format\"):void 0)!=null){name+=\" copy-button-container\"}if(key=_.slugify(this.model.get(\"key\")))name+=\" field-\"+key;return name},initialize:function(options){var clearPrefillCache,clearUserfillCache,_ref,_ref2,_ref3,_ref4,_this=this;this.options=options;_.bindAll(this);this.model=this.options.model;this.model.on(\"remove\",this.remove,this);this.model.state.on(\"change:busy\",this.checkBusy,this);this.model.on(\"change:list change:isChild\",this.renderParentChild,this);this.model.on(\"change:valid\",this.renderValid,this);this.model.on(\"change:value\",this.valueToClipButton,this);this.model.on(\"change:value change:display\",this.set,this);if((_ref=this.options.form)!=null){_ref.on(\"change\",this.renderRule,this)}this.node=(_ref2=this.options.options)!=null?(_ref3=_ref2.userfill)!=null?_ref3.node:void 0:void 0;if(this.node!=null){clearUserfillCache=_.debounce(function(){var _ref4,_ref5,_ref6;return Backbone.cache.clear((_ref4=_this.userfillModal)!=null?(_ref5=_ref4.view)!=null?(_ref6=_ref5.gives)!=null?_ref6.url():void 0:void 0:void 0)},40);this.node.on(\"change:selected_api change:action change:authentication_id\",clearUserfillCache,this)}if((_ref4=this.model)!=null?_ref4.node:void 0){clearPrefillCache=_.debounce(function(){var _ref5,_ref6,_ref7;delete _this.prefillSamples;return Backbone.cache.clear((_ref5=_this.prefillModal)!=null?(_ref6=_ref5.view)!=null?(_ref7=_ref6.samples)!=null?_ref7.url():void 0:void 0:void 0)},40);this.model.node.on(\"change:authentication_id\",clearPrefillCache,this)}return this.on(\"remove\",function(){var _ref5,_ref6,_ref7,_ref8;if((_ref5=_this.userfillModal)!=null)_ref5.close();if((_ref6=_this.prefillModal)!=null)_ref6.close();if((_ref7=_this.selectfillModal)!=null)_ref7.close();return(_ref8=_this.givefillModal)!=null?_ref8.close():void 0},this)},context:function(){var choices,context,_ref;context=_.extend({},this.model.toJSON(),{model:this.model});context.val=this.model.getDisplay();if(_.isArray(context.val)){context.val=context.val.join(\",\")}else if(this.model.get(\"type\")===\"json\"&&context.val!=null&&context.val){context.val=JSON.stringify(context.val,null,4)}else if(this.model.get(\"choices\")){choices=this.model.get(\"choices\");if($.isPlainObject(choices))context.val=choices[context.val]}context.userfill=this.options.options.userfill!=null&&this.model.isUserfill();context.userfillClass=(_ref=this.options.options.userfill)!=null?typeof _ref[\"class\"]===\"function\"?_ref[\"class\"]():void 0:void 0;context.cid=z.app.account.id;context.ccode=z.app.account.get(\"code\");context.givefill=this.model.get(\"givefill\")!=null;return context},template:function(){var type;type=this.model.get(\"type\");if(type===\"select\"){return JST.common_form_select_row(false)}else if(type===\"password\"){return JST.common_form_password_row(false)}else if(type===\"copy\"){return\"<div></div>\"}else if(type===\"text\"||type===\"json\"){return JST.common_form_text_row(false)}else if(type===\"confirmation\"){return JST.common_form_confirmation_row(false)}else if(type===\"file\"){return JST.common_form_file_row(false)}else if(type===\"upload\"){return JST.common_form_upload_row(false)}else if(type===\"prettypills\"){return JST.common_form_unicode_prettypill_row(false)}else if(type===\"unicode\"){return JST.common_form_unicode_row(false)}else if(type===\"checkbox\"){return JST.common_form_checkbox_row(false)}return JST.common_form_unicode_row(false)},render:function(){var context,template,_ref,_ref2,_ref3,_ref4,_this=this;template=this.template();context=this.context();context.row_html=z.useful.render(template,context);this.$el.html(JST.common_form_base_row(context));this.renderValid();this.renderClipboard();this.checkBusy();this.renderParentChild();this.renderRule();_.defer(function(){return _this.prettypills()});if((_ref=this.userfillModal)!=null)_ref.close();if((_ref2=this.prefillModal)!=null)_ref2.close();if((_ref3=this.selectfillModal)!=null)_ref3.close();if((_ref4=this.givefillModal)!=null)_ref4.close();return this},doesRuleApply:function(match,fieldValue,ruleValues){var coerce,_ref;if(!_.isArray(ruleValues))ruleValues=[ruleValues];ruleValues=_.map(ruleValues,function(val){return String(val)});coerce=function(val){return String(val)};if(match===\"iexact\"){coerce=function(val){return String(val).toLowerCase()}}ruleValues=_.map(ruleValues,coerce);return _ref=coerce(fieldValue),__indexOf.call(ruleValues,_ref)>=0},applyRule:function(rule,inverse,actionOverride){var action;if(inverse==null)inverse=false;if(actionOverride==null)actionOverride=null;action=actionOverride||rule.action;if(action===\"hide\"){if(inverse){this.$el.removeClass(\"hide\");return this.options.form.softAdd(this.model)}else{this.$el.addClass(\"hide\");return this.options.form.softRemove(this.model)}}else if(action===\"show\"){return this.applyRule(rule,!inverse,\"hide\")}},renderRule:function(){var rules,values,_this=this;rules=this.model.get(\"rules\")||[];values=this.options.form.getValues();if(!(rules!=null?rules.length:void 0))return;values=this.options.form.getValues();return _.each(rules,function(rule){var shouldApply;shouldApply=_this.doesRuleApply(rule.match,values[rule.key],rule.value);return _this.applyRule(rule,!shouldApply)})},renderValid:function(){var valid;valid=this.model.get(\"valid\");this.$el.removeClass(\"valid invalid\");if(valid!=null&&valid)this.$el.addClass(\"valid\");if(valid!=null&&!valid)return this.$el.addClass(\"invalid\")},renderParentChild:function(){this.$el.removeClass(\"list-child list-parent\");if(this.model.get(\"list\")&&this.model.get(\"parent\")){this.$el.addClass(\"list-child\")}if(this.model.get(\"list\")&&!this.model.get(\"parent\")){return this.$el.addClass(\"list-parent\")}},renderClipboard:function(){var $el,clip;if(this.model.get(\"input_format\")!=null){$el=this.$(\".copy-button\");clip=new z.useful.clipboard($el);return clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)})}},softChange:function(){var data;data=this.get();if((data!=null?data.value:void 0)!=null&&(data!=null?data.value:void 0)!==this.model.getValue()){return this.model.set(data)}if((data!=null?data.display:void 0)!=null&&(data!=null?data.display:void 0)!==this.model.getDisplay()){return this.model.set(data)}},hardChange:function(){var data;data=this.get();return this.model.save(data)},get:function(){var $el,data,key,prefill,type;type=this.model.get(\"type\");prefill=this.model.get(\"prefill\")!=null;$el=this.$(\"[data-input]\");data={};if(prefill){key=this.hasMode(\"not\",\"locked\")?\"value\":\"display\"}else{key=\"value\"}if(type===\"checkbox\"){data[key]=$el.prop(\"checked\")}else if(type===\"json\"){try{data[key]=JSON.parse($el.val())}catch(e){data[key]=$el.val()}}else if(this.prettypill!=null){data[key]=this.prettypill.getValue()}else{data[key]=$el.val()}return data},set:function(val){var $el,choices,data,type,_ref;if(this.model.get(\"list\")&&!(this.model.get(\"parent\")!=null))return;if(!_.isString(val))val=this.model.getDisplay();type=this.model.get(\"type\");$el=this.$(\"[data-input]\");data=this.get();if(val!=null&&((data!=null?data.value:void 0)===val||(data!=null?data.display:void 0)===val)){return}if(type===\"checkbox\"){return $el.prop(\"checked\",val)}else if(this.model.get(\"choices\")){choices=this.model.get(\"choices\");if($.isPlainObject(choices))val=choices[val]}else if(type===\"json\"){if(val!=null){val=JSON.stringify(val,null,4)}else{val=\"\"}}$el.val(val);return(_ref=this.prettypill)!=null?_ref.setValue(val!=null&&!_.isArray(val)?val:\"\"):void 0},focus:function(){var _this=this;if(this.prettypill!=null){return _.defer(function(){return _this.prettypill.editor.focus()})}else{return _.defer(function(){return _this.$(\"[data-input]\").first().focus()})}},blur:function(){var _this=this;if(this.prettypill!=null){return _.defer(function(){return _this.prettypill.editor.getInputField().blur()})}else{return _.defer(function(){return _this.$(\"[data-input]\").first().blur()})}},busy:function(){var _ref;this.blur();this.$el.removeClass(\"busy\").addClass(\"busy\");this.$(\"[data-input]\").prop({disabled:true});this.undelegateEvents();if(this.prettypill!=null){this.undelegatePrettypills();if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",\"nocursor\")}return this.prettypill.container.addClass(\"disabled\")}},notBusy:function(){var _ref;this.$el.removeClass(\"busy\");this.$(\"[data-input]\").prop({disabled:false});this.delegateEvents();if(this.prettypill!=null){this.delegatePrettypills();if(this.hasMode(\"not\",\"locked\")||!(this.model.get(\"prefill\")!=null)&&!(this.model.get(\"choices\")!=null)){if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",false)}}return this.prettypill.container.removeClass(\"disabled\")}},checkBusy:function(){if(!this.model.state.get(\"busy\")){return this.notBusy()}else{return this.busy()}},valueToClipButton:function(){var f,v;f=this.model.get(\"input_format\");if(f!=null){v=\"\";if((f!=null?f[0]:void 0)!=null)v=f[0]+v;v=v+this.model.getValue();if((f!=null?f[2]:void 0)!=null)v=v+f[2];v=_.template(v)({cid:z.app.account.get(\"id\"),ccode:z.app.account.get(\"code\")});return this.$(\"[data-clipboard-text]\").attr(\"data-clipboard-text\",v)}},fillButton:function(e){var _ref,_ref2,_ref3,_ref4;this.focus();if(this.hasMode(\"not\",\"locked\")&&!this.$(e.currentTarget).hasClass(\"fill-button\")){return}if(this.model.get(\"choices\")!=null||this.model.get(\"prefill\")!=null){this.setMode(\"is\",\"locked\");this.$(\"[data-input]\").prop({disabled:true});if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",\"nocursor\")}}if(this.model.get(\"prefill\")!=null){this.prefill(this.model.node,this.model.get(\"prefill\"),this.model.getValue(),this.model.get(\"choices\"))}else if(this.model.get(\"choices\")!=null){this.selectfill(this.model.get(\"choices\"),this.model.getValue())}else if(this.model.get(\"givefill\")){this.givefill((_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?(_ref4=_ref3.givefill)!=null?_ref4.node:void 0:void 0:void 0)}else if(this.options.options.userfill!=null&&this.model.isUserfill()&&this.$(e.currentTarget).hasClass(\"fill-button\")){this.userfill(this.node)}},addPlaceholder:function(e){if(this.options.options.userfill!=null&&this.model.isUserfill()&&this.$(e.currentTarget).hasClass(\"add-placeholder\")){return this.userfill(this.node)}},selectfill:function(choices,current){var $el,customValue,height,pick,placeholderValue,pos,view,x,y,_ref,_ref2,_ref3,_ref4,_this=this;if((_ref=this.selectfillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");if(this.prettypill!=null)$el=this.prettypillTarget();pick=function(pick){return _this.model.save({value:pick[\"key\"],display:null},{wait:true})};customValue=function(){var _ref2;_this.setMode(\"not\",\"locked\");_this.model.set({display:null});_this.$(\"[data-input]\").prop({disabled:false});if((_ref2=_this.prettypill)!=null){_ref2.editor.setOption(\"readOnly\",false)}_this.focus();return _this.prettypill.editor.focus()};placeholderValue=function(){var _ref2;if((_ref2=_this.selectfillModal)!=null)_ref2.close();return _this.userfill(_this.node,{pick:function(picked){var val;val=z.cfg.userfillOTag+picked.key+z.cfg.userfillETag;return _this.model.save({value:val,display:val},{wait:true})}})};view=new z.ui.SelectfillModal({pick:pick,target:$el,choices:choices,current:current,hideRawValue:(_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?_ref3.hideRawValue:void 0:void 0,options:{custom:customValue,placeholder:placeholderValue,fancychoices:(_ref4=this.options.options)!=null?_ref4.fancychoices:void 0}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;return this.selectfillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true})},prefill:function(node,prefill,current,fixedChoices){var $el,customValue,height,loadError,pick,placeholderValue,pos,view,x,y,_ref,_this=this;if((_ref=this.prefillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");if(this.prettypill!=null)$el=this.prettypillTarget();pick=function(pick){var display;display=pick!=null?pick.display:void 0;return _this.model.save({value:pick[\"key\"],display:display},{wait:true,success:function(){return _this.model.trigger(\"prefill\")}})};loadError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};customValue=function(){var _ref2;_this.setMode(\"not\",\"locked\");_this.model.set({display:null});_this.$(\"[data-input]\").prop({disabled:false});if((_ref2=_this.prettypill)!=null){_ref2.editor.setOption(\"readOnly\",false)}_this.focus();return _this.prettypill.editor.focus()};placeholderValue=function(){var _ref2;if((_ref2=_this.prefillModal)!=null)_ref2.close();return _this.userfill(_this.node,{pick:function(picked){var val;val=z.cfg.userfillOTag+picked.key+z.cfg.userfillETag;return _this.model.save({value:val,display:val},{wait:true})}})};if(!(this.prefillSamples!=null)){this.prefillSamples=new z.model.SampleSet([],{node:node,action:node.get(\"action\")})}view=new z.ui.PrefillModal({pick:pick,target:$el,node:node,samples:this.prefillSamples,formRow:this.model,prefill:prefill,current:current,fixedChoices:fixedChoices,options:{error:loadError,custom:customValue,placeholder:placeholderValue}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;this.prefillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true});return view.loadChoices()},userfill:function(node,options){var $el,eTag,elPos,fieldsError,fieldsLoaded,fieldsMissing,left,oTag,pick,pos,top,view,x,y,_ref,_this=this;z.store.set(\"userfill-click\",true);if((_ref=this.userfillModal)!=null?_ref.isOpen():void 0)return;if(!(this.prettypill!=null))return;$el=this.prettypillTarget();elPos=$el.offset();pos=(options!=null?options.coords:void 0)?options.coords:this.prettypill.getCursorCoords();left=(pos!=null?pos.left:void 0)-(elPos!=null?elPos.left:void 0);top=(pos!=null?pos.top:void 0)-(elPos!=null?elPos.top:void 0);x=left;y=top;if(!(x!=null)||x<5)x=5;if(!(y!=null)||y<25)y=25;x+=1;y+=12;oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;pick=function(picked){var key,val;key=picked.key;val=z.cfg.userfillOTag+key+z.cfg.userfillETag;if((options!=null?options.line:void 0)!=null&&(options!=null?options.ch:void 0)!=null&&(options!=null?options.length:void 0)!=null){_this.prettypill.replaceText(val,{line:options.line,ch:options.ch},options.length)}else{_this.prettypill.insertText(val)}return options!=null?typeof options.pick===\"function\"?options.pick(picked):void 0:void 0};fieldsMissing=function(){var view;_this.blur();view=new z.ui.MissingDataModal({success:function(){Backbone.cache.clear(_this.userfillModal.view.gives.url());return _this.userfill(node,options!=null?options.text:void 0)}});return _this.missingDataModal=new z.ui.Modal({view:view})};fieldsError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};fieldsLoaded=function(model,json){var fieldmap,meta,_ref2;fieldmap=model.exportMeta();if((_ref2=_this.prettypill)!=null){_ref2.setOption(\"replacements\",_.extend({},fieldmap,_this.prettyReplacements()))}if(_this.node!=null){meta=_this.node.get(\"meta\")||{};meta[\"fieldmap\"]=fieldmap;return _this.node.save({meta:meta},{loose:false})}};view=new z.ui.UserfillModal({pick:pick,target:$el,node:node,current:options!=null?options.textcurrent:void 0,options:{missing:fieldsMissing,error:fieldsError,success:fieldsLoaded}});if(x>$el.outerWidth())x=$el.outerWidth();if(y>$el.outerHeight())y=$el.outerHeight();this.userfillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true,close:function(){_this.removeEmptyUserfillTags;return _this.prettypill.clearActivePills()}});return view.loadChoices()},givefill:function(node){var $el,fieldsError,fieldsMissing,height,pick,pos,view,x,y,_ref,_ref2,_ref3,_this=this;if((_ref=this.givefillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");pick=function(pick){return _this.model.save({value:pick[\"key\"],display:null},{wait:true})};fieldsMissing=function(){var view;_this.blur();view=new z.ui.MissingDataModal({success:function(){var _ref2;if((_ref2=_this.missingDataModal)!=null)_ref2.close();Backbone.cache.clear(_this.givefillModal.view.gives.url());return _this.givefill(node)}});return _this.missingDataModal=new z.ui.Modal({view:view})};fieldsError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};view=new z.ui.GivefillModal({pick:pick,target:$el,givefill:true,node:node,hideRawValue:(_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?_ref3.hideRawValue:void 0:void 0,options:{missing:fieldsMissing,error:fieldsError}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;this.givefillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false});return view.loadChoices()},removeEmptyUserfillTags:function(){var $el,eTag,newVal,oTag,tags,val;$el=this.$(\"[data-input]\");oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;tags=oTag+eTag;if(!(tags!=null))return;val=$el.val();newVal=val.replace(new RegExp(tags,\"gm\"),\"\");if(val!==newVal){this.set(newVal);return $el.trigger(\"change\")}},listAdd:function(e){var collection;if(e!=null)e.preventDefault();collection=this.model.collection;collection.listAdd(this.model.get(\"parent\"));return collection.save()},listRemove:function(e){var collection;if(e!=null)e.preventDefault();collection=this.model.collection;collection.listRemove(this.model.id,this.model.get(\"parent\"));return collection.save()},prettypills:function(){var _ref;if(!((_ref=this.options.options)!=null?_ref.prettypills:void 0)){return}if(this.prettypill!=null)this.undelegatePrettypills();return this.prettypillsSetup()},prettyReplacements:function(){var humanize,_this=this;humanize=function(match){match=match.replace(/\\{\\{/g,\"\");match=match.replace(/\\}\\}/g,\"\");return _.superHumanize(match)};return{\"{{(?:(?!{{).)+}}\":{replaceWith:function(match){return humanize(match)},allowRegex:true}}},prettypillsSetup:function(){var classes,input,replacements,saved,tag,type,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_this=this;input=this.$(\"[data-input]\");tag=(_ref=input[0])!=null?_ref.nodeName.toLowerCase():void 0;type=this.model.get(\"type\");if((tag===\"input\"||tag===\"textarea\")&&type!==\"password\"){saved=(_ref2=this.node)!=null?(_ref3=_ref2.get(\"meta\"))!=null?_ref3.fieldmap:void 0:void 0;replacements=_.extend({},saved,this.prettyReplacements());this.prettypill=new PrettyPills(input[0],{showPills:true,replacements:replacements,mode:null,extraKeys:{Tab:false,\"Shift-Tab\":false}});classes=this.prettypill.container.attr(\"class\")+\" \";classes+=input.attr(\"class\");this.prettypill.container.attr(\"class\",classes);this.minInputHeight=type===\"text\"?\"100\":\"26\";this.prettypillHeight();this.delegatePrettypills();if(((_ref4=this.model)!=null?_ref4.get(\"choices\"):void 0)!=null||((_ref5=this.model)!=null?_ref5.get(\"prefill\"):void 0)!=null){this.setMode(\"is\",\"locked\");this.$(\"[data-input]\").prop({disabled:true});if((_ref6=this.prettypill)!=null){_ref6.editor.setOption(\"readOnly\",\"nocursor\")}}if(type!==\"text\"){return(_ref7=this.prettypill)!=null?_ref7.editor.addKeyMap({Enter:function(cm){return false}}):void 0}}},delegatePrettypills:function(){if(!(this.prettypill!=null))return;this.prettypill.on(\"input\",this.softChange);this.prettypill.on(\"input\",this.prettypillHeight);this.prettypill.on(\"change\",this.hardChange);this.prettypill.on(\"mousedown\",this.fillButton);this.prettypill.on(\"pillenter\",this.prettypillEnter);return this.prettypill.on(\"pillleave\",this.prettypillLeave)},undelegatePrettypills:function(){if(!(this.prettypill!=null))return;this.prettypill.off(\"input\",this.softChange);this.prettypill.off(\"input\",this.prettypillHeight);this.prettypill.off(\"change\",this.hardChange);this.prettypill.off(\"mousedown\",this.fillButton);this.prettypill.off(\"pillenter\",this.prettypillEnter);return this.prettypill.off(\"pillleave\",this.prettypillLeave)},prettypillTarget:function(){if(!(this.prettypill!=null))return;return this.$(this.prettypill.container)},prettypillEnter:function(e,options){var length,text,_ref;if((_ref=this.userfillModal)!=null?_ref.isOpen():void 0)return;text=options!=null?options.text:void 0;length=text.length;text=text.replace(z.cfg.userfillOTag,\"\");text=text.replace(z.cfg.userfillETag,\"\");return this.userfill(this.options.options.userfill.node,{text:text,line:options.line,ch:options.ch,length:length,coords:options.coords})},prettypillLeave:function(){var _ref;return(_ref=this.userfillModal)!=null?_ref.close():void 0},prettypillHeight:function(){if(!(this.prettypill!=null)){}}});z.ui.Preloader=z.ui.Base.extend({events:{\"click .retry button\":\"retry\"},initialize:function(options){var _this=this;_.bindAll(this);this.loading=false;this.fakeFirst=true;$(document).ajaxSend(function(){return _this.total+=1});return $(document).ajaxComplete(function(){_this.complete+=1;if(_this.fakeFirst&&_this.complete===1)return _this.complete+=1})},start:function(hardTotal){var _this=this;if(this.loading)return;this.loading=true;this.hardTotal=hardTotal;this.total=0;this.complete=0;this.percent=0;this.interval=setInterval(function(){return _this.renderProgress()},25);this.delay=_.delay(function(){return _this.timeout()},15e3);return this.render()},active:function(){return $.ajax.active},isLoading:function(){return this.loading},render:function(){this.$el.html(JST.preloader({}));this.renderProgress();return this},renderProgress:function(){var percent,total;total=this.hardTotal||this.total;percent=Math.ceil(this.complete/total*100)||0;if(percent>100)percent=100;if(this.percent===percent)return;this.percent=percent;$(\".preloader .progress\").animate({width:percent+\"%\"},200);return this},timeout:function(){this.setMode(\"is\",\"timeout\");clearInterval(this.interval);return clearTimeout(this.delay)},retry:function(e){if(e!=null)e.preventDefault();return z.app.viewport.refresh()},done:function(cb){clearInterval(this.interval);clearTimeout(this.delay);this.loading=false;this.approxTotal=null;return typeof cb===\"function\"?cb():void 0}});z.ui.Viewport=z.ui.Base.extend({events:{click:\"clickAnywhere\",\"click [data-nav]\":\"click\",\"click [data-contact-support]\":\"contactSupport\",'click [href=\"/support/\"]':\"contactSupport\",'click [href=\"mailto:contact@zapier.com\"]':\"contactSupport\",\"click .menu-login\":\"login\",\"click .menu-account\":\"menu\",\"click .links-container\":\"navMenu\"},initialize:function(options){Backbone.cache.on(\"syncing\",this.showSyncing,this);Backbone.cache.on(\"synced\",this.hideSyncing,this);return z.app.clicks=[]},clickAnywhere:function(e){var name;name=$(e.currentTarget).attr(\"data-record-click\");if(name){z.app.track[\"new\"](\"Click\",{name:name})}z.app.clicks.unshift(e);z.app.clicks=z.app.clicks.slice(0,10);return z.app.trigger(\"click\",e)},click:function(e){if(!$(e.target).attr(\"data-nav\")&&!$(e.currentTarget).attr(\"data-nav\")){return\n}if(z.app.preloader.isLoading())return;if(e!=null)e.preventDefault();if((typeof window.onbeforeunload===\"function\"?window.onbeforeunload():void 0)!=null){if(confirm(window.onbeforeunload()))return this.doNav(e)}else{return this.doNav(e)}},doNav:function(e){var target;target=$(e.target).attr(\"data-nav\")||$(e.currentTarget).attr(\"data-nav\");if((e!=null?e.ctrlKey:void 0)||(e!=null?e.metaKey:void 0)){return z.useful.open(\"/\"+target,null,null)}else{return Backbone.history.navigate(target,{trigger:true})}},refresh:function(){return Backbone.history.location.reload()},title:function(title){return typeof document!==\"undefined\"&&document!==null?document.title=title+z.cfg.title:void 0},dim:function(){return $(\".app, .header, .footer\").removeClass(\"dim\").addClass(\"dim\")},undim:function(){return $(\".app, .header, .footer\").removeClass(\"dim\")},login:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.loginModal)!=null)_ref.close();this.loginModal=new z.ui.Modal({view:new z.ui.LoginModal,target:this.$(\".menu-login\"),x:-234,y:55,noX:true});return this.$(\".links-container\").removeClass(\"open\")},menu:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();this.menuModal=new z.ui.Modal({view:new z.ui.MenuModal({className:\"main menu with-hover\"}),target:this.$(\".menu-account\"),x:-186,y:55,noX:true});return this.$(\".links-container\").removeClass(\"open\")},navMenu:function(e){return $(e.currentTarget).toggleClass(\"open\")},contactSupport:function(e){var modal;if(e!=null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.ContactModal})},showSyncing:function(){return this.$(\".sync\").removeClass(\"hide\")},hideSyncing:function(){return this.$(\".sync\").addClass(\"hide\")}});z.ui.TopBar=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={text:this.getText()};return context},render:function(){var context;context=this.context();if(context.text!=null){this.$el.removeClass(\"hide\");this.$(\"h1\").html(context.text)}else{this.$el.addClass(\"hide\")}return this},showSyncing:function(){return this.$(\".sync\").removeClass(\"hide\")},hideSyncing:function(){return this.$(\".sync\").addClass(\"hide\")},getText:function(){var active_card,amount,is_trialing,is_unlimited,logo,provider,status,trialDays,_ref,_ref2,_ref3;status=(_ref=z.app.account.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.status:void 0:void 0;is_trialing=z.app.account.get(\"is_trialing\");amount=z.app.account.getCurrentPlanAmount();active_card=(_ref3=z.app.account.get(\"billing\"))!=null?_ref3.active_card:void 0;is_unlimited=z.app.account.get(\"is_unlimited\");provider=z.app.account.get(\"provider\");if(!z.app.account.isLoggedIn()){return null}else if(false){logo=\"<i class='img32 \"+provider.selected_api+\"32x32'></i>\";return\"\"+logo+\" &nbsp; Your Zapier account is sponsored by \"+provider.title+\"! &nbsp; \"+logo+\" &nbsp; <a href='#' data-support-tags='sponsored-account'>Learn more.</a> &nbsp; \"+logo}else if(is_unlimited){return null}else if(is_trialing&&active_card!=null){return null}else if(is_trialing){trialDays=z.app.account.trialDaysLeft();if(trialDays>30){return\"You have \"+trialDays+\" days left in your extended trial.\"}else{return\"You have \"+trialDays+' days left in your trial &mdash; <a href=\"/app/settings/plans\" data-nav=\"app/settings/plans\">Choose the best plan for you</a>.'}}else if(status===\"past_due\"||status===\"unpaid\"){return'We couldn\\'t process your credit card! <a href=\"/app/settings\" data-nav=\"app/settings\">Update your credit card</a> to keep your Zaps running.'}else if(status===\"canceled\"){return'Your plan was canceled because we couldn\\'t process your payment. <a href=\"/app/settings\" data-nav=\"app/settings/plans\">Choose a plan</a> to get your Zaps running again.'}else{return null}}});z.ui.Home=z.ui.Base.extend({events:{\"click .carousel-dots .dot\":\"loadCustomerQuote\",\"click .carousel-nav .next\":\"nextCustomerQuote\",\"click .carousel-nav .previous\":\"previousCustomerQuote\"},initialize:function(){var maxSlideHeight;maxSlideHeight=0;this.$(\".slides .slide\").each(function(){$(this).css(\"display\",\"inline-block\");if($(this).height()>maxSlideHeight){return maxSlideHeight=$(this).height()}});this.$(\".slides\").css(\"height\",maxSlideHeight+\"px\");this.$(\".slides .slide\").css({display:\"none\"});this.$(\".slides .slide\").eq(0).addClass(\"show\");this.totalSlides=this.$(\".slides .slide\").length;return this.currentCarouselSlide=0},showCustomerSlide:function(index){this.$(\".carousel-dots .dot\").removeClass(\"active\");this.$(\".carousel-dots .dot\").eq(index).addClass(\"active\");this.$(\".slides .slide\").removeClass(\"show\");this.$(\".slides .slide\").eq(index).addClass(\"show\");this.currentCarouselSlide=index;return this.$(\".carousel-nav .previous\").removeClass(\"disabled\")},loadCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();index=this.$(e.currentTarget).index();return this.showCustomerSlide(index)},nextCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();if(this.currentCarouselSlide+1>=this.totalSlides){index=0}else{index=this.currentCarouselSlide+1}return this.showCustomerSlide(index)},previousCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).hasClass(\"disabled\"))return false;if(this.currentCarouselSlide===0){index=this.totalSlides-1}else{index=this.currentCarouselSlide-1}return this.showCustomerSlide(index)}});z.ui.ForgotPassword=z.ui.Singleton(z.ui.Base.extend({className:\"simple-page forgot\",events:{\"submit form\":\"submit\",\"click .submit\":\"submit\"},initialize:function(options){_.bindAll(this);this.code=options.code;return this.username=options.username},context:function(){var context;context={username:this.username};return context},render:function(){this.$el.html(JST.forgot_base(this.context()));if(this.code!=null&&this.username!=null){this.$el.append(JST.forgot_password(this.context()))}else{this.$el.append(JST.forgot_email(this.context()))}return this},submit:function(e){if(e!=null)e.preventDefault();if(this.code!=null&&this.username!=null){return this.submitPasswordForm()}else{return this.submitEmailForm()}},submitEmailForm:function(){var email,_this=this;email=this.$(\".email\").val();return z.app.account.sendForgotPasswordEmail(email,{success:function(json){return _this.$(\".feedback\").text(json.success).removeClass(\"hide error\").addClass(\"success\")},error:function(xhr){var errors;errors=z.useful.errors(xhr);_this.$(\".feedback\").text(errors).removeClass(\"hide success\").addClass(\"error\");return _.delay(function(){return _this.$(\".feedback\").addClass(\"hide\")},5e3)}})},submitPasswordForm:function(){var password1,password2,_this=this;password1=this.$(\".password1\").val();password2=this.$(\".password2\").val();return z.app.account.resetPassword(this.username,this.code,password1,password2,{success:function(json){_this.$(\".feedback\").text(json.success).removeClass(\"hide error\").addClass(\"success\");return z.useful.goto(\"/\")},error:function(xhr){var errors;errors=z.useful.errors(xhr);_this.$(\".feedback\").text(errors).removeClass(\"hide success\").addClass(\"error\");return _.delay(function(){return _this.$(\".feedback\").addClass(\"hide\")},3e3)}})}}));z.ui.Login=z.ui.Singleton(z.ui.Base.extend({className:\"simple-page login\",initialize:function(options){var _ref;this.options=options;_.bindAll(this);if(((_ref=z.app.account)!=null?_ref.id:void 0)!=null){return z.useful.goto(\"/app/dashboard\")}},context:function(){var context,_ref,_ref2,_ref3;context={status:this.options.status,querystring:(_ref=this.options)!=null?_ref.querystring:void 0,next:(_ref2=this.options)!=null?(_ref3=_ref2.querystring)!=null?_ref3.next:void 0:void 0};return context},render:function(){this.$el.html(JST.login(this.context()));return this}}));z.ui.Zapbook=z.ui.Base.extend({events:{\"click [data-service-sort]\":\"sortServices\",\"click [data-service-filter]\":\"filterServices\",\"click [data-use-template]\":\"useRecipe\",\"click [data-collect-email]\":\"collectEmail\",\"click [data-recipe-paginate-previous]\":\"prevRecipePage\",\"click [data-recipe-paginate-next]\":\"nextRecipePage\",\"click .start-button\":\"usePlain\"},RECIPES_PER_PAGE:4,initialize:function(options){this.options=options;window.t=this;this.recipePage=0;this.paginateRecipes();this.hashString=new z.useful.QueryString(Backbone.history.location.hash.replace(\"#\",\"\")).object;this.sorterKey=(this.hashString[\"sort\"]||this.sorterKey).replace(/[^-\\w]/g,\"\");this.filterKey=(this.hashString[\"filter\"]||this.filterKey).replace(/[^-\\w]/g,\"\");this.doFilter();return this.doSort()},paginateRecipes:function(){var index,pagination,recipe,recipes,_i,_len;recipes=this.$(\".zaps .zap-mini\");if(recipes){pagination=this.$(\".zaps\").next(\".pagination\");this.totalPages=Math.ceil(recipes.length/this.RECIPES_PER_PAGE)-1;if(this.totalPages>0)pagination.removeClass(\"hide\");this.$(\"[data-recipe-paginate-previous]\").hide();this.$(\"[data-recipe-paginate-next]\").hide();for(_i=0,_len=recipes.length;_i<_len;_i++){recipe=recipes[_i];index=_.indexOf(recipes,recipe)+1;$(recipe).hide();if(this.RECIPES_PER_PAGE*this.recipePage<index&&index<=this.RECIPES_PER_PAGE*this.recipePage+this.RECIPES_PER_PAGE){$(recipe).show()}}if(this.recipePage)this.$(\"[data-recipe-paginate-previous]\").show();if(this.recipePage!==this.totalPages){this.$(\"[data-recipe-paginate-next]\").show()}$(\"[data-recipe-paginate-page]\").text(this.recipePage+1);return $(\"[data-recipe-paginate-totals]\").text(this.totalPages+1)}},prevRecipePage:function(e){if(e!=null)e.preventDefault();if(this.recipePage>0){this.recipePage-=1;return this.paginateRecipes()}},nextRecipePage:function(e){if(e!=null)e.preventDefault();if(this.recipePage<this.totalPages){this.recipePage+=1;return this.paginateRecipes()}},usePlain:function(e){var qs,recipe,s1,s2,_ref,_ref2,_ref3,_ref4;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).attr(\"data-collect-email\")===\"true\")return;s1=this.$(e.currentTarget).attr(\"data-service-one\");s2=this.$(e.currentTarget).attr(\"data-service-two\");recipe=new z.model.Recipe;recipe.set({read_data:{selected_api:s1},write_data:{selected_api:s2},generated:true});if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0};return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}},useRecipe:function(e){var id,recipe,_this=this;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).attr(\"data-collect-email\")===\"true\")return;$(e.currentTarget).addClass(\"disabled\").html('<div class=\"spinning-star\"></div>');id=$(e.currentTarget).attr(\"data-use-template\");recipe=new z.model.Recipe({id:id});return recipe.fetch({success:function(recipe,resp){var qs,_ref,_ref2,_ref3,_ref4;if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={};if(recipe.get(\"generated\")){qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0}}else{qs={recipe_id:recipe.id}}return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}}})},alphabeticalSorter:function(element){var letterScore,letters;letters=$.trim($(element).text()).toLowerCase();letterScore=function(c,i){return Math.abs(c.charCodeAt(0)-122)/Math.pow(26,i)};return _.reduce(_.map(letters,letterScore),function(p,n){return p+n})},popularSorter:function(element){return Number($(element).attr(\"data-popularity\"))+1e3},recentSorter:function(element){return-(Number($(element).attr(\"data-days-age\"))+1e3)},premiumSorter:function(element){return Number($(element).attr(\"data-is-premium\"))*1e3},calcExtraScore:function(element){return{popular:this.popularSorter,alphabetical:this.alphabeticalSorter,recent:this.recentSorter,premium:this.premiumSorter}[this.sorterKey](element)+this.alphabeticalSorter(element)},score:function(element){var score;element=$(element);score=0;if(element.hasClass(\"filtered\"))score+=5e5;score+=this.calcExtraScore(element);return score},doSort:function(){var scored,_this=this;$(\"[data-service-sort]\").removeClass(\"active\");$('[data-service-sort=\"'+this.sorterKey+'\"]').addClass(\"active\");scored=_.sortBy($(\".services-grid .service\"),function(el){return _this.score(el)});return $(\".services-grid\").html(scored.reverse())},doFilter:function(){$(\"[data-service-filter]\").removeClass(\"active\");log('[data-service-filter=\"'+this.filterKey+'\"]');$('[data-service-filter=\"'+this.filterKey+'\"]').addClass(\"active\");$(\".services-grid .service\").addClass(\"opaque\");$(\".services-grid .service\").removeClass(\"filtered\");$(\".services-grid .service-\"+this.filterKey).removeClass(\"opaque\");if(this.filterKey!==\"all\"){return $(\".services-grid .service-\"+this.filterKey).addClass(\"filtered\")}},sorterKey:\"popular\",sortServices:function(e){log(\"******\",e);if(e!=null)e.preventDefault();this.sorterKey=$(e.currentTarget).attr(\"data-service-sort\");this.doFilter();this.doSort();return this.setUrl()},filterKey:\"all\",filterServices:function(e){if(e!=null)e.preventDefault();this.filterKey=$(e.currentTarget).attr(\"data-service-filter\");this.doFilter();this.doSort();return this.setUrl()},setUrl:function(){var url;url=Backbone.history.location.pathname+\"#\"+$.param({sort:this.sorterKey,filter:this.filterKey});return Backbone.history.navigate(url,{replace:true})},collectEmail:function(e){var view;if(e!=null)e.preventDefault();view=new z.ui.CollectEmailModal({s1:this.options.s1,s2:this.options.s2});return this.collectEmailModal=new z.ui.Modal({view:view})}});z.ui.StatusModal=z.ui.Base.extend({html:null,className:\"status-modal\",initialize:function(options){this.options=options;_.bindAll(this);return this.html=options.html},render:function(){this.$el.html(this.html);this.$el.addClass(this.options[\"class\"]);return this}});z.ui.Status=z.ui.Base.extend({events:{\"click td.has-errors\":\"showErrors\"},initialize:function(options){var el;this.options=options;this.loaded=true;_.bindAll(this,\"scolled\");$(document).scroll(_.throttle(this.scolled,100));el=this.$el.find(\"table\");return this.tableHeights=[el.offset().top,el.height()]},scolled:function(e){var tableHeight,tableTop,winLeft,winTop,_ref,_ref2;_ref=this.tableHeights,tableTop=_ref[0],tableHeight=_ref[1];_ref2=z.useful.viewportScroll(),winLeft=_ref2[0],winTop=_ref2[1];if(winTop>tableTop&&tableTop+tableHeight-35>winTop){return this.$el.find(\"table\").addClass(\"fixed-head\")}else{return this.$el.find(\"table\").removeClass(\"fixed-head\")}},showErrors:function(e){return this.modal=new z.ui.Modal({view:new z.ui.StatusModal({html:$(e.currentTarget).find(\".status-modal-html\").html()})})}});z.ui.DeveloperAppCommonForm=z.ui.Base.extend({events:{\"click .save\":\"save\"},form:null,initialize:function(options){this.options=options;_.bindAll(this);z.app.developer.form.on(\"error\",this.saveError);z.app.developer.form.on(\"invalid\",this.saveError);return z.app.developer.form.on(\"saveSuccess\",this.saveSuccess)},save:function(e){if(e!=null)e.preventDefault();z.app.developer.form.save()},saveSuccess:function(){throw\"You should implement your own saveSuccess method\"},saveError:function(form,errors){this.form.renderErrors(errors)}});z.ui.DeveloperAppCommonSummary=z.ui.Base.extend({tagName:\"tr\",className:\"summary-block\",events:{\"click .delete\":\"delete\"},initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.model!=null))throw\"model required\";return this.setMode(\"default\",\"delete\")},attributes:function(){return{\"data-id\":this.options.model.id}},render:function(){if(!z.app.developer.app.isEditable()){this.$el.find(\"a\").removeAttr(\"href\").removeAttr(\"data-nav\").addClass(\"disabled\");this.undelegateEvents()}return this},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.model.destroy({wait:true,success:function(){return _this.$el.animate({opacity:0},350,function(){return _this.remove()})},error:function(model,xhr,options){var errors;errors=z.useful.errors(xhr);return new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}})}});z.ui.DeveloperAppCommonSection=z.ui.Base.extend({className:\"section\",initialize:function(options){this.options=options;return _.bindAll(this)},renderRows:function(models,summaryView){var container;this.$el.find(\".section-content table tbody\").html(\"\");container=this.$el.find(\".section-content table tbody\");return models.each(function(model){var view;view=new summaryView({model:model});return container.append(view.render().el)},this)},render:function(models,summaryView,emptyTemplate){if(models.length>0){this.renderRows(models,summaryView)}else if(emptyTemplate){this.$el.find(\".section-content\").html(emptyTemplate(this.context()))}if(!z.app.developer.app.isEditable()){this.$el.find(\"a\").removeAttr(\"href\").removeAttr(\"data-nav\").addClass(\"disabled\");this.undelegateEvents();this.$el.find(\"div.warning\").hide()}return this}});z.ui.DashboardSearch=z.ui.Base.extend({events:{\"keyup input\":\"search\",\"click .clear\":\"clear\"},initialize:function(options){this.options=options;_.bindAll(this);this.setMode(\"no\",\"text\");this.model=this.options.model;this.initSearch();return this.search=_.debounce(this._search,300)},initSearch:function(){var mode,val;val=z.store.get(\"dashboard-search\");if(val!=null){this.model.set({search:val})}mode=(val!=null?val.length:void 0)>0?\"has\":\"no\";return this.setMode(mode,\"text\")},context:function(){var context;context={readCount:z.app.reads.length,search:this.model.get(\"search\"),selected:this.options.shared?\"shared\":\"dashboard\"};return context},render:function(){this.$el.html(JST.dashboard_search(this.context()));z.useful.placeholders(this.$el);return this},_search:function(){var mode,val;val=this.$(\"input\").val();z.store.set(\"dashboard-search\",val,{expires:0});this.model.set({search:val});mode=(val!=null?val.length:void 0)>0?\"has\":\"no\";return this.setMode(mode,\"text\")},clear:function(e){var val;val=\"\";this.$(\"input\").val(val);z.store.set(\"dashboard-search\",val,{expires:0});this.model.set({search:null});return this.setMode(\"no\",\"text\")}});z.ui.SubscribeBlock=z.ui.Base.extend({className:\"widget subscribe\",events:{\"click .button\":\"subscribe\"},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.dashboard_subscribe(this.context()));return this},subscribe:function(){var _this=this;z.app.account.save({is_subscribed_to_blog:true});return this.$(\".subscribe-info\").fadeOut(\"slow\",function(){return _this.$(\".subscribe-message\").fadeIn(\"fast\")})}});z.ui.LimitsBlock=z.ui.Base.extend({className:\"widget limits\",initialize:function(){z.app.reads.on(\"change:paused add remove destroy\",this.refresh,this);z.app.accountLimits.on(\"change\",this.rerender,this);return this.debounceRender=_.debounce(this.render,1e3)},context:function(){var context;context={};context.limits=z.app.accountLimits.toJSON();return context},render:function(){this.$el.html(JST.dashboard_limits(this.context()));return this},rerender:function(){var limits,_this=this;limits=z.app.accountLimits.toJSON().allotment;return _.each(limits,function(limit){var name;name=_.slugify(limit.name);_this.$(\"#\"+name+\" .bar\").css(\"width\",limit.percent+\"%\");return _this.debounceRender()})},refresh:function(){var _this=this;return _.defer(function(){return z.app.accountLimits.fetch({cache:false})})}});z.ui.LogsBlock=z.ui.Base.extend({className:\"widget activities\",initialize:function(){_.bindAll(this);return z.app.stream.on(\"add remove reset\",this.render,this)},context:function(){var context,logs,_this=this;context={};logs=z.app.stream.filter(function(item){var _ref;return((_ref=item.get(\"data\"))!=null?_ref.status:void 0)!==\"halted\"});context.logs=logs.map(function(item){var l;l=item.toJSON();l.title=item.getTitle();return l});return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_logs(context));return this}});z.ui.PartnerText=z.ui.Base.extend({events:{\"click a\":\"next\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,readService,writeService,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;readService=z.app.services.get((_ref=z.app.recipes)!=null?_ref.at(0).get(\"read_data\")[\"selected_api\"]:void 0);writeService=z.app.services.get((_ref2=z.app.recipes)!=null?_ref2.at(0).get(\"write_data\")[\"selected_api\"]:void 0);context={recipes:(_ref3=z.app.recipes)!=null?_ref3.toJSON():void 0,service:z.app.services.get((_ref4=z.app.partner.get(\"zap\"))!=null?_ref4.selected_api:void 0).getName(),readService:(_ref5=z.app.recipes)!=null?_ref5.at(0).get(\"read_service_selected_api\"):void 0,writeService:(_ref6=z.app.recipes)!=null?_ref6.at(0).get(\"write_service_selected_api\"):void 0,readAction:readService.getActionName((_ref7=z.app.recipes)!=null?_ref7.at(0).get(\"read_data\")[\"action\"]:void 0,\"read\"),writeAction:writeService.getActionName((_ref8=z.app.recipes)!=null?_ref8.at(0).get(\"write_data\")[\"action\"]:void 0,\"write\")};return context},render:function(){this.$el.html(JST.dashboard_partner_text(this.context()));return this},next:function(e){var next,step;if(e!=null)e.preventDefault();step=this.$(e.currentTarget).closest(\"div.step\");next=step.next(\"div.step\");step.removeClass(\"hide\").addClass(\"hide\");return next.removeClass(\"hide\")}});z.ui.SharedZap=z.ui.Base.extend({tagName:\"div\",className:\"zap-mini dashboard\",events:{\"click .open-menu\":\"menu\",click:\"permalink\"},attributes:function(){var _ref;return{\"data-shared-id\":(_ref=this.options.recipe)!=null?_ref.id:void 0}},initialize:function(options){var render;this.options=options;_.bindAll(this);_.defaults(this,this.options);this.recipe.on(\"change:description\",this.render);return render=_.debounce(this.render,40)},context:function(){var context,readService,writeService;readService=z.app.services.get(this.recipe.get(\"read_service_selected_api\"));writeService=z.app.services.get(this.recipe.get(\"write_service_selected_api\"));context={title:this.recipe.get(\"title\"),description:this.recipe.get(\"description\"),cssReadClass:readService.getImageClass(),cssWriteClass:writeService.getImageClass()};return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_shared_zap(context));return this},menu:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.SharedZapMenu({recipe:this.recipe}),target:this.$(\".open-menu\"),x:-215,y:48,noX:true})},permalink:function(e){var $elX,menuX,x,_ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();$elX=this.$el.offset().left;x=e.pageX-$elX;menuX=this.$(\".open-menu\").offset().left-$elX;if(x<menuX){return z.useful.goto(this.options.recipe.get(\"url\"))}else{return this.menu(e)}}});z.ui.SharedZapMenu=z.ui.Base.extend({className:\"zap-menu-modal menu with-hover\",events:{\"click .rename\":\"rename\",\"click .permalink\":\"permalink\",\"click .delete\":\"delete\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.dashboard_shared_zap_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.$el.animate({opacity:0},350,function(){_this.close();return _this.options.recipe.destroy()})},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.options.recipe.save({description:value})};console.log(save);modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.options.recipe.get(\"description\"),save:save})});return this.close()},permalink:function(e){if(e!=null)e.preventDefault();z.useful.goto(this.options.recipe.get(\"url\"));return this.close()}});z.ui.Zaps=z.ui.Base.extend({initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,this.options);z.app.reads.on(\"remove\",this[\"delete\"],this);z.app.reads.on(\"add\",this.add,this);z.app.writes.on(\"add\",this.add,this);z.app.reads.on(\"change:paused\",this.move,this);this.views=[];return this.options.search.on(\"change:search\",this.renderSearch,this)},live:function(read){return read.isLive()},paused:function(read){return!read.isLive()&&read.isComplete()},unfinished:function(read){return!read.isComplete()},setEmptyModes:function(){this.setMode(!z.app.reads.any(this.live),\"live-empty\");this.setMode(!z.app.reads.any(this.paused),\"paused-empty\");return this.setMode(!z.app.reads.any(this.unfinished),\"unfinished-empty\")},context:function(){var context;context={isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var renderSearch,_this=this;this.$el.html(JST.dashboard_zaps(this.context()));this.setEmptyModes();this.$live=this.$(\".live-block\");this.$paused=this.$(\".paused-block\");this.$unfinished=this.$(\".unfinished-block\");renderSearch=_.after(z.app.reads.length,this.renderSearch);z.app.reads.each(function(read){return _.defer(function(){_this.add(read);return renderSearch()})});return this},add:function(model){var $el,read,view,write;if(!((model!=null?model.isLive:void 0)!=null)){read=z.app.reads.get(model.get(\"read_id\"));write=model}else{read=model;write=z.app.writes.get(model.get(\"write_ids\")[0])}if(!(read!=null)||!(write!=null))return;view=_.find(this.views,function(view){return view.id===read.id});if(this.live(read))$el=this.$live;if(this.paused(read))$el=this.$paused;if(this.unfinished(read))$el=this.$unfinished;if(view!=null){view.$el.appendTo($el);view.delegateEvents()}else{view=new z.ui.Zap({read:read,write:write,zaps:this});view.id=read.id;$el.append(view.render().el);this.views.push(view)}return this.setEmptyModes()},\"delete\":function(model){var view;view=_.find(this.views,function(view){return view.id===model.id});if(view!=null)view.remove();this.views=_.without(this.views,view);return this.setEmptyModes()},move:function(model){var $el,view;view=_.find(this.views,function(view){return view.id===model.id});if(!(view!=null))return;if(this.live(model))$el=this.$live;if(this.paused(model))$el=this.$paused;if(this.unfinished(model))$el=this.$unfinished;view.undelegateEvents();view.$el.appendTo($el);view.delegateEvents();return this.setEmptyModes()},renderSearch:function(){var _this=this;return this.$(\".zap-mini\").each(function(i,el){var $el,read,write;$el=$(el);read=z.app.reads.get($el.attr(\"data-read-id\"));write=z.app.writes.get($el.attr(\"data-write-id\"));$el.removeClass(\"hide\");if(!_this.searchMatch(read,write))return $el.addClass(\"hide\")})},regex:{selected_api:/selected_api:(\"[^\"]+\"|[\\w]+)/g,params:/params:(\"[^\"]+\"|[\\w]+)/g,action:/action:(\"[^\"]+\"|[\\w]+)/g,status:/status:(\"[^\"]+\"|[\\w]+)/g},searchMatch:function(read,write){var any,each,haystack,m,needle,needles,q,_i,_len,_ref,_ref2,_this=this;q=this.search.get(\"search\")||\"\";needles=q.split(\"OR\");any=[];for(_i=0,_len=needles.length;_i<_len;_i++){needle=needles[_i];each=[];if(m=needle.match(this.regex.selected_api)){each.push(_.all(m,function(match){match=match.replace(\"selected_api:\",\"\");needle=needle.replace(\"selected_api:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return read.get(\"selected_api\")===match||write.get(\"selected_api\")===match}))}if(m=needle.match(this.regex.action)){each.push(_.all(m,function(match){match=match.replace(\"action:\",\"\");needle=needle.replace(\"action:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return read.get(\"action\")===match||write.get(\"action\")===match}))}if(m=needle.match(this.regex.params)){each.push(_.all(m,function(match){match=match.replace(\"params:\",\"\");needle=needle.replace(\"params:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return _.str.include(JSON.stringify(read.get(\"params\")),match)||_.str.include(JSON.stringify(write.get(\"params\")),match)}))}if(m=needle.match(this.regex.status)){each.push(_.all(m,function(match){var status;match=match.replace(\"status:\",\"\");needle=needle.replace(\"status:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;status=!read.isComplete()?\"unfinished\":null;if(!(status!=null))status=read.isLive()?\"live\":\"paused\";return _.str.include(status,match)}))}needle=_.trim(needle.toLowerCase());haystack=\"\";haystack+=(read!=null?read.get(\"title\"):void 0)+\" \";haystack+=(read!=null?read.get(\"action\"):void 0)+\" \";haystack+=((_ref=z.app.services.get(read!=null?read.get(\"selected_api\"):void 0))!=null?_ref.getName():void 0)+\" \";haystack+=(write!=null?write.get(\"title\"):void 0)+\" \";haystack+=(write!=null?write.get(\"action\"):void 0)+\" \";haystack+=((_ref2=z.app.services.get(write!=null?write.get(\"selected_api\"):void 0))!=null?_ref2.getName():void 0)+\" \";haystack=haystack.toLowerCase();if((needle!=null?needle.length:void 0)>0){each.push(_.str.include(haystack,needle))}if(_.any(each,function(e){return!e})){any.push(false)}else{any.push(true)}}return _.any(any,function(a){return a})}});z.ui.CreateBlock=z.ui.Base.extend({className:\"widget create\",context:function(){var context;context={isPartner:z.app.partner.isPartnerSession()};return context},render:function(){this.$el.html(JST.dashboard_create(this.context()));return this}});z.ui.PartnerZaps=z.ui.Base.extend({events:{\"click button[data-template-id]\":\"useRecipe\"},initialize:function(options){this.options=options;_.bindAll(this);this.setMode(\"no\",\"text\");return this.model=this.options.model},context:function(){var context,_ref,_ref2;context={recipes:(_ref=z.app.recipes)!=null?_ref.toJSON():void 0,service:z.app.services.get((_ref2=z.app.partner.get(\"zap\"))!=null?_ref2.selected_api:void 0).getName(),button:this.options.button};return context},render:function(){this.$el.html(JST.dashboard_partner_zaps(this.context()));return this},useRecipe:function(e){var recipe;if(e!=null)e.preventDefault();$(e.currentTarget).attr(\"disabled\",true);recipe=z.app.recipes.get($(e.currentTarget).attr(\"data-template-id\"));return recipe.startUsing({success:function(read,write){$(e.currentTarget).attr(\"disabled\",false);return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}});z.ui.SharedZaps=z.ui.Base.extend({initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,this.options);z.app.recipes.on(\"remove\",this[\"delete\"],this);z.app.recipes.on(\"add\",this.add,this);this.views=[];return this.options.search.on(\"change:search\",this.renderSearch,this)},setEmptyModes:function(){return this.setMode(!z.app.recipes.any(),\"shared-empty\")},context:function(){var context;context={};return context},render:function(){var renderSearch,_this=this;this.$el.html(JST.dashboard_shared_zaps(this.context()));this.setEmptyModes();this.$shared=this.$(\".shared-zaps\");renderSearch=_.after(z.app.recipes.length,this.renderSearch);z.app.recipes.each(function(recipe){return _.defer(function(){_this.add(recipe);return renderSearch()})});return this},add:function(model){var view;view=_.find(this.views,function(view){return view.id===model.id});if(view!=null){view.$el.appendTo(this.$shared);view.delegateEvents()}else{view=new z.ui.SharedZap({recipe:model,zaps:this});view.id=model.id;this.$shared.append(view.render().el);this.views.push(view)}return this.setEmptyModes()},\"delete\":function(model){var view;view=_.find(this.views,function(view){return view.id===model.id\n});if(view!=null)view.remove();this.views=_.without(this.views,view);return this.setEmptyModes()},renderSearch:function(){var _this=this;return this.$(\".zap-mini\").each(function(i,el){var $el,recipe;$el=$(el);recipe=z.app.recipes.get($el.attr(\"data-shared-id\"));$el.removeClass(\"hide\");if(!_this.searchMatch(recipe))return $el.addClass(\"hide\")})},regex:{selected_api:/selected_api:(\"[^\"]+\"|[\\w]+)/g,params:/params:(\"[^\"]+\"|[\\w]+)/g,action:/action:(\"[^\"]+\"|[\\w]+)/g,status:/status:(\"[^\"]+\"|[\\w]+)/g},searchMatch:function(recipe){var any,each,haystack,m,needle,needles,q,_i,_len,_ref,_ref2,_this=this;q=this.search.get(\"search\")||\"\";needles=q.split(\"OR\");any=[];for(_i=0,_len=needles.length;_i<_len;_i++){needle=needles[_i];each=[];if(m=needle.match(this.regex.selected_api)){each.push(_.all(m,function(match){match=match.replace(\"selected_api:\",\"\");needle=needle.replace(\"selected_api:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return recipe.get(\"read_service_selected_api\")===match||recipe.get(\"write_service_selected_api\")===match}))}if(m=needle.match(this.regex.action)){each.push(_.all(m,function(match){match=match.replace(\"action:\",\"\");needle=needle.replace(\"action:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return recipe.get(\"read_data\").action===match||recipe.get(\"write_data\").action===match}))}if(m=needle.match(this.regex.params)){each.push(_.all(m,function(match){match=match.replace(\"params:\",\"\");needle=needle.replace(\"params:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return _.str.include(JSON.stringify(recipe.get(\"read_data\").params),match)||_.str.include(JSON.stringify(recipe.get(\"write_data\").params),match)}))}needle=_.trim(needle.toLowerCase());haystack=\"\";haystack+=(recipe!=null?recipe.get(\"title\"):void 0)+\" \";haystack+=(recipe!=null?recipe.get(\"read_data\").action:void 0)+\" \";haystack+=((_ref=z.app.services.get(recipe!=null?recipe.get(\"read_data\").selected_api:void 0))!=null?_ref.getName():void 0)+\" \";haystack+=(recipe!=null?recipe.get(\"write_data\").action:void 0)+\" \";haystack+=((_ref2=z.app.services.get(typeof wrecipe!==\"undefined\"&&wrecipe!==null?wrecipe.get(\"write_data\").selected_api:void 0))!=null?_ref2.getName():void 0)+\" \";haystack=haystack.toLowerCase();if((needle!=null?needle.length:void 0)>0){each.push(_.str.include(haystack,needle))}if(_.any(each,function(e){return!e})){any.push(false)}else{any.push(true)}}return _.any(any,function(a){return a})}});z.ui.BonusBlock=z.ui.Base.extend({className:\"widget bonuses\",initialize:function(){z.app.accountBonuses.on(\"change\",this.debounceRender,this);return this.debounceRender=_.debounce(this.render,1e3)},context:function(){var context;context={};context.bonuses=z.app.accountBonuses.toJSON();_.each(context.bonuses,function(bonus){bonus.earned=false;bonus.partial_earned=false;if(bonus.limit===1&&bonus.times_earned>0)bonus.earned=true;if(bonus.limit!==1&&bonus.times_earned===bonus.limit){bonus.earned=true}if(bonus.limit!==1&&bonus.times_earned>0){return bonus.partial_earned=true}});return context},render:function(){if(!z.app.account.isFree())return this;this.$el.html(JST.dashboard_bonus(this.context()));this.refresh();return this},refresh:function(){return z.app.accountBonuses.fetch({expiry:2e3})}});z.ui.CollectionBlock=z.ui.Base.extend({className:\"widget collection center\",events:{\"click .button\":\"click\"},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.dashboard_collection(this.context()));return this},click:function(){var modal;if(typeof e!==\"undefined\"&&e!==null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.CreateCollectionModal({})})}});z.ui.Zap=z.ui.Base.extend({tagName:\"div\",className:\"zap-mini dashboard\",attributes:function(){var _ref,_ref2;return{\"data-read-id\":(_ref=this.options.read)!=null?_ref.id:void 0,\"data-write-id\":(_ref2=this.options.write)!=null?_ref2.id:void 0}},events:{\"click .open-menu\":\"menu\",\"click .toggle .hit-target\":\"toggle\",\"click .count\":\"tag\",click:\"edit\"},initialize:function(options){var render;this.options=options;if(!(this.options.read!=null))throw\"read required\";if(!(this.options.write!=null))throw\"write required\";_.bindAll(this);_.defaults(this,this.options);render=_.debounce(this.render,40);this.setMode(this.state.get(\"open\")||\"not\",\"open\");this.setMode(this.state.get(\"paused\")||this.read.get(\"paused\"),\"paused\");this.setMode(this.state.get(\"delete\")||this.read.get(\"delete\"),\"delete\");this.read.on(\"change:title\",render,this);this.read.on(\"change:selected_api\",render,this);this.read.on(\"change:has_shared\",render,this);this.write.on(\"change:selected_api\",render,this);return z.app.stream.on(\"add remove reset\",render,this)},context:function(){var context,readService,t;readService=z.app.services.get(this.read.get(\"selected_api\"));context={};context.read=this.read.toJSON();context.write=this.write.toJSON();context.title=this.read.getTitle();context.cssReadClass=this.read.serviceImageClass();context.cssWriteClass=this.write.serviceImageClass();context.canRun=!(readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0);context.isStaff=z.app.account.isStaff();context.isComplete=this.read.isComplete();context.unseen=z.app.stream.unseen(this.write.get(\"id\"));t=z.useful.render(\"{{s}}\",{s:this.read.get(\"collect_errors\").join(\"<br />\")});context.errorString=new Handlebars.SafeString(t);return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_zap(context));return this},edit:function(e){var $elX,menuX,toggleX,x,_ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();$elX=this.$el.offset().left;x=e.pageX-$elX;if(this.$(\".toggle\").length>0){toggleX=this.$(\".toggle\").offset().left-$elX;menuX=this.$(\".open-menu\").offset().left-$elX;if(x<toggleX){return Backbone.history.navigate(\"app/editor/\"+this.read.id,{trigger:true})}else if(x<menuX){return this.toggle(e)}else{return this.menu(e)}}else{menuX=this.$(\".open-menu\").offset().left-$elX;if(x<menuX){return Backbone.history.navigate(\"app/editor/\"+this.read.id,{trigger:true})}else{return this.menu(e)}}},menu:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.ZapMenu({read:this.read,write:this.write}),target:this.$(\".open-menu\"),x:-215,y:48,noX:true})},toggle:function(e){if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if(this.read.get(\"paused\")){return this.unpause(e)}else{return this.pause(e)}},pause:function(e){var _this=this;return this.$el.animate({opacity:.25},350,function(){return _this.read.pause({wait:true,success:function(){_this.$el.animate({opacity:1},350,function(){return _this.render()});return _this.setMode(\"is\",\"paused\")}})})},unpause:function(e){var _this=this;return this.$el.animate({opacity:.25},350,function(){return _this.read.unpause({wait:true,error:function(model,xhr){var error,modal;_this.$el.animate({opacity:1},350,function(){});_this.setMode(\"is\",\"paused\");if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})},success:function(){_this.$el.animate({opacity:1},350,function(){return _this.render()});return _this.setMode(\"not\",\"paused\")}})})},tag:function(e){return e!=null?e.stopPropagation():void 0}});z.ui.ZapMenu=z.ui.Base.extend({className:\"zap-menu-modal menu with-hover\",events:{\"click .edit\":\"edit\",\"click .logs\":\"logs\",\"click .copy\":\"copy\",\"click .rename\":\"rename\",\"click .share\":\"share\",\"click .delete\":\"delete\",\"click .recipe\":\"recipe\",\"click .instant\":\"instant\",\"click .run\":\"run\"},initialize:function(options){this.options=options;_.bindAll(this);this.read=this.options.read;return this.write=this.options.write},context:function(){var context,readService;readService=z.app.services.get(this.read.get(\"selected_api\"));context={};context.read=this.read.toJSON();context.write=this.write.toJSON();context.title=this.read.getTitle();context.cssReadClass=this.read.serviceImageClass();context.cssWriteClass=this.write.serviceImageClass();context.canRun=!(readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0);context.isStaff=z.app.account.isStaff();context.isComplete=this.read.isComplete();context.unseen=z.app.stream.unseen(this.write.get(\"id\"));context.canShare=this.read.canShare()&&this.write.canShare();return context},render:function(){this.$el.html(JST.dashboard_zap_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},run:function(e){var modal;if(e!=null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.RunZap({read:this.read})})},edit:function(e){if(e!=null)e.preventDefault();return this.close()},logs:function(e){if(e!=null)e.preventDefault();return this.close()},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.$el.animate({opacity:0},350,function(){_this.close();return _this.read.destroy()})},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.read.save({title:value})};modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.read.getTitle(),save:save})});return this.close()},share:function(e){if(e!=null)e.preventDefault();this.shareZapModal=new z.ui.Modal({view:new z.ui.ShareZapModal({read:this.read,write:this.write})});return this.close()},copy:function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"copy\")===\"working\")return;this.setMode(\"working\",\"copy\");return this.read.copy({success:function(){return _.delay(function(){_this.setMode(\"default\",\"copy\");return _this.close()},1e3)}})},getRecipeURL:function(){var base,qs;base=\"/admin/snapbook/recipe/add/\";qs=$.param({title:\"\"+_.superHumanize(this.read.get(\"action\"))+\" to \"+_.superHumanize(this.write.get(\"action\")),read:this.read.get(\"selected_api\"),write:this.write.get(\"selected_api\"),read_action:this.read.get(\"action\"),write_action:this.write.get(\"action\"),read_params:JSON.stringify(this.read.get(\"params\")),write_params:JSON.stringify(this.write.get(\"params\"))});return\"\"+base+\"?\"+qs},recipe:function(e){var options,target,url,win;if(e!=null)e.preventDefault();url=this.getRecipeURL();target=null;options=\"height=600,width=980,resizable=yes,scrollbars=yes\";win=z.useful.open(url,target,options).focus();return this.close()},instant:function(e){if(e!=null)e.preventDefault()}});z.ui.Support=z.ui.Base.extend({events:{click:\"open\"},initialize:function(options){var _this=this;_.bindAll(this);return Backbone.history.on(\"route\",function(){_this.render();if(_.str.include(Backbone.history.fragment,\"help/\")){return $(\".support-button\").addClass(\"on-help\")}else{return $(\".support-button\").removeClass(\"on-help\")}})},open:function(e){if(e!=null)e.preventDefault();if(_.str.include(Backbone.history.fragment,\"help/\")){return this.contactSupport()}else{return z.useful.goto(\"/help\")}},contactSupport:function(){var modal;return modal=new z.ui.Modal({view:new z.ui.ContactModal})},context:function(){var context;context={};if(_.str.include(Backbone.history.fragment,\"help/\")){context[\"label\"]=\"Contact us\"}else{context[\"label\"]=\"Get help\"}return context},render:function(){this.$el.html(JST.support_base(this.context()));return this}});z.ui.ContactModal=z.ui.Base.extend({className:\"support-question\",events:{\"click button.submit\":\"submit\"},initialize:function(options){var _ref,_ref2,_ref3,_this=this;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}this.IDENTIFIER=[{key:\"full_name\",label:\"Your full name.\",type:\"unicode\",required:true},{key:\"email\",label:\"Your email address.\",type:\"unicode\",required:true}];this.CHOICES=[\"I have a question before signing up.\",\"I can't access my account.\",\"I can't get my zap to work.\",\"I got an error on my zap.\",\"I have a billing/pricing question.\",\"Some other issue.\"];if((_ref2=z.app.account)!=null?_ref2.id:void 0){this.IDENTIFIER=[];this.CHOICES=[\"I can't get my zap to work.\",\"I got an error on my zap.\",\"I have a billing/pricing question.\",\"I have a request for a new feature or supported service.\",\"Some other issue.\"]}this.fields=[{key:\"question_type\",label:\"What do you need help with?\",choices:this.CHOICES,type:\"prettypills\",required:true}];this.form=new z.model.FormSet(this.fields);this.form.on(\"change\",this.formChange,this);this.form.on(\"add reset\",this.render,this);this.setMode(\"cannot\",\"save\");if(((_ref3=z.app.account)!=null?_ref3.id:void 0)&&(!(z.app.reads!=null)||!(z.app.services!=null))){return async.parallel({services:async.fetch(new z.model.ServiceSet),reads:async.fetch(new z.model.ReadSet)},function(err,models){_.extend(z.app,models);return _this.render()})}},context:function(){var context,_ref;context={button:(_ref=this.options)!=null?_ref.button:void 0,mediaUrl:window.mediaUrl};return context},render:function(){var view;this.$el.html(JST.support_contact_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.form,prettypills:true});this.$paramform.html(view.render().el);return this},formChange:function(e){var ZAP_FORM,choice_fields,extended_fields,fields,_ref,_ref2,_ref3;fields=this.form.toJSON().slice(0,1);ZAP_FORM=[{key:\"zap\",label:\"Which zap is having the issue?\",help_text:\"Please do not delete/modify the zap! We will need to use it to debug.\",type:\"unicode\",choices:(_ref=z.app.reads)!=null?_ref.map(function(read){return\"\"+(read.getTitle()||\"Unnamed Zap\")+\" (https://zapier.com/app/edit/\"+read.id+\")\"}):void 0,required:true},{key:\"message\",label:\"Describe the problem you are having. What did you want to happen?\",help_text:\"The more details you provide the faster/better we can respond! For example, let us know what you tried already, or what you expected to happen, etc...\",type:\"text\",required:true},{key:\"media_urls\",label:\"Videos/Screenshots URL\",help_text_html:'<p>Videos/Screenshots are the best way to show us <em>exactly</em> what is going on. Use a service like <strong><a target=\"_new\" href=\"http://imgur.com/\">Imgur</a></strong> to upload images, or a service like <strong><a target=\"_new\" href=\"http://www.techsmith.com/jing.html\">Jing</a></strong> to share videos.</p>',type:\"unicode\",required:false}];if(!((_ref2=z.app.account)!=null?_ref2.id:void 0)){ZAP_FORM=[{key:\"login\",help_text_html:'<br /><p class=\"red\"><em>You need to <a href=\"/app/login?next='+window.location.pathname+'\">login first</a> if you want to ask a zap specific question!</em></p>',type:\"copy\",required:true}]}if(fields[0][\"value\"]&&this.currentType!==fields[0][\"value\"]){this.currentType=fields[0][\"value\"];choice_fields={\"I have a question before signing up.\":this.IDENTIFIER.concat([{key:\"message\",label:\"What is your question?\",help_text:\"The more details you provide, the faster we can respond!\",type:\"text\",required:true}]),\"I can't access my account.\":this.IDENTIFIER.concat([{key:\"message\",label:\"More information.\",help_text:\"Please provide any identifying information you might have about the inaccessible account (company name, alternate emails, usernames, etc...).\",type:\"text\",required:false}]),\"I can't get my zap to work.\":this.IDENTIFIER.concat(ZAP_FORM),\"I got an error on my zap.\":this.IDENTIFIER.concat(ZAP_FORM),\"I have a request for a new feature or supported service.\":this.IDENTIFIER.concat([{key:\"service\",label:\"Which service does this pertain to?\",type:\"unicode\",choices:[\"Suggest New Service\"].concat((_ref3=z.app.services)!=null?_ref3.filter(function(service){var _ref4;return!((_ref4=service.get(\"meta\"))!=null?_ref4.hide:void 0)}).map(function(service){return\"\"+service.getName()}):void 0),required:true},{key:\"message\",label:\"Provide more details.\",type:\"text\",required:true}]),\"I have a billing/pricing question.\":this.IDENTIFIER.concat([{key:\"message\",label:\"Ask away! The more details you provide, the faster we can respond!\",type:\"text\",required:true}]),\"Some other issue.\":this.IDENTIFIER.concat([{key:\"message\",label:\"Describe the issue you are having.\",help_text:\"The more details you provide, the faster we can respond!\",type:\"text\",required:true},{key:\"media_urls\",label:\"Videos/Screenshots URL\",help_text_html:'<p>Videos/Screenshots are the best way to show us <em>exactly</em> what is going on. Use a service like <strong><a target=\"_new\" href=\"http://imgur.com/\">Imgur</a></strong> to upload images, or a service like <strong><a target=\"_new\" href=\"http://www.techsmith.com/jing.html\">Jing</a></strong> to share videos.</p>',type:\"unicode\",required:false}])};extended_fields=choice_fields[this.currentType];this.form.reset(fields.concat(extended_fields));this.modal.reposition()}if(this.form.isValid()){return this.setMode(\"can\",\"save\")}else{return this.setMode(\"cannot\",\"save\")}},submit:function(e){var values;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"cannot\",\"save\"))return;this.setMode(\"cannot\",\"save\");this.$(\".feedback\").text(\"\").removeClass(\"error\");this.$(\"button\").text(\"Sending...\");values=this.form.getValues();values.current_url=String(window.location.href);return this.save(values)},saveSuccess:function(model){var _this=this;this.$(\".submitter\").html('<em class=\"lighter\">Got it! We will respond via email as soon as possible!</em> <a class=\"close\">Close this.</a>');return setTimeout(function(){return _this.modal.close()},1e4)},saveError:function(model,xhr){var errors;this.setMode(\"can\",\"save\");errors=z.useful.errors(xhr);this.$(\".feedback\").text(errors).addClass(\"error\");return this.$(\"button\").text(\"Send Support Request\")},save:function(values){return $.ajax({url:z.cfg.api+\"/support/contact\",type:\"POST\",data:JSON.stringify(values),dataType:\"json\",contentType:\"application/json\",success:this.saveSuccess,error:this.saveError})}});z.ui.SupportNote=z.ui.Base.extend({events:{\"click [data-support-vote]\":\"vote\"},initialize:function(options){this.options=options;return _.bindAll(this)},vote:function(e){var helpful,success,_this=this;helpful=$(e.currentTarget).attr(\"data-support-vote\");success=function(){return _this.$el.find(\".vote\").text(\"Thanks! This helps us provide better support.\")};return this.options.note.vote({success:success},helpful)},context:function(){var context,_ref;context=this.options.note.toJSON();context=_.extend(context,{first:this.options.first,more:this.options.more,isStaff:(_ref=z.app.account)!=null?_ref.get(\"is_staff\"):void 0});return context},render:function(){var context;context=this.context();this.$el.html(JST.support_note(context));return this}});z.ui.Plans=z.ui.Base.extend({events:{\"click .toggle-interval .switch\":\"switch\",\"click .toggle-interval .toggle-container\":\"toggle\",\"click [data-explain-highlight]\":\"highlight\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);return this.variant=\"month\"},context:function(){var context;context={services:z.app.services,monthly:this.variant===\"month\",plans:z.app.plans.getIntervalPlans(this.variant)};return context},toggle:function(e){var t;t=$(e.currentTarget);if(t.hasClass(\"on\")){this.variant=\"month\"}else{this.variant=\"year\"}t.toggleClass(\"on\");this.render();return this.normalizePlanHeight()},\"switch\":function(e){var t;if(e!=null)e.preventDefault();t=$(e.currentTarget);t.parent().toggleClass(\"on\");this.variant=t.attr(\"data-pricing-interval\");this.render();return this.normalizePlanHeight()},highlight:function(e){var highlightThis,target;highlightThis=$(e.currentTarget).attr(\"data-explain-highlight\");this.$el.find(\"[data-explain]\").removeClass(\"highlighted\");target=this.$el.find('[data-explain=\"'+highlightThis+'\"]');return $(\"html, body\").animate({scrollTop:target.offset().top-100},100,function(){return target.addClass(\"highlighted\")})},render:function(){var context;context=this.context();this.$el.html(JST.pricing_plans(context));return this},normalizePlanHeight:function(cb){var height,plan_boxes;plan_boxes=this.$el.find(\".plan .features\");height=_.max(_.map(plan_boxes,function(el){return $(el).height()}));if(height){plan_boxes.css({height:height+\"px\"})}return typeof cb===\"function\"?cb():void 0}});z.ui.DeveloperAppRequests=z.ui.Base.extend({events:{\"click #request-log-controls button\":\"loadRequestLogs\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_requests(this.context()));this.loadRequestLogs();return this},displayRequest:function(html){var backLink,origScroll,requestLog,requestLogControls,requestLogList,requsetDetails;requestLog=this.$el.find(\"#request-log\");requestLogControls=this.$el.find(\"#request-log-controls\");requestLogList=requestLog.find(\"table\");origScroll=$(\"body\").scrollTop();requsetDetails=$(\"<div>\").append(html);backLink=$('<a href=\"#\">Back to List</a>').on(\"click\",function(e){e.preventDefault();requsetDetails.remove();requestLogControls.show();requestLogList.show();return $(\"body\").scrollTop(origScroll)});requsetDetails.prepend(backLink);requestLogControls.hide();requestLogList.hide();requestLog.append(requsetDetails);return $(\"body\").scrollTop(0)},loadRequestLogs:function(){var ajaxifyRequestLinks,refreshIcon,requestLog,_this=this;requestLog=this.$el.find(\"#request-log\");ajaxifyRequestLinks=function(){return $(\"#request-log table a\").on(\"click\",function(e){var url;e.preventDefault();url=$(e.target).attr(\"href\")+\"?wrap=false\";return $.ajax(url,{success:_this.displayRequest})})};refreshIcon=$(\"#request-log-controls button\");refreshIcon.html(\"Loading...\");return $.ajax(\"/developer/app/\"+z.app.developer.app.id+\"/requests?wrap=false\",{success:function(html){requestLog.find(\"table\").remove();requestLog.append(html);ajaxifyRequestLinks();refreshIcon.html(\"Done\");return setTimeout(function(){return refreshIcon.html(\"Refresh\")},1500)}})}});z.ui.DeveloperAppAuthFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_auth_field_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppAuthFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"auth field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),app:z.app.developer.app.toJSON(),isWizard:this.options.isWizard}},render:function(){this.$el.html(JST.developer_app_edit_auth_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref,_ref2;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.authFields.add(model)}if((_ref2=this.options)!=null?_ref2.isWizard:void 0){next=\"/auth/edit/fields\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+next,{trigger:true})}});z.ui.DeveloperAppTriggerFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_trigger_field_table_row(this.context()));return this}});z.ui.DeveloperAppTriggerFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"trigger field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_edit_trigger_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var _ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){this.options.trigger.fields.add(model)}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/triggers/\"+this.options.trigger.get(\"id\")+\"/fields\",{trigger:true})}});z.ui.DeveloperAppAuth=z.ui.DeveloperAppCommonSection.extend({events:{\"click .save-sortable\":\"saveSortable\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},context:function(){var allWarnings,warnings;allWarnings=z.app.developer.app.get(\"warnings\");warnings=[];if(allWarnings!=null?allWarnings.auth_mapping:void 0){warnings=warnings.concat(allWarnings.auth_mapping)}if(allWarnings!=null?allWarnings.oauth_data:void 0){warnings=warnings.concat(allWarnings.oauth_data)}return{app:z.app.developer.app.toJSON(),warnings:warnings}},renderRows:function(){return z.ui.DeveloperAppCommonSection.prototype.renderRows.apply(this,[z.app.developer.app.authFields,z.ui.DeveloperAppAuthFieldSummary])},render:function(){this.$el.html(JST.developer_app_auth(this.context()));return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.authFields,z.ui.DeveloperAppAuthFieldSummary,JST.developer_app_auth_empty_section])},gotSorted:false,saveSortable:function(){var _this=this;this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save-sortable\").text(\"Saving...\");this.$el.find(\".save-sortable\").attr(\"disabled\",\"disabled\");return z.app.developer.app.authFields.saveSort({success:function(){_this.$el.find(\".save-sortable\").text(\"Success!\");return _.delay(function(){return _this.$el.find(\".save-sortable\").hide()},1e3)},error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));_this.$el.find(\".save-sortable\").text(\"Save Sorting\");return _this.$el.find(\".save-sortable\").removeAttr(\"disabled\",\"disabled\")}})},sortFields:function(id,pad){this.$el.find(\".save-sortable\").show();this.gotSorted=true;z.app.developer.app.authFields.models=z.app.developer.app.authFields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});z.app.developer.app.authFields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)}});z.ui.DeveloperAppAuthSettings=z.ui.DeveloperAppCommonForm.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_auth_settings(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppTriggerFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},renderRows:function(){var fieldContainer;this.$el.find(\".trigger-fields tbody\").html(\"\");fieldContainer=this.$el.find(\".trigger-fields tbody\");return this.options.trigger.fields.each(function(field){var view;view=new z.ui.DeveloperAppTriggerFieldSummary({trigger:this.options.trigger,model:field});return fieldContainer.append(view.render().el)},this)},render:function(){this.$el.html(JST.developer_app_trigger_fields(this.context()));this.renderRows();return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;this.options.trigger.fields.models=this.options.trigger.fields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});this.options.trigger.fields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(){var goNextUrl,_this=this;goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/triggers/\"+_this.options.trigger.get(\"id\")+\"/edit/backend\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return this.options.trigger.fields.saveSort({success:goNextUrl,error:function(){this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppTriggers=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_triggers(this.context()));z.app.developer.app.triggers.sort();return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.triggers,z.ui.DeveloperAppTriggerSummary,JST.developer_app_triggers_empty_section])}});z.ui.DeveloperAppActionEditor=z.ui.Base.extend({className:\"action-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_action(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppActionEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_action_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.actions.add(model)}if(this.section===\"appearance\"){next=\"actions/\"+model.get(\"id\")+\"/edit/fields\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/\"+next,{trigger:true})}});z.ui.DeveloperAppActionFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},renderRows:function(){var fieldContainer;this.$el.find(\".action-fields tbody\").html(\"\");fieldContainer=this.$el.find(\".action-fields\");return this.options.action.fields.each(function(field){var view;view=new z.ui.DeveloperAppActionFieldSummary({action:this.options.action,model:field});return fieldContainer.append(view.render().el)},this)},render:function(){var fieldContainer;this.$el.html(JST.developer_app_action_fields(this.context()));fieldContainer=this.$el.find(\".action-fields\");\nthis.options.action.fields.each(function(field){var view;view=new z.ui.DeveloperAppActionFieldSummary({action:this.options.action,model:field});return fieldContainer.append(view.render().el)},this);return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;this.options.action.fields.models=this.options.action.fields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});this.options.action.fields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(e){var goNextUrl,_this=this;if(e!=null)e.preventDefault();goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/actions/\"+_this.options.action.get(\"id\")+\"/edit/backend\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return this.options.action.fields.saveSort({success:goNextUrl,error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return _this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppTriggerEditor=z.ui.Base.extend({className:\"trigger-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_trigger(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppTriggerEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_trigger_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.triggers.add(model)}if(this.section===\"appearance\"){next=\"triggers/\"+model.get(\"id\")+\"/edit/fields\"}else if(this.section===\"backend\"){next=\"triggers/\"+model.get(\"id\")+\"/edit/sample\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/\"+next,{trigger:true})}});z.ui.DeveloperAppInvite=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_invite(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var modal;this.form.clearErrors();modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_invite_success_modal({numSent:response!=null?response.count:void 0})})}});z.ui.DeveloperAppScripting=z.ui.Base.extend({className:\"scripting-new\",events:{\"click .save\":\"save\",\"click .links\":\"links\",\"click .go-back\":\"back\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){var _ref;if((_ref=_this.menuModal)!=null)_ref.close();return window.onbeforeunload=null})},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){var _this=this;this.$el.html(JST.developer_app_scripting(this.context()));this.editor=CodeMirror.fromTextArea(this.$(\"textarea\")[0],{lineNumbers:true,lineWrapping:true,indentUnit:4,matchBrackets:true,mode:\"javascript\"});this.editor.on(\"change\",_.debounce(this.stale,500));_.defer(function(){return _this.editor.refresh()});return this},save:function(e){var _this=this;if(e!=null)e.preventDefault();z.app.developer.app.save({js:this.editor.getValue()},{success:function(){_this.$(\".save\").text(\"Saved!\");return window.onbeforeunload=null},error:function(){return _this.$(\".save\").text(\"Error!\")}});return this.$(\".save\").text(\"Saving...\")},links:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.ScriptingLinksMenu({}),target:this.$(\".buttons\"),x:-100,y:40,noX:true})},stale:function(){var current,saved,_this=this;saved=_.str.clean(z.app.developer.app.get(\"js\"));current=_.str.clean(this.editor.getValue());if(saved!==current){window.onbeforeunload=function(){return\"You have unsaved changes! Are you sure you want to leave?\"};return this.$(\".save\").text(\"Save\")}else{return window.onbeforeunload=null}},back:function(e){var go,id,_this=this;if(e!=null)e.preventDefault();id=z.app.developer.app.id;go=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+id,{trigger:true})};if(window.onbeforeunload!=null){if(confirm(window.onbeforeunload()))return go()}else{return go()}}});z.ui.ScriptingLinksMenu=z.ui.Base.extend({className:\"developer-app-scripting-menu-modal menu with-hover\",events:{\"click a\":\"close\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={app:z.app.developer.app.toJSON()};return context},render:function(){this.$el.html(JST.developer_app_scripting_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})}});z.ui.DeveloperAppTriggerSampleResult=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);return z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments)},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),isNew:z.app.developer.form.wrappedModel.isNew()}},render:function(){var _this=this;this.$el.html(JST.developer_app_trigger_sample_result(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();z.app.developer.form.get(\"sample\").on(\"change\",this.updateSaveButtonCopy);this.overrideForms={};_.each(this.options.triggerSample.get(\"overrides\"),function(override){var overrideEl,overrideModel,overrideView;overrideModel=new z.model.DeveloperAppFormSet([_this.buildOverrideLabelFormRow(override),_this.buildOverrideImportantFormRow(override)]);_this.overrideForms[override.key]=overrideModel;overrideEl=$(\"<div></div>\").html(JST.developer_app_trigger_sample_override_form({key:override.key}));overrideView=new z.ui.DeveloperAppParamForm({form:overrideModel,el:overrideEl.find(\"form\")});overrideView.render();return _this.$el.find(\"#override-container\").append(overrideEl)});return this},save:function(e){var overrides,_this=this;if(e!=null)e.preventDefault();overrides=this.options.triggerSample.get(\"overrides\");_.each(overrides,function(override){var values;values=_this.overrideForms[override.key].getValues();return override=_.extend(override,values)});z.app.developer.form.save()},saveSuccess:function(model,response,options){var _ref;if((_ref=z.app.developer.form.wrappedModel.changed)!=null?_ref.sample:void 0){this.render()}else{Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}},buildOverrideLabelFormRow:function(override){return new z.model.FormRow({key:\"label\",value:override!=null?override.label:void 0,required:false,label:\"Label\",type:\"unicode\",help_text:\"\"})},buildOverrideImportantFormRow:function(override){return new z.model.FormRow({key:\"important\",value:override!=null?override.important:void 0,required:false,label:\"Important\",type:\"checkbox\"})},updateSaveButtonCopy:function(e){this.$el.find(\"button.save\").text(\"Parse Sample\");this.$el.find(\"#override-container\").slideUp()}});z.ui.DeveloperAppActivation=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:z.app.developer.app.toJSON(),hasErrors:this.options.audit.hasErrors()}},render:function(){var auditView;this.$el.html(JST.developer_app_global_activation(this.context()));auditView=new z.ui.DeveloperAppAudit({audit:this.options.audit});this.$el.find(\".developer-app-audit\").html(auditView.render().el);if(!this.options.audit.hasErrors()){this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render()}return this},saveSuccess:function(model,response,options){var modal;modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_global_activation_success_modal()});modal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})})}});z.ui.DeveloperAppMeta=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:this.options.app.toJSON()}},render:function(){var fileInput,_this=this;this.$el.html(JST.developer_app_meta(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();if(this.options.app.get(\"id\")!=null){fileInput=this.$el.find('input[type=\"file\"]');fileInput.attr(\"data-url\",\"\"+z.cfg.devapi+\"/apps/\"+this.options.app.get(\"id\")+\"/image\");fileInput.fileupload({dataType:\"json\",add:function(e,data){return z.app.developer.form.setFileUpload(data)}})}else{this.$el.find(\"div.field-image\").hide()}return this},saveSuccess:function(model,response,options){var _ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app=model;if(z.app.developer.apps!=null)z.app.developer.apps.add(model)}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppMigrate=z.ui.Base.extend({className:\"developer-app\",initialize:function(options){this.options=options;return _.bindAll(this)},events:{\"click .save\":\"next\"},context:function(){return{app:z.app.developer.app.toJSON(),hasErrors:this.options.audit.hasErrors()}},render:function(){var auditView;this.$el.html(JST.developer_app_migrate(this.context()));auditView=new z.ui.DeveloperAppAudit({audit:this.options.audit});this.$el.find(\".developer-app-audit\").html(auditView.render().el);return this},next:function(){return $.ajax({type:\"POST\",url:z.cfg.devapi+\"/apps/migrations\",data:JSON.stringify({old_app:this.options.oldAppId,new_app:z.app.developer.app.get(\"id\")}),dataType:\"json\",contentType:\"application/json\",success:function(data,xhr){var modal;modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_migrate_success_modal()});return modal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}});z.ui.DeveloperAppChooseMigrationTarget=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},events:{\"click .save\":\"next\"},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_migrate_choose_target(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},next:function(){var old_app_id;if(typeof e!==\"undefined\"&&e!==null)e.preventDefault();if(z.app.developer.form.isValid()){old_app_id=z.app.developer.form.getValues()[\"old_app\"];Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/migrate/\"+old_app_id,{trigger:true})}}});z.ui.DeveloperAppAuthEditor=z.ui.Base.extend({className:\"auth-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_auth_editor(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppAuthEditorScheme=z.ui.Base.extend({events:{\"click #use-basic-auth\":\"enableBasicAuth\",\"click #use-api-key\":\"showApiKeySubMenu\",\"click #use-oauthv2\":\"showOauthV2SubMenu\",\"click #use-digest-auth\":\"enableDigestAuth\",\"click #api-key-sub-type button\":\"enableApiKey\",\"click #oauthv2-sub-type button\":\"enableOauthV2\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON(),devpath:z.cfg.devpath}},render:function(){this.$el.html(JST.developer_app_auth_choose_scheme(this.context()));return this},saveAuthFieldsAndNext:function(){var saves,_this=this;saves=[];z.app.developer.app.authFields.each(function(field){return saves.push(function(cb){return field.save({required:true},{success:function(){return cb()}})})});async.parallel(saves,function(err,models){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/auth/edit/fields\",{trigger:true})})},enableBasicAuth:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",1);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Username\",key:\"username\",type_of:\"unicode\"},{app:z.app.developer.app});z.app.developer.app.authFields.add({label:\"Password\",key:\"password\",type_of:\"password\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}},showApiKeySubMenu:function(e){e.preventDefault();this.$el.find(\"#api-key-sub-type\").show();return this.$el.find(\"#oauthv2-sub-type\").hide()},enableApiKey:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",this.$(e.target).val());if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"API Key\",key:\"api_key\",type_of:\"unicode\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}},showOauthV2SubMenu:function(e){e.preventDefault();this.$el.find(\"#api-key-sub-type\").hide();return this.$el.find(\"#oauthv2-sub-type\").show()},enableOauthV2:function(e){var authType;authType=parseInt(this.$(e.target).val());z.app.developer.app.set(\"auth_type\",authType);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Access Token\",key:\"access_token\",type_of:\"unicode\"},{app:z.app.developer.app});if(authType===6){z.app.developer.app.authFields.add({label:\"Refresh Token\",key:\"refresh_token\",type_of:\"unicode\"},{app:z.app.developer.app})}this.saveAuthFieldsAndNext()}},enableDigestAuth:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",7);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Username\",key:\"username\",type_of:\"unicode\"},{app:z.app.developer.app});z.app.developer.app.authFields.add({label:\"Password\",key:\"password\",type_of:\"password\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}}});z.ui.DeveloperAppAuthEditorFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},context:function(){return{app:z.app.developer.app.toJSON(),devpath:z.cfg.devpath}},renderRows:function(){var container;container=this.$el.find(\".table tbody\");container.html(\"\");return z.app.developer.app.authFields.each(function(model){var view;view=new z.ui.DeveloperAppAuthFieldSummary({model:model});return container.append(view.render().el)},this)},render:function(){if(z.app.developer.app.authFields.size()>0){this.$el.html(JST.developer_app_auth_editor_fields(this.context()));this.renderRows()}else{this.$el.html(JST.developer_app_auth_empty_fields(this.context()))}if(z.app.developer.app.authFields.size()>0){this.$el.find(\".table tbody\").find(\"a[data-nav]\").each(function(index,elem){elem=$(elem);elem.attr(\"data-nav\",elem.attr(\"data-nav\").replace(\"auth/\",\"auth/edit/\").slice(0,-5));elem.attr(\"href\",elem.attr(\"href\").replace(\"auth/\",\"auth/edit/\").slice(0,-5))})}return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;z.app.developer.app.authFields.models=z.app.developer.app.authFields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});z.app.developer.app.authFields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(e){var goNextUrl,_this=this;if(e!=null)e.preventDefault();goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/auth/edit/mapping\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return z.app.developer.app.authFields.saveSort({success:goNextUrl,error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return _this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppAuthEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_auth_editor_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();this.form.$el.find(\"div.field-auth-type\").hide();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperApp=z.ui.Base.extend({className:\"developer-app\",events:{\"click #make-global\":\"showMakeGlobalModal\",\"click #enable-invite\":\"showEnableInviteModal\",\"click #clone-app\":\"cloneApp\",\"click #revert-app\":\"revertApp\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON(),isEditable:z.app.developer.app.isEditable(),isActive:z.app.developer.app.get(\"status\")>0}},render:function(){var wrapper;this.$el.html(JST.developer_app(this.context()));wrapper=this.$el.find(\"div.all-wrapper\");if(!_.isEmpty(z.app.developer.app.get(\"stats\"))){wrapper.append(this.options.subViews.stats.render().el)}wrapper.append(this.options.subViews.auth.render().el);wrapper.append(this.options.subViews.triggers.render().el);wrapper.append(this.options.subViews.actions.render().el);return this},showMakeGlobalModal:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_global_modal,yes:function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/activate\",{trigger:true})}})})},showEnableInviteModal:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_invite_modal,yes:function(){var id;id=z.app.developer.app.get(\"id\");return $.ajax({url:z.cfg.devapi+(\"/apps/\"+id+\"/invite_activation\"),type:\"POST\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(){var successModal;modal.close();successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_invite_activation_success_modal()});return successModal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.loadUrl()})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}})})},cloneApp:function(e){e.preventDefault();$.ajax({url:z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/clones\"),type:\"POST\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(data){var successModal;z.app.developer.isAppSetCacheStale=true;successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_clone_success_modal()});return successModal.on(\"remove\",function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+data.id,{trigger:true})})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})},revertApp:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_revert_modal,yes:function(){return $.ajax({url:z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/activation\"),type:\"DELETE\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(data){var successModal;modal.close();successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_revert_success_modal()});return successModal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.loadUrl()})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}})})}});z.ui.DeveloperAppSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){var statusMap;statusMap={0:\"Private\",1:\"Pending\",2:\"Invite-Only\",3:\"Global\"};return{app:this.model.toJSON(),prettyStatus:statusMap[this.model.get(\"status\")]}},render:function(){this.$el.html(JST.developer_app_table_row(this.context()));return this}});z.ui.DeveloperAppTriggerSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){var sourceMap;sourceMap={polling:\"Polling\",\"static-webhooks\":\"Static Webhooks\",\"payload-subscriptions\":\"REST Hooks\",\"notification-subscriptions\":\"Notification REST Hooks\"};return{trigger:this.model.toJSON(),app:z.app.developer.app.toJSON(),prettySource:sourceMap[this.model.get(\"source\")]}},render:function(){this.$el.html(JST.developer_app_trigger_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppTriggerSettings=z.ui.DeveloperAppCommonForm.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){var formChoices;formChoices=z.app.developer.form.get(\"test_trigger\").get(\"choices\");if(_.keys(formChoices).length+1!==z.app.developer.app.triggers.size()){formChoices={\"null\":\"None\"};z.app.developer.app.triggers.each(function(trigger){return formChoices[trigger.id]=trigger.get(\"label\")});z.app.developer.form.get(\"test_trigger\").set(\"choices\",formChoices)}this.$el.html(JST.developer_app_trigger_settings(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppAudit=z.ui.Base.extend({context:function(){var errors,warnings;errors=[];_.each(this.options.audit.get(\"errors\"),function(errorsForObject,objectName,array){return errors.push({name:objectName,errors:errorsForObject})});warnings=[];_.each(this.options.audit.get(\"warnings\"),function(warningsForObject,objectName,array){return warnings.push({name:objectName,warnings:warningsForObject})});return{errors:errors,warnings:warnings}},render:function(){this.$el.html(JST.developer_app_audit(this.context()));return this}});z.ui.DeveloperDashboard=z.ui.Base.extend({className:\"dashboard\",initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{activeCount:z.app.developer.apps.where({status:3}).length,inviteCount:z.app.developer.apps.where({status:2}).length,pendingCount:z.app.developer.apps.where({status:1}).length,privateCount:z.app.developer.apps.where({status:0}).length}},render:function(){var activeContainer,inviteContainer,pendingContainer,privateContainer;this.$el.html(JST.developer_dashboard(this.context()));privateContainer=this.$el.find(\".private-developer-apps tbody\");pendingContainer=this.$el.find(\".pending-developer-apps tbody\");inviteContainer=this.$el.find(\".invite-developer-apps tbody\");activeContainer=this.$el.find(\".active-developer-apps tbody\");_.each(z.app.developer.apps.sortBy(\"title\"),function(app){var view;view=new z.ui.DeveloperAppSummary({model:app});if(app.get(\"status\")===0){return privateContainer.append(view.render().el)}else if(app.get(\"status\")===1){return pendingContainer.append(view.render().el)}else if(app.get(\"status\")===2){return inviteContainer.append(view.render().el)}else{return activeContainer.append(view.render().el)}},this);return this}});z.ui.DeveloperAppActions=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_actions(this.context()));z.app.developer.app.actions.sort();return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.actions,z.ui.DeveloperAppActionSummary,JST.developer_app_actions_empty_section])}});z.ui.DeveloperAppStats=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_stats(this.context()));return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.stats(),z.ui.DeveloperAppStatsSummary])}});z.ui.DeveloperAppStatsSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{stat:this.model.toJSON()}},render:function(){this.$el.html(JST.developer_app_stats_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppActionFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_action_field_table_row(this.context()));return this}});z.ui.DeveloperAppActionFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"action field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_edit_action_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var actionId,appId,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){this.options.action.fields.add(model)}appId=z.app.developer.app.get(\"id\");actionId=this.options.action.get(\"id\");Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+appId+\"/actions/\"+actionId+\"/fields\",{trigger:true})}});z.ui.DeveloperAppActionSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{action:this.model.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_action_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.SelectfillModal=z.ui.Base.extend({className:\"selectfill-wrapper select\",STILL_LOADING:[[\"Loading choices ...\",\"Still loading choices ...\",\"Still still loading choices (hang tight, can take a minute) ...\"],[\"Knocking on {{#plural}}{{service}}{{/plural}} door ...\",\"Waiting for {{service}} to answer ...\",\"Still waiting on {{service}} (stick with us; can take a few minutes) ...\"],[\"Releasing the carrier pigeons ...\",\"Waiting for the pigeons to return ...\",\"Still waiting on the pigeons (stick with us; can take a few minutes) ...\"],[\"Commence thumb twiddling ...\",\"{{service}} is sure taking their time ...\",\"Still twiddling thumbs (stick with us; can take a few minutes) ...\"]],events:{\"mousedown li\":\"clickField\",\"mousemove li\":\"mousemove\",\"mousedown li.custom-value\":\"customValue\",\"mousedown li.placeholder-value\":\"placeholderValue\"},initialize:function(options){var i,_ref,_ref2,_ref3,_ref4,_this=this;this.options=options;_.bindAll(this);this.hideRawValue=(_ref=this.options)!=null?_ref.hideRawValue:void 0;this.target=(_ref2=this.options)!=null?_ref2.target:void 0;this.choices=this.getChoices((_ref3=this.options)!=null?_ref3.choices:void 0);this.current=(_ref4=this.options)!=null?_ref4.current:void 0;$(document).on(\"keydown\",this.keydown);i=_.random(0,this.STILL_LOADING.length-1);this.loadingMsg=this.STILL_LOADING[i];return this.on(\"remove\",function(){$(document).off(\"keydown\",_this.keydown);return z.useful.noBGScrollOff(_this.$el)})},getChoices:function(choices){var k,newChoices,v,_i,_len;newChoices=[];if(!_.isArray(choices)){for(k in choices){v=choices[k];newChoices.push({key:k,display:v,val:k})}}else if(_.isArray(choices)&&_.any(choices,function(i){return _.isString(i)})){for(_i=0,_len=choices.length;_i<_len;_i++){v=choices[_i];newChoices.push({key:v,display:v,val:null})}}else{newChoices=choices}this.setMode(\"show\",\"empty-value\");return _.filter(newChoices,function(choice){return Boolean(choice.key)})},parseGives:function(gives){var choices,_this=this;choices=gives!=null?gives.map(function(give){return{key:give.getKey(),display:give.getLabel(),val:give.getSample(),type:give.get(\"type\")}}):void 0;choices=choices!=null?choices.filter(function(choice){return!_.str.include(choice.key,\"zap_meta\")}):void 0;return _.filter(choices,function(choice){return Boolean(choice.key)})},context:function(){var context,_ref,_ref2,_ref3;context={choices:this.choices,fancychoices:(_ref=this.options.options)!=null?_ref.fancychoices:void 0,hideRawValue:this.hideRawValue};if(this.node!=null||((_ref2=this.options)!=null?_ref2.useGives:void 0)){context.loadingMsg=this.loadingMsg;context.service=(_ref3=z.app.services.get(this.node.get(\"selected_api\")))!=null?_ref3.getName():void 0}return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_selectfill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"min-width\",this.modal.targetWidth());return this},highlightDefault:function(){var $el,_this=this;this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").filter(function(i,el){return $(el).attr(\"data-key\")===_this.current});if(this.current!=null&&($el!=null?$el.length:void 0)>0){$el.addClass(\"hover\")}else{this.$(\"li:not(.hide)\").first().addClass(\"hover\")}if(this.current!=null&&($el!=null?$el.length:void 0)>0){return _.defer(function(){return _this.$el.scrollTo($el)})}},clickField:function(e){var $el,display,id,key,val,_ref;if(e!=null)e.preventDefault();$el=this.$(\"li.hover\").first();key=$el.attr(\"data-key\");display=$el.attr(\"data-display\");val=$el.attr(\"data-val\");id=$el.attr(\"data-id\");if(id===\"load-more\"||id===\"custom-value\"||id===\"placeholder-value\"){return}if((_ref=this.options)!=null){if(typeof _ref.pick===\"function\"){_ref.pick({key:key,display:display,val:val})}}return this.modal.close()},mousemove:function(e){this.$(\"li\").removeClass(\"hover\");return this.$(e.currentTarget).addClass(\"hover\")\n},keydown:function(e){if(e.keyCode===13)this.clickField(e);if(e.keyCode===38)this.moveUp(e);if(e.keyCode===40)this.moveDown(e);if(e.keyCode===9)return this.modal.close()},moveUp:function(e){var $el,h,idx;if(e!=null)e.preventDefault();idx=this.$(\"li.hover\").index();this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").eq(idx).prevAll(\"li:not(.hide)\").eq(0).addClass(\"hover\");if(this.$(\"li.hover\").length===0){$el=this.$(\"li:not(.hide)\").first().addClass(\"hover\")}h=$el.outerHeight();if(($el!=null?$el.length:void 0)>0&&this.highlightOutOfView()){return this.$el.scrollTo({left:\"=0px\",top:\"-=\"+h})}},moveDown:function(e){var $el,h,idx;if(e!=null)e.preventDefault();idx=this.$(\"li.hover\").index();this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").eq(idx).nextAll(\"li:not(.hide)\").first().addClass(\"hover\");if(this.$(\"li.hover\").length===0){$el=this.$(\"li:not(.hide)\").last().addClass(\"hover\")}h=$el.outerHeight();if(($el!=null?$el.length:void 0)>0&&this.highlightOutOfView()){return this.$el.scrollTo({left:\"+=0px\",top:\"+=\"+h})}},highlightOutOfView:function(){var $el,frameHeight,frameScrollTop,outBottom,outTop,targetHeight,targetScrollTop;$el=this.$(\"li.hover\");if($el.length===0)return;frameScrollTop=this.$el.scrollTop();frameHeight=this.$el.innerHeight();targetScrollTop=$el.position().top;targetHeight=$el.innerHeight();outBottom=targetScrollTop+targetHeight>frameHeight;outTop=targetScrollTop<0;return outBottom||outTop},customValue:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();if((_ref=this.options)!=null){if((_ref2=_ref.options)!=null){if(typeof _ref2.custom===\"function\")_ref2.custom()}}return this.modal.close()},placeholderValue:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();if((_ref=this.options)!=null){if((_ref2=_ref.options)!=null){if(typeof _ref2.placeholder===\"function\")_ref2.placeholder()}}return this.modal.close()}});z.ui.PrefillModal=z.ui.SelectfillModal.extend({className:\"prefill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"keyup input.searcher\":\"search\",\"mousedown li.load-more\":\"loadMore\"})},initialize:function(options){var _ref;this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=this.options.node;this.formRow=this.options.formRow;this.prefill=this.options.prefill;this.samples=options.samples;this.fixedChoices=z.ui.SelectfillModal.prototype.getChoices.apply(this,[(_ref=this.options)!=null?_ref.fixedChoices:void 0]);this.lastSamplesLength=0;if(this.samples.allLoaded)this.setMode(\"hide\",\"load-more\");return this.state.on(\"change:choices\",this.render,this)},getChoices:function(choices){var k,newChoices,v;newChoices=[];for(k in choices){v=choices[k];newChoices.push({key:k,display:v,val:k})}return _.filter(newChoices,function(choice){return Boolean(choice.key)})},context:function(){var choices,context,_ref;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);choices=((_ref=this.fixedChoices)!=null?_ref.length:void 0)>0?this.fixedChoices.concat(this.choices):this.choices;context=_.extend(context,{choices:choices,search:this.searchString,trigger:this.node.isRead()});return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_prefill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"width\",this.modal.targetWidth());return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_ref,_ref2,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);options={success:function(map){var _ref,_ref2;_this.choices=_this.getChoices(map);clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");if(_this.samples.length<=_this.lastSamplesLength){_this.setMode(\"hide\",\"load-more\");_this.samples.allLoaded=true}_this.lastSamplesLength=_this.samples.length;return(_ref=_this.options.options)!=null?(_ref2=_ref.success)!=null?_ref2.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2;_this.error=z.useful.errors(xhr);clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");_this.setMode(\"hide\",\"load-more\");return(_ref=_this.options.options)!=null?(_ref2=_ref.error)!=null?_ref2.apply(_this,arguments):void 0:void 0}};if(!(((_ref=this.formRow)!=null?_ref.collection:void 0)!=null)){return(_ref2=this.modal)!=null?_ref2.close():void 0}return this.samples.prefillMap(this.prefill,this.formRow.collection.getValues(),options)},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)},loadMore:function(e){if(e!=null)e.preventDefault();this.samples.setPage(this.samples.getPage()+1);return this.loadChoices()}});z.ui.UserfillModal=z.ui.SelectfillModal.extend({className:\"userfill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"click button.missing\":\"clickMissing\",\"keyup input.searcher\":\"search\"})},initialize:function(options){this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=this.options.node;this.missing=false;return this.state.on(\"change:choices\",this.render,this)},context:function(){var context;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);context=_.extend(context,{choices:this.choices,missing:this.missing,search:this.searchString});return context},render:function(){var context,_ref;context=this.context();this.$el.html(JST.editor_userfill_modal(context));z.useful.noBGScroll(this.$el);if((_ref=this.options.options)!=null?_ref.flexWidth:void 0){this.$el.css(\"width\",this.modal.targetWidth())}return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);this.gives=new z.model.FieldSet([],{node:this.node});options={data:{zap_meta_limit:3,zap_meta_hydrate:true},success:function(model,json,resp){var _ref,_ref2,_ref3,_ref4,_ref5;_this.setMode(\"hide\",\"empty-value\");_this.choices=_this.parseGives(model);if(_this.choices.length===0){_this.modal.close();return(_ref=_this.options.options)!=null?(_ref2=_ref.missing)!=null?_ref2.apply(_this,arguments):void 0:void 0}_this.missing=(resp!=null?(_ref3=resp.xhr)!=null?_ref3.status:void 0:void 0)===206;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");return(_ref4=_this.options.options)!=null?(_ref5=_ref4.success)!=null?_ref5.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");_this.modal.close();return(_ref=_this.options.options)!=null?(_ref2=_ref.error)!=null?_ref2.apply(_this,arguments):void 0:void 0}};return this.gives.fetch(options)},clickMissing:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.options)!=null?(_ref2=_ref.missing)!=null?_ref2.apply(this,arguments):void 0:void 0},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)}});z.ui.GivefillModal=z.ui.SelectfillModal.extend({className:\"givefill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"keyup input.searcher\":\"search\"})},initialize:function(options){var _ref;this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=(_ref=this.options)!=null?_ref.node:void 0;return this.state.on(\"change:choices\",this.render,this)},context:function(){var context;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);context=_.extend(context,{search:this.searchString});return context},render:function(){var context,_ref;context=this.context();this.$el.html(JST.editor_givefill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"width\",(_ref=$(this.options.target))!=null?_ref.outerWidth():void 0);return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);this.gives=new z.model.FieldSet([],{node:this.node});options={data:{zap_meta_limit:3,zap_meta_hydrate:true},success:function(model,json,resp){var _ref,_ref2,_ref3,_ref4,_ref5;_this.choices=_this.parseGives(model);if(_this.choices.length===0){if((_ref=_this.modal)!=null)_ref.close();return(_ref2=_this.options.options)!=null?(_ref3=_ref2.missing)!=null?_ref3.apply(_this,arguments):void 0:void 0}clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");return(_ref4=_this.options.options)!=null?(_ref5=_ref4.success)!=null?_ref5.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2,_ref3;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");if((_ref=_this.modal)!=null)_ref.close();return(_ref2=_this.options.options)!=null?(_ref3=_ref2.error)!=null?_ref3.apply(_this,arguments):void 0:void 0}};return this.gives.fetch(options)},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)}});z.ui.MissingDataModal=z.ui.Base.extend({className:\"missing-data\",events:{\"click .active>button\":\"buttonClick\",\"click .webhook-url\":\"highlight\"},initialize:function(options){var action,read,readService,service,_this=this;this.options=options;_.bindAll(this);this.samples=new z.model.SampleSet([],{node:z.app.read});service=z.app.services.get(z.app.read.get(\"selected_api\"));action=z.app.read.get(\"action\");this.isHook=service!=null?service.isHook(action,\"read\"):void 0;this.notSubHook=!(service!=null?service.isSubHook(action,\"read\"):void 0);this.step=this.isHook?1:2;read=z.app.read.toJSON();readService=z.app.services.get(z.app.read.get(\"selected_api\"));if(readService.isSubHook(read.action,\"read\")){this.initHook();return this.on(\"remove\",function(){return z.app.read.tearDownHook()})}},initHook:function(){var success,_this=this;this.initConnection=true;success=function(){_this.initConnection=false;return _this.render()};return z.app.read.subscribeHook({success:function(model,resp){return success()},error:function(model,xhr){var context,html;if((xhr!=null?xhr.status:void 0)===409)return success();_this.initConnection=false;_this.close();context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_hook_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},context:function(){var action,context,read,service;read=z.app.read.toJSON();service=z.app.services.get(z.app.read.get(\"selected_api\"));action=z.app.read.get(\"action\");context={read:read,readModel:z.app.read,service:service,step:this.step,initConnection:this.initConnection,filters:this.getFilterTable(),action:action,isHook:this.isHook,notSubHook:this.notSubHook};return context},renderClipboard:function(){var $el,clip,_this=this;$el=this.$(\".copy-button\");if($el){clip=new z.useful.clipboard($el);clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)});return this.modal.on(\"reposition\",function(){return clip.reposition()})}},render:function(){this.$el.html(JST.editor_missing_data_modal(this.context()));this.renderClipboard();return this},getFilterTable:function(){var _this=this;return _.compact(z.app.readNeeds.map(function(i){var f,k,v;if(i.isListParent())return false;k=i.getLabel();v=i.getDisplay();f=i.get(\"input_format\");if(f!=null){if((f!=null?f[0]:void 0)!=null)v=f[0]+v;if((f!=null?f[2]:void 0)!=null)v=v+f[2];v=_.template(v)({cid:z.app.account.id,ccode:z.app.account.get(\"code\")})}if(v!=null){return{k:k,v:v}}return false}))},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},buttonClick:function(e){var step;if(e!=null)e.preventDefault();step=this.$(e.currentTarget).attr(\"data-step\");if(step===\"1\")this.nextStep(e);if(this.isHook){if(step===\"2\"){this.nextStep(e);this.waitForData(e)}if(step===\"4\")return this.done(e)}else{if(step===\"2\")this.nextStep(e);if(step===\"3\")this.loadData(e);if(step===\"4\")return this.done(e)}},nextStep:function(e){this.step+=1;return this.render()},waitForData:function(e){var _this=this;this.sampleInterval=setInterval(function(){return _this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},z.app.read.getParams()),success:function(model,json,resp){if(model.length>0){_this.setMode(\"hide\",\"loading-samples\");_this.setMode(\"show\",\"found-samples\");clearInterval(_this.sampleInterval);return _this.nextStep()}},error:function(model,xhr){var context,html;clearInterval(_this.sampleInterval);context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},5e3);return this.on(\"remove\",function(){return clearInterval(_this.sampleInterval)})},loadData:function(e){var _this=this;if(this.$(e.currentTarget).hasClass(\"disabled\"))return;this.$(e.currentTarget).text(\"Loading...\").addClass(\"disabled\");this.setMode(\"hide\",\"no-samples\");return this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},z.app.read.getParams()),success:function(model,json,resp){if(model.length>0){return _this.nextStep()}else{_this.setMode(\"show\",\"no-samples\");return _this.render()}},error:function(model,xhr){var context,html;context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},done:function(e){var _ref;if((_ref=this.options)!=null){if(typeof _ref.success===\"function\")_ref.success()}return this.close()},close:function(){return this.modal.close()}});z.ui.CustomFilterRow=z.ui.Base.extend({className:\"advanced-filter\",events:{\"click .remove\":\"destroy\",\"change .field-value input\":\"updateModel\"},initialize:function(options){var fields,_this=this;_.bindAll(this);_.defaults(this,options);this.model=options.rule;this.model.on(\"destroy\",function(){return _this.remove()},this);this.model.on(\"change\",this.render,this);this.matchChoices={iexact:\"(Text) Exactly matches\",\"not-iexact\":\"(Text) Does not exactly match\",icontains:\"(Text) Contains\",\"not-icontains\":\"(Text) Does not contain\",istartswith:\"(Text) Starts with\",\"not-istartswith\":\"(Text) Does not start with\",iendswith:\"(Text) Ends with\",\"not-iendswith\":\"(Text) Does not end with\",igreater:\"(Number) Greater than\",iless:\"(Number) Less than\",idategreater:\"(Date/time) Greater than\",idateless:\"(Date/time) Less than\",idateequal:\"(Date/time) Equals\",iexist:\"Exists\",\"not-iexist\":\"Does not exist\"};fields=[{key:\"key\",type:\"select\",hideLabel:true,givefill:{node:z.app.read},value:this.model.get(\"key\")!=null?this.model.get(\"key\"):void 0,placeholder:\"Key\"},{key:\"match\",hideLabel:true,type:\"select\",hideRawValue:true,choices:this.matchChoices,placeholder:\"Matches\"},{key:\"value\",type:\"unicode\",hideLabel:true,required:false,value:this.model.get(\"value\")!=null?this.model.get(\"value\"):void 0,placeholder:\"Value\"}];this.form=new z.model.FormSet(fields);this.paramform=new z.ui.ParamForm({form:this.form});return _.each(this.form.models,function(row){if(row.options.type===\"select\"){return row.on(\"change\",_this.updateModel,_this)}})},context:function(){var context;context={group:this.model.get(\"group\"),index:this.index};return context},render:function(){var match;this.$el.html(JST.editor_custom_filter_row(this.context()));this.$(\"paramform\").replaceWith(this.paramform.render().el);match=this.model.get(\"match\");if(match===\"iexist\"){this.setMode(\"hide\",\"field-value\")}else{this.setMode(\"show\",\"field-value\")}if(this.model.get(\"action\")===\"stop\")match=\"not-\"+match;this.$(\".field-match input\").val(this.matchChoices[match]);return this},destroy:function(){return this.model.destroy()},updateModel:function(){var action,check,data,fields,key,match,value;key=this.$(\".field-key input\").val();match=_.invert(this.matchChoices)[this.$(\".field-match input\").val()];value=this.$(\".field-value input\").val();action=\"continue\";if(_.str.startsWith(match,\"not-\")){match=match.replace(\"not-\",\"\");action=\"stop\"}data={key:key,match:match,value:value,action:action};this.model.set(data);fields=[key,match,action];check=_.all(fields,function(field){if(field!=null&&field!==\"\")return true});if(check)this.model.save();if(match===\"iexist\"){return this.setMode(\"hide\",\"field-value\")}else{return this.setMode(\"show\",\"field-value\")}}});z.ui.TestStep=z.ui.Base.extend({className:\"test-zap\",events:{\"click .skip a\":\"skip\",\"click .load\":\"load\",\"click .webhook-url\":\"highlightWebhook\",\"click [data-sample-read-id]\":\"openReadData\",\"click [data-sample-write-id]\":\"openWriteData\",\"click .continue\":\"continue\",\"click [data-send-sample-id]\":\"send\",\"click .custom-filters\":\"scrollToFilters\"},initialize:function(options){var render,stale;this.options=options;_.bindAll(this);this.read=this.options.read;this.write=this.options.write;this.writeNeeds=this.options.writeNeeds;this.readNeeds=this.options.readNeeds;this.rules=this.options.rules;render=_.debounce(this.render,40);stale=_.debounce(this.stale,40);this.read.on(\"change:selected_api change:authentication_id change:action\",render,this);this.read.on(\"change:selected_api change:authentication_id change:action\",stale,this);this.rules.on(\"change add remove\",stale,this);this.readNeeds.on(\"change\",render,this);this.writeNeeds.on(\"change\",render,this);this.samples=new z.model.SampleSet([],{node:z.app.read});this.samples.on(\"reset\",render,this);return this.setMode(\"no\",\"samples\")},context:function(){var authValid,context,readService,show,writeService,_ref,_this=this;readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));authValid=this.read.get(\"authentication_id\")!=null||!(readService!=null?readService.needsAuth():void 0);show=this.readNeeds.isValid()&&authValid&&this.writeNeeds.isValid();if((_ref=this.samples)!=null){_ref.each(function(sample,i){var action,noun;noun=_this.read.getActionNoun();sample.num=i+1;sample.readSummary=sample.summary(sample.toJSON(),{\"default\":\"Sample \"+noun});action=_this.write.getActionLabel();return sample.writeSummary=sample.summary(sample.buildWrite(_this.write.get(\"params\")),{\"default\":action})})}context={flow:this.options.flow,show:show,readService:readService,writeService:writeService,readNoun:this.read.getActionNoun(),samples:this.samples,filters:_.compact(this.readNeeds.map(function(i){var k,v;if(i.isListParent())return false;k=i.getLabel();v=i.getDisplay();if(v!=null){return{k:k,v:v}}return false}))};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_test(context));return this},skip:function(e){if(e!=null)e.preventDefault();this.setMode(\"hide\",\"skip\");return z.app.editor.next(this)},stale:function(){this.samples.reset();return this.setMode(\"no\",\"samples\")},load:function(e,cache){var loadFields,loadSamples,_this=this;if(cache==null)cache=false;if(e!=null)e.preventDefault();if(this.hasMode(\"loading\",\"samples\"))return;this.$(\".load\").text(\"Loading...\");this.loadingTimer=_.delay(function(){return _this.$(\".load\").text(\"Still Loading...\")},3e3);this.setMode(\"loading\",\"samples\");loadSamples=function(cb){return _this.samples.fetch({cache:cache,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:3},_this.read.getParams()),success:function(model,json,resp){if(model.length>0){return typeof cb===\"function\"?cb():void 0}else{clearInterval(_this.loadingTimer);_this.setMode(\"no\",\"samples\");return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal({success:function(){return _this.load.apply(_this,[e,false])}})})}},error:function(model,xhr){var context,html,modal;_this.setMode(\"no\",\"samples\");clearInterval(_this.loadingTimer);context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})};loadFields=function(cb){_this.fields=new z.model.FieldSet([],{node:z.app.read});return _this.fields.fetch({cache:cache,data:{zap_meta_combine:false},success:function(model,json,resp){return cb()},error:function(model,xhr){var context,html,modal;_this.setMode(\"no\",\"samples\");clearInterval(_this.loadingTimer);context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})};return async.series([loadSamples,loadFields],function(err,results){clearInterval(_this.loadingTimer);_this.setMode(\"loaded\",\"samples\");return _this.render()})},highlightWebhook:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},openReadData:function(e){var customs,data,modal,pos;if(e!=null)e.preventDefault();pos=this.$(e.currentTarget).attr(\"data-sample-read-id\");customs=this.fields.toJSON();data={};_.each(this.samples.at(pos).buildRead(),function(v,k){return data[customs[k]||_.superHumanize(k)]=v});if(data.zap_meta_filter!=null)delete data.zap_meta_filter;return modal=new z.ui.Modal({view:new z.ui.DataTableModal({data:data})})},openWriteData:function(e){var customs,data,modal,pos,rendered;if(e!=null)e.preventDefault();pos=this.$(e.currentTarget).attr(\"data-sample-write-id\");data={};customs=this.fields.toJSON();rendered=this.samples.at(pos).buildWrite(this.write.get(\"params\"));_.each(rendered,function(v,k){return data[customs[k]||_.superHumanize(k)]=v});return modal=new z.ui.Modal({view:new z.ui.DataTableModal({data:data})})},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},send:function(e){var $el,data,options,pos,raw,replaced,sample,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.hasClass(\"working\"))return;pos=$el.attr(\"data-send-sample-id\");sample=this.samples.at(pos);replaced=this.samples.at(pos).buildWrite(this.write.get(\"params\"),{sanitize:false});raw=sample.toJSON();data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");$el.addClass(\"working\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");return $el.removeClass(\"working\")},error:function(model,xhr){var context,html,modal,service,_ref;clearInterval(_this.loadingTimer);service=(_ref=z.app.services.get(_this.write.get(\"selected_api\")))!=null?_ref.getName():void 0;$el.text(\"Send!\");$el.removeClass(\"working\");context={key:_this.write.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};return this.write.write(this.write.get(\"action\"),data,options)},scrollToFilters:function(e){var options;if(e!=null)e.preventDefault();options={offset:{left:0,top:-25}};return $.scrollTo('a[id=\"custom-filters\"]',200,options)}});z.ui.AuthStep=z.ui.Base.extend({className:\"auths\",events:{\"click li.auth\":\"select\",\"click .test\":\"test\",\"click .add\":\"add\",\"click .continue\":\"continue\",\"click .webhook-url\":\"highlight\"},initialize:function(options){var render,renderTest,_this=this;this.options=options;_.bindAll(this);this.model=this.options.isTrigger?this.options.read:this.options.write;render=_.debounce(this.render,40);renderTest=_.debounce(this.renderTest,40);this.setMode(\"disable\",\"continue\");this.model.on(\"change:selected_api\",render,this);this.model.on(\"change:action\",render,this);this.state.on(\"change\",renderTest,this);this.model.on(\"change:authentication_id\",function(){render();return renderTest()},this);z.app.auths.on(\"remove\",function(model){if(model.id===_this.model.get(\"authentication_id\")){return _this.model.save({authentication_id:null},{wait:true})}},this);z.app.auths.on(\"add remove\",render,this);z.app.auths.on(\"change:title\",render,this);return this.on(\"remove\",function(){return _this.$(\"select.auths\").off(\"change\",_this.selectChange)})},get:function(){return this.model.get(\"authentication_id\")},set:function(id){return this.model.save({authentication_id:Number(id)},{wait:true})},unset:function(){return this.model.save({authentication_id:null},{wait:true})},show:function(){return this.checkAutoSelect()},checkAutoSelect:function(){var auths,_ref;auths=z.app.auths.getByKey(this.model.get(\"selected_api\"));if(((_ref=this.options)!=null?_ref.flow:void 0)&&(auths!=null?auths.length:void 0)===1){return this.set(auths[0].id)}},context:function(){var accountSatisfied,action,auths,context,isHook,key,service,which;key=this.model.get(\"selected_api\");service=z.app.services.get(key);action=this.model.get(\"action\");which=this.options.isTrigger?\"read\":\"write\";isHook=(service!=null?service.isHook(action,which):void 0)&&!(service!=null?service.isSubHook(action,which):void 0);accountSatisfied=(service!=null?service.needsAuth():void 0)&&this.get()!=null||!(service!=null?service.needsAuth():void 0);auths=z.app.auths.where({selected_api:this.model.get(\"selected_api\")});context={flow:this.options.flow,key:key,selected:this.get(),testStatus:this.state.get(this.get()),needsAuth:service!=null?service.needsAuth():void 0,isHook:isHook,showContinue:this.options.flow,auths:auths,hasAtLeastOneAuth:z.app.auths.hasAtLeastOneAuth(key),show:this.model.get(\"action\")!=null,service:service,action:action,which:which,model:this.model};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_auth(context));this.renderContinue();this.renderTest();this.initSelect(context);this.renderClipboard();return this},renderClipboard:function(){var $el,action,clip,isHook,key,service,which;key=this.model.get(\"selected_api\");service=z.app.services.get(key);action=this.model.get(\"action\");which=this.options.isTrigger?\"read\":\"write\";isHook=(service!=null?service.isHook(action,which):void 0)&&!(service!=null?service.isSubHook(action,which):void 0);if(isHook){$el=this.$(\".copy-button\");clip=new z.useful.clipboard($el);return clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)})}},initSelect:function(context){this.$(\"select.auths\").select2({containerCssClass:\"select2-editor-auth larger\",dropdownCssClass:\"select2-editor-auth\",formatResult:_.bind(this.formatResult,this,context.service),formatSelection:_.bind(this.formatSelection,this,context.service),escapeMarkup:function(s){return s},matcher:this.matcher});this.$(\"select.auths\").off(\"change\",this.selectChange);return this.$(\"select.auths\").on(\"change\",this.selectChange)},selectChange:function(e){if(e.val===\"new\"){this.$(\"select.auths\").select2(\"val\",this.get());return this.add(e)}else{return this.set(e.val)}},formatResult:function(service,row){return this.formatSelection.apply(this,arguments)},formatSelection:function(service,row){var html,icon,img,text;if(!row.id)return row.text;icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;if(row.id===\"new\"){img=\"fa fa-plus\"}else{img=\"img32 \"+icon}text=_.escape(row.text);html='<i class=\"'+img+'\"></i> <t>'+text+\"</t>\";return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},select:function(e){var id;if(e!=null)e.preventDefault();id=this.$(e.currentTarget).attr(\"id\");if(String(this.get())!==String(id)){return this.set(id)}else{return this.unset()}},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},test:function(e){var auth,error,id,success,_this=this;if(e!=null)e.preventDefault();id=this.get();auth=z.app.auths.get(id);if(this.state.get(id)===\"testing\"||this.state.get(id)===\"slow\")return;this.state.set(id,\"testing\");success=function(){return _this.state.set(id,\"success\")};error=function(model,xhr){var context,errors,modal;errors=z.useful.errors(xhr);_this.state.set(id,\"error\");context={auth:auth,message:errors,type:\"manual\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context)})};z.app.auths.get(id).test({success:success,error:error});return _.delay(function(){if(_this.state.get(id)===\"testing\")return _this.state.set(id,\"slow\")},3e3)},add:function(e){var context,key,modal,service,success,_this=this;if(e!=null)e.preventDefault();key=this.model.get(\"selected_api\");service=z.app.services.get(key);z.app.auths.on(\"add\",function(model){return _this.set(model.id)},this);success=function(auth){_this.state.set(auth.id,\"success\");return z.app.auths.off(\"add\",null,_this)};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},renderContinue:function(){var mode,needsAuth,service;service=z.app.services.get(this.model.get(\"selected_api\"));needsAuth=service!=null?service.needsAuth():true;mode=this.get()!=null||!needsAuth?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},renderTest:function(){var $el,status;status=this.state.get(this.get());$el=this.$(\"button.test\");if(status===\"success\"){$el.removeClass(\"success error\").addClass(\"success\");return $el.replaceWith('<span class=\"success\"><i class=\"fa fa-ok\"></i> Account is working.</span>')}else if(status===\"error\"){$el.removeClass(\"success error\").addClass(\"error\");return $el.text(\"Account not working\")}else if(status===\"testing\"){$el.removeClass(\"success error\");return $el.text(\"Testing...\")}else if(status===\"slow\"){$el.removeClass(\"success error\");return $el.text(\"Still testing...\")}else{$el.text(\"Test this Account\");\nreturn $el.removeClass(\"success error\")}}});z.ui.FilterStep=z.ui.Base.extend({className:\"filters\",events:{\"click button.continue\":\"continue\",\"click button.retry-fields\":\"loadNeeds\",\"click button.or\":\"or\",\"click .custom .add\":\"add\",\"click .show-custom .add\":\"add\"},initialize:function(options){var render,renderContinue,updateModel,updateNeeds,_this=this;this.options=options;_.bindAll(this);this.model=this.options.read;this.readNeeds=this.options.readNeeds;this.rules=this.options.rules;this.setMode(\"disable\",\"continue\");render=_.debounce(this.render,40);renderContinue=_.debounce(this.renderContinue,40);updateModel=_.debounce(this.updateModel,40);updateNeeds=_.debounce(this.updateNeeds,40);this.state.on(\"change:fields\",render,this);this.model.on(\"change:selected_api change:action change:authentication_id\",render,this);this.views=[];this.rules.on(\"add remove reset\",render,this);this.rules.on(\"change\",this.stripAnd,this);this.rules.on(\"change remove\",this.updateRules,this);this.on(\"remove\",function(){_.each(_this.views,function(view){return view.remove()});return _this.views=[]});this.renderGroups();this.paramform=new z.ui.ParamForm({form:this.readNeeds,prettypills:true,fancychoices:true});this.model.on(\"change:action change:authentication_id\",updateNeeds,this);this.readNeeds.on(\"change:value\",renderContinue,this);return this.loadNeedsAndRender()},updateNeeds:function(){var _this=this;return this.loadNeeds({success:function(){return _this.readNeeds.initData({success:function(){return _.defer(function(){return _this.renderForm()})}})}})},loadNeedsAndRender:function(){var _this=this;return this.loadNeeds({success:function(){return _.defer(function(){return _this.renderForm()})}})},loadNeeds:function(options){var _this=this;this.setMode(\"loading\",\"fields\");return this.readNeeds.fetch({cache:false,success:function(model,json,resp){var _ref;_this.setMode(\"loaded\",\"fields\");if((json!=null?json.length:void 0)===0){_this.setMode(\"zero\",\"fields\")}return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref;_this.setMode(\"error\",\"fields\");return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}})},context:function(){var authValid,context,service,show;service=z.app.services.get(this.model.get(\"selected_api\"));authValid=this.model.get(\"authentication_id\")!=null||!(service!=null?service.needsAuth():void 0);show=service!=null&&this.model.get(\"action\")!=null&&authValid;context={state:this.state.toJSON(),flow:this.options.flow,show:show,form:this.readNeeds,read:this.model.toJSON(),service:service};context=_.extend(context,{rules:this.rules});return context},render:function(){var context,groupIds,index,_this=this;context=this.context();this.detachForm();this.$el.html(JST.editor_filter(context));this.attachForm();this.renderContinue();this.$groups=this.$(\".groups\");groupIds=this.rules.getGroups();index=1;_.each(groupIds,function(id,i){var $el,$or,rules;$el=$('<div class=\"group\"></div>').attr(\"data-group\",id);$el.appendTo(_this.$groups);if(i>0){$or=$('<div class=\"or\"></div>').text(\"OR\");$or.insertBefore($el)}rules=_this.rules.where({group:id});return _.each(rules,function(rule){var view;view=new z.ui.CustomFilterRow({rule:rule,samples:_this.samples,index:index});view.render().$el.appendTo($el);_this.views.push(view);return index+=1})});this.stripAnd();this.renderGroups();return this},show:function(){var _ref;return(_ref=this.paramform)!=null?_ref.refreshPrettypills():void 0},detachForm:function(){return this.paramform.$el.detach()},attachForm:function(){return this.$(\"paramform\").replaceWith(this.paramform.$el)},renderForm:function(){return this.paramform.render()},renderContinue:function(){var mode;mode=this.readNeeds.isValid()?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},renderGroups:function(){if(this.rules.length>0){this.setMode(\"show\",\"custom\");return this.setMode(\"hide\",\"custom-toggle\")}else{this.setMode(\"hide\",\"custom\");return this.setMode(\"show\",\"custom-toggle\")}},destroyRules:function(){var _this=this;return this.rules.each(function(rule){return rule.destroy()})},stripAnd:function(){return this.$(\".group\").each(function(){return $(this).find(\".and\").last().text(\"\")})},updateRules:function(){var ids;ids=_.compact(this.rules.pluck(\"id\"));return this.options.read.set({rule_ids:ids},{silent:true})},add:function(e){var id,rule;if(e!=null)e.preventDefault();id=this.$(e.currentTarget).attr(\"data-group\");if(!(id!=null))id=this.rules.getMaxGroup();rule=new z.model.Rule({group:Number(id)});rule.setRead(this.options.read);return this.rules.add(rule)},or:function(e){var id,rule;if(e!=null)e.preventDefault();id=this.rules.getMaxGroup()+1;rule=new z.model.Rule({group:Number(id)});rule.setRead(this.options.read);return this.rules.add(rule)}});z.ui.MapStep=z.ui.Base.extend({className:\"map\",events:{\"click button\":\"continue\",\"click button.retry-fields\":\"loadNeeds\",\"click .enable-live-preview\":\"enableLivePreview\"},initialize:function(options){var insertPreviewContainer,loadNeedsAndRender,render,renderContinue,renderPreview,updateModel,updateNeeds,_this=this;this.options=options;_.bindAll(this);this.model=this.options.write;this.read=this.options.read;this.readNeeds=this.options.readNeeds;this.writeNeeds=this.options.writeNeeds;this.setMode(\"disable\",\"continue\");render=_.debounce(this.render,40);renderContinue=_.debounce(this.renderContinue,40);updateModel=_.debounce(this.updateModel,40);loadNeedsAndRender=_.debounce(this.loadNeedsAndRender,40);updateNeeds=_.debounce(this.updateNeeds,40);renderPreview=_.debounce(this.renderPreview,40);insertPreviewContainer=_.debounce(this.insertPreviewContainer,40);this.read.on(\"change:selected_api change:action change:authentication_id\",render,this);this.model.on(\"change:selected_api change:action change:authentication_id\",render,this);this.samples=new z.model.SampleSet([],{node:z.app.read});this.writeNeeds.on(\"change:value\",function(){return renderPreview()},this);this.writeNeeds.on(\"add\",function(){insertPreviewContainer();return renderPreview()},this);this.samples.on(\"reset\",renderPreview,this);this.read.on(\"change:selected_api change:action change:authentication_id\",function(){return _this.samples.reset()},this);this.read.on(\"change:selected_api\",function(){return _this.renderForm()},this);this.paramform=new z.ui.ParamForm({form:this.writeNeeds,prettypills:true,fancychoices:true,userfill:{\"class\":this.userfillClass,node:this.read}});this.model.on(\"change:action change:authentication_id\",updateNeeds,this);this.readNeeds.on(\"change:value\",render,this);this.writeNeeds.on(\"change:value\",renderContinue,this);this.writeNeeds.on(\"prefill\",updateNeeds,this);this.writeNeeds.on(\"change:value\",renderContinue,this);loadNeedsAndRender();return this.on(\"remove\",function(){var _ref;return(_ref=_this.paramform)!=null?_ref.remove():void 0},this)},updateNeeds:function(){var _this=this;return this.loadNeeds({success:function(){return _this.writeNeeds.initData({success:function(){return _.defer(function(){return _this.renderForm()})}})}})},loadNeedsAndRender:function(){var _this=this;return this.loadNeeds({success:function(){return _.defer(function(){return _this.renderForm()})}})},loadNeeds:function(options){var _this=this;this.setMode(\"loading\",\"fields\");return this.writeNeeds.fetch({cache:false,success:function(model,json,resp){var _ref,_ref2;_this.setMode(\"loaded\",\"fields\");if((resp!=null?(_ref=resp.xhr)!=null?_ref.status:void 0:void 0)===206){_this.setMode(\"error\",\"fields\")}if((json!=null?json.length:void 0)===0){_this.setMode(\"zero\",\"fields\")}return options!=null?(_ref2=options.success)!=null?_ref2.apply(_this,arguments):void 0:void 0},error:function(){var _ref;_this.setMode(\"error\",\"fields\");return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}})},context:function(){var authValid,context,readAction,readNeedsValid,readService,show,writeAction,writeService;readService=z.app.services.get(this.read.get(\"selected_api\"));readAction=readService!=null?readService.getActionName(this.read.get(\"action\"),\"read\",\"true\"):void 0;writeService=z.app.services.get(this.model.get(\"selected_api\"));writeAction=writeService!=null?writeService.getActionName(this.model.get(\"action\"),\"write\",\"true\"):void 0;readNeedsValid=this.readNeeds.isValid();authValid=this.model.get(\"authentication_id\")!=null||!(writeService!=null?writeService.needsAuth():void 0);show=readService!=null&&readAction!=null&&writeService!=null&&writeAction!=null&&readNeedsValid&&authValid;context={state:this.state.toJSON(),flow:this.options.flow,show:show,form:this.writeNeeds,service:writeService,write:this.model.toJSON(),readService:readService,readAction:readAction,writeService:writeService,writeAction:writeAction};return context},render:function(){var context;context=this.context();this.detachForm();this.$el.html(JST.editor_map(context));this.attachForm();this.renderContinue();return this},show:function(){var _ref;return(_ref=this.paramform)!=null?_ref.refreshPrettypills():void 0},detachForm:function(){return this.paramform.$el.detach()},attachForm:function(){return this.$(\"paramform\").replaceWith(this.paramform.$el)},renderForm:function(){this.paramform.render();this.insertPreviewContainer();return this.renderPreview()},userfillClass:function(){var readService;readService=z.app.services.get(this.read.get(\"selected_api\"));return readService.getImageClass(\"16x16\")},renderContinue:function(){var mode;mode=this.writeNeeds.isValid()&&this.hasMode(\"loaded\",\"fields\")?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},insertPreviewContainer:function(){var _this=this;return this.paramform.$el.find(\".input\").each(function(i,el){var _ref;if(((_ref=$(el).parent().find(\".live-preview\"))!=null?_ref.length:void 0)===0){return $(el).parent().append($('<div class=\"live-preview hide\"></div>'))}})},renderPreview:function(){var sample,_this=this;sample=false;if(this.samples.length>0)sample=this.samples.at(0);return this.writeNeeds.each(function(field){var $el,key,map,value;key=field.get(\"key\");$el=_this.paramform.$el.find(\".field-\"+_.slugify(key)+\" .live-preview\");if(field.get(\"prefill\")!=null){}else if(field.get(\"input_format\")!=null){return $el.remove()}else if(!sample&&!(field.get(\"prefill\")!=null)){$el.html('<a class=\"enable-live-preview\">Preview this field with sample data.</a>');return $el.removeClass(\"hide\")}else if(field.getValue()!=null&&field.getValue()!==\"\"){map=sample.buildWrite({sample:field.getValue()},{sanitize:true});value=map.sample;$el.html($(\"<div/>\").text(value).html().split(\" \").join(\"&nbsp;\").split(\"\\n\").join(\"<br>\"));return $el.removeClass(\"hide\")}else{$el.html(\"<em>Add text and/or placeholders to the field above to preview.</em>\");return $el.removeClass(\"hide\")}})},enableLivePreview:function(e){var showMissing,_ref,_this=this;e.preventDefault();if(this.$(e.currentTarget).hasClass(\"disabled\"))return;if((_ref=this.samples)!=null?_ref.length:void 0){return this.renderContinue()}showMissing=function(){var _ref2;_this.$(e.currentTarget).text(\"Preview this field with sample data.\").removeClass(\"disabled\");if(!((_ref2=_this.samples)!=null?_ref2.length:void 0)){return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal({success:function(){return _this.renderContinue()}})})}};this.$(e.currentTarget).text(\"loading sample data to preview...\").addClass(\"disabled\");return this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},this.read.getParams()),success:function(model,json,resp){if(model.length>0){}else{return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal})}},error:function(model,xhr){var context,html,modal;context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})}});z.ui.ServiceActionStep=z.ui.Base.extend({className:\"step services-actions\",events:{\"change #trigger-service\":\"changeService\",\"change #action-service\":\"changeService\",\"change #trigger\":\"changeAction\",\"change #action\":\"changeAction\",\"click button\":\"continue\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.setMode(\"disable\",\"continue\");this.setMode(\"hide\",\"triggers\");this.setMode(\"hide\",\"actions\");z.app.read.on(\"change:selected_api change:action\",this.render,this);z.app.write.on(\"change:selected_api change:action\",this.render,this);this.buildServiceMatchIndex();this.state.on(\"change:saving\",this.renderLocks,this);this.state.set({showTriggerAll:false,showActionAll:false});$(document).on(\"mouseenter\",\".right li.select2-result-selectable\",this.showActionCard);$(document).on(\"mouseenter\",\".left li.select2-result-selectable\",this.showTriggerCard);$(document).on(\"mouseleave\",\"li.select2-result-selectable\",this.hideCards);$(document).on(\"keypress\",\".select2-editor-service input.select2-input\",this.hideCards);return this.on(\"remove\",function(){$(document).off(\"mouseenter\",\".right li.select2-result-selectable\",_this.showActionCard);$(document).off(\"mouseenter\",\".left li.select2-result-selectable\",_this.showTriggerCard);$(document).off(\"mouseleave\",\"li.select2-result-selectable\",_this.hideCards);return $(document).off(\"keypress\",\".select2-editor-service input.select2-input\",_this.hideCards)})},context:function(){var context,readAction,readActions,showActionExpand,showTriggerExpand,writeAction,writeActions,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;this.readServices=z.app.services.filter(function(service){var _ref;if(z.app.read.get(\"selected_api\")===service.get(\"key\"))return true;if(!service.hasReads())return false;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.writeServices=z.app.services.filter(function(service){var _ref;if(z.app.write.get(\"selected_api\")===service.get(\"key\"))return true;if(!service.hasWrites())return false;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.readService=z.app.services.get(this.options.read.get(\"selected_api\"));this.writeService=z.app.services.get(this.options.write.get(\"selected_api\"));readAction=this.options.read.get(\"action\");this.readActions=(_ref=this.readService)!=null?typeof _ref.getActions===\"function\"?_ref.getActions(\"read\",readAction):void 0:void 0;if(readAction!=null&&this.readService!=null&&!this.readService.isActionImportant(\"read\",readAction)){this.state.set({showTriggerAll:true})}writeAction=this.options.write.get(\"action\");this.writeActions=(_ref2=this.writeService)!=null?typeof _ref2.getActions===\"function\"?_ref2.getActions(\"write\",writeAction):void 0:void 0;if(writeAction!=null&&this.writeService!=null&&!this.writeService.isActionImportant(\"write\",writeAction)){this.state.set({showActionAll:true})}if(!this.state.get(\"showTriggerAll\")){readActions=_.filter(this.readActions,function(action){return action.important});if(((_ref3=this.readActions)!=null?_ref3.length:void 0)!==(readActions!=null?readActions.length:void 0)){showTriggerExpand=true}this.readActions=readActions}if(!this.state.get(\"showActionAll\")){writeActions=_.filter(this.writeActions,function(action){return action.important});if(((_ref4=this.writeActions)!=null?_ref4.length:void 0)!==(writeActions!=null?writeActions.length:void 0)){showActionExpand=true}this.writeActions=writeActions}context={readServices:this.readServices,readActions:this.readActions,writeServices:this.writeServices,writeActions:this.writeActions,showTriggerExpand:showTriggerExpand,showActionExpand:showActionExpand,flow:this.options.flow,partnerService:(_ref5=z.app.services.get((_ref6=z.app.partner.get(\"zap\"))!=null?_ref6.selected_api:void 0))!=null?_ref5.getName():void 0,isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_service_action(context));this.$(\"#trigger-service\").val(this.options.read.get(\"selected_api\"));this.$(\"#action-service\").val(this.options.write.get(\"selected_api\"));this.$(\"#trigger-service\").select2({containerCssClass:\"select2-editor-service larger\",dropdownCssClass:\"select2-editor-service wide left\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcherService});this.$(\"#action-service\").select2({containerCssClass:\"select2-editor-service larger\",dropdownCssClass:\"select2-editor-service wide right\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcherService});this.$(\"#trigger\").val(this.options.read.get(\"action\"));this.$(\"#action\").val(this.options.write.get(\"action\"));this.$(\"#trigger\").select2({containerCssClass:\"select2-editor-action\",dropdownCssClass:\"select2-editor-action wide left\",formatResult:_.bind(this.actionFormatResult,this,this.readService),formatSelection:_.bind(this.actionFormatSelection,this,this.readService),escapeMarkup:function(s){return s},matcher:this.matcher});this.$(\"#action\").select2({containerCssClass:\"select2-editor-action\",dropdownCssClass:\"select2-editor-action wide right\",formatResult:_.bind(this.actionFormatResult,this,this.writeService),formatSelection:_.bind(this.actionFormatSelection,this,this.writeService),escapeMarkup:function(s){return s},matcher:this.matcher});if(this.readService!=null)this.setMode(\"show\",\"triggers\");if(this.writeService!=null)this.setMode(\"show\",\"actions\");this.renderContinue();this.renderLocks();return this},renderLocks:function(){if(this.hasMode(\"is\",\"saving\")){this.$(\".picker.services .trigger select\").select2(\"disable\");this.$(\".picker.services .action select\").select2(\"disable\");this.$(\"select#trigger\").select2(\"disable\");return this.$(\"select#action\").select2(\"disable\")}else{this.$(\".picker.services .trigger select\").select2(\"enable\");this.$(\".picker.services .action select\").select2(\"enable\");this.$(\"select#trigger\").select2(\"enable\");return this.$(\"select#action\").select2(\"enable\")}},showActionCard:function(e){var _this=this;clearTimeout(this.actionCardTimeout);return this.actionCardTimeout=_.delay(function(){var actions,key,view;key=$(e.currentTarget).find(\"t[data-id]\").attr(\"data-id\");if(!(key!=null))return;actions=z.app.services.get(key).getActions(\"write\");view=JST.editor_action_card({action:actions,which:\"Action\"});return _this.actionCard=new z.ui.Modal({\"class\":\"action-card\",view:view,target:$(e.currentTarget),x:-260,y:0,noX:true,noLayer:true})},750)},showTriggerCard:function(e){var _this=this;clearTimeout(this.triggerCardTimeout);return this.triggerCardTimeout=_.delay(function(){var key,triggers,view;key=$(e.currentTarget).find(\"t[data-id]\").attr(\"data-id\");if(!(key!=null))return;triggers=z.app.services.get(key).getActions(\"read\");view=JST.editor_action_card({action:triggers,which:\"Trigger\"});return _this.actionCard=new z.ui.Modal({\"class\":\"action-card\",view:view,target:$(e.currentTarget),x:90,y:0,noX:true,noLayer:true})},750)},hideCards:function(){var _ref,_ref2;clearTimeout(this.actionCardTimeout);clearTimeout(this.triggerCardTimeout);if((_ref=this.triggerCard)!=null)_ref.close();return(_ref2=this.actionCard)!=null?_ref2.close():void 0},buildServiceMatchIndex:function(){var _this=this;this.serviceIndex={};return z.app.services.each(function(service){var actions,categories,index,triggers;index=\"\";triggers=service.getActions(\"read\");actions=service.getActions(\"write\");categories=service.getCategories();_.each(triggers,function(trigger){return index+=service.getActionName(trigger.key,\"read\",\"true\")+\" \"});_.each(actions,function(action){return index+=service.getActionName(action.key,\"write\",\"true\")+\" \"});_.each(categories,function(category){return index+=category+\" \"});index+=service.getName().replace(\" \",\"\")+\" \";index=_.str.clean(index.toLowerCase());return _this.serviceIndex[service.getName()]=index})},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,key,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);key=service.get(\"key\");icon=service.getImageClass(\"32x32\");name=service.getName();key=_.escape(key);name=_.escape(name);icon=_.escape(icon);html='<i class=\"img32 '+icon+'\"></i> <t data-id=\"'+key+'\">'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},actionFormatSelection:function(service,row){var help,html,icon;if(!row.id)return row.text;help=$(row.element).attr(\"data-help\");icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;row.text=_.escape(row.text);html=\"<t>\"+row.text+\"</t>\";return html},actionFormatResult:function(service,row){var help,html,icon;if(!row.id)return row.text;if(row.id===\"showAll\"){return'<span class=\"showAll\">'+row.text+\"</span>\"}help=$(row.element).attr(\"data-help\");icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;row.text=_.escape(row.text);html=\"<t>\"+row.text+\"</t> <span>\"+help+\"</span>\";return html},matcherService:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=this.serviceIndex[haystack].toLowerCase();return _.str.include(haystack,needle)},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},changeService:function(e){var $el,data,model,val,which,_this=this;$el=this.$(e.currentTarget);this.hideCards();val=$el.val();which=_.str.include($el.attr(\"id\"),\"trigger\")?\"showTriggerAll\":\"showActionAll\";data={};data[which]=false;this.state.set(data);model=_.str.include($el.attr(\"id\"),\"trigger\")?this.options.read:this.options.write;which=_.str.include($el.attr(\"id\"),\"trigger\")?\"trigger\":\"action\";this.setMode(\"is\",\"saving\");return model.save({selected_api:val,action:null},{wait:true,complete:function(){return _this.setMode(\"not\",\"saving\")}})},changeAction:function(e){var $el,data,model,val,which,_this=this;$el=this.$(e.currentTarget);val=$el.val();if(val===\"showAll\"){which=_.str.include($el.attr(\"id\"),\"trigger\")?\"showTriggerAll\":\"showActionAll\";data={};data[which]=true;this.state.set(data);this.render();which=_.str.include($el.attr(\"id\"),\"trigger\")?\"trigger\":\"action\";return this.$(\"select#\"+which).select2(\"open\")}else{model=_.str.include($el.attr(\"id\"),\"trigger\")?this.options.read:this.options.write;this.setMode(\"is\",\"saving\");return model.save({action:val},{wait:true,complete:function(){return _this.setMode(\"not\",\"saving\")}})}},renderContinue:function(){var mode;mode=this.complete()?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},complete:function(){var action,bothSelected,parterService,partner,trigger,_ref;trigger=this.options.read.get(\"selected_api\")!=null&&this.options.read.get(\"action\")!=null;action=this.options.write.get(\"selected_api\")!=null&&this.options.write.get(\"action\")!=null;parterService=(_ref=z.app.partner.get(\"zap\"))!=null?_ref.selected_api:void 0;partner=parterService===this.options.read.get(\"selected_api\")||parterService===this.options.write.get(\"selected_api\");bothSelected=this.options.read.get(\"selected_api\")!=null&&this.options.write.get(\"selected_api\")!=null;if(parterService!=null&&!partner&&bothSelected){this.$(\".partner-feedback\").removeClass(\"hide\")}else{this.$(\".partner-feedback\").removeClass(\"hide\").addClass(\"hide\")}return trigger&&action&&(partner||!(parterService!=null))},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")}});z.ui.EnableStep=z.ui.Base.extend({className:\"enable\",events:{\"click .enable\":\"enable\",\"click input.title\":\"highlight\",\"change .title\":\"updateModel\"},initialize:function(options){var render;this.options=options;_.bindAll(this);this.read=this.options.read;this.write=this.options.write;this.readNeeds=this.options.readNeeds;this.writeNeeds=this.options.writeNeeds;render=_.debounce(this.render,40);this.read.on(\"change:selected_api change:action change:params change:paused change:errors\",render,this);this.write.on(\"change:selected_api change:action change:params change:errors\",render,this);this.readNeeds.on(\"change\",render,this);return this.writeNeeds.on(\"change\",render,this)},context:function(){var context,plan,polling,readService,writeService;readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));if(z.app.account.get(\"plan_id\")!=null){plan=z.app.plans.get(z.app.account.get(\"plan_id\"))}else{plan=z.app.plans.getTrialPlan()}polling=z.app.accountLimits.get(\"polling_interval\");context={flow:this.options.flow,errors:this.read.get(\"errors\").concat(this.write.get(\"errors\")),plan:plan,polling:polling,read:this.read.toJSON(),write:this.write.toJSON(),isHook:readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0,title:this.read.getTitle(true),readService:readService,writeService:writeService,ov:z.cfg.userfillOTag,cv:z.cfg.userfillETag};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_enable(context));z.useful.placeholders(this.$el);return this},updateModel:function(e){var title;if(e!=null)e.preventDefault();title=this.$(e.currentTarget).val();return this.read.save({title:title})},enable:function(e){var t,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"is\",\"disabled\"))return;this.setMode(\"is\",\"disabled\");this.$button=this.$(e.currentTarget);this.$button.text(\"Working...\");this.i=0;t=500;this.read.fetch({cache:false});return _.delay(function(){return _this.checkTimer=setInterval(function(){return _this.unpauseAjaxCheck()},500)},20)},unpauseAjaxCheck:function(){this.i+=1;if($.active===0)this.unpauseErrorCheck();if(this.i>20)return clearInterval(this.checkTimer)},unpauseErrorCheck:function(){var _this=this;return _.defer(function(){clearInterval(_this.checkTimer);if(!_this.read.hasErrors()){window.onbeforeunload=null;return _this.stripNonvisibleParams()}else{_this.setMode(\"not\",\"disabled\");return _this.$button.text(\"Make Zap Live\")}})},stripNonvisibleParams:function(){var stripped,_this=this;stripped={};z.app.writeNeeds.each(function(need){var key,_ref;key=need.get(\"key\");return stripped[key]=(_ref=z.app.write.get(\"params\"))!=null?_ref[key]:void 0});return z.app.write.save({params:stripped},{success:this.unpause,error:this.unpause})},unpause:function(){var error,success,_this=this;success=function(){var _ref;if(!((_ref=z.app.partner)!=null?_ref.isPartnerSession():void 0)){_this.shareZap()}Backbone.history.navigate(\"/app/dashboard\",{trigger:true});return _this.$button.text(\"Make Zap Live\")};error=function(model,xhr){var modal;_this.setMode(\"not\",\"disabled\");_this.$button.text(\"Make Zap Live\");if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})};return this.read.unpause({success:success,error:error})},shareZap:function(){var hasCookie,olderZap;hasCookie=z.store.get(this.read.id+\"-shared\")===\"yes\";olderZap=this.read.date&&(new Date).getTime()-this.read.date.getTime()>3*24*60*60*1e3;if(z.app.account.isFree()&&this.read.canShare()&&this.write.canShare()&&!hasCookie&&olderZap){this.shareZapModal=new z.ui.Modal({view:new z.ui.ShareZapModal({read:this.read,write:this.write})});return window.t=this.shareZapModal}},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()}});z.ui.ActionStep=z.ui.Base.extend({className:\"actions\",events:{\"click .showall\":\"showall\",\"click li.action\":\"select\"},test:function(e){return e!=null?e.preventDefault():void 0},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.model=this.isTrigger?this.read:this.write;this.state.set(\"showall\",false);if(this.model.get(\"selected_api\")!=null)this.setActions();if(this.model.get(\"selected_api\")!=null&&this.model.get(\"action\")!=null){this.setShowall()}this.model.on(\"change:selected_api\",function(){return _this.state.set(\"showall\",false)},this);this.model.on(\"change:selected_api\",this.render,this);this.model.on(\"change:action\",this.render,this);this.state.on(\"change:showall\",this.render,this);return this.model.on(\"change:action\",function(){if(_this.get()!=null)return z.app.editor.next(_this)},this)},get:function(){return this.model.get(\"action\")},set:function(action){return this.model.set(\"action\",action)},unset:function(){return this.model.set(\"action\",null)},context:function(){var context;context={anyAdvanced:this.anyAdvanced(),showall:this.state.get(\"showall\"),actions:this.actions,show:this.model.get(\"selected_api\")!=null};return context},render:function(){this.setActions();this.$el.html(JST.editor_action(this.context()));this.renderActions();return this},renderActions:function(){var _this=this;this.$(\"ul\").empty();return _.each(this.actions,function(action){var context;context=action;context.selected=context.key===_this.get();if(action.important||!_this.anyAdvanced()||_this.state.get(\"showall\")){return _this.$(\"ul\").append(JST.editor_action_row(context))}})},anyAdvanced:function(){var _this=this;return _.any(this.actions,function(action){return action.important===false})},setActions:function(){var service;service=z.app.services.get(this.model.get(\"selected_api\"));return this.actions=this.isTrigger?service!=null?service.getActions(\"read\"):void 0:service!=null?service.getActions(\"write\"):void 0},setShowall:function(){var selected,_this=this;selected=_.find(this.actions,function(action){return action.key===_this.get()});if((selected!=null?selected.important:void 0)===false){return this.state.set(\"showall\",true)}},showall:function(e){if(e!=null)e.preventDefault();return this.state.set(\"showall\",true)},select:function(e){var action;if(e!=null)e.preventDefault();action=this.$(e.currentTarget).attr(\"id\");if(this.get()!==action){return this.set(action)}else{return this.unset()}}});z.ui.Steps=z.ui.Base.extend({className:\"steps\",events:{\"click .unpause\":\"unpause\"},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.cap=0;_.each(this.steps(),function(step,name){return _this.state.set(name,\"none_visible\")});this.read.on(\"change:selected_api change:action change:paused\",this.render,this);return this.write.on(\"change:selected_api change:action\",this.render,this)},steps:function(){return{\"services-actions\":{step:1,view:z.app.editor.views.servicesActions},\"trigger-auth\":{step:2,view:z.app.editor.views.triggerAuth},\"action-auth\":{step:3,view:z.app.editor.views.actionAuth},filters:{step:4,view:z.app.editor.views.filters},map:{step:5,view:z.app.editor.views.map},test:{step:6,view:z.app.editor.views.test},enable:{step:7,view:z.app.editor.views.enable}}},context:function(){var context,readService,writeService;context={read:this.read.toJSON(),write:this.write.toJSON(),flow:this.flow};readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));context.readAction=readService!=null?readService.getActionName(this.read.get(\"action\"),\"read\",\"true\"):void 0;context.writeAction=writeService!=null?writeService.getActionName(this.write.get(\"action\"),\"write\",\"true\"):void 0;context.hasErrors=this.read.hasErrors();_.extend(context,this.state.toJSON());return context},renderSteps:function(){var steps;steps=this.steps();steps[\"services-actions\"].view.render();steps[\"trigger-auth\"].view.render();steps[\"action-auth\"].view.render();steps[\"filters\"].view.render();steps[\"map\"].view.render();steps[\"test\"].view.render();return steps[\"enable\"].view.render()\n},render:function(){var steps,_this=this;_.each(this.steps(),function(step,name){return _this.$(\"[data-id=\"+name+\"] content\").detach()});this.$el.html(JST.editor_steps(this.context()));steps=this.steps();this.$(\"[data-id=services-actions] content\").html(steps[\"services-actions\"].view.$el);this.$(\"[data-id=trigger-auth] content\").html(steps[\"trigger-auth\"].view.$el);this.$(\"[data-id=action-auth] content\").html(steps[\"action-auth\"].view.$el);this.$(\"[data-id=filters] content\").html(steps[\"filters\"].view.$el);this.$(\"[data-id=map] content\").html(steps[\"map\"].view.$el);this.$(\"[data-id=test] content\").html(steps[\"test\"].view.$el);this.$(\"[data-id=enable] content\").html(steps[\"enable\"].view.$el);this.$(\".dial\").knob({max:this.$(\".dial\").length,readOnly:true,height:40,width:40,inputColor:\"#4d4d4d\",fgColor:\"#888888\",bgColor:\"#cccccc\"});return this},getPosition:function(step){var pos,_this=this;pos=0;_.each(this.steps(),function(eachStep,name){if(step===name)return pos=eachStep.step});return pos},showAllSteps:function(){var _this=this;return _.each(this.steps(),function(step,name){return _this.showAll(name)})},showNext:function(){var _this=this;return this.$(\"step.none_visible\").first().each(function(i,el){var options,step,view;step=$(el).attr(\"data-id\");view=_this.steps()[step].view;z.app.track[\"new\"](\"Editor Step: \"+step,{step:step,snap:z.app.read.id});_this.state.set(step,\"all_visible\");_this.setMode(\"all\",\"visible\",$(el));options={offset:{left:0,top:-25}};if(_this.getPosition(step)>0){_.defer(function(){if(z.app.partner.isPartnerSession()&&z.app.partner.hasIframeJs){return _.delay(function(){var event,target,_ref;target=(_ref=$(el).find(\".row\").eq(0).offset())!=null?_ref.top:void 0;event={event:\"scroll\",height:target};return typeof window!==\"undefined\"&&window!==null?window.top.postMessage(JSON.stringify(event),\"*\"):void 0},150)}else{return $.scrollTo($(el).find(\".row\").eq(0),200,options)}})}return view!=null?typeof view.show===\"function\"?view.show():void 0:void 0})},toggleStep:function(e){var step;if(e!=null)e.preventDefault();step=$(e.currentTarget).closest(\"step\").attr(\"data-id\");if(this.state.get(step)===\"all_visible\"){return this.showTitle(step)}else if(this.state.get(step)===\"title_visible\"){return this.showAll(step)}},showTitle:function(step){var $el;this.state.set(step,\"title_visible\");$el=this.$(\"[data-id=\"+step+\"]\");return this.setMode(\"title\",\"visible\",$el)},showAll:function(step){var $el;this.state.set(step,\"all_visible\");$el=this.$(\"[data-id=\"+step+\"]\");return this.setMode(\"all\",\"visible\",$el)},unpause:function(e){var error,success,_this=this;if(e!=null)e.preventDefault();success=function(){};error=function(model,xhr){var modal;if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})};return this.read.unpause({success:success,error:error})}});var __indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};z.ui.EmbedSharedZaps=z.ui.Base.extend({embeddedZaps:[],events:{\"click input.add-to-embed\":\"toggleOnEmbed\",\"click .page-nav .previous\":\"previous\",\"click .page-nav .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.on(\"add remove reset change\",this.render,this);this.recipes.on(\"fetch\",this.startFetching,this);this.recipes.on(\"add remove reset change\",this.doneFetching,this);this.embed=options.embed;return this.checkedBoxes=[]},previous:function(e){if(e!=null)e.preventDefault();return this.recipes.serverPrev()},next:function(e){if(e!=null)e.preventDefault();return this.recipes.serverNext()},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());return this.recipes.serverPage(page)},routingKey:function(checkbox){if(checkbox.prop(\"checked\"))return\"embed.template.add\";return\"embed.template.remove\"},toggleOnEmbed:function(e){var $checkbox;$checkbox=$(e.currentTarget);z.cfg.pubSub.trigger(this.routingKey($checkbox),{zap_id:$checkbox.val()});return this.checkedBoxes.push(parseInt($checkbox.val(),10))},context:function(){var context;context={recipes:this.recipes,pagination:this.recipes.pagination.toJSON()};return context},render:function(){this.$el.html(JST.explore_results(this.context()));this.$zaps=this.$(\".zaps\");this.renderSharedRecipes();return this},sharedRecipesContext:function(recipe){var context,_ref;context=_.extend(recipe.toJSON(),{checked:(_ref=recipe.id,__indexOf.call(this.checkedBoxes,_ref)>=0)});return context},renderSharedRecipes:function(){var html,_this=this;html=\"\";this.recipes.each(function(recipe){return html+=JST.share_recipe(_this.sharedRecipesContext(recipe))});if(html===\"\"){html='<div class=\"empty\">No Zaps shared! Try sharing a few services.</div>'}return this.$zaps.html(html)}});z.ui.EmbededZaps=z.ui.Base.extend({SHARABLE_SCRIPT:'<script type=\"text/javascript\" src=\"{{base_url}}/zapbook/embed/widget.js?zaps={{zaps}}\"></script>',embeddedZaps:[],events:{},initialize:function(options){var render,_ref;_.bindAll(this);_.defaults(this,options);render=_.debounce(this.render,40);_ref=[false,false],this.animating=_ref[0],this.fetching=_ref[1];this.embed=options.embed;this.embed.on(\"changed fetch sync\",render,this);this.embed.on(\"fetch\",this.startFetching,this);this.embed.on(\"add remove reset change\",this.doneFetching,this);this.embeddedZaps=[];z.cfg.pubSub.on(\"embed.template.add\",this.addZap,this);return z.cfg.pubSub.on(\"embed.template.remove\",this.removeZap,this)},addZap:function(params){this.embeddedZaps.push(params.zap_id);return this.fetchView()},removeZap:function(params){this.embeddedZaps=_.reject(this.embeddedZaps,function(id){return id===params.zap_id});return this.fetchView()},toTop:function(){var _this=this;this.animating=true;return $(\"html, body\").animate({scrollTop:0},200,function(){return setTimeout(function(){_this.animating=false;return _this.doneAnimating()},200)})},doneAnimating:function(){if(!this.animating&&!this.fetching)return this.$el.removeClass(\"loading\")},startFetching:function(){this.fetching=true;return this.$el.addClass(\"loading\")},doneFetching:function(){this.fetching=false;return this.doneAnimating()},fetchView:function(){this.embed.fetch({data:{zaps:this.embeddedZaps.join(\",\")}},{processData:true});return this.toTop()},render:function(){var context;this.$el.html(JST.share_embed({}));this.$sharer=this.$(\".sharer\");this.$sharer.append($(this.embed.get(\"html\")));context={base_url:window.location.origin,zaps:this.embeddedZaps.join(\",\")};this.$el.find(\".share-this\").val(_.template(this.SHARABLE_SCRIPT,context));this.$el.find(\".share-this\").on(\"click\",function(){return this.select()});return this}});z.ui.HistoryNav=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={id:this.options.id};return context},render:function(){var context;context=this.context();this.$el.html(JST.history_nav(context));return this}});z.ui.HistoryDetails=z.ui.Base.extend({events:{\"click .replay\":\"replay\",\"click .target:not(.container)\":\"toggle\",\"click .toggle-details\":\"toggle\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var changed,context,json,ra,read,rs,rsn,title,wa,write,ws,wsn,_this=this;json=this.options.streamItem.toJSON();json.children=this.options.streamItem.buildChildren();if(json.children!=null){json.children=_.map(json.children,function(child){child.dataDetails=_this.getDataDetails(child.type);return child})}context=json;if(json.type===\"write\"){write=z.app.writes.get(json.object_id);read=z.app.reads.filter(function(read){return read.get(\"write_ids\")[0]===(write!=null?write.id:void 0)});read=read[0]}else{read=z.app.reads.get(json.object_id);write=z.app.writes.get(read.get(\"write_ids\")[0])}changed=false;if(read!=null&&read.get(\"selected_api\")!==json.data.read_selected_api){changed=true;read=null}if(write!=null&&write.get(\"selected_api\")!==json.data.write_selected_api){changed=true;write=null}if(!(read!=null)){read=new z.model.Read({selected_api:json.data.read_selected_api,action:json.data.read_action,params:json.data.read_params})}if(!(write!=null)){write=new z.model.Write({selected_api:json.data.write_selected_api,action:json.data.write_action,params:json.data.write_params})}context.read=read.toJSON();context.write=write.toJSON();title=read.getTitle();rs=z.app.services.get(read.get(\"selected_api\"));ws=z.app.services.get(write.get(\"selected_api\"));rsn=(rs!=null?rs.getName():void 0)||read.get(\"selected_api\");ra=(rs!=null?rs.getActionName(read.get(\"action\"),\"read\",\"true\"):void 0)||read.get(\"action\");wsn=(ws!=null?ws.getName():void 0)||write.get(\"selected_api\");wa=(ws!=null?ws.getActionName(write.get(\"action\"),\"write\",\"true\"):void 0)||write.get(\"action\");if(!(title!=null)){title=\"\"+rsn+\" \"+ra+\" to \"+wsn+\" \"+wa;if(changed){title+=\" (Zap services changed)\"}else{title+=\" (Zap deleted)\"}}context.title=title;context.state=this.state.toJSON();return context},render:function(){var context;context=this.context();this.$el.html(JST.history_details(context));return this},toggle:function(e){var detail,el,target;if(e!=null)e.preventDefault();detail=this.$(e.currentTarget).parent();if(this.$(e.currentTarget).hasClass(\"toggle-details\")){target=this.$(e.currentTarget).next(\".target\")}else{target=this.$(e.currentTarget)}if(detail.find('[class*=\"fa-caret-\"]').hasClass(\"fa-caret-right\")){el=target.find(\".fa-caret-right\");el.removeClass(\"fa-caret-right\").addClass(\"fa-caret-down\");el=target.siblings(\".details\");el.removeClass(\"hide\");return detail.find(\".toggle-details\").text(\"Hide detail\")}else{el=target.find(\".fa-caret-down\");el.removeClass(\"fa-caret-down\").addClass(\"fa-caret-right\");el=target.siblings(\".details\");el.addClass(\"hide\");return detail.find(\".toggle-details\").text(\"Show detail\")}},getDataDetails:function(type){var action,data,event,fields,i,name,read,service,status,stream,title,unreplaced,write,zapHtml,_ref,_ref2;stream=(_ref=z.app.streamItem)!=null?_ref.toJSON():void 0;if(!(stream!=null))return{};if(stream.type===\"write\"){write=z.app.writes.get(stream.legacy_object_id||stream.object_id);read=z.app.reads.filter(function(read){return read.get(\"write_ids\")[0]===(write!=null?write.id:void 0)});read=read[0]}else{read=z.app.reads.get(stream.legacy_object_id||stream.object_id);write=z.app.writes.get(read.get(\"write_ids\")[0])}if(!(read!=null)){read=new z.model.Read({selected_api:stream.data.read_selected_api,action:stream.data.read_action,params:stream.data.read_params})}if(!(write!=null)){write=new z.model.Write({selected_api:stream.data.write_selected_api,action:stream.data.write_action,params:stream.data.write_params})}title=read.getTitle();if(title!=null){zapHtml='<a target=\"_new\" href=\"/app/editor/'+read.id+'\">'+title+'</a> <i class=\"fa fa-external-link\"></i>'}else{zapHtml=\"(Zap no longer exists, it was deleted)\"}zapHtml=new Handlebars.SafeString(zapHtml);if(type===\"manual\"){data={Event:\"This Zap was manually ran from the Zapier dashboard.\",Date:z.useful.prettyISO(stream.date)}}if(type===\"trigger_summary\"){status=((_ref2=_.keys(stream.data.write_raw_data))!=null?_ref2.length:void 0)>0?\"success\":\"error\";service=z.app.services.get(stream.data.read_selected_api);name=(service!=null?service.getName():void 0)||stream.data.read_selected_api;action=(service!=null?service.getActionName(stream.data.read_action,\"read\",\"true\"):void 0)||stream.data.read_action;if(status===\"success\")event=\"Found 1 new \"+action+\" from \"+name;if(status===\"error\")event=\"Error getting \"+action+\" from \"+name;data={Zap:zapHtml,Event:event,Date:z.useful.prettyISO(stream.date),Status:_.superHumanize(stream.data.status)};if(stream.data.message!=null&&status===\"error\"){data[\"Details\"]=stream.data.message}i=0;_.each(stream.data.write_raw_data,function(v,k){i+=1;if(!(v!=null)||v===\"\")v=\"<empty>\";return data[k]=v});if(i===0){data[\"Warning\"]=\"No data was sent to Zapier for this Trigger.\"}}if(type===\"action_summary\"){service=z.app.services.get(stream.data.write_selected_api);name=(service!=null?service.getName():void 0)||stream.data.write_selected_api;action=(service!=null?service.getActionName(stream.data.write_action,\"write\",\"true\"):void 0)||stream.data.write_action;if(stream.data.status===\"success\"){event=\"Sent 1 \"+action+\" to \"+name}if(stream.data.status===\"halted\"){event=\"Advanced Filters halted 1 \"+action}if(stream.data.status===\"error\"){event=\"Tried to send 1 \"+action+\" to \"+name}data={Zap:zapHtml,Event:event,Date:z.useful.prettyISO(stream.date),Status:_.superHumanize(stream.data.status)};if(stream.data.message!=null&&stream.data.status===\"error\"){data[\"Details\"]=stream.data.message}i=0;_.each(stream.data.write_replaced_data,function(v,k){i+=1;if(!(v!=null)||v===\"\")v=\"<empty>\";return data[k]=v});if(i===0){data[\"Warning\"]=\"There was no data (after replacing template variables) to send for this Action.\"}unreplaced=[];_.each(stream.data.write_params,function(v,k){if(!(stream.data.write_replaced_data[k]!=null)){return unreplaced.push(k)}});if(unreplaced.length>0){fields=unreplaced.join(\", \");data[\"Warning\"]=\"Some expected template variables did not exist in the Trigger data. The following fields were sent to \"+name+\" empty: \"+fields+\".\"}}return data},replay:function(e){var $el,account,data,id,modal,options,paid,raw,replaced,sample,view,write,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_this=this;if(e!=null)e.preventDefault();account=z.app.account.toJSON();paid=(account!=null?(_ref=account.billing)!=null?(_ref2=_ref.subscription)!=null?(_ref3=_ref2.plan)!=null?_ref3.amount:void 0:void 0:void 0:void 0)>0;z.app.track[\"new\"](\"Replay Action\",{paid:paid});if(!(account.is_trialing||account.is_staff||paid||account.provider)){view=new z.ui.UpgradeModal({errors:[\"Replaying old tasks requires a paid plan.\"]});modal=new z.ui.Modal({view:view});return false}$el=this.$(e.currentTarget);id=$el.closest(\".container\").attr(\"data-id\");sample=z.app.streamItem;replaced=(_ref4=sample.toJSON())!=null?(_ref5=_ref4.data)!=null?_ref5.write_replaced_data:void 0:void 0;raw=(_ref6=sample.toJSON())!=null?(_ref7=_ref6.data)!=null?_ref7.write_raw_data:void 0:void 0;data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={step:sample.id,success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");$el.removeClass(\"working\");data=sample.get(\"data\");data[\"status\"]=\"success\";return sample.save({data:data},{wait:true})},error:function(model,xhr){var context,html,service,_ref10,_ref8,_ref9;clearInterval(_this.loadingTimer);service=(_ref8=z.app.services.get((_ref9=sample.get(\"data\"))!=null?_ref9.write_selected_api:void 0))!=null?_ref8.getName():void 0;$el.html(\"Error!\");$el.removeClass(\"working\");context={key:(_ref10=sample.get(\"data\"))!=null?_ref10.write_selected_api:void 0,message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};write=new z.model.Write({id:sample.get(\"object_id\")});write.write((_ref8=sample.get(\"data\"))!=null?_ref8.write_action:void 0,data,options);return false}});z.ui.SendCSVModal=z.ui.Base.extend({className:\"send-csv-modal\",events:{\"click .send\":\"send\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,_ref,_ref2,_ref3,_ref4;context={};context.filters=z.app.stream.filters.toJSON();if((_ref=context.filters)!=null?_ref.write_id:void 0){context.zap=(_ref2=z.app.reads)!=null?_ref2.find(function(read){return _.indexOf(read.get(\"write_ids\"),parseInt(context.filters.write_id))!==-1}):void 0;context.zapName=(_ref3=context.zap)!=null?_ref3.getTitle():void 0}context.status=(_ref4=context.filters)!=null?_ref4.status:void 0;return context},render:function(){this.$el.html(JST.history_send_csv(this.context()));return this},send:function(options){var _this=this;if(options==null)options={};return $.ajax({url:z.cfg.api+\"/stream/send\",type:\"POST\",data:JSON.stringify(z.app.stream.filters.toJSON()),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.$el.find(\"button.submit\").hide();_this.$el.find(\".feedback\").html(\"<em>Success! Check your email in a few moments!</em>\");setTimeout(function(){return _this.modal.close()},5e3);return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0}})}});z.ui.History=z.ui.Base.extend({events:{\"click .replay\":\"replay\",\"click .page-nav .previous\":\"previous\",\"click .page-nav .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){this.options=options;_.bindAll(this);return z.app.stream.on(\"add remove reset\",this.render,this)},context:function(){var context;context={pagination:z.app.stream.pagination.toJSON(),isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var empty,_this=this;this.$el.html(JST.history_table(this.context()));this.$table=this.$(\"table\");empty=_.once(function(){return _this.$table.empty()});z.app.stream.each(function(item){var context,_ref;empty();context=item.toJSON();if(((_ref=context.timesince)!=null?_ref.length:void 0)<4&&_.str.endsWith(context.timesince,\"m\")){context.date=context.timesince+\" ago\"}else{context.date=z.useful.prettyISO(context.date)}if(context)return _this.$table.append(JST.history_row(context))});this.$el.append(JST.history_pagination(this.context()));return this},previous:function(e){if(e!=null)e.preventDefault();z.app.stream.serverPrev();return $.scrollTo($(\"#app\"),200)},next:function(e){if(e!=null)e.preventDefault();z.app.stream.serverNext();return $.scrollTo($(\"#app\"),200)},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());return z.app.stream.serverPage(page)},replay:function(e){var $el,account,data,id,modal,options,paid,raw,replaced,sample,view,write,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();account=z.app.account.toJSON();paid=(account!=null?(_ref=account.billing)!=null?(_ref2=_ref.subscription)!=null?(_ref3=_ref2.plan)!=null?_ref3.amount:void 0:void 0:void 0:void 0)>0;z.app.track[\"new\"](\"Replay Action\",{paid:paid});if(!(account.is_trialing||account.is_staff||paid||z.app.partner.isPartnerSession())){view=new z.ui.UpgradeModal({errors:[\"Replaying old tasks requires any paid plan.\"]});modal=new z.ui.Modal({view:view});return false}$el=this.$(e.currentTarget);id=$el.closest(\".history\").attr(\"data-id\");sample=z.app.stream.get(id);replaced=sample!=null?(_ref4=sample.toJSON().data)!=null?_ref4.write_replaced_data:void 0:void 0;raw=sample!=null?(_ref5=sample.toJSON().data)!=null?_ref5.write_raw_data:void 0:void 0;data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={step:sample.id,success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");$el.removeClass(\"working\");data=sample.get(\"data\");data[\"status\"]=\"success\";return sample.save({data:data},{wait:true})},error:function(model,xhr){var context,html,service,_ref6,_ref7,_ref8;clearInterval(_this.loadingTimer);service=(_ref6=z.app.services.get((_ref7=sample.get(\"data\"))!=null?_ref7.write_selected_api:void 0))!=null?_ref6.getName():void 0;$el.html(\"Error!\");$el.removeClass(\"working\");context={key:(_ref8=sample.get(\"data\"))!=null?_ref8.write_selected_api:void 0,message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};write=new z.model.Write({id:sample.get(\"object_id\")});write.write((_ref6=sample.get(\"data\"))!=null?_ref6.write_action:void 0,data,options);return false}});z.ui.SendCSVModal=z.ui.Base.extend({events:{\"click .send\":\"send\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,_ref,_ref2,_ref3,_ref4;context={};context.filters=z.app.stream.filters.toJSON();if((_ref=context.filters)!=null?_ref.write_id:void 0){context.zap=(_ref2=z.app.reads)!=null?_ref2.find(function(read){return _.indexOf(read.get(\"write_ids\"),parseInt(context.filters.write_id))!==-1}):void 0;context.zapName=(_ref3=context.zap)!=null?_ref3.getTitle():void 0}context.status=(_ref4=context.filters)!=null?_ref4.status:void 0;return context},render:function(){this.$el.html(JST.history_send_csv(this.context()));return this},send:function(options){var _this=this;if(options==null)options={};return $.ajax({url:z.cfg.api+\"/stream/send\",type:\"POST\",data:JSON.stringify(z.app.stream.filters.toJSON()),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.$el.find(\".bottom\").html(\"<em>Success! Check your email in a few moments!</em>\");setTimeout(function(){return _this.modal.close()},5e3);return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0}})}});z.ui.HistoryFilters=z.ui.Base.extend({events:{\"click .send-csv\":\"sendCSV\",\"click .refresh\":\"refresh\"},initialize:function(options){var fields,_this=this;this.options=options;_.bindAll(this);this.refresh=_.throttle(this._refresh,1e3);z.app.stream.filters.on(\"change\",this.updateCookie,this);z.app.stream.on(\"add remove reset\",this.updateCookie,this);fields=[{key:\"write_id\",type:\"select\",hideLabel:true,hideRawValue:true,choices:this.generateChoices(),value:z.app.stream.filters.toJSON().write_id||\"0\"},{key:\"status\",type:\"select\",hideLabel:true,hideRawValue:true,choices:{0:\"All Statuses\",success:\"Successful Only\",error:\"Errors Only\",halted:\"Filtered Only\"},value:z.app.stream.filters.toJSON().status||\"0\"}];this.form=new z.model.FormSet(fields);this.paramform=new z.ui.ParamForm({form:this.form});_.each(this.form.models,function(row){if(row.options.type===\"select\"){return row.on(\"change\",_this.filter,row)}});return this.updateCookie()},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.history_filters(this.context()));this.$(\"paramform\").replaceWith(this.paramform.render().el);return this},generateChoices:function(){var choices;choices={0:\"All zaps\"};_.each(this.getZaps(),function(zap,index,list){return choices[zap.write.id]=zap.title+\" (#\"+zap.read.id+\")\"});return choices},toggle:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).toggleClass(\"selected\")},filter:function(row){var key,url,value,_this=this;key=row.options.key;value=row.get(\"value\");url=\"/app/history?\";_.each(this.form.models,function(formRow){var thisKey,thisValue;thisKey=formRow.options.key;thisValue=formRow.get(\"value\");if(thisKey===\"write_id\"&&thisValue!==\"0\"){return url+=thisKey+\"=\"+thisValue+\"&\"}else if(thisKey===\"status\"&&thisValue!==\"0\"){return url+=thisKey+\"=\"+thisValue+\"&\"}});url=url.slice(0,-1);Backbone.history.navigate(url);if(value===\"0\")value=\"\";return z.app.stream.filters.set(key,value)},getZaps:function(){var zaps,_this=this;zaps=[];z.app.reads.each(function(read){var title,write;write=z.app.writes.get(read.get(\"write_ids\")[0]);title=read.getTitle();if(title!=null&&read!=null&&write!=null){return zaps.push({read:read.toJSON(),write:write.toJSON(),title:title})}});return zaps},_refresh:function(e){var done,oldHTML,_this=this;if(e!=null)e.preventDefault();oldHTML=this.$(e.currentTarget).html();this.$(e.currentTarget).text(\"Refreshing...\");done=function(){return _.delay(function(){return _this.$(e.currentTarget).html(oldHTML)},500)};return z.app.stream.fetch({cache:false,success:done,error:done})},sendCSV:function(e){return this.sendCSVModal=new z.ui.Modal({view:new z.ui.SendCSVModal({yes:null})})},updateCookie:function(){var cookie,date,write_id,_this=this;cookie=z.store.get(\"logs-seen\");cookie=cookie!=null?cookie:{};date=(new Date).toISOString();write_id=z.app.stream.filters.get(\"write_id\");if(write_id!=null)cookie[write_id]=date;z.app.stream.each(function(item){return cookie[item.get(\"legacy_object_id\")||item.get(\"object_id\")]=date});return z.store.set(\"logs-seen\",cookie)}});z.ui.ExploreSearch=z.ui.Base.extend({events:{\"click select#involve-service\":\"addServiceFilter\",\"click [data-remove-involve-service]\":\"removeServiceFilter\",\"change select[data-filter]\":\"filterUpdate\",\"click [data-clear-filter]\":\"clearFilter\",\"click .do-clear\":\"clearAllFilters\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.filters.on(\"change reset\",this.render,this);return this.buildServiceMatchIndex()},context:function(){var context,_this=this;this.services=z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.involvedServices=_.map(this.recipes.getServicesFilter(),function(value){if(_.str.include(value,\"API\")){return z.app.services.where({key:value})[0]}else{return z.app.services.where({slug:value})[0]}});context={services:this.services,involvedServices:this.involvedServices,filters:this.recipes.filters.toJSON(),anyFilters:_.any(_.values(this.recipes.filters.toJSON())),directLink:\"/app/explore?services=\"+this.recipes.filters.get(\"services\")};return context},addServiceFilter:function(e){var current,filterList,key;if(e!=null)e.preventDefault();key=z.app.services.get($(e.currentTarget).val()).get(\"slug\");current=this.recipes.getServicesFilter();if(!_.contains(current,key)){filterList=current.concat([key]);return this.recipes.applyServicesFilter(filterList)}},removeServiceFilter:function(e){var filterList,key;if(e!=null)e.preventDefault();filterList=this.recipes.getServicesFilter();key=$(e.currentTarget).attr(\"data-remove-involve-service\");return this.recipes.applyServicesFilter(_.without(filterList,key))},filterUpdate:function(e){var key,value;if(e!=null)e.preventDefault();key=$(e.currentTarget).attr(\"data-filter\");value=$(e.currentTarget).val();return this.recipes.filters.set(key,value)},clearFilter:function(e){var key,keys;if(e!=null)e.preventDefault();keys=$(e.currentTarget).attr(\"data-clear-filter\");return this.recipes.filters.set(_.object(function(){var _i,_len,_ref,_results;_ref=keys.split(\" \");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){key=_ref[_i];_results.push([key,null])}return _results}()))},clearAllFilters:function(e){if(e!=null)e.preventDefault();return this.recipes.clearFilters()},render:function(){var context;context=this.context();this.$el.html(JST.explore_search(context));this.$(\"#single-service\").val(this.recipes.filters.get(\"services\"));this.$(\"#trigger-service\").val(this.recipes.filters.get(\"read_service\"));this.$(\"#action-service\").val(this.recipes.filters.get(\"write_service\"));this.$(\".services select\").select2({containerCssClass:\"select2-explore-service larger\",dropdownCssClass:\"select2-explore-service wide left\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcher});return this},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,key,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);key=service.get(\"key\");icon=service.getImageClass(\"32x32\");name=service.getName();icon=_.escape(icon);key=_.escape(key);name=_.escape(name);html='<i class=\"img32 '+icon+'\"></i> <t data-id=\"'+key+'\">'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=this.serviceIndex[haystack].toLowerCase();return _.str.include(haystack,needle)},buildServiceMatchIndex:function(){var _this=this;this.serviceIndex={};return z.app.services.each(function(service){var actions,categories,index,triggers;index=\"\";triggers=service.getActions(\"read\");actions=service.getActions(\"write\");categories=service.getCategories();_.each(triggers,function(trigger){return index+=service.getActionName(trigger.key,\"read\",\"true\")+\" \"});_.each(actions,function(action){return index+=service.getActionName(action.key,\"write\",\"true\")+\" \"});_.each(categories,function(category){return index+=category+\" \"});index+=service.getName()+\" \";index=_.str.clean(index.toLowerCase());return _this.serviceIndex[service.getName()]=index})}});z.ui.ExploreResults=z.ui.Base.extend({events:{\"click .use-this\":\"useRecipe\",\"click .previous\":\"previous\",\"click .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){var _ref;_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.on(\"add remove reset change\",this.render,this);_ref=[false,false],this.animating=_ref[0],this.fetching=_ref[1];this.recipes.on(\"fetch\",this.startFetching,this);return this.recipes.on(\"add remove reset change\",this.doneFetching,this)},toTop:function(){var _this=this;this.animating=true;return $(\"html, body\").animate({scrollTop:0},200,function(){return setTimeout(function(){_this.animating=false;return _this.doneAnimating()},200)})},doneAnimating:function(){if(!this.animating&&!this.fetching)return this.$el.removeClass(\"loading\")},startFetching:function(){this.fetching=true;return this.$el.addClass(\"loading\")},doneFetching:function(){this.fetching=false;return this.doneAnimating()},previous:function(e){if(e!=null)e.preventDefault();this.recipes.serverPrev();return this.toTop()},next:function(e){if(e!=null)e.preventDefault();this.recipes.serverNext();return this.toTop()},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());this.recipes.serverPage(page);return this.toTop()},useRecipe:function(e){var qs,recipe,_ref,_ref2,_ref3,_ref4;if(e!=null)e.preventDefault();$(e.currentTarget).attr(\"disabled\",true);$(e.currentTarget).addClass(\"disabled\");$(e.currentTarget).html('<div class=\"spinning-star\"></div>');recipe=this.recipes.get($(e.currentTarget).attr(\"data-id\"));if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={};if(recipe.get(\"generated\")){qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0}}else{qs={recipe_id:recipe.id}}return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}},context:function(){var context;context={recipes:this.recipes,pagination:this.recipes.pagination.toJSON()};return context},render:function(){var html,_this=this;this.$el.html(JST.explore_results(this.context()));this.$container=this.$(\".zaps\");html=\"\";this.recipes.each(function(recipe){return html+=JST.explore_recipe(recipe.toJSON())});if(html===\"\"){html='<div class=\"empty\">No Zaps to show! Try choosing different services.</div>'}this.$container.html(html);return this}});z.ui.SignUpWhy=z.ui.Base.extend({events:{\"click .render\":\"render\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.querystring=options!=null?options.querystring:void 0;return this.recipe=options!=null?options.recipe:void 0},selectedPlan:function(){if(this.querystring.plan)return z.app.plans.get(this.querystring.plan);return null},readService:function(){if(this.recipe)return this.recipe.readService();return null},readAction:function(){var read_action,_ref,_ref2;read_action=(_ref=this.recipe)!=null?_ref.get(\"read_data\").action:void 0;if(read_action){return(_ref2=this.readService())!=null?_ref2.getActionMeta(read_action):void 0}return null},writeService:function(){if(this.recipe)return this.recipe.writeService();return null},writeAction:function(){var write_action,_ref,_ref2;write_action=(_ref=this.recipe)!=null?_ref.get(\"write_data\").action:void 0;if(write_action){return(_ref2=this.writeService())!=null?_ref2.getActionMeta(write_action,\"write\"):void 0}},context:function(){var context;\ncontext={selectedPlan:this.selectedPlan(),readService:this.readService(),readAction:this.readAction(),writeService:this.writeService(),writeAction:this.writeAction(),services:_.shuffle(z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0){return false}return true}))};return context},render:function(){var context;context=this.context();this.$el.html(JST.signup_why(context));return this}});z.ui.SignUpForm=z.ui.Base.extend({tagName:\"div\",className:\"form\",events:{\"click button.submit\":\"submitForm\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);return this.recipe=options!=null?options.recipe:void 0},setFormError:function(error){this.$(\".errors span\").text(error);this.$(\".errors\").removeClass(\"hide\");return this.$(\"button\").attr(\"disabled\",false)},resetFormError:function(){this.$(\".errors\").addClass(\"hide\");return this.$(\"button\").attr(\"disabled\",true)},createAccount:function(cb){var _this=this;z.app.account.set(this.form.getValues(),{trigger:false});z.app.account.set({timezone:z.useful.getUserTimezone()},{trigger:false});return z.app.account.save({},{success:function(model,response,options){z.app.account.accountCreated();return typeof cb===\"function\"?cb():void 0},error:function(model,xhr,options){var response,_ref;response=JSON.parse(xhr.responseText);_this.setFormError((_ref=response.errors)!=null?_ref.join(\", \"):void 0);return typeof cb===\"function\"?cb():void 0}})},doRedirect:function(cb){var _ref,_this=this;if(z.app.account.isLoggedIn()){if(((_ref=this.querystring)!=null?_ref.next:void 0)!=null){return z.useful.goto(decodeURI(this.querystring.next))}else if(this.recipe){return this.recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{return Backbone.history.navigate(\"/app/dashboard\",{trigger:true})}}},refreshChrome:function(cb){z.useful.refreshChrome();return typeof cb===\"function\"?cb():void 0},submitForm:function(){var _this=this;this.resetFormError();if(this.form.isValid()){return async.series([this.createAccount,this.refreshChrome,this.doRedirect],function(err,results){})}else{return this.setFormError(\"Please double-check the form is complete and valid.\")}},signUpFields:function(){return[{key:\"email\",label:\"Email\",placeholder:\"You'll use this to login...\",type:\"unicode\",required:true,validator:function(model,collection){var data,email;data=collection.getValues();email=data.email||\"\";return/\\S+@\\S+\\.\\S+/.test(email)}},{key:\"first_name\",label:\"First Name\",placeholder:\"What your mother calls you...\",type:\"unicode\",required:true},{key:\"last_name\",label:\"Last Name\",placeholder:\"What your army buddies call you...\",type:\"unicode\",required:true},{key:\"password1\",label:\"Password\",placeholder:\"Be sure to keep this private...\",type:\"password\",required:true},{key:\"terms\",label:\"Terms of Service\",type:\"checkbox\",required:true,help_text_html:'I agree to Zapier\\'s <a href=\"/terms\" target=\"_new\">Terms of Service</a>'},{key:\"updates\",label:\"Get Zapier Updates\",type:\"checkbox\",required:false,\"default\":true,help_text:\"Receive 1 weekly email about new services, triggers and actions available on Zapier.\"}]},render:function(){this.$el.html(JST.signup_form({}));this.form=new z.model.FormSet(this.signUpFields());this.signupform=new z.ui.ParamForm({form:this.form});this.$(\"signupform\").replaceWith(this.signupform.render().el);return this}});z.ui.PersonaFormModal=z.ui.Base.extend({className:\"persona-modal\",events:{submit:\"submitPersona\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={};context.personas=z.useful.equalChunks(PERSONAS||[],2);context.first_personas=context.personas[0];context.second_personas=context.personas[1];return context},render:function(){this.$el.html(JST.signup_persona_modal(this.context()));return this},submitPersona:function(ev){var personas;if(ev!=null)ev.preventDefault();z.store.set(\"showPersonaModal\",null);personas=_.map($(\".persona-modal :checked\").get(),function(persona){return persona.value}).join(\",\");z.app.account.save({personas:personas});return this.modal.close()}});z.ui.ExtraSettings=z.ui.Base.extend({events:{\"click .advanced\":\"advanced\",\"click .close\":\"close\"},initialize:function(){return _.bindAll(this)},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.settings_extra(this.context()));return this},advanced:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"disable_ssl_check\",label:\"Disable SSL Certificate Checks?\",help_text_html:'Only disable this if you\\'re experiencing problems and understand the risks in doing so. <a href=\"https://zapier.com/blog/2013/04/09/ssl-certificates-and-zapier/\" target=\"_new\">Learn more here</a>.',type:\"unicode\",choices:[\"no\",\"yes\"],required:false,value:z.app.account.get(\"disable_ssl_check\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},close:function(e){var fields,form,modal,save;if(e!=null)e.preventDefault();fields=[{key:\"word\",label:\"Confirm Delete\",help_text:'Confirm you really want to permanently delete your account by typing \"DELETE\" in all caps below.',type:\"unicode\",required:true,validator:function(model,collection){var data;data=collection.getValues();return data.word===\"DELETE\"}},{key:\"password\",label:\"Verify Current Password\",help_text:\"Verify your current password to delete your account.\",type:\"password\",required:true}];form=new z.model.FormSet(fields);save=function(values){var _this=this;if(values.word!==\"DELETE\"){this.saveError.call(this,this,{responseText:\"Confirmation word did not match.\"});return}return z.app.account.destroy({wait:true,data:JSON.stringify({password:values.password}),success:function(){return z.useful.goto(\"/\")},error:this.saveError})};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,button:\"Delete Account\",title:\"Permanently Delete Account and Data\"})})}});z.ui.Auths=z.ui.Base.extend({events:{\"click button.test\":\"test\",\"click button.reconnect\":\"replace\",\"click button.rename\":\"rename\",\"click button.disconnect\":\"delete\"},initialize:function(options){var render,_this=this;this.options=options;_.bindAll(this);render=_.debounce(this.render,40);z.app.auths.on(\"change add remove reset\",render,this);z.app.services.on(\"change add remove reset\",render,this);this.on(\"remove\",function(){return _this.$(\"select\").off(\"change\",_this.selectChange)});if(this.options.addService!=null){if(parseInt(this.options.addService)){return this.replaceAuth(this.options.addService)}else{return this.addAuth(this.options.addService)}}},context:function(){var auths,context,services,_this=this;this.applyCounts();auths=z.app.auths.toJSON();auths=z.app.auths.map(function(each){var auth,d;auth=each.toJSON();auth[\"name\"]=each.getName();d=new Date(auth[\"date\"]);auth[\"prettyDate\"]=[d.getMonth()+1,d.getDate(),d.getFullYear()].join(\"/\");return auth});services=z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.needsAuth())return false;return true});context={auths:auths,services:services};return context},render:function(){this.$el.html(JST.settings_auths(this.context()));this.$(\"select\").select2({containerCssClass:\"select2-auths-service\",dropdownCssClass:\"select2-auths-service wide right\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcher,allowClear:true});this.$(\"select\").off(\"change\",this.selectChange);this.$(\"select\").on(\"change\",this.selectChange);return this},selectChange:function(e){var key,which;key=this.$(e.currentTarget).val();which=this.$(e.currentTarget).attr(\"data-which\");this.$(e.currentTarget).select2(\"val\",\"\");if(which===\"add\")this.addAuth(key);if(which===\"request\")return this.requestAuth(key)},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);icon=service.getImageClass(\"32x32\");name=service.getName();icon=_.escape(icon);name=_.escape(name);html='<i class=\"img32 '+icon+'\"></i> <t>'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},applyCounts:function(){var _this=this;return z.app.auths.each(function(auth){var count;count=0;z.app.reads.each(function(read){var write,_ref;write=z.app.writes.get((_ref=read.get(\"write_ids\"))!=null?_ref[0]:void 0);if(read.get(\"authentication_id\")===auth.get(\"id\")||(write!=null?write.get(\"authentication_id\"):void 0)===auth.get(\"id\")){return count+=1}});return auth.set({used:count})})},addAuth:function(key){var context,service,success,_this=this;service=z.app.services.get(key);success=function(auth){return _this.render()};context={service:service,success:success};return this.modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},requestAuth:function(key){var context,modal,service,success,_this=this;service=z.app.services.get(key);success=function(auth){return _this.render()};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthRequestModal(context)})},replaceAuth:function(oldAuthId){var context,modal,oldAuth,service,success,_this=this;oldAuth=z.app.auths.get(oldAuthId);if(!oldAuth)return;success=function(newAuth){return oldAuth.swap(newAuth.id,{success:function(model,resp){return async.parallel({reads:function(cb){return z.app.reads.fetch({cache:false,reset:true,success:cb})},writes:function(cb){return z.app.writes.fetch({cache:false,reset:true,success:cb})}},function(err,results){return _this.render()})}})};service=z.app.services.get(oldAuth.get(\"selected_api\"));context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},replace:function(e){var $el,id;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);id=$el.attr(\"data-id\");return this.replaceAuth(id)},rename:function(e){var $el,auth,id,modal,save,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);id=$el.attr(\"data-id\");auth=z.app.auths.get(id);save=function(value){return auth.save({title:value})};return modal=new z.ui.Modal({view:new z.ui.RenameModal({value:auth.get(\"title\"),save:save})})},\"delete\":function(e){var $el,auth,id,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.text()===\"Really?\"){id=$el.attr(\"data-id\");auth=z.app.auths.get(id);this.$(\"tr[data-id=\"+id+\"]\").addClass(\"destroying\");return this.$(\"tr[data-id=\"+id+\"]\").fadeOut(400,function(){return auth.destroy()})}else{this.$(e.currentTarget).text(\"Really?\").addClass(\"orange\");return _.delay(function(){var _ref;return(_ref=_this.$(e.currentTarget))!=null?_ref.text(\"Disconnect\").removeClass(\"orange\"):void 0},3e3)}},test:function(e){var $el,auth,id,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.text()===\"Testing...\")return;id=$el.attr(\"data-id\");auth=z.app.auths.get(id);$el.text(\"Testing...\").removeClass(\"success error\");return auth.test({success:function(model,resp){return $el.text(\"Connected!\").addClass(\"success\").attr(\"disabled\",true)},error:function(model,xhr){var context,errors,modal;$el.text(\"error!\").addClass(\"error\");errors=z.useful.errors(xhr);context={auth:auth,message:errors,type:\"manual\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context)})}})}});z.ui.PlanSelect=z.ui.Base.extend({events:{\"click .toggle-interval .switch\":\"switch\",\"click .toggle-interval .toggle-container\":\"toggle\",\"click button.change-plan\":\"changePlan\",\"click .coupon-form button\":\"useCoupon\",\"click .add-card\":\"addCard\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);return this.variant=((_ref=z.app.account.getCurrentPlan())!=null?_ref.get(\"interval\"):void 0)||\"month\"},context:function(){var context,_ref,_ref2,_ref3,_this=this;context={account:z.app.account,services:z.app.services,monthly:this.variant===\"month\",billing:z.app.account.get(\"billing\"),provider:z.app.account.get(\"provider\"),showCoupon:(_ref=this.options)!=null?_ref.showCoupon:void 0,coupon:this.couponDescription((_ref2=z.app.account.get(\"billing\"))!=null?(_ref3=_ref2.discount)!=null?_ref3.coupon:void 0:void 0),cached_coupon:z.app.account.get(\"cached_coupon\"),plans:z.app.plans.getIntervalPlans(this.variant).map(function(plan){plan.current=plan.get(\"current_plan\");plan.buttonText=\"Switch to this plan\";return plan})};return context},toggle:function(e){var t;t=this.$(e.currentTarget);if(t.hasClass(\"on\")){this.variant=\"month\"}else{this.variant=\"year\"}t.toggleClass(\"on\");return this.render()},\"switch\":function(e){var t;if(e!=null)e.preventDefault();t=this.$(e.currentTarget);t.parent().toggleClass(\"on\");this.variant=t.attr(\"data-pricing-interval\");return this.render()},changePlan:function(e){var changePlanWhy,done,el,error,isFree,lessCostly,oldText,plan,planId,sameInterval,_ref,_ref2,_this=this;if(e!=null)e.preventDefault();el=this.$(e.currentTarget);oldText=el.text();planId=el.attr(\"data-change-plan\");plan=z.app.plans.get(planId);lessCostly=plan.dollarsMo()<((_ref=z.app.account.getCurrentPlan())!=null?_ref.dollarsMo():void 0);sameInterval=plan.get(\"interval\")===((_ref2=z.app.account.getCurrentPlan())!=null?_ref2.get(\"interval\"):void 0);isFree=plan.isFree();if(el.hasClass(\"confirm\")){done=function(){_.defer(_this.render);if(_this.downgradeModal)return _this.downgradeModal.close()};error=function(model,xhr){var errors;errors=z.useful.errors(xhr);if(_this.downgradeModal)_this.downgradeModal.close();return _this.errorModal=new z.ui.Modal({view:errors+' You can update your credit card <a href=\"/app/settings/card\" data-nav=\"app/settings/card\">here</a>.'})};changePlanWhy=function(why){if(why==null)why=null;return z.app.account.switchPlan(planId,null,why,{success:done,error:error})};clearInterval(this.changeTimeout);el.attr(\"disabled\",true);el.text(oldText);if(lessCostly&&(sameInterval||isFree)){return this.downgradeModal=new z.ui.Modal({close:function(){return _this.render()},view:new z.ui.DowngradeModal({save:function(values){var why;why=\"\";_.each(values,function(value,key){if(value&&_.isBoolean(value)){return why+=\"Checked: \"+key+\"\\n\"}});if(values.comments)why+=\"Comments: \"+values.comments;return changePlanWhy(why)}})})}else{return changePlanWhy(null)}}else{this.changeTimeout=setTimeout(function(){el.text(oldText);return el.removeClass(\"confirm\")},3e3);el.text(\"Are you sure?\");return el.addClass(\"confirm\")}},useCoupon:function(e){var coupon,el,error,planId,success,_this=this;if(e!=null)e.preventDefault();el=this.$(e.currentTarget);el.addClass(\"disabled\");el.text(\"Working...\");planId=z.app.account.get(\"plan_id\");coupon=this.$(\"input.coupon-code\").val()||null;success=function(resp){var s;s=function(){_this.render();_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"success\");_this.$(\".coupon-form .feedback\").text(\"Coupon added: \"+resp.description);_this.$(\".coupon-form input\").val(\"\");el.text(\"Use Coupon\");return el.removeClass(\"disabled\")};e=function(){_this.render();_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"error\");_this.$(\".coupon-form .feedback\").text(\"Coupon is valid but could not apply.\");el.text(\"Use Coupon\");return el.removeClass(\"disabled\")};return z.app.account.switchPlan(planId,coupon,null,{success:s,error:e})};error=function(xhr){_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"error\");_this.$(\".coupon-form .feedback\").text(\"Coupon does not exist.\");el.removeClass(\"disabled\");return el.text(\"Use Coupon\")};return z.app.account.checkCoupon(coupon,{success:success,error:error})},sizeTable:function(){return this.$(\".overflow-container\").css({maxWidth:$(\"body\").width()})},render:function(){var context;context=this.context();this.$el.html(JST.settings_plans(context));this.sizeTable();return this},couponDescription:function(coupon){var desc;if(coupon!=null?coupon.amount_off:void 0){desc=\"$\"+coupon.amount_off/100+\" off\"}else if(coupon!=null?coupon.percent_off:void 0){desc=coupon.percent_off+\"% off\"}if((coupon!=null?coupon.duration:void 0)===\"repeating\"){desc=desc+\" for \"+(coupon!=null?coupon.duration_in_months:void 0)+\" months\"}else if((coupon!=null?coupon.duration:void 0)===\"once\"){desc=desc+\" for 1 month\"}else if((coupon!=null?coupon.duration:void 0)===\"forever\"){desc=desc+\" forever\"}return desc},addCard:function(e){var $el,card,cleanMonth,context,fields,form,html,joinPlan,mochoices,modal,now,planId,save,validateCard,validateCvc,validateExp,year,yearchoices,_ref,_ref2,_this=this;if(e!=null)e.preventDefault();card=(_ref=z.app.account.get(\"billing\"))!=null?_ref.active_card:void 0;context={};if(card!=null){context={type:card.type,last4:card.last4,expM:card.exp_month,expY:card.exp_year}}html=JST.settings_card(context);mochoices=[\"Jan (01)\",\"Feb (02)\",\"Mar (03)\",\"Apr (04)\",\"May (05)\",\"June (06)\",\"July (07)\",\"Aug (08)\",\"Sept (09)\",\"Oct (10)\",\"Nov (11)\",\"Dec (12)\"];yearchoices=[];now=(new Date).getFullYear();for(year=now,_ref2=now+13;now<=_ref2?year<=_ref2:year>=_ref2;now<=_ref2?year++:year--){yearchoices.push(String(year))}cleanMonth=function(month){var _ref3;return month!=null?(_ref3=month.match(/\\(([^\\)]+)\\)/))!=null?_ref3[1]:void 0:void 0};validateExp=function(model,collection){var month,_ref3,_ref4,_ref5,_ref6;month=cleanMonth((_ref3=collection.where({key:\"expmo\"}))!=null?(_ref4=_ref3[0])!=null?typeof _ref4.get===\"function\"?_ref4.get(\"value\"):void 0:void 0:void 0);year=(_ref5=collection.where({key:\"expyear\"}))!=null?(_ref6=_ref5[0])!=null?typeof _ref6.get===\"function\"?_ref6.get(\"value\"):void 0:void 0:void 0;return z.stripe.validateExpiry(month||\"0\",year||\"3000\")};validateCard=function(model,collection){return z.stripe.validateCardNumber(model.get(\"value\"))};validateCvc=function(model,collection){return z.stripe.validateCVC(model.get(\"value\"))};fields=[{key:\"name\",label:\"Cardholder Name\",help_text:\"Full name on the card.\",type:\"unicode\",required:true},{key:\"cardnumber\",label:\"Card Number\",type:\"unicode\",required:true,validator:validateCard},{key:\"expmo\",label:\"Month\",required:true,type:\"select\",choices:mochoices,validator:validateExp},{key:\"expyear\",label:\"Year\",required:true,type:\"select\",choices:yearchoices,validator:validateExp},{key:\"cvc\",label:\"CVC\",type:\"unicode\",required:true,validator:validateCvc}];form=new z.model.FormSet(fields);$el=this.$(e.currentTarget);planId=$el.attr(\"data-change-plan\");joinPlan=function(){var done;done=function(){return _.defer(_this.render)};$el.html(\"Upgrading...\");return z.app.account.switchPlan(planId,null,null,{success:done,error:done})};save=function(values){var error,stripeHandler,success,_this=this;success=this.saveSuccess;error=this.saveError;stripeHandler=function(status,response){var token;if(response.error){return error.call(_this,_this,{responseText:response.error.message})}else{token=response.id;return z.app.account.saveCard(token,{success:function(){joinPlan(e);return success.apply(this,arguments)},error:error})}};return z.stripe.createToken({name:values.name,number:values.cardnumber,cvc:values.cvc,exp_month:cleanMonth(values.expmo),exp_year:values.expyear},stripeHandler)};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({button:\"Save card and upgrade\",form:form,save:save})})}});z.ui.DowngradeModal=z.ui.Base.extend({className:\"settings-changer downgrade\",events:{\"click button.submit\":\"submit\",keyup:\"submit\"},initialize:function(options){var fields,requireOne,_ref;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}this.setMode(\"not\",\"saving\");requireOne=function(field,form){var val,_this=this;val=form.any(function(field){return field.get(\"value\")});return val};fields=[{label:\"Let us know why you are downgrading.\",help_text:\"Don't have the budget.\",key:\"Don't have the budget.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Only needed it for a short time.\",key:\"Only needed it for a short time.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Doesn't do what I need.\",key:\"Doesn't do what I need.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Stopped using the trigger/action service.\",key:\"Stopped using the trigger/action service.\",type:\"checkbox\",required:false,validator:requireOne},{key:\"comments\",label:\"Comments?\",help_text:\"We are a small team and details help us improve the product, so every little bit helps!\",type:\"text\",required:false,validator:requireOne}];return this.form=new z.model.FormSet(fields)},context:function(){var context;context={button:\"Downgrade my account\"};return context},render:function(){var view;this.$el.html(JST.settings_settings_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.form});this.$paramform.html(view.render().el);return this},submit:function(e){var _ref;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"is\",\"saving\"))return;if(!((_ref=this.form)!=null?_ref.isValid():void 0)){return this.$(\".feedback\").html(\"We're a small team here at Zapier and would really appreciate your feedback, double check you filled out the required field above. Thank you!\").addClass(\"error\")}else{this.$(\".feedback\").html(\"\").removeClass(\"error\")}this.setMode(\"is\",\"saving\");this.$(\"button\").attr(\"disabled\",\"true\").text(\"Downgrading...\");return this.save(this.form.getValues())},save:function(values){return log(\"to be overwritten\")}});z.ui.Invoices=z.ui.Base.extend({events:{\"click .details\":\"toggleDetails\"},initialize:function(){_.bindAll(this);z.app.account.on(\"change\",this.render,this);return z.app.invoices.on(\"change reset\",this.render,this)},context:function(){var context,d,date,m,periodEnd,y,_ref,_ref2,_ref3,_ref4,_ref5,_ref6;context={};if(((_ref=z.app.account.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.current_period_end:void 0:void 0)!=null&&!((_ref3=z.app.account.get(\"billing\"))!=null?(_ref4=_ref3.subscription)!=null?_ref4.cancel_at_period_end:void 0:void 0)){periodEnd=(_ref5=z.app.account.get(\"billing\"))!=null?(_ref6=_ref5.subscription)!=null?_ref6.current_period_end:void 0:void 0;date=new Date(periodEnd*1e3);d=date.getDate();m=date.getMonth()+1;y=date.getFullYear();context.billing_period_start_date=\"\"+m+\"-\"+d+\"-\"+y}return context},render:function(){var $invoices,html,_this=this;this.$el.html(JST.settings_invoices(this.context()));$invoices=this.$(\"#invoices\");html=\"\";z.app.invoices.each(function(invoice){var json;json=invoice.toFancyJSON();json.cid=invoice.cid;return html+=JST.settings_invoice(json)});if(html!==\"\")$invoices.html(html);return this},toggleDetails:function(e){var id;if(e!=null)e.preventDefault();id=$(e.currentTarget).attr(\"id\");this.$(\".invoice-details\").hide();return this.$el.find(\"#\"+id+\".invoice-details\").toggle()}});z.ui.SettingsOverview=z.ui.Base.extend({initialize:function(){var render;_.bindAll(this);render=_.debounce(this.render,40);z.app.account.on(\"change\",render,this);return z.app.plans.on(\"change\",render,this)},context:function(){var context,_ref;context=z.app.account.toJSON();context.plan=(_ref=z.app.account.getCurrentPlan())!=null?_ref.toJSON():void 0;context.status=this.getStatus();return context},render:function(){this.$el.html(JST.settings_overview(this.context()));return this},getStatus:function(){if(z.app.account.get(\"is_unlimited\"))return\"Unlimited\";if(z.app.account.get(\"is_trialing\"))return\"Trialing\";if(z.app.account.get(\"plan_active\"))return\"Active\";return\"Inactive\"}});z.ui.MyAccountSettings=z.ui.Base.extend({events:{\"click .account\":\"account\",\"click .email\":\"email\",\"click .user\":\"user\",\"click .advanced\":\"advanced\",\"click .close\":\"close\",\"click .bonus\":\"bonus\",\"click .auth\":\"auth\"},CONFIRM_PASSWORD_FIELD:{key:\"password\",label:\"Verify Current Password\",help_text:\"Please enter your password to make changes to these settings.\",type:\"password\",required:true},initialize:function(){return _.bindAll(this)},context:function(){var context;context={account:z.app.account.attributes};return context},render:function(){this.$el.html(JST.settings_my_account(this.context()));return this},bonus:function(e){if(e!=null)e.preventDefault();return z.useful.goto(\"/rewards\")},auth:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/authorizations\",{trigger:true})},account:function(e){var emailConfirmField,fields,form,modal;if(e!=null)e.preventDefault();if(z.app.account.get(\"email_confirmed\")){emailConfirmField={label:\"Confirm Email Address\",help_text_html:'<i class=\"icon-check\"></i> Your email address is confirmed.',type:\"copy\",required:false}}else{emailConfirmField={label:\"Confirm Email Address\",help_text_html:'<button class=\"confirm-email light smaller\">Send confirmation email</button>',type:\"copy\",required:false}}fields=[{key:\"email\",label:\"Email Address\",help_text:\"Make sure you can receive email at this address.\",type:\"unicode\",required:false,value:z.app.account.get(\"email\")},emailConfirmField,{key:\"password1\",label:\"New Password\",help_text:\"Leave this blank if you don't want to change your password.\",type:\"password\",required:false},{key:\"password2\",label:\"Confirm New Password\",help_text:\"Leave this blank if you don't want to change your password.\",type:\"password\",required:false},this.CONFIRM_PASSWORD_FIELD];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},email:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"manage_email_settings\",label:\"Manage Email Settings\",help_text_html:'<a target=\"_new\" href=\"/subscription/opt-out/manage/\">Manage all email subscription settings</a>.',required:false,type:\"copy\"},{key:\"summary_schedule\",label:\"Summary Schedule\",help_text:\"Daily or weekly summary of the tasks Zapier has performed.\",type:\"unicode\",choices:\"weekly,daily,never\",required:false,\"default\":z.app.account.get(\"summary_schedule\")},{key:\"alert_triggers\",label:\"Send Alerts on Failed Trigger\",help_text:'The recommended setting is \"never\". \"Repeated\" means we will only alert you once after 5 errors in a 24 hour cycle.',type:\"unicode\",choices:\"never,repeated,always\",required:false,\"default\":z.app.account.get(\"alert_triggers\")},{key:\"alert_actions\",label:\"Send Alerts on Failed Action\",help_text:'The recommended setting is \"always\". \"Repeated\" means we will only alert you once after 5 errors in a 24 hour cycle.',type:\"unicode\",choices:\"never,repeated,always\",required:false,\"default\":z.app.account.get(\"alert_actions\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},user:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"first_name\",label:\"First Name\",type:\"unicode\",required:false,value:z.app.account.get(\"first_name\")},{key:\"last_name\",label:\"Last Name\",type:\"unicode\",required:false,value:z.app.account.get(\"last_name\")},{key:\"company_name\",label:\"Company Name/Billing Info\",help_text:\"Mostly used in invoices, but can help us identify accounts.\",type:\"text\",required:false,value:z.app.account.get(\"company_name\")},{label:\"Change Your Profile Picture\",help_text_html:'We use Gravatar, a service that associates an avatar image with your email address.<br /><a target=\"_new\" href=\"https://en.gravatar.com/site/login/\">Change your Gravatar here.</a>',type:\"copy\",required:false},{key:\"timezone\",label:\"Set Your Timezone\",help_text:\"In the event that a service does not pass datetimes with timezone information (when a Zap runs), we can use this setting.\",type:\"unicode\",choices:z.app.account.get(\"timezone_choices\"),required:false,\"default\":z.app.account.get(\"timezone\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},advanced:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"disable_ssl_check\",label:\"Disable SSL Certificate Checks?\",help_text_html:'Only disable this if you\\'re experiencing problems and understand the risks in doing so. <a href=\"https://zapier.com/blog/2013/04/09/ssl-certificates-and-zapier/\" target=\"_new\">Learn more here</a>.',type:\"unicode\",choices:[\"no\",\"yes\"],required:false,value:z.app.account.get(\"disable_ssl_check\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},close:function(e){var fields,form,modal,save;if(e!=null)e.preventDefault();fields=[{key:\"word\",label:\"Confirm Delete\",help_text:'Confirm you really want to permanently delete your account by typing \"DELETE\" in all caps below.',type:\"unicode\",required:true,validator:function(model,collection){var data;data=collection.getValues();return data.word===\"DELETE\"}},{key:\"password\",label:\"Verify Current Password\",help_text:\"Verify your current password to delete your account.\",type:\"password\",required:true}];form=new z.model.FormSet(fields);save=function(values){var _this=this;if(values.word!==\"DELETE\"){this.saveError.call(this,this,{responseText:\"Confirmation word did not match.\"});return}return z.app.account.destroy({wait:true,data:JSON.stringify({password:values.password}),success:function(){return z.useful.goto(\"/\")},error:this.saveError})};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,button:\"Delete Account\",title:\"Permanently Delete Account and Data\"})})}});z.ui.BillingSettings=z.ui.Base.extend({events:{\"click .plans\":\"plans\",\"click .card\":\"card\",\"click .invoice\":\"invoice\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);if((_ref=this.options)!=null?_ref.card:void 0)return this.card()},context:function(){var context,plan_name,plan_rate,_ref,_ref2,_ref3,_ref4,_this=this;plan_name=\"Here\";plan_rate=\"\";z.app.plans.getIntervalPlans(this.variant).map(function(plan){if(plan.get(\"current_plan\")){plan_name=plan.get(\"name\");return plan_rate=\"$\"+plan.dollarsMo()+\"/month\"}});context={plan_name:plan_name,plan_rate:plan_rate};context[\"last4\"]=(_ref=z.app.account.toJSON().billing)!=null?(_ref2=_ref.cards)!=null?(_ref3=_ref2.data)!=null?(_ref4=_ref3[0])!=null?_ref4.last4:void 0:void 0:void 0:void 0;return context},render:function(){this.$el.html(JST.settings_billing(this.context()));return this},plans:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/plans\",{trigger:true})},invoice:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/invoices\",{trigger:true})},card:function(e){var card,context,fields,form,html,modal,save,validateCard,validateCvc,validateExp,_ref,_ref2;if(e!=null)if(typeof e.preventDefault===\"function\")e.preventDefault();card=(_ref=z.app.account.get(\"billing\"))!=null?_ref.active_card:void 0;context={};if(card!=null){context={type:card.type,last4:card.last4,expM:card.exp_month,expY:card.exp_year}}html=JST.settings_card(context);validateExp=function(model,collection){var month,year,_ref2,_ref3,_ref4,_ref5;month=(_ref2=collection.where({key:\"expmo\"}))!=null?(_ref3=_ref2[0])!=null?typeof _ref3.get===\"function\"?_ref3.get(\"value\"):void 0:void 0:void 0;year=(_ref4=collection.where({key:\"expyear\"}))!=null?(_ref5=_ref4[0])!=null?typeof _ref5.get===\"function\"?_ref5.get(\"value\"):void 0:void 0:void 0;return z.stripe.validateExpiry(month||\"0\",year||\"3000\")};validateCard=function(model,collection){return z.stripe.validateCardNumber(model.get(\"value\"))};validateCvc=function(model,collection){return z.stripe.validateCVC(model.get(\"value\"))\n};fields=[{label:\"Card on File\",help_text_html:html,type:\"copy\",required:false},{key:\"name\",label:\"Cardholder Name\",help_text:\"Fill out the rest of the form if you'd like to update the credit card you have on file.\",type:\"unicode\",required:true},{key:\"cardnumber\",label:\"Card Number\",type:\"unicode\",required:true,validator:validateCard},{key:\"expmo\",label:\"Month\",required:true,type:\"select\",placeholder:\"MM\",validator:validateExp},{key:\"expyear\",label:\"Year\",required:true,type:\"select\",placeholder:\"YYYY\",validator:validateExp},{key:\"cvc\",label:\"CVC\",type:\"unicode\",required:true,validator:validateCvc}];form=new z.model.FormSet(fields);save=function(values){var stripeHandler,_this=this;stripeHandler=function(status,response){var token;if(response.error){return _this.saveError.call(_this,_this,{responseText:response.error.message})}else{token=response.id;return z.app.account.saveCard(token,{success:_this.saveSuccess,error:_this.saveError})}};return z.stripe.createToken({name:values.name,number:values.cardnumber,cvc:values.cvc,exp_month:values.expmo,exp_year:values.expyear},stripeHandler)};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,title:(_ref2=this.$(e!=null?e.currentTarget:void 0))!=null?_ref2.text():void 0})})}});z.ui.AccountSettingsModal=z.ui.Base.extend({className:\"settings-changer\",events:{\"click .confirm-email\":\"sendEmailConfirmation\",\"click button.submit\":\"submit\",keyup:\"submit\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}return this.setMode(\"not\",\"saving\")},context:function(){var context;context={button:this.options.button,title:this.options.title};return context},render:function(){var view;this.$el.html(JST.settings_settings_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.options.form});this.$paramform.html(view.render().el);return this},submit:function(e){var values;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"is\",\"saving\"))return;this.setMode(\"is\",\"saving\");this.$(\".feedback\").html(\"\").removeClass(\"error\");this.$(\"button\").text(\"Working...\");values=this.options.form.getValues();return this.save(values)},saveSuccess:function(model){var text;this.unsetHelpers();this.setMode(\"not\",\"saving\");text=this.options.button!=null?this.options.button:\"Save changes\";this.$(\"button\").text(text);return this.modal.close()},saveError:function(model,xhr){var errors,text;this.unsetHelpers();this.setMode(\"not\",\"saving\");errors=z.useful.errors(xhr);this.$(\".feedback\").html(errors).addClass(\"error\");text=this.options.button!=null?this.options.button:\"Save changes\";return this.$(\"button\").text(text)},save:function(values){return z.app.account.save(values,{success:this.saveSuccess,error:this.saveError,wait:true,patch:true})},sendEmailConfirmation:function(e){var error,success,_this=this;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).hasClass(\"success\"))return;success=function(model,resp){return _this.$(\".confirm-email\").addClass(\"success\").text(\"Sent! Check your email\")};error=function(model,xhr){return _this.$(\".confirm-email\").addClass(\"error\").text(\"Error sending confirmation email\")};return z.app.account.sendEmailConfirmation({success:success,error:error})},unsetHelpers:function(){z.app.account.unset(\"password\",{silent:true});z.app.account.unset(\"password1\",{silent:true});z.app.account.unset(\"password2\",{silent:true});return z.app.account.unset(\"coupon\",{silent:true})}});\n/*\n//@ sourceMappingURL=https://zapier.cachefly.net/static/CUEKpp/build/app.js.map\n*/"
      },
      "/inline_a2ee291c85dc78d0a65192cb358b4829": {
         "body": "\n    var path = '/app/signup';\n    var mediaUrl = 'https://zapier.cachefly.net/static/CUEKpp/';\n    var preload = {};\n  \n    preload.account = {};\n  \n    var DEBUG = false;\n    var STRIPE_PUB_API_KEY = 'pk_phnG9Y3BlUIYXVpH1gkMOJ25RGbsI';\n    var TITLE_APPEND = ' - Zapier';\n    var PARTNER_ENVIRONMENT = null;\n    var PERSONAS = [\"Contractor\", \"Customer Support\", \"Designer\", \"Developer\", \"Freelancer\", \"Government\", \"Human Resource\", \"Information Technology\", \"Lawyer\", \"Marketer\", \"Non-Profit\", \"Real Estate\", \"Sales\", \"Small Business Owner\", \"Other\"];\n    \n  ",
         "pageUrl": "https://zapier.com/app/signup",
         "scriptUrl": "/inline_a2ee291c85dc78d0a65192cb358b4829"
      },
      "https://zapier.cachefly.net/static/CUEboR/build/templates.js": {
         "pageUrl": "https://zapier.com/zapbook/gmail/",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEboR/build/templates.js",
         "body": "(function(){window.JST=window.JST||{};window.JST[\"login\"]=JST('<h1>Login</h1>\\n<form id=\"login-form-static\" autocomplete=\"on\" action=\"/login/\" method=\"post\">\\n  <!-- the id of the form, login-form, is depended upon to sub in/out of the DOM -->\\n  <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\" />\\n  <input type=\"hidden\" name=\"next\" value=\"{{next}}\" />\\n  <input id=\"email\" name=\"email\" type=\"text\" class=\"account\" placeholder=\"Email\" autocomplete=\"on\" />\\n  <input id=\"password\" name=\"password\" type=\"password\" class=\"password\" placeholder=\"Password\" autocomplete=\"on\" />\\n  <input type=\"submit\" class=\"submit\" value=\"Log In\" />\\n  <span class=\"alt-cta\"><a href=\"/app/forgot\" data-nav=\"app/forgot\">Forgot password?</a></span>\\n  <p class=\"feedback error\">\\n    {{#equals status \"tryagain\"}}Incorrect email or password.{{/equals}}\\n  </p>\\n</form>\\n<div class=\"signup\">Don\\'t have a Zapier account yet? <em><a href=\"/app/signup{{#if next}}?next={{next}}{{/if}}\" data-nav=\"app/signup{{#if next}}?next={{next}}{{/if}}\">Signup Now!</a></em></div>');window.JST[\"test\"]=JST(\"<div>hello world</div>\");window.JST[\"preloader\"]=JST('<div class=\"preloader\">\\n  <div class=\"boundary\">\\n    <div class=\"progress\" src=\"{{mediaURL}}images/logo60orange.png\"></div>\\n    <div class=\"logo\" src=\"{{mediaURL}}images/logo60grey.png\"></div>\\n  </div>\\n  <div class=\"retry\">So sorry! Let\\'s try that again, shall we? <button>Refresh this page</button></div>\\n</div>');window.JST[\"dashboard_zaps\"]=JST('{{#hasAtLeastOne z.app.reads}}\\n\\n  <div class=\"live-block\">\\n    <h2>On</h2>\\n    <div class=\"empty-block\">You have no Zaps turned on. <a href=\"#\" data-nav=\"app/editor\">Make a new Zap</a>{{#unless isPartner}} or <a href=\"#\" data-nav=\"app/explore\">Explore Zap templates to start with</a>{{/unless}}.</div>\\n  </div>\\n\\n  <div class=\"paused-block\">\\n    <h2>Off</h2>\\n    <div class=\"empty-block\">You have no Zaps turned off.</div>\\n  </div>\\n\\n  <div class=\"unfinished-block\">\\n    <h2>Drafts</h2>\\n    <div class=\"empty-block\">You have no Unfinished Zaps.</div>\\n  </div>\\n\\n{{else}}\\n\\n<div class=\"no-zaps inlay\">\\n  <h2>You haven\\'t built any Zaps yet!</h2>\\n  <a class=\"pill-button orange huge\" href=\"/app/editor\" data-nav=\"app/editor\">Make your first Zap now</a>\\n</div>\\n\\n{{/hasAtLeastOne}}\\n');window.JST[\"dashboard_logs\"]=JST('<h3>Task History</h3>\\n{{#hasAtLeastOne logs}}\\n<a href=\"/app/history\" data-nav=\"app/history\" class=\"right-link\">See all</a>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"dashboard-log\">\\n{{#each logs max=8}}\\n  <div class=\"history\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\" title=\"Click for more details\">\\n    <div class=\"services\">\\n      <div class=\"service\">\\n        <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n      </div>\\n      <i class=\"fa fa-caret-right caret\"></i>\\n      <div class=\"service\">\\n        <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n      </div>\\n    </div>\\n    <div class=\"title\">{{this.object_title}}</div>\\n    <div class=\"timesince\">{{this.timesince}} ago</div>\\n    <div class=\"status-indicator {{this.data.status}}\"></div>\\n  </div>\\n{{else}}\\n  <div>\\n    <div class=\"empty\"><em>No recent activity.</em></div>\\n  </div>\\n{{/each}}\\n</div>\\n\\n{{#hasAtLeastOne logs}}\\n<p class=\"small more\"><a href=\"/app/history\" data-nav=\"app/history\">See all task history</a></p>\\n{{/hasAtLeastOne}}');window.JST[\"dashboard_search\"]=JST('<div class=\"tabs\">\\n{{#equals selected \\'dashboard\\'}}\\n  <h2>My Zaps <span class=\"link\">(see <a href=\"/app/dashboard/shared\" data-nav=\"app/dashboard/shared\">Shared</a>)</span></h2>\\n{{else}}\\n  <h2>Shared <span class=\"link\">(see <a href=\"/app/dashboard\" data-nav=\"app/dashboard\">My Zaps</a>)</span></h2>\\n{{/equals}}\\n</div>\\n<div class=\"search-bar\">\\n  <i class=\"fa fa-search\"></i>\\n  <input type=\"text\" placeholder=\"Filter my Zaps by name or app...\" value=\"{{search}}\" />\\n  <a href=\"#\" class=\"clear\"><i class=\"fa fa-times-circle\"></i></a>\\n</div>\\n<div class=\"clearfix\"></div>');window.JST[\"dashboard_bonus\"]=JST('<div class=\"top-hat\">\\n  Get Free Bonuses\\n  <div class=\"right\"><em><a class=\"blue\" href=\"/bonus\">learn more</a></em></div>\\n</div>\\n\\n<div class=\"content\">\\n  <ol>\\n  {{#each bonuses}}\\n    <li class=\"bonus {{#if earned}}earned{{/if}} {{#if partial_earned}}partial_earned{{/if}}\" id=\"{{this.id}}\">\\n\\n      <span class=\"description\">\\n        <i class=\"checkmark\"></i>\\n        <h5>\\n          {{#unless earned}}<a href=\"/bonus\">{{/unless}}\\n          {{title}}\\n          {{#unless earned}}</a>{{/unless}}\\n        </h5>\\n        <br />\\n        <span class=\"count\">\\n          {{#notequals limit \"1\"}}\\n          earned {{times_earned}} / {{#equals limit \"-1\"}}unlimited{{else}}{{limit}}{{/equals}} times\\n          {{/notequals}}\\n        </span>\\n      </span>\\n\\n      <div class=\"incentive\">\\n        <span class=\"number\">+{{action_limit_extra}}</span> tasks\\n      </div>\\n\\n    </li>\\n  {{/each}}\\n  </ol>\\n\\n</div>');window.JST[\"dashboard_shared_zap_menu\"]=JST('<ul class=\"zap-menu\">\\n  <li><a href=\"#\" class=\"rename\"><i class=\"fa fa-tag\"></i> Rename</a></li>\\n  <li><a href=\"#\" class=\"permalink\"><i class=\"fa fa-link\"></i> Permalink</a></li>\\n  <li>\\n  <a href=\"#\" class=\"delete\">\\n    <i class=\"fa fa-times-circle\"></i>\\n    <span class=\"default\">Delete</span>\\n    <span class=\"confirm\">Really delete?</span>\\n  </a>\\n  </li>\\n</ul>');window.JST[\"dashboard_zap\"]=JST('{{#greater read.held_items 0}}\\n<a class=\"held button\" title=\"This Zap has {{read.held_items}} waiting for your review before they can be processed.\" href=\"/engine/zaps/{{read.id}}/release\"><i class=\"fa fa-exclamation-circle\"></i></a>\\n{{else}}\\n{{#if unseen}}\\n<a class=\"count button\" title=\"View recent task history ({{unseen}}) for this Zap\" href=\"/app/history/?write_id={{write.id}}\" data-nav=\"app/history?write_id={{write.id}}\">{{unseen}}</a>\\n{{/if}}\\n{{/greater}}\\n\\n<div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n\\n<div class=\"twrapper\">\\n  <div class=\"services\">\\n    <div class=\"service {{ cssReadClass }}\" title=\"[Service name]\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{ cssWriteClass }}\" title=\"Connect {{ recipe.write_service.title }}\"></div>\\n  </div>\\n  <div class=\"title\">{{try title \"Unnamed Zap\"}}</div>\\n\\n  <div class=\"controls\">\\n    {{#unless errorString}}\\n    <div class=\"toggle\">\\n      <a href=\"#\" class=\"switch\" data-toggle=\"off\">Off</a>\\n      <div class=\"toggle-container{{#unless read.paused}} on{{/unless}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-toggle=\"on\">On</a>\\n    </div>\\n    {{/unless}}\\n    <div class=\"open-menu\">\\n      <div class=\"menu-button\">\\n        <i class=\"fa fa-cog\"></i>\\n      </div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"dashboard_limits\"]=JST('<h3>Account Usage</h3>\\n{{#each limits.allotment}}\\n  <div class=\"limit\" id=\"{{slugify name}}\">\\n    <div class=\"name\">{{name}}</div>\\n\\n    <div class=\"count\">{{this.count}} / {{limit}}</div>\\n\\n    <div class=\"progress-bar striped\">\\n      <div class=\"bar {{status}}\" style=\"width: {{percent}}%;\"></div>\\n    </div>\\n\\n  </div>\\n{{/each}}\\n\\n<p class=\"small cycle\">Monthly Usage Resets In: {{limits.billing_cycle_time_left}}</p>\\n\\n<p class=\"small\"><a href=\"#\" data-nav=\"/app/settings/plans\" title=\"See other available pricing plans\">Need more tasks or Zaps?</a></p>');window.JST[\"dashboard_collection\"]=JST('<a href=\"#\" class=\"button\">Create an embeddable widget</a>');window.JST[\"dashboard_shared_zap\"]=JST('<div class=\"title-narrow\">{{try description \"Unnamed Zap\"}}</div>\\n\\n<div class=\"twrapper\">\\n  <div class=\"services\">\\n    <div class=\"service {{ cssReadClass }}\" title=\"[Service name]\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{ cssWriteClass }}\" title=\"Connect {{ recipe.write_service.title }}\"></div>\\n  </div>\\n  <div class=\"title\">{{try description \"Unnamed Zap\"}}</div>\\n\\n  <div class=\"controls\">\\n    <div class=\"open-menu\">\\n      <div class=\"menu-button\">\\n        <i class=\"fa fa-cog\"></i>\\n      </div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"dashboard_partner_text\"]=JST('<div class=\"step\">\\n  <h1>Zapier enables you to connect {{service}} to hundreds of other web services!</h1>\\n  <a href=\"#\" class=\"button orange big\">Learn How &nbsp; <i class=\"fa fa-arrow-right \"></i></a>\\n</div>\\n\\n<div class=\"step hide\">\\n  <h1>Zaps automate common tasks.</h1>\\n  <h2>Here is an example:</h2>\\n  <div class=\"example\">\\n    <div class=\"zap-step\">\\n      <i class=\"img64 {{readService}}64x64\"></i> {{readAction}}\\n      <br />\\n      <img src=\"{{mediaURL}}images/arrows/trigger.png\"></img>\\n    </div>\\n\\n    <div class=\"zap-step\">\\n      <i class=\"img64 {{writeService}}64x64\"></i> {{writeAction}}\\n      <br />\\n      <img src=\"{{mediaURL}}images/arrows/action.png\"></img>\\n    </div>\\n  </div>\\n  <div class=\"clear\"></div>\\n  <a href=\"#\" class=\"button orange big\">Alright, let\\'s do this! &nbsp; <i class=\"fa fa-arrow-right \"></i></a>\\n</div>\\n\\n<div class=\"step hide\">\\n  <h1>Pick a Zap over here to get started!</h1>\\n  <br/>\\n  <img src=\"{{mediaURL}}images/arrows/right.png\" />\\n</div>');window.JST[\"dashboard_zap_menu\"]=JST('<ul class=\"zap-menu\">\\n{{#if canRun}}\\n  {{#unless errorString}}\\n  {{#unless read.paused}}\\n  <li><a href=\"#\" class=\"run\"><i class=\"fa fa-repeat\"></i> Run</a></li>\\n  {{/unless}}\\n  {{/unless}}\\n{{else}}\\n  {{#unless errorString}}\\n  {{#unless read.paused}}\\n  <li class=\"no-hover\"><a href=\"#\" class=\"instant\"><i class=\"fa fa-bolt\"></i> Instant!</a></li>\\n  {{/unless}}\\n  {{/unless}}\\n{{/if}}\\n<li>\\n  <a href=\"#\" class=\"edit\" data-nav=\"app/editor/{{read.id}}\">\\n    <i class=\"fa fa-edit\"></i> Edit\\n  </a>\\n</li>\\n<li><a href=\"#\" class=\"logs\" data-nav=\"app/history?write_id={{write.id}}\"><i class=\"fa fa-bars\"></i> History</a></li>\\n<li>\\n  <a href=\"#\" class=\"copy\">\\n    <i class=\"fa fa-copy\"></i>\\n    <span class=\"default\">Copy</span>\\n    <span class=\"working\">Copying...</span>\\n  </a>\\n</li>\\n<li><a href=\"#\" class=\"rename\"><i class=\"fa fa-tag\"></i> Rename</a></li>\\n<li><a href=\"#\" class=\"share\"><i class=\"fa fa-share\"></i> Share</a></li>\\n<li>\\n<a href=\"#\" class=\"delete\">\\n  <i class=\"fa fa-times-circle\"></i>\\n  <span class=\"default\">Delete</span>\\n  <span class=\"confirm\">Really delete?</span>\\n</a>\\n</li>\\n</ul>');window.JST[\"dashboard_subscribe\"]=JST('<span class=\"subscribe-info\">\\n<p class=\"small\">Want tips to help you become more efficient, productive, and awesome?</p>\\n<a href=\"#\" class=\"button\">Subscribe to the Zapier blog!</a>\\n</span>\\n\\n<span class=\"subscribe-message\">\\n<p>Want tips to help you become more efficient, productive, and awesome?</p>\\n<p class=\"success\"><i class=\"fa fa-check\"></i>&nbsp;Great, welcome inside!</p>\\n<p>Enjoy some of the best workplace productivity advice around.</p>\\n</span>');window.JST[\"dashboard_create\"]=JST('<a href=\"#\" class=\"orange button\" data-nav=\"app/editor\">Make a New Zap</a> {{#unless isPartner}}<span class=\"alt-cta\">or <a href=\"#\" data-nav=\"app/explore\" title=\"Explore Zap templates to start with\">Explore Zaps</a></span>{{/unless}}');window.JST[\"dashboard_partner_zaps\"]=JST('<h2>Select {{service}} Zaps</h2>\\n\\n{{#each recipes}}\\n  <div class=\"zap-mini\">\\n\\n    <div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n    <div class=\"twrapper\">\\n      <div class=\"services\">\\n        <div class=\"service {{this.read_service_selected_api}}32x32\"></div>\\n        <span class=\"fa fa-caret-right caret\"></span>\\n        <div class=\"service {{this.write_service_selected_api}}32x32\"></div>\\n      </div>\\n      <div class=\"title\">{{this.short_description}}</div>\\n\\n      <div class=\"controls\">\\n        <div class=\"use-this\">\\n          <button data-template-id=\"{{this.id}}\">Use This</button>\\n        </div>\\n      </div>\\n    </div>\\n\\n  </div>\\n{{/each}}\\n\\n<br/>\\n\\n{{#if button}}\\n  <button data-nav=\"app/edit\" class=\"large\">Or create your own {{service}} Zap!</button>\\n{{/if}}');window.JST[\"dashboard_base\"]=JST('<!-- <div class=\"row\">\\n  <div class=\"container shave\">\\n    <h1 class=\"shave\">Zap Dashboard</h1>\\n  </div>\\n</div> -->\\n\\n<div class=\"row dashboard\">\\n  <div class=\"container empty\">\\n    <!-- sorry, we\\'ll come back to it... -->\\n    <!-- empty dashboard on partner -->\\n    <div class=\"column one-half left\"></div>\\n    <div class=\"column one-half right\"></div>\\n    <div class=\"clear\"></div>\\n  </div>\\n\\n  <div class=\"container\">\\n    <div class=\"column two-thirds main-col\">\\n      <div class=\"search\"></div>\\n      <div class=\"zaps\"></div>\\n      <div class=\"start\"></div>\\n    </div>\\n    <div class=\"column one-third side-col\">\\n    </div>\\n  </div>\\n</div>\\n');window.JST[\"dashboard_shared_zaps\"]=JST('{{#hasAtLeastOne z.app.recipes}}\\n  <h2>Zap Templates Shared With Others</h2>\\n\\n  <div class=\"shared-zaps\"></div>\\n{{else}}\\n  <div class=\"no-zaps inlay\">\\n    <h2>You haven\\'t shared any Zaps yet!</h2>\\n    <a class=\"pill-button orange huge\" href=\"/app/dashboard\" data-nav=\"app/dashboard\">Share one from the dashboard now</a>\\n  </div>\\n{{/hasAtLeastOne}}\\n');window.JST[\"common_rename_modal\"]=JST('<form>\\n<input type=\"text\" value=\"{{value}}\" placeholder=\"Name\" />\\n<button class=\"save orange\">Save</button>\\n<button class=\"close\">Cancel</button>\\n</form>');window.JST[\"common_base_modal\"]=JST('<div class=\"modal-container\">{{#unless noX}}<div class=\"x\"><i class=\"fa fa-times-circle\"></i></div>{{/unless}}<div class=\"modal invisible\"></div></div>');window.JST[\"common_data_table_modal\"]=JST('<table class=\"fields-table table table-bordered table-striped\">\\n{{#each data}}\\n  {{#notequals this.value \"[object Object]\"}}\\n    <tr>\\n      <td class=\"key\"><strong>{{this.key}}</strong></td>\\n      <td class=\"value\"><pre>{{this.value}}</pre></td>\\n    </tr>\\n  {{/notequals}}\\n{{/each}}\\n</table>');window.JST[\"common_auth_edit_modal\"]=JST('<ul>\\n  <li class=\"rename\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-pencil\"></span> Rename this Account</a></li>\\n  {{#unless onEditor}}\\n  <li class=\"delete\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-trash\"></span> Delete this Account</a></li>\\n  {{else}}\\n  <li class=\"manage\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-th-list\"></span> Manage your Accounts</a></li>\\n  {{/unless}}\\n</ul>');window.JST[\"common_since_you_been_gone_modal\"]=JST('<div class=\"row border\">\\n  <h1 class=\"center\">Good To See You Again!</h1>\\n  <p>We\\'ve been working hard to make your life easier. Here\\'s what\\'s new since you last visited...</p>\\n</div>\\n\\n<div class=\"blog\">\\n\\n{{#each updates}}\\n  <div class=\"entry border\">\\n    <div class=\"title\">\\n      <div class=\"service\">\\n        <div class=\"service img64 {{selected_api}}64x64\"></div>\\n      </div>\\n      <h2><a href=\"{{link}}\">{{title}}</a></h2>\\n    </div>\\n\\n    <div class=\"date\">{{prettyISO date}} by {{added_by_name}}</div>\\n\\n    {{{description_trunc}}}\\n  </div><!-- entry -->\\n{{/each}}\\n\\n</div><!-- blog -->\\n<br />\\n<a href=\"/zapbook/updates\">See more updates <i class=\"fa fa-arrow-right\"></i></a>');window.JST[\"common_recipe\"]=JST('<div class=\"recipe\">\\n\\n  <div class=\"images\">\\n    <div class=\"read\"><div class=\"img32 {{this.read_service_selected_api}}32x32\"></div></div>\\n    <div class=\"arrow\">&#9658;</div>\\n    <div class=\"write\"><div class=\"img32 {{this.write_service_selected_api}}32x32\"></div></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    <div class=\"description\"><a class=\"underline\" href=\"#\" data-id=\"{{this.id}}\">{{this.short_description}}</a></div>\\n  </div>\\n\\n  <a href=\"#\" data-id=\"{{this.id}}\"><button>Use This!</button></a>\\n\\n</div>');window.JST[\"common_share_zap_modal\"]=JST('<h1>Share This Zap Template!</h1>\\n\\n<p>Help your friends and colleagues save time by allowing them to use your Zap as a template to start with.</p>\\n<p>You\\'ll instantly be rewarded with <strong>50 FREE tasks/month</strong> for sharing!</p>\\n\\n<div class=\"services\">\\n  <div class=\"service\">\\n    <div class=\"service-icon {{readClass}}\"></div>\\n  </div>\\n  <i class=\"fa fa-caret-right caret\"></i>\\n  <div class=\"service\">\\n    <div class=\"service-icon write {{writeClass}}\"></div>\\n  </div>\\n</div>\\n<div class=\"zap-title\">{{try zapTitle \"Unnamed Zap\"}}</div>\\n\\n<div class=\"loading\">Loading fields...</div>\\n\\n<form class=\"share-it\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Share Zap Template\" class=\"big orange submit\" /> <span class=\"alt-cta\"><a class=\"no-thanks close\" title=\"Skip and close this window\">Skip this for now</a></span>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_auth_create_modal\"]=JST('<form class=\"auth\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Continue\" class=\"submit orange\" onclick=\"{{onclick}}\" /> &nbsp; <small>Having trouble connecting? Try <a href=\"/help/search/?{{{serviceHelpQueryString}}}\" target=\"_blank\">searching our help docs!</a></small>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_auth_request_modal\"]=JST('<p>This will send an email asking for permission for you to access their <strong>{{call service.getName context=service}}</strong> account. We\\'ll email you when they finish.</p>\\n<form class=\"auth\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Request Access\" class=\"submit orange\" />\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_run_zap_modal\"]=JST('<h2>Manually Running Zap Now...</h2>\\n<ul>\\n  {{#each messages}}\\n  <li class=\"{{#contains this \"failed\"}}error{{/contains}}\">{{this}}</li>\\n  {{else}}\\n  <li>Running {{title}}...</li>\\n  {{/each}}\\n</ul>\\n{{#if noItemsFound}}\\n{{/if}}');window.JST[\"common_auth_error_modal\"]=JST('{{#equals type \"manual\"}}\\n<h2>We received an error while testing</h2>\\n{{else}}\\n<h2>We hit an error adding your new account</h2>\\n{{/equals}}\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  {{#equals type \"manual\"}}<li>Delete and re-add this Account</li>{{/equals}}\\n  {{#if hasUpfronts}}\\n    <li>Make sure the values you type in are correct</li>\\n    <li>Watch out for trailing-spaces on API Keys or Codes</li>\\n  {{else}}\\n    <li>Make sure you click \"Allow\" or \"Accept\" on the permission popup</li>\\n    <li>Double check your Account has the correct permissions</li>\\n  {{/if}}\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"common_menu_modal\"]=JST('<ul>\\n   <li class=\"menu-settings\"><a href=\"/app/settings\" data-nav=\"app/settings\"><i class=\"fa fa-cog\"></i>Settings</a></li>\\n   <li class=\"menu-history\"><a href=\"/app/history\" data-nav=\"app/history\"><i class=\"fa fa-clock-o\"></i>Task History</a></li>\\n   <li class=\"menu-connected-accounts\"><a href=\"/app/settings/authorizations\" data-nav=\"app/settings/authorizations\"><i class=\"fa fa-bolt\"></i>Connected Accounts</a></li>\\n   <li class=\"menu-help\"><a href=\"/help/\"><i class=\"fa fa-medkit\"></i>Support</a></li>\\n   <li class=\"menu-developer\"><a href=\"/developer\"><i class=\"fa fa-flask\"></i>Developers</a></li>\\n   <li class=\"menu-logout\"><a href=\"/logout\"><i class=\"fa fa-power-off\"></i>Logout</a></li>\\n</ul>');window.JST[\"common_select_modal\"]=JST('<ul>\\n  {{#each choices}}\\n    <li><a href=\"#\" data-key=\"{{key}}\" data-value=\"{{value}}\">{{#if value}}{{value}}{{else}}(empty){{/if}}</a></li>\\n    {{else}}\\n    <li><a href=\"#\">(No values to pick from)</a></li>\\n  {{/each}}\\n</ul>');window.JST[\"common_service_picker_modal\"]=JST('<div class=\"top\">\\n  <h1>Pick a Service</h1>\\n  <input class=\"search\" type=\"text\" placeholder=\"Search services by name...\" value=\"{{search}}\"></input>\\n  <clear></clear>\\n  <a class=\"reset\" href=\"#\">clear</a>\\n</div>\\n\\n<div class=\"container\">\\n  <div class=\"selector-bg\"><ul class=\"selector\"></ul></div>\\n  <div class=\"scroll\"></div>\\n</div>');window.JST[\"common_auth_delete_message\"]=JST('Delete {{appNameFromKey service}} Account {{#if title}}\"{{title}}\"{{/if}}');window.JST[\"common_share_thanks_modal\"]=JST('<div class=\"center\">\\n<h2>Thank you for sharing!</h2>\\n<p>Share this Zap, and for each person who clicks<br>and signs up, you <i>both</i> get <strong>100 free tasks/month</strong>!</p>\\n\\n\\n<p><a href=\"{{twitter_href}}\" data-record-click=\"share twitter\" target=\"_blank\" title=\"Share this Zap on Twitter\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/twitter.png\" alt=\"twitter share\"></a><a href=\"{{facebook_href}}\" data-record-click=\"share facebook\" target=\"_blank\" title=\"Share this Zap on Facebook\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/facebook.png\" alt=\"facebook share\"></a><a href=\"{{linkedin_href}}\" data-record-click=\"share linkedin\" target=\"_blank\" title=\"Share this Zap on LinkedIn\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/linkedin.png\" alt=\"linkedin share\"></a><a href=\"{{email_href}}\" data-record-click=\"share email\" target=\"_blank\" title=\"Share this Zap via Email\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/email.png\" alt=\"email share\"></a></p>\\n\\n<p><input class=\"share-link\" type=\"text\" onclick=\"this.select();\" value=\"{{ recipe.share_url }}\"></p>\\n<p class=\"small\"><a href=\"{{ recipe.share_url }}\" target=\"_blank\">Open this link in a new window</a></p>\\n</div>');window.JST[\"common_login_modal\"]=JST('<form id=\"login-form\" autocomplete=\"on\" action=\"/login/?next={{path}}\" method=\"post\">\\n  <!-- the id of the form, login-form, is depended upon to sub in/out of the DOM -->\\n  <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\" />\\n  <input id=\"email\" name=\"email\" type=\"text\" class=\"account\" placeholder=\"Email\" autocomplete=\"on\" />\\n  <input id=\"password\" name=\"password\" type=\"password\" class=\"password\" placeholder=\"Password\" autocomplete=\"on\" />\\n  <input type=\"submit\" value=\"Log In\" />\\n  <span class=\"alt-cta\"><a href=\"/app/forgot\" data-nav=\"app/forgot\">Forgot your password?</a></span>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_upgrade_modal\"]=JST('<h2><i class=\"\"></i> You\\'ll need to upgrade to do that!</h2>\\n{{#if hasErrors}}\\n<ul class=\"because\">\\n  {{#each errors}}\\n    <li>{{this}}</li>\\n  {{/each}}\\n</ul>\\n{{/if}}\\n<a class=\"pill-button larger\" href=\"/app/settings/plans\" data-nav=\"app/settings/plans\">Click here to see which plan best suites you</a>\\n\\n{{#if hasErrors}}\\n{{else}}\\n<br/> \\n<h3>Common reasons you may need to upgrade</h3>\\n<ol>\\n  <li>You\\'re trying to enable a Zap which includes a Premium Service</li>\\n  <li>You have maxed out the number of live Zaps for your current plan</li>\\n  <li>You\\'re over your task limit for the month</li>\\n  <li>You\\'re trying to enable a Zap which includes an invite-only Developer App</li>\\n</ol>\\n{{/if}}\\n');window.JST[\"common_unpause_error_modal\"]=JST('<h2>We received an error turning this Zap on</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Double check your accounts for this Zap work (test them)</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"common_collect_email_modal\"]=JST('<h2>Sorry! This App Isn\\'t Available Yet</h2>\\n<p>New apps are added to Zapier often and we need you to tell us which ones you want most.</p>\\n<p>Add your email below and we\\'ll notify you when this app is ready to use in your Zaps. Your vote helps this app become available sooner.</p>\\n\\n<form id=\"login-form\" autocomplete=\"on\">\\n  <input id=\"email\" name=\"email\" type=\"text\" placeholder=\"Your email...\" autocomplete=\"on\" />\\n  <input type=\"submit\" value=\"Vote for this app!\" class=\"orange\" />\\n  <p class=\"feedback hide\"></p>\\n</form>\\n');window.JST[\"common_create_collection_modal\"]=JST('<div class=\"row\">\\n    <div class=\"container shave center\">\\n        <h1>Make Your Own Zap Widget</h1>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <h3>1. Select Zaps To Include</h3>\\n        <p>Choose which shared Zaps below to include in your widget.</p>\\n        <div class=\"results\"></div>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <h3>2. Preview Your Zap Widget</h3>\\n        <p>This is how your Zap widget will look on your website or blog.</p>\\n        <div class=\"embed\"></div>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <p><a class=\"button close orange\">Close Window</a></p>\\n    </div>\\n</div>');window.JST[\"common_auth_row\"]=JST(' <div class=\"pill-row-wrapper\">\\n\\n  <li class=\"auth pill-row {{#if selected}}selected{{/if}}\" id=\"{{id}}\">\\n\\n    <div class=\"radio\"></div>\\n\\n    <div class=\"icon\"><div class=\"img16 {{service}}16x16\"></div></div>\\n\\n    <div class=\"text name\">\\n      {{appNameFromKey service}}\\n    </div>\\n\\n    <div class=\"text description\">\\n      {{title}}\\n    </div>\\n\\n    <div class=\"clear\"></div>\\n  </li>\\n\\n  <div class=\"test {{#equals testStatus \"success\"}}success{{/equals}} {{#equals testStatus \"error\"}}error{{/equals}}\" id=\"{{id}}\">\\n    <div class=\"text-container\"><div class=\"text\">\\n      {{#equals testStatus null}}Test this Account{{/equals}}\\n      {{#equals testStatus \"testing\"}}Testing...{{/equals}}\\n      {{#equals testStatus \"slow\"}}Still testing...{{/equals}}\\n      {{#equals testStatus \"success\"}}Account is working!{{/equals}}\\n      {{#equals testStatus \"error\"}}Account not working{{/equals}}\\n    </div></div>\\n  </div>\\n\\n  <div class=\"gear\" id=\"{{id}}\">\\n    <div class=\"text-container\"><div class=\"text\">\\n    <img src=\"{{mediaURL}}images/frontend/gear.png\"></img>\\n    </div></div>\\n  </div>\\n\\n  </div> <!-- pill-row-wrapper -->');window.JST[\"common_service_panel\"]=JST('<li class=\"panel {{#if selected}}selected{{/if}}\" id=\"{{service}}\">\\n<div class=\"img64 {{service}}64x64\"></div>\\n<span>{{name}}</span>\\n</li>');window.JST[\"common_confirm_modal\"]=JST('<form>\\n<h2>Are you sure you want to do that?</h2>\\n<h3>{{message}}</h3>\\n<br />\\n<button class=\"yes\">Yes</button>\\n<button class=\"no orange\">No</button>\\n</form>');window.JST[\"support_contact_modal\"]=JST('<div class=\"header\">\\n\t<h1>Questions? We\\'re here to help!</h1>\\n\t<div class=\"picture-small\" title=\"Micah!\"><img src=\"{{ mediaUrl }}images/team/micah-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Wade!\"><img src=\"{{ mediaUrl }}images/team/wade-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Mike!\"><img src=\"{{ mediaUrl }}images/team/mike-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Bryan!\"><img src=\"{{ mediaUrl }}images/team/bryan-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"James!\"><img src=\"{{ mediaUrl }}images/team/james-square.jpg\"></img></div>\\n    <div class=\"picture-small\" title=\"Cooksey!\"><img src=\"{{ mediaUrl }}images/team/cooksey-square.jpg\"></img></div>\\n    <div class=\"picture-small\" title=\"Danny!\"><img src=\"{{ mediaUrl }}images/team/danny-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Al!\"><img src=\"{{ mediaUrl }}images/team/al-square.jpg\"></img></div>\\n</div>\\n\\n<paramform></paramform>\\n\\n<p class=\"feedback\"></p>\\n<p class=\"small\">Average response time: <strong>2h 37m</strong> during business hours (M-F 9am-5pm PST).</p>\\n<button class=\"submit\">Send Request</button>');window.JST[\"support_definition\"]=JST('{{{ text }}}\\n\\n{{#if slug}}\\n<a class=\"read-more\" href=\"/help/{{slug}}\">Learn more...</a>\\n{{/if}}');window.JST[\"support_base\"]=JST(\"<div>{{label}}</div>\");window.JST[\"support_note\"]=JST('<div class=\"support-note{{#if first}} first{{/if}}\">\\n  {{#if title}}<h1>{{title}}</h1>{{/if}}\\n  \\n  {{{html}}}\\n\\n  {{#if isStaff}}\\n    <div style=\"text-align:right\"><small><a href=\"/admin/support/note/{{id}}/\">edit this note</a></small></div>\\n  {{/if}}\\n  {{#if first}}{{#if more}}<div class=\"more\">Not exactly what you were looking for? We have some other possibly related sections below.</div>{{/if}}{{/if}}\\n</div>');window.JST[\"pricing_plans\"]=JST('<div class=\"row\">\\n  <div class=\"container shave center\">\\n    <h1>Pricing Plans</h1>\\n\\n    <div class=\"toggle toggle-interval\">\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"month\">Monthly</a>\\n      <div class=\"toggle-container{{#if monthly}}{{else}} on{{/if}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"year\">Yearly (1 Month Free)</a>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"row border\">\\n  <div class=\"container center\">\\n    <div class=\"plans\">\\n    {{#each plans}}\\n      <div class=\"plan\" data-plan=\"true\">\\n        <h2>{{get this \"name\"}}</h2>\\n        <div class=\"price\">\\n          ${{dollars}}<span class=\"sup\">/ {{get this \"interval\"}}</span>\\n        </div>\\n        <div class=\"features\">\\n          <ul>\\n            <li class=\"important\" data-explain-highlight=\"zaps\"><strong>{{zaps}}</strong> Zaps</li>\\n            <li class=\"important\" data-explain-highlight=\"interval\">Zaps run every <strong>{{pollInterval}} {{pollIntervalTimeFrame}}</strong></li>\\n            <li class=\"important\" data-explain-highlight=\"tasks\"><strong>{{tasksMo}}</strong> Tasks/month</li>\\n            {{#hasExactly this.blacklistedServices 0}}\\n              <li class=\"important\" data-explain-highlight=\"services\">Premium Services</li>\\n            {{/hasExactly}}\\n            {{#each this.extraFeatures}}\\n              <li class=\"important\">{{{title_html}}}</li>\\n            {{/each}}\\n          </ul>\\n        </div>\\n        {{#if \"\"}}<div class=\"get\">\\n          <button class=\"larger\" data-nav=\"app/signup\">{{#equals dollars 0}}Signup For Free{{else}}Start 14 Day Trial{{/equals}}</button>\\n        </div>{{/if}}\\n        <a class=\"big orange button\" data-nav=\"app/signup\">Start FREE Trial</a>\\n      </div>\\n    {{/each}}\\n    </div>\\n\\n    <p>Need more? <a href=\"mailto:contact@zapier.com\">Send us a message</a> and we can let you in on our enterprise plans.</p>\\n\\n  </div>\\n</div>\\n\\n{{JST \"pricing_about\"}}\\n');window.JST[\"pricing_base\"]=JST('<div class=\"pricing\"></div>');window.JST[\"pricing_about\"]=JST('<div class=\"row pricing-about\">\\n  <div class=\"container\">\\n    <div class=\"column one-half\">\\n      <h2>Confused By Plan Terms?</h2>\\n      <div class=\"block\">\\n        <h3>What\\'s a Zap?</h3>\\n        <p>A Zap is a link between two services (a \"trigger\" and an \"action\"). Zaps run automatically in the background every few minutes to move and manage data on your behalf. Only live Zaps count against your limit &mdash; you can have as many paused and unfinished Zaps as you\\'d like. For example, one Zap might be \"Send me an SMS every time I get a new email\".</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <span class=\"explainable\" data-explain=\"tasks\"></span><h3>What are Tasks?</h3>\\n        <p>A Task is counted every time we move a piece of data or take some action on your behalf during a pay period or month. If you set up a filter, we don\\'t count filtered items against your Task limit.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <span class=\"explainable\" data-explain=\"services\"></span><h3>What are Services?</h3>\\n        <p>A Service is a web service or app, such as Facebook, Gmail, or SalesForce. Zapier integrates with over 193 services and counting and lets you move data between them.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>What are Premium services?</h3>\\n        <p>Some services on Zapier are marked as \\'Premium\\'. To use these services in your zaps, you\\'ll need to have a paid plan.</p>\\n      </div>\\n    </div>\\n\\n    <div class=\"column one-half\">\\n      <h2>Have Questions?</h2>\\n      <div class=\"block\">\\n        <h3>Can I change my plan later on?</h3>\\n        <p>Yes, you can upgrade or downgrade at any time. If you choose to upgrade you\\'ll pay a pro-rated amount for the rest of the month. If you choose to downgrade you\\'ll be credited on next month\\'s bill.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>What if I decide to cancel?</h3>\\n        <p>If you no longer wish to use Zapier, you can cancel at any time. You will receive a pro-rated credit with Zapier for the remainder of that month\\'s billing cycle.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>Is phone support available?</h3>\\n        <p>We offer phone support to our Business Plus plan members. You can schedule a phone call with us for personal-level support during regular business hours.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>Do I need to know how to code?</h3>\\n        <p>No! Zapier makes it easy for you to move data between your web services without being a developer. We may need you to locate information for certain accounts (things like API keys), but we\\'ll guide you through any additional steps required.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>I have more questions. Who do I ask?</h3>\\n        <p>Check out our <a href=\"/support\">support page</a>, or you can email us at <a href=\"mailto:contact@zapier.com\">contact@zapier.com</a>.</p>\\n      <div class=\"block\">\\n    </div>\\n  </div>\\n</div>\\n');\nwindow.JST[\"developer_app_trigger_settings\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Trigger Settings</h1>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_global_activation\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Request Global Activation</h1>\\n\\n<br />\\n\\n<div class=\"developer-app-audit\"></div>\\n\\n{{#unless hasErrors}}\\n   <p>Provide us a little bit of info about your organization and a test account we can use to review the service.</p>\\n   <form class=\"paramform\"></form>\\n{{/unless}}\\n\\n<clear/>\\n<div>\\n  {{#unless hasErrors}}<button class=\"save big orange\">Send Request</button>{{/unless}}\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_digest_auth_empty_section\"]=JST(\"<p>Now that we know you are using Digest Auth, define some authentication fields that will ask the user for their username and password.\\n</p>\\n\");window.JST[\"developer_app_edit_trigger\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if trigger.label}}Edit Trigger: {{trigger.label}}{{else}}Create Trigger{{/if}}</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'appearance\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">1. Name and Description</a>\\n      {{else}}\\n         1. Name and Description\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/fields\">2. Trigger Fields</a>\\n      {{else}}\\n         2. Trigger Fields\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'backend\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/backend\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/backend\">3. Where Data Comes From</a>\\n      {{else}}\\n         3. Where Data Comes From\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'sample\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/sample\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/sample\">4. Sample Result</a>\\n      {{else}}\\n         4. Sample Result\\n      {{/if}}\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');window.JST[\"developer_app_auth_api_key_empty_section\"]=JST(\"<p>Now that we know you are using API Keys, define an authentication field that will ask the user for their key.\\n</p>\\n\");window.JST[\"developer_app_clone_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service was cloned.</p>\\n   <button class=\"close\">Go to clone</button>\\n</div>\\n');window.JST[\"developer_app_scripting\"]=JST('<textarea>{{app.js}}</textarea>\\n<div class=\"buttons\">\\n  <button class=\"save orange\">Save</button>\\n  <button class=\"links\">Quick links</button>\\n  <button class=\"go-back\">Back</button>\\n</div>');window.JST[\"developer_app_trigger_sample_result\"]=JST('<form class=\"paramform\"></form>\\n{{#unless isNew}}\\n<div class=\"sep\"></div>\\n<div id=\"override-container\">\\n   <p>This lets you give friendly names to your sample result data, as well as hide \"unimportant\", or especially unlikely to be useful, fields.</p>\\n</div>\\n{{/unless}}\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">{{#if isNew}}Parse Sample{{else}}Save{{/if}}</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_actions_empty_section\"]=JST('<p>\\nActions send data to your API. An action creates or updates a record with data provided by a trigger.\\n</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/create\"><i class=\"fa fa-plus-circle\"></i> Add Your First Action</a></p>');window.JST[\"developer_dashboard\"]=JST('<h1>Your Apps</h1>\\n\\n<p></p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/create\" data-nav=\"{{devpath}}/app/create\"><i class=\"fa fa-plus-circle\"></i> Add New App</a></p>\\n\\n<h2>Active <small>(Useable by anyone)</small></h2>\\n{{#if activeCount}}\\n   <table class=\"table active-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any active services.</p>\\n{{/if}}\\n\\n<h2>Invite Only <small>(Useable by invited users)</small></h2>\\n{{#if inviteCount}}\\n   <table class=\"table invite-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any active services.</p>\\n{{/if}}\\n\\n<h2>Pending <small>(Being reviewed by Zapier)</small></h2>\\n{{#if pendingCount}}\\n   <table class=\"table pending-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any pending services.</p>\\n{{/if}}\\n\\n<h2>Private <small>(Only usable by you)</small></h2>\\n{{#if privateCount}}\\n   <table class=\"table private-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any private services. <a href=\"/{{devpath}}/app/create\" data-nav=\"{{devpath}}/app/create\">Make one</a>!</p>\\n{{/if}}\\n');window.JST[\"developer_app_trigger_field_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\">{{field.label}}</a></td>\\n<td><code>{{field.key}}</code></td>\\n<td>\\n   {{#if field.prefill}}\\n      <code>{{field.prefill}}</code>\\n   {{else}}\\n      <em class=\"empty\">None</em>\\n   {{/if}}\\n</td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_auth_field_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\">{{field.label}}</a></td>\\n<td><code>{{field.key}}</code></td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n  <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\">\\n    <i class=\"fa fa-pencil\"></i> Edit\\n  </a>\\n  <a href=\"#\" class=\"delete button\">\\n     <i class=\"fa fa-times-circle\"></i>\\n     <span class=\"default\">Delete</span>\\n     <span class=\"confirm\">Really?</span>\\n  </a>\\n</td>\\n');window.JST[\"developer_app_action_fields\"]=JST('<p>Action Fields are the fields users will map data into.<p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add New Action Field</a></p>\\n\\n{{#if action.fields.length}}\\n   <table class=\"table action-fields\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Prefill</th>\\n         <th>Required</th>\\n         <th class=\"sort-column\">Sort</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{/if}}\\n\\n<div>\\n   <button class=\"save big orange\">Next</button>&nbsp;\\n   <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n   <span class=\"sort-errors red\"></span> <!-- sort is the only thing that saves here -->\\n</div>\\n');window.JST[\"developer_app_table_row\"]=JST('<td class=\"image-place\"><img style=\"width:32px;height:32px\" src=\"{{#if app.cropped_image_urls}}{{app.cropped_image_urls.32x32}}{{else}}{{ z.cfg.mediaURL }}images/frontend/placeholder/32x32.png{{/if}}\" alt=\"{{app.title}}\"/></td>\\n<td><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a></td>\\n<td>{{prettyStatus}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/\" data-nav=\"{{devpath}}/app/{{app.id}}/\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_confirm_invite_modal\"]=JST('<form>\\n  <h2>Are you sure you want to do that?</h2>\\n  <p>Enabling Invite-Only mode means you will no longer be able to make changes to your service.</p>\\n  <p>If you are trying to test your service, it is available to you right now if you go <a href=\"/app/editor\" target=\"_blank\">make a zap</a>.</p>\\n  <br />\\n  <button class=\"yes\">Enable</button>&nbsp; <a href=\"#\" class=\"no orange\">Close</a>\\n</form>\\n');window.JST[\"developer_app_actions\"]=JST('<h2>Actions <small>(Zapier sending data out)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Important</th>\\n         <th>Visible</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/create\"><i class=\"fa fa-plus-circle\"></i> Add New Action</a></p>\\n</div>\\n');window.JST[\"developer_app_auth_empty_section\"]=JST('<p>Defining how to authenticate is the first step in building your service.</p>\\n\\n<p><button data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/scheme\">Get Started <i class=\"fa fa-chevron-right\"></i></button></p>\\n');window.JST[\"developer_app_trigger_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">{{trigger.label}}</a></td>\\n<td><code>{{trigger.key}}</code></td>\\n<td>{{prettySource}}</td>\\n<td>{{#if trigger.important}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td>{{#if trigger.hide}}<i class=\"fa fa-ban red\"></i>{{else}}<i class=\"fa fa-check green\"></i>{{/if}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_migrate_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service has been migrated.</p>\\n   <button class=\"close\">Back to Service</button>\\n</div>\\n');window.JST[\"developer_app_revert_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service is now private. Make any edits you need to and then request global activation again.</p>\\n   <button class=\"close\">Reload</button>\\n</div>\\n');window.JST[\"developer_app_auth\"]=JST('<h2>Authentication <small>(Values needed to confirm identity)</small></h2>\\n\\n{{#equals app.auth_type 5}}\\n  <p>Your OAuth redirect URI is <code>https://zapier.com/dashboard/auth/oauth/return/{{app.key}}/</code>.</p>\\n{{/equals}}\\n\\n{{#equals app.auth_type 6}}\\n  <p>Your OAuth redirect URI is <code>https://zapier.com/dashboard/auth/oauth/return/{{app.key}}/</code>.</p>\\n{{/equals}}\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n        <th>Label</th>\\n        <th>Key</th>\\n        <th>Required</th>\\n        <th class=\"sort-column\">Sort</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add Authentication Field</a> <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/settings\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/settings\"><i class=\"fa fa-cog\"></i> Manage Authentication Settings</a> <a class=\"button save-sortable orange\" style=\"display:none\">Save Sorting</a> <span class=\"sort-errors red\"></span></p>\\n\\n   {{#if warnings.length}}\\n      <div class=\"warning\">\\n         <p>Things to do for this section:</p>\\n         <ul>\\n         {{#each warnings}}\\n            <li class=\"alert\">{{this}}</li>\\n         {{/each}}\\n         </ul>\\n      </div>\\n   {{/if}}\\n</div>\\n');window.JST[\"developer_app_stats\"]=JST('<h2>Statistics <small>(Site wide counts of users)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n        <th>Type</th>\\n        <th>Label</th>\\n        <th>Live</th>\\n        <th>Paused</th>\\n        <th>Total</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n</div>');window.JST[\"developer_app_trigger_fields\"]=JST('<p>Trigger fields define the pre-requirements needed in order to make a request. Theses are things like parent objects or search strings.<p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add New Trigger Field</a></p>\\n\\n{{#if trigger.fields.length}}\\n   <table class=\"table trigger-fields\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Prefill</th>\\n         <th>Required</th>\\n         <th class=\"sort-column\">Sort</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{/if}}\\n\\n<clear/>\\n<div>\\n   <button class=\"save big orange\">Next</button>&nbsp;\\n   <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n   <span class=\"sort-errors red\"></span> <!-- sort is the only thing that saves here -->\\n</div>\\n');window.JST[\"developer_app_edit_trigger_form\"]=JST('<form class=\"paramform\"></form>\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save &amp; Next</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_settings\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Authentication Settings</h1>\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_confirm_revert_modal\"]=JST('<form>\\n<h2>Are you sure you want to do that?</h2>\\n<h3>Reverting your service back to being private means you will have to make a new request for global activation.</h3>\\n<h3>If you realize your service is not ready to be made global, you should revert so you can continue working on it.</h3>\\n<br />\\n<button class=\"yes\">Revert to Private</button>\\n<button class=\"no orange\">Close</button>\\n</form>\\n');window.JST[\"developer_app_auth_editor_fields\"]=JST('<p>This is our best guess at what fields you will need. You may customize them as needed.</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/edit/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add Another Authentication Field</a></p>\\n\\n\\n<table class=\"table\">\\n   <thead>\\n     <th>Label</th>\\n     <th>Key</th>\\n     <th>Required</th>\\n     <th class=\"sort-column\">Sort</th>\\n     <th class=\"action-header\">Actions</th>\\n   </thead>\\n   <tbody>\\n     <!-- render here -->\\n   </tbody>\\n</table>\\n\\n<div>\\n  <button class=\"save big orange\">Next</button>&nbsp;\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_action_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">{{action.label}}</a></td>\\n<td><code>{{action.key}}</code></td>\\n<td>{{#if trigger.important}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td>{{#if action.hide}}<i class=\"fa fa-ban red\"></i>{{else}}<i class=\"fa fa-check green\"></i>{{/if}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_trigger_sample_override_form\"]=JST('Field Key: <code>{{key}}</code>\\n<form class=\"paramform\"></form>\\n<div class=\"sep\"></div>\\n');window.JST[\"developer_app_edit_action_form\"]=JST('<form class=\"paramform\"></form>\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save {{#notequals section \\'backend\\'}}&amp; Next{{/notequals}}</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_empty_fields\"]=JST('<p>Now go make some fields!</p>\\n<p>TODO: bcooksey Write some real instructions</p>\\n<a href=\"/{{devpath}}/app/{{app.id}}/auth/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/create\"><i class=\"fa fa-plus-circle\"></i>Add Field</a>\\n<div>\\n  <button class=\"save big orange\">Next</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_action_field_table_row\"]=JST('<td>\\n   <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\">{{field.label}}</a>\\n</td>\\n<td><code>{{field.key}}</code></td>\\n<td>\\n   {{#if field.prefill}}\\n      <code>{{field.prefill}}</code>\\n   {{else}}\\n      <em class=\"empty\">None</em>\\n   {{/if}}\\n</td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_invite\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Email Invites</h1>\\n<br/>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Send</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_scripting_menu\"]=JST('<ul class=\"scripting-menu\">\\n  <li><a class=\"logs\" href=\"/{{devpath}}/app/{{app.id}}/requests\" data-nav=\"{{devpath}}/app/{{app.id}}/requests\">\\n    <i class=\"fa fa-bars\"></i> Request Logs\\n  </a></li>\\n  <li><a href=\"/developer/scripting/\" class=\"docs\" target=\"_new\">\\n    <i class=\"fa fa-question-circle\"></i> Scripting Docs\\n  </a></li>\\n</ul>');window.JST[\"developer_app_confirm_global_modal\"]=JST('<form>\\n  <h2>Are you sure you want to do that?</h2>\\n  <p>Requesting global activation means you will no longer be able to make changes.</p>\\n  <p>If you are trying to test your service, it is available to you right now if you go <a href=\"/app/editor\" target=\"_blank\">make a zap</a>.</p>\\n  <br />\\n  <button class=\"yes\">Continue to request form</button>&nbsp; <a href=\"#\" class=\"no orange\">Close</a>\\n</form>\\n');window.JST[\"developer_app_auth_choose_scheme\"]=JST('<p>Which authentication scheme does your your API use:</p>\\n<p>\\n   <button id=\"use-basic-auth\">Basic Auth</button>\\n   <button id=\"use-api-key\">API Keys</button>\\n   <button id=\"use-oauthv2\">OAuth v2</button>\\n   <button id=\"use-digest-auth\">Digest Auth</button>\\n</p>\\n\\n<div id=\"api-key-sub-type\" style=\"display: none;\">\\n   <p>Does the API Key go in the HTTP Headers or Querystring?</p>\\n   <p>\\n      <button value=\"3\">Headers</button>\\n      <button value=\"2\">Querystring</button>\\n   </p>\\n</div>\\n<div id=\"oauthv2-sub-type\" style=\"display: none;\">\\n   <p>Will Zapier need to refresh the access token on a regular basis?</p>\\n   <p>\\n      <button value=\"6\">Yes, setup refresh</button>\\n      <button value=\"5\">No, original will do</button>\\n   </p>\\n   <p>Your OAuth redirect URI is <code>https://zapier.com/dashboard/auth/oauth/return/{{app.key}}/</code>.</p>\\n</div>\\n\\n<br/>\\n\\n<div>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_triggers_empty_section\"]=JST('<p>\\nTriggers read data in from your API. A trigger focuses on a particular event that happens, say a new Contact or Order being created, and provides the relavant data so that users can take action on that event (like get an email notification with details about the newly created contact/order). \\n</p>\\n\\n<p>You will need one <strong>test trigger</strong> so we can test the credentials users provide in the authentication fields. Usually this is a <code>/ping</code> or <code>/user</code> endpoint.</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/create/test\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/create/test\"><i class=\"fa fa-plus-circle\"></i> Add Your First Test Trigger</a></p>');window.JST[\"developer_app_edit_auth_field\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if field.label}}Edit Auth Field: {{field.label}}{{else}}Create Auth Field{{/if}}</h1>\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}{{#if isWizard}}/auth/edit/fields{{/if}}\" data-nav=\"{{devpath}}/app/{{app.id}}{{#if isWizard}}/auth/edit/fields{{/if}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_auth_editor\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Setup Authentication</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'scheme\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/scheme\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/scheme\">1. Choose Authentication Scheme</a>\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/fields\">2. Create Auth Fields</a>\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'mapping\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/mapping\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/mapping\">3. Map Fields to Request Parameters</a>\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');window.JST[\"developer_app_requests\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Request Log</h1>\\n<br />\\n\\n<div id=\"request-log-controls\">\\n   <button>Refresh</button>\\n</div>\\n\\n<div id=\"request-log\"></div>\\n');window.JST[\"developer_app_meta\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; {{#if app.title}}<a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;{{/if}}</span> {{#if app.title}}Edit General Info{{else}}Create Service{{/if}}</h1>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/{{#if app.id}}app/{{app.id}}{{/if}}\" data-nav=\"{{devpath}}/{{#if app.id}}app/{{app.id}}{{/if}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_audit\"]=JST('{{#hasAtLeastOne errors}}\\n<p>Looks like your service has some errors. Look over the list below before you submit your service. They are automatically generated, so if you see something odd or unfixable, <a href=\"mailto:contact@zapier.com\">just contact us</a>!</p>\\n\\n<div id=\"app-errors\">\\n   <h3>Errors</h3>\\n   <ul>\\n   {{#each errors}}\\n      <li>\\n         <strong>{{name}}</strong>\\n         <ul>\\n         {{#each errors}}\\n            <li>{{message}}</li>\\n         {{/each}}\\n         </ul> \\n      </li>\\n   {{/each}}\\n   </ul>\\n</div>\\n{{/hasAtLeastOne}}\\n\\n{{#hasAtLeastOne warnings}}\\n<div id=\"app-warnings\">\\n   <h3>Warnings</h3>\\n   <ul>\\n   {{#each warnings}}\\n      <li>\\n         <strong>{{name}}</strong>\\n         <ul>\\n         {{#each warnings}}\\n            <li>{{message}}</li>\\n         {{/each}}\\n         </ul> \\n      </li>\\n   {{/each}}\\n   </ul>\\n</div>\\n{{/hasAtLeastOne}}\\n');window.JST[\"developer_app_triggers\"]=JST('<h2>Triggers <small>(Bringing data into Zapier)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Source</th>\\n         <th>Important</th>\\n         <th>Visible</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/create\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/create\"><i class=\"fa fa-plus-circle\"></i> Add New Trigger</a> <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/settings\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/settings\"><i class=\"fa fa-cog\"></i> Manage Trigger Settings</a></p>\\n\\n   {{#if app.warnings.test_trigger}}\\n      <div class=\"warning\">\\n         <p>Things to do for this section:</p>\\n         <ul>\\n            <li class=\"alert\">{{app.warnings.test_trigger}}</li>\\n         </ul>\\n      </div>\\n   {{/if}}\\n</div>');window.JST[\"developer_app_auth_basic_auth_empty_section\"]=JST(\"<p>Now that we know you are using Basic Auth, define some authentication fields that will ask the user for their username and password.\\n</p>\\n\");window.JST[\"developer_app_auth_editor_form\"]=JST('<form class=\"paramform\"></form>\\n<div>\\n  <button class=\"save big orange\">Save</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_edit_action_field\"]=JST('<h1>{{#if field.label}}Edit Action Field: {{field.label}}{{else}}Create Action Field{{/if}}</h1>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Done</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_migrate\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Service Migration</h1>\\n\\n<div class=\"developer-app-audit\"></div>\\n\\n{{#unless hasErrors}}\\n   <p>This app looks ready to become active!</p>\\n{{/unless}}\\n\\n<clear/>\\n<div>\\n  {{#unless hasErrors}}<button class=\"save big orange\">Migrate service</button>{{/unless}}\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}/migrate\" data-nav=\"{{devpath}}/app/{{app.id}}/migrate\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_edit_trigger_field\"]=JST('<h1>{{#if field.label}}Edit Trigger Field: {{field.label}}{{else}}Create Trigger Field{{/if}}</h1>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Done</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_global_activation_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. We\\'ll be in touch soon.</p>\\n   <button class=\"close\">Back to Service</button>\\n</div>\\n');window.JST[\"developer_app_invite_activation_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service is now Invite-only.</p>\\n   <button class=\"close\">Reload</button>\\n</div>\\n');window.JST[\"developer_app_edit_action\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if action.label}}Edit Action: {{action.label}}{{else}}Create Action{{/if}}</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'appearance\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">1. Name and Description</a>\\n      {{else}}\\n         1. Name and Description\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/fields\">2. Action Fields</a>\\n      {{else}}\\n         2. Action Fields\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'backend\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/backend\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/backend\">3. Where To Send Data</a>\\n      {{else}}\\n         3. Where To Send Data\\n      {{/if}}\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');\nwindow.JST[\"developer_app\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656;</span> {{app.title}}</h1>\\n\\n<div class=\"column two-thirds\" style=\"padding-left:0;\"> <!-- uuugh inline styles. unfortunately doing row/column in all developer views would be a *lot* -->\\n  <div class=\"section service-feature\">\\n    <div class=\"service-icon-large\">\\n      <img src=\"{{#if app.cropped_image_urls}}{{app.cropped_image_urls.64x64}}{{else}}{{ z.cfg.mediaURL }}images/frontend/placeholder/64x64.png{{/if}}\" alt=\"GitHub integration logo\">\\n    </div>\\n    <div class=\"description\">\\n      <p>{{app.description}}</p>\\n      <p><a {{#if isEditable}}class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/meta\" data-nav=\"{{devpath}}/app/{{app.id}}/meta\"{{else}}class=\"button disabled\"{{/if}}><i class=\"fa fa-cog\"></i> Edit Title, Image or Description</a></p>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"column one-third side-col\" style=\"padding-right:0;\"> <!-- uuugh inline styles?!? -->\\n  <div class=\"widget\">\\n    <h3>Status</h3>\\n    <p><strong>{{#equals app.status 0}}Private{{/equals}}{{#equals app.status 1}}Under Review{{/equals}}{{#equals app.status 2}}Invite Only{{/equals}}{{#equals app.status 3}}Global{{/equals}}</strong> - <em>{{#equals app.status 0}}private apps can be used just like any app on Zapier, except only you can see them{{/equals}}{{#equals app.status 1}}we\\'ll get back to your as soon as possible!{{/equals}}{{#equals app.status 2}}invite apps can be used just like any app on Zapier,\\n    but only by those who have the link{{/equals}}{{#equals app.status 3}}global apps are apps that anyone on Zapier can see and use{{/equals}}.</em></p>\\n  </div>\\n</div>\\n\\n<clear/>\\n<br/>\\n\\n<div class=\"all-wrapper\">\\n  <!-- stats/auths/triggers/actions rendered here! -->\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Scripting API <small>(Modify Zapier\\'s default behavior)</small></h2>\\n   <div class=\"section-content\">\\n      {{#if isActive}}\\n         <p>Scripting API is disabled for global or invite only services. <a href=\"#\">Read the docs.</a></p>\\n      {{else}}\\n         <p>You can write javascript code that can modify data that comes in and goes out of our system. <a href=\"#\">Read the docs.</a>\\n         </p>\\n      {{/if}}\\n      {{#if isEditable}}\\n         <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/scripting\" data-nav=\"{{devpath}}/app/{{app.id}}/scripting\"><i class=\"fa fa-code\"></i> Edit Code</a></p>\\n      {{else}}\\n         <button class=\"disabled\"><i class=\"fa fa-code\"></i> Edit Code</button>\\n      {{/if}}\\n   </div>\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Request Log <small>(A stream of all outbound and inbound HTTP)</small></h2>\\n   <div class=\"section-content\">\\n      {{#if isActive}}\\n         <p>Logs are disabled for active services. <a href=\"#logged-requests\">Read the docs.</a></p>\\n      {{else}}\\n         <p>A list of all recent development HTTP requests. <a href=\"#logged-requests\">Read the docs.</a></p>\\n      {{/if}}\\n      {{#if isEditable}}\\n         <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/requests\" data-nav=\"{{devpath}}/app/{{app.id}}/requests\"><i class=\"fa fa-clock-o\"></i> See HTTP Log</a></p>\\n      {{else}}\\n         <button class=\"disabled\"><i class=\"fa fa-clock-o\"></i> See HTTP Log</button>\\n      {{/if}}\\n   </div>\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Status <small>(Who can use your service)</small><a id=\"status-section\"></a></h2>\\n   <div class=\"section-content\">\\n      {{#equals app.status 0}}\\n      <p>Your service is currently private, which means only you can use it.</p>\\n      <p>To allow others access, you need to do one of the following:\\n        <ol>\\n           <li><a id=\"make-global\" href=\"#\">Request global activation</a></li>\\n           <li><a id=\"enable-invite\" href=\"#\">Enable invite-only activation</a></li>\\n           <li><a href=\"/{{devpath}}/app/{{app.id}}/migrate\" data-nav=\"{{devpath}}/app/{{app.id}}/migrate\">Migrate and replace an existing Service</a></li>\\n        </ol>\\n      </p>\\n      If at any time you want to make a copy of your service, you can <a id=\"clone-app\" href=\"#\">clone your service</a>.\\n      {{/equals}}\\n\\n      {{#equals app.status 1}}\\n         <p>Your service is waiting to be reviewed by Zapier. At this point, you can rest easy and wait for us to schedule a demo call with you. You can also get a head start thinking about your service\\'s launch by checking out these articles:</p>\\n         <ol>\\n             <li><a href=\"/help/partner-pre-launch-checklist/\">Five Prep Steps for Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-checklist/\">Three Ingredients of a Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-zapier/\">How Zapier Promotes the Launch</a></li>\\n         </ol>\\n         <p>If you need to make a change, you can <a id=\"revert-app\" href=\"#\">revert back to private</a>. You\\'ll make your changes, then submit for global activation again.</p>\\n      {{/equals}}\\n\\n      {{#equals app.status 2}}\\n         <p>Your service is invite-only. At this point, you can invite users to to use your service. Only people you have explicitly invited will be able to use your service on Zapier.</p>\\n         <!-- <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/invite\" data-nav=\"{{devpath}}/app/{{app.id}}/invite\"><i class=\"fa fa-share\"></i> Invite User via Bulk Email</a></p> -->\\n         <p>You can invite users by sharing this link:</p>\\n         <p><input type=\"text\" onclick=\"this.select();\" value=\"{{app.share_url}}\" style=\"width:570px\"></p>\\n         <p>To make changes to your service, you need to <a id=\"clone-app\" href=\"#\">clone this service</a> and then perform a migration. <a href=\"#\">Read the docs</a>.</p>\\n      {{/equals}}\\n\\n      {{#equals app.status 3}}\\n         <p>Your service is global, which means anyone can use it. If your service has not had its official Zapier launch, now is a good time to work on conent for the launch. Here are a few articles that explain the process:</p>\\n         <ol>\\n             <li><a href=\"/help/partner-pre-launch-checklist/\">Five Prep Steps for Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-checklist/\">Three Ingredients of a Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-zapier/\">How Zapier Promotes the Launch</a></li>\\n         </ol>\\n         <p>To make changes to your service, you need to <a id=\"clone-app\" href=\"#\">clone this service</a> and then perform a migration. <a href=\"#\">Read the docs</a>.</p>\\n      {{/equals}}\\n   </div>\\n</div>\\n');window.JST[\"developer_base\"]=JST('<div class=\"row developer\">\\n  <div class=\"container developer-content\">\\n      \\n  </div>\\n</div>\\n');window.JST[\"developer_app_invite_success_modal\"]=JST('<div class=\"center\">\\n   <p>{{numSent}} I{{#plural count=numSent}}nvite{{/plural}} Sent.</p>\\n   <button class=\"close\">Close</button>\\n</div>\\n');window.JST[\"developer_app_stats_table_row\"]=JST(\"<td>{{stat.Type}}</td>\\n<td>{{stat.Label}}</td>\\n<td>{{stat.Live}}</td>\\n<td>{{stat.Paused}}</td>\\n<td>{{stat.Total}}</td>\");window.JST[\"developer_app_migrate_choose_target\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Service Migration</h1>\\n\\n<p>A migration is the process used to deploy an updated versions of your app. If you think this app is ready to become the new active version, select an app for it to replace and click next.</p>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Next</button>&nbsp;\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"editor_userfill_modal\"]=JST('{{#if missing}}\\n  <div class=\"empty\">\\n    <button class=\"missing light smaller\"><i class=\"fa fa-exclamation-circle\"></i>\\n      We\\'re using <strong>fake</strong> data. Load real data here.\\n    </button>\\n  </div>\\n{{else}}\\n  {{#hasAtLeastOne choices}}\\n  <div class=\"search\">\\n    <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n  </div>\\n  {{/hasAtLeastOne}}\\n{{/if}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match...</div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n    {{#if this.type}}data-type=\"{{this.type}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">{{#ellipsis 50}}{{this.display}}{{/ellipsis}} <span class=\"sample\">{{this.val}}</span></a>\\n  </li>\\n  {{/each}}\\n</ul>');window.JST[\"editor_selectfill_modal\"]=JST('<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match <strong>{{search}}</strong></div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">\\n      {{#if ../fancychoices}}\\n        {{#ellipsis 30}}{{this.display}}{{/ellipsis}}\\n      {{else}}\\n        {{this.display}}\\n      {{/if}}\\n      {{#unless ../hideRawValue }}<span class=\"sample\">{{this.val}}</span>{{/unless}}\\n    </a>\\n  </li>\\n  {{/each}}\\n\\n  {{#if fancychoices}}\\n    <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n    <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value<span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n    <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/if}}\\n</ul>\\n');window.JST[\"editor_hook_error_modal\"]=JST('<h2>We received an error connecting to {{appNameFromKey key}}</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Make sure you have followed all on-screen directions, in order</li>\\n  <li>Test your {{serivce}} Account again</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"editor_service_action\"]=JST('{{#unless isPartner}}<p class=\"big\">Need inspiration? <a href=\"/app/explore\" data-nav=\"app/explore\">Explore existing Zap templates to get you started.</a></p>{{/unless}}\\n\\n<div class=\"picker\">\\n\\n  <div class=\"trigger\">\\n    <select id=\"trigger-service\" data-placeholder=\"Choose a Trigger service...\">\\n      <option></option> <!-- placeholder -->\\n      {{#each readServices}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n    <div class=\"picker actions\">\\n    <div class=\"trigger\">\\n      <select id=\"trigger\" data-placeholder=\"Choose a Trigger...\">\\n        <option></option> <!-- placeholder -->\\n        {{#each readActions}}\\n        <option value=\"{{key}}\" data-help=\"{{help_text_html}}\">{{label}}</option>\\n        {{/each}}\\n        {{#if showTriggerExpand}}<option value=\"showAll\">Show all triggers</option>{{/if}}\\n      </select>\\n      <img class=\"helper\" src=\"{{mediaURL}}images/arrows/trigger.png\" />\\n    </div>\\n    </div>\\n\\n  </div>\\n\\n  <div class=\"arrow\"><i class=\"fa fa-caret-right\"></i></div>\\n\\n  <div class=\"action\">\\n    <select id=\"action-service\" data-placeholder=\"Choose an Action service...\">\\n      <option></option> <!-- placeholder -->\\n      {{#each writeServices}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n\\n    <div class=\"actions\">\\n      <select id=\"action\" data-placeholder=\"Choose an Action...\">\\n        <option></option> <!-- placeholder -->\\n        {{#each writeActions}}\\n        <option value=\"{{key}}\" data-help=\"{{help_text_html}}\">{{label}}</option>\\n        {{/each}}\\n        {{#if showActionExpand}}<option value=\"showAll\">Show all actions</option>{{/if}}\\n      </select>\\n      <img class=\"helper\" src=\"{{mediaURL}}images/arrows/action.png\" />\\n    </div>\\n  </div>\\n\\n</div>\\n\\n{{#if flow}}\\n<button class=\"continue\">Continue</button>\\n\\n<span class=\"partner-feedback hide\">To create a Zap without {{partnerService}} in it, you\\'ll need to go to <a target=\"_new\" href=\"https://zapier.com/\">Zapier.com</a></span>\\n{{/if}}');window.JST[\"editor_enable\"]=JST('{{#if isHook}}\\n  <p class=\"big\">This Zap is instant. It will trigger immediately when we receive a new {{appNameFromKey readService.id}} {{call readService.getActionName read.action \"read\" \"true\" context=readService}}.</p>\\n{{else}}\\n  <p class=\"big\">This Zap will automatically check for new {{appNameFromKey readService.id}} {{#plural}}{{call readService.getActionName read.action \"read\" \"true\" context=readService}}{{/plural}} every <i class=\"fa fa-clock-o\"></i> {{polling}} minutes.</p>\\n{{/if}}\\n\\n<div class=\"paramform\">\\n  <div class=\"field\">\\n    <div class=\"label\">Name this Zap:</div>\\n    <div class=\"input\">\\n      <input class=\"xlarge title\" type=\"text\" name=\"title\" placeholder=\"Name this Zap...\" value=\"{{#unless flow}}{{title}}{{/unless}}\" />\\n    </div>\\n  </div>\\n</div>\\n\\n{{#hasAtLeastOne errors}}\\n  <h3>Please fix the following errors before enabling:</h3>\\n  <ul>\\n  {{#each ../errors}}<li class=\"error\">{{this}}</li>{{/each}}\\n  </ul>\\n{{/hasAtLeastOne}}\\n\\n<p><button class=\"enable big orange {{#hasAtLeastOne errors}}disabled{{/hasAtLeastOne}}\">Turn Zap on</button></p>\\n');window.JST[\"editor_custom_filter_row\"]=JST('<div class=\"index\" href=\"rule-{{index}}\">{{index}}</div>\\n\\n<paramform></paramform>\\n\\n<div class=\"stack add-or-remove\">\\n   <div class=\"add\" data-group=\"{{group}}\"></div>\\n   <div class=\"remove\"></div>\\n</div>\\n\\n<div class=\"stack\"></div>\\n\\n<div class=\"stack label\">\\n   <span class=\"and\">AND</span>\\n</div>');window.JST[\"editor_steps\"]=JST('<!-- none_visible title_visible all_visisble -->\\n\\n<step class=\"{{services-actions}}\" data-id=\"services-actions\">\\n  <div class=\"row\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"1\" disabled=\"disabled\"></input></span>\\n      <h2>Choose a trigger and action</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{trigger-auth}}\" data-id=\"trigger-auth\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"2\" disabled=\"disabled\"></input></span>\\n      <h2>Select a <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} account {{#equals read.selected_api write.selected_api}}(Trigger){{/equals}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{action-auth}}\" data-id=\"action-auth\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"3\" disabled=\"disabled\"></input></span>\\n      <h2>Select a <i class=\"img32 {{write.selected_api}}32x32\"></i> {{appNameFromKey write.selected_api}} account {{#equals read.selected_api write.selected_api}}(Action){{/equals}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{filters}}\" data-id=\"filters\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"4\" disabled=\"disabled\"></input></span>\\n      <h2>Filter <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} triggers</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{map}}\" data-id=\"map\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"5\" disabled=\"disabled\"></input></span>\\n      <h2>Match up <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} {{#if readAction}}{{readAction}}{{/if}} to <i class=\"img32 {{write.selected_api}}32x32\"></i> {{appNameFromKey write.selected_api}} {{#if writeAction}}{{writeAction}}{{/if}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{test}}\" data-id=\"test\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"6\" disabled=\"disabled\"></input></span>\\n      <h2>Test this Zap</i></h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{enable}}\" data-id=\"enable\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"7\" disabled=\"disabled\"></input></span>\\n      <h2>Name and turn this Zap on</i></h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n{{#unless flow}}{{#if ../read.paused}}\\n<div class=\"row paused\">\\n    <div class=\"container\">\\n      This Zap is off while you edit.\\n      {{#if ../hasErrors}}\\n        <i>Complete the steps above to turn it back on.</i>\\n      {{else}}\\n        <a href=\"#\" class=\"unpause button\">Turn it back on!</a>\\n      {{/if}}\\n  </div>\\n</div>\\n{{/if}}{{/unless}}');window.JST[\"editor_missing_data_modal\"]=JST('{{#initConnection}}\\n  <div class=\"loading\">Connecting to {{appNameFromKey read.selected_api}}...</div>\\n{{else}}\\n\\n  <div class=\"title\">\\n    <h2><i class=\"fa fa-exclamation-circle\"></i> We couldn\\'t get any samples from {{appNameFromKey read.selected_api}}</h2>\\n  </div>\\n\\n  <ol>\\n    {{#and isHook notSubHook}}\\n    <li class=\"{{#less step 1}}fade{{/less}} {{#equals step 1}}active{{/equals}}\">\\n      {{{call service.getWebhookDirections action \"read\" context=service}}}\\n\\n      <div class=\"label\">Make sure this is your Webhook URL:</div>\\n      <div class=\"table-wrapper fill\">\\n        <div class=\"table-cell column\">\\n          <input class=\"webhook-url\" type=\"text\" value=\"{{call service.getWebhookURL action \"read\" readModel context=service}}\" data-id=\"webhook-url\" readonly/>\\n        </div>\\n        <div class=\"table-cell vcenter\">\\n          <button class=\"copy-button\" data-clipboard-text=\"{{call service.getWebhookURL action \"read\" readModel context=service}}\">Copy to clipboard</button>\\n        </div>\\n      </div>\\n\\n      <button data-step=\"1\" class=\"continue {{#greater step 1}}disabled{{/greater}}\">Ok, I did this</button>\\n    </li>\\n    {{/and}}\\n\\n    <li class=\"{{#less step 2}}fade{{/less}} {{#equals step 2}}active{{/equals}}\">\\n      <p>{{#copyOverride service read.action \"read\" \"no_sample_dirs\"}}\\n      Go create a <em><strong>brand new</strong></em> {{call service.getActionName read.action \"read\" \"true\" context=service}} inside {{appNameFromKey read.selected_api}}, then come back to Zapier.\\n      {{/copyOverride}}</p>\\n\\n      {{#hasAtLeastOne filters}}\\n      <table class=\"fields-table table-bordered\">\\n        {{#each filters}}\\n        <tr>\\n          <td class=\"key\">{{this.k}}:</td>\\n          <td class=\"value\">{{this.v}}</td>\\n        </tr>\\n        {{/each}}\\n      </table>\\n      {{/hasAtLeastOne}}\\n\\n      <button data-step=\"2\" class=\"continue load {{#greater step 2}}disabled{{/greater}}\">Ok, I did this</button>\\n    </li>\\n\\n    <li class=\"{{#less step 3}}fade{{/less}} {{#equals step 3}}active{{/equals}}\">\\n\\n      {{#if isHook}}\\n      <p>Zapier is now waiting for your changes to make their way back to our server.</p>\\n      <span class=\"loading loading-samples\">Waiting anxiously...</span>\\n      <span class=\"found-samples success\"><i class=\"fa fa-check green\"></i>&nbsp;We found your changes!</span>\\n      {{else}}\\n      <p>Have Zapier get the {{call service.getActionName read.action \"read\" \"true\" context=service}} you just created.</p>\\n      <button data-step=\"3\" class=\"continue {{#greater step 3}}disabled{{/greater}}\">Get {{#plural}}{{call service.getActionName read.action \"read\" \"true\" context=service}}{{/plural}}</button>\\n      <span class=\"no-samples\"><i class=\"fa fa-exclamation-circle red\"></i> We couldn\\'t find any! Please try again.</span>\\n      {{/if}}\\n    </li>\\n\\n    <li class=\"{{#less step 4}}fade{{/less}} {{#equals step 4}}active{{/equals}}\">\\n      {{#unless isHook}}\\n      <p>Great, we found it!</p>\\n      {{/unless}}\\n      <button data-step=\"4\" class=\"submit\">All done!</button>\\n    </li>\\n  </ol>\\n{{/initConnection}}');window.JST[\"editor_givefill_modal\"]=JST('{{#hasAtLeastOne choices}}\\n<div class=\"search\">\\n  <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n</div>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match <strong>{{search}}</strong></div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">\\n      {{#if ../fancychoices}}\\n        {{#ellipsis 30}}{{this.display}}{{/ellipsis}}\\n      {{else}}\\n        {{this.display}}\\n      {{/if}}\\n      {{#unless ../hideRawValue }}<span class=\"sample\">{{this.val}}</span>{{/unless}}\\n    </a>\\n  </li>\\n  {{/each}}\\n\\n  {{#if fancychoices}}\\n    <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n    <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value<span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n    <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/if}}\\n</ul>\\n');window.JST[\"editor_filter\"]=JST('{{#if show}}\\n  <p class=\"big\">Only trigger a \"{{call service.getActionName read.action \"read\" \"false\" context=service}}\" from {{appNameFromKey read.selected_api}} when...</p>\\n\\n  <paramform class=\"top-margin\"></paramform>\\n\\n  <div class=\"loading-fields\">Loading fields...</div>\\n  <div class=\"loading-error\">\\n    <p><i class=\"fa fa-exclamation-circle\"></i> We had trouble loading some fields!</p>\\n    <button class=\"retry-fields\">Try again?</button>\\n  </div>\\n\\n  <p class=\"big custom-filter-helper\">Add filters based on other {{appNameFromKey read.selected_api}} fields.</p>\\n\\n  {{#hasExactly rules 0}}\\n    <div class=\"show-custom\"><button class=\"add\">Add custom filters</button></div>\\n    {{else}}\\n    <a id=\"custom-filters\"></a>\\n    <h3>Custom Filters</h3>\\n  {{/hasExactly}}\\n\\n  <div class=\"custom paramform\">\\n    <div class=\"groups\"></div>\\n    {{#hasAtLeastOne rules}}<button class=\"or\">Add OR Filter</button>{{/hasAtLeastOne}}\\n  </div>\\n\\n  {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_test\"]=JST('{{#if show}}\\n\\n  {{#hasAtLeastOne samples}}\\n  {{else}}\\n    <p class=\"big\">Click the button below to test your trigger and get sample data.</p>\\n    <p><button class=\"load {{#hasAtLeastOne samples}}orange{{/hasAtLeastOne}}\" href=\"#\">\\n      <span class=\"img16 {{#if readService}}{{readService.id}}16x16{{else}}placeholder{{/if}}\"></span> Test {{appNameFromKey readService.id}} trigger\\n    </button></p>\\n  {{/hasAtLeastOne}}\\n\\n  {{#hasAtLeastOne samples}}\\n  <p class=\"big\">Select a sample to test with.</p>\\n\\n      <div class=\"samples\">\\n        {{#each samples limit=3}}\\n          <div class=\"sample\">\\n            <h3>Sample #{{this.num}}</h3>\\n            <div class=\"sample-modal-link\">\\n              <div class=\"service {{../readService.id}}32x32\" title=\"[Service name]\"></div>\\n              <a href=\"#\" data-sample-read-id=\"{{this.[_idx]}}\">See trigger sample.</a>\\n            </div>\\n\\n            {{#if this.isFiltered}}\\n              <span class=\"filtered-out\">filtered via <a class=\"custom-filters\">custom filter</a> #{{call this.getWhyFiltered context=this}}</span>\\n            {{/if}}\\n          {{#and this.isFiltered context=this}}\\n          {{else}}\\n            <div class=\"sample-modal-link\">\\n              <div class=\"service {{../../writeService.id}}32x32\" title=\"[Service name]\"></div>\\n              <a href=\"#\" data-sample-write-id=\"{{this.[_idx]}}\">See action sample.</a>\\n            </div>\\n\\n            <button class=\"send\" data-send-sample-id=\"{{this.[_idx]}}\">Test Zap with this sample</button>\\n          {{/and}}\\n          </div>\\n        {{/each}}\\n      </div>\\n\\n      <p><a href=\"#\" class=\"load refresh\"><span class=\"img16 {{#if readService}}{{readService.id}}{{else}}placeholder{{/if}}\"></span> Refresh samples from {{appNameFromKey readService.id}}</a></p>\\n\\n    </div>\\n  {{/hasAtLeastOne}}\\n\\n\\n  {{#hasAtLeastOne samples}}\\n\\n    {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n  {{else}}\\n  {{/hasAtLeastOne}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}\\n');window.JST[\"editor_map\"]=JST('{{#if show}}\\n  <paramform></paramform>\\n\\n  <div class=\"loading-fields\">Loading fields...</div>\\n  <span class=\"loading-empty\">(This Action, {{call service.getActionName write.action \"write\" \"false\" context=service}}, does not have any fields)</span>\\n\\n  {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_prefill_modal\"]=JST('{{#hasAtLeastOne choices}}\\n<div class=\"search\">\\n  <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n</div>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">{{#ellipsis 50}}{{this.display}}{{/ellipsis}} <span class=\"sample\">{{this.val}}</span></a>\\n  </li>\\n  {{/each}}\\n\\n  <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n  <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n  {{#unless trigger}}\\n  <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/unless}}\\n\\n  <li class=\"load-more\" data-id=\"load-more\"><a class=\"display\" title=\"Load more choices\" alt=\"Load more choices\">Load more choices <span class=\"sample\"><i class=\"fa fa-ellipsis-horizontal\"></i></span></a></li>\\n</ul>');window.JST[\"editor_action_card\"]=JST(\"<h2>Available {{#plural}}{{which}}{{/plural}}</h2>\\n<ul>\\n  {{#each action}}\\n  <li>{{this.label}}</li>\\n  {{/each}}\\n</ul>\");window.JST[\"editor_auth\"]=JST('{{#if show}}\\n\\n  {{#if needsAuth}}\\n\\n    {{#if hasAtLeastOneAuth}}\\n      <div class=\"container table-wrapper\">\\n        <div class=\"column one-half table-cell\">\\n        <select class=\"auths\" data-placeholder=\"{{appNameFromKey key}} Account\">\\n          <option></option> <!-- placeholder -->\\n          {{#each auths}}\\n          <option value=\"{{this.id}}\" {{#equals this.id ../selected }}selected=\"selected\"{{/equals}}>{{call this.getName}}</option>\\n          {{/each}}\\n          <option value=\"new\">Connect a different {{appNameFromKey key}} Account</option>\\n        </select>\\n        </div>\\n        <div class=\"column one-half table-cell vcenter\">\\n      {{#if selected}}\\n        <button class=\"test\">Test this Account</button>\\n      {{/if}}\\n        </div>\\n      </div>\\n    {{else}}\\n      <a class=\"orange button add\" href=\"#\" data-id=\"add\">\\n        Connect {{#article}}{{appNameFromKey key}}{{/article}} Account\\n      </a>\\n    {{/if}}\\n  {{/if}}\\n\\n  {{#neither needsAuth isHook}}\\n    <p class=\"big\">You\\'re all set. Carry on!</p>\\n  {{/neither}}\\n\\n  {{#if isHook}}\\n    <div class=\"hook-dirs\">{{{call service.getWebhookDirections action which context=service}}}</div>\\n\\n    <p class=\"big\">Use this Webhook URL:</p>\\n\\n    <div class=\"table-wrapper fill\">\\n      <div class=\"table-cell column\">\\n        <input class=\"webhook-url\" type=\"text\" value=\"{{call service.getWebhookURL action which model context=service}}\" data-id=\"webhook-url\" readonly>\\n      </div>\\n      <div class=\"table-cell vcenter\">\\n        <button class=\"copy-button\" data-clipboard-text=\"{{call service.getWebhookURL action which model context=service}}\">Copy to clipboard</button>\\n      </div>\\n    </div>\\n\\n    {{#if showContinue}}<div><button class=\"continue\">Continue</button></div>{{/if}}\\n\\n  {{/if}}\\n\\n  {{#if showContinue}}{{#unless isHook}}<div><button class=\"continue\">Continue</button></div>{{/unless}}{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_action\"]=JST('{{#if show}}}\\n  <ul class=\"pill-list\"></ul>\\n  {{#if anyAdvanced}} {{#unless showall}} {{#hasAtLeastOne actions}}\\n    <a href=\"#\" class=\"showall\">Show advanced, less-used options</a>\\n  {{/hasAtLeastOne}} {{/unless}} {{/if}}\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_no_samples_modal\"]=JST('<h2>We could not find any <em>recent</em> {{#plural}}{{call service.getActionName action \"read\" \"true\" context=service}}{{/plural}} from {{appNameFromKey key}} {{#unless isHook}}matching your Filters{{/unless}}</span></h2>\\n\\n<pre class=\"error\">{{call service.getActionName action \"read\" \"true\" context=service}} response: empty</pre>\\n\\n<h3>What To Do Next</h3>\\n\\n<ol>\\n  {{#if isHook}}\\n  <li>Follow any on-screen instructions and make sure that you have recently <em>sent us</em> a {{call service.getActionName action \"read\" \"true\" context=service}}</li>\\n  {{else}}\\n\\n  <li>Create a new {{call service.getActionName action \"read\" \"true\" context=service}} in {{appNameFromKey key}} {{#unless isHook}}which matches your Filters{{/unless}}</li>\\n  {{/if}}\\n\\n  <li>Try reloading {{#plural}}{{call service.getActionName action \"read\" \"true\" context=service}}{{/plural}} again in a few seconds</li>\\n</ol>');window.JST[\"editor_action_row\"]=JST('<li class=\"action pill-row {{#if selected}}selected{{/if}}\" id=\"{{key}}\">\\n  <div class=\"radio\"></div>\\n  <div class=\"text name\">{{label}}</div>\\n  <div class=\"text description\">{{#if help_text_html}}{{{help_text_html}}}{{else}}{{help_text}}{{/if}}</div>\\n  <div class=\"clear\"></div>\\n</li>');\nwindow.JST[\"editor_base\"]=JST('<div class=\"editor\"></div>');window.JST[\"editor_api_error_modal\"]=JST('<h2>We received an error from {{appNameFromKey key}}</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Make sure you have followed all on-screen directions, in order</li>\\n  <li>Test your {{serivce}} Account again</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"share_shared\"]=JST('<div class=\"container\"></div>\\n\\n<div class=\"pagination\">\\n    <button class=\"light previous\" {{#unless this.pagination.prev }}disabled{{/unless}}>&nbsp; &larr; &nbsp;</button>\\n    {{! <button class=\"light\">1</button> }}\\n    {{! <button class=\"light\">2</button> }}\\n    {{! <button class=\"light\">3</button> }}\\n    <span><em>page <select class=\"page\">{{#range this.pagination.pages}}<option value=\"{{i}}\" {{#equals i this.pagination.page }}selected{{/equals}}>{{i}}</option>{{/range}}</select> of {{ this.pagination.pages }}</em></span>\\n    <button class=\"light next\" {{#unless this.pagination.next }}disabled{{/unless}}>&nbsp; &rarr; &nbsp;</button>\\n</div>\\n');window.JST[\"share_recipe\"]=JST('<div class=\"zap-mini\">\\n  <div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n  <div class=\"twrapper\">\\n    <div class=\"checkbox\">\\n      <input type=\"checkbox\" class=\"add-to-embed\" value=\"{{this.id}}\" {{#if checked}}checked=\"checked\"{{/if}}>\\n    </div>\\n    <div class=\"services\">\\n      <div class=\"service {{this.read_service_selected_api}}32x32\"></div>\\n      <span class=\"fa fa-caret-right caret\"></span>\\n      <div class=\"service {{this.write_service_selected_api}}32x32\"></div>\\n    </div>\\n    <div class=\"title\">{{this.short_description}}</div>\\n  </div>\\n</div>');window.JST[\"share_embed\"]=JST('<div class=\"sharer\"></div>\\n<h3>3. Embed Your Widget</h3>\\n<div class=\"share-link\">\\n  <p>Happy with your new widget?!</p>\\n  <p>Copy the code below and embed your widget on your website or anywhere that allows embedding.</p>\\n  <input type=\"text\" class=\"share-this\" readonly>\\n</div>');window.JST[\"share_base\"]=JST('<div class=\"row\">\\n    <div class=\"container shave center\">\\n        <h1>Make Your Own Zap Widget</h1>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <div class=\"column one-half\">\\n            <h3>1. Select Zaps To Include</h3>\\n            <p>Choose which shared Zaps below to include in your widget.</p>\\n            <div class=\"results\"></div>\\n        </div>\\n        <div class=\"column one-half\">\\n            <h3>2. Preview Your Zap Widget</h3>\\n            <p>This is how your Zap widget will look on your website or blog.</p>\\n            <div class=\"embed\"></div>\\n        </div>\\n    </div>\\n</div>');window.JST[\"history_filters\"]=JST('<div class=\"history-controls\">\\n  <div class=\"history-selects\">\\n    <label>Filter by: </label>\\n\\n    <paramform></paramform>\\n    \\n  </div>\\n\\n  <div class=\"history-buttons\">\\n    <button class=\"refresh light right\"><i class=\"fa fa-refresh left\"></i> Refresh</button>\\n    <button class=\"send-csv light right\"><i class=\"fa fa-download left\"></i> Export to CSV</button>\\n  </div>\\n</div>');window.JST[\"history_table\"]=JST('<table class=\"table table-striped\">\\n  <tr class=\"history\">\\n    <td class=\"empty\">\\n      <p>No tasks match this filter.</p>\\n      <p><a href=\"/app/editor/\">Make a new Zap</a>{{#unless isPartner}} or <a href=\"/app/explore\">Explore existing Zap templates</a>{{/unless}}.</p>\\n    </td>\\n  </tr>\\n</table>');window.JST[\"history_details\"]=JST('<table class=\"table history-single\">\\n  <tr class=\"history single\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\">\\n    <td class=\"status-column\">\\n      <div class=\"status-indicator {{this.data.status}}\"></div>\\n    </td>\\n    <td class=\"services\">\\n      <div class=\"service\">\\n        <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n      </div>\\n      <i class=\"fa fa-caret-right caret\"></i>\\n      <div class=\"service\">\\n        <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n      </div>\\n    </td>\\n    <td>\\n      <div class=\"title\">{{this.object_title}}</div>\\n    </td>\\n    <td>\\n      <button class=\"replay {{#notequals data.status \"success\"}}{{else}}invisible{{/notequals}}\"><i class=\"fa fa-repeat left\"></i> Replay</button>\\n    </td>\\n    <td>\\n      <div class=\"timesince\">{{this.timesince}} ago</div>\\n    </td>\\n  </tr>\\n</table>\\n\\n<h2>Details</h2>\\n<div class=\"task-details\">\\n  {{#each children}}\\n  <div class=\"task-detail\">\\n    <a href=\"#\" class=\"toggle-details\">Show detail</a>\\n    <div class=\"target {{#equals ../selected.id ../id}}{{#equals ../../selected.row ../_idx}}selected{{/equals}}{{/equals}}\"\\n    data-id=\"{{../id}}\" data-row=\"{{_idx}}\" data-type=\"{{type}}\">\\n      <div class=\"caret\">\\n        <i class=\"fa fa-caret-right\"></i>\\n      </div>\\n      <div class=\"status-container\">\\n        <div class=\"status-indicator {{status}}\"></div>\\n      </div>\\n      <div class=\"title\">{{message}}</div>\\n      <div class=\"date\">{{prettyISO date}}</div>\\n    </div>\\n\\n    <div class=\"details hide\">\\n      {{#if dataDetails}}\\n        <ul>\\n          {{#each dataDetails}}\\n          <li>\\n            <span class=\"detail-key\">{{key}}:</span>\\n            <pre class=\"detail-value\">{{value}}</pre>\\n          </li>\\n          {{/each}}\\n        </ul>\\n      {{else}}\\n        <div class=\"empty\">No details to show...</div>\\n      {{/if}}\\n    </div>\\n\\n  </div><!-- task-detail -->\\n  {{/each}}\\n</div><!-- task-details -->');window.JST[\"history_send_csv\"]=JST('<div class=\"the-content\">\\n  <h1>Generate Task History CSV</h1>\\n  <p>Customers on the Basic plan and up can export large amounts of task history as a CSV (5000 items is the default max, <a href=\"mailto:contact@zapier.com\">contact us</a> if you need to export more). This can take a few minutes so we\\'ll email you with a link when it is ready!</p>\\n  <ul>\\n      <li><strong>Selected Zap</strong>: <em>{{#if zapName}}{{zapName}}{{else}}any{{/if}}</em></li>\\n      <li><strong>Selected Status</strong>: <em>{{#if status}}{{status}}{{else}}any{{/if}}</em></li>\\n  </ul>\\n  <p class=\"feedback\"></p>\\n  <button class=\"submit send\">Generate &amp; Email CSV</button>\\n</div>');window.JST[\"history_pagination\"]=JST('{{#if pagination.pages }}\\n{{#greater pagination.pages 1}}\\n<div class=\"pagination\">\\n  <div class=\"page-nav\"><a href=\"#\" class=\"previous {{#unless pagination.hasPrev }}disabled{{/unless}}\"><i class=\"fa fa-chevron-left\"></i></a></div>\\n  <div class=\"page-numbers\"><span>{{ pagination.page }}</span> of <span>{{ pagination.pages }}</span></div>\\n  <div class=\"page-nav\"><a href=\"#\" class=\"next {{#unless pagination.hasNext }}disabled{{/unless}}\"><i class=\"fa fa-chevron-right\"></i></a></div>\\n</div>\\n{{/greater}}\\n{{/if}}');window.JST[\"history_base\"]=JST('<div class=\"row\">\\n  <div class=\"container shave\">\\n    {{#if id}}\\n      <h1 class=\"history-header shave\">Task Id: {{id}}</h1>\\n    {{else}}\\n      <div class=\"column one-half\">\\n        <h1 class=\"history-header shave\">Task History</h1>\\n      </div>\\n      <div class=\"column one-half\">\\n        <div class=\"history-key\"><span class=\"status-indicator success\"></span> success &nbsp; <span class=\"status-indicator error\"></span> error &nbsp; <span class=\"status-indicator halted\"></span> filtered</div>\\n      </div>\\n    {{/if}}\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container shave head\">\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container body\">\\n  </div>\\n</div>');window.JST[\"history_nav\"]=JST('<a data-nav=\"/app/history\" href=\"#\" class=\"history-back-link\"><i class=\"fa fa-angle-left\"></i> Back to Task History</a>');window.JST[\"history_row\"]=JST('<tr class=\"history\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\" title=\"Click for more details\">\\n  <td class=\"status-column\">\\n    <div class=\"status-indicator {{this.data.status}}\"></div>\\n  </td>\\n  <td class=\"services\">\\n    <div class=\"service\">\\n      <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n    </div>\\n    <i class=\"fa fa-caret-right caret\"></i>\\n    <div class=\"service\">\\n      <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n    </div>\\n  </td>\\n  <td>\\n    <div class=\"title\">{{this.object_title}}</div>\\n  </td>\\n  <td>\\n    <button class=\"replay {{#notequals data.status \"success\"}}{{else}}invisible{{/notequals}}\"><i class=\"fa fa-repeat left\"></i> Replay</button>\\n  </td>\\n  <td>\\n    <div class=\"timesince\">{{date}}</div>\\n  </td>\\n</tr>');window.JST[\"explore_recipe\"]=JST('<div class=\"zap\">\\n\\n  <div class=\"text-narrow\">\\n    <div class=\"title\"><a href=\"#\" class=\"use-this\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n    <div class=\"description\">{{this.short_description}}</div>\\n  </div>\\n\\n  <div class=\"services\">\\n    <div class=\"service {{this.read_service_selected_api}}64x64\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{this.write_service_selected_api}}64x64\"></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    {{#if this.generated}}\\n      <div class=\"title\"><a href=\"#\" class=\"use-this\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n    {{else}}\\n      {{#if z.app.partner.isPartnerSession context=z.app.partner}}\\n        <div class=\"title\">{{this.title}}</div>\\n      {{else}}\\n        <div class=\"title\"><a href=\"{{this.url}}\">{{this.title}}</a></div>\\n      {{/if}}\\n    {{/if}}\\n    <div class=\"description\">{{this.short_description}}</div>\\n  </div>\\n\\n  <div class=\"cta\"><a class=\"big button use-this\" data-id=\"{{this.id}}\">Use this Zap</a></div>\\n\\n</div>');window.JST[\"explore_recipe_classic\"]=JST('<div class=\"recipe classic\">\\n\\n  <div class=\"images\">\\n    <div class=\"read\"><div class=\"img64 {{this.read_service_selected_api}}64x64\"></div></div>\\n    <div class=\"arrow\">&#9658;</div>\\n    <div class=\"write\"><div class=\"img64 {{this.write_service_selected_api}}64x64\"></div></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    <div class=\"description\"><a class=\"underline\" href=\"#\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n\\n    <a href=\"#\" data-id=\"{{this.id}}\"><button>Use This!</button></a>\\n\\n    <div class=\"used-by\">\\n      <div class=\"count\">{{humanize this.used}} others use this</div>\\n    </div>\\n  </div>\\n\\n  <clear />\\n\\n</div>\\n');window.JST[\"explore_search\"]=JST('<div class=\"row\">\\n  <div class=\"column one-half\">\\n    <div class=\"involve services\">\\n      <select id=\"involve-service\" data-placeholder=\"Click here and select the apps you use...\">\\n        <option></option>\\n        {{#each services}}\\n          <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n        {{/each}}\\n      </select>\\n    </div>\\n  </div>\\n\\n  <div class=\"column one-half\">\\n    <div class=\"involved-services\">\\n      {{#each involvedServices}}\\n        <div class=\"involved-service\">\\n          <div class=\"img32 {{get this \"key\"}}32x32\">&nbsp;</div>\\n          <div class=\"remove\" data-remove-involve-service=\"{{get this \"slug\"}}\"><i class=\"fa fa-times\"></i></div>\\n        </div>\\n      {{/each}}\\n    </div>\\n\\n    {{#if anyFilters}}\\n      <button class=\"do-clear\">Reset all</button>\\n      <a class=\"direct-link\" href=\"{{directLink}}\" title=\"Click to get a direct link to this page in your browser\\'s address bar\"><i class=\"fa fa-external-link\" /></a>\\n    {{/if}}\\n  </div>\\n</div>');window.JST[\"explore_results\"]=JST('<div class=\"zaps\"></div>\\n\\n{{#greater this.pagination.pages 1}}\\n<div class=\"pagination\">\\n  <div class=\"page-nav\"><a href=\"#\" class=\"previous {{#unless this.pagination.prev }}disabled{{/unless}}\"><i class=\"fa fa-chevron-left\"></i></a></div>\\n  <div class=\"page-numbers\"><span>{{ this.pagination.page }}</span> of <span>{{ this.pagination.pages }}</span></div>\\n  <div class=\"page-nav\"><a href=\"#\" class=\"next {{#unless this.pagination.next }}disabled{{/unless}}\"><i class=\"fa fa-chevron-right\"></i></a></div>\\n</div>\\n{{/greater}}');window.JST[\"explore_base\"]=JST('<div class=\"row\">\\n\t<div class=\"container center shave\">\\n\t\t<h1>Explore Zaps!</h1>\\n\t\t<p>Pick from thousands of Zaps that other people have shared to use as a template.<br />A Zap is a connection between two apps that automates time-consuming tasks.</p>\\n\t</div>\\n</div>\\n<div class=\"row\">\\n\t<div class=\"container\">\\n\t\t<div class=\"explore\">\\n\t\t\t<div class=\"search\"></div>\\n\t\t\t<div class=\"results\"></div>\\n\t\t</div>\\n\t</div>\\n</div>');window.JST[\"signup_why\"]=JST('{{#if selectedPlan}}\\n  <div class=\"selected-plan\">\\n    <h2>{{get selectedPlan \"name\"}}</h2>\\n  </div>\\n{{else}}\\n  <div class=\"trialing\">\\n    <h1>Sign Up For Free</h1>\\n    <ul class=\"default\">\\n      <li><i class=\"fa fa-check green\"></i> Access to Premium Apps</li>\\n      <li><i class=\"fa fa-check green\"></i> Unlimited Tasks and Zaps</li>\\n      <li><i class=\"fa fa-check green\"></i> Upgrade, downgrade, or cancel at any time</li>\\n    </ul>\\n  </div>\\n{{/if}}\\n\\n{{#or readService writeService}}\\n  <div class=\"services\">\\n    <h3>You are seconds away from connecting...</h3>\\n\\n    {{#if readService}}\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          <img src=\"/generated/{{get readService \"key\" context=readService}}/128/\" />\\n        </div>\\n      </div>\\n    {{else}}\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          {{#each services}}\\n            <div class=\"gray img32 {{get this \"key\" context=this}}32x32\"></div>\\n          {{/each}}\\n        </div>\\n        <h3 class=\"no-service\">hundreds of apps!</h3>\\n      </div>\\n    {{/if}}\\n\\n    {{#if writeService}}\\n      <div class=\"connection\">\\n        <em>to</em>\\n      </div>\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          <img src=\"/generated/{{get writeService \"key\" context=writeService}}/128/\" />\\n        </div>\\n      </div>\\n    {{else}}\\n      <h3 class=\"no-service\">to hundreds of other apps!</h3>\\n    {{/if}}\\n  </div>\\n\\n{{else}}\\n\\n  <div class=\"ebook\">\\n    <div class=\"book\"><img src=\"{{mediaURL}}images/ebook.png\" /></div>\\n    <div class=\"description\">\\n      <h3>Sign up and get this E-book FREE!</h3>\\n      <p class=\"small\">You\\'ll get a download link in your inbox.</p>\\n      <img src=\"{{mediaURL}}images/arrows/right.png\" class=\"arrow\" />\\n    </div>\\n  </div>\\n\\n{{/or}}');window.JST[\"signup_persona_modal\"]=JST('<h1 class=\"center\">Get Better Zap Recommendations</h1>\\n<div class=\"subhead center\">Check one or more professions below that best match you to get the best Zap recommendations.</div>\\n<div class=\"line\"></div>\\n\\n<form method=\"post\">\\n    \\n    <div class=\"group left\">\\n        {{#each first_personas}}\\n            <label><input type=\"checkbox\" name=\"persona\" value=\"{{this}}\"> {{this}}</label> <br>\\n        {{/each}}\\n    </div> <!-- end of .group .left -->\\n\\n    <div class=\"group\">\\n        {{#each second_personas}}\\n            <label><input type=\"checkbox\" name=\"persona\" value=\"{{this}}\"> {{this}}</label> <br>\\n        {{/each}}\\n    </div> <!-- end of .group -->\\n    \\n    <div class=\"clear\"></div>\\n\\n    <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\">\\n\\n    <input type=\"submit\" value=\"Let\\'s get started!\" class=\"button light\">\\n</form>\\n');window.JST[\"signup_form\"]=JST('<h3>Signup Today - It\\'s Easy!</h3>\\n<signupform></signupform>\\n<div class=\"submit-row\">\\n  <button class=\"submit big orange\">Create Your New Zapier Account</button>\\n</div>\\n\\n<div class=\"errors hide\">\\n    <i class=\"fa fa-exclamation-circle\" /> <span>A user with that email already exists.</span>\\n</div>');window.JST[\"signup_base\"]=JST('<div class=\"row signup\">\\n\t<div class=\"container haircut\">\\n\t\t<div class=\"column one-half signup-why\">\\n\t\t\t<div class=\"selected-plan\"></div>\\n\t\t</div>\\n\t\t<div class=\"column one-half signup-form\"></div>\\n\t</div>\\n</div>');window.JST[\"forgot_password\"]=JST('<p>Reset the password for {{username}}.</p>\\n<form>\\n<input type=\"password\" class=\"password1\" placeholder=\"New Password\" />\\n<input type=\"password\" class=\"password2\" placeholder=\"Confirm New Password\" />\\n<button class=\"submit\">Set New Password</button>\\n<p class=\"feedback hide\"></p>\\n</form>');window.JST[\"forgot_base\"]=JST(\"<h1>Forgot Password</h1>\");window.JST[\"forgot_email\"]=JST('<p>Enter the email address you signed up with below. An email will be sent containing a link to reset your password.</p>\\n<p>Forgot your email address? Send <a href=\"mailto:contact@zapier.com\">an email to support</a> and we\\'ll track it down.</p>\\n<form>\\n<input type=\"text\" class=\"email\" placeholder=\"Email Address\" />\\n<button class=\"submit\">Send Reset Instructions</button>\\n<p class=\"feedback hide\"></p>\\n</form>');window.JST[\"settings_plans\"]=JST('<div class=\"row\">\\n  <div class=\"container\">\\n\\n    <h1>Pricing Plans</h1>\\n\\n    <div class=\"toggle toggle-interval\">\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"month\">Monthly</a>\\n      <div class=\"toggle-container{{#if monthly}}{{else}} on{{/if}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"year\">Yearly (1 Month Free)</a>\\n    </div>\\n\\n    {{#if account.isTrialing context=account}}\\n      <div class=\"extra-info\">\\n        <p>There are {{call ../account.trialDaysLeft context=../account}} days left in your current Zapier trial.</p>\\n        <h3 class=\"haircut\">Your trial includes:</h3>\\n        <ul class=\"default\">\\n          <li><i class=\"fa fa-check green\"></i> Access to all Regular + Premium Apps</li>\\n          <li><i class=\"fa fa-check green\"></i> Unlimited Tasks and Zaps</li>\\n          <li><i class=\"fa fa-check green\"></i> 5-minute Syncing</li>\\n        </ul>\\n        <p>If you don\\'t select a plan before your trial ends, we\\'ll automatically switch your account to the free plan for you. If you have more than 5 Zaps, 100 tasks, or are using any premium apps in your Zaps, please select a plan to avoid any service interruptions.</p>\\n      </div>\\n    {{/if}}\\n\\n  {{#if provider}}\\n    <div class=\"extra-info\">You have a Zapier account sponsored by {{provider.title}}! That means you get free access to lots of Zapier benefits without the costs. However, you can upgrade to a full Zapier to unlock more features.<!-- <a href=\"#\" data-support-tags=\"sponsored-account\">Click to learn more.</a>--></div>\\n  {{/if}}\\n\\n  {{#if coupon}}\\n    <div class=\"extra-info\">Coupon is active! {{coupon}}</div>\\n  {{/if}}\\n\\n    {{#if cached_coupon.description}}\\n      <div class=\"extra-info\">Coupon is ready for upgrade! {{cached_coupon.description}}</div>\\n    {{/if}}\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container table-fixed-width\">\\n    <div class=\"overflow-container\">\\n      <table class=\"table table-striped\">\\n        <thead>\\n          <tr class=\"table-header-row\">\\n            <th>Plan</th>\\n            <th>Price</th>\\n            <th style=\"width:150px;\">Premium Services</th>\\n            <th>Tasks/mo</th>\\n            <th>Zaps</th>\\n            <th>Zaps Run Every</th>\\n            <th class=\"change\">Action</th>\\n          </tr>\\n        </thead>\\n\\n        <tbody id=\"plans\">\\n          {{#each plans}}\\n            <tr>\\n              <td>{{get this \"name\"}}</td>\\n              <td>${{dollars}}/{{get this \"interval\"}}</td>\\n              <td class=\"center\">{{#hasExactly this.blacklistedServices 0}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-times\"></i>{{/hasExactly}}</td>\\n              <td>{{tasksMo}}</td>\\n              <td>{{zaps}}</td>\\n              <td>{{pollInterval}} {{pollIntervalTimeFrame}}</td>\\n              <td>\\n              {{#if current}}\\n                <a class=\"button disabled\">Your current plan</a>\\n              {{else}}\\n                {{#if ../../account.hasActiveCard context=../../account}}\\n                  <button class=\"light {{#if ../../isFree}}change-plan{{else}}add-card{{/if}}\" data-change-plan=\"{{../../id}}\">{{../../buttonText}}</button>\\n                {{else}}\\n                  <a class=\"add-card button\" data-change-plan=\"{{../../id}}\">Switch to this plan</a>\\n                {{/if}}\\n              {{/if}}\\n              </td>\\n            </tr>\\n          {{/each}}\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"row border\">\\n   <div class=\"container\">\\n\\n  {{#if showCoupon}}\\n    <div class=\"coupon-form\">\\n      <span class=\"feedback\"></span>\\n      <input class=\"coupon-code\" type=\"text\" name=\"coupon-code\" placeholder=\"Enter your coupon code...\">\\n      <button class=\"submit light\">Use Coupon</button>\\n    </div>\\n  {{/if}}\\n\\n  </div>\\n</div>\\n{{JST \"pricing_about\"}}');window.JST[\"settings_overview\"]=JST('<div class=\"picture\">\\n  <img src=\"https://secure.gravatar.com/avatar/{{email_hash}}.jpg?s=30&amp;d=mm\">\\n</div>\\n<div class=\"table left\">\\n<span class=\"key\">Email:</span><span class=\"val\">{{email}}</span><br />\\n<span class=\"key\">Joined:</span><span class=\"val\">{{since_signup}} ago</span><br />\\n</div>\\n<div class=\"table right\">\\n<span class=\"key\">Plan:</span><span class=\"val\">{{plan.name}}</span><br />\\n<span class=\"key\">Status:</span><span class=\"val\">{{status}}</span><br />\\n</div>');window.JST[\"settings_extra\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"advanced\"><i class=\"fa fa-wrench\"></i> Advanced Settings</a></h3>\\n    <p>Modify advanced or technical settings with your account</p>\\n    <p><a href=\"#\" class=\"advanced action left\">Monkey with advanced settings</a></p>\\n    <p><a href=\"#\" class=\"close\">Click here to permanently delete your account</a></p>\\n  </li>\\n</ul>');window.JST[\"settings_invoices\"]=JST('<div class=\"row\">\\n  <div class=\"container settings invoices\">\\n\\n    <h1>Invoices</h1>\\n    {{#if billing_period_start_date}}\\n      <h4>Your next billing period starts on {{billing_period_start_date}}</h4>\\n    {{/if}}\\n\\n    <table class=\"table\">\\n      <thead>\\n        <tr>\\n          <th>Billing Period Starting</th>\\n          <th>Subtotal</th>\\n          <th>Discount</th>\\n          <th>Amount</th>\\n          <th>Status</th>\\n          <th>Actions</th>\\n        </tr>\\n      </thead>\\n      <tbody id=\"invoices\">\\n        <tr>\\n          <td colspan=\"7\" class=\"center\"><em>No past invoices to see...</em></td>\\n        </tr>\\n      </tbody>\\n    </table>\\n\\n    <p><a data-nav=\"/app/settings\">Back to settings</a></p>\\n\\n  </div>\\n</div>');window.JST[\"settings_billing\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"plans\"><i class=\"fa fa-tag\"></i> Current Plan</a></h3>\\n    <p>{{plan_name}} {{plan_rate}} <a href=\"#\" class=\"plans action\">See other plans</a></p>\\n    <p>{{#if last4}}Credit Card Last Four: {{last4}} <a href=\"#\" class=\"card action left\">Update credit card</a>{{else}}<a href=\"#\" class=\"card action left\">Add credit card</a>{{/if}}</p>\\n    <p><a href=\"#\" class=\"invoice action left\">See invoices</a></p>\\n  </li>\\n</ul>');window.JST[\"settings_card\"]=JST('<table class=\"table table-bordered credit-card\">\\n  <thead>\\n    <tr>\\n      <th>Type</th>\\n      <th>Number</th>\\n      <th>Expiration</th>\\n    </tr>\\n  </thead>\\n\\n  <tbody>\\n    <tr>\\n      {{#if last4}}\\n        <td>{{type}}</td>\\n        <td>xxxx-xxxx-xxxx-{{last4}}</td>\\n        <td>{{expM}}/{{expY}}</td>\\n      {{else}}\\n        <td colspan=\"3\"><em>No card on file.</em></td>\\n      {{/if}}\\n    </tr>\\n  </tbody>\\n</table>');window.JST[\"settings_invoice\"]=JST('<tr>\\n  <td>{{period_end_pretty}}</td>\\n  <td>${{subtotal_pretty}}</td>\\n  <td>{{#if discount.coupon.percent_off}}\\n    {{discount.coupon.percent_off}}% off\\n  {{else}}\\n    {{#if discount.coupon.amount_off}}\\n      ${{discount.coupon.amount_off_pretty}} off\\n    {{/if}}\\n  {{/if}}</td>\\n  <td>${{total_pretty}}</td>\\n  <td>\\n    {{#if charge.refunded}}\\n      <i class=\"fa fa-check-circle green\"></i> Refunded\\n    {{else}}\\n      {{#if paid}}\\n        <i class=\"fa fa-check green\"></i> Paid\\n      {{else}}\\n        {{#if next_payment_attempt}}\\n          <i class=\"fa fa-calendar\"></i> Scheduled {{next_payment_attempt_pretty}}\\n        {{else}}\\n          <i class=\"fa fa-minus-circle\"></i> Balance Due\\n        {{/if}}\\n      {{/if}}\\n    {{/if}}\\n  </td>\\n  <td>\\n    <a class=\"button details\" id=\"{{cid}}\">View details</a>\\n    {{#if printable_url}}<a href=\"{{printable_url}}\" class=\"button\" target=\"_new\">Print</a>{{/if}}\\n  </td>\\n</tr>\\n<tr class=\"invoice-details\" id=\"{{cid}}\">\\n  <td class=\"holders\" colspan=\"7\">\\n    <table class=\"table table-bordered\">\\n      <thead>\\n        <tr>\\n          <th>Date</th>\\n          <th>Amount</th>\\n          <th>Description</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each lines.invoiceitems}}\\n        <tr>\\n          <td>{{date_pretty}}</td>\\n          <td>${{amount_pretty}}</td>\\n          <td>{{description}}</td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"3\" class=\"center\">\\n            <div class=\"no-results\">No line item information available.</div>\\n          </td>\\n        </tr>\\n      {{/each}}\\n      </tbody>\\n    </table>\\n\\n    <table class=\"table table-bordered\">\\n      <thead>\\n        <tr>\\n          <th>Plan Name</th>\\n          <th>Amount</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each lines.subscriptions}}\\n        <tr>\\n          <td>{{plan.name}}</td>\\n          <td>${{plan.amount_pretty}}</td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"1\" class=\"center\">\\n            <div class=\"no-results\">No plan information available.</div>\\n          </td>\\n        </tr>\\n      {{/each}}\\n    </table>\\n  </td>\\n</tr>');window.JST[\"settings_settings_modal\"]=JST('<h2>{{title}}</h2>\\n<paramform></paramform>\\n<clear />\\n<div>\\n  <button class=\"submit orange\">{{#if button}}{{button}}{{else}}Save changes{{/if}}</button>\\n  <span class=\"feedback\"></span>\\n</div>');window.JST[\"settings_auths\"]=JST('<div class=\"row\">\\n  <div class=\"container shave\">\\n    <h1 class=\"history-header shave\">Connected Accounts</h1>\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container shave\">\\n\\n  <div class=\"auth-select\">\\n    <select id=\"add\" data-placeholder=\"Connect new account\" data-which=\"add\">\\n      <option></option> <!-- placeholder -->\\n      {{#each services}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n  </div>\\n\\n\\n  <div class=\"auth-select\">\\n    <select id=\"request\" data-placeholder=\"Request access to a new account via email\" data-which=\"request\">\\n      <option></option> <!-- placeholder -->\\n      {{#each services}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n  </div>\\n\\n  </div><!-- container -->\\n</div><!-- row -->\\n\\n<div class=\"row\">\\n  <div class=\"container\">\\n\\n    <table class=\"auths-table table table-striped\">\\n      <thead>\\n        <tr>\\n          <th>Service</th>\\n          <th>Connected</th>\\n          <th class=\"center\">Zaps</th>\\n          <th></th>\\n          <th></th>\\n          <th></th>\\n          <th></th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each auths}}\\n        <tr data-id=\"{{this.id}}\">\\n          <td class=\"name\">\\n            <div class=\"service\">\\n              <div class=\"service-icon {{this.selected_api}}16x16\" title=\"{{appNameFromKey this.selected_api}}\"></div>\\n            </div>\\n            {{this.name}}\\n          </td>\\n          <td class=\"age\">{{this.prettyDate}}</td>\\n          <td class=\"used center\">{{this.used}}</td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller test\">Test</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller rename\">Rename</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller reconnect\">Reconnect</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller disconnect\">Disconnect</button>\\n          </td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"7\" class=\"empty\">You don\\'t have any conncted accounts!</td>\\n        </tr>\\n      {{/each}}\\n      </tbody>\\n    </table>\\n\\n  </div><!-- container -->\\n</div><!-- row -->');window.JST[\"settings_base\"]=JST('<div class=\"row\">\\n   <div class=\"container shave\">\\n      <h1 class=\"shave\">Settings</h1>\\n   </div>\\n</div>\\n\\n<div class=\"row settings\">\\n  <div class=\"container\">\\n    <div class=\"column one-half\">\\n      <div class=\"my-account\"></div>\\n    </div>\\n    <div class=\"column one-half\">\\n      <div class=\"billing\"></div>\\n      <div class=\"extra\"></div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"settings_my_account\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"user\"><i class=\"fa fa-user\"></i> Your Profile</a></h3>\\n    <div class=\"profile-image\">\\n      <div class=\"picture-small\">\\n        <img src=\"https://secure.gravatar.com/avatar/{{ account.email_hash }}.jpg?s=50&amp;d=mm\" />\\n      </div>\\n      <a href=\"#\" class=\"user action\">Change profile image</a>\\n    </div>\\n    {{#if account.provider}}\\n      <p><em>You signed up with a sponsored account, which doesn\\'t have the ability to modify an account\\'s email address. Please contact support for help.</em></h3>\\n    {{else}}\\n      <p>{{account.email}} <a href=\"#\" class=\"account action\">Change email</a></p>\\n      <p>* * * * <span class=\"info-hidden\">(hidden)</span> <a href=\"#\" class=\"account action\">Change password</a></p>\\n    {{/if}}\\n    <p>{{account.first_name}} {{account.last_name}} <a href=\"#\" class=\"user action\">Change name</a></p>\\n    {{#if account.company_name}}\\n    <p>{{account.company_name}} <a href=\"#\" class=\"user action\">Change company name</a></p>\\n    {{else}}\\n    <p><a href=\"#\" class=\"user action left\">Add a company name</a></p>\\n    {{/if}}\\n    {{#notequals account.timezone \"-----\"}}\\n    <p>{{account.timezone}} <a href=\"#\" class=\"user action\">Change timezone</a></p>\\n    {{else}}\\n    <p><a href=\"#\" class=\"user action left\">Set your timezone</a></p>\\n    {{/notequals}}\\n  </li>\\n  <li>\\n    <h3><a href=\"#\" class=\"email\"><i class=\"fa fa-envelope\"></i> Notification Settings</a></h3>\\n    <p>Activity summary email: {{account.summary_schedule}} <a href=\"#\" class=\"email action\">Change</a></p>\\n    <p>Send alerts on failed trigger: {{account.alert_triggers}} <a href=\"#\" class=\"email action\">Change</a></p>\\n    <p>Send alerts on failed action: {{account.alert_actions}} <a href=\"#\" class=\"email action\">Change</a></p>\\n  </li>\\n</ul>');window.JST[\"common_form_checkbox_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"checkbox\"\\n  {{#if val}}checked=\"checked\"{{/if}}\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>\\n\\n<label for=\"{{key}}\">{{#if help_text_html}}{{{help_text_html}}}{{else}}{{help_text}}{{/if}}</label>');window.JST[\"common_form_select_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_unicode_prettypill_row\"]=JST('{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[0] cid=cid ccode=ccode}}</span>\\n{{/if}}\\n\\n<textarea\\n  data-id=\"{{key}}\"\\n  data-type=\"unicode\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"{{#if input_format}} flanked{{/if}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n>{{val}}</textarea>\\n\\n\\n{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[2] cid=cid ccode=ccode}}</span>\\n  <button class=\"copy-button\" data-clipboard-text=\"{{render input_format.[0] cid=cid ccode=ccode}}{{value}}{{render input_format.[2] cid=cid ccode=ccode}}\">Copy to clipboard</button>\\n{{/if}}');\nwindow.JST[\"common_form_unicode_row\"]=JST('{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[0] cid=cid ccode=ccode}}</span>\\n{{/if}}\\n\\n<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"{{#if input_format}} flanked{{/if}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n/>\\n\\n\\n{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[2] cid=cid ccode=ccode}}</span>\\n  <button class=\"copy-button\" data-clipboard-text=\"{{render input_format.[2] cid=cid ccode=ccode}}\">Copy to clipboard</button>\\n{{/if}}');window.JST[\"common_form_prefill_empty_modal\"]=JST('<div class=\"prefill-error-modal\">\\n  <h2>{{sapi}} did not return any {{#plural}}{{sfield}}{{/plural}}</h2>\\n  <h3>What To Do Next</h3>\\n  <ol>\\n      <li>Log into {{sapi}} and create a new {{sfield}}</li>\\n      <li>Note: this field ({{#plural}}{{sfield}}{{/plural}}) may be filtered by fields above it</li>\\n      <li>Make sure you\\'ve followed all on-screen instructions in order</li>\\n      <li>Retry in a few seconds</li>\\n  </ol>\\n</div>');window.JST[\"common_form_prefill_error_modal\"]=JST('<div class=\"prefill-error-modal\">\\n  <h2>We received an error while accessing {{sapi}}</h2>\\n\\n  <pre class=\"error\">{{message}}</pre>\\n  <h3>What To Do Next</h3>\\n  <ol>\\n      <li>Make sure you complete fields in order they appear</li>\\n      <li>Make sure you\\'ve followed all on-screen instructions</li>\\n      <li>Retry in a few seconds</li>\\n      <li>Your {{sapi}} Account may not be working anymore, go back and test it</li>\\n  </ol>\\n</div>');window.JST[\"common_form_text_row\"]=JST('<textarea\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"multi-row\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n>{{val}}</textarea>');window.JST[\"common_form_upload_row\"]=JST('<div class=\"file-button-wrapper\">\\n   <span class=\"button\">Choose a file</span>\\n   <input\\n     data-id=\"{{key}}\"\\n     data-type=\"{{type}}\"\\n     data-input=\"true\"\\n     data-url=\"{{dataUrl}}\"\\n     name=\"image\"\\n\\n     {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n\\n     type=\"file\"\\n     autocomplete=\"off\"\\n\\n     {{#if disabled}}disabled=\"disabled\"{{/if}}\\n   />\\n</div>\\n\\n<div class=\"currently\">Currently: <a href=\"{{val}}\">{{val}}</a></div>\\n\\n<clear/>\\n');window.JST[\"common_form_confirmation_row\"]=JST('<a class=\"send-confirmation pill-button orange {{#if sentConfirmation}}hide{{/if}}\" data-id=\"{{key}}\">Send PIN</a>\\n\\n<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  class=\"input-confirmation {{#unless sentConfirmation}}hide{{/unless}} xlarge confirmation-width\"\\n  autocomplete=\"off\"\\n\\n  placeholder=\"Enter confirmation PIN\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_required_error\"]=JST(\"Please complete all required fields.\");window.JST[\"common_form_file_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  class=\"input-file\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_base_row\"]=JST('{{#unless hideLabel}}\\n<div class=\"label {{#if required}}required{{else}}not-required{{/if}}\">\\n  {{call model.getLabel context=model}}\\n  <span class=\"required-text\">{{#if required}}(required){{else}}(optional){{/if}}</span>\\n  <span class=\"extra\" data-extra=\"true\"></span></div>\\n  {{#if help_text_html}}\\n  <div class=\"helper\">{{{help_text_html}}}</div>\\n  {{else}}\\n  {{#if help_text}}<div class=\"helper\">{{help_text}}</div>{{/if}}\\n  {{/if}}\\n{{/unless}}\\n\\n<div class=\"input\">\\n  {{{row_html}}}\\n\\n  {{#if prefill}}<div class=\"fill-button {{#if busy}}busy{{/if}}\"></div>{{/if}}\\n\\n  {{#or choices givefill}}<div class=\"fill-button\"></div>{{/or}}\\n  \\n  {{#if userfill}}<div class=\"add-placeholder button\">Insert <span class=\"img16 {{#if userfillClass}}{{userfillClass}}{{else}}placeholder{{/if}}\"></span> fields</div>{{/if}}\\n\\n</div>\\n\\n\\n{{#if list}}\\n<div class=\"add-or-remove\">\\n  <div class=\"add\" title=\"Add or remove another field.\" data-id=\"{{key}}\"></div>\\n  <div class=\"remove\" title=\"Add or remove another field.\" data-id=\"{{key}}\"></div>\\n</div>\\n{{/if}}');window.JST[\"common_form_password_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"password\"\\n  value=\"{{val}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>')}).call(this);"
      },
      "/inline_8de103de7a1b26828a0c591532fb8bd4": {
         "body": "\n    var path = '/zapbook/evernote/';\n    var mediaUrl = 'https://zapier.cachefly.net/static/CUEw7C/';\n    var preload = {};\n  \n    preload.account = {};\n  \n    var DEBUG = false;\n    var STRIPE_PUB_API_KEY = 'pk_phnG9Y3BlUIYXVpH1gkMOJ25RGbsI';\n    var TITLE_APPEND = ' - Zapier';\n    var PARTNER_ENVIRONMENT = null;\n    var PERSONAS = [\"Contractor\", \"Customer Support\", \"Designer\", \"Developer\", \"Freelancer\", \"Government\", \"Human Resource\", \"Information Technology\", \"Lawyer\", \"Marketer\", \"Non-Profit\", \"Real Estate\", \"Sales\", \"Small Business Owner\", \"Other\"];\n    \n  ",
         "pageUrl": "https://zapier.com/zapbook/evernote/",
         "scriptUrl": "/inline_8de103de7a1b26828a0c591532fb8bd4"
      },
      "/inline_e69bb54d3ecd3353e02d5b862166c3e3": {
         "body": "\nwindow.tests = window.tests || {};\n\n// place test switches!\n// See if adding a guider on mapping step bumps signup to live zap %\nwindow.tests.editorMappingGuiders = false;\nwindow.tests.seeUserfillHelper = false;\nwindow.tests.canGetSuggestions = false;\n\n",
         "pageUrl": "https://zapier.com/zapbook/evernote/",
         "scriptUrl": "/inline_e69bb54d3ecd3353e02d5b862166c3e3"
      },
      "https://zapier.cachefly.net/static/CUEw7C/build/templates.js": {
         "pageUrl": "https://zapier.com/zapbook/dropbox/",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEw7C/build/templates.js",
         "body": "(function(){window.JST=window.JST||{};window.JST[\"login\"]=JST('<h1>Login</h1>\\n<form id=\"login-form-static\" autocomplete=\"on\" action=\"/login/\" method=\"post\">\\n  <!-- the id of the form, login-form, is depended upon to sub in/out of the DOM -->\\n  <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\" />\\n  <input type=\"hidden\" name=\"next\" value=\"{{next}}\" />\\n  <input id=\"email\" name=\"email\" type=\"text\" class=\"account\" placeholder=\"Email\" autocomplete=\"on\" />\\n  <input id=\"password\" name=\"password\" type=\"password\" class=\"password\" placeholder=\"Password\" autocomplete=\"on\" />\\n  <input type=\"submit\" class=\"submit\" value=\"Log In\" />\\n  <span class=\"alt-cta\"><a href=\"/app/forgot\" data-nav=\"app/forgot\">Forgot password?</a></span>\\n  <p class=\"feedback error\">\\n    {{#equals status \"tryagain\"}}Incorrect email or password.{{/equals}}\\n  </p>\\n</form>\\n<div class=\"signup\">Don\\'t have a Zapier account yet? <em><a href=\"/app/signup{{#if next}}?next={{next}}{{/if}}\" data-nav=\"app/signup{{#if next}}?next={{next}}{{/if}}\">Signup Now!</a></em></div>');window.JST[\"test\"]=JST(\"<div>hello world</div>\");window.JST[\"preloader\"]=JST('<div class=\"preloader\">\\n  <div class=\"boundary\">\\n    <div class=\"progress\" src=\"{{mediaURL}}images/logo60orange.png\"></div>\\n    <div class=\"logo\" src=\"{{mediaURL}}images/logo60grey.png\"></div>\\n  </div>\\n  <div class=\"retry\">So sorry! Let\\'s try that again, shall we? <button>Refresh this page</button></div>\\n</div>');window.JST[\"dashboard_zaps\"]=JST('{{#hasAtLeastOne z.app.reads}}\\n\\n  <div class=\"live-block\">\\n    <h2>On</h2>\\n    <div class=\"empty-block\">You have no Zaps turned on. <a href=\"#\" data-nav=\"app/editor\">Make a new Zap</a>{{#unless isPartner}} or <a href=\"#\" data-nav=\"app/explore\">Explore Zap templates to start with</a>{{/unless}}.</div>\\n  </div>\\n\\n  <div class=\"paused-block\">\\n    <h2>Off</h2>\\n    <div class=\"empty-block\">You have no Zaps turned off.</div>\\n  </div>\\n\\n  <div class=\"unfinished-block\">\\n    <h2>Drafts</h2>\\n    <div class=\"empty-block\">You have no Unfinished Zaps.</div>\\n  </div>\\n\\n{{else}}\\n\\n<div class=\"no-zaps inlay\">\\n  <h2>You haven\\'t built any Zaps yet!</h2>\\n  <a class=\"pill-button orange huge\" href=\"/app/editor\" data-nav=\"app/editor\">Make your first Zap now</a>\\n</div>\\n\\n{{/hasAtLeastOne}}\\n');window.JST[\"dashboard_logs\"]=JST('<h3>Task History</h3>\\n{{#hasAtLeastOne logs}}\\n<a href=\"/app/history\" data-nav=\"app/history\" class=\"right-link\">See all</a>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"dashboard-log\">\\n{{#each logs max=8}}\\n  <div class=\"history\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\" title=\"Click for more details\">\\n    <div class=\"services\">\\n      <div class=\"service\">\\n        <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n      </div>\\n      <i class=\"fa fa-caret-right caret\"></i>\\n      <div class=\"service\">\\n        <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n      </div>\\n    </div>\\n    <div class=\"title\">{{this.object_title}}</div>\\n    <div class=\"timesince\">{{this.timesince}} ago</div>\\n    <div class=\"status-indicator {{this.data.status}}\"></div>\\n  </div>\\n{{else}}\\n  <div>\\n    <div class=\"empty\"><em>No recent activity.</em></div>\\n  </div>\\n{{/each}}\\n</div>\\n\\n{{#hasAtLeastOne logs}}\\n<p class=\"small more\"><a href=\"/app/history\" data-nav=\"app/history\">See all task history</a></p>\\n{{/hasAtLeastOne}}');window.JST[\"dashboard_search\"]=JST('{{#greater readCount 1}}\\n<i class=\"fa fa-search\"></i>\\n<input type=\"text\" placeholder=\"Search your own Zaps by name, service, trigger, or action...\" value=\"{{search}}\" />\\n<a href=\"#\" class=\"clear\"><i class=\"fa fa-times-circle\"></i></a>\\n{{/greater}}');window.JST[\"dashboard_bonus\"]=JST('<div class=\"top-hat\">\\n  Get Free Bonuses\\n  <div class=\"right\"><em><a class=\"blue\" href=\"/bonus\">learn more</a></em></div>\\n</div>\\n\\n<div class=\"content\">\\n  <ol>\\n  {{#each bonuses}}\\n    <li class=\"bonus {{#if earned}}earned{{/if}} {{#if partial_earned}}partial_earned{{/if}}\" id=\"{{this.id}}\">\\n\\n      <span class=\"description\">\\n        <i class=\"checkmark\"></i>\\n        <h5>\\n          {{#unless earned}}<a href=\"/bonus\">{{/unless}}\\n          {{title}}\\n          {{#unless earned}}</a>{{/unless}}\\n        </h5>\\n        <br />\\n        <span class=\"count\">\\n          {{#notequals limit \"1\"}}\\n          earned {{times_earned}} / {{#equals limit \"-1\"}}unlimited{{else}}{{limit}}{{/equals}} times\\n          {{/notequals}}\\n        </span>\\n      </span>\\n\\n      <div class=\"incentive\">\\n        <span class=\"number\">+{{action_limit_extra}}</span> tasks\\n      </div>\\n\\n    </li>\\n  {{/each}}\\n  </ol>\\n\\n</div>');window.JST[\"dashboard_zap\"]=JST('{{#greater read.held_items 0}}\\n<a class=\"held button\" title=\"This Zap has {{read.held_items}} waiting for your review before they can be processed.\" href=\"/engine/zaps/{{read.id}}/release\"><i class=\"fa fa-exclamation-circle\"></i></a>\\n{{else}}\\n{{#if unseen}}\\n<a class=\"count button\" title=\"View recent task history ({{unseen}}) for this Zap\" href=\"/app/history/?write_id={{write.id}}\" data-nav=\"app/history?write_id={{write.id}}\">{{unseen}}</a>\\n{{/if}}\\n{{/greater}}\\n\\n<div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n\\n<div class=\"twrapper\">\\n  <div class=\"services\">\\n    <div class=\"service {{ cssReadClass }}\" title=\"[Service name]\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{ cssWriteClass }}\" title=\"Connect {{ recipe.write_service.title }}\"></div>\\n  </div>\\n  <div class=\"title\">{{try title \"Unnamed Zap\"}}</div>\\n\\n  <div class=\"controls\">\\n    {{#unless errorString}}\\n    <div class=\"toggle\">\\n      <a href=\"#\" class=\"switch\" data-toggle=\"off\">Off</a>\\n      <div class=\"toggle-container{{#unless read.paused}} on{{/unless}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-toggle=\"on\">On</a>\\n    </div>\\n    {{/unless}}\\n    <div class=\"open-menu\">\\n      <div class=\"menu-button\">\\n        <i class=\"fa fa-cog\"></i>\\n      </div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"dashboard_limits\"]=JST('<h3>Account Usage</h3>\\n{{#each limits.allotment}}\\n  <div class=\"limit\" id=\"{{slugify name}}\">\\n    <div class=\"name\">{{name}}</div>\\n\\n    <div class=\"count\">{{this.count}} / {{limit}}</div>\\n\\n    <div class=\"progress-bar striped\">\\n      <div class=\"bar {{status}}\" style=\"width: {{percent}}%;\"></div>\\n    </div>\\n\\n  </div>\\n{{/each}}\\n\\n<p class=\"small cycle\">Monthly Usage Resets In: {{limits.billing_cycle_time_left}}</p>\\n\\n<p class=\"small\"><a href=\"#\" data-nav=\"/app/settings/plans\" title=\"See other available pricing plans\">Need more tasks or Zaps?</a></p>');window.JST[\"dashboard_partner_text\"]=JST('<div class=\"step\">\\n  <h1>Zapier enables you to connect {{service}} to hundreds of other web services!</h1>\\n  <a href=\"#\" class=\"button orange big\">Learn How &nbsp; <i class=\"fa fa-arrow-right \"></i></a>\\n</div>\\n\\n<div class=\"step hide\">\\n  <h1>Zaps automate common tasks.</h1>\\n  <h2>Here is an example:</h2>\\n  <div class=\"example\">\\n    <div class=\"zap-step\">\\n      <i class=\"img64 {{readService}}64x64\"></i> {{readAction}}\\n      <br />\\n      <img src=\"{{mediaURL}}images/arrows/trigger.png\"></img>\\n    </div>\\n\\n    <div class=\"zap-step\">\\n      <i class=\"img64 {{writeService}}64x64\"></i> {{writeAction}}\\n      <br />\\n      <img src=\"{{mediaURL}}images/arrows/action.png\"></img>\\n    </div>\\n  </div>\\n  <div class=\"clear\"></div>\\n  <a href=\"#\" class=\"button orange big\">Alright, let\\'s do this! &nbsp; <i class=\"fa fa-arrow-right \"></i></a>\\n</div>\\n\\n<div class=\"step hide\">\\n  <h1>Pick a Zap over here to get started!</h1>\\n  <br/>\\n  <img src=\"{{mediaURL}}images/arrows/right.png\" />\\n</div>');window.JST[\"dashboard_zap_menu\"]=JST('<ul class=\"zap-menu\">\\n{{#if canRun}}\\n  {{#unless errorString}}\\n  {{#unless read.paused}}\\n  <li><a href=\"#\" class=\"run\"><i class=\"fa fa-repeat\"></i> Run</a></li>\\n  {{/unless}}\\n  {{/unless}}\\n{{else}}\\n  {{#unless errorString}}\\n  {{#unless read.paused}}\\n  <li class=\"no-hover\"><a href=\"#\" class=\"instant\"><i class=\"fa fa-bolt\"></i> Instant!</a></li>\\n  {{/unless}}\\n  {{/unless}}\\n{{/if}}\\n<li>\\n  <a href=\"#\" class=\"edit\" data-nav=\"app/editor/{{read.id}}\">\\n    <i class=\"fa fa-edit\"></i> Edit\\n  </a>\\n</li>\\n<li><a href=\"#\" class=\"logs\" data-nav=\"app/history?write_id={{write.id}}\"><i class=\"fa fa-bars\"></i> History</a></li>\\n<li>\\n  <a href=\"#\" class=\"copy\">\\n    <i class=\"fa fa-copy\"></i>\\n    <span class=\"default\">Copy</span>\\n    <span class=\"working\">Copying...</span>\\n  </a>\\n</li>\\n<li><a href=\"#\" class=\"rename\"><i class=\"fa fa-tag\"></i> Rename</a></li>\\n{{#if canShare}}\\n<li><a href=\"#\" class=\"share\"><i class=\"fa fa-share\"></i> Share</a></li>\\n{{/if}}\\n<li>\\n<a href=\"#\" class=\"delete\">\\n  <i class=\"fa fa-times-circle\"></i>\\n  <span class=\"default\">Delete</span>\\n  <span class=\"confirm\">Really delete?</span>\\n</a>\\n</li>\\n</ul>');window.JST[\"dashboard_subscribe\"]=JST('<span class=\"subscribe-info\">\\n<p class=\"small\">Want tips to help you become more efficient, productive, and awesome?</p>\\n<a href=\"#\" class=\"button\">Subscribe to the Zapier blog!</a>\\n</span>\\n\\n<span class=\"subscribe-message\">\\n<p>Want tips to help you become more efficient, productive, and awesome?</p>\\n<p class=\"success\"><i class=\"fa fa-check\"></i>&nbsp;Great, welcome inside!</p>\\n<p>Enjoy some of the best workplace productivity advice around.</p>\\n</span>');window.JST[\"dashboard_create\"]=JST('<a href=\"#\" class=\"orange button\" data-nav=\"app/editor\">Make a New Zap</a> {{#unless isPartner}}<span class=\"alt-cta\">or <a href=\"#\" data-nav=\"app/explore\" title=\"Explore Zap templates to start with\">Explore Zaps</a></span>{{/unless}}');window.JST[\"dashboard_partner_zaps\"]=JST('<h2>Select {{service}} Zaps</h2>\\n\\n{{#each recipes}}\\n  <div class=\"zap-mini\">\\n\\n    <div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n    <div class=\"twrapper\">\\n      <div class=\"services\">\\n        <div class=\"service {{this.read_service_selected_api}}32x32\"></div>\\n        <span class=\"fa fa-caret-right caret\"></span>\\n        <div class=\"service {{this.write_service_selected_api}}32x32\"></div>\\n      </div>\\n      <div class=\"title\">{{this.short_description}}</div>\\n\\n      <div class=\"controls\">\\n        <div class=\"use-this\">\\n          <button data-template-id=\"{{this.id}}\">Use This</button>\\n        </div>\\n      </div>\\n    </div>\\n\\n  </div>\\n{{/each}}\\n\\n<br/>\\n\\n{{#if button}}\\n  <button data-nav=\"app/edit\" class=\"large\">Or create your own {{service}} Zap!</button>\\n{{/if}}');window.JST[\"dashboard_base\"]=JST('<!-- <div class=\"row\">\\n  <div class=\"container shave\">\\n    <h1 class=\"shave\">Zap Dashboard</h1>\\n  </div>\\n</div> -->\\n\\n<div class=\"row dashboard\">\\n  <div class=\"container empty\">\\n    <!-- sorry, we\\'ll come back to it... -->\\n    <!-- empty dashboard on partner -->\\n    <div class=\"column one-half left\"></div>\\n    <div class=\"column one-half right\"></div>\\n    <div class=\"clear\"></div>\\n  </div>\\n\\n  <div class=\"container\">\\n    <div class=\"column two-thirds main-col\">\\n      <div class=\"search\"></div>\\n      <div class=\"zaps\"></div>\\n      <div class=\"start\"></div>\\n    </div>\\n    <div class=\"column one-third side-col\">\\n    </div>\\n  </div>\\n</div>\\n');window.JST[\"common_rename_modal\"]=JST('<form>\\n<input type=\"text\" value=\"{{value}}\" placeholder=\"Name\" />\\n<button class=\"save orange\">Save</button>\\n<button class=\"close\">Cancel</button>\\n</form>');window.JST[\"common_base_modal\"]=JST('<div class=\"modal-container\">{{#unless noX}}<div class=\"x\"><i class=\"fa fa-times-circle\"></i></div>{{/unless}}<div class=\"modal invisible\"></div></div>');window.JST[\"common_data_table_modal\"]=JST('<table class=\"fields-table table table-bordered table-striped\">\\n{{#each data}}\\n  {{#notequals this.value \"[object Object]\"}}\\n    <tr>\\n      <td class=\"key\"><strong>{{this.key}}</strong></td>\\n      <td class=\"value\"><pre>{{this.value}}</pre></td>\\n    </tr>\\n  {{/notequals}}\\n{{/each}}\\n</table>');window.JST[\"common_auth_edit_modal\"]=JST('<ul>\\n  <li class=\"rename\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-pencil\"></span> Rename this Account</a></li>\\n  {{#unless onEditor}}\\n  <li class=\"delete\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-trash\"></span> Delete this Account</a></li>\\n  {{else}}\\n  <li class=\"manage\" id=\"{{id}}\"><a href=\"#\"><span class=\"fa fa-th-list\"></span> Manage your Accounts</a></li>\\n  {{/unless}}\\n</ul>');window.JST[\"common_since_you_been_gone_modal\"]=JST('<div class=\"row border\">\\n  <h1 class=\"center\">Good To See You Again!</h1>\\n  <p>We\\'ve been working hard to make your life easier. Here\\'s what\\'s new since you last visited...</p>\\n</div>\\n\\n<div class=\"blog\">\\n\\n{{#each updates}}\\n  <div class=\"entry border\">\\n    <div class=\"title\">\\n      <div class=\"service\">\\n        <div class=\"service img64 {{selected_api}}64x64\"></div>\\n      </div>\\n      <h2><a href=\"{{link}}\">{{title}}</a></h2>\\n    </div>\\n\\n    <div class=\"date\">{{prettyISO date}} by {{added_by_name}}</div>\\n\\n    {{{description_trunc}}}\\n  </div><!-- entry -->\\n{{/each}}\\n\\n</div><!-- blog -->\\n<br />\\n<a href=\"/zapbook/updates\">See more updates <i class=\"fa fa-arrow-right\"></i></a>');window.JST[\"common_recipe\"]=JST('<div class=\"recipe\">\\n\\n  <div class=\"images\">\\n    <div class=\"read\"><div class=\"img32 {{this.read_service_selected_api}}32x32\"></div></div>\\n    <div class=\"arrow\">&#9658;</div>\\n    <div class=\"write\"><div class=\"img32 {{this.write_service_selected_api}}32x32\"></div></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    <div class=\"description\"><a class=\"underline\" href=\"#\" data-id=\"{{this.id}}\">{{this.short_description}}</a></div>\\n  </div>\\n\\n  <a href=\"#\" data-id=\"{{this.id}}\"><button>Use This!</button></a>\\n\\n</div>');window.JST[\"common_share_zap_modal\"]=JST('<h1>Share This Zap Template!</h1>\\n\\n<p>Help your friends and colleagues save time by allowing them to use your Zap as a template to start with.</p>\\n<p>You\\'ll instantly be rewarded with <strong>50 FREE tasks/month</strong> for sharing!</p>\\n\\n<div class=\"services\">\\n  <div class=\"service\">\\n    <div class=\"service-icon {{readClass}}\"></div>\\n  </div>\\n  <i class=\"fa fa-caret-right caret\"></i>\\n  <div class=\"service\">\\n    <div class=\"service-icon write {{writeClass}}\"></div>\\n  </div>\\n</div>\\n<div class=\"zap-title\">{{try zapTitle \"Unnamed Zap\"}}</div>\\n\\n<div class=\"loading\">Loading fields...</div>\\n\\n<form class=\"share-it\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Share Zap Template\" class=\"big orange submit\" /> <span class=\"alt-cta\"><a class=\"no-thanks close\" title=\"Skip and close this window\">Skip this for now</a></span>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_auth_create_modal\"]=JST('<form class=\"auth\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Continue\" class=\"submit orange\" onclick=\"{{onclick}}\" /> &nbsp; <small>Having trouble connecting? Try <a href=\"/help/search/?{{{serviceHelpQueryString}}}\" target=\"_blank\">searching our help docs!</a></small>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_auth_request_modal\"]=JST('<p>This will send an email asking for permission for you to access their <strong>{{call service.getName context=service}}</strong> account. We\\'ll email you when they finish.</p>\\n<form class=\"auth\">\\n  <paramform></paramform>\\n  <input type=\"submit\" value=\"Request Access\" class=\"submit orange\" />\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_run_zap_modal\"]=JST('<h2>Manually Running Zap Now...</h2>\\n<ul>\\n  {{#each messages}}\\n  <li class=\"{{#contains this \"failed\"}}error{{/contains}}\">{{this}}</li>\\n  {{else}}\\n  <li>Running {{title}}...</li>\\n  {{/each}}\\n</ul>\\n{{#if noItemsFound}}\\n{{/if}}');window.JST[\"common_auth_error_modal\"]=JST('{{#equals type \"manual\"}}\\n<h2>We received an error while testing</h2>\\n{{else}}\\n<h2>We hit an error adding your new account</h2>\\n{{/equals}}\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  {{#equals type \"manual\"}}<li>Delete and re-add this Account</li>{{/equals}}\\n  {{#if hasUpfronts}}\\n    <li>Make sure the values you type in are correct</li>\\n    <li>Watch out for trailing-spaces on API Keys or Codes</li>\\n  {{else}}\\n    <li>Make sure you click \"Allow\" or \"Accept\" on the permission popup</li>\\n    <li>Double check your Account has the correct permissions</li>\\n  {{/if}}\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"common_menu_modal\"]=JST('<ul>\\n   <li class=\"menu-settings\"><a href=\"/app/settings\" data-nav=\"app/settings\"><i class=\"fa fa-cog\"></i>Settings</a></li>\\n   <li class=\"menu-history\"><a href=\"/app/history\" data-nav=\"app/history\"><i class=\"fa fa-clock-o\"></i>Task History</a></li>\\n   <li class=\"menu-connected-accounts\"><a href=\"/app/settings/authorizations\" data-nav=\"app/settings/authorizations\"><i class=\"fa fa-bolt\"></i>Connected Accounts</a></li>\\n   <li class=\"menu-help\"><a href=\"/help/\"><i class=\"fa fa-medkit\"></i>Support</a></li>\\n   <li class=\"menu-developer\"><a href=\"/developer\"><i class=\"fa fa-flask\"></i>Developers</a></li>\\n   <li class=\"menu-logout\"><a href=\"/logout\"><i class=\"fa fa-power-off\"></i>Logout</a></li>\\n</ul>');window.JST[\"common_select_modal\"]=JST('<ul>\\n  {{#each choices}}\\n    <li><a href=\"#\" data-key=\"{{key}}\" data-value=\"{{value}}\">{{#if value}}{{value}}{{else}}(empty){{/if}}</a></li>\\n    {{else}}\\n    <li><a href=\"#\">(No values to pick from)</a></li>\\n  {{/each}}\\n</ul>');window.JST[\"common_service_picker_modal\"]=JST('<div class=\"top\">\\n  <h1>Pick a Service</h1>\\n  <input class=\"search\" type=\"text\" placeholder=\"Search services by name...\" value=\"{{search}}\"></input>\\n  <clear></clear>\\n  <a class=\"reset\" href=\"#\">clear</a>\\n</div>\\n\\n<div class=\"container\">\\n  <div class=\"selector-bg\"><ul class=\"selector\"></ul></div>\\n  <div class=\"scroll\"></div>\\n</div>');window.JST[\"common_auth_delete_message\"]=JST('Delete {{appNameFromKey service}} Account {{#if title}}\"{{title}}\"{{/if}}');window.JST[\"common_share_thanks_modal\"]=JST('<div class=\"center\">\\n<h2>Thank you for sharing!</h2>\\n<p>Share this Zap, and for each person who clicks<br>and signs up, you <i>both</i> get <strong>100 free tasks/month</strong>!</p>\\n\\n\\n<p><a href=\"{{twitter_href}}\" data-record-click=\"share twitter\" target=\"_blank\" title=\"Share this Zap on Twitter\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/twitter.png\" alt=\"twitter share\"></a><a href=\"{{facebook_href}}\" data-record-click=\"share facebook\" target=\"_blank\" title=\"Share this Zap on Facebook\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/facebook.png\" alt=\"facebook share\"></a><a href=\"{{linkedin_href}}\" data-record-click=\"share linkedin\" target=\"_blank\" title=\"Share this Zap on LinkedIn\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/linkedin.png\" alt=\"linkedin share\"></a><a href=\"{{email_href}}\" data-record-click=\"share email\" target=\"_blank\" title=\"Share this Zap via Email\"><img class=\"share-image\" src=\"{{mediaURL}}images/frontend/email.png\" alt=\"email share\"></a></p>\\n\\n<p><input class=\"share-link\" type=\"text\" onclick=\"this.select();\" value=\"{{ recipe.share_url }}\"></p>\\n<p class=\"small\"><a href=\"{{ recipe.share_url }}\" target=\"_blank\">Open this link in a new window</a></p>\\n</div>');window.JST[\"common_login_modal\"]=JST('<form id=\"login-form\" autocomplete=\"on\" action=\"/login/?next={{path}}\" method=\"post\">\\n  <!-- the id of the form, login-form, is depended upon to sub in/out of the DOM -->\\n  <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\" />\\n  <input id=\"email\" name=\"email\" type=\"text\" class=\"account\" placeholder=\"Email\" autocomplete=\"on\" />\\n  <input id=\"password\" name=\"password\" type=\"password\" class=\"password\" placeholder=\"Password\" autocomplete=\"on\" />\\n  <input type=\"submit\" value=\"Log In\" />\\n  <span class=\"alt-cta\"><a href=\"/app/forgot\" data-nav=\"app/forgot\">Forgot your password?</a></span>\\n  <p class=\"feedback hide\"></p>\\n</form>');window.JST[\"common_upgrade_modal\"]=JST('<h2><i class=\"\"></i> You\\'ll need to upgrade to do that!</h2>\\n{{#if hasErrors}}\\n<ul class=\"because\">\\n  {{#each errors}}\\n    <li>{{this}}</li>\\n  {{/each}}\\n</ul>\\n{{/if}}\\n<a class=\"pill-button larger\" href=\"/app/settings/plans\" data-nav=\"app/settings/plans\">Click here to see which plan best suites you</a>\\n\\n{{#if hasErrors}}\\n{{else}}\\n<br/> \\n<h3>Common reasons you may need to upgrade</h3>\\n<ol>\\n  <li>You\\'re trying to enable a Zap which includes a Premium Service</li>\\n  <li>You have maxed out the number of live Zaps for your current plan</li>\\n  <li>You\\'re over your task limit for the month</li>\\n  <li>You\\'re trying to enable a Zap which includes an invite-only Developer App</li>\\n</ol>\\n{{/if}}\\n');window.JST[\"common_unpause_error_modal\"]=JST('<h2>We received an error turning this Zap on</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Double check your accounts for this Zap work (test them)</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"common_collect_email_modal\"]=JST('<h2>Sorry! This App Isn\\'t Available Yet</h2>\\n<p>New apps are added to Zapier often and we need you to tell us which ones you want most.</p>\\n<p>Add your email below and we\\'ll notify you when this app is ready to use in your Zaps. Your vote helps this app become available sooner.</p>\\n\\n<form id=\"login-form\" autocomplete=\"on\">\\n  <input id=\"email\" name=\"email\" type=\"text\" placeholder=\"Your email...\" autocomplete=\"on\" />\\n  <input type=\"submit\" value=\"Vote for this app!\" class=\"orange\" />\\n  <p class=\"feedback hide\"></p>\\n</form>\\n');window.JST[\"common_auth_row\"]=JST(' <div class=\"pill-row-wrapper\">\\n\\n  <li class=\"auth pill-row {{#if selected}}selected{{/if}}\" id=\"{{id}}\">\\n\\n    <div class=\"radio\"></div>\\n\\n    <div class=\"icon\"><div class=\"img16 {{service}}16x16\"></div></div>\\n\\n    <div class=\"text name\">\\n      {{appNameFromKey service}}\\n    </div>\\n\\n    <div class=\"text description\">\\n      {{title}}\\n    </div>\\n\\n    <div class=\"clear\"></div>\\n  </li>\\n\\n  <div class=\"test {{#equals testStatus \"success\"}}success{{/equals}} {{#equals testStatus \"error\"}}error{{/equals}}\" id=\"{{id}}\">\\n    <div class=\"text-container\"><div class=\"text\">\\n      {{#equals testStatus null}}Test this Account{{/equals}}\\n      {{#equals testStatus \"testing\"}}Testing...{{/equals}}\\n      {{#equals testStatus \"slow\"}}Still testing...{{/equals}}\\n      {{#equals testStatus \"success\"}}Account is working!{{/equals}}\\n      {{#equals testStatus \"error\"}}Account not working{{/equals}}\\n    </div></div>\\n  </div>\\n\\n  <div class=\"gear\" id=\"{{id}}\">\\n    <div class=\"text-container\"><div class=\"text\">\\n    <img src=\"{{mediaURL}}images/frontend/gear.png\"></img>\\n    </div></div>\\n  </div>\\n\\n  </div> <!-- pill-row-wrapper -->');window.JST[\"common_service_panel\"]=JST('<li class=\"panel {{#if selected}}selected{{/if}}\" id=\"{{service}}\">\\n<div class=\"img64 {{service}}64x64\"></div>\\n<span>{{name}}</span>\\n</li>');window.JST[\"common_confirm_modal\"]=JST('<form>\\n<h2>Are you sure you want to do that?</h2>\\n<h3>{{message}}</h3>\\n<br />\\n<button class=\"yes\">Yes</button>\\n<button class=\"no orange\">No</button>\\n</form>');window.JST[\"support_contact_modal\"]=JST('<div class=\"header\">\\n\t<h1>Questions? We\\'re here to help!</h1>\\n\t<div class=\"picture-small\" title=\"Micah!\"><img src=\"{{ mediaUrl }}images/team/micah-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Wade!\"><img src=\"{{ mediaUrl }}images/team/wade-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Mike!\"><img src=\"{{ mediaUrl }}images/team/mike-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Bryan!\"><img src=\"{{ mediaUrl }}images/team/bryan-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"James!\"><img src=\"{{ mediaUrl }}images/team/james-square.jpg\"></img></div>\\n    <div class=\"picture-small\" title=\"Cooksey!\"><img src=\"{{ mediaUrl }}images/team/cooksey-square.jpg\"></img></div>\\n    <div class=\"picture-small\" title=\"Danny!\"><img src=\"{{ mediaUrl }}images/team/danny-square.jpg\"></img></div>\\n\t<div class=\"picture-small\" title=\"Al!\"><img src=\"{{ mediaUrl }}images/team/al-square.jpg\"></img></div>\\n</div>\\n\\n<paramform></paramform>\\n\\n<p class=\"feedback\"></p>\\n<p class=\"small\">Average response time: <strong>2h 37m</strong> during business hours (M-F 9am-5pm PST).</p>\\n<button class=\"submit\">Send Request</button>');window.JST[\"support_definition\"]=JST('{{{ text }}}\\n\\n{{#if slug}}\\n<a class=\"read-more\" href=\"/help/{{slug}}\">Learn more...</a>\\n{{/if}}');window.JST[\"support_base\"]=JST(\"<div>{{label}}</div>\");window.JST[\"support_note\"]=JST('<div class=\"support-note{{#if first}} first{{/if}}\">\\n  {{#if title}}<h1>{{title}}</h1>{{/if}}\\n  \\n  {{{html}}}\\n\\n  {{#if isStaff}}\\n    <div style=\"text-align:right\"><small><a href=\"/admin/support/note/{{id}}/\">edit this note</a></small></div>\\n  {{/if}}\\n  {{#if first}}{{#if more}}<div class=\"more\">Not exactly what you were looking for? We have some other possibly related sections below.</div>{{/if}}{{/if}}\\n</div>');window.JST[\"pricing_plans\"]=JST('<div class=\"row\">\\n  <div class=\"container shave center\">\\n    <h1>Pricing Plans</h1>\\n\\n    <div class=\"toggle toggle-interval\">\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"month\">Monthly</a>\\n      <div class=\"toggle-container{{#if monthly}}{{else}} on{{/if}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"year\">Yearly (1 Month Free)</a>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"row border\">\\n  <div class=\"container center\">\\n    <div class=\"plans\">\\n    {{#each plans}}\\n      <div class=\"plan\" data-plan=\"true\">\\n        <h2>{{get this \"name\"}}</h2>\\n        <div class=\"price\">\\n          ${{dollars}}<span class=\"sup\">/ {{get this \"interval\"}}</span>\\n        </div>\\n        <div class=\"features\">\\n          <ul>\\n            <li class=\"important\" data-explain-highlight=\"zaps\"><strong>{{zaps}}</strong> Zaps</li>\\n            <li class=\"important\" data-explain-highlight=\"interval\">Zaps run every <strong>{{pollInterval}} {{pollIntervalTimeFrame}}</strong></li>\\n            <li class=\"important\" data-explain-highlight=\"tasks\"><strong>{{tasksMo}}</strong> Tasks/month</li>\\n            {{#hasExactly this.blacklistedServices 0}}\\n              <li class=\"important\" data-explain-highlight=\"services\">Premium Services</li>\\n            {{/hasExactly}}\\n            {{#each this.extraFeatures}}\\n              <li class=\"important\">{{{title_html}}}</li>\\n            {{/each}}\\n          </ul>\\n        </div>\\n        {{#if \"\"}}<div class=\"get\">\\n          <button class=\"larger\" data-nav=\"app/signup\">{{#equals dollars 0}}Signup For Free{{else}}Start 14 Day Trial{{/equals}}</button>\\n        </div>{{/if}}\\n        <a class=\"big orange button\" data-nav=\"app/signup\">Start FREE Trial</a>\\n      </div>\\n    {{/each}}\\n    </div>\\n\\n    <p>Need more? <a href=\"mailto:contact@zapier.com\">Send us a message</a> and we can let you in on our enterprise plans.</p>\\n\\n  </div>\\n</div>\\n\\n{{JST \"pricing_about\"}}\\n');window.JST[\"pricing_base\"]=JST('<div class=\"pricing\"></div>');window.JST[\"pricing_about\"]=JST('<div class=\"row pricing-about\">\\n  <div class=\"container\">\\n    <div class=\"column one-half\">\\n      <h2>Confused By Plan Terms?</h2>\\n      <div class=\"block\">\\n        <h3>What\\'s a Zap?</h3>\\n        <p>A Zap is a link between two services (a \"trigger\" and an \"action\"). Zaps run automatically in the background every few minutes to move and manage data on your behalf. Only live Zaps count against your limit &mdash; you can have as many paused and unfinished Zaps as you\\'d like. For example, one Zap might be \"Send me an SMS every time I get a new email\".</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <span class=\"explainable\" data-explain=\"tasks\"></span><h3>What are Tasks?</h3>\\n        <p>A Task is counted every time we move a piece of data or take some action on your behalf during a pay period or month. If you set up a filter, we don\\'t count filtered items against your Task limit.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <span class=\"explainable\" data-explain=\"services\"></span><h3>What are Services?</h3>\\n        <p>A Service is a web service or app, such as Facebook, Gmail, or SalesForce. Zapier integrates with over 193 services and counting and lets you move data between them.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>What are Premium services?</h3>\\n        <p>Some services on Zapier are marked as \\'Premium\\'. To use these services in your zaps, you\\'ll need to have a paid plan.</p>\\n      </div>\\n    </div>\\n\\n    <div class=\"column one-half\">\\n      <h2>Have Questions?</h2>\\n      <div class=\"block\">\\n        <h3>Can I change my plan later on?</h3>\\n        <p>Yes, you can upgrade or downgrade at any time. If you choose to upgrade you\\'ll pay a pro-rated amount for the rest of the month. If you choose to downgrade you\\'ll be credited on next month\\'s bill.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>What if I decide to cancel?</h3>\\n        <p>If you no longer wish to use Zapier, you can cancel at any time. You will receive a pro-rated credit with Zapier for the remainder of that month\\'s billing cycle.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>Is phone support available?</h3>\\n        <p>We offer phone support to our Business Plus plan members. You can schedule a phone call with us for personal-level support during regular business hours.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>Do I need to know how to code?</h3>\\n        <p>No! Zapier makes it easy for you to move data between your web services without being a developer. We may need you to locate information for certain accounts (things like API keys), but we\\'ll guide you through any additional steps required.</p>\\n      </div>\\n\\n      <div class=\"block\">\\n        <h3>I have more questions. Who do I ask?</h3>\\n        <p>Check out our <a href=\"/support\">support page</a>, or you can email us at <a href=\"mailto:contact@zapier.com\">contact@zapier.com</a>.</p>\\n      <div class=\"block\">\\n    </div>\\n  </div>\\n</div>\\n');window.JST[\"developer_app_trigger_settings\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Trigger Settings</h1>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_global_activation\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Request Global Activation</h1>\\n\\n<br />\\n\\n<div class=\"developer-app-audit\"></div>\\n\\n{{#unless hasErrors}}\\n   <p>Provide us a little bit of info about your organization and a test account we can use to review the service.</p>\\n   <form class=\"paramform\"></form>\\n{{/unless}}\\n\\n<clear/>\\n<div>\\n  {{#unless hasErrors}}<button class=\"save big orange\">Send Request</button>{{/unless}}\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_digest_auth_empty_section\"]=JST(\"<p>Now that we know you are using Digest Auth, define some authentication fields that will ask the user for their username and password.\\n</p>\\n\");window.JST[\"developer_app_edit_trigger\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if trigger.label}}Edit Trigger: {{trigger.label}}{{else}}Create Trigger{{/if}}</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'appearance\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">1. Name and Description</a>\\n      {{else}}\\n         1. Name and Description\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/fields\">2. Trigger Fields</a>\\n      {{else}}\\n         2. Trigger Fields\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'backend\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/backend\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/backend\">3. Where Data Comes From</a>\\n      {{else}}\\n         3. Where Data Comes From\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'sample\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if trigger.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/sample\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/sample\">4. Sample Result</a>\\n      {{else}}\\n         4. Sample Result\\n      {{/if}}\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');\nwindow.JST[\"developer_app_auth_api_key_empty_section\"]=JST(\"<p>Now that we know you are using API Keys, define an authentication field that will ask the user for their key.\\n</p>\\n\");window.JST[\"developer_app_clone_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service was cloned.</p>\\n   <button class=\"close\">Go to clone</button>\\n</div>\\n');window.JST[\"developer_app_scripting\"]=JST('<textarea>{{app.js}}</textarea>\\n<div class=\"buttons\">\\n  <button class=\"save orange\">Save</button>\\n  <button class=\"links\">Quick links</button>\\n  <button class=\"go-back\">Back</button>\\n</div>');window.JST[\"developer_app_trigger_sample_result\"]=JST('<form class=\"paramform\"></form>\\n{{#unless isNew}}\\n<div class=\"sep\"></div>\\n<div id=\"override-container\">\\n   <p>This lets you give friendly names to your sample result data, as well as hide \"unimportant\", or especially unlikely to be useful, fields.</p>\\n</div>\\n{{/unless}}\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">{{#if isNew}}Parse Sample{{else}}Save{{/if}}</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_actions_empty_section\"]=JST('<p>\\nActions send data to your API. An action creates or updates a record with data provided by a trigger.\\n</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/create\"><i class=\"fa fa-plus-circle\"></i> Add Your First Action</a></p>');window.JST[\"developer_dashboard\"]=JST('<h1>Your Apps</h1>\\n\\n<p></p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/create\" data-nav=\"{{devpath}}/app/create\"><i class=\"fa fa-plus-circle\"></i> Add New App</a></p>\\n\\n<h2>Active <small>(Useable by anyone)</small></h2>\\n{{#if activeCount}}\\n   <table class=\"table active-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any active services.</p>\\n{{/if}}\\n\\n<h2>Invite Only <small>(Useable by invited users)</small></h2>\\n{{#if inviteCount}}\\n   <table class=\"table invite-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any active services.</p>\\n{{/if}}\\n\\n<h2>Pending <small>(Being reviewed by Zapier)</small></h2>\\n{{#if pendingCount}}\\n   <table class=\"table pending-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any pending services.</p>\\n{{/if}}\\n\\n<h2>Private <small>(Only usable by you)</small></h2>\\n{{#if privateCount}}\\n   <table class=\"table private-developer-apps\">\\n      <thead>\\n        <th class=\"image-header\">Image</th>\\n        <th>Title</th>\\n        <th>Status</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n        <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{else}}\\n   <p>You do not have any private services. <a href=\"/{{devpath}}/app/create\" data-nav=\"{{devpath}}/app/create\">Make one</a>!</p>\\n{{/if}}\\n');window.JST[\"developer_app_trigger_field_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\">{{field.label}}</a></td>\\n<td><code>{{field.key}}</code></td>\\n<td>\\n   {{#if field.prefill}}\\n      <code>{{field.prefill}}</code>\\n   {{else}}\\n      <em class=\"empty\">None</em>\\n   {{/if}}\\n</td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/{{field.id}}\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_auth_field_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\">{{field.label}}</a></td>\\n<td><code>{{field.key}}</code></td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n  <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/{{field.id}}/edit\">\\n    <i class=\"fa fa-pencil\"></i> Edit\\n  </a>\\n  <a href=\"#\" class=\"delete button\">\\n     <i class=\"fa fa-times-circle\"></i>\\n     <span class=\"default\">Delete</span>\\n     <span class=\"confirm\">Really?</span>\\n  </a>\\n</td>\\n');window.JST[\"developer_app_action_fields\"]=JST('<p>Action Fields are the fields users will map data into.<p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add New Action Field</a></p>\\n\\n{{#if action.fields.length}}\\n   <table class=\"table action-fields\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Prefill</th>\\n         <th>Required</th>\\n         <th class=\"sort-column\">Sort</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{/if}}\\n\\n<div>\\n   <button class=\"save big orange\">Next</button>&nbsp;\\n   <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n   <span class=\"sort-errors red\"></span> <!-- sort is the only thing that saves here -->\\n</div>\\n');window.JST[\"developer_app_table_row\"]=JST('<td class=\"image-place\"><img style=\"width:32px;height:32px\" src=\"{{#if app.cropped_image_urls}}{{app.cropped_image_urls.32x32}}{{else}}{{ z.cfg.mediaURL }}images/frontend/placeholder/32x32.png{{/if}}\" alt=\"{{app.title}}\"/></td>\\n<td><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a></td>\\n<td>{{prettyStatus}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/\" data-nav=\"{{devpath}}/app/{{app.id}}/\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_confirm_invite_modal\"]=JST('<form>\\n  <h2>Are you sure you want to do that?</h2>\\n  <p>Enabling Invite-Only mode means you will no longer be able to make changes to your service.</p>\\n  <p>If you are trying to test your service, it is available to you right now if you go <a href=\"/app/editor\" target=\"_blank\">make a zap</a>.</p>\\n  <br />\\n  <button class=\"yes\">Enable</button>&nbsp; <a href=\"#\" class=\"no orange\">Close</a>\\n</form>\\n');window.JST[\"developer_app_actions\"]=JST('<h2>Actions <small>(Zapier sending data out)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Important</th>\\n         <th>Visible</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/create\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/create\"><i class=\"fa fa-plus-circle\"></i> Add New Action</a></p>\\n</div>\\n');window.JST[\"developer_app_auth_empty_section\"]=JST('<p>Defining how to authenticate is the first step in building your service.</p>\\n\\n<p><button data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/scheme\">Get Started <i class=\"fa fa-chevron-right\"></i></button></p>\\n');window.JST[\"developer_app_trigger_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">{{trigger.label}}</a></td>\\n<td><code>{{trigger.key}}</code></td>\\n<td>{{prettySource}}</td>\\n<td>{{#if trigger.important}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td>{{#if trigger.hide}}<i class=\"fa fa-ban red\"></i>{{else}}<i class=\"fa fa-check green\"></i>{{/if}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/edit/appearance\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_migrate_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service has been migrated.</p>\\n   <button class=\"close\">Back to Service</button>\\n</div>\\n');window.JST[\"developer_app_revert_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service is now private. Make any edits you need to and then request global activation again.</p>\\n   <button class=\"close\">Reload</button>\\n</div>\\n');window.JST[\"developer_app_auth\"]=JST('<h2>Authentication <small>(Values needed to confirm identity)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n        <th>Label</th>\\n        <th>Key</th>\\n        <th>Required</th>\\n        <th class=\"sort-column\">Sort</th>\\n        <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add Authentication Field</a> <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/settings\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/settings\"><i class=\"fa fa-cog\"></i> Manage Authentication Settings</a> <a class=\"button save-sortable orange\" style=\"display:none\">Save Sorting</a> <span class=\"sort-errors red\"></span> </p>\\n\\n   {{#if warnings.length}}\\n      <div class=\"warning\">\\n         <p>Things to do for this section:</p>\\n         <ul>\\n         {{#each warnings}}\\n            <li class=\"alert\">{{this}}</li>\\n         {{/each}}\\n         </ul>\\n      </div>\\n   {{/if}}\\n</div>\\n');window.JST[\"developer_app_stats\"]=JST('<h2>Statistics <small>(Site wide counts of users)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n        <th>Type</th>\\n        <th>Label</th>\\n        <th>Live</th>\\n        <th>Paused</th>\\n        <th>Total</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n</div>');window.JST[\"developer_app_trigger_fields\"]=JST('<p>Trigger fields define the pre-requirements needed in order to make a request. Theses are things like parent objects or search strings.<p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add New Trigger Field</a></p>\\n\\n{{#if trigger.fields.length}}\\n   <table class=\"table trigger-fields\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Prefill</th>\\n         <th>Required</th>\\n         <th class=\"sort-column\">Sort</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- render here! -->\\n      </tbody>\\n   </table>\\n{{/if}}\\n\\n<clear/>\\n<div>\\n   <button class=\"save big orange\">Next</button>&nbsp;\\n   <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n   <span class=\"sort-errors red\"></span> <!-- sort is the only thing that saves here -->\\n</div>\\n');window.JST[\"developer_app_edit_trigger_form\"]=JST('<form class=\"paramform\"></form>\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save &amp; Next</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_settings\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Authentication Settings</h1>\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_confirm_revert_modal\"]=JST('<form>\\n<h2>Are you sure you want to do that?</h2>\\n<h3>Reverting your service back to being private means you will have to make a new request for global activation.</h3>\\n<h3>If you realize your service is not ready to be made global, you should revert so you can continue working on it.</h3>\\n<br />\\n<button class=\"yes\">Revert to Private</button>\\n<button class=\"no orange\">Close</button>\\n</form>\\n');window.JST[\"developer_app_auth_editor_fields\"]=JST('<p>This is our best guess at what fields you will need. You may customize them as needed.</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/auth/edit/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/fields/create\"><i class=\"fa fa-plus-circle\"></i> Add Another Authentication Field</a></p>\\n\\n\\n<table class=\"table\">\\n   <thead>\\n     <th>Label</th>\\n     <th>Key</th>\\n     <th>Required</th>\\n     <th class=\"sort-column\">Sort</th>\\n     <th class=\"action-header\">Actions</th>\\n   </thead>\\n   <tbody>\\n     <!-- render here -->\\n   </tbody>\\n</table>\\n\\n<div>\\n  <button class=\"save big orange\">Next</button>&nbsp;\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_action_table_row\"]=JST('<td><a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">{{action.label}}</a></td>\\n<td><code>{{action.key}}</code></td>\\n<td>{{#if trigger.important}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td>{{#if action.hide}}<i class=\"fa fa-ban red\"></i>{{else}}<i class=\"fa fa-check green\"></i>{{/if}}</td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_trigger_sample_override_form\"]=JST('Field Key: <code>{{key}}</code>\\n<form class=\"paramform\"></form>\\n<div class=\"sep\"></div>\\n');window.JST[\"developer_app_edit_action_form\"]=JST('<form class=\"paramform\"></form>\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save {{#notequals section \\'backend\\'}}&amp; Next{{/notequals}}</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_auth_empty_fields\"]=JST('<p>Now go make some fields!</p>\\n<p>TODO: bcooksey Write some real instructions</p>\\n<a href=\"/{{devpath}}/app/{{app.id}}/auth/fields/create\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/fields/create\"><i class=\"fa fa-plus-circle\"></i>Add Field</a>\\n<div>\\n  <button class=\"save big orange\">Next</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_action_field_table_row\"]=JST('<td>\\n   <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\">{{field.label}}</a>\\n</td>\\n<td><code>{{field.key}}</code></td>\\n<td>\\n   {{#if field.prefill}}\\n      <code>{{field.prefill}}</code>\\n   {{else}}\\n      <em class=\"empty\">None</em>\\n   {{/if}}\\n</td>\\n<td>{{#if field.required}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-ban red\"></i>{{/if}}</td>\\n<td class=\"sort-column\"><button class=\"move-up button\"><i class=\"fa fa-arrow-up\"></i></button> <button class=\"move-down button\"><i class=\"fa fa-arrow-down\"></i></button></td>\\n<td>\\n   <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields/{{field.id}}\">\\n     <i class=\"fa fa-pencil\"></i> Edit\\n   </a>\\n   <a href=\"#\" class=\"delete button\">\\n      <i class=\"fa fa-times-circle\"></i>\\n      <span class=\"default\">Delete</span>\\n      <span class=\"confirm\">Really?</span>\\n   </a>\\n</td>\\n');window.JST[\"developer_app_invite\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Email Invites</h1>\\n<br/>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Send</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_scripting_menu\"]=JST('<ul class=\"scripting-menu\">\\n  <li><a class=\"logs\" href=\"/{{devpath}}/app/{{app.id}}/requests\" data-nav=\"{{devpath}}/app/{{app.id}}/requests\">\\n    <i class=\"fa fa-bars\"></i> Request Logs\\n  </a></li>\\n  <li><a href=\"/developer/scripting/\" class=\"docs\" target=\"_new\">\\n    <i class=\"fa fa-question-circle\"></i> Scripting Docs\\n  </a></li>\\n</ul>');window.JST[\"developer_app_confirm_global_modal\"]=JST('<form>\\n  <h2>Are you sure you want to do that?</h2>\\n  <p>Requesting global activation means you will no longer be able to make changes.</p>\\n  <p>If you are trying to test your service, it is available to you right now if you go <a href=\"/app/editor\" target=\"_blank\">make a zap</a>.</p>\\n  <br />\\n  <button class=\"yes\">Continue to request form</button>&nbsp; <a href=\"#\" class=\"no orange\">Close</a>\\n</form>\\n');window.JST[\"developer_app_auth_choose_scheme\"]=JST('<p>Which authentication scheme does your your API use:</p>\\n<p>\\n   <button id=\"use-basic-auth\">Basic Auth</button>\\n   <button id=\"use-api-key\">API Keys</button>\\n   <button id=\"use-oauthv2\">OAuth v2</button>\\n   <button id=\"use-digest-auth\">Digest Auth</button>\\n</p>\\n\\n<div id=\"api-key-sub-type\" style=\"display: none;\">\\n   <p>Does the API Key go in the HTTP Headers or Querystring?</p>\\n   <p>\\n      <button value=\"3\">Headers</button>\\n      <button value=\"2\">Querystring</button>\\n   </p>\\n</div>\\n<div id=\"oauthv2-sub-type\" style=\"display: none;\">\\n   <p>Will Zapier need to refresh the access token on a regular basis?</p>\\n   <p>\\n      <button value=\"6\">Yes, setup refresh</button>\\n      <button value=\"5\">No, original will do</button>\\n   </p>\\n</div>\\n\\n<br/>\\n\\n<div>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_triggers_empty_section\"]=JST('<p>\\nTriggers read data in from your API. A trigger focuses on a particular event that happens, say a new Contact or Order being created, and provides the relavant data so that users can take action on that event (like get an email notification with details about the newly created contact/order). \\n</p>\\n\\n<p>You will need one <strong>test trigger</strong> so we can test the credentials users provide in the authentication fields. Usually this is a <code>/ping</code> or <code>/user</code> endpoint.</p>\\n\\n<p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/create/test\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/create/test\"><i class=\"fa fa-plus-circle\"></i> Add Your First Test Trigger</a></p>');window.JST[\"developer_app_edit_auth_field\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if field.label}}Edit Auth Field: {{field.label}}{{else}}Create Auth Field{{/if}}</h1>\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}{{#if isWizard}}/auth/edit/fields{{/if}}\" data-nav=\"{{devpath}}/app/{{app.id}}{{#if isWizard}}/auth/edit/fields{{/if}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_auth_editor\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Setup Authentication</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'scheme\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/scheme\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/scheme\">1. Choose Authentication Scheme</a>\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/fields\">2. Create Auth Fields</a>\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'mapping\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      <a href=\"/{{devpath}}/app/{{app.id}}/auth/edit/mapping\" data-nav=\"{{devpath}}/app/{{app.id}}/auth/edit/mapping\">3. Map Fields to Request Parameters</a>\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');window.JST[\"developer_app_requests\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Request Log</h1>\\n<br />\\n\\n<div id=\"request-log-controls\">\\n   <button>Refresh</button>\\n</div>\\n\\n<div id=\"request-log\"></div>\\n');window.JST[\"developer_app_meta\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; {{#if app.title}}<a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;{{/if}}</span> {{#if app.title}}Edit General Info{{else}}Create Service{{/if}}</h1>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Save</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/{{#if app.id}}app/{{app.id}}{{/if}}\" data-nav=\"{{devpath}}/{{#if app.id}}app/{{app.id}}{{/if}}\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_audit\"]=JST('{{#hasAtLeastOne errors}}\\n<p>Looks like your service has some errors. Look over the list below before you submit your service. They are automatically generated, so if you see something odd or unfixable, <a href=\"mailto:contact@zapier.com\">just contact us</a>!</p>\\n\\n<div id=\"app-errors\">\\n   <h3>Errors</h3>\\n   <ul>\\n   {{#each errors}}\\n      <li>\\n         <strong>{{name}}</strong>\\n         <ul>\\n         {{#each errors}}\\n            <li>{{message}}</li>\\n         {{/each}}\\n         </ul> \\n      </li>\\n   {{/each}}\\n   </ul>\\n</div>\\n{{/hasAtLeastOne}}\\n\\n{{#hasAtLeastOne warnings}}\\n<div id=\"app-warnings\">\\n   <h3>Warnings</h3>\\n   <ul>\\n   {{#each warnings}}\\n      <li>\\n         <strong>{{name}}</strong>\\n         <ul>\\n         {{#each warnings}}\\n            <li>{{message}}</li>\\n         {{/each}}\\n         </ul> \\n      </li>\\n   {{/each}}\\n   </ul>\\n</div>\\n{{/hasAtLeastOne}}\\n');window.JST[\"developer_app_triggers\"]=JST('<h2>Triggers <small>(Bringing data into Zapier)</small></h2>\\n\\n<div class=\"section-content\">\\n   <table class=\"table\">\\n      <thead>\\n         <th>Label</th>\\n         <th>Key</th>\\n         <th>Source</th>\\n         <th>Important</th>\\n         <th>Visible</th>\\n         <th class=\"action-header\">Actions</th>\\n      </thead>\\n      <tbody>\\n         <!-- rendered here -->\\n      </tbody>\\n   </table>\\n\\n   <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/create\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/create\"><i class=\"fa fa-plus-circle\"></i> Add New Trigger</a> <a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/triggers/settings\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/settings\"><i class=\"fa fa-cog\"></i> Manage Trigger Settings</a></p>\\n\\n   {{#if app.warnings.test_trigger}}\\n      <div class=\"warning\">\\n         <p>Things to do for this section:</p>\\n         <ul>\\n            <li class=\"alert\">{{app.warnings.test_trigger}}</li>\\n         </ul>\\n      </div>\\n   {{/if}}\\n</div>');window.JST[\"developer_app_auth_basic_auth_empty_section\"]=JST(\"<p>Now that we know you are using Basic Auth, define some authentication fields that will ask the user for their username and password.\\n</p>\\n\");window.JST[\"developer_app_auth_editor_form\"]=JST('<form class=\"paramform\"></form>\\n<div>\\n  <button class=\"save big orange\">Save</button>\\n  <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Cancel</a>\\n</div>\\n');window.JST[\"developer_app_edit_action_field\"]=JST('<h1>{{#if field.label}}Edit Action Field: {{field.label}}{{else}}Create Action Field{{/if}}</h1>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Done</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/fields\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_migrate\"]=JST('<h1>Service Migration</h1>\\n\\n<div class=\"developer-app-audit\"></div>\\n\\n{{#unless hasErrors}}\\n   <p>TODO: bcooksey TBW</p>\\n{{/unless}}\\n\\n<clear/>\\n<div>\\n  {{#unless hasErrors}}<button class=\"save big orange\">Migrate service</button>{{/unless}}\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}/migrate\" data-nav=\"{{devpath}}/app/{{app.id}}/migrate\">Back</a></span>\\n</div>\\n');window.JST[\"developer_app_edit_trigger_field\"]=JST('<h1>{{#if field.label}}Edit Trigger Field: {{field.label}}{{else}}Create Trigger Field{{/if}}</h1>\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Done</button>&nbsp;\\n  <span><a href=\"/{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/triggers/{{trigger.id}}/fields\">cancel</a></span>\\n</div>\\n');window.JST[\"developer_app_global_activation_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. We\\'ll be in touch soon.</p>\\n   <button class=\"close\">Back to Service</button>\\n</div>\\n');window.JST[\"developer_app_invite_activation_success_modal\"]=JST('<div class=\"center\">\\n   <p>Success. Your service is now Invite-only.</p>\\n   <button class=\"close\">Reload</button>\\n</div>\\n');window.JST[\"developer_app_edit_action\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> {{#if action.label}}Edit Action: {{action.label}}{{else}}Create Action{{/if}}</h1>\\n\\n<h3 class=\"breadcrumb-nav\">\\n   <span {{#equals section \\'appearance\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/appearance\">1. Name and Description</a>\\n      {{else}}\\n         1. Name and Description\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'fields\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/fields\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/fields\">2. Action Fields</a>\\n      {{else}}\\n         2. Action Fields\\n      {{/if}}\\n   </span>\\n   <i class=\"fa fa-long-arrow-right\"></i>\\n   <span {{#equals section \\'backend\\'}}class=\"active-breadcrumb\"{{/equals}}>\\n      {{#if action.label}}\\n         <a href=\"/{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/backend\" data-nav=\"{{devpath}}/app/{{app.id}}/actions/{{action.id}}/edit/backend\">3. Where To Send Data</a>\\n      {{else}}\\n         3. Where To Send Data\\n      {{/if}}\\n   </span>\\n</h3>\\n\\n<br />\\n\\n<div id=\"editor-section\"></div>\\n');window.JST[\"developer_app\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656;</span> {{app.title}}</h1>\\n\\n<div class=\"column two-thirds\" style=\"padding-left:0;\"> <!-- uuugh inline styles. unfortunately doing row/column in all developer views would be a *lot* -->\\n  <div class=\"service-feature\">\\n    <div class=\"service-icon-large\">\\n      <img src=\"{{#if app.cropped_image_urls}}{{app.cropped_image_urls.64x64}}{{else}}{{ z.cfg.mediaURL }}images/frontend/placeholder/64x64.png{{/if}}\" alt=\"GitHub integration logo\">\\n    </div>\\n    <div class=\"description\">\\n      <p>{{app.description}}</p>\\n      <p><a class=\"button\" {{#if isEditable}}href=\"/{{devpath}}/app/{{app.id}}/meta\" data-nav=\"{{devpath}}/app/{{app.id}}/meta\"{{else}}class=\"disabled\"{{/if}}><i class=\"fa fa-cog\"></i> Edit Title, Image or Description</a></p>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"column one-third side-col\" style=\"padding-right:0;\"> <!-- uuugh inline styles?!? -->\\n  <div class=\"widget\">\\n    <h3>Status</h3>\\n    <p><strong>{{#equals app.status 0}}Private{{/equals}}{{#equals app.status 1}}Under Review{{/equals}}{{#equals app.status 2}}Invite Only{{/equals}}{{#equals app.status 3}}Global{{/equals}}</strong> - <em>{{#equals app.status 0}}private apps can be used just like any app on Zapier, except only you can see them{{/equals}}{{#equals app.status 1}}we\\'ll get back to your as soon as possible!{{/equals}}{{#equals app.status 2}}private apps can be used just like any app on Zapier except only those who have the link or you invite can see them{{/equals}}{{#equals app.status 3}}global apps are apps that anyone on Zapier can see and use{{/equals}}.</em></p>\\n  </div>\\n</div>\\n\\n<clear/>\\n<br/>\\n\\n<div class=\"all-wrapper\">\\n  <!-- stats/auths/triggers/actions rendered here! -->\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Scripting API <small>(Modify Zapier\\'s default behavior)</small></h2>\\n   <div class=\"section-content\">\\n      {{#if isActive}}\\n         <p>Scripting API is disabled for global or invite only services. <a href=\"#\">Read the docs.</a></p>\\n      {{else}}\\n         <p>You can write javascript code that can modify data that comes in and goes out of our system. <a href=\"#\">Read the docs.</a>\\n         </p>\\n      {{/if}}\\n      {{#if isEditable}}\\n         <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/scripting\" data-nav=\"{{devpath}}/app/{{app.id}}/scripting\"><i class=\"fa fa-code\"></i> Edit Code</a></p>\\n      {{else}}\\n         <button class=\"disabled\"><i class=\"fa fa-code\"></i> Edit Code</button>\\n      {{/if}}\\n   </div>\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Request Log <small>(A stream of all outbound and inbound HTTP)</small></h2>\\n   <div class=\"section-content\">\\n      {{#if isActive}}\\n         <p>Logs are disabled for active services. <a href=\"#logged-requests\">Read the docs.</a></p>\\n      {{else}}\\n         <p>A list of all recent development HTTP requests. <a href=\"#logged-requests\">Read the docs.</a></p>\\n      {{/if}}\\n      {{#if isEditable}}\\n         <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/requests\" data-nav=\"{{devpath}}/app/{{app.id}}/requests\"><i class=\"fa fa-clock-o\"></i> See HTTP Log</a></p>\\n      {{else}}\\n         <button class=\"disabled\"><i class=\"fa fa-clock-o\"></i> See HTTP Log</button>\\n      {{/if}}\\n   </div>\\n</div>\\n\\n<div class=\"section\">\\n   <h2>Status <small>(Who can use your service)</small><a id=\"status-section\"></a></h2>\\n   <div class=\"section-content\">\\n      {{#equals app.status 0}}\\n      <p>Your service is currently private, which mefsee logans only you can use it.</p>\\n      <p>To allow others access, you need to do one of the following:\\n        <ol>\\n           <li><a id=\"make-global\" href=\"#\">Request global activation</a></li>\\n           <li><a id=\"enable-invite\" href=\"#\">Enable invite-only activation</a></li>\\n           <li><a href=\"/{{devpath}}/app/{{app.id}}/migrate\" data-nav=\"{{devpath}}/app/{{app.id}}/migrate\">Migrate and replace an existing Service</a></li>\\n        </ol>\\n      </p>\\n      If at any time you want to make a copy of your service, you can <a id=\"clone-app\" href=\"#\">clone your service</a>.\\n      {{/equals}}\\n\\n      {{#equals app.status 1}}\\n         <p>Your service is waiting to be reviewed by Zapier. At this point, you can rest easy and wait for us to schedule a demo call with you. You can also get a head start thinking about your service\\'s launch by checking out these articles:</p>\\n         <ol>\\n             <li><a href=\"/help/partner-pre-launch-checklist/\">Five Prep Steps for Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-checklist/\">Three Ingredients of a Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-zapier/\">How Zapier Promotes the Launch</a></li>\\n         </ol>\\n         <p>If you need to make a change, you can <a id=\"revert-app\" href=\"#\">revert back to private</a>. You\\'ll make your changes, then submit for global activation again.</p>\\n      {{/equals}}\\n\\n      {{#equals app.status 2}}\\n         <p>Your service is invite-only. At this point, you can invite users to to use your service. Only people you have explicitly invited will be able to use your service on Zapier.</p>\\n         <p><a class=\"button\" href=\"/{{devpath}}/app/{{app.id}}/invite\" data-nav=\"{{devpath}}/app/{{app.id}}/invite\"><i class=\"fa fa-share\"></i> Invite User via Bulk Email</a></p>\\n         <p>You can also invite users by sharing this link:</p>\\n         <p><input type=\"text\" onclick=\"this.select();\" value=\"{{app.share_url}}\" style=\"width:570px\"></p>\\n         <p>To make changes to your service, you need to <a id=\"clone-app\" href=\"#\">clone this service</a> and then perform a migration. <a href=\"#\">Read the docs</a>.</p>\\n      {{/equals}}\\n\\n      {{#equals app.status 3}}\\n         <p>Your service is global, which means anyone can use it. If your service has not had its official Zapier launch, now is a good time to work on conent for the launch. Here are a few articles that explain the process:</p>\\n         <ol>\\n             <li><a href=\"/help/partner-pre-launch-checklist/\">Five Prep Steps for Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-checklist/\">Three Ingredients of a Launch</a></li>\\n             <li><a href=\"/help/partner-launch-day-zapier/\">How Zapier Promotes the Launch</a></li>\\n         </ol>\\n         <p>To make changes to your service, you need to <a id=\"clone-app\" href=\"#\">clone this service</a> and then perform a migration. <a href=\"#\">Read the docs</a>.</p>\\n      {{/equals}}\\n   </div>\\n</div>\\n');\nwindow.JST[\"developer_base\"]=JST('<div class=\"row developer\">\\n  <div class=\"container developer-content\">\\n      \\n  </div>\\n</div>\\n');window.JST[\"developer_app_invite_success_modal\"]=JST('<div class=\"center\">\\n   <p>{{numSent}} I{{#plural count=numSent}}nvite{{/plural}} Sent.</p>\\n   <button class=\"close\">Close</button>\\n</div>\\n');window.JST[\"developer_app_stats_table_row\"]=JST(\"<td>{{stat.Type}}</td>\\n<td>{{stat.Label}}</td>\\n<td>{{stat.Live}}</td>\\n<td>{{stat.Paused}}</td>\\n<td>{{stat.Total}}</td>\");window.JST[\"developer_app_migrate_choose_target\"]=JST('<h1><span class=\"bread\"><a href=\"/{{devpath}}/\" data-nav=\"{{devpath}}/\">Apps</a> &#9656; <a href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">{{app.title}}</a> &#9656;</span> Service Migration</h1>\\n\\n<p>TODO: bcooksey TBW. Something about what a migration is and what to expect.</p>\\n\\n<br />\\n\\n<form class=\"paramform\"></form>\\n\\n<clear/>\\n<div>\\n  <button class=\"save big orange\">Next</button>&nbsp;\\n  <span><a class=\"go-back\" href=\"/{{devpath}}/app/{{app.id}}\" data-nav=\"{{devpath}}/app/{{app.id}}\">Back</a></span>\\n</div>\\n');window.JST[\"editor_userfill_modal\"]=JST('{{#if missing}}\\n  <div class=\"empty\">\\n    <button class=\"missing light smaller\"><i class=\"fa fa-exclamation-circle\"></i>\\n      We\\'re using <strong>fake</strong> data. Load real data here.\\n    </button>\\n  </div>\\n{{else}}\\n  {{#hasAtLeastOne choices}}\\n  <div class=\"search\">\\n    <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n  </div>\\n  {{/hasAtLeastOne}}\\n{{/if}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match...</div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n    {{#if this.type}}data-type=\"{{this.type}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">{{#ellipsis 50}}{{this.display}}{{/ellipsis}} <span class=\"sample\">{{this.val}}</span></a>\\n  </li>\\n  {{/each}}\\n</ul>');window.JST[\"editor_selectfill_modal\"]=JST('<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match <strong>{{search}}</strong></div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">\\n      {{#if ../fancychoices}}\\n        {{#ellipsis 30}}{{this.display}}{{/ellipsis}}\\n      {{else}}\\n        {{this.display}}\\n      {{/if}}\\n      {{#unless ../hideRawValue }}<span class=\"sample\">{{this.val}}</span>{{/unless}}\\n    </a>\\n  </li>\\n  {{/each}}\\n\\n  {{#if fancychoices}}\\n    <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n    <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value<span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n    <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/if}}\\n</ul>\\n');window.JST[\"editor_hook_error_modal\"]=JST('<h2>We received an error connecting to {{appNameFromKey key}}</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Make sure you have followed all on-screen directions, in order</li>\\n  <li>Test your {{serivce}} Account again</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"editor_service_action\"]=JST('{{#unless isPartner}}<p class=\"big\">Need inspiration? <a href=\"/app/explore\" data-nav=\"app/explore\">Explore existing Zap templates to get you started.</a></p>{{/unless}}\\n\\n<div class=\"picker\">\\n\\n  <div class=\"trigger\">\\n    <select id=\"trigger-service\" data-placeholder=\"Choose a Trigger service...\">\\n      <option></option> <!-- placeholder -->\\n      {{#each readServices}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n    <div class=\"picker actions\">\\n    <div class=\"trigger\">\\n      <select id=\"trigger\" data-placeholder=\"Choose a Trigger...\">\\n        <option></option> <!-- placeholder -->\\n        {{#each readActions}}\\n        <option value=\"{{key}}\" data-help=\"{{help_text_html}}\">{{label}}</option>\\n        {{/each}}\\n        {{#if showTriggerExpand}}<option value=\"showAll\">Show all triggers</option>{{/if}}\\n      </select>\\n      <img class=\"helper\" src=\"{{mediaURL}}images/arrows/trigger.png\" />\\n    </div>\\n    </div>\\n\\n  </div>\\n\\n  <div class=\"arrow\"><i class=\"fa fa-caret-right\"></i></div>\\n\\n  <div class=\"action\">\\n    <select id=\"action-service\" data-placeholder=\"Choose an Action service...\">\\n      <option></option> <!-- placeholder -->\\n      {{#each writeServices}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n\\n    <div class=\"actions\">\\n      <select id=\"action\" data-placeholder=\"Choose an Action...\">\\n        <option></option> <!-- placeholder -->\\n        {{#each writeActions}}\\n        <option value=\"{{key}}\" data-help=\"{{help_text_html}}\">{{label}}</option>\\n        {{/each}}\\n        {{#if showActionExpand}}<option value=\"showAll\">Show all actions</option>{{/if}}\\n      </select>\\n      <img class=\"helper\" src=\"{{mediaURL}}images/arrows/action.png\" />\\n    </div>\\n  </div>\\n\\n</div>\\n\\n{{#if flow}}\\n<button class=\"continue\">Continue</button>\\n\\n<span class=\"partner-feedback hide\">To create a Zap without {{partnerService}} in it, you\\'ll need to go to <a target=\"_new\" href=\"https://zapier.com/\">Zapier.com</a></span>\\n{{/if}}');window.JST[\"editor_enable\"]=JST('{{#if isHook}}\\n  <p class=\"big\">This Zap is instant. It will trigger immediately when we receive a new {{appNameFromKey readService.id}} {{call readService.getActionName read.action \"read\" \"true\" context=readService}}.</p>\\n{{else}}\\n  <p class=\"big\">This Zap will automatically check for new {{appNameFromKey readService.id}} {{#plural}}{{call readService.getActionName read.action \"read\" \"true\" context=readService}}{{/plural}} every <i class=\"fa fa-clock-o\"></i> {{polling}} minutes.</p>\\n{{/if}}\\n\\n<div class=\"paramform\">\\n  <div class=\"field\">\\n    <div class=\"label\">Name this Zap:</div>\\n    <div class=\"input\">\\n      <input class=\"xlarge title\" type=\"text\" name=\"title\" placeholder=\"Name this Zap...\" value=\"{{#unless flow}}{{title}}{{/unless}}\" />\\n    </div>\\n  </div>\\n</div>\\n\\n{{#hasAtLeastOne errors}}\\n  <h3>Please fix the following errors before enabling:</h3>\\n  <ul>\\n  {{#each ../errors}}<li class=\"error\">{{this}}</li>{{/each}}\\n  </ul>\\n{{/hasAtLeastOne}}\\n\\n<p><button class=\"enable big orange {{#hasAtLeastOne errors}}disabled{{/hasAtLeastOne}}\">Turn Zap on</button></p>\\n');window.JST[\"editor_custom_filter_row\"]=JST('<div class=\"index\" href=\"rule-{{index}}\">{{index}}</div>\\n\\n<paramform></paramform>\\n\\n<div class=\"stack add-or-remove\">\\n   <div class=\"add\" data-group=\"{{group}}\"></div>\\n   <div class=\"remove\"></div>\\n</div>\\n\\n<div class=\"stack\"></div>\\n\\n<div class=\"stack label\">\\n   <span class=\"and\">AND</span>\\n</div>');window.JST[\"editor_steps\"]=JST('<!-- none_visible title_visible all_visisble -->\\n\\n<step class=\"{{services-actions}}\" data-id=\"services-actions\">\\n  <div class=\"row\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"1\" disabled=\"disabled\"></input></span>\\n      <h2>Choose a trigger and action</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{trigger-auth}}\" data-id=\"trigger-auth\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"2\" disabled=\"disabled\"></input></span>\\n      <h2>Select a <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} account {{#equals read.selected_api write.selected_api}}(Trigger){{/equals}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{action-auth}}\" data-id=\"action-auth\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"3\" disabled=\"disabled\"></input></span>\\n      <h2>Select a <i class=\"img32 {{write.selected_api}}32x32\"></i> {{appNameFromKey write.selected_api}} account {{#equals read.selected_api write.selected_api}}(Action){{/equals}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{filters}}\" data-id=\"filters\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"4\" disabled=\"disabled\"></input></span>\\n      <h2>Filter <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} triggers</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{map}}\" data-id=\"map\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"5\" disabled=\"disabled\"></input></span>\\n      <h2>Match up <i class=\"img32 {{read.selected_api}}32x32\"></i> {{appNameFromKey read.selected_api}} {{#if readAction}}{{readAction}}{{/if}} to <i class=\"img32 {{write.selected_api}}32x32\"></i> {{appNameFromKey write.selected_api}} {{#if writeAction}}{{writeAction}}{{/if}}</h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{test}}\" data-id=\"test\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"6\" disabled=\"disabled\"></input></span>\\n      <h2>Test this Zap</i></h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n<step class=\"{{enable}}\" data-id=\"enable\">\\n  <div class=\"row border-top\">\\n    <div class=\"container\">\\n      <span class=\"dial-container\"><input class=\"dial\" value=\"7\" disabled=\"disabled\"></input></span>\\n      <h2>Name and turn this Zap on</i></h2>\\n      <content></content>\\n    </div>\\n  </div>\\n</step>\\n\\n{{#unless flow}}{{#if ../read.paused}}\\n<div class=\"row paused\">\\n    <div class=\"container\">\\n      This Zap is off while you edit.\\n      {{#if ../hasErrors}}\\n        <i>Complete the steps above to turn it back on.</i>\\n      {{else}}\\n        <a href=\"#\" class=\"unpause button\">Turn it back on!</a>\\n      {{/if}}\\n  </div>\\n</div>\\n{{/if}}{{/unless}}');window.JST[\"editor_missing_data_modal\"]=JST('{{#initConnection}}\\n  <div class=\"loading\">Connecting to {{appNameFromKey read.selected_api}}...</div>\\n{{else}}\\n\\n  <div class=\"title\">\\n    <h2><i class=\"fa fa-exclamation-circle\"></i> We couldn\\'t get any samples from {{appNameFromKey read.selected_api}}</h2>\\n  </div>\\n\\n  <ol>\\n    {{#and isHook notSubHook}}\\n    <li class=\"{{#less step 1}}fade{{/less}} {{#equals step 1}}active{{/equals}}\">\\n      {{{call service.getWebhookDirections action \"read\" context=service}}}\\n\\n      <div class=\"label\">Make sure this is your Webhook URL:</div>\\n      <div class=\"table-wrapper fill\">\\n        <div class=\"table-cell column\">\\n          <input class=\"webhook-url\" type=\"text\" value=\"{{call service.getWebhookURL action \"read\" readModel context=service}}\" data-id=\"webhook-url\" readonly/>\\n        </div>\\n        <div class=\"table-cell vcenter\">\\n          <button class=\"copy-button\" data-clipboard-text=\"{{call service.getWebhookURL action \"read\" readModel context=service}}\">Copy to clipboard</button>\\n        </div>\\n      </div>\\n\\n      <button data-step=\"1\" class=\"continue {{#greater step 1}}disabled{{/greater}}\">Ok, I did this</button>\\n    </li>\\n    {{/and}}\\n\\n    <li class=\"{{#less step 2}}fade{{/less}} {{#equals step 2}}active{{/equals}}\">\\n      <p>{{#copyOverride service read.action \"read\" \"no_sample_dirs\"}}\\n      Go create a <em><strong>brand new</strong></em> {{call service.getActionName read.action \"read\" \"true\" context=service}} inside {{appNameFromKey read.selected_api}}, then come back to Zapier.\\n      {{/copyOverride}}</p>\\n\\n      {{#hasAtLeastOne filters}}\\n      <table class=\"fields-table table-bordered\">\\n        {{#each filters}}\\n        <tr>\\n          <td class=\"key\">{{this.k}}:</td>\\n          <td class=\"value\">{{this.v}}</td>\\n        </tr>\\n        {{/each}}\\n      </table>\\n      {{/hasAtLeastOne}}\\n\\n      <button data-step=\"2\" class=\"continue load {{#greater step 2}}disabled{{/greater}}\">Ok, I did this</button>\\n    </li>\\n\\n    <li class=\"{{#less step 3}}fade{{/less}} {{#equals step 3}}active{{/equals}}\">\\n\\n      {{#if isHook}}\\n      <p>Zapier is now waiting for your changes to make their way back to our server.</p>\\n      <span class=\"loading loading-samples\">Waiting anxiously...</span>\\n      <span class=\"found-samples success\"><i class=\"fa fa-check green\"></i>&nbsp;We found your changes!</span>\\n      {{else}}\\n      <p>Have Zapier get the {{call service.getActionName read.action \"read\" \"true\" context=service}} you just created.</p>\\n      <button data-step=\"3\" class=\"continue {{#greater step 3}}disabled{{/greater}}\">Get {{#plural}}{{call service.getActionName read.action \"read\" \"true\" context=service}}{{/plural}}</button>\\n      <span class=\"no-samples\"><i class=\"fa fa-exclamation-circle red\"></i> We couldn\\'t find any! Please try again.</span>\\n      {{/if}}\\n    </li>\\n\\n    <li class=\"{{#less step 4}}fade{{/less}} {{#equals step 4}}active{{/equals}}\">\\n      {{#unless isHook}}\\n      <p>Great, we found it!</p>\\n      {{/unless}}\\n      <button data-step=\"4\" class=\"submit\">All done!</button>\\n    </li>\\n  </ol>\\n{{/initConnection}}');window.JST[\"editor_givefill_modal\"]=JST('{{#hasAtLeastOne choices}}\\n<div class=\"search\">\\n  <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n</div>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<div class=\"nomatch\">No choices match <strong>{{search}}</strong></div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">\\n      {{#if ../fancychoices}}\\n        {{#ellipsis 30}}{{this.display}}{{/ellipsis}}\\n      {{else}}\\n        {{this.display}}\\n      {{/if}}\\n      {{#unless ../hideRawValue }}<span class=\"sample\">{{this.val}}</span>{{/unless}}\\n    </a>\\n  </li>\\n  {{/each}}\\n\\n  {{#if fancychoices}}\\n    <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n    <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value<span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n    <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/if}}\\n</ul>\\n');window.JST[\"editor_filter\"]=JST('{{#if show}}\\n  <p class=\"big\">Only trigger a \"{{call service.getActionName read.action \"read\" \"false\" context=service}}\" from {{appNameFromKey read.selected_api}} when...</p>\\n\\n  <paramform class=\"top-margin\"></paramform>\\n\\n  <div class=\"loading-fields\">Loading fields...</div>\\n  <div class=\"loading-error\">\\n    <p><i class=\"fa fa-exclamation-circle\"></i> We had trouble loading some fields!</p>\\n    <button class=\"retry-fields\">Try again?</button>\\n  </div>\\n\\n  <p class=\"big custom-filter-helper\">Add filters based on other {{appNameFromKey read.selected_api}} fields.</p>\\n\\n  {{#hasExactly rules 0}}\\n    <div class=\"show-custom\"><button class=\"add\">Add custom filters</button></div>\\n    {{else}}\\n    <a id=\"custom-filters\"></a>\\n    <h3>Custom Filters</h3>\\n  {{/hasExactly}}\\n\\n  <div class=\"custom paramform\">\\n    <div class=\"groups\"></div>\\n    {{#hasAtLeastOne rules}}<button class=\"or\">Add OR Filter</button>{{/hasAtLeastOne}}\\n  </div>\\n\\n  {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_test\"]=JST('{{#if show}}\\n\\n  {{#hasAtLeastOne samples}}\\n  {{else}}\\n    <p class=\"big\">Click the button below to test your trigger and get sample data.</p>\\n    <p><button class=\"load {{#hasAtLeastOne samples}}orange{{/hasAtLeastOne}}\" href=\"#\">\\n      <span class=\"img16 {{#if readService}}{{readService.id}}16x16{{else}}placeholder{{/if}}\"></span> Test {{appNameFromKey readService.id}} trigger\\n    </button></p>\\n  {{/hasAtLeastOne}}\\n\\n  {{#hasAtLeastOne samples}}\\n  <p class=\"big\">Select a sample to test with.</p>\\n\\n      <div class=\"samples\">\\n        {{#each samples limit=3}}\\n          <div class=\"sample\">\\n            <h3>Sample #{{this.num}}</h3>\\n            <div class=\"sample-modal-link\">\\n              <div class=\"service {{../readService.id}}32x32\" title=\"[Service name]\"></div>\\n              <a href=\"#\" data-sample-read-id=\"{{this.[_idx]}}\">See trigger sample.</a>\\n            </div>\\n\\n            {{#if this.isFiltered}}\\n              <span class=\"filtered-out\">filtered via <a class=\"custom-filters\">custom filter</a> #{{call this.getWhyFiltered context=this}}</span>\\n            {{/if}}\\n          {{#and this.isFiltered context=this}}\\n          {{else}}\\n            <div class=\"sample-modal-link\">\\n              <div class=\"service {{../../writeService.id}}32x32\" title=\"[Service name]\"></div>\\n              <a href=\"#\" data-sample-write-id=\"{{this.[_idx]}}\">See action sample.</a>\\n            </div>\\n\\n            <button class=\"send\" data-send-sample-id=\"{{this.[_idx]}}\">Test Zap with this sample</button>\\n          {{/and}}\\n          </div>\\n        {{/each}}\\n      </div>\\n\\n      <p><a href=\"#\" class=\"load refresh\"><span class=\"img16 {{#if readService}}{{readService.id}}{{else}}placeholder{{/if}}\"></span> Refresh samples from {{appNameFromKey readService.id}}</a></p>\\n\\n    </div>\\n  {{/hasAtLeastOne}}\\n\\n\\n  {{#hasAtLeastOne samples}}\\n\\n    {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n  {{else}}\\n  {{/hasAtLeastOne}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}\\n');window.JST[\"editor_map\"]=JST('{{#if show}}\\n  <paramform></paramform>\\n\\n  <div class=\"loading-fields\">Loading fields...</div>\\n  <span class=\"loading-empty\">(This Action, {{call service.getActionName write.action \"write\" \"false\" context=service}}, does not have any fields)</span>\\n\\n  {{#if flow}}<button class=\"continue\">Continue</button>{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_prefill_modal\"]=JST('{{#hasAtLeastOne choices}}\\n<div class=\"search\">\\n  <input placeholder=\"Search choices...\" type=\"text\" class=\"searcher\" value=\"{{../search}}\">\\n</div>\\n{{/hasAtLeastOne}}\\n\\n<div class=\"loading\">{{render loadingMsg.[0] context=this}}</div>\\n<div class=\"still-loading\">{{render loadingMsg.[1] context=this}}</div>\\n<div class=\"still-still-loading\">{{render loadingMsg.[2] context=this}}</div>\\n\\n<ul>\\n  {{#each choices}}\\n  <li\\n    {{#if this.key}}data-key=\"{{this.key}}\"{{/if}}\\n    {{#if this.display}}data-display=\"{{this.display}}\"{{/if}}\\n    {{#if this.val}}data-val=\"{{this.val}}\"{{/if}}\\n  >\\n    <a class=\"display\" title=\"{{this.display}}\" alt=\"{{this.display}}\">{{#ellipsis 50}}{{this.display}}{{/ellipsis}} <span class=\"sample\">{{this.val}}</span></a>\\n  </li>\\n  {{/each}}\\n\\n  <li class=\"empty-value\" data-id=\"empty-value\"><a class=\"display\" title=\"Clear current choice\" alt=\"Clear current choice\">Clear current choice <span class=\"sample\"><i class=\"fa fa-eraser\"></i></span></a></li>\\n\\n  <li class=\"custom-value\" data-id=\"custom-value\"><a class=\"display\" title=\"Advanced: type in a custom value\" alt=\"Advanced: type in a custom value\">Advanced: type in a custom value <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n\\n  {{#unless trigger}}\\n  <li class=\"placeholder-value\" data-id=\"placeholder-value\"><a class=\"display\" title=\"Advanced: choose from trigger data\" alt=\"Advanced: choose from trigger data\">Advanced: choose from trigger data <span class=\"sample\"><i class=\"fa fa-edit\"></i></span></a></li>\\n  {{/unless}}\\n\\n  <li class=\"load-more\" data-id=\"load-more\"><a class=\"display\" title=\"Load more choices\" alt=\"Load more choices\">Load more choices <span class=\"sample\"><i class=\"fa fa-ellipsis-horizontal\"></i></span></a></li>\\n</ul>');window.JST[\"editor_action_card\"]=JST(\"<h2>Available {{#plural}}{{which}}{{/plural}}</h2>\\n<ul>\\n  {{#each action}}\\n  <li>{{this.label}}</li>\\n  {{/each}}\\n</ul>\");window.JST[\"editor_auth\"]=JST('{{#if show}}\\n\\n  {{#if needsAuth}}\\n\\n    {{#if hasAtLeastOneAuth}}\\n      <div class=\"container table-wrapper\">\\n        <div class=\"column one-half table-cell\">\\n        <select class=\"auths\" data-placeholder=\"{{appNameFromKey key}} Account\">\\n          <option></option> <!-- placeholder -->\\n          {{#each auths}}\\n          <option value=\"{{this.id}}\" {{#equals this.id ../selected }}selected=\"selected\"{{/equals}}>{{call this.getName}}</option>\\n          {{/each}}\\n          <option value=\"new\">Connect a different {{appNameFromKey key}} Account</option>\\n        </select>\\n        </div>\\n        <div class=\"column one-half table-cell vcenter\">\\n      {{#if selected}}\\n        <button class=\"test\">Test this Account</button>\\n      {{/if}}\\n        </div>\\n      </div>\\n    {{else}}\\n      <a class=\"orange button add\" href=\"#\" data-id=\"add\">\\n        Connect {{#article}}{{appNameFromKey key}}{{/article}} Account\\n      </a>\\n    {{/if}}\\n  {{/if}}\\n\\n  {{#neither needsAuth isHook}}\\n    <p class=\"big\">You\\'re all set. Carry on!</p>\\n  {{/neither}}\\n\\n  {{#if isHook}}\\n    <div class=\"hook-dirs\">{{{call service.getWebhookDirections action which context=service}}}</div>\\n\\n    <p class=\"big\">Use this Webhook URL:</p>\\n\\n    <div class=\"table-wrapper fill\">\\n      <div class=\"table-cell column\">\\n        <input class=\"webhook-url\" type=\"text\" value=\"{{call service.getWebhookURL action which model context=service}}\" data-id=\"webhook-url\" readonly>\\n      </div>\\n      <div class=\"table-cell vcenter\">\\n        <button class=\"copy-button\" data-clipboard-text=\"{{call service.getWebhookURL action which model context=service}}\">Copy to clipboard</button>\\n      </div>\\n    </div>\\n\\n    {{#if showContinue}}<div><button class=\"continue\">Continue</button></div>{{/if}}\\n\\n  {{/if}}\\n\\n  {{#if showContinue}}{{#unless isHook}}<div><button class=\"continue\">Continue</button></div>{{/unless}}{{/if}}\\n\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_action\"]=JST('{{#if show}}}\\n  <ul class=\"pill-list\"></ul>\\n  {{#if anyAdvanced}} {{#unless showall}} {{#hasAtLeastOne actions}}\\n    <a href=\"#\" class=\"showall\">Show advanced, less-used options</a>\\n  {{/hasAtLeastOne}} {{/unless}} {{/if}}\\n{{else}}\\n  <p class=\"big\">Complete the steps above.</p>\\n{{/if}}');window.JST[\"editor_no_samples_modal\"]=JST('<h2>We could not find any <em>recent</em> {{#plural}}{{call service.getActionName action \"read\" \"true\" context=service}}{{/plural}} from {{appNameFromKey key}} {{#unless isHook}}matching your Filters{{/unless}}</span></h2>\\n\\n<pre class=\"error\">{{call service.getActionName action \"read\" \"true\" context=service}} response: empty</pre>\\n\\n<h3>What To Do Next</h3>\\n\\n<ol>\\n  {{#if isHook}}\\n  <li>Follow any on-screen instructions and make sure that you have recently <em>sent us</em> a {{call service.getActionName action \"read\" \"true\" context=service}}</li>\\n  {{else}}\\n\\n  <li>Create a new {{call service.getActionName action \"read\" \"true\" context=service}} in {{appNameFromKey key}} {{#unless isHook}}which matches your Filters{{/unless}}</li>\\n  {{/if}}\\n\\n  <li>Try reloading {{#plural}}{{call service.getActionName action \"read\" \"true\" context=service}}{{/plural}} again in a few seconds</li>\\n</ol>');window.JST[\"editor_action_row\"]=JST('<li class=\"action pill-row {{#if selected}}selected{{/if}}\" id=\"{{key}}\">\\n  <div class=\"radio\"></div>\\n  <div class=\"text name\">{{label}}</div>\\n  <div class=\"text description\">{{#if help_text_html}}{{{help_text_html}}}{{else}}{{help_text}}{{/if}}</div>\\n  <div class=\"clear\"></div>\\n</li>');window.JST[\"editor_base\"]=JST('<div class=\"editor\"></div>');window.JST[\"editor_api_error_modal\"]=JST('<h2>We received an error from {{appNameFromKey key}}</h2>\\n\\n<pre class=\"error\">{{message}}</pre>\\n\\n<h3>What To Do Next</h3>\\n<ol>\\n  <li>Make sure you have followed all on-screen directions, in order</li>\\n  <li>Test your {{serivce}} Account again</li>\\n  <li>Check out our <a href=\"/help\">help docs</a> for more information</li>\\n</ol>');window.JST[\"share_shared\"]=JST('<div class=\"container\"></div>\\n\\n<div class=\"pagination\">\\n    <button class=\"light previous\" {{#unless this.pagination.prev }}disabled{{/unless}}>&nbsp; &larr; &nbsp;</button>\\n    {{! <button class=\"light\">1</button> }}\\n    {{! <button class=\"light\">2</button> }}\\n    {{! <button class=\"light\">3</button> }}\\n    <span><em>page <select class=\"page\">{{#range this.pagination.pages}}<option value=\"{{i}}\" {{#equals i this.pagination.page }}selected{{/equals}}>{{i}}</option>{{/range}}</select> of {{ this.pagination.pages }}</em></span>\\n    <button class=\"light next\" {{#unless this.pagination.next }}disabled{{/unless}}>&nbsp; &rarr; &nbsp;</button>\\n</div>\\n');window.JST[\"share_recipe\"]=JST('<div class=\"zap-mini\">\\n  <div class=\"title-narrow\">{{try title \"Unnamed Zap\"}}</div>\\n  <div class=\"twrapper\">\\n    <div class=\"checkbox\">\\n      <input type=\"checkbox\" class=\"add-to-embed\" value=\"{{this.id}}\">\\n    </div>\\n    <div class=\"services\">\\n      <div class=\"service {{this.read_service_selected_api}}32x32\"></div>\\n      <span class=\"fa fa-caret-right caret\"></span>\\n      <div class=\"service {{this.write_service_selected_api}}32x32\"></div>\\n    </div>\\n    <div class=\"title\">{{this.short_description}}</div>\\n  </div>\\n</div>');window.JST[\"share_embed\"]=JST('<div class=\"sharer\"></div>\\n<h3>3. Embed Your Widget</h3>\\n<div class=\"share-link\">\\n  <p>Happy with your new widget?!</p>\\n  <p>Copy the code below and embed your widget on your website or anywhere that allows embedding.</p>\\n  <input type=\"text\" class=\"share-this\" readonly>\\n</div>');window.JST[\"share_base\"]=JST('<div class=\"row\">\\n    <div class=\"container shave center\">\\n        <h1>Make Your Own Zap Widget</h1>\\n    </div>\\n</div>\\n<div class=\"row\">\\n    <div class=\"container shared haircut\">\\n        <div class=\"column one-half\">\\n            <h3>1. Select Zaps To Include</h3>\\n            <p>Choose which shared Zaps below to include in your widget.</p>\\n            <div class=\"results\"></div>\\n        </div>\\n        <div class=\"column one-half\">\\n            <h3>2. Preview Your Zap Widget</h3>\\n            <p>This is how your Zap widget will look on your website or blog.</p>\\n            <div class=\"embed\"></div>\\n        </div>\\n    </div>\\n</div>');window.JST[\"history_filters\"]=JST('<div class=\"history-controls\">\\n  <div class=\"history-selects\">\\n    <label>Filter by: </label>\\n\\n    <paramform></paramform>\\n    \\n  </div>\\n\\n  <div class=\"history-buttons\">\\n    <button class=\"refresh light right\"><i class=\"fa fa-refresh left\"></i> Refresh</button>\\n    <button class=\"send-csv light right\"><i class=\"fa fa-download left\"></i> Export to CSV</button>\\n  </div>\\n</div>');window.JST[\"history_table\"]=JST('<table class=\"table table-striped\">\\n  <tr class=\"history\">\\n    <td class=\"empty\">\\n      <p>No tasks match this filter.</p>\\n      <p><a href=\"/app/editor/\">Make a new Zap</a>{{#unless isPartner}} or <a href=\"/app/explore\">Explore existing Zap templates</a>{{/unless}}.</p>\\n    </td>\\n  </tr>\\n</table>');window.JST[\"history_details\"]=JST('<table class=\"table history-single\">\\n  <tr class=\"history single\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\">\\n    <td class=\"status-column\">\\n      <div class=\"status-indicator {{this.data.status}}\"></div>\\n    </td>\\n    <td class=\"services\">\\n      <div class=\"service\">\\n        <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n      </div>\\n      <i class=\"fa fa-caret-right caret\"></i>\\n      <div class=\"service\">\\n        <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n      </div>\\n    </td>\\n    <td>\\n      <div class=\"title\">{{this.object_title}}</div>\\n    </td>\\n    <td>\\n      <button class=\"replay {{#notequals data.status \"success\"}}{{else}}invisible{{/notequals}}\"><i class=\"fa fa-repeat left\"></i> Replay</button>\\n    </td>\\n    <td>\\n      <div class=\"timesince\">{{this.timesince}} ago</div>\\n    </td>\\n  </tr>\\n</table>\\n\\n<h2>Details</h2>\\n<div class=\"task-details\">\\n  {{#each children}}\\n  <div class=\"task-detail\">\\n    <a href=\"#\" class=\"toggle-details\">Show detail</a>\\n    <div class=\"target {{#equals ../selected.id ../id}}{{#equals ../../selected.row ../_idx}}selected{{/equals}}{{/equals}}\"\\n    data-id=\"{{../id}}\" data-row=\"{{_idx}}\" data-type=\"{{type}}\">\\n      <div class=\"caret\">\\n        <i class=\"fa fa-caret-right\"></i>\\n      </div>\\n      <div class=\"status-container\">\\n        <div class=\"status-indicator {{status}}\"></div>\\n      </div>\\n      <div class=\"title\">{{message}}</div>\\n      <div class=\"date\">{{prettyISO date}}</div>\\n    </div>\\n\\n    <div class=\"details hide\">\\n      {{#if dataDetails}}\\n        <ul>\\n          {{#each dataDetails}}\\n          <li>\\n            <span class=\"detail-key\">{{key}}:</span>\\n            <pre class=\"detail-value\">{{value}}</pre>\\n          </li>\\n          {{/each}}\\n        </ul>\\n      {{else}}\\n        <div class=\"empty\">No details to show...</div>\\n      {{/if}}\\n    </div>\\n\\n  </div><!-- task-detail -->\\n  {{/each}}\\n</div><!-- task-details -->');window.JST[\"history_send_csv\"]=JST('<div class=\"the-content\">\\n  <h1>Generate Task History CSV</h1>\\n  <p>Customers on the Basic plan and up can export large amounts of task history as a CSV (5000 items is the default max, <a href=\"mailto:contact@zapier.com\">contact us</a> if you need to export more). This can take a few minutes so we\\'ll email you with a link when it is ready!</p>\\n  <ul>\\n      <li><strong>Selected Zap</strong>: <em>{{#if zapName}}{{zapName}}{{else}}any{{/if}}</em></li>\\n      <li><strong>Selected Status</strong>: <em>{{#if status}}{{status}}{{else}}any{{/if}}</em></li>\\n  </ul>\\n  <p class=\"feedback\"></p>\\n  <button class=\"submit send\">Generate &amp; Email CSV</button>\\n</div>');window.JST[\"history_pagination\"]=JST('{{#if pagination.pages }}\\n{{#greater pagination.pages 1}}\\n<div class=\"pagination\">\\n  <div class=\"page-nav\"><a href=\"#\" class=\"previous {{#unless pagination.hasPrev }}disabled{{/unless}}\"><i class=\"fa fa-chevron-left\"></i></a></div>\\n  <div class=\"page-numbers\"><span>{{ pagination.page }}</span> of <span>{{ pagination.pages }}</span></div>\\n  <div class=\"page-nav\"><a href=\"#\" class=\"next {{#unless pagination.hasNext }}disabled{{/unless}}\"><i class=\"fa fa-chevron-right\"></i></a></div>\\n</div>\\n{{/greater}}\\n{{/if}}');\nwindow.JST[\"history_base\"]=JST('<div class=\"row\">\\n  <div class=\"container shave\">\\n    {{#if id}}\\n      <h1 class=\"history-header shave\">Task Id: {{id}}</h1>\\n    {{else}}\\n      <div class=\"column one-half\">\\n        <h1 class=\"history-header shave\">Task History</h1>\\n      </div>\\n      <div class=\"column one-half\">\\n        <div class=\"history-key\"><span class=\"status-indicator success\"></span> success &nbsp; <span class=\"status-indicator error\"></span> error &nbsp; <span class=\"status-indicator halted\"></span> filtered</div>\\n      </div>\\n    {{/if}}\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container shave head\">\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container body\">\\n  </div>\\n</div>');window.JST[\"history_nav\"]=JST('<a data-nav=\"/app/history\" href=\"#\" class=\"history-back-link\"><i class=\"fa fa-angle-left\"></i> Back to Task History</a>');window.JST[\"history_row\"]=JST('<tr class=\"history\" data-id=\"{{this.id}}\" href=\"/app/history/{{this.id}}\" data-nav=\"app/history/{{this.id}}\" title=\"Click for more details\">\\n  <td class=\"status-column\">\\n    <div class=\"status-indicator {{this.data.status}}\"></div>\\n  </td>\\n  <td class=\"services\">\\n    <div class=\"service\">\\n      <div class=\"service-icon read {{this.data.read_selected_api}}16x16\"></div>\\n    </div>\\n    <i class=\"fa fa-caret-right caret\"></i>\\n    <div class=\"service\">\\n      <div class=\"service-icon write {{this.data.write_selected_api}}16x16\"></div>\\n    </div>\\n  </td>\\n  <td>\\n    <div class=\"title\">{{this.object_title}}</div>\\n  </td>\\n  <td>\\n    <button class=\"replay {{#notequals data.status \"success\"}}{{else}}invisible{{/notequals}}\"><i class=\"fa fa-repeat left\"></i> Replay</button>\\n  </td>\\n  <td>\\n    <div class=\"timesince\">{{date}}</div>\\n  </td>\\n</tr>');window.JST[\"explore_recipe\"]=JST('<div class=\"zap\">\\n\\n  <div class=\"text-narrow\">\\n    <div class=\"title\"><a href=\"#\" class=\"use-this\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n    <div class=\"description\">{{this.short_description}}</div>\\n  </div>\\n\\n  <div class=\"services\">\\n    <div class=\"service {{this.read_service_selected_api}}64x64\"></div>\\n    <span class=\"fa fa-caret-right caret\"></span>\\n    <div class=\"service {{this.write_service_selected_api}}64x64\"></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    {{#if this.generated}}\\n      <div class=\"title\"><a href=\"#\" class=\"use-this\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n    {{else}}\\n      {{#if z.app.partner.isPartnerSession context=z.app.partner}}\\n        <div class=\"title\">{{this.title}}</div>\\n      {{else}}\\n        <div class=\"title\"><a href=\"{{this.url}}\">{{this.title}}</a></div>\\n      {{/if}}\\n    {{/if}}\\n    <div class=\"description\">{{this.short_description}}</div>\\n  </div>\\n\\n  <div class=\"cta\"><a class=\"big button use-this\" data-id=\"{{this.id}}\">Use this Zap</a></div>\\n\\n</div>');window.JST[\"explore_recipe_classic\"]=JST('<div class=\"recipe classic\">\\n\\n  <div class=\"images\">\\n    <div class=\"read\"><div class=\"img64 {{this.read_service_selected_api}}64x64\"></div></div>\\n    <div class=\"arrow\">&#9658;</div>\\n    <div class=\"write\"><div class=\"img64 {{this.write_service_selected_api}}64x64\"></div></div>\\n  </div>\\n\\n  <div class=\"text\">\\n    <div class=\"description\"><a class=\"underline\" href=\"#\" data-id=\"{{this.id}}\">{{this.title}}</a></div>\\n\\n    <a href=\"#\" data-id=\"{{this.id}}\"><button>Use This!</button></a>\\n\\n    <div class=\"used-by\">\\n      <div class=\"count\">{{humanize this.used}} others use this</div>\\n    </div>\\n  </div>\\n\\n  <clear />\\n\\n</div>\\n');window.JST[\"explore_search\"]=JST('<div class=\"row\">\\n  <div class=\"column one-half\">\\n    <div class=\"involve services\">\\n      <select id=\"involve-service\" data-placeholder=\"Click here and select the apps you use...\">\\n        <option></option>\\n        {{#each services}}\\n          <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n        {{/each}}\\n      </select>\\n    </div>\\n  </div>\\n\\n  <div class=\"column one-half\">\\n    <div class=\"involved-services\">\\n      {{#each involvedServices}}\\n        <div class=\"involved-service\">\\n          <div class=\"img32 {{get this \"key\"}}32x32\">&nbsp;</div>\\n          <div class=\"remove\" data-remove-involve-service=\"{{get this \"slug\"}}\"><i class=\"fa fa-times\"></i></div>\\n        </div>\\n      {{/each}}\\n    </div>\\n\\n    {{#if anyFilters}}\\n      <button class=\"do-clear\">Reset all</button>\\n      <a class=\"direct-link\" href=\"{{directLink}}\" title=\"Click to get a direct link to this page in your browser\\'s address bar\"><i class=\"fa fa-external-link\" /></a>\\n    {{/if}}\\n  </div>\\n</div>');window.JST[\"explore_results\"]=JST('<div class=\"zaps\"></div>\\n\\n{{#greater this.pagination.pages 1}}\\n<div class=\"pagination\">\\n  <div class=\"page-nav\"><a href=\"#\" class=\"previous {{#unless this.pagination.prev }}disabled{{/unless}}\"><i class=\"fa fa-chevron-left\"></i></a></div>\\n  <div class=\"page-numbers\"><span>{{ this.pagination.page }}</span> of <span>{{ this.pagination.pages }}</span></div>\\n  <div class=\"page-nav\"><a href=\"#\" class=\"next {{#unless this.pagination.next }}disabled{{/unless}}\"><i class=\"fa fa-chevron-right\"></i></a></div>\\n</div>\\n{{/greater}}');window.JST[\"explore_base\"]=JST('<div class=\"row\">\\n\t<div class=\"container center shave\">\\n\t\t<h1>Explore Zaps!</h1>\\n\t\t<p>Pick from thousands of Zaps that other people have shared to use as a template.<br />A Zap is a connection between two apps that automates time-consuming tasks.</p>\\n\t</div>\\n</div>\\n<div class=\"row\">\\n\t<div class=\"container\">\\n\t\t<div class=\"explore\">\\n\t\t\t<div class=\"search\"></div>\\n\t\t\t<div class=\"results\"></div>\\n\t\t</div>\\n\t</div>\\n</div>');window.JST[\"signup_why\"]=JST('{{#if selectedPlan}}\\n  <div class=\"selected-plan\">\\n    <h2>{{get selectedPlan \"name\"}}</h2>\\n  </div>\\n{{else}}\\n  <div class=\"trialing\">\\n    <h1>Sign Up For Free</h1>\\n    <ul class=\"default\">\\n      <li><i class=\"fa fa-check green\"></i> Access to Premium Apps</li>\\n      <li><i class=\"fa fa-check green\"></i> Unlimited Tasks and Zaps</li>\\n      <li><i class=\"fa fa-check green\"></i> Upgrade, downgrade, or cancel at any time</li>\\n    </ul>\\n  </div>\\n{{/if}}\\n\\n{{#or readService writeService}}\\n  <div class=\"services\">\\n    <h3>You are seconds away from connecting...</h3>\\n\\n    {{#if readService}}\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          <img src=\"/generated/{{get readService \"key\" context=readService}}/128/\" />\\n        </div>\\n      </div>\\n    {{else}}\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          {{#each services}}\\n            <div class=\"gray img32 {{get this \"key\" context=this}}32x32\"></div>\\n          {{/each}}\\n        </div>\\n        <h3 class=\"no-service\">hundreds of apps!</h3>\\n      </div>\\n    {{/if}}\\n\\n    {{#if writeService}}\\n      <div class=\"connection\">\\n        <em>to</em>\\n      </div>\\n      <div class=\"service\">\\n        <div class=\"service-icon-large\">\\n          <img src=\"/generated/{{get writeService \"key\" context=writeService}}/128/\" />\\n        </div>\\n      </div>\\n    {{else}}\\n      <h3 class=\"no-service\">to hundreds of other apps!</h3>\\n    {{/if}}\\n  </div>\\n\\n{{else}}\\n\\n  <div class=\"ebook\">\\n    <div class=\"book\"><img src=\"{{mediaURL}}images/ebook.png\" /></div>\\n    <div class=\"description\">\\n      <h3>Sign up and get this E-book FREE!</h3>\\n      <p class=\"small\">You\\'ll get a download link in your inbox.</p>\\n      <img src=\"{{mediaURL}}images/arrows/right.png\" class=\"arrow\" />\\n    </div>\\n  </div>\\n\\n{{/or}}');window.JST[\"signup_persona_modal\"]=JST('<h1 class=\"center\">Get Better Zap Recommendations</h1>\\n<div class=\"subhead center\">Check one or more professions below that best match you to get the best Zap recommendations.</div>\\n<div class=\"line\"></div>\\n\\n<form method=\"post\">\\n    \\n    <div class=\"group left\">\\n        {{#each first_personas}}\\n            <label><input type=\"checkbox\" name=\"persona\" value=\"{{this}}\"> {{this}}</label> <br>\\n        {{/each}}\\n    </div> <!-- end of .group .left -->\\n\\n    <div class=\"group\">\\n        {{#each second_personas}}\\n            <label><input type=\"checkbox\" name=\"persona\" value=\"{{this}}\"> {{this}}</label> <br>\\n        {{/each}}\\n    </div> <!-- end of .group -->\\n    \\n    <div class=\"clear\"></div>\\n\\n    <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{{csrf}}\">\\n\\n    <input type=\"submit\" value=\"Let\\'s get started!\" class=\"button light\">\\n</form>\\n');window.JST[\"signup_form\"]=JST('<h3>Signup Today - It\\'s Easy!</h3>\\n<signupform></signupform>\\n<div class=\"submit-row\">\\n  <button class=\"submit big orange\">Create Your New Zapier Account</button>\\n</div>\\n\\n<div class=\"errors hide\">\\n    <i class=\"fa fa-exclamation-circle\" /> <span>A user with that email already exists.</span>\\n</div>');window.JST[\"signup_base\"]=JST('<div class=\"row signup\">\\n\t<div class=\"container haircut\">\\n\t\t<div class=\"column one-half signup-why\">\\n\t\t\t<div class=\"selected-plan\"></div>\\n\t\t</div>\\n\t\t<div class=\"column one-half signup-form\"></div>\\n\t</div>\\n</div>');window.JST[\"forgot_password\"]=JST('<p>Reset the password for {{username}}.</p>\\n<form>\\n<input type=\"password\" class=\"password1\" placeholder=\"New Password\" />\\n<input type=\"password\" class=\"password2\" placeholder=\"Confirm New Password\" />\\n<button class=\"submit\">Set New Password</button>\\n<p class=\"feedback hide\"></p>\\n</form>');window.JST[\"forgot_base\"]=JST(\"<h1>Forgot Password</h1>\");window.JST[\"forgot_email\"]=JST('<p>Enter the email address you signed up with below. An email will be sent containing a link to reset your password.</p>\\n<p>Forgot your email address? Send <a href=\"mailto:contact@zapier.com\">an email to support</a> and we\\'ll track it down.</p>\\n<form>\\n<input type=\"text\" class=\"email\" placeholder=\"Email Address\" />\\n<button class=\"submit\">Send Reset Instructions</button>\\n<p class=\"feedback hide\"></p>\\n</form>');window.JST[\"settings_plans\"]=JST('<div class=\"row\">\\n  <div class=\"container\">\\n\\n    <h1>Pricing Plans</h1>\\n\\n    <div class=\"toggle toggle-interval\">\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"month\">Monthly</a>\\n      <div class=\"toggle-container{{#if monthly}}{{else}} on{{/if}}\"><div class=\"toggle-switch\"></div></div>\\n      <a href=\"#\" class=\"switch\" data-pricing-interval=\"year\">Yearly (1 Month Free)</a>\\n    </div>\\n\\n    {{#if account.isTrialing context=account}}\\n      <div class=\"extra-info\">\\n        <p>There are {{call ../account.trialDaysLeft context=../account}} days left in your current Zapier trial.</p>\\n        <h3 class=\"haircut\">Your trial includes:</h3>\\n        <ul class=\"default\">\\n          <li><i class=\"fa fa-check green\"></i> Access to all Regular + Premium Apps</li>\\n          <li><i class=\"fa fa-check green\"></i> Unlimited Tasks and Zaps</li>\\n          <li><i class=\"fa fa-check green\"></i> 5-minute Syncing</li>\\n        </ul>\\n        <p>If you don\\'t select a plan before your trial ends, we\\'ll automatically switch your account to the free plan for you. If you have more than 5 Zaps, 100 tasks, or are using any premium apps in your Zaps, please select a plan to avoid any service interruptions.</p>\\n      </div>\\n    {{/if}}\\n\\n  {{#if provider}}\\n    <div class=\"extra-info\">You have a Zapier account sponsored by {{provider.title}}! That means you get free access to lots of Zapier benefits without the costs. However, you can upgrade to a full Zapier to unlock more features.<!-- <a href=\"#\" data-support-tags=\"sponsored-account\">Click to learn more.</a>--></div>\\n  {{/if}}\\n\\n  {{#if coupon}}\\n    <div class=\"extra-info\">Coupon is active! {{coupon}}</div>\\n  {{/if}}\\n\\n    {{#if cached_coupon.description}}\\n      <div class=\"extra-info\">Coupon is ready for upgrade! {{cached_coupon.description}}</div>\\n    {{/if}}\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container table-fixed-width\">\\n    <div class=\"overflow-container\">\\n      <table class=\"table table-striped\">\\n        <thead>\\n          <tr class=\"table-header-row\">\\n            <th>Plan</th>\\n            <th>Price</th>\\n            <th style=\"width:150px;\">Premium Services</th>\\n            <th>Tasks/mo</th>\\n            <th>Zaps</th>\\n            <th>Zaps Run Every</th>\\n            <th class=\"change\">Action</th>\\n          </tr>\\n        </thead>\\n\\n        <tbody id=\"plans\">\\n          {{#each plans}}\\n            <tr>\\n              <td>{{get this \"name\"}}</td>\\n              <td>${{dollars}}/{{get this \"interval\"}}</td>\\n              <td class=\"center\">{{#hasExactly this.blacklistedServices 0}}<i class=\"fa fa-check green\"></i>{{else}}<i class=\"fa fa-times\"></i>{{/hasExactly}}</td>\\n              <td>{{tasksMo}}</td>\\n              <td>{{zaps}}</td>\\n              <td>{{pollInterval}} {{pollIntervalTimeFrame}}</td>\\n              <td>\\n              {{#if current}}\\n                <a class=\"button disabled\">Your current plan</a>\\n              {{else}}\\n                {{#if ../../account.hasActiveCard context=../../account}}\\n                  <button class=\"light {{#if ../../isFree}}change-plan{{else}}add-card{{/if}}\" data-change-plan=\"{{../../id}}\">{{../../buttonText}}</button>\\n                {{else}}\\n                  <a class=\"add-card button\" data-change-plan=\"{{../../id}}\">Switch to this plan</a>\\n                {{/if}}\\n              {{/if}}\\n              </td>\\n            </tr>\\n          {{/each}}\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"row border\">\\n   <div class=\"container\">\\n\\n  {{#if showCoupon}}\\n    <div class=\"coupon-form\">\\n      <span class=\"feedback\"></span>\\n      <input class=\"coupon-code\" type=\"text\" name=\"coupon-code\" placeholder=\"Enter your coupon code...\">\\n      <button class=\"submit light\">Use Coupon</button>\\n    </div>\\n  {{/if}}\\n\\n  </div>\\n</div>\\n{{JST \"pricing_about\"}}');window.JST[\"settings_overview\"]=JST('<div class=\"picture\">\\n  <img src=\"https://secure.gravatar.com/avatar/{{email_hash}}.jpg?s=30&amp;d=mm\">\\n</div>\\n<div class=\"table left\">\\n<span class=\"key\">Email:</span><span class=\"val\">{{email}}</span><br />\\n<span class=\"key\">Joined:</span><span class=\"val\">{{since_signup}} ago</span><br />\\n</div>\\n<div class=\"table right\">\\n<span class=\"key\">Plan:</span><span class=\"val\">{{plan.name}}</span><br />\\n<span class=\"key\">Status:</span><span class=\"val\">{{status}}</span><br />\\n</div>');window.JST[\"settings_extra\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"advanced\"><i class=\"fa fa-wrench\"></i> Advanced Settings</a></h3>\\n    <p>Modify advanced or technical settings with your account</p>\\n    <p><a href=\"#\" class=\"advanced action left\">Monkey with advanced settings</a></p>\\n    <p><a href=\"#\" class=\"close\">Click here to permanently delete your account</a></p>\\n  </li>\\n</ul>');window.JST[\"settings_invoices\"]=JST('<div class=\"row\">\\n  <div class=\"container settings invoices\">\\n\\n    <h1>Invoices</h1>\\n    {{#if billing_period_start_date}}\\n      <h4>Your next billing period starts on {{billing_period_start_date}}</h4>\\n    {{/if}}\\n\\n    <table class=\"table\">\\n      <thead>\\n        <tr>\\n          <th>Billing Period Starting</th>\\n          <th>Subtotal</th>\\n          <th>Discount</th>\\n          <th>Amount</th>\\n          <th>Status</th>\\n          <th>Actions</th>\\n        </tr>\\n      </thead>\\n      <tbody id=\"invoices\">\\n        <tr>\\n          <td colspan=\"7\" class=\"center\"><em>No past invoices to see...</em></td>\\n        </tr>\\n      </tbody>\\n    </table>\\n\\n    <p><a data-nav=\"/app/settings\">Back to settings</a></p>\\n\\n  </div>\\n</div>');window.JST[\"settings_billing\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"plans\"><i class=\"fa fa-tag\"></i> Current Plan</a></h3>\\n    <p>{{plan_name}} {{plan_rate}} <a href=\"#\" class=\"plans action\">See other plans</a></p>\\n    <p>{{#if last4}}Credit Card Last Four: {{last4}} <a href=\"#\" class=\"card action left\">Update credit card</a>{{else}}<a href=\"#\" class=\"card action left\">Add credit card</a>{{/if}}</p>\\n    <p><a href=\"#\" class=\"invoice action left\">See invoices</a></p>\\n  </li>\\n</ul>');window.JST[\"settings_card\"]=JST('<table class=\"table table-bordered credit-card\">\\n  <thead>\\n    <tr>\\n      <th>Type</th>\\n      <th>Number</th>\\n      <th>Expiration</th>\\n    </tr>\\n  </thead>\\n\\n  <tbody>\\n    <tr>\\n      {{#if last4}}\\n        <td>{{type}}</td>\\n        <td>xxxx-xxxx-xxxx-{{last4}}</td>\\n        <td>{{expM}}/{{expY}}</td>\\n      {{else}}\\n        <td colspan=\"3\"><em>No card on file.</em></td>\\n      {{/if}}\\n    </tr>\\n  </tbody>\\n</table>');window.JST[\"settings_invoice\"]=JST('<tr>\\n  <td>{{period_end_pretty}}</td>\\n  <td>${{subtotal_pretty}}</td>\\n  <td>{{#if discount.coupon.percent_off}}\\n    {{discount.coupon.percent_off}}% off\\n  {{else}}\\n    {{#if discount.coupon.amount_off}}\\n      ${{discount.coupon.amount_off_pretty}} off\\n    {{/if}}\\n  {{/if}}</td>\\n  <td>${{total_pretty}}</td>\\n  <td>\\n    {{#if charge.refunded}}\\n      <i class=\"fa fa-check-circle green\"></i> Refunded\\n    {{else}}\\n      {{#if paid}}\\n        <i class=\"fa fa-check green\"></i> Paid\\n      {{else}}\\n        {{#if next_payment_attempt}}\\n          <i class=\"fa fa-calendar\"></i> Scheduled {{next_payment_attempt_pretty}}\\n        {{else}}\\n          <i class=\"fa fa-minus-circle\"></i> Balance Due\\n        {{/if}}\\n      {{/if}}\\n    {{/if}}\\n  </td>\\n  <td>\\n    <a class=\"button details\" id=\"{{cid}}\">View details</a>\\n    {{#if printable_url}}<a href=\"{{printable_url}}\" class=\"button\" target=\"_new\">Print</a>{{/if}}\\n  </td>\\n</tr>\\n<tr class=\"invoice-details\" id=\"{{cid}}\">\\n  <td class=\"holders\" colspan=\"7\">\\n    <table class=\"table table-bordered\">\\n      <thead>\\n        <tr>\\n          <th>Date</th>\\n          <th>Amount</th>\\n          <th>Description</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each lines.invoiceitems}}\\n        <tr>\\n          <td>{{date_pretty}}</td>\\n          <td>${{amount_pretty}}</td>\\n          <td>{{description}}</td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"3\" class=\"center\">\\n            <div class=\"no-results\">No line item information available.</div>\\n          </td>\\n        </tr>\\n      {{/each}}\\n      </tbody>\\n    </table>\\n\\n    <table class=\"table table-bordered\">\\n      <thead>\\n        <tr>\\n          <th>Plan Name</th>\\n          <th>Amount</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each lines.subscriptions}}\\n        <tr>\\n          <td>{{plan.name}}</td>\\n          <td>${{plan.amount_pretty}}</td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"1\" class=\"center\">\\n            <div class=\"no-results\">No plan information available.</div>\\n          </td>\\n        </tr>\\n      {{/each}}\\n    </table>\\n  </td>\\n</tr>');window.JST[\"settings_settings_modal\"]=JST('<h2>{{title}}</h2>\\n<paramform></paramform>\\n<clear />\\n<div>\\n  <button class=\"submit orange\">{{#if button}}{{button}}{{else}}Save changes{{/if}}</button>\\n  <span class=\"feedback\"></span>\\n</div>');window.JST[\"settings_auths\"]=JST('<div class=\"row\">\\n  <div class=\"container shave\">\\n    <h1 class=\"history-header shave\">Connected Accounts</h1>\\n  </div>\\n</div>\\n\\n<div class=\"row\">\\n  <div class=\"container shave\">\\n\\n  <div class=\"auth-select\">\\n    <select id=\"add\" data-placeholder=\"Connect new account\" data-which=\"add\">\\n      <option></option> <!-- placeholder -->\\n      {{#each services}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n  </div>\\n\\n\\n  <div class=\"auth-select\">\\n    <select id=\"request\" data-placeholder=\"Request access to a new account via email\" data-which=\"request\">\\n      <option></option> <!-- placeholder -->\\n      {{#each services}}\\n      <option value=\"{{get this \"key\"}}\">{{call getName}}</option>\\n      {{/each}}\\n    </select>\\n  </div>\\n\\n  </div><!-- container -->\\n</div><!-- row -->\\n\\n<div class=\"row\">\\n  <div class=\"container\">\\n\\n    <table class=\"auths-table table table-striped\">\\n      <thead>\\n        <tr>\\n          <th>Service</th>\\n          <th>Connected</th>\\n          <th class=\"center\">Zaps</th>\\n          <th></th>\\n          <th></th>\\n          <th></th>\\n          <th></th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n      {{#each auths}}\\n        <tr data-id=\"{{this.id}}\">\\n          <td class=\"name\">\\n            <div class=\"service\">\\n              <div class=\"service-icon {{this.selected_api}}16x16\" title=\"{{appNameFromKey this.selected_api}}\"></div>\\n            </div>\\n            {{this.name}}\\n          </td>\\n          <td class=\"age\">{{this.prettyDate}}</td>\\n          <td class=\"used center\">{{this.used}}</td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller test\">Test</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller rename\">Rename</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller reconnect\">Reconnect</button>\\n          </td>\\n          <td>\\n            <button data-id=\"{{this.id}}\" class=\"light smaller disconnect\">Disconnect</button>\\n          </td>\\n        </tr>\\n      {{else}}\\n        <tr>\\n          <td colspan=\"7\" class=\"empty\">You don\\'t have any conncted accounts!</td>\\n        </tr>\\n      {{/each}}\\n      </tbody>\\n    </table>\\n\\n  </div><!-- container -->\\n</div><!-- row -->');window.JST[\"settings_base\"]=JST('<div class=\"row\">\\n   <div class=\"container shave\">\\n      <h1 class=\"shave\">Settings</h1>\\n   </div>\\n</div>\\n\\n<div class=\"row settings\">\\n  <div class=\"container\">\\n    <div class=\"column one-half\">\\n      <div class=\"my-account\"></div>\\n    </div>\\n    <div class=\"column one-half\">\\n      <div class=\"billing\"></div>\\n      <div class=\"extra\"></div>\\n    </div>\\n  </div>\\n</div>');window.JST[\"settings_my_account\"]=JST('<ul>\\n  <li>\\n    <h3><a href=\"#\" class=\"user\"><i class=\"fa fa-user\"></i> Your Profile</a></h3>\\n    <div class=\"profile-image\">\\n      <div class=\"picture-small\">\\n        <img src=\"https://secure.gravatar.com/avatar/{{ account.email_hash }}.jpg?s=50&amp;d=mm\" />\\n      </div>\\n      <a href=\"#\" class=\"user action\">Change profile image</a>\\n    </div>\\n    {{#if account.provider}}\\n      <p><em>You signed up with a sponsored account, which doesn\\'t have the ability to modify an account\\'s email address. Please contact support for help.</em></h3>\\n    {{else}}\\n      <p>{{account.email}} <a href=\"#\" class=\"account action\">Change email</a></p>\\n      <p>* * * * <span class=\"info-hidden\">(hidden)</span> <a href=\"#\" class=\"account action\">Change password</a></p>\\n    {{/if}}\\n    <p>{{account.first_name}} {{account.last_name}} <a href=\"#\" class=\"user action\">Change name</a></p>\\n    {{#if account.company_name}}\\n    <p>{{account.company_name}} <a href=\"#\" class=\"user action\">Change company name</a></p>\\n    {{else}}\\n    <p><a href=\"#\" class=\"user action left\">Add a company name</a></p>\\n    {{/if}}\\n    {{#notequals account.timezone \"-----\"}}\\n    <p>{{account.timezone}} <a href=\"#\" class=\"user action\">Change timezone</a></p>\\n    {{else}}\\n    <p><a href=\"#\" class=\"user action left\">Set your timezone</a></p>\\n    {{/notequals}}\\n  </li>\\n  <li>\\n    <h3><a href=\"#\" class=\"email\"><i class=\"fa fa-envelope\"></i> Notification Settings</a></h3>\\n    <p>Activity summary email: {{account.summary_schedule}} <a href=\"#\" class=\"email action\">Change</a></p>\\n    <p>Send alerts on failed trigger: {{account.alert_triggers}} <a href=\"#\" class=\"email action\">Change</a></p>\\n    <p>Send alerts on failed action: {{account.alert_actions}} <a href=\"#\" class=\"email action\">Change</a></p>\\n  </li>\\n</ul>');window.JST[\"common_form_checkbox_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"checkbox\"\\n  {{#if val}}checked=\"checked\"{{/if}}\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>\\n\\n<label for=\"{{key}}\">{{#if help_text_html}}{{{help_text_html}}}{{else}}{{help_text}}{{/if}}</label>');window.JST[\"common_form_select_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_unicode_prettypill_row\"]=JST('{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[0] cid=cid ccode=ccode}}</span>\\n{{/if}}\\n\\n<textarea\\n  data-id=\"{{key}}\"\\n  data-type=\"unicode\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"{{#if input_format}} flanked{{/if}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n>{{val}}</textarea>\\n\\n\\n{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[2] cid=cid ccode=ccode}}</span>\\n  <button class=\"copy-button\" data-clipboard-text=\"{{render input_format.[0] cid=cid ccode=ccode}}{{value}}{{render input_format.[2] cid=cid ccode=ccode}}\">Copy to clipboard</button>\\n{{/if}}');window.JST[\"common_form_unicode_row\"]=JST('{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[0] cid=cid ccode=ccode}}</span>\\n{{/if}}\\n\\n<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"{{#if input_format}} flanked{{/if}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n/>\\n\\n\\n{{#if input_format}}\\n  <span class=\"input-flanker\">{{render input_format.[2] cid=cid ccode=ccode}}</span>\\n  <button class=\"copy-button\" data-clipboard-text=\"{{render input_format.[2] cid=cid ccode=ccode}}\">Copy to clipboard</button>\\n{{/if}}');window.JST[\"common_form_prefill_empty_modal\"]=JST('<div class=\"prefill-error-modal\">\\n  <h2>{{sapi}} did not return any {{#plural}}{{sfield}}{{/plural}}</h2>\\n  <h3>What To Do Next</h3>\\n  <ol>\\n      <li>Log into {{sapi}} and create a new {{sfield}}</li>\\n      <li>Note: this field ({{#plural}}{{sfield}}{{/plural}}) may be filtered by fields above it</li>\\n      <li>Make sure you\\'ve followed all on-screen instructions in order</li>\\n      <li>Retry in a few seconds</li>\\n  </ol>\\n</div>');window.JST[\"common_form_prefill_error_modal\"]=JST('<div class=\"prefill-error-modal\">\\n  <h2>We received an error while accessing {{sapi}}</h2>\\n\\n  <pre class=\"error\">{{message}}</pre>\\n  <h3>What To Do Next</h3>\\n  <ol>\\n      <li>Make sure you complete fields in order they appear</li>\\n      <li>Make sure you\\'ve followed all on-screen instructions</li>\\n      <li>Retry in a few seconds</li>\\n      <li>Your {{sapi}} Account may not be working anymore, go back and test it</li>\\n  </ol>\\n</div>');window.JST[\"common_form_text_row\"]=JST('<textarea\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  class=\"multi-row\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n>{{val}}</textarea>');window.JST[\"common_form_upload_row\"]=JST('<div class=\"file-button-wrapper\">\\n   <span class=\"button\">Choose a file</span>\\n   <input\\n     data-id=\"{{key}}\"\\n     data-type=\"{{type}}\"\\n     data-input=\"true\"\\n     data-url=\"{{dataUrl}}\"\\n     name=\"image\"\\n\\n     {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n\\n     type=\"file\"\\n     autocomplete=\"off\"\\n\\n     {{#if disabled}}disabled=\"disabled\"{{/if}}\\n   />\\n</div>\\n\\n<div class=\"currently\">Currently: <a href=\"{{val}}\">{{val}}</a></div>\\n\\n<clear/>\\n');window.JST[\"common_form_confirmation_row\"]=JST('<a class=\"send-confirmation pill-button orange {{#if sentConfirmation}}hide{{/if}}\" data-id=\"{{key}}\">Send PIN</a>\\n\\n<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  class=\"input-confirmation {{#unless sentConfirmation}}hide{{/unless}} xlarge confirmation-width\"\\n  autocomplete=\"off\"\\n\\n  placeholder=\"Enter confirmation PIN\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_required_error\"]=JST(\"Please complete all required fields.\");window.JST[\"common_form_file_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"text\"\\n  value=\"{{val}}\"\\n  class=\"input-file\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>');window.JST[\"common_form_base_row\"]=JST('{{#unless hideLabel}}\\n<div class=\"label {{#if required}}required{{else}}not-required{{/if}}\">\\n  {{call model.getLabel context=model}}\\n  <span class=\"required-text\">{{#if required}}(required){{else}}(optional){{/if}}</span>\\n  <span class=\"extra\" data-extra=\"true\"></span></div>\\n  {{#if help_text_html}}\\n  <div class=\"helper\">{{{help_text_html}}}</div>\\n  {{else}}\\n  {{#if help_text}}<div class=\"helper\">{{help_text}}</div>{{/if}}\\n  {{/if}}\\n{{/unless}}\\n\\n<div class=\"input\">\\n  {{{row_html}}}\\n\\n  {{#if prefill}}<div class=\"fill-button {{#if busy}}busy{{/if}}\"></div>{{/if}}\\n\\n  {{#or choices givefill}}<div class=\"fill-button\"></div>{{/or}}\\n  \\n  {{#if userfill}}<div class=\"add-placeholder button\">Insert <span class=\"img16 {{#if userfillClass}}{{userfillClass}}{{else}}placeholder{{/if}}\"></span> fields</div>{{/if}}\\n\\n</div>\\n\\n\\n{{#if list}}\\n<div class=\"add-or-remove\">\\n  <div class=\"add\" title=\"Add or remove another field.\" data-id=\"{{key}}\"></div>\\n  <div class=\"remove\" title=\"Add or remove another field.\" data-id=\"{{key}}\"></div>\\n</div>\\n{{/if}}');window.JST[\"common_form_password_row\"]=JST('<input\\n  data-id=\"{{key}}\"\\n  data-type=\"{{type}}\"\\n  data-input=\"true\"\\n\\n  {{#if prefill}}data-prefill=\"{{prefill}}\"{{/if}}\\n  {{#if input_format}} placeholder=\"{{label}}\"{{/if}}\\n  {{#if placeholder}} placeholder=\"{{placeholder}}\"{{/if}}\\n\\n  type=\"password\"\\n  value=\"{{val}}\"\\n  autocomplete=\"off\"\\n\\n  {{#if disabled}}disabled=\"disabled\"{{/if}}\\n/>')}).call(this);"
      },
      "https://zapier.cachefly.net/static/CUEboR/build/app.js": {
         "pageUrl": "https://zapier.com/zapbook/gmail/",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEboR/build/app.js",
         "body": "window.z={};z.cfg={};z.model={};z.ui={};z.controllers={};z.app={};z.jst={};z.useful={};z.store={};z.tests=window.tests;z.cfg.api=\"/api/v2\";z.cfg.newapi=\"/api/v2\";z.cfg.devapi=\"/api/developer/v1\";z.cfg.devpath=\"developer/v2/builder\";if(typeof DEBUG!==\"undefined\"&&DEBUG!==null)z.cfg.debug=DEBUG;if(typeof mediaUrl!==\"undefined\"&&mediaUrl!==null){z.cfg.mediaURL=mediaUrl}if(typeof path!==\"undefined\"&&path!==null)z.cfg.path=path;z.cfg.hasPushState=window.history.pushState!=null;if(typeof STRIPE_PUB_API_KEY!==\"undefined\"&&STRIPE_PUB_API_KEY!==null){z.cfg.stripePubApiKey=STRIPE_PUB_API_KEY}z.cfg.pubSub={};_.extend(z.cfg.pubSub,Backbone.Events);if(typeof TITLE_APPEND!==\"undefined\"&&TITLE_APPEND!==null){z.cfg.title=TITLE_APPEND}z.cfg.cursorLoadAnimTimeout=0;z.cfg.location=window.location;z.cfg.defaultSupportTags=\"default\";z.useful.pluralize=typeof owl!==\"undefined\"&&owl!==null?owl.pluralize:void 0;z.cfg.userfillOTag=\"{{\";z.cfg.userfillETag=\"}}\";if(typeof PARTNER_ENVIRONMENT!==\"undefined\"&&PARTNER_ENVIRONMENT!==null){z.cfg.partner=PARTNER_ENVIRONMENT}window.$(document).ready(function(){var $el,csrfSafeMethod,invalidatePersist,loadModels,postSizeEvents,sameOrigin,start,track,url,_this=this;if(!$.cookie(\"csrftoken\")){$.ajax(\"\"+z.cfg.api+\"/csrf\",{success:function(){var csrf;csrf=$.cookie(\"csrftoken\");z.cfg.renderContext.csrf=csrf;return $('input[name=\"csrfmiddlewaretoken\"]',document).val(csrf)}})}csrfSafeMethod=function(method){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(method)};sameOrigin=function(url){var host,origin,protocol,sr_origin;host=document.location.host;protocol=document.location.protocol;sr_origin=\"//\"+host;origin=protocol+sr_origin;return url===origin||url.slice(0,origin.length+1)===origin+\"/\"||url===sr_origin||url.slice(0,sr_origin.length+1)===sr_origin+\"/\"||!/^(\\/\\/|http:|https:).*/.test(url)};window.$(document).ajaxSend(function(event,xhr,settings){if(!csrfSafeMethod(settings.type)&&sameOrigin(settings.url)){return xhr.setRequestHeader(\"X-CSRFToken\",$.cookie(\"csrftoken\"))}});_.extend(z.app,Backbone.Events);z.cfg.browser=window.BrowserDetect.browser;z.cfg.isMobile=window.mobilecheck(0);z.cfg.renderContext={mediaURL:z.cfg.mediaURL,csrf:$.cookie(\"csrftoken\"),path:z.cfg.path,devpath:z.cfg.devpath,tests:z.tests};_.mixin(_.str.exports());_.str.include(\"Underscore.string\",\"string\");z.stripe=window.Stripe;z.stripe.setPublishableKey(z.cfg.stripePubApiKey);_.templateSettings={interpolate:/\\{\\{(.+?)\\}\\}/g};if(window.JST!=null)z.jst=window.JST;z.useful.clipboard=window.ZeroClipboard;z.useful.clipboard.setDefaults({moviePath:\"\"+z.cfg.mediaURL+\"images/flash/ZeroClipboard.swf\",trustedOrigins:[window.location.protocol+\"//\"+window.location.host],hoverClass:\"hover\",activeClass:\"active\",allowScriptAccess:\"always\"});$(\"img.retina\").retina();$(\".video\").loadYoutubeVideo();$el=$(z.useful.render(JST.common_login_modal({}))).addClass(\"hide\");$el.appendTo($(\"body\"));if(typeof preload!==\"undefined\"&&preload!==null?preload.account:void 0){url=_.result(z.model.Account.prototype,\"url\");Backbone.cache.set(url,typeof preload!==\"undefined\"&&preload!==null?preload.account:void 0);url=_.result(z.model.AccountLimits.prototype,\"url\");Backbone.cache.set(url,typeof preload!==\"undefined\"&&preload!==null?preload.account.limits:void 0)}z.app.errorHandler=new z.model.ErrorHandler;z.app.track=new z.model.Track;z.app.simple=new z.controllers.Simple;z.app.home=new z.controllers.Home;z.app.server=new z.controllers.Server;z.app.dashboard=new z.controllers.Dashboard;z.app.editor=new z.controllers.Editor;z.app.explore=new z.controllers.Explore;z.app.pricing=new z.controllers.Pricing;z.app.signup=new z.controllers.SignUp;z.app.zapbook=new z.controllers.Zapbook;z.app.status=new z.controllers.Status;z.app.settings=new z.controllers.Settings;z.app.history=new z.controllers.History;z.app.support=new z.controllers.Support;z.app.sharedzaps=new z.controllers.SharedZaps;z.app.developer=new z.controllers.Developer;z.app.topbar=new z.ui.TopBar({el:$(\".topbar\")});z.app.viewport=new z.ui.Viewport({el:$(\"body\")});z.app.support.view=new z.ui.Support({el:$(\"#support\")});z.app.preloader=new z.ui.Preloader({el:$(\"#app\")});z.app.partner=new z.model.Partner(z.cfg.partner);window.partnerChecks(window.location.pathname);if(z.app.partner.isPartnerSession()){postSizeEvents=function(){return _.defer(function(){var e,_ref;if(z.app.partner.hasIframeJs){e={event:\"resize\",height:$(\"body\").outerHeight(),width:$(\"body\").outerWidth()};return(_ref=window.top)!=null?_ref.postMessage(JSON.stringify(e),\"*\"):void 0}})};z.app.on(\"render\",postSizeEvents)}loadModels=function(cb){var _this=this;return async.parallel({account:async.fetch(new z.model.Account),accountLimits:async.fetch(new z.model.AccountLimits)},function(err,models){_.extend(z.app,models);if(err!=null)log(\"error: \",err,models);if(z.app.account.id!=null){$(\"#header .logo a\").attr(\"data-nav\",\"app/dashboard\")}z.app.topbar.render();z.app.support.view.render();return typeof cb===\"function\"?cb():void 0})};invalidatePersist=function(cb){var _this=this;return Backbone.cache.lawnchair.get(\"user\",function(obj){var callback,id;id=obj!=null?obj.id:void 0;callback=function(){return cb()};if(z.app.account.id!=null&&id!=null&&z.app.account.id!==id){return async.parallel([function(cb){return Backbone.cache.clear(\"user\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/account\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/read\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/write\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/stream\",cb,true)}],function(err,results){return Backbone.cache.set(null,null,callback,false,{key:\"user\",id:z.app.account.id})})}else if(z.app.account.id!=null){return async.parallel([function(cb){return Backbone.cache.clear(\"user\",cb,true)}],function(err,results){return Backbone.cache.set(null,null,callback,false,{key:\"user\",id:z.app.account.id})})}else{return typeof cb===\"function\"?cb():void 0}},true)};start=function(cb){var found;found=Backbone.history.start({hashChange:false,pushState:true,root:\"/\"});log(\"global environment `z`: \",z);if(!found&&_.str.startsWith(Backbone.history.fragment,\"app/\")){z.useful.goto(\"/404\")}return typeof cb===\"function\"?cb():void 0};track=function(cb){var cookie,count,haystack,name,referrer,route;haystack=window.location.pathname;referrer=document.referrer;name=\"zapier-visit\";cookie=z.store.get(name);if(!(cookie!=null)){z.store.set(name,\"true\");z.app.track[\"new\"](\"Visit Zapier (all)\",{referrer:referrer})}name=\"zapier-landing\";cookie=z.store.get(name);if(!(cookie!=null)){count=haystack.split(\"/\").length-1;if(count===0){route=\"home\"}else if(count===1){route=\"home\"}else if(_.str.include(haystack,\"zapbook\")&&count===2){route=\"zb no service\"}else if(_.str.include(haystack,\"zapbook\")&&count===3){route=\"zb one service\"}else if(_.str.include(haystack,\"zapbook\")&&count===4){route=\"zb two service\"}else if(_.str.include(haystack,\"zapbook\")&&count===5){route=\"zb recipe\"}else if(_.str.include(haystack,\"zapbook\")&&count===6){route=\"zb recipe\"}else{route=\"other\"}if(route!=null){z.store.set(name,\"true\");return z.app.track[\"new\"](\"Landing Page: \"+route,{path:haystack,referrer:referrer})}}};return async.series([loadModels,invalidatePersist,start,track])});var $,methods;$=jQuery;methods={insert:function(value){var after,before,o,pos;o=this[0];pos=methods[\"getCaretPosition\"].apply(this);before=o.value.substring(0,pos);after=o.value.substring(pos,o.value.length);$(o).val(before+value+after);pos+=value.length;methods[\"setCaretPosition\"].apply(this,[pos]);return pos},getCaretPosition:function(){var caretPos,o,sel;o=this[0];caretPos=0;if(document.selection){o.focus();sel=document.selection.createRange();sel.moveStart(\"character\",-o.value.length);caretPos=sel.text.length}else if(o.selectionStart||o.selectionStart===\"0\"){caretPos=o.selectionStart}return caretPos},setCaretPosition:function(pos){var f,o,_this=this;o=this[0];if(o.setSelectionRange){o.focus();return o.setSelectionRange(pos,pos)}else if(o.createTextRange){f=function(){return o.focus()};setTimeout(f,10);f=function(o,pos){var range;range=o.createTextRange();range.collapse(true);range.moveEnd(\"character\",pos);range.moveStart(\"character\",pos);return range.select()};setTimeout(function(){return f(o,pos)},20);return pos}}};$.fn.atCaret=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method===\"object\"||!method){return methods.init.apply(this,arguments)}else{return $.error(\"Method \"+method+\" does not exist on jQuery.atCaret\")}};z.store={length:function(){return window.localStorage.length},remove:_.bind(window.localStorage.removeItem,window.localStorage),clear:_.bind(window.localStorage.clear,window.localStorage),get:function(key){var expire,getItem,item,val;getItem=_.bind(window.localStorage.getItem,window.localStorage);item=getItem(key);try{item=JSON.parse(item);expire=item[0];try{val=JSON.parse(item[1])}catch(e){val=val}if(expire<(new Date).getTime()){val=null;z.store.remove(key)}}catch(e){val=null}return val},set:function(key,val,options){var expire,setItem;if(options==null)options={};expire=options!=null?options.expire:void 0;if(!(expire!=null))expire=1e3*60*60*24*365*100;expire+=(new Date).getTime();if(_.isObject(val))val=JSON.stringify(val);setItem=_.bind(window.localStorage.setItem,window.localStorage);return setItem(key,JSON.stringify([expire,val]))}};var getValue,indexedDBValid,methodMap,_this=this;if(!((typeof Backbone!==\"undefined\"&&Backbone!==null?Backbone.sync:void 0)!=null)){throw\"Backbone not ready yet\"}Backbone.cache={};Backbone.cache.store={};Backbone.cache.queue={};Backbone.cache.pending={};Backbone.cache.persistPending=0;Backbone.cache.lawnchair=new Lawnchair({},function(){});indexedDBValid=function(callback){var idb,request;try{idb=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB;if(!idb)return callback(false);if(!idb)return callback(false);request=idb.open(\"test\",3);request.onsucess=function(){return callback(true)};request.onerror=function(){return callback(false)};return request.get(\"test\",function(){})}catch(e){return callback(false)}};indexedDBValid(function(valid){var adapters;if(!valid){log(\"* Falling back to not using indexed-db adapater (is not available)\");adapters=_.filter(Lawnchair.adapters,function(adpt){return adpt.adapter!==\"indexed-db\"});adapters=_.map(adapters,function(adpt){return adpt.adapter});return Backbone.cache.lawnchair=new Lawnchair({adapter:adapters},function(){})}});_.extend(Backbone.cache,Backbone.Events);Backbone.cache.defaults={expiry:10*60*1e3};Backbone.cache.sync=Backbone.sync;methodMap={create:\"POST\",update:\"PUT\",\"delete\":\"DELETE\",read:\"GET\",patch:\"PATCH\"};getValue=function(object,prop){if(!(object!=null)||!(object[prop]!=null))return null;if(_.isFunction(object[prop]))return object[prop]();return object[prop]};Backbone.cache.set=function(key,resp,cb,noPersist,json){var error,message;if(noPersist==null)noPersist=false;if(json==null)json=null;key=_.str.trim(key);if(!(json!=null)){json={key:key,resp:resp}}if(key!=null)Backbone.cache.store[key]=json;try{if(!noPersist)return Backbone.cache.lawnchair.save(json,cb)}catch(e){message=\"CAUGHT: \"+e;error={message:message,url:window.path,linenumber:null,trace:null};return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:error}),url:z.cfg.api+\"/events/errors\",contentType:\"application/json\",dataType:\"json\"})}};Backbone.cache.get=function(key,cb,persist){key=_.str.trim(key);if(persist){if(key===\"all\"){return Backbone.cache.lawnchair.all(cb)}else{return Backbone.cache.lawnchair.get(key,cb)}}else{if(key===\"all\"){return typeof cb===\"function\"?cb(Backbone.cache.store):void 0}else{return typeof cb===\"function\"?cb(Backbone.cache.store[key]):void 0}}};Backbone.cache.clear=function(key,cb,persist,loose){if(loose==null)loose=true;key=_.str.trim(key);return Backbone.cache.get(\"all\",function(all){var deletes,filtered,item,_i,_len,_this=this;filtered=_.filter(all,function(item){if(loose){return _.str.include(item!=null?item.key:void 0,key)}else{return(item!=null?item.key:void 0)===key}});deletes=[];for(_i=0,_len=filtered.length;_i<_len;_i++){item=filtered[_i];deletes.push(function(cb){return Backbone.cache.lawnchair.remove(item.key,cb)});delete Backbone.cache.store[item.key]}return async.parallel(deletes,function(err,results){return typeof cb===\"function\"?cb():void 0})},persist)};Backbone.sync=function(method,model,options){var bc,cUrl,clearing,copyOptions,loose,type,url,_ref;if(options==null)options={};copyOptions=_.clone(options);type=methodMap[method];url=options.url!=null?options.url:getValue(model,\"url\");loose=options.loose;if(type===\"GET\"&&url!=null&&(options!=null?options.data:void 0)!=null&&!_.isEmpty(options!=null?options.data:void 0)){url+=_.str.include(url,\"?\")?\"&\":\"?\";url+=$.param(options.data)}if(options.cache===false||_.contains([\"PUT\",\"POST\",\"PATCH\",\"DELETE\"],type)){if(!options.persist){clearing=true;bc=options.cache===false?\"cache=false\":type;log(\"  clearing cache b/c \"+bc,url);if(url!=null)Backbone.cache.clear(url,null,null,loose);if(_.contains([\"DELETE\",\"PUT\"],type)&&(model!=null?(_ref=model.collection)!=null?_ref.url:void 0:void 0)!=null){cUrl=getValue(model.collection,\"url\");log(\"  also clearing cache b/c coll\",cUrl);Backbone.cache.clear(cUrl,null,null,loose)}if(options.cache!=null)delete options.cache}}return Backbone.cache.get(url,function(obj){var error,pending,queue,success,_ref2,_this=this;if(_.contains([\"GET\"],type)){if(obj!=null&&!clearing){log(\"+ from cache:\",url);options.success(model,obj.resp,options);if(options.persist){_.defer(function(){log(\"~ backgrounding real request\",url);copyOptions.cache=true;copyOptions.persist=false;copyOptions.update=true;copyOptions.success=function(){log(\"~~ background synced\",url);Backbone.cache.persistPending-=1;if(Backbone.cache.persistPending===0){return Backbone.cache.trigger(\"synced\")}};copyOptions.error=function(){Backbone.cache.persistPending-=1;if(Backbone.cache.persistPending===0){return Backbone.cache.trigger(\"synced\")}};Backbone.cache.persistPending+=1;if(Backbone.cache.persistPending===1){Backbone.cache.trigger(\"syncing\")}copyOptions.headers=_.extend({},copyOptions!=null?copyOptions.headers:void 0,{\"X-Can-304\":true});return model.fetch(copyOptions)})}model.trigger(\"sync\",model,obj.resp,options);return}if((pending=Backbone.cache.pending[url])!=null){pending.unshift({method:method,model:model,options:options});return}success=options!=null?options.success:void 0;options.success=function(model,resp,opts){var item,_ref2,_ref3;Backbone.cache.set(url,resp,function(){},model.noPersist);opts.success=success;pending=(_ref2=Backbone.cache.pending[url])!=null?_ref2:[{method:method,model:model,options:opts}];_.each(pending,function(item){var _base;return typeof(_base=item.options).success===\"function\"?_base.success(item.model,resp,item.options):void 0});delete Backbone.cache.pending[url];item=(_ref3=Backbone.cache.queue[url])!=null?_ref3.shift():void 0;if(item!=null){model.set(item.json);return Backbone.sync(method,model,item.options)}};error=options!=null?options.error:void 0;options.error=function(model,resp,opts){var item,_ref2,_ref3;opts.error=error;pending=(_ref2=Backbone.cache.pending[url])!=null?_ref2:[{method:method,model:model,options:opts}];_.each(pending,function(item){var _base;return typeof(_base=item.options).error===\"function\"?_base.error(item.model,resp,item.options):void 0});delete Backbone.cache.pending[url];item=(_ref3=Backbone.cache.queue[url])!=null?_ref3.shift():void 0;if(item!=null){model.set(item.json);return Backbone.sync(method,model,item.options)}}}if(_.contains([\"PUT\"],type)){if((pending=Backbone.cache.pending[url])!=null){queue=(_ref2=Backbone.cache.queue[url])!=null?_ref2:[];queue.push({options:options,json:model.toJSON()});Backbone.cache.queue[url]=queue;log(\"? locking request for later\",url);return}}log(\"- \"+type+\" request:\",url);return Backbone.cache.sync(method,model,options)},options!=null?options.persist:void 0)};_.mixin({compactObject:function(obj){_.each(obj,function(v,k){if(!v)return delete obj[k]});return obj},superHumanize:function(string){var humanize,out,subs,words;humanize=function(str){return _.str.capitalize(_.str.underscored(str).replace(/_/g,\" \"))};out=_.str.titleize(humanize(string));words=_.str.words(out);subs={Url:\"URL\",Uri:\"URI\",Html:\"HTML\",Id:\"ID\",id:\"ID\"};_.each(subs,function(v,k){var index;index=words.indexOf(k);if(index!==-1)return words[index]=v});return words.join(\" \")},wordenshtein:function(str1,str2){str1=str1.toLowerCase().replace(/[^\\w ]/g,\" \");str1=_.str.words(str1).sort().join(\" \");str2=str2.toLowerCase().replace(/[^\\w ]/g,\" \");str2=_.str.words(str2).sort().join(\" \");return _.str.levenshtein(str1,str2)},flattenObj:function(input,splitter){var flatObject,k,output,x;if(splitter==null)splitter=\"__\";output={};for(k in input){if(!input.hasOwnProperty(k))continue;if(typeof input[k]===\"object\"){flatObject=this.flattenObj(input[k],splitter);for(x in flatObject){if(!flatObject.hasOwnProperty(x))continue;output[k+splitter+x]=flatObject[x]}}else{output[k]=input[k]}}return output},unflatten:function(input,splitter){var k,key,output,part,parts,t;if(splitter==null)splitter=\"__\";output={};for(k in input){t=output;parts=k.split(splitter);key=parts.pop();while(parts.length){part=parts.shift();t=t[part]=t[part]||{}}t[key]=input[k]}return output}});var $;$=jQuery;$.fn.extend({setMode:function(state,group){var mode,re;group=group||\"mode\";re=new RegExp(\"\\\\w+_\"+group+\"(\\\\s|$)\",\"g\");mode=!(state!=null)?\"\":state+\"_\"+group;this.each(function(){return this.className=(this.className.replace(re,\"\")+\" \"+mode).replace(/\\s\\s/g,\" \")});return mode},hasMode:function(state,group){var has,mode,re;group=group||\"mode\";re=new RegExp(\"\\\\w+_\"+group+\"(\\\\s|$)\",\"g\");mode=!(state!=null)?\"\":state+\"_\"+group;has=$(this).hasClass(mode);return has}});$.fn.retina=function(retina_part){var settings;settings={retina_part:\"@2x\"};if(retina_part){jQuery.extend(settings,{retina_part:retina_part})}if(window.devicePixelRatio>=2){this.each(function(index,el){var checkForRetina,new_image_src;el=$(el);if(!el.attr(\"src\"))return;checkForRetina=new RegExp(\"(.+)(\"+settings[\"retina_part\"]+\"\\\\.\\\\w{3,4})\");if(checkForRetina.test(el.attr(\"src\")))return;new_image_src=el.attr(\"src\").replace(/(.+)(\\.\\w{3,4})$/,\"$1\"+settings[\"retina_part\"]+\"$2\");return $.ajax({url:new_image_src,type:\"HEAD\",success:function(){el.attr(\"height\",el.height());el.attr(\"width\",el.width());return el.attr(\"src\",new_image_src)}})})}return this};$.fn.loadYoutubeVideo=function(){var t,youtubeId;t=$(this);youtubeId=t.attr(\"data-youtubeid\");t.on(\"click\",function(){t.removeClass(\"video\");return t.html('<iframe class=\"\" width=\"460\" height=\"259\" src=\"https://www.youtube.com/embed/'+youtubeId+'?rel=0&amp;wmode=transparent&amp;showinfo=0&amp;theme=light&amp;autohide=1&amp;autoplay=1\" frameborder=\"0\" allowfullscreen></iframe>')});return this};var __slice=Array.prototype.slice;Handlebars.registerHelper(\"render\",function(templateString,options){var c,rendered;if(!(templateString!=null))return;c=_.extend({},options!=null?options.hash:void 0,options!=null?options.hash.context:void 0);rendered=Handlebars.compile(templateString)(c);return rendered});Handlebars.registerHelper(\"JST\",function(name,options){var rendered,_ref;rendered=JST[name](options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0);return new Handlebars.SafeString(rendered)});Handlebars.registerHelper(\"slugify\",function(string){return _.str.slugify(string)});Handlebars.registerHelper(\"try\",function(){var options,tries,value,_i,_this=this;tries=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.find(tries,function(each,i){value=_.result(tries,i);if(value!=null&&value!==\"\")return true});if(!(value!=null))value=_.last(tries);value=_.result([value],0);return value});Handlebars.registerHelper(\"filter\",function(array,filter,options){var buffer,context,render,_ref,_this=this;buffer=\"\";if(array instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;array=array.apply(context,null)}if((array!=null?array.length:void 0)>0){render=function(each){if(context=filter(each))return buffer+=options.fn(context)};if(array instanceof Backbone.Collection){array.each(function(each){return render(each)})}else if(array instanceof Array){_.each(array,function(each){return render(each)})}return buffer}else{return options.inverse(this)}});Handlebars.registerHelper(\"each\",function(array,options){var buffer,context,count,max,meta,renderArray,renderHash,_ref,_ref2,_this=this;buffer=\"\";count=0;max=options!=null?(_ref=options.hash)!=null?_ref.max:void 0:void 0;meta=function(each){if(count%2===0)each._even=true;if(count%2!==0)each._odd=true;each._idx=count;count=count+1;return each};renderArray=function(each){each=meta(each);if(max!=null&&count>max)return;return buffer+=options.fn(each)};renderHash=function(value,key){var each;each={key:key,value:value};each=meta(each);if(max!=null&&count>max)return;return buffer+=options.fn(each)};if(array instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;array=array.apply(context,null)}if(array instanceof Backbone.Collection&&(array!=null?array.length:void 0)>0){array.each(function(each){return renderArray(each)})}else if(array instanceof Array&&(array!=null?array.length:void 0)>0){_.each(array,function(each){return renderArray(each)})}else if(array instanceof Object){_.each(array,function(val,key){return renderHash(val,key)})}if(buffer!==\"\")return buffer;return options.inverse(this)});Handlebars.registerHelper(\"paginate\",function(coll,options){var buffer,onCurrentPage,render,_this=this;buffer=\"\";onCurrentPage=function(index,page,perPage){if((page-1)*perPage<=index&&index<page*perPage)return true;return false};render=function(each,index){var page,perPage;page=coll.frontendPagination.page;if(!(page!=null))page=1;perPage=coll.frontendPagination.perPage;if(!(perPage!=null))perPage=100;if(onCurrentPage(index,page,perPage))return buffer+=options.fn(each)};if((coll!=null?coll.length:void 0)>0?coll instanceof Backbone.Collection:void 0){coll.each(function(each,idx){return render(each,idx)})}if(buffer!==\"\")return buffer;return options.inverse(this)});Handlebars.registerHelper(\"log\",function(thing){log(\"(from template): \",thing);return\"\"});Handlebars.registerHelper(\"get\",function(model,key,options){var context,_ref,_ref2;context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;return model!=null?(_ref2=model.get)!=null?_ref2.call(context,key):void 0:void 0});Handlebars.registerHelper(\"call\",function(){var args,context,func,options,_i,_ref;func=arguments[0],args=3<=arguments.length?__slice.call(arguments,1,_i=arguments.length-1):(_i=1,[]),options=arguments[_i++];context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;return func!=null?func.apply(context,args):void 0});Handlebars.registerHelper(\"humanize\",function(string,key,options){return _.str.humanize(string)});Handlebars.registerHelper(\"ellipsis\",function(max,options){var string;string=options.fn(this);string=_.truncate(string,max,\"...\");return string});Handlebars.registerHelper(\"plural\",function(options){var plural,string,_ref;string=options.fn(this);plural=z.useful.pluralize(string.toLowerCase(),(_ref=options.hash)!=null?_ref.count:void 0);return plural});Handlebars.registerHelper(\"article\",function(options){var article,letter,string,v,vowel,vowels,_i,_len,_ref;string=options.fn(this);vowels=[\"a\",\"e\",\"i\",\"o\",\"u\"];vowel=false;letter=string.toLowerCase()[0];for(_i=0,_len=vowels.length;_i<_len;_i++){v=vowels[_i];if(letter===v)vowel=true}if(vowel)article=\"an \";if(!vowel)article=\"a \";if((_ref=options.hash)!=null?_ref.capitalize:void 0){article=_.str.capitalize(article)}return article+string});Handlebars.registerHelper(\"if\",function(value,options){var context,_ref;if(value instanceof Handlebars.SafeString)value=value.string;if(value instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value=value.apply(context,null)}value=Boolean(value);if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"unless\",function(value,options){var context,_ref;if(value instanceof Handlebars.SafeString)value=value.string;if(value instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value=value.apply(context,null)}value=Boolean(value);if(value!=null&&value){return options.inverse(this)}else{return options.fn(this)}});Handlebars.registerHelper(\"and\",function(){var ands,options,value,_i,_this=this;ands=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.all(ands,function(each,i){var context,_ref;if(each instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||_this;each=each.apply(context,null)}if(each!=null&&each)return true});if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"neither\",function(){var neithers,options,value,_i,_this=this;neithers=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.all(neithers,function(each,i){value=_.result(neithers,i);if(value!=null&&!value)return true});if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"or\",function(value1,value2,options){var context,_ref,_ref2;if(value1 instanceof Handlebars.SafeString)value1=value1.string;if(value2 instanceof Handlebars.SafeString)value2=value2.string;if(value1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value1=value1.apply(context,null)}if(value2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;value2=value2.apply(context,null)}if(value1!=null&&value1||value2!=null&&value2){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"hasAtLeastOne\",function(object,options){var context,_ref;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if(object instanceof Backbone.Collection&&(object!=null?object.length:void 0)>0){return options.fn(this)}else if(object instanceof Array&&(object!=null?object.length:void 0)>0){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"range\",function(number,options){var buffer,i,_ref;buffer=\"\";for(i=1,_ref=Number(number)+1;1<=_ref?i<_ref:i>_ref;1<=_ref?i++:i--){buffer+=options.fn(_.extend(this,{i:i}))}return buffer});Handlebars.registerHelper(\"hasExactly\",function(object,count,options){var context,_ref;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if(object instanceof Backbone.Collection&&(object!=null?object.length:void 0)===count){return options.fn(this)}else if(object instanceof Array&&(object!=null?object.length:void 0)===count){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"equals\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(val1===val2||String(val1)===String(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"notequals\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(val1!==val2&&String(val1)!==String(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"greater\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(Number(val1)>Number(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"less\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(Number(val1)<Number(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"contains\",function(haystack,needle,options){var context,_ref,_ref2;if(haystack instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;haystack=haystack.apply(context,null)}if(needle instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;needle=needle.apply(context,null)}if(_.isArray(haystack)){if(_.any(haystack,function(each){return each===needle})){return options.fn(this)}else{return options.inverse(this)}}if(_.isString(haystack)){if(_.str.include(haystack,needle)){return options.fn(this)}else{return options.inverse(this)}}});Handlebars.registerHelper(\"count\",function(object,options){var context,filtered,_ref,_ref2;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if((options!=null?(_ref2=options.hash)!=null?_ref2.filter:void 0:void 0)!=null){filtered=_.filter(object,function(each){return options!=null?options.hash.filter(each):void 0})}else{filtered=object}if(filtered!=null)return filtered.length;return\"0\"});Handlebars.registerHelper(\"appNameFromKey\",function(key){var s;s=z.app.services.get(key);if((s!=null?s.getName:void 0)!=null)return s.getName();return\"\"});Handlebars.registerHelper(\"prettyISO\",function(string){return z.useful.prettyISO(string)});Handlebars.registerHelper(\"toDollars\",function(int){var cents,dollars;int=Number(int);if(int>0){dollars=Math.floor(int/100)}else if(int<0){dollars=Math.ceil(int/100)}else{dollars=0}cents=\"0\"+(int-dollars*100);return dollars+\".\"+cents.substr(cents.length-2)});Handlebars.registerHelper(\"copyOverride\",function(service,action,which,copy,options){var override;override=service!=null?service.getCopyOverride(action,which,copy):void 0;if(override!=null)return override;return options.fn(this)});var useful,__indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};useful={QueryString:function(){function _Class(queryString){var pair,_ref;this.queryString=queryString;this.queryString||(this.queryString=(_ref=window.document.location.search)!=null?_ref.substr(1):void 0);this.pairs=Array();this.object={};if(__indexOf.call(this.queryString,\"=\")>=0){this.variables=this.queryString.split(\"&\");this.pairs=function(){var _i,_len,_ref2,_results;_ref2=this.variables;_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++){pair=_ref2[_i];_results.push(pair.split(\"=\"))}return _results}.call(this);this.object=_.object(this.pairs||Array())}}return _Class}(),prettyISO:function(string){var dt;dt=new Date(string);return dt.toLocaleDateString()+\" \"+dt.toLocaleTimeString()},summarize:function(data,max){var pos,s;\nif(max==null)max=50;if(!(data!=null)||data.length<max)return data;pos=Math.round(data.length/2)-Math.round(max/2);s=String(data).substr(pos,max).replace(/(\\r\\n|\\n|\\r)/gm,\"\");data=\"... \"+s+\" ...\";return data},whatPage:function(haystack,needle,perPage){var idx;idx=1;_.each(haystack,function(each,i){if(each===needle)return idx=i+1});return Math.ceil(idx/perPage)},maxPage:function(haystack,perPage){return Math.ceil(haystack.length/perPage)},errors:function(xhr){var body,error,_ref,_ref2,_ref3;try{body=JSON.parse(xhr.responseText);error=(body!=null?(_ref=body.error)!=null?_ref.join(\" \"):void 0:void 0)||(body!=null?(_ref2=body.errors)!=null?_ref2.join(\" \"):void 0:void 0)}catch(_error){}if(!error){if(xhr.status!=null&&xhr.statusText!=null){error=xhr.status+\": \"+xhr.statusText}else{error=(_ref3=xhr.responseText)!=null?_ref3.substring(0,150):void 0}}return error},open:function(url,target,options){var win;if(target==null)target=\"_blank\";win=typeof window!==\"undefined\"&&window!==null?window.open(url,target,options):void 0;win.focus();return win},\"goto\":function(url){return typeof window!==\"undefined\"&&window!==null?window.location.href=url:void 0},template:function(templateString){var _this=this;return function(){var context;if(arguments[0]===false)return templateString;z.app.trigger(\"render\");context=_.defaults({},z.cfg.renderContext,{z:z},arguments[0]);return z.useful.render(templateString,context)}},render:function(templateString,context,options){var rendered;rendered=Handlebars.compile(templateString,options).call(this,context);return rendered},chunks:function(array,chunkSize){return[].concat.apply([],_.map(array,function(item,i){return i%chunkSize?[]:[array.slice(i,i+chunkSize)]}))},equalChunks:function(array,chunks){var chunked;chunked=this.chunks(array,Math.ceil(array.length/chunks));return[].concat.apply([],_.map(_.range(chunks),function(item,i){return[chunked[i]||[]]}))},markdown:function(string){var converter;converter=new Showdown.converter;return converter.makeHtml(string)},placeholders:function($el){var _this=this;return _.defer(function(){var _ref;return $el!=null?(_ref=$el.find(\"input, textarea\"))!=null?_ref.placeholder():void 0:void 0})},viewportSize:function(){var viewPortHeight,viewPortWidth;if(typeof window.innerWidth!==\"undefined\"){viewPortWidth=window.innerWidth;viewPortHeight=window.innerHeight}else if(typeof document.documentElement!==\"undefined\"&&typeof document.documentElement.clientWidth!==\"undefined\"&&document.documentElement.clientWidth!==0){viewPortWidth=document.documentElement.clientWidth;viewPortHeight=document.documentElement.clientHeight}else{viewPortWidth=document.getElementsByTagName(\"body\")[0].clientWidth;viewPortHeight=document.getElementsByTagName(\"body\")[0].clientHeight}return[viewPortWidth,viewPortHeight]},viewportScroll:function(){var scrollx,scrolly;scrollx=$(window).scrollLeft();scrolly=$(window).scrollTop();return[scrollx,scrolly]},elClippedByScreenBottom:function(el){var edges,offset,size,viewport;offset=$(el).offset();offset.left=offset.left-z.useful.viewportScroll()[0];offset.top=offset.top-z.useful.viewportScroll()[1];size={width:$(el).outerWidth(),height:$(el).outerHeight()};viewport=z.useful.viewportSize();edges=[];edges.push(offset.top+size.height>viewport[1]);return _.any(edges,function(edge){return edge})},squish:function(string){return string.replace(/\\s/g,\"\")},noBGScroll:function(el){z.useful.noBGScrollOff(el);return $(el).on(\"mousewheel DOMMouseScroll\",function(e){var scrollTo;scrollTo=null;if(e.type===\"mousewheel\"){scrollTo=e.originalEvent.wheelDelta*-1}else if(e.type===\"DOMMouseScroll\"){scrollTo=40*e.originalEvent.detail}if(scrollTo){e.preventDefault();return $(this).scrollTop(scrollTo+$(this).scrollTop())}})},noBGScrollOff:function(el){return el.off(\"mousewheel DOMMouseScroll\")},refreshChrome:function(options){var _this=this;return $.ajax(\"/chrome.html\",{success:function(html){var $dom,$footer,$header;$dom=$(\"<div>\").html(html);$header=$dom.find(\"#header\");$footer=$dom.find(\"#footer\");$(\"#header\").replaceWith($header);$(\"#footer\").replaceWith($footer);return options!=null?options.success.apply(_this,arguments):void 0},error:function(){return options!=null?options.error.apply(_this,arguments):void 0}})},orderRelative:function(fullSeries,partialSeries){var orderRelative,orderedFullSeries;orderedFullSeries=_.sortBy(fullSeries,function(){return arguments[0]});orderRelative=_.map(partialSeries,function(i){return _.indexOf(orderedFullSeries,i)});if(_.any(orderRelative,function(i){return i===-1})){return false}orderRelative=_.map(orderRelative,function(i){return i+1});return orderRelative},getUserTimezone:function(){return this._calculateTimeZone()+\"\"},_calculateTimeZone:function(){var daylightTimeOffset,dst,hemisphere,jan1,jan2,june1,june2,rightNow,stdTimeOffset,temp;rightNow=new Date;jan1=new Date(rightNow.getFullYear(),0,1,0,0,0,0);june1=new Date(rightNow.getFullYear(),6,1,0,0,0,0);temp=jan1.toGMTString();jan2=new Date(temp.substring(0,temp.lastIndexOf(\" \")-1));temp=june1.toGMTString();june2=new Date(temp.substring(0,temp.lastIndexOf(\" \")-1));stdTimeOffset=(jan1-jan2)/(1e3*60*60);daylightTimeOffset=(june1-june2)/(1e3*60*60);dst=void 0;if(stdTimeOffset===!daylightTimeOffset){hemisphere=stdTimeOffset-daylightTimeOffset;if(hemisphere>=0)stdTimeOffset=daylightTimeOffset}return this._convert(stdTimeOffset)},_convert:function(value){var displayHours,hours,mins,secs;hours=parseInt(value);value-=parseInt(value);value*=60;mins=parseInt(value);value-=parseInt(value);value*=60;secs=parseInt(value);displayHours=hours;if(hours===0){displayHours=\"00\"}else if(hours>0){displayHours=hours<10?\"+0\"+hours:\"+\"+hours}else{displayHours=hours>-10?\"-0\"+Math.abs(hours):hours}mins=mins<10?\"0\"+mins:mins;return parseInt(displayHours).toFixed(1)}};_.extend(z.useful,useful);window.JST=useful.template;async.fetch=function(model,options){return function(callback){return model.fetch({cache:(options!=null?options.cache:void 0)!=null?options.cache:true,persist:(options!=null?options.persist:void 0)!=null?options.persist:false,success:function(results){return callback(null,model)},error:function(err){if(options!=null?options.canFail:void 0){return callback(null,model)}else{return callback(err,model)}}})}};Backbone.View.prototype.setMode=function(mode,group,el){if(this.state.get(group)===mode&&!(el!=null))return;if(!(mode!=null))return;if(mode===true)mode=\"is\";if(mode===false)mode=\"not\";$(el||this.el).setMode(mode,group);if(!(el!=null))this.state.set(group,mode);return z.app.trigger(\"render\")};Backbone.View.prototype.hasMode=function(mode,group,el){return $(el||this.el).hasMode(mode,group)};Backbone.View.prototype._remove=Backbone.View.prototype.remove;Backbone.View.prototype.remove=function(){this.trigger(\"remove\");this.off();this.$el.off();this._remove();return this};Backbone.Events._on=Backbone.Events.on;Backbone.Events.on=function(events,callback,context){this._on.apply(this,arguments);if(_.isObject(context)&&context.listenTo!=null){context.listenTo.call(context,this,name,callback)}return this};Backbone.Events.listenTo=function(object,events,callback){var listeners=this._listeners||(this._listeners={});var id=object._listenerId||(object._listenerId=_.uniqueId(\"l\"));listeners[id]=object;return this};_.extend(Backbone.View.prototype,Backbone.Events);_.extend(Backbone.Model.prototype,Backbone.Events);_.extend(Backbone.Collection.prototype,Backbone.Events);_.extend(Backbone.Router.prototype,Backbone.Events);z.model.Base=Backbone.Model.extend({initialize:function(attrs,options){var _this=this;this.loaded=attrs!=null;this.once(\"sync\",function(){return _this.loaded=true});if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}if(attrs!=null)arguments[0]=this.parse(attrs);return Backbone.Model.prototype.initialize.apply(this,arguments)}});z.model.BaseSet=Backbone.Collection.extend({initialize:function(models,options){var _this=this;this.loaded=models!=null;this.once(\"sync\",function(){return _this.loaded=true});if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}if(models!=null&&_.any(models,function(model){return!(model instanceof Backbone.Model)})){arguments[0]=this.parse(models)}return Backbone.Collection.prototype.initialize.apply(this,arguments)},parse:function(response){return response.objects||response}});z.model.Store=Backbone.Collection.extend({retrieve:function(model,Model,strict){var found,id,v,_this=this;if(strict==null)strict=false;id=Number(model.id);v=this.find(function(v){if(id===v.get(\"id\")||!strict&&v.get(\"model\")instanceof Model){return true}});found=v!=null?v.get(\"model\"):void 0;if(found!=null&&found instanceof Backbone.Model){found.set(_.extend(found.toJSON(),model.toJSON()));if(model.collection!=null)found.collection=model.collection}return found},inject:function(model,Model){var v;v=new Backbone.Model({id:Number(model.id),Model:model,model:model});this.add(v);return v!=null?v.get(\"model\"):void 0}});z.model.Singleton=function(Model,options){var Singleton,construct,store;construct=function(){var child;child=function(args){return Model.apply(this,args)};child.prototype=Model.prototype;return function(args){return new child(args)}};Model.prototype.store=new z.model.Store;store=Model.prototype.store;return Singleton=function(){function Singleton(){var model,single;model=construct()(arguments);single=store.retrieve(model,Model,options!=null?options.strict:void 0)||store.inject(model,Model);return single}return Singleton}()};z.model.StrictSingleton=function(Model){return z.model.Singleton(Model,{strict:true})};z.model.PaginationSet=z.model.BaseSet.extend({initialize:function(attrs,options){var pagination,_this=this;z.model.BaseSet.prototype.initialize.apply(this,arguments);pagination=(options!=null?options.pagination:void 0)||{};pagination=_.defaults(pagination,{perPage:15,page:1,pages:void 0,total:void 0,prev:void 0,next:void 0});this.pagination=new z.model.Base(pagination);this.paginationStore=this.pagination.toJSON();return this.pagination.on(\"change reset\",function(){_this.paginationStore=_this.pagination.toJSON();return _this.fetch()},this)},parse:function(response){var pagination;if(_.isArray(response))return response;pagination={perPage:response.per_page,page:response.page,pages:response.pages,total:response.total,prev:response.prev_url,next:response.next_url};this.pagination.set(pagination,{silent:true});this.pagination.set({hasPrev:this.hasPrev(),hasNext:this.hasNext()},{silent:true});return response.objects},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,{per_page:this.pagination.get(\"perPage\"),page:this.pagination.get(\"page\")});return z.model.BaseSet.prototype.fetch.call(this,options)},serverPrev:function(options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([_.max([page-1,1]),pages]),options)},serverNext:function(options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([page+1,pages]),options)},serverPage:function(target,options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([_.max([target,1]),pages]),options)},serverPageReset:function(options){if(options==null)options={};return this.pagination.set(\"page\",1,options)},hasPrev:function(){return this.pagination.get(\"page\")>1},hasNext:function(){return this.pagination.get(\"page\")<this.pagination.get(\"pages\")},count:function(){var count,total;total=this.pagination.get(\"total\");count=total!=null?total:this.length;return count}});z.model.Node=z.model.Base.extend({initialize:function(attrs,options){},getService:function(){return z.app.services.get(this.get(\"selected_api\"))},serviceImageClass:function(key){var _ref;if(key==null)key=\"32x32\";return(_ref=this.getService(z.app.services))!=null?_ref.getImageClass(key):void 0},serviceImageStyle:function(key){var _ref;if(key==null)key=\"32x32\";return(_ref=this.getService(z.app.services))!=null?_ref.getImageStyle(key):void 0},getParams:function(){return this.get(\"params\")},needsAuth:function(){var needsAuth,upfronts,_ref;upfronts=(_ref=z.app.services.get(this.get(\"selected_api\")))!=null?_ref.get(\"upfront_fields\"):void 0;needsAuth=upfronts!=null&&upfronts.length>0?true:false;return needsAuth},hasAuth:function(){if(!this.needsAuth())return true;if(this.needsAuth()&&this.get(\"authentication_id\")!=null)return true},isRead:function(){return this.get(\"write_ids\")!=null},isWrite:function(){return this.get(\"read_id\")!=null}});z.model.NodeSet=z.model.BaseSet.extend({model:z.model.Node});z.model.Write=z.model.StrictSingleton(z.model.Node.extend({urlRoot:z.cfg.api+\"/writes\",customNeeds:[],customGives:[],initialize:function(attrs,options){return z.model.Node.prototype.initialize.apply(this,arguments)},parse:function(response){if(response[\"lastchanged\"]!=null)delete response[\"lastchanged\"];if(response[\"date\"]!=null){this.date=new Date(response[\"date\"]);delete response[\"date\"]}return response},isComplete:function(){if(this.id!=null&&this.get(\"selected_api\")!=null&&this.get(\"action\")!=null&&this.get(\"read_id\")!=null&&this.get(\"errors\").length===0){return true}else{return false}},getActionMeta:function(){var _ref;return(_ref=this.getService())!=null?_ref.getActionMeta(this.get(\"action\"),\"write\"):void 0},getActionNoun:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s.getActionName(this.get(\"action\"),\"write\",\"true\");return noun},getActionLabel:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s.getActionName(this.get(\"action\"),\"write\",\"false\");return noun},write:function(action,data,options){var syncOptions,_this=this;syncOptions={url:\"\"+this.url()+\"/write/\"+action,type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)},canShare:function(){var globalService,_ref;globalService=(_ref=this.getService())!=null?_ref.get(\"public\"):void 0;return globalService}}));z.model.WriteSet=z.model.Singleton(z.model.NodeSet.extend({model:z.model.Write,url:z.cfg.api+\"/writes\"}));z.model.SavableSortSet=z.model.BaseSet.extend({saveSort:function(options){var syncOptions;syncOptions={type:\"PUT\",url:\"\"+this.url()+\"/sort\",data:JSON.stringify({ordering:this.map(function(field){return field.id})}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0,cache:false};return Backbone.sync(\"update\",this,syncOptions)}});z.model.DeveloperApp=z.model.Base.extend({urlRoot:z.cfg.devapi+\"/apps\",isEditable:function(){return z.app.account.get(\"is_staff\")===true||this.get(\"status\")===0},parse:function(json){this.authFields=new z.model.DeveloperAppAuthFieldSet(json.auth_fields,{app:this});this.triggers=new z.model.DeveloperAppTriggerSet(json.triggers,{app:this});this.actions=new z.model.DeveloperAppActionSet(json.actions,{app:this});return json},stats:function(){var stats;stats=[];_.each(this.get(\"stats\"),function(items,type){return _.each(items,function(values,label){var item;item={Type:type,Label:label};return stats.push(_.extend(item,values))})});stats=new z.model.BaseSet(stats,{model:z.model.Base});return stats}});z.model.DeveloperAppSet=z.model.BaseSet.extend({model:z.model.DeveloperApp,url:z.cfg.devapi+\"/apps\"});z.model.DeveloperAppAuthField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/auth_fields\";z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppAuthFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppAuthField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/auth_fields\"}});z.model.DeveloperAppTrigger=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/triggers\";z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(json){this.fields=new z.model.DeveloperAppTriggerFieldSet(json.fields,{app:this.app,trigger:this});return json}});z.model.DeveloperAppTriggerSet=z.model.BaseSet.extend({model:z.model.DeveloperAppTrigger,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/triggers\"},comparator:function(item){var index;index=1;if(item.get(\"important\"))index=0;if(item.get(\"hide\"))index=2;return index}});z.model.DeveloperAppTriggerField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+(\"/apps/\"+this.app.get(\"id\")+\"/triggers/\"+options.trigger.get(\"id\")+\"/fields\");z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppTriggerFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppTriggerField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/triggers/\"+this.options.trigger.id+\"/fields\"}});z.model.DeveloperAppTriggerSampleResult=z.model.Base.extend({idAttribute:\"sample\",initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+(\"/apps/\"+this.options.appId+\"/triggers/\"+this.options.triggerId+\"/sample_result\")}});z.model.DeveloperAppAction=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/actions\";z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(json){this.fields=new z.model.DeveloperAppActionFieldSet(json.fields,{app:this.app,action:this});return json}});z.model.DeveloperAppActionSet=z.model.BaseSet.extend({model:z.model.DeveloperAppAction,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/actions\"},comparator:function(item){var index;index=1;if(item.get(\"important\"))index=0;if(item.get(\"hide\"))index=2;return index}});z.model.DeveloperAppActionField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+(\"/apps/\"+this.app.get(\"id\")+\"/actions/\"+options.action.get(\"id\")+\"/fields\");z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppActionFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppActionField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/actions/\"+this.options.action.id+\"/fields\"}});z.model.DeveloperAppActivationRequest=z.model.Base.extend({initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/activation\"}});z.model.DeveloperAppAudit=z.model.Base.extend({initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},hasErrors:function(){return!$.isEmptyObject(this.get(\"errors\"))},url:function(){var url,_ref;url=z.cfg.devapi+\"/apps/\"+this.options.appId+\"/audit\";if((_ref=this.options)!=null?_ref.compareTo:void 0){url+=\"?compare_to=\"+this.options.compareTo}return url}});z.model.Recipe=z.model.Base.extend({urlRoot:z.cfg.api+\"/recipes\",noPersist:true,createRead:function(cb){var _this=this;this.read=new z.model.Read;return this.read.save(this.get(\"read_data\"),{success:function(){return typeof cb===\"function\"?cb():void 0}})},createWrite:function(cb){var data,_this=this;this.write=new z.model.Write;data=_.clone(this.get(\"write_data\"));data.read_id=this.read.id;return this.write.save(data,{success:function(){return typeof cb===\"function\"?cb():void 0}})},startUsing:function(options){var _this=this;if(options==null)options={};return async.series([function(cb){return _this.createRead(cb)},function(cb){return _this.createWrite(cb)}],function(err,models){if(err!=null){if(options!=null){if(typeof options.error===\"function\")options.error(err)}}(new z.model.ReadSet).fetch({cache:false,add:true});(new z.model.WriteSet).fetch({cache:false,add:true});return options!=null?typeof options.success===\"function\"?options.success(_this.read,_this.write):void 0:void 0})},readService:function(){var _ref;if((_ref=this.get(\"read_data\"))!=null?_ref.selected_api:void 0){return z.app.services.get(this.get(\"read_data\").selected_api)}return null},writeService:function(){var _ref;if((_ref=this.get(\"write_data\"))!=null?_ref.selected_api:void 0){return z.app.services.get(this.get(\"write_data\").selected_api)}return null}});z.model.RecipeSet=z.model.PaginationSet.extend({model:z.model.Recipe,url:z.cfg.api+\"/recipes\",noPersist:true,initialize:function(models,options){var filters,_this=this;z.model.PaginationSet.prototype.initialize.apply(this,arguments);this.services=this.format(options!=null?options.services:void 0);this.userid=this.format(options!=null?options.userid:void 0);this.categories=this.format(options!=null?options.categories:void 0);filters=(options!=null?options.filters:void 0)||{};filters=_.defaults(filters,{read_service:null,read_action:null,write_service:null,write_action:null,services:null,userid:null,categories:null});this.filters=new z.model.Base(filters);return this.filters.on(\"change reset\",function(){_this.serverPageReset({silent:true});return _this.fetch()},this)},format:function(rawList,location){var list;if(rawList!=null)list=_.compact(rawList);if((list!=null?list.length:void 0)>0)location=list.join(\",\");return location},applyServicesFilter:function(services,options){if(options==null)options={};return this.filters.set(\"services\",this.format(services),options)},getServicesFilter:function(){var _ref;return((_ref=this.filters.get(\"services\"))!=null?_ref.split(\",\"):void 0)||[]},applyUserFilter:function(userid,options){if(options==null)options={};return this.filters.set(\"userid\",this.format(userid),options)},applyCategoryFilter:function(categories,options){if(options==null)options={};return this.filters.set(\"categories\",this.format(categories),options)},clearFilters:function(){return this.filters.set({read_service:null,read_action:null,write_service:null,write_action:null,services:null,userid:null,categories:null})},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,_.compactObject(this.filters.toJSON()));this.trigger(\"fetch\");return z.model.PaginationSet.prototype.fetch.call(this,options)},comparator:function(model){return-model.get(\"used\")||0}});z.model.Auth=z.model.Base.extend({urlRoot:z.cfg.api+\"/auths\",validateModel:function(){if(!(this.get(\"key\")!=null))return false;return true},getService:function(services){var _ref;return(_ref=z.app.services)!=null?_ref.get(this.get(\"selected_api\")):void 0},getName:function(services){var base,name,_ref;base=(_ref=this.getService(services))!=null?_ref.getName():void 0;if(this.get(\"title\")!=null){name=this.get(\"title\")}else{name=\"\"+base+\" (\"+this.get(\"timesince\")+\" ago)\"}return name},test:function(options){var syncOptions,_this=this;if(options==null)options={};syncOptions={url:\"\"+this.url()+\"/test\",type:\"post\",data:\"{}\",dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)},destroy:function(options){return Backbone.Model.prototype.destroy.call(this,options)},swap:function(newAuthId,options){var syncOptions,_this=this;if(options==null)options={};syncOptions={url:\"\"+this.url()+\"/swap/\"+newAuthId,type:\"post\",data:\"{}\",dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.trigger(\"destroy\",_this,_this.collection,options);return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)}});z.model.AuthSet=z.model.BaseSet.extend({model:z.model.Auth,url:z.cfg.api+\"/auths\",comparator:function(auth){var d;d=new Date(auth.get(\"date\"));return-d.getTime()},getByKey:function(key){var match;if(!(key!=null))return null;match=[];this.each(function(model){if(model.get(\"selected_api\")===key)return match.push(model)});return match},hasAtLeastOneAuth:function(key){var auth;auth=this.getByKey(key);if(auth!=null&&auth.length>0)return true;return false},create:function(data,options){var syncOptions;syncOptions={url:this.url,type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",statusCode:{200:options!=null?options.s200:void 0,201:options!=null?options.s201:void 0,202:options!=null?options.s202:void 0},error:function(e){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(this,arguments):void 0:void 0}};return Backbone.sync(\"create\",this,syncOptions)},request:function(data,options){var syncOptions;syncOptions={url:this.url+\"/request\",type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},pollForNewAuth:function(interval,iters,id,options){var i,match,poll,_this=this;i=0;match=false;poll=function(){var error,success,syncOptions,_ref;success=function(model,resp){var status,_ref,_ref2;status=resp[\"status\"];log(\"oauth poll status: \",status);if(status===\"success\"){log(\"oauth success\",resp);clearInterval(poll);return(_ref=options.success)!=null?_ref.call(_this,resp):void 0}else if(status===\"error\"){log(\"oauth error\",resp);clearInterval(poll);return(_ref2=options.error)!=null?_ref2.call(_this,resp[\"message\"]):void 0}};error=function(model,xhr){};syncOptions={url:_this.url+(\"/oauth/\"+id),cache:false,type:\"get\",success:success,error:error};Backbone.sync(\"read\",_this,syncOptions);i=i+1;if(i===iters){log(\"oauth poll stopping, max iter\");clearInterval(poll);return(_ref=options.maxIter)!=null?_ref.call(_this):void 0}};poll=setInterval(poll,interval);return poll}});z.model.Stream=z.model.Base.extend({urlRoot:z.cfg.api+\"/stream\",getReadService:function(){var _ref,_ref2;return(_ref=z.app.services)!=null?_ref.get((_ref2=this.get(\"data\"))!=null?_ref2[\"read_selected_api\"]:void 0):void 0},getWriteService:function(){var _ref,_ref2;return(_ref=z.app.services)!=null?_ref.get((_ref2=this.get(\"data\"))!=null?_ref2[\"write_selected_api\"]:void 0):void 0},getRead:function(reads,writes){var write;if(this.get(\"type\")===\"write\"&&reads&&writes){write=writes!=null?writes.get(this.get(\"legacy_object_id\")||this.get(\"object_id\")):void 0;return reads!=null?reads.get(write!=null?write.get(\"read_id\"):void 0):void 0}return null},getTitle:function(){var data,read,read_action,title,write,write_action,_ref,_ref2;data=this.get(\"data\");if(data.message!=null){title=data.message}else{write=(_ref=z.app.writes)!=null?_ref.get(this.get(\"legacy_object_id\")||this.get(\"object_id\")):void 0;read=(_ref2=z.app.reads)!=null?_ref2.get(write!=null?write.get(\"read_id\"):void 0):void 0;if(read!=null){title=read.getTitle()}else{read_action=_.superHumanize(data.read_action);write_action=_.superHumanize(data.write_action);title=\"\"+read_action+\" to \"+write_action}}return title},buildChildren:function(){var action,children,jmessage,json,message,name,service,status,_ref,_ref2;json=this.toJSON();if(!(json!=null?json.data:void 0))return[];children=[];if(json.data.manual!=null&&json.data.manual===true){children.push({status:\"success\",message:\"Manually ran from dashboard\",date:json.date,type:\"manual\"})}status=((_ref=_.keys(json.data.write_raw_data))!=null?_ref.length:void 0)>0?\"success\":\"error\";service=z.app.services.get(json.data.read_selected_api);name=(service!=null?service.getName():void 0)||json.data.read_selected_api;action=(service!=null?service.getActionName(json.data.read_action,\"read\",\"true\"):void 0)||json.data.read_action;if(status===\"success\")message=\"Found 1 new \"+action+\" from \"+name;if(status===\"error\"){message=\"Error getting \"+action+\" from \"+name;if(json.data.message!=null)message=json.data.message}children.push({status:status,message:message,date:json.date,type:\"trigger_summary\"});if(json.data.message!=null)message=json.data.message;if(!(json.data.message!=null)){service=z.app.services.get(json.data.write_selected_api);name=(service!=null?service.getName():void 0)||json.data.write_selected_api;action=(service!=null?service.getActionName(json.data.write_action,\"write\",\"true\"):void 0)||json.data.write_action;if(json.data.status===\"success\"){message=\"Sent 1 \"+action+\" to \"+name}if(json.data.status===\"halted\"){jmessage=\"Advanced Filters halted 1 \"+action}if(json.data.status===\"error\"){message=\"Error sending 1 \"+action+\" to \"+name}}if(((_ref2=_.keys(json.data.write_raw_data))!=null?_ref2.length:void 0)>0){children.push({status:json.data.status,message:message,date:json.date,type:\"action_summary\"})}return children}});z.model.StreamSet=z.model.PaginationSet.extend({model:z.model.Stream,url:z.cfg.api+\"/stream\",initialize:function(models,options){var filters,_this=this;this.filterStore={};this.paginationStore={};z.model.PaginationSet.prototype.initialize.apply(this,arguments);filters=_.extend({},options!=null?options.filters:void 0);this.filters=new z.model.Base(filters);this.updateFilterStore();return this.filters.on(\"change reset\",function(){_this.serverPageReset({silent:true});_this.updateFilterStore();return _this.fetch()},this)},updateFilterStore:function(){return this.filterStore=this.filters.toJSON()},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,_.compactObject(this.filters.toJSON()));this.trigger(\"fetch\");return z.model.PaginationSet.prototype.fetch.call(this,options)},unseen:function(objectId){var all,cookie,unseen,_this=this;all=this.where({object_id:objectId});cookie=z.store.get(\"logs-seen\");unseen=_.filter(all,function(item){var seen;seen=cookie!=null?cookie[objectId]:void 0;if(!(seen!=null))return true;if(new Date(seen).getTime()>new Date(item.get(\"date\")).getTime()){return true}return false});return unseen!=null?unseen.length:void 0},comparator:function(model){var _ref;return-((_ref=new Date(model.get(\"date\")))!=null?_ref.getTime():void 0)}});z.model.Plan=z.model.Base.extend({urlRoot:function(){return z.cfg.api+\"/accounts/plans\"},getName:function(){return this.get(\"name\")},dollarsMo:function(){if(this.get(\"interval\")===\"year\")return this.dollars()/12;return this.dollars()},dollars:function(){return Math.floor(this.get(\"amount\")/100)},andCents:function(){return this.get(\"amount\")-this.dollars()*100\n},tasksMo:function(){var actions;actions=this.get(\"actions\");if(actions===-1)return new Handlebars.SafeString(\"&infin;\");return actions.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\")},zaps:function(){var zaps;zaps=this.get(\"zaps\")===-1?new Handlebars.SafeString(\"&infin;\"):this.get(\"zaps\");return zaps},pollInterval:function(){var interval_minutes;interval_minutes=this.get(\"polling_interval_minutes\");if(interval_minutes>=1440)return interval_minutes/1440;if(interval_minutes>60)return interval_minutes/60;return interval_minutes},pollIntervalTimeFrame:function(){var interval_minutes;interval_minutes=this.get(\"polling_interval_minutes\");if(interval_minutes>=1440)return\"Day\";if(interval_minutes>60)return\"Hour\";return\"Minute\"},pollSpeed:function(){var minutes;minutes=this.get(\"polling_interval_minutes\");if(minutes<10)return\"Fastest\";if(minutes<60)return\"Fast\";if(minutes>59)return\"Slow\"},blacklistedServices:function(key){var blacklisted_apps,_ref;if(key==null)key=\"blacklisted_apps\";blacklisted_apps=this.get(key);if(blacklisted_apps!=null?blacklisted_apps.length:void 0){return(_ref=z.app.services)!=null?_ref.filter(function(service){return blacklisted_apps.indexOf(service.get(\"key\"))!==-1}):void 0}else{return[]}},extraFeatures:function(){return this.get(\"meta\")},isYearly:function(){return this.get(\"interval\"===\"year\")},isMonthly:function(){return this.get(\"interval\"===\"month\")},isFree:function(){return this.dollars()===0}});z.model.PlanSet=z.model.BaseSet.extend({model:z.model.Plan,url:function(){var readId,_ref;readId=(_ref=this.read)!=null?_ref.id:void 0;return z.cfg.api+\"/accounts/plans\"},getFreePlan:function(){var plan,_this=this;plan=this.find(function(plan){if(plan.get(\"amount\")===0)return true});return plan},getCancelPlan:function(){return this.getFreePlan()},getTrialPlan:function(){var _this=this;this.comparator=function(model){return-model.get(\"amount\")};this.sort({silent:true});return this.at(1)},getIntervalPlans:function(which){var _this=this;if(which==null)which=\"month\";return this.filter(function(plan){return plan.get(\"interval\")===which||plan.get(\"amount\")===0})}});z.model.FormRow=z.model.Base.extend({TYPES:[\"password\",\"text\",\"copy\",\"datetime\",\"confirmation\",\"file\",\"unicode\",\"select\",\"bool\",\"checkbox\",\"string\",\"upload\",\"json\"],idAttribute:\"key\",isSoftRemoved:false,initialize:function(options){var _this=this;this.options=options;z.model.Base.prototype.initialize.apply(this,arguments);this.on(\"change:value\",function(){return _this.set({valid:_this.isValid()})});this.baseline();return this.originalCopy=this.toJSON()},reset:function(key){if(key){return this.set(key,this.originalCopy[key])}else{return this.set(this.originalCopy)}},baseline:function(){var choices,def,key,rawChoices,value,_ref,_ref2;_ref=this.toJSON();for(key in _ref){value=_ref[key];if(value!=null&&value===\"\")this.unset(key)}if(this.get(\"display\")!=null&&!(this.get(\"prefill\")!=null)){this.unset(\"display\")}if(!(this.get(\"required\")!=null)){this.set({required:!((_ref2=this.collection)!=null?_ref2.anyRequired():void 0)})}if(this.get(\"type\")===\"bool\"){this.set({choices:[\"yes\",\"no\"]})}def=this.get(\"default\");if(def!=null&&def!==\"\"&&!(this.getValue()!=null)){this.set({value:def})}if(_.isString(this.get(\"choices\"))){rawChoices=this.get(\"choices\");choices=rawChoices.split(\",\");choices=_.map(choices,function(choice){return choice=_.str.trim(choice)});if(_.every(choices,function(choice){return _.str.contains(choice,\"|\")})){choices=_.object(_.map(choices,function(choice){return choice.split(\"|\",2)}))}return this.set({choices:choices})}},save:function(attrs,options){return this.set(attrs,options)},validate:function(attrs,options){var isValid,value,_base;if(this.isSoftRemoved)return null;value=this.getValue();if(this.get(\"validator\")!=null){isValid=typeof(_base=this.get(\"validator\"))===\"function\"?_base(this,this.collection):void 0}else if(this.get(\"regex\")!=null){isValid=RegExp(this.get(\"regex\")).test(value)}else if(this.get(\"choices\")){if((value!=null?value.toString().length:void 0)>0){isValid=true}else{isValid=false}}else{isValid=!this.get(\"required\")||Boolean(value)}if(isValid){return null}else if(this.get(\"required\")){if((value!=null?value.toString().length:void 0)>0){return\"Invalid value\"}else{return\"Missing value\"}}else{return null}},getLabel:function(){if(this.get(\"label\")!=null)return this.get(\"label\");return _.superHumanize(this.get(\"key\"))},getDisplay:function(){if(this.get(\"display\")!=null)return this.get(\"display\");return this.get(\"value\")},getValue:function(){return this.get(\"value\")}});z.model.FormSet=z.model.BaseSet.extend({TYPES:z.model.FormRow.prototype.TYPES,model:z.model.FormRow,isValid:function(){var complete,errors,_this=this;complete=true;errors={};this.each(function(row){var valid;valid=row.isValid();complete=complete&&valid;if(!valid)errors[row.get(\"key\")]=[row.validationError]});if(!complete)this.trigger(\"invalid\",this,errors,null);return complete},getValues:function(){var data,_this=this;data={};this.each(function(each){var value;value=each.getValue();if(value!=null&&value&&value!==\"undefined\"){return data[each.get(\"key\")]=value}});return data},anyRequired:function(){return this.any(function(item){return item.get(\"required\")!=null})},softAdd:function(model){model.isSoftRemoved=false},softRemove:function(model){model.isSoftRemoved=true}});z.model.ParamFormRow=z.model.FormRow.extend({initialize:function(options){var onCollectionInit,_this=this;this.options=options;z.model.FormRow.prototype.initialize.apply(this,arguments);this.node=this.collection.node;this.state.set({busy:true});this.on(\"loaded\",this._baseline);onCollectionInit=function(state){var _ref,_ref2;if((_ref=_this.collection)!=null?(_ref2=_ref.state)!=null?_ref2.get(\"init\"):void 0:void 0){if(!_this.state.get(\"busy\")){return _this.state.set({busy:true})}}else{if(_this.state.get(\"busy\")){_this.state.set({busy:false})}return _this.trigger(\"loaded\")}};this.collection.state.on(\"change:init\",onCollectionInit,this);return this.collection.on(\"reset\",function(collection){if(!(_this.collection!=null)){return collection.state.off(null,null,_this)}})},baseline:function(){},_baseline:function(){z.model.FormRow.prototype.baseline.apply(this,arguments);if(this.get(\"prefill\")!=null&&!(this.getValue()!=null)&&this.get(\"display\")!=null){this.set({display:\"\"})}if(this.get(\"prefill\")!=null&&this.getValue()!=null&&!(this.get(\"display\")!=null)){return this.loadDisplay()}},save:function(attrs,options){var error,opts,success,_this=this;if(options==null)options={};if(!(this.collection!=null))return;if(attrs!=null)this.set(attrs);this.state.set({busy:true});success=function(){var _ref;_this.state.set({busy:false});return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(){var _ref;_this.state.set({busy:false});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};opts=_.extend({},options,{success:success,error:error});return this.collection.save(opts)},loadDisplay:function(){var options,samples,_this=this;if(!(this.collection!=null))return;this.state.set({busy:true});options={success:function(map){_this.state.set({busy:false});if(map[_this.getValue()]!=null){return _this.save({display:map[_this.getValue()]},{wait:true})}},error:function(model,xhr){return _this.state.set({busy:false})}};samples=new z.model.SampleSet([],{node:this.node,action:this.node.get(\"action\")});samples.prefillMap(this.get(\"prefill\"),this.collection.getValues(),options);return{hasTags:function(){var eTag,oTag,val;oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;val=this.getValue()||\"\";return val.indexOf(oTag)!==-1&&val.indexOf(eTag)!==-1}}},isUserfill:function(){if(this.get(\"prefill\")!=null&&this.get(\"prefill\")!==\"\")return false;if(this.get(\"choices\")!=null&&this.get(\"choice\")!==\"\")return false;if(this.get(\"type\")===\"checkbox\")return false;if(this.get(\"type\")===\"confirmation\")return false;if(this.get(\"type\")===\"copy\")return false;return true},isListParent:function(){return this.get(\"list\")&&!this.get(\"parent\")}});z.model.ParamFormSet=z.model.FormSet.extend({model:z.model.ParamFormRow,url:function(){return this.node.url()+\"/needs\"},initialize:function(models,options){z.model.FormSet.prototype.initialize.apply(this,arguments);this.node=options!=null?options.node:void 0;return this.once(\"sync\",this.initData)},stripMissing:function(params){var k,v,_ref;if(params==null)params={};for(k in params){v=params[k];if(!(((_ref=this.where({key:k}))!=null?_ref[0]:void 0)!=null)){delete params[k]}}return params},stripEmpty:function(params){var key,out,value;if(params==null)params={};out={};for(key in params){value=params[key];if(value!=null&&value!==\"\")out[key]=value}return out},applyPartner:function(params){var defaultKey,defaultVal,defaults,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(params==null)params={};if(this.node.get(\"selected_api\")!==((_ref=z.app.partner.get(\"zap\"))!=null?_ref.selected_api:void 0)){return params}if(this.node.isRead()){defaults=(_ref2=z.app.partner.get(\"zap\"))!=null?(_ref3=_ref2.defaults)!=null?(_ref4=_ref3.read)!=null?_ref4.params:void 0:void 0:void 0}else{defaults=(_ref5=z.app.partner.get(\"zap\"))!=null?(_ref6=_ref5.defaults)!=null?(_ref7=_ref6.write)!=null?_ref7.params:void 0:void 0:void 0}if(defaults){for(defaultKey in defaults){defaultVal=defaults[defaultKey];if(!(params[defaultKey]!=null)&&this.get(defaultKey)!=null){params[defaultKey]=defaultVal}}}return params},initData:function(options){var _this=this;this.state.set({init:true});return async.parallel([_.bind(this.loadFields,this)],function(err,results){var display,key,meta,model,params,value,_ref,_ref2,_ref3;params=_this.node.get(\"params\");meta=(_ref=_this.node.get(\"meta\"))!=null?_ref.parammap:void 0;if(!(meta!=null))meta={};if(!(params!=null))params={};params=_this.applyPartner(params);params=_this.unpackLists(params);meta=_this.unpackLists(meta,{update:true});for(key in params){value=params[key];model=_this.get(key);display=meta!=null?meta[key]:void 0;if(model!=null){model.set({value:value,display:display})}}_this.state.set({init:false});_.defer(function(){return _this.applyPartner()});if(err!=null){if(options!=null){if((_ref2=options.error)!=null)_ref2.apply(_this,err)}}if(results!=null){return options!=null?(_ref3=options.success)!=null?_ref3.apply(_this,results):void 0:void 0}})},loadFields:function(cb){var _this=this;if(!(this.node!=null))return cb();return this.node.fetch({success:function(){return cb()}})},save:function(options){var data,meta,oldParams,params,_ref,_ref2,_ref3,_this=this;if(!(this.node!=null))return;data={};oldParams=_.extend({},this.node.get(\"params\"));params={};this.each(function(row){return params[row.id]=row.get(\"value\")});params=this.packLists(params);params=this.stripEmpty(params);if(!_.isEqual(oldParams,params)){data=_.extend(data,{params:params})}oldParams=_.extend({},(_ref=this.node.get(\"meta\"))!=null?_ref.parammap:void 0);params={};this.each(function(row){return params[row.id]=row.get(\"display\")});params=this.packLists(params);params=this.stripEmpty(params);if(!_.isEqual(oldParams,params)){meta={parammap:params,fieldmap:(_ref2=this.node.get(\"meta\"))!=null?_ref2.fieldmap:void 0};data=_.extend(data,{meta:meta})}if(_.keys(data).length>0){return this.node.save(data,{success:function(){var _ref3;return options!=null?(_ref3=options.success)!=null?_ref3.apply(_this,arguments):void 0:void 0},error:function(){var _ref3;return options!=null?(_ref3=options.error)!=null?_ref3.apply(_this,arguments):void 0:void 0}})}else{return options!=null?(_ref3=options.success)!=null?_ref3.apply(this,{noop:true}):void 0:void 0}},unpackLists:function(params,options){var clone,i,key,model,models,skip,value,values,_len,_this=this;if(params==null)params={};if(options==null)options={};params=_.clone(params);this.each(function(model){var def,val;if(model.get(\"list\")){if(!(params[model.id]!=null)||!_.isArray(params[model.id])){def=(options!=null?options.update:void 0)?null:[null];val=params[model.id]!=null?[params[model.id]]:def;if(val!=null&&(val!=null?val[0]:void 0)!=null){if(_.isString(val[0]))val=val[0].split(\",\")}return params[model.id]=val}}});for(key in params){values=params[key];if(_.isArray(values)){for(i=0,_len=values.length;i<_len;i++){value=values[i];if(this.any(function(m){return m.get(\"parent\")===key&&m.getValue()===value})){if(options!=null)options.update=true}if(options!=null?options.update:void 0){models=this.where({parent:key});model=models[i];if((model!=null?model.id:void 0)!=null){params[model.id]=value}}else{if(this.get(key)!=null){skip=_.startsWith(key,\"__\")?true:false;if(!skip){clone=this.listAdd(key);params[clone.id]=value}}}}}}return params},packLists:function(params){var _this=this;if(params==null)params={};params=_.clone(params);this.each(function(model){var childs,values;if(model.get(\"list\")&&!model.get(\"parent\")){childs=_this.where({parent:model.id});childs=_.sortBy(childs,function(child){return child.get(\"order\")});values=[];_.each(childs,function(child){var val;val=params[child.id];if(val!=null)values.push(params[child.id]);return delete params[child.id]});values=values.join();return params[model.id]=values}});return params},listLength:function(parent){var childs;childs=this.where({parent:parent});return childs.length},listAdd:function(parent){var at,clone,i,json,model,newKey;model=this.get(parent);i=_.uniqueId();newKey=\"__\"+parent+i;if(!(this.get(newKey)!=null)){json=model.toJSON();json.key=newKey;json.value=null;json.display=null;json.order=i;json.parent=parent;clone=new this.model(json,{collection:this});clone.state.set(model.state.toJSON());at=1+this.indexOf(model)+this.listLength(parent);this.add(clone,{at:at})}return clone},listRemove:function(child,parent){var model;model=this.get(child);this.remove(model);if(parent!=null&&this.listLength(parent)===0){return this.listAdd(parent)}}});z.model.DeveloperAppFormRow=z.model.FormRow.extend({validate:function(attrs,options){var choices,isValid,value;if(this.isSoftRemoved)return null;value=this.getValue();if(this.get(\"choices\")){choices=this.get(\"choices\");if($.isArray(choices)&&choices.indexOf(value)>=0){isValid=true}else if($.isPlainObject(choices)&&choices[value]!=null){isValid=true}else{isValid=false}}else{return z.model.FormRow.prototype.validate.apply(this,arguments)}if(isValid){return null}else if(this.get(\"required\")){if((value!=null?value.toString().length:void 0)>0){return\"Invalid value\"}else{return\"Missing value\"}}else{return null}}});z.model.DeveloperAppFormSet=z.model.FormSet.extend({model:z.model.DeveloperAppFormRow,wrappedModel:null,fileToUpload:null,initialize:function(formRowModels,options){z.model.FormSet.prototype.initialize.apply(this,arguments);if(options!=null?options.model:void 0){return this.setWrappedModel(options!=null?options.model:void 0)}},setWrappedModel:function(model){this.wrappedModel=model;return this.initData()},setFileUpload:function(file){return this.fileToUpload=file},initData:function(){var _this=this;this.each(function(field){var currentValue;currentValue=_this.wrappedModel.get(field.id);return field.set(\"value\",currentValue)})},getValues:function(){var data,_this=this;data={};this.each(function(each){var value;value=each.getValue();if(value===\"null\")value=null;return data[each.get(\"key\")]=value});return data},save:function(){var _this=this;if(this.isValid()){if(this.fileToUpload){return this.fileToUpload.submit().done(function(data){_this.fileToUpload=null;return _this._saveForm()}).fail(function(xhr,textStatus,errorThrown){return _this._handleErrors(xhr)})}else{return this._saveForm()}}},_saveForm:function(){var values,_this=this;values=this.getValues();return this.wrappedModel.save(values,{wait:true,error:function(model,xhr,options){return _this._handleErrors(xhr)},success:function(model,response,options){_this.trigger(\"saveSuccess\",model,response,options)}})},_handleErrors:function(xhr){var errors,_ref;try{errors=JSON.parse(xhr.responseText).errors}catch(_error){}if(errors&&xhr.status===403){this.trigger(\"error\",this,errors,null)}else if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}});z.model.Invoice=z.model.Base.extend({getDateFormat:function(date){var day,month,year;if(typeof date===\"number\")date=new Date(date*1e3);day=date.getDate();month=date.getMonth()+1;year=date.getFullYear();return\"\"+month+\"/\"+day+\"/\"+year},getDollarFormat:function(int){var cents,dollars;if(int>0){dollars=Math.floor(int/100)}else if(int<0){dollars=Math.ceil(int/100)}else{dollars=0}cents=\"0\"+(int-dollars*100);return dollars+\".\"+cents.substr(cents.length-2)},toFancyJSON:function(obj){var isTimestamp,key,val;if(typeof obj!==\"object\")obj=this.toJSON();isTimestamp=function(num){return num>1318851380};for(key in obj){val=obj[key];if(typeof val===\"number\"){if(isTimestamp(val)){obj[key+\"_pretty\"]=this.getDateFormat(val)}else{obj[key+\"_pretty\"]=this.getDollarFormat(val)}}if(typeof val===\"object\"&&val)obj[key]=this.toFancyJSON(val)}return obj}});z.model.InvoiceSet=z.model.BaseSet.extend({model:z.model.Invoice,url:z.cfg.api+\"/accounts/me/invoices\"});z.model.SupportDefinition=z.model.Base.extend({url:z.cfg.api});z.model.SupportDefinitionSet=z.model.BaseSet.extend({model:z.model.SupportDefinition,url:z.cfg.api});z.model.Embed=z.model.Base.extend({url:\"\"+z.cfg.api+\"/embedded\"});z.model.Update=z.model.Base.extend({urlRoot:z.cfg.api+\"/updates\"});z.model.UpdateSet=z.model.PaginationSet.extend({model:z.model.Update,url:z.cfg.api+\"/updates\"});z.model.Rule=z.model.Base.extend({urlRoot:function(){var readId,_ref,_ref2,_ref3;readId=((_ref=this.collection)!=null?(_ref2=_ref.read)!=null?_ref2.id:void 0:void 0)||((_ref3=this.read)!=null?_ref3.id:void 0);return z.cfg.api+\"/reads/\"+readId+\"/rules\"},setRead:function(read){this.read=read;return this.set({read_id:read.id})}});z.model.RuleSet=z.model.BaseSet.extend({model:z.model.Rule,url:function(){var id,_ref;id=(_ref=this.read)!=null?_ref.id:void 0;return z.cfg.api+(\"/reads/\"+id+\"/rules\")},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);return this.setRead(options.read)},setRead:function(read){var _this=this;this.read=read;return this.each(function(rule){return rule.set({read_id:read.id})})},getGroups:function(){var groups;groups=_.map(this.toJSON(),function(rule){return Number(rule.group)});groups=_.uniq(groups).sort();return groups},getMaxGroup:function(){var max;max=_.max(this.getGroups());if(!(max!=null)||max===-Infinity)max=0;return Number(max)}});z.model.Sample=z.model.Base.extend({initialize:function(options){this.options=options;return z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(resp){var id,_ref;if((id=(_ref=this.collection)!=null?_ref.idAttribute:void 0)!=null){this.idAttribute=id}return resp},summary:function(params,options){var key,s;if(params==null)params={};s=\"Sample Data\";if(options!=null?options[\"default\"]:void 0)s=options[\"default\"];if((key=this.collection.displayKey(params))!=null&&params[key]!=null){s=params[key]}return s},buildRead:function(data){if(!(data!=null))data=this.toJSON();data=this.sanitize(data);return data},buildWrite:function(params,options){var context,data,_this=this;data={};context=this.toJSON();_.each(params,function(tmpl,key){var render,value;render=function(tmpl,context){var value;try{value=_this.render(tmpl,context)}catch(e){value=\"(Error: mismatched {{}})\"}return value};if(_.isArray(tmpl)){value=_.map(tmpl,function(each){return render(each,context)})}else{value=render(tmpl,context)}return data[key]=value});if((options!=null?options.sanitize:void 0)!==false){data=this.sanitize(data)}return data},sanitize:function(data){var k,out,v;out={};for(k in data){v=data[k];if(_.str.include(k,\"zap_meta\"))continue;if(_.str.include(v,\"hydrate|||\"))v=\"(Exists but not shown)\";out[k]=v}return out},isFiltered:function(){return this.get(\"zap_meta_filter\")},getWhyFiltered:function(){var allIds,ids,ordered,_ref;ids=(_ref=this.get(\"zap_meta_filter\"))!=null?_ref.rule_ids:void 0;allIds=z.app.rules.map(function(rule){return rule.id});ordered=z.useful.orderRelative(allIds,ids);return _.str.toSentenceSerial(ordered)},render:function(tmpl,context){var k,regex,rendered,v;rendered=tmpl.toString();for(k in context){v=context[k];regex=new RegExp((\"{{\"+k+\"}}\").replace(/([.?*+^$[\\]\\\\(){}|-])/g,\"\\\\$1\"),\"g\");rendered=rendered.replace(regex,v)}return rendered.replace(\"{{}}\",\"\")}});z.model.SampleSet=z.model.BaseSet.extend({model:z.model.Sample,url:function(){var action;action=this.action!=null?\"/\"+this.action:\"\";return this.node.url()+\"/samples\"+action},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);this.node=options!=null?options.node:void 0;return this.action=options!=null?options.action:void 0},setIDKey:function(id){return this.idAttribute=id},prefillMap:function(prefill,data,options){var action,displayKeys,opts,payloadData,pfdata,targetKey,_this=this;pfdata=this.splitPrefill(prefill);action=pfdata[\"action\"];displayKeys=pfdata[\"displayKeys\"];targetKey=pfdata[\"targetKey\"];this.setIDKey(targetKey);this.action=action;payloadData=_.extend({zap_meta_limit:-1,zap_meta_hydrate:false,zap_meta_page:this.getPage(),zap_meta_prefill:true},data);if($.param(payloadData).length>4096){payloadData=_.map(payloadData,function(value,key){if(value.toString().length>256)return null;return[key,value]});payloadData=_.object(_.filter(payloadData,function(pair){return pair}))}opts={data:payloadData,update:true,remove:false,success:function(model,resp){var map,_ref;map=_this.doPrefillMap(model.toJSON(),displayKeys,targetKey);return options!=null?(_ref=options.success)!=null?_ref.call(_this,map):void 0:void 0},error:function(model,xhr){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}};return this.fetch(opts)},splitPrefill:function(prefillPath){var action,displayKeys,pfdata,targetKey,_ref;pfdata=prefillPath!=null?prefillPath.split(\".\"):void 0;action=pfdata!=null?pfdata[0]:void 0;targetKey=pfdata!=null?pfdata[1]:void 0;displayKeys=pfdata!=null?(_ref=pfdata[2])!=null?_ref.split(\",\"):void 0:void 0;return{action:action,targetKey:targetKey,displayKeys:displayKeys}},doPrefillMap:function(data,displayKeys,targetKey){var mapping,_this=this;mapping={};_.each(data,function(each){var displayKey,fallback,key,value,values,_i,_len;key=each[targetKey];value=\"\";if(displayKeys!=null){values=[];for(_i=0,_len=displayKeys.length;_i<_len;_i++){displayKey=displayKeys[_i];fallback=value.length>0?false:targetKey;values.push(each[_this.displayKey(each,displayKey,fallback)])}value=values.join(\" \")}else{value=each[_this.displayKey(each,null,targetKey)]}return mapping[key]=value});return mapping},displayKey:function(data,preferredKey,fallback){var defaults,key,_this=this;defaults=[\"name\",\"Name\",\"display\",\"Display\",\"title\",\"Title\",\"subject\",\"Subject\"];if(preferredKey!=null&&data[preferredKey]!=null&&data[preferredKey]!==\"\"){return preferredKey}if((typeof options!==\"undefined\"&&options!==null?options.fallback:void 0)===false){return null}key=_.find(defaults,function(key){if(data[key]!=null&&data[key]!==\"\")return true});if(key!=null)return key;return fallback;return displayKey},getPage:function(){var page;page=this.page!=null?this.page:0;return page},setPage:function(page){return this.page=page}});z.model.AccountLimits=z.model.Base.extend({url:z.cfg.api+\"/accounts/me/limits\"});z.model.AccountBonusSet=z.model.BaseSet.extend({url:z.cfg.api+\"/accounts/me/bonuses\"});z.model.Account=z.model.Base.extend({url:z.cfg.api+\"/accounts/me\",initialize:function(){var _this=this;z.model.Base.prototype.initialize.apply(this,arguments);return this.on(\"sync error\",function(){return _this.loaded=true})},isLoggedIn:function(){return this.id!=null},isStaff:function(){return this.get(\"is_staff\")},isDeveloper:function(){return this.get(\"is_developer\")},login:function(username,password,options){var data,_this=this;data={username:username,password:password};return $.ajax({url:z.cfg.api+\"/accounts/session\",type:\"PUT\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.fetch({cache:false});return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0},error:options!=null?options.error:void 0})},logout:function(options){var _this=this;return $.ajax({url:z.cfg.api+\"/accounts/session\",type:\"DELETE\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;if(options!=null){if((_ref=options.success)!=null)_ref.apply(_this,arguments)}return global.router.goto(\"/\")},error:options!=null?options.error:void 0})},hasActiveCard:function(){var _ref;return((_ref=this.get(\"billing\"))!=null?_ref.active_card:void 0)!=null},switchPlan:function(planId,coupon,why,options){var error,opts,success,_this=this;if(coupon==null)coupon=null;if(why==null)why=null;if(options==null)options={};success=function(){var args,done;_this.unset(\"coupon\",{silent:true});args=arguments;done=_.after(2,function(){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,args):void 0:void 0});if(!z.app.plans)z.app.plans=new z.model.PlanSet;z.app.plans.fetch({cache:false,update:true,success:done,error:done});return _this.fetch({success:done,error:done})};error=function(){var _ref;_this.unset(\"coupon\",{silent:true});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};opts=_.extend(_.clone(options),{success:success,error:error,wait:true});return this.save({plan_id:planId,coupon:coupon,why:why},opts)},checkCoupon:function(coupon,options){return $.ajax({url:z.cfg.api+\"/accounts/coupon\",type:\"POST\",data:JSON.stringify({coupon:coupon}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},saveCard:function(token,options){var error,success,_this=this;success=function(){var _ref;_this.unset(\"card_token\",{silent:true});_this.fetch();return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(){var _ref;_this.unset(\"card_token\",{silent:true});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};this.set({card_token:token},{silent:true});return this.save({},{success:success,error:error,wait:true})},deleteAccount:function(password,options){if(options==null)options={};options.data={password:password};return this.destroy(options)},accountCreated:function(){z.store.set(\"showPersonaModal\",true);z.store.set(\"guiderPreferences\",{editorMapping:z.tests.editorMappingGuiders});z.app.track.gaPageTrack(\"/app/signup/success\")},checkUsernameAvailable:_.throttle(this._checkUsernameAvailable,200),_checkUsernameAvailable:function(username,options){var data,error,success;data={username:username};return $.ajax({type:\"GET\",url:z.cfg.api+(\"/accounts/username?\"+$.param(data)),dataType:\"json\",contentType:\"application/json\"},success=options!=null?options.success:void 0,error=options!=null?options.error:void 0)},sendForgotPasswordEmail:function(email,options){return $.ajax({type:\"POST\",data:JSON.stringify({email:email}),url:z.cfg.api+\"/accounts/password/forgot\",dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},resetPassword:function(username,code,password1,password2,options){return $.ajax({type:\"POST\",data:JSON.stringify({username:username,code:code,password1:password1,password2:password2}),url:z.cfg.api+\"/accounts/password/reset\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},sendEmailConfirmation:function(options){var syncOptions;syncOptions={url:z.cfg.api+\"/accounts/me/confirm\",type:\"post\",data:JSON.stringify({}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},trialDaysLeft:function(){var end,now;if(!this.isTrialing())return null;now=Math.round((new Date).getTime()/1e3);end=this.get(\"trial_end_date\");if(!(end!=null))return null;if(end<now)return 0;return Math.round((end-now)/(60*60*24))},isTrialing:function(){return!!this.get(\"trial_end_date\")},isFree:function(){return this.getCurrentPlanAmount()===0},getCurrentPlan:function(){var _ref;if(!z.app.plans)z.app.plans=new z.model.PlanSet;if(this.get(\"plan_id\")){return(_ref=z.app.plans)!=null?_ref.get(this.get(\"plan_id\")):void 0}return null},getCurrentPlanAmount:function(){var amount,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;amount=null;if(!(((_ref=this.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.plan:void 0:void 0)!=null)){amount=0}else if(((_ref3=this.get(\"billing\"))!=null?(_ref4=_ref3.subscription)!=null?(_ref5=_ref4.plan)!=null?_ref5.amount:void 0:void 0:void 0)!=null){amount=(_ref6=this.get(\"billing\"))!=null?(_ref7=_ref6.subscription)!=null?(_ref8=_ref7.plan)!=null?_ref8.amount:void 0:void 0:void 0}return amount},planId:function(){return this.get(\"plan_id\")},hasCard:function(){var card,_ref;card=(_ref=this.get(\"billing\"))!=null?_ref.active_card:void 0;return card!=null},isUnlimited:function(){var unlimited;unlimited=this.get(\"is_unlimited\");return unlimited!=null&&unlimited},isPaying:function(){var paying;paying=this.isTrialing()&&this.hasCard();return paying!=null&&paying}});z.model.Partner=z.model.Base.extend({initialize:function(){var _ref,_this=this;this.hasIframeJs=false;window.addEventListener(\"message\",function(e){var json;try{json=JSON.parse(e.data)}catch(e){return}if((json!=null?json.event:void 0)===\"exist\"){_this.hasIframeJs=true;return z.app.trigger(\"render\")}});if((_ref=window.top)!=null){_ref.postMessage(JSON.stringify({event:\"exist\"}),\"*\")}},isPartnerSession:function(){var _ref;return((_ref=_.keys(this.toJSON()))!=null?_ref.length:void 0)>0}});z.model.Cache=Backbone.Model.extend({url:function(){var url;url=\"/cache/\";if(this.key!=null)url+=this.key+\"/\";if(this.expiry!=null)url+=this.expiry;return z.cfg.api+url},setKey:function(key){return this.key=key},setExpiry:function(expiry){return this.expiry=expiry},parse:function(response){var filtered,_this=this;filtered={};_.each(response,function(v,k){if(_.isObject(v)&&_.keys(v)===0)return;if(_.isString(v)&&v===\"\")return;if(_.isArray(v)&&v.length===0)return;return filtered[k]=v});return filtered}});z.model.State=Backbone.Model.extend();z.model.SupportNote=z.model.Base.extend({urlRoot:z.cfg.api+\"/support/notes\",vote:function(options,helpful){var syncOptions;if(helpful==null)helpful=\"yes\";syncOptions={type:\"post\",data:JSON.stringify({helpful:helpful}),url:\"\"+this.url(),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)}});z.model.SupportNoteSet=z.model.BaseSet.extend({model:z.model.SupportNote,url:z.cfg.api+\"/support/notes\"});z.model.Field=z.model.Base.extend({initialize:function(options){this.options=options;return z.model.Base.prototype.initialize.apply(this,arguments)},getKey:function(){return this.get(\"key\")},getLabel:function(){if(this.get(\"label\")!=null)return this.get(\"label\");return _.superHumanize(this.get(\"key\"))},getSample:function(){return this.get(\"zap_meta_sample\")}});z.model.FieldSet=z.model.BaseSet.extend({model:z.model.Field,url:function(){return this.node.url()+\"/gives\"},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);return this.node=options!=null?options.node:void 0},exportMeta:function(){var humanize,meta;meta={};humanize=function(match){match=match.replace(/\\{\\{/g,\"\");match=match.replace(/\\}\\}/g,\"\");return _.superHumanize(match)};this.each(function(field){var key,label;key=z.cfg.userfillOTag+field.get(\"key\")+z.cfg.userfillETag;label=field.get(\"label\");if(!(label!=null))label=humanize(key);return meta[key]=label});return meta}});z.model.Read=z.model.StrictSingleton(z.model.Node.extend({urlRoot:z.cfg.api+\"/reads\",customNeeds:[],customGives:[],initialize:function(attrs,options){return z.model.Node.prototype.initialize.apply(this,arguments)\n},parse:function(response){if(response[\"lastchanged\"]!=null)delete response[\"lastchanged\"];if(response[\"date\"]!=null){this.date=new Date(response[\"date\"]);delete response[\"date\"]}if(response[\"fancy_title\"]!=null&&!(response[\"title\"]!=null)){response[\"title\"]=response[\"fancy_title\"]}delete response[\"fancy_title\"];return response},getFiltersIds:function(){return this.get(\"filter_ids\")},isComplete:function(){return this.id!=null&&this.get(\"selected_api\")!=null&&this.get(\"action\")!=null&&this.get(\"write_ids\").length>0&&this.get(\"collect_errors\").length===0},run:function(options){var syncOptions;syncOptions={type:\"get\",url:\"\"+this.url()+\"/run\",dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0,cache:false};return Backbone.sync(\"read\",this,syncOptions)},runStatus:function(options){var syncOptions;syncOptions={type:\"get\",cache:false,url:\"\"+this.url()+\"/run/status\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"read\",this,syncOptions)},hasErrors:function(){var _ref;return((_ref=this.get(\"collect_errors\"))!=null?_ref.length:void 0)>0},getActionNoun:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s!=null?s.getActionName(this.get(\"action\"),\"read\",\"true\"):void 0;return noun},getActionLabel:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s!=null?s.getActionName(this.get(\"action\"),\"read\",\"false\"):void 0;return noun},isLive:function(){return!this.get(\"paused\")},canShare:function(){var globalService,hasShared,_ref;globalService=(_ref=this.getService())!=null?_ref.get(\"public\"):void 0;hasShared=this.get(\"has_shared\");return globalService&&!hasShared},share:function(data,options){var error,success,syncOptions,_this=this;success=function(model,resp,opts){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(model,xhr,opts){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};syncOptions={type:\"post\",cache:false,url:\"\"+this.url()+\"/share\",contentType:\"application/json\",dataType:\"json\",data:JSON.stringify(data),success:success,error:error};return Backbone.sync(\"create\",this,syncOptions)},getTitle:function(){return this.get(\"fancy_title\")||this.get(\"title\")},copy:function(options){var reqOptions,_this=this;reqOptions={type:\"post\",url:\"\"+this.url()+\"/copy\",contentType:\"application/json\",dataType:\"json\",success:function(){(new z.model.ReadSet).fetch({update:true,cache:false});(new z.model.WriteSet).fetch({update:true,cache:false});return options!=null?options.success.apply(_this,arguments):void 0},error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,reqOptions)},subscribeHook:function(options){var syncOptions;syncOptions={type:\"post\",url:\"\"+this.url()+\"/subscription\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},tearDownHook:function(options){var syncOptions;syncOptions={type:\"delete\",url:\"\"+this.url()+\"/subscription\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"destroy\",this,syncOptions)},pause:function(options){return this.save({paused:true},options)},unpause:function(options){var error,success,syncOptions,_this=this;success=function(model,resp,opts){success=function(){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};return _this.fetch({cache:false,success:success})};error=function(model,xhr,opts){var _ref;if(xhr.status===409)return success();return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};syncOptions={type:\"put\",cache:false,url:\"\"+this.url()+\"/unpause\",contentType:\"application/json\",dataType:\"json\",success:success,error:error};return Backbone.sync(\"update\",this,syncOptions)}}));z.model.ReadSet=z.model.Singleton(z.model.NodeSet.extend({model:z.model.Read,url:z.cfg.api+\"/reads\"}));var __hasProp=Object.prototype.hasOwnProperty;z.model.Service=z.model.Base.extend({url:z.cfg.api+\"/services\",idAttribute:\"key\",getName:function(){if(this.get(\"meta\").human_readable_key!=null){return this.get(\"meta\").human_readable_key}return this.get(\"key\")},getNameArticle:function(){var letter,v,vowel,vowels,_i,_len;vowels=[\"a\",\"e\",\"i\",\"o\",\"u\"];vowel=false;letter=this.getName().toLowerCase()[0];for(_i=0,_len=vowels.length;_i<_len;_i++){v=vowels[_i];if(letter===v)vowel=true}if(vowel)return\"an\";return\"a\"},isPremium:function(){return this.get(\"premium\")},hasReads:function(){if(this.countActions(this.get(\"read\"))>0)return true;return false},hasWrites:function(){if(this.countActions(this.get(\"write\"))>0)return true;return false},countActions:function(actions){var action,isEmpty;isEmpty=function(object){var key,value;if(object!=null?object.hide:void 0)return true;for(key in object){if(!__hasProp.call(object,key))continue;value=object[key];return false}return true};actions=function(){var _i,_len,_results;_results=[];for(_i=0,_len=actions.length;_i<_len;_i++){action=actions[_i];if(!isEmpty(action))_results.push(action)}return _results}();return actions.length},hasUpfronts:function(){var _ref;if(((_ref=this.get(\"upfront_fields\"))!=null?_ref.length:void 0)>1){return true}return false},needsAuth:function(){var _ref;if(((_ref=this.getUpfronts())!=null?_ref.length:void 0)>0){return true}if(this.get(\"oauth\"))return true;return false},getUpfronts:function(){var context,upfronts;upfronts=[];context={service:this.getName()};_.each(this.get(\"upfront_fields\"),function(field){var newField;newField={};_.each(field,function(v,k){if(_.isString(v))v=z.useful.render(v,context);return newField[k]=v});return upfronts.push(newField)});return upfronts},isHook:function(action,which,needsURL){var meta;if(which==null)which=\"read\";if(needsURL==null)needsURL=true;meta=this.getActionMeta(action,which);if(!(meta!=null))return;return Boolean(meta.hook)&&(!needsURL||meta.hook_url!=null)},isSubHook:function(action,which){var meta;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!(meta!=null))return;return Boolean(meta.hook_subscription)},getWebhookURL:function(action,which,object){var meta,template;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!((meta!=null?meta.hook_url:void 0)!=null))return;template=_.template(meta.hook_url);return template({cid:z.app.account.get(\"id\"),ccode:z.app.account.get(\"code\"),sid:object!=null?object.id:void 0,scode:object!=null?object.get(\"code\"):void 0,code:object!=null?object.get(\"code\"):void 0})},getWebhookDirections:function(action,which){var meta;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!((meta!=null?meta.hook_url:void 0)!=null))return;return meta.hook_directions_html},getImageClass:function(size){var css,_ref;if(size==null)size=\"64x64\";if(((_ref=this.get(\"css\"))!=null?_ref[size]:void 0)!=null){css=this.get(\"css\")[size]}else{css=\"placeholder\"}return css},getCategories:function(){return this.get(\"categories\")},parseActions:function(actions,currentSelection){var filtered,_this=this;if(!_.any(actions,function(action){if((action!=null?action.important:void 0)===true)return true})){_.each(actions,function(action){action[\"important\"]=true;if(!(action.label!=null)){return action[\"label\"]=_.superHumanize(action.key)}})}filtered=_.filter(actions,function(action){return(action!=null?action.key:void 0)===currentSelection||!(action!=null?action.hide:void 0)});return filtered},getActionName:function(action,which,noverb){var meta,name,words,_this=this;if(which==null)which=\"read\";if(noverb==null)noverb=\"false\";noverb=noverb===\"true\";meta=this.getActionMeta(action,which);if(!(meta!=null))return;name=_.superHumanize(meta.key);if(meta.label!=null)name=meta.label;words=_.words(name);_.each([\"New\",\"Updated\",\"Update\",\"Changed\",\"Delete\",\"Create\",\"Add\",\"Added\",\"Set\",\"Send\",\"Submit\",\"Call\",\"Order\",\"Catch\",\"Copy\",\"Append\",\"/\",\"Move\",\"Remove\",\"Change\"],function(search){words[0]=words[0].replace(search,\"\");return words[0]=words[0].replace(search.toLowerCase(),\"\")});words[0]=words[0].replace(/^to$/i,\"\");if(noverb)name=words.join(\" \");if(noverb)name=name.replace(/\\((.+?)\\)/,\"\");name=_.trim(name);return name},getActions:function(which,currentSelection){if(which==null)which=\"read\";return this.parseActions(this.get(which),currentSelection)},getActionMeta:function(action,which){var each,_i,_len,_ref;if(which==null)which=\"read\";_ref=this.parseActions(this.get(which),action);for(_i=0,_len=_ref.length;_i<_len;_i++){each=_ref[_i];if(each.key===action)return each}},getCopyOverride:function(action,which,copy){var meta,_ref;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);return meta!=null?(_ref=meta.editor_copy)!=null?_ref[copy]:void 0:void 0},isActionImportant:function(which,action){var actions,important,_this=this;if(which==null)which=\"read\";actions=this.getActions(which);important=_.any(actions,function(each){return each.key===action&&each.important!=null&&each.important});return important},anyImportantActions:function(which){var action,_i,_len,_ref;if(which==null)which=\"read\";_ref=this.get(which);for(_i=0,_len=_ref.length;_i<_len;_i++){action=_ref[_i];if(action.important!=null&&action.important)return true}return false},getNeeds:function(which,action){var allNeeds,need,needs,_this=this;if(which==null)which=\"read\";allNeeds=this.get(which);need=_.find(allNeeds,function(need){if(need.key===action)return true});needs=need!=null?need.needs:void 0;return needs}});z.model.ServiceSet=z.model.BaseSet.extend({model:z.model.Service,url:z.cfg.api+\"/services\",comparator:function(service){return service.getName()},visibleList:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true})},hasReads:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.hasReads())return false;return true})},hasWrites:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.hasWrites())return false;return true})},sortPageAlpha:function(perPage){var group,grouped,ordered,sorted,_i,_len,_ref,_this=this;ordered=this.sortBy(function(service){return service.get(\"order\")});grouped=_.groupBy(ordered,function(service,i){return Math.floor(i/perPage)});sorted=[];_ref=_.toArray(grouped);for(_i=0,_len=_ref.length;_i<_len;_i++){group=_ref[_i];sorted=sorted.concat(_.sortBy(group,function(service){return service.getName()}))}return this.reset(sorted)},sortOrder:function(perPage){var sorted,_this=this;sorted=this.sortBy(function(service){return service.get(\"order\")});return this.reset(sorted)}});z.model.Track=z.model.Base.extend({url:z.cfg.api+\"/events\",dupe:{},initialize:function(){var _this=this;z.model.Base.prototype.initialize.apply(this,arguments);_.bindAll(this);return Backbone.history.on(\"route\",function(){var path;path=Backbone.history.location.pathname;_this[\"new\"](\"navigate\",{path:path});if(!z.cfg.debug)return _this.gaPageTrack()})},\"new\":function(message,data){if(!(this.dupe[message]!=null)){this.dupe[message]=_.debounce(this.send,50)}return this.dupe[message](message,data)},send:function(message,data){if(z.cfg.debug){return log(\"tracking an event:\",message,data)}else{return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:data}),url:this.url,contentType:\"application/json\",dataType:\"json\"})}},gaPageTrack:function(path){var title;if(!(path!=null))path=Backbone.history.location.pathname;title=typeof document!==\"undefined\"&&document!==null?document.title:void 0;log(\"GA:\",title,path);if(typeof _gaq!==\"undefined\"&&_gaq!==null){_gaq.push([\"_trackPageview\",path])}return typeof ga===\"function\"?ga(\"send\",\"pageview\",{page:path,title:title}):void 0}});window.onerrordupe={};window.onerror=function(message,url,linenumber){var send,trace,_ref,_this=this;trace=(_ref=printStackTrace())!=null?_ref.join(\"\\n\\n\"):void 0;send=function(message,url,linenumber,trace){var error;error={message:message,url:url,linenumber:linenumber,trace:trace};return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:error}),url:z.cfg.api+\"/events/errors\",contentType:\"application/json\",dataType:\"json\"})};if(!(window.onerrordupe[message]!=null)){window.onerrordupe[message]=_.debounce(send,50)}return window.onerrordupe[message](message,url,linenumber,trace)};var partnerChecks;z.controllers.Base=Backbone.Router.extend({constructor:function(options){var _this=this;Backbone.Router.prototype.constructor.apply(this,arguments);_.bindAll(this);Backbone.history.on(\"route\",this._route,this);Backbone.history.on(\"route\",function(){var _ref;if(((_ref=Backbone.history.getHash())!=null?_ref.length:void 0)<1){return $.scrollTo({top:0,left:0,duration:0})}},this)},_route:function(){var fragment,route;route=arguments[1];fragment=Backbone.history.fragment;if(!(route!=null))return;Backbone.history.last=fragment;if(!_.any(this.routes,function(v,k){return v===route})){if(typeof this.remove===\"function\")this.remove(route,fragment)}if(_.any(this.routes,function(v,k){return v===route})){return typeof this.match===\"function\"?this.match(route,fragment):void 0}},requireLogin:function(){var redirect,_this=this;redirect=function(){z.useful.goto(\"/app/login?next=/\"+Backbone.history.fragment);throw\"Login required!\"};if(z.app.account.loaded&&!z.app.account.isLoggedIn()){return redirect()}else{return z.app.account.once(\"sync\",function(){if(z.app.account.loaded&&!z.app.account.isLoggedIn())return redirect()})}}});partnerChecks=function(route,options){var allowed,iframed,pass,_this=this;if(options==null)options={};iframed=window!==(typeof window!==\"undefined\"&&window!==null?window.top:void 0);route=_.ltrim(route,\"/\");allowed=[\"app/edit\",\"app/explore\",\"app/dashboard\",\"app/history\",\"app/settings/authorizations\"];pass=true;if(z.app.partner.isPartnerSession()){pass=false;pass=_.any(allowed,function(allow){return _.str.include(route,allow)})}return pass};Backbone.history._navigate=Backbone.history.navigate;Backbone.history.navigate=function(){if(partnerChecks.apply(this,arguments)){return Backbone.history._navigate.apply(this,arguments)}};z.controllers.Settings=z.controllers.Base.extend({routes:{\"app/settings\":\"overview\",\"app/settings/\":\"overview\",\"app/settings/plans\":\"plans\",\"app/settings/plans/\":\"plans\",\"app/settings/plans/:showCoupon\":\"plans\",\"app/settings/invoices\":\"invoices\",\"app/settings/invoices/\":\"invoices\",\"app/settings/card\":\"card\",\"app/settings/card/\":\"card\",\"app/settings/authorizations\":\"auths\",\"app/settings/authorizations/\":\"auths\",\"app/settings/authorizations/:key\":\"auths\",\"app/settings/authorizations/replace/:key\":\"auths\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"settings\"},remove:function(){var _this=this;_.each(this.views,function(view){return view.remove()})},card:function(){this.options={card:true};return this.overview()},overview:function(options){this.requireLogin();z.app.viewport.title(\"Account Settings\");async.series([this.loadOverviewModels,this.loadOverview,this.renderOverview])},loadOverviewModels:function(cb){var _this=this;z.app.preloader.start(2);return async.parallel({accountBonuses:async.fetch(new z.model.AccountBonusSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadOverview:function(cb){$(\"#app\").html(JST.settings_base({}));this.$myAccount=$(\"#app .my-account\");this.$billing=$(\"#app .billing\");this.$extra=$(\"#app .extra\");this.views.myAccount=new z.ui.MyAccountSettings(this.options);this.views.billing=new z.ui.BillingSettings(this.options);this.views.extra=new z.ui.ExtraSettings(this.options);return typeof cb===\"function\"?cb():void 0},renderOverview:function(cb){this.$myAccount.html(this.views.myAccount.render().el);this.$billing.html(this.views.billing.render().el);this.$extra.html(this.views.extra.render().el);return typeof cb===\"function\"?cb():void 0},plans:function(showCoupon){this.showCoupon=showCoupon===\"coupon\";this.requireLogin();z.app.viewport.title(\"Plans\");async.series([this.loadPlanModels,this.loadPlans,this.renderPlans])},loadPlanModels:function(cb){var _this=this;z.app.preloader.start(1);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadPlans:function(cb){this.views.plans=new z.ui.PlanSelect({showCoupon:this.showCoupon});return typeof cb===\"function\"?cb():void 0},renderPlans:function(cb){$(\"#app\").html(this.views.plans.render().el);return typeof cb===\"function\"?cb():void 0},invoices:function(){this.requireLogin();z.app.viewport.title(\"Invoices\");async.series([this.loadInvoiceModels,this.loadInvoices,this.renderInvoices])},loadInvoiceModels:function(cb){var _this=this;z.app.preloader.start(1);return async.parallel({invoices:async.fetch(new z.model.InvoiceSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadInvoices:function(cb){this.views.invoices=new z.ui.Invoices({});return typeof cb===\"function\"?cb():void 0},renderInvoices:function(cb){$(\"#app\").html(this.views.invoices.render().el);return typeof cb===\"function\"?cb():void 0},auths:function(key){this.requireLogin();z.app.viewport.title(\"Connected Accounts\");this.addService=key;async.series([this.loadAuthModels,this.loadAuths,this.renderAuths])},loadAuthModels:function(cb){var _this=this;z.app.preloader.start(4);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),auths:async.fetch(new z.model.AuthSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadAuths:function(cb){this.views.auths=new z.ui.Auths({addService:this.addService});return typeof cb===\"function\"?cb():void 0},renderAuths:function(cb){$(\"#app\").html(this.views.auths.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.Explore=z.controllers.Base.extend({routes:{\"app/explore\":\"explore\",\"app/explore*qs\":\"explore\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"explore\"},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.search)!=null)_ref.off();return(_ref2=this.recipes)!=null?_ref2.off():void 0},explore:function(){z.app.track[\"new\"](\"Visit Page: explore\",{path:window.location.pathname});z.app.viewport.title(\"Explore\");async.series([this.loadModels,this.loadViews,this.renderViews])},storeFilters:function(filters){return z.store.set(\"recipe-filters\",filters,{expires:60*15})},restoreFilters:function(){var filters;filters={};filters=z.store.get(\"recipe-filters\")||{};_.extend(filters,_.object((new z.useful.QueryString).pairs||Array()));return filters},loadModels:function(cb){var recipeOptions,_this=this;z.app.preloader.start(3);recipeOptions={filters:this.restoreFilters(),pagination:{perPage:15}};return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),recipes:async.fetch(new z.model.RecipeSet([],recipeOptions),{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();z.app.recipes.filters.on(\"change\",function(){return _this.storeFilters(z.app.recipes.filters.toJSON())},_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={recipes:z.app.recipes};$(\"#app\").html(JST.explore_base({}));this.$search=$(\"#app .search\");this.$results=$(\"#app .results\");this.views.search=new z.ui.ExploreSearch(options);this.views.results=new z.ui.ExploreResults(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$search.html(this.views.search.render().el);this.$results.html(this.views.results.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.SignUp=z.controllers.Base.extend({routes:{\"app/signup\":\"signup\",\"app/signup?*querystring\":\"signup\"},views:{},match:function(){z.cfg.defaultSupportTags=\"signup\";if(!z.app.account.isLoggedIn()){return $(\"#header .hiring, #header .links-container, #header .menu-account, #header .menu-login\").addClass(\"hide\")}},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.sidebar)!=null)_ref.off();if((_ref2=this.recipes)!=null)_ref2.off();return $(\"#header .hiring, #header .links-container, #header .menu-account, #header .menu-login\").removeClass(\"hide\")},signup:function(){z.app.track[\"new\"](\"Visit Page: signup\",{path:window.location.pathname});z.app.viewport.title(\"Signup\");this.querystring=_.object((new z.useful.QueryString).pairs||Array());async.series([this.loadRecipe,this.loadModels,this.loadViews,this.renderViews])},loadRecipe:function(cb){var service,_this=this;z.app.preloader.start(3);this.recipe=null;if(this.querystring.recipe_id){return(this.recipe=new z.model.Recipe({id:this.querystring.recipe_id})).fetch({success:function(){return typeof cb===\"function\"?cb():void 0},error:function(){_this.recipe=null;return typeof cb===\"function\"?cb():void 0}})}else if(this.querystring.read_service||this.querystring.write_service){this.recipe=new z.model.Recipe({id:\"fake\",generated:true,read_data:{selected_api:this.querystring.read_service,action:this.querystring.read_action},write_data:{selected_api:this.querystring.write_service,action:this.querystring.write_action}});return typeof cb===\"function\"?cb():void 0}else if(this.querystring.next!=null&&_.str.include(this.querystring.next,\"API\")){service=this.querystring.next.match(\"(.*/)?(.*API)(.*)?\")[2];this.recipe=new z.model.Recipe({id:\"fake\",generated:true,read_data:{selected_api:service,action:null},write_data:{selected_api:null,action:null}});return typeof cb===\"function\"?cb():void 0}else{return typeof cb===\"function\"?cb():void 0}},loadModels:function(cb){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={querystring:this.querystring,recipe:this.recipe};$(\"#app\").html(JST.signup_base({}));this.$signUpWhy=$(\"#app .signup-why\");this.$signUpForm=$(\"#app .signup-form\");this.views.signUpWhy=new z.ui.SignUpWhy(options);this.views.signUpForm=new z.ui.SignUpForm(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$signUpWhy.html(this.views.signUpWhy.render().el);this.$signUpForm.html(this.views.signUpForm.render().el);this.$signUpForm.find(\"br\").first().remove();return typeof cb===\"function\"?cb():void 0}});z.controllers.Support=z.controllers.Base.extend({routes:{help:\"support\",\"help/\":\"support\",\"help/:qs\":\"support\",\"help/:qs/\":\"support\"},remove:function(route,fragment){return $(\".vote a\").off(\"click\",this.vote)},support:function(){var $el,para,paras,replaced,text,_i,_len,_this=this;if(Backbone.history.last!=null)Backbone.history.location.reload();z.app.supportDefinitions=new z.model.SupportDefinitionSet(typeof preload!==\"undefined\"&&preload!==null?preload.definitions:void 0);paras=$(\".content > p\");for(_i=0,_len=paras.length;_i<_len;_i++){para=paras[_i];$el=$(para);text=$el.html();replaced=text;z.app.supportDefinitions.each(function(def){var regex,replace,slug,title,word;word=def.get(\"word\");title=def.get(\"text\");slug=def.get(\"read_more\");return regex=slug!=null?(replace=$(\"<a class='def' href='/help/\"+slug+\"' data-title='\"+title+\"'>\"+word+\"</a>\")[0],_this.highlightWord($el[0],word,replace)):(replace=$(\"<span class='def' data-title='\"+title+\"'>\"+word+\"</span>\")[0],_this.highlightWord($el[0],word,replace))});$el.find(\".def\").each(function(){$el=$(this);if($el.position().left>=$el.parent().width()/2){return $el.addClass(\"left\")}})}return $(\".vote a\").on(\"click\",this.vote)},vote:function(e){var $el,helpful,id,url,_ref;if(e!=null)e.preventDefault();$el=$(e.currentTarget);if(!($el!=null))return;id=$el.attr(\"data-id\");helpful=(_ref=$(e.currentTarget))!=null?_ref.attr(\"data-option\"):void 0;$el.closest(\".option-container\").text(\"Thanks!\");url=\"\"+z.cfg.api+\"/support/notes/\"+id;return $.ajax({type:\"POST\",url:url,data:JSON.stringify({helpful:helpful})})},highlightWord:function(root,word,replace){var cut,highlightWords,textNodesUnder;textNodesUnder=function(root){var a,n,w;n=void 0;a=[];w=document.createTreeWalker(root,NodeFilter.SHOW_TEXT,null,false);while(n=w.nextNode()){a.push(n)}return a};cut=function(str,cutStart,cutEnd){return str.substr(0,cutStart)+str.substr(cutEnd+1)};highlightWords=function(n){var after,insert,match,next,_results;match=new RegExp(\"\\\\b\"+word+\"\\\\b\",\"g\").exec(n.nodeValue);_results=[];while(match!==null){insert=replace.cloneNode(true);after=n.splitText(match.index+match[0].length);n.nodeValue=cut(n.nodeValue,match.index,match.index+match[0].length);after.parentNode.insertBefore(insert,after);n=after;next=new RegExp(\"\\\\b\"+word+\"\\\\b\",\"g\").exec(n.nodeValue);_results.push(match=next)}return _results};return textNodesUnder(root).forEach(highlightWords)}});z.controllers.Server=z.controllers.Base.extend({routes:{\"referral*q\":\"nothing\",\"support*q\":\"nothing\",\"partner*q\":\"nothing\",\"developer*q\":\"nothing\",\"users*q\":\"nothing\",\"about*q\":\"nothing\",\"privacy*q\":\"nothing\",\"terms*q\":\"nothing\",\"support*q\":\"nothing\",\"engine*q\":\"nothing\",\"marketing/*q\":\"nothing\",\"zapbook/updates*q\":\"nothing\",\"zapbook/share*q\":\"nothing\",\"checks*q\":\"nothing\",\"login*q\":\"nothing\",\"subscription*q\":\"nothing\",\"blog*q\":\"nothing\",\"comments*q\":\"nothing\"},nothing:function(){if(Backbone.history.last!=null)Backbone.history.location.reload()}});z.controllers.Simple=z.controllers.Base.extend({routes:{\"app/forgot\":\"forgot\",\"app/forgot/\":\"forgot\",\"app/forgot/:username/:code\":\"forgot\",\"app/forgot/:username/:code/\":\"forgot\",\"app/login\":\"login\",\"app/login/\":\"login\",\"app/login?*qs\":\"login\",\"app/login/?*qs\":\"login\",\"app/login/:status\":\"login\",\"app/login/:status/\":\"login\",bonus:\"rewards\",\"bonus/\":\"rewards\"},remove:function(){var _ref;return(_ref=this.view)!=null?_ref.remove():void 0},forgot:function(username,code){z.app.viewport.title(\"Forgot Password\");this.view=new z.ui.ForgotPassword({username:username,code:code});$(\"#app\").html(this.view.render().el)},login:function(status){var querystring;z.app.viewport.title(\"Login\");querystring=_.object((new z.useful.QueryString).pairs||Array());this.view=new z.ui.Login({status:status,querystring:querystring});return $(\"#app\").html(this.view.render().el)},rewards:function(){if(Backbone.history.last!=null)return Backbone.history.location.reload()}});z.controllers.Home=z.controllers.Base.extend({routes:{\"\":\"home\",\"/\":\"home\"},remove:function(){var _this=this;$(window).off(\"focus\");$(window).off(\"blur\");_.each(this.views,function(view){return view.remove()});return this.views={}},home:function(){if(Backbone.history.last!=null)Backbone.history.location.reload();z.app.viewport.title(\"Automate the Web\");async.series([this.loadViews]);this.preload()},loadViews:function(cb){this.view=new z.ui.Home({el:$(\"#app\")});return typeof cb===\"function\"?cb():void 0},preload:function(){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){return typeof cb===\"function\"?cb():void 0})}});z.controllers.SharedZaps=z.controllers.Base.extend({routes:{\"app/share\":\"explore\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"explore\"},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.search)!=null)_ref.off();return(_ref2=this.recipes)!=null?_ref2.off():void 0},explore:function(){z.app.track[\"new\"](\"Visit Page: share\",{path:window.location.pathname});z.app.viewport.title(\"Explore\");return async.series([this.loadModels,this.loadViews,this.renderViews])},storeFilters:function(filters){return z.store.set(\"recipe-filters\",filters,{expires:60*15})},restoreFilters:function(){var filters;filters={};filters=z.store.get(\"recipe-filters\")||{};_.extend(filters,_.object((new z.useful.QueryString).pairs||Array()));return null},loadModels:function(cb){var recipeOptions,_this=this;z.app.preloader.start(3);recipeOptions={filters:{userid:z.app.account.id},pagination:{perPage:10}};return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),recipes:async.fetch(new z.model.RecipeSet([],recipeOptions),{persist:true}),embed:async.fetch(new z.model.Embed,{persist:false,cache:false})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();z.app.recipes.filters.on(\"change\",function(){return _this.storeFilters(z.app.recipes.filters.toJSON())},_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={recipes:z.app.recipes};$(\"#app\").html(JST.share_base({}));this.$shared=$(\"#app .results\");this.$embed=$(\"#app .embed\");this.views.embed=new z.ui.EmbededZaps({embed:z.app.embed});this.views.sharedZapsView=new z.ui.EmbedSharedZaps(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){console.log(\"render views got called!\");this.$shared.html(this.views.sharedZapsView.render().el);this.$embed.html(this.views.embed.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.Zapbook=z.controllers.Base.extend({routes:{\"zapbook/\":\"zapbook\",\"zapbook/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/\":\"zapbook\",\"zapbook/:serviceOneSlug/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:recipeId/:recipeSlug/\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:recipeId/:recipeSlug/:qs\":\"zapbook\"},zapbook:function(s1,s2,recipe,recipeSlug){if(Backbone.history.last!=null)Backbone.history.location.reload();this.view=new z.ui.Zapbook({el:$(\"#app\"),s1:s1,s2:s2,recipe:recipe,recipeSlug:recipeSlug});this.preload()},preload:function(){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){return typeof cb===\"function\"?cb():void 0})}});z.controllers.Status=z.controllers.Base.extend({routes:{\"status/\":\"status\"},sizeTable:function(){return $(\".overflow-container\").css({maxWidth:$(\"body\").width()})},status:function(){if(Backbone.history.last!=null)Backbone.history.location.reload();this.view=new z.ui.Status({el:$(\"#app\")});this.sizeTable()}});z.controllers.Editor=z.controllers.Base.extend({routes:{\"app/edit\":\"redirect\",\"app/edit/:id\":\"redirect\",\"app/editor\":\"create\",\"app/editor/\":\"create\",\"app/editor/recipe/:id\":\"fromRecipe\",\"app/editor/recipe/:id/\":\"fromRecipe\",\"app/editor/:id\":\"edit\",\"app/editor/:id/\":\"edit\",\"app/editor/:id/:step\":\"edit\",\"app/editor/:id/:step/\":\"edit\"},views:{},seen:[],redirect:function(id){var url;url=id!=null?\"app/editor/\"+id:\"app/editor\";return Backbone.history.navigate(url,{trigger:true,replace:true})},fromRecipe:function(id){var recipe;recipe=new z.model.Recipe({id:id});return recipe.fetch({success:function(recipe,resp){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}})},match:function(){return z.cfg.defaultSupportTags=\"editor\"\n},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});this.views={};this.seen=[];this.id=null;this.step=null;if((_ref=z.app.read)!=null)_ref.off();if((_ref2=z.app.write)!=null)_ref2.off();return window.onbeforeunload=null},create:function(){this.flow=true;z.app.viewport.title(\"Create New Zap\");z.app.preloader.start(7);return async.series([this.createModels,this.load,z.app.preloader.done])},edit:function(id,step){this.flow=false;this.id=id;this.step=step;z.app.viewport.title(\"Editor\");z.app.preloader.start(4);return async.series([this.load,z.app.preloader.done])},createModels:function(cb){var createRead,createWrite,navigate,read,updateRead,write,_this=this;read=new z.model.Read;write=new z.model.Write;createRead=function(cb){return read.save({},{success:function(){return cb()}})};createWrite=function(cb){return write.save({read_id:read.id},{success:function(){return cb()}})};updateRead=function(cb){return read.save({write_ids:[write.id]},{success:function(){return cb()}})};navigate=function(cb){_this.id=read.id;Backbone.history.navigate(\"app/editor/\"+_this.id,{replace:true});return cb()};return async.series([createRead,createWrite,updateRead,navigate,function(){return cb()}])},load:function(cb){var _this=this;return async.series([this.loadModels,this.loadViews,this.renderViews,function(){return cb()}])},loadModels:function(cb){var loginRedirect,models,_this=this;z.app.read=new z.model.Read({id:this.id});z.app.write=new z.model.Write;models={services:async.fetch(new z.model.ServiceSet,{persist:true}),auths:async.fetch(new z.model.AuthSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})};if(this.id!=null){models.read=async.fetch(z.app.read,{persist:true})}loginRedirect=_.once(function(){return z.useful.goto(\"/app/login?next=/\"+Backbone.history.fragment)});return async.parallel(models,function(err,models){var id,next,_ref;if(err!=null)return loginRedirect();_.extend(z.app,models);next=[];id=(_ref=z.app.read.get(\"write_ids\"))!=null?_ref[0]:void 0;if(id!=null){z.app.write.set({id:id})}if(id!=null){next.push(async.fetch(z.app.write,{persist:true}))}z.app.readNeeds=new z.model.ParamFormSet([],{node:z.app.read});z.app.writeNeeds=new z.model.ParamFormSet([],{node:z.app.write});z.app.rules=new z.model.RuleSet([],{read:z.app.read});id=z.app.read.id;if(id!=null){next.push(async.fetch(z.app.rules,{persist:true}))}next.push(function(){if(z.app.reads!=null&&z.app.writes!=null){if(!(z.app.reads.get(z.app.read.id)!=null)){z.app.reads.add(z.app.read)}if(!(z.app.reads.get(z.app.write.id)!=null)){z.app.writes.add(z.app.write)}}return typeof cb===\"function\"?cb():void 0});if(z.app.read.hasErrors())_this.flow=true;next.push(function(){return cb()});return async.series(next)})},loadViews:function(cb){var options;options={read:z.app.read,write:z.app.write,rules:z.app.rules,readNeeds:z.app.readNeeds,writeNeeds:z.app.writeNeeds,flow:this.flow};this.views.steps=new z.ui.Steps(_.extend({},options,{}));this.views.servicesActions=new z.ui.ServiceActionStep(_.extend({},options,{}));this.views.triggerAuth=new z.ui.AuthStep(_.extend({},options,{isTrigger:true}));this.views.filters=new z.ui.FilterStep(_.extend({},options,{}));this.views.actionAuth=new z.ui.AuthStep(_.extend({},options,{isTrigger:false}));this.views.map=new z.ui.MapStep(_.extend({},options,{isTrigger:false}));this.views.test=new z.ui.TestStep(_.extend({},options,{}));this.views.enable=new z.ui.EnableStep(_.extend({},options,{}));return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){var options;options={read:z.app.read,write:z.app.write};$(\"#app\").html(JST.editor_base(options));this.views.steps.renderSteps();$(\"#app .editor\").html(this.views.steps.render().el);if(!this.flow)this.views.steps.showAllSteps();if(this.flow)this.next();return typeof cb===\"function\"?cb():void 0},next:function(view){var step,_ref,_this=this;if(view!=null){step=view.$el.closest(\"[data-id]\").attr(\"data-id\");if(_.contains(this.seen,step)||!(step!=null))return;this.seen.push(step)}if(((_ref=this.seen)!=null?_ref.length:void 0)>0){window.onbeforeunload=function(){return\"This Zap is not done yet! Are you sure you want to leave?\"}}return this.views.steps.showNext()}});z.controllers.Pricing=z.controllers.Base.extend({routes:{\"app/pricing\":\"pricing\",\"app/pricing/\":\"pricing\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"pricing\"},remove:function(){var _ref,_this=this;_.each(this.views,function(view){return view.remove()});return(_ref=this.plans)!=null?_ref.off():void 0},pricing:function(){z.app.track[\"new\"](\"Visit Page: pricing\",{path:window.location.pathname});z.app.viewport.title(\"Pricing\");async.series([this.loadModels,this.loadViews,this.renderViews,this.normalizePlanHeight])},loadModels:function(cb){var _this=this;z.app.preloader.start(2);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){$(\"#app\").html(JST.pricing_base({}));this.$plans=$(\"#app .pricing\");this.views.plans=new z.ui.Plans({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$plans.html(this.views.plans.render().el);this.views.plans.normalizePlanHeight();return typeof cb===\"function\"?cb():void 0}});z.controllers.Dashboard=z.controllers.Base.extend({routes:{\"app/dashboard\":\"dashboard\",\"app/dashboard/shared\":\"shared\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"dashboard\"},remove:function(route,fragment){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});this.views={};if((_ref=this.modal)!=null)_ref.close();return(_ref2=z.app.updates)!=null?_ref2.off():void 0},shared:function(){return this.dashboard(true)},dashboard:function(shared){var _this=this;this.requireLogin();z.app.viewport.title(\"Dashboard\");async.series([function(cb){return _this.loadModels(cb,shared!=null)},function(cb){return _this.loadViews(cb,shared!=null)},function(cb){return _this.renderViews(cb,shared!=null)}])},loadModels:function(cb,shared){var calls,_ref,_ref2,_ref3,_this=this;z.app.preloader.start(3);this.search=new z.model.Base({search:(_ref=z.app.partner.get(\"dashboard\"))!=null?_ref.search:void 0});calls={accountBonuses:async.fetch(new z.model.AccountBonusSet,{persist:true}),services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{cache:false,persist:true}),writes:async.fetch(new z.model.WriteSet,{cache:false,persist:true}),stream:async.fetch(new z.model.StreamSet([],{pagination:{perPage:50},filters:{}}),{cache:false,persist:true}),updates:async.fetch(new z.model.UpdateSet,{persist:true})};if((_ref2=z.app.partner)!=null?_ref2.isPartnerSession():void 0){calls.recipes=async.fetch(new z.model.RecipeSet([],{pagination:{page:1},filters:{partner:(_ref3=z.app.account.get(\"provider\"))!=null?_ref3.public_key:void 0}}),{persist:true})}else if(shared){calls.recipes=async.fetch(new z.model.RecipeSet([],{pagination:{page:1,perPage:100},filters:{userid:z.app.account.id,status:\"all\"}}),{persist:true});calls.embed=async.fetch(new z.model.Embed,{persist:false,cache:false})}return async.parallel(calls,function(err,models){_.extend(z.app,models);z.app.preloader.done();z.app.updates.on(\"change\",_this.showAnyUpdates,_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb,shared){$(\"#app\").html(JST.dashboard_base({}));if(z.app.partner.isPartnerSession()&&z.app.reads.length===0){$(\"#app .dashboard .empty\").show();this.$partnerText=$(\"#app .dashboard .empty .left\");this.$partnerZaps=$(\"#app .dashboard .empty .right\");this.views.partnerText=new z.ui.PartnerText({el:this.$partnerText});this.views.partnerZaps=new z.ui.PartnerZaps({el:this.$partnerZaps,button:true});return typeof cb===\"function\"?cb():void 0}if(z.app.partner.isPartnerSession()){this.$start=$(\"#app .main-col .start\");this.views.partnerStart=new z.ui.PartnerZaps({button:false})}this.$zaps=$(\"#app .main-col .zaps\");this.$search=$(\"#app .main-col .search\");this.$side=$(\"#app .side-col\");this.views.search=new z.ui.DashboardSearch({model:this.search,shared:shared});if(shared){this.views.zaps=new z.ui.SharedZaps({search:this.search});this.views.collectionBlock=new z.ui.CollectionBlock({})}else{this.views.zaps=new z.ui.Zaps({search:this.search})}this.views.create=new z.ui.CreateBlock({});this.views.subscribe=new z.ui.SubscribeBlock({});this.views.limits=new z.ui.LimitsBlock({});this.views.logs=new z.ui.LogsBlock({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb,shared){var showPersona;if(z.app.partner.isPartnerSession()&&z.app.reads.length===0){this.views.partnerText.render();this.views.partnerZaps.render();return typeof cb===\"function\"?cb():void 0}if(z.app.partner.isPartnerSession()){this.$start.html(this.views.partnerStart.render().el)}this.$search.html(this.views.search.render().el);this.$zaps.html(this.views.zaps.render().el);this.$side.append(this.views.create.render().el);if(shared)this.$side.append(this.views.collectionBlock.render().el);if(!z.app.account.get(\"is_subscribed_to_blog\")){this.$side.append(this.views.subscribe.render().el)}this.$side.append(this.views.limits.render().el);this.$side.append(this.views.logs.render().el);showPersona=z.store.get(\"showPersonaModal\");if(showPersona){new z.ui.Modal({view:new z.ui.PersonaFormModal})}this.showAnyUpdates();return typeof cb===\"function\"?cb():void 0},showAnyUpdates:function(){var updates;updates=this.newUpdates();if(!_.isEmpty(updates)){return new z.ui.Modal({view:new z.ui.SinceYouBeenGoneModal({model:updates})})}},newUpdates:function(){var last;last=z.store.get(\"lastUpdateViewedDatetime\");z.store.set(\"lastUpdateViewedDatetime\",Date.now());if(!last)last=Date.parse(z.app.account.get(\"last_login\"));this.recentUpdates=_.filter(z.app.updates.toJSON(),function(update){return Date.parse(update.date)>last});return this.recentUpdates}});z.controllers.History=z.controllers.Base.extend({routes:{\"app/history\":\"all\",\"app/history/:id\":\"single\",\"app/history*qs\":\"all\"},views:{},remove:function(){var _this=this;_.each(this.views,function(view){return view.remove()});return this.views={}},all:function(){this.requireLogin();this.querystring=_.object((new z.useful.QueryString).pairs||Array());z.app.viewport.title(\"Task History\");async.series([this.loadModels,this.loadViews,this.renderViews])},loadModels:function(cb){var filters,pagination,_ref,_ref2,_this=this;z.app.preloader.start(4);filters=_.extend({},_.compactObject((_ref=z.app.stream)!=null?_ref.filterStore:void 0),this.querystring);pagination=((_ref2=z.app.stream)!=null?_ref2.paginationStore:void 0)||{};pagination.perPage=25;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true}),stream:async.fetch(new z.model.StreamSet([],{pagination:pagination,filters:filters},{persist:true}))},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){$(\"#app\").html(JST.history_base({}));this.$filters=$(\"#app .head\");this.$all=$(\"#app .body\");this.views.filters=new z.ui.HistoryFilters({});this.views.all=new z.ui.History({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$filters.html(this.views.filters.render().el);this.$all.html(this.views.all.render().el);return typeof cb===\"function\"?cb():void 0},single:function(id){this.id=id;this.requireLogin();this.querystring=_.object((new z.useful.QueryString).pairs||Array());z.app.viewport.title(\"Task History \"+this.id);async.series([this.loadSingleModels,this.loadSingleViews,this.renderSingleViews])},loadSingleModels:function(cb){var _this=this;z.app.preloader.start(4);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true}),streamItem:async.fetch(new z.model.Stream({id:this.id},{persist:true}))},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadSingleViews:function(cb){$(\"#app\").html(JST.history_base({id:this.id}));this.$nav=$(\"#app .head\");this.$details=$(\"#app .body\");this.views.nav=new z.ui.HistoryNav({id:this.id});this.views.details=new z.ui.HistoryDetails({streamItem:z.app.streamItem});return typeof cb===\"function\"?cb():void 0},renderSingleViews:function(cb){this.$nav.html(this.views.nav.render().el);this.$details.html(this.views.details.render().el);return typeof cb===\"function\"?cb():void 0}});var DEVELOPER_ROUTES,_DEVELOPER_ROUTES;_DEVELOPER_ROUTES={\"(/)\":\"dashboard\",\"/app/create(/)\":\"create\",\"/app/:id(/)\":\"viewApp\",\"/app/:id/meta(/)\":\"meta\",\"/app/:id/requests(/)\":\"requests\",\"/app/:id/activate(/)\":\"activate\",\"/app/:id/invite(/)\":\"invite\",\"/app/:id/migrate/:old_id\":\"migrate\",\"/app/:id/migrate(/)\":\"chooseMigrationTarget\",\"/app/:id/scripting(/)\":\"scripting\",\"/app/:id/auth/edit/fields/create(/)\":\"createAuthFieldWizard\",\"/app/:id/auth/edit/fields/:fieldId(/)\":\"editAuthFieldWizard\",\"/app/:id/auth/edit/:section(/)\":\"authWizard\",\"/app/:id/auth/settings(/)\":\"authSettings\",\"/app/:id/auth/fields/create(/)\":\"createAuthField\",\"/app/:id/auth/fields/:fieldId/edit(/)\":\"editAuthField\",\"/app/:id/triggers(/)\":\"triggers\",\"/app/:id/triggers/create(/)\":\"createTrigger\",\"/app/:id/triggers/create/test(/)\":\"createTestTrigger\",\"/app/:id/triggers/settings(/)\":\"triggerSettings\",\"/app/:id/triggers/:trigger/edit(/)\":\"editTrigger\",\"/app/:id/triggers/:trigger/edit/fields(/)\":\"triggerFields\",\"/app/:id/triggers/:trigger/edit/sample(/)\":\"editTriggerSample\",\"/app/:id/triggers/:trigger/edit/:section(/)\":\"editTrigger\",\"/app/:id/triggers/:trigger/fields(/)\":\"triggerFields\",\"/app/:id/triggers/:trigger/fields/create(/)\":\"createTriggerField\",\"/app/:id/triggers/:trigger/fields/:field(/)\":\"editTriggerField\",\"/app/:id/actions(/)\":\"actions\",\"/app/:id/actions/create(/)\":\"createAction\",\"/app/:id/actions/:action/edit(/)\":\"editAction\",\"/app/:id/actions/:action/edit/fields(/)\":\"actionFields\",\"/app/:id/actions/:action/edit/:section(/)\":\"editAction\",\"/app/:id/actions/:action/fields(/)\":\"actionFields\",\"/app/:id/actions/:action/fields/create(/)\":\"createActionField\",\"/app/:id/actions/:action/fields/:field(/)\":\"editActionField\"};DEVELOPER_ROUTES=_.object(_.map(_.keys(_DEVELOPER_ROUTES),function(r){return z.cfg.devpath+r}),_.values(_DEVELOPER_ROUTES));z.controllers.Developer=z.controllers.Base.extend({routes:DEVELOPER_ROUTES,views:{},isAppCacheStale:false,isAppSetCacheStale:false,remove:function(){var _this=this;return _.each(this.views,function(view){return view.remove()})},loadApp:function(appId,cb,additionalModels){var models,_this=this;if(additionalModels==null)additionalModels={};if(!(z.app.developer.app!=null)||z.app.developer.app.get(\"id\")!==Number(appId)||z.app.developer.isAppCacheStale){z.app.developer.isAppCacheStale=false;models={app:async.fetch(new z.model.DeveloperApp({id:appId}),{cache:false,persist:false})}}else{models={}}_.extend(models,additionalModels);z.app.preloader.start(_.keys(models).length);return async.parallel(models,function(err,model){var allowedUrls;_.extend(z.app.developer,model);z.app.viewport.title(z.app.developer.app.get(\"title\")+\" - Dev Platform\");z.app.preloader.done();if(!z.app.developer.app.isEditable()){allowedUrls=[\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),\"/\"+z.cfg.devpath+\"/\"+z.app.developer.app.get(\"id\")+\"/invite\"];if(!_.contains(allowedUrls,Backbone.history.location.pathname)){Backbone.history.navigate(allowedUrls[0],{trigger:true});return}}return typeof cb===\"function\"?cb():void 0})},placeInWrapper:function(view){$(\"#app\").html(JST.developer_base({}));return $(\"#app .developer-content\").html(view.render().el)},dashboard:function(){var loadModels,renderViews,_this=this;this.requireLogin();z.app.viewport.title(\"Dashboard - Dev Platform\");loadModels=function(cb){var options;z.app.preloader.start(1);options={};if(z.app.developer.isAppSetCacheStale){z.app.developer.isAppSetCacheStale=false;options.cache=false;options.persist=false}return async.parallel({apps:async.fetch(new z.model.DeveloperAppSet,options)},function(err,models){if(!(z.app.developer!=null))z.app.developer={};_.extend(z.app.developer,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})};renderViews=function(cb){var supportContainer;_this.views.dashboard=new z.ui.DeveloperDashboard({});if($(\"#app\").length===0){supportContainer=$(\"#app .support.container\");supportContainer.find(\".search\").after('<div class=\"column three-quarters developer\" id=\"developer\"></div>').remove();supportContainer.find(\".content\").remove()}$(\"#app\").html(JST.developer_base({}));$(\"#app .developer-nav\").hide();$(\"#app .developer-content\").html(_this.views.dashboard.render().el);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},viewApp:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app=new z.ui.DeveloperApp({subViews:{stats:new z.ui.DeveloperAppStats({}),auth:new z.ui.DeveloperAppAuth({}),triggers:new z.ui.DeveloperAppTriggers({}),actions:new z.ui.DeveloperAppActions({})}});_this.placeInWrapper(_this.views.app);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},create:function(){this.meta(null)},meta:function(id){var app,formLoader,linkModels,loadModels,renderViews,_this=this;this.requireLogin();formLoader={form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/meta\"}))};if(id!=null){loadModels=function(cb){return _this.loadApp(id,cb,formLoader)}}else{z.app.viewport.title(\"Create Service - Dev Platform\");loadModels=function(cb){z.app.preloader.start(1);return async.parallel(formLoader,function(err,models){_.extend(z.app.developer,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})}}app=null;linkModels=function(cb){if(id!=null){app=z.app.developer.app}else{app=new z.model.DeveloperApp}z.app.developer.form.setWrappedModel(app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_meta=new z.ui.DeveloperAppMeta({app:app});_this.placeInWrapper(_this.views.app_meta);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},authWizard:function(id,section){var extraModels,loadModels,renderViews,_this=this;if(section==null)section=\"scheme\";this.requireLogin();extraModels={};if(section===\"mapping\"){extraModels.form=async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-settings\"}))}loadModels=function(cb){return _this.loadApp(id,cb,extraModels)};renderViews=function(cb){var options;options={section:section};if(section===\"scheme\"){options.sectionView=new z.ui.DeveloperAppAuthEditorScheme}else if(section===\"fields\"){options.sectionView=new z.ui.DeveloperAppAuthEditorFields}else{z.app.developer.form.setWrappedModel(z.app.developer.app);options.sectionView=new z.ui.DeveloperAppAuthEditorForm(options)}_this.views.app_auth_editor=new z.ui.DeveloperAppAuthEditor(options);_this.placeInWrapper(_this.views.app_auth_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},authSettings:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-settings\"}))})};linkModels=function(cb){z.app.developer.form.setWrappedModel(z.app.developer.app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_auth_settings=new z.ui.DeveloperAppAuthSettings({});_this.placeInWrapper(_this.views.app_auth_settings);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},createAuthFieldWizard:function(id){return this.editAuthField(id,null,true)},editAuthFieldWizard:function(id,fieldId){return this.editAuthField(id,fieldId,true)},createAuthField:function(id){return this.editAuthField(id,null)},editAuthField:function(id,fieldId,isWizard){var field,linkModels,loadModels,renderViews,_this=this;if(isWizard==null)isWizard=false;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-field\"}))})};field=null;linkModels=function(cb){if(fieldId!=null){field=z.app.developer.app.authFields.get(fieldId)}else{field=new z.model.DeveloperAppAuthField({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_auth_field_editor=new z.ui.DeveloperAppAuthFieldEditor({field:field,isWizard:isWizard});_this.placeInWrapper(_this.views.app_auth_field_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggers:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app_triggers=new z.ui.DeveloperAppTriggers({});_this.placeInWrapper(_this.views.app_triggers);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createTrigger:function(id){return this.editTrigger(id,null,\"appearance\")},createTestTrigger:function(id){return this.editTrigger(id,null,\"appearance\",true)},editTrigger:function(id,triggerId,section,asTest){var formName,linkModels,loadModels,renderViews,sectionToFormNameMap,trigger,_this=this;if(section==null)section=\"appearance\";if(asTest==null)asTest=false;this.requireLogin();sectionToFormNameMap={appearance:\"trigger\",backend:\"trigger-source\"};formName=sectionToFormNameMap[section];loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/\"+formName}))})};trigger=null;linkModels=function(cb){if(triggerId!=null){trigger=z.app.developer.app.triggers.get(triggerId)}else if(asTest){trigger=new z.model.DeveloperAppTrigger({hide:true,important:false,test_trigger:true},{app:z.app.developer.app})}else{trigger=new z.model.DeveloperAppTrigger({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(trigger);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var options;options={trigger:trigger,section:section};options.sectionView=new z.ui.DeveloperAppTriggerEditorForm(options);_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor(options);_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},editTriggerSample:function(id,triggerId){var linkModels,loadModels,renderViews,triggerSample,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/sample\"})),triggerSample:async.fetch(new z.model.DeveloperAppTriggerSampleResult({},{appId:id,triggerId:triggerId}))})};triggerSample=null;linkModels=function(cb){triggerSample=z.app.developer.triggerSample;delete z.app.developer.triggerSample;z.app.developer.form.setWrappedModel(triggerSample);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView,trigger;trigger=z.app.developer.app.triggers.get(triggerId);sectionView=new z.ui.DeveloperAppTriggerSampleResult({trigger:trigger,triggerSample:triggerSample});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"sample\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggerFields:function(id,triggerId){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){var sectionView,trigger;trigger=z.app.developer.app.triggers.get(triggerId);sectionView=new z.ui.DeveloperAppTriggerFields({trigger:trigger});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createTriggerField:function(id,triggerId){return this.editTriggerField(id,triggerId,null)},editTriggerField:function(id,triggerId,fieldId){var field,linkModels,loadModels,renderViews,trigger,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/trigger-field\"}))})};field=null;trigger=null;linkModels=function(cb){trigger=z.app.developer.app.triggers.get(triggerId);if(fieldId!=null){field=trigger.fields.get(fieldId)}else{field=new z.model.DeveloperAppTriggerField({},{app:z.app.developer.app,trigger:trigger})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView;sectionView=new z.ui.DeveloperAppTriggerFieldEditor({field:field,trigger:trigger});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggerSettings:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/trigger-settings?app_id=\"+id}))})};linkModels=function(cb){z.app.developer.form.setWrappedModel(z.app.developer.app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_trigger_settings=new z.ui.DeveloperAppTriggerSettings({});_this.placeInWrapper(_this.views.app_trigger_settings);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},actions:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app_actions=new z.ui.DeveloperAppActions({});_this.placeInWrapper(_this.views.app_actions);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createAction:function(id){return this.editAction(id,null,\"appearance\")},editAction:function(id,actionId,section){var action,formName,linkModels,loadModels,renderViews,sectionToFormNameMap,_this=this;if(section==null)section=\"appearance\";this.requireLogin();sectionToFormNameMap={appearance:\"action\",backend:\"action-source\"};formName=sectionToFormNameMap[section];loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/\"+formName}))})};action=null;linkModels=function(cb){if(actionId!=null){action=z.app.developer.app.actions.get(actionId)}else{action=new z.model.DeveloperAppAction({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(action);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var options;options={action:action,section:section};options.sectionView=new z.ui.DeveloperAppActionEditorForm(options);_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor(options);_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},actionFields:function(id,actionId){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){var action,sectionView;action=z.app.developer.app.actions.get(actionId);sectionView=new z.ui.DeveloperAppActionFields({action:action});_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor({action:action,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createActionField:function(id,actionId){return this.editActionField(id,actionId,null)},editActionField:function(id,actionId,fieldId){var action,field,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/action-field\"}))})};field=null;action=null;linkModels=function(cb){action=z.app.developer.app.actions.get(actionId);if(fieldId!=null){field=action.fields.get(fieldId)}else{field=new z.model.DeveloperAppActionField({},{app:z.app.developer.app,action:action})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView;sectionView=new z.ui.DeveloperAppActionFieldEditor({field:field,action:action});_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor({action:action,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},requests:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{})};renderViews=function(cb){_this.views.app_requests=new z.ui.DeveloperAppRequests;_this.placeInWrapper(_this.views.app_requests);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},activate:function(id){var activationRequest,audit,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/request-global\"})),audit:async.fetch(new z.model.DeveloperAppAudit([],{appId:id}),{cache:false,persist:false})})};audit=null;activationRequest=null;linkModels=function(cb){audit=z.app.developer.audit;delete z.app.developer.audit;activationRequest=new z.model.DeveloperAppActivationRequest([],{app:z.app.developer.app});z.app.developer.form.setWrappedModel(activationRequest);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_activation=new z.ui.DeveloperAppActivation({activationRequest:activationRequest,audit:audit});_this.placeInWrapper(_this.views.app_activation);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},invite:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/email-invite\"}))})};linkModels=function(cb){var model;model=new z.model.Base;model.urlRoot=z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/invites\");z.app.developer.form.setWrappedModel(model);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_invite=new z.ui.DeveloperAppInvite;_this.placeInWrapper(_this.views.app_invite);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},chooseMigrationTarget:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.FormSet([],{url:z.cfg.devapi+\"/forms/migration-request\"}))})};renderViews=function(cb){_this.views.app_migrate_choose_target=new z.ui.DeveloperAppChooseMigrationTarget({form:z.app.developer.form});_this.placeInWrapper(_this.views.app_migrate_choose_target);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},migrate:function(id,oldAppId){var audit,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.FormSet([],{url:z.cfg.devapi+\"/forms/migration-request\"})),audit:async.fetch(new z.model.DeveloperAppAudit([],{appId:id,compareTo:oldAppId}),{cache:false,persist:false})})\n};audit=null;linkModels=function(cb){audit=z.app.developer.audit;delete z.app.developer.audit;return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_migrate=new z.ui.DeveloperAppMigrate({audit:audit,oldAppId:oldAppId});_this.placeInWrapper(_this.views.app_migrate);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},scripting:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{})};renderViews=function(cb){_this.views.app_scripting=new z.ui.DeveloperAppScripting;_this.placeInWrapper(_this.views.app_scripting);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])}});z.ui.Base=Backbone.View.extend({constructor:function(options){if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}Backbone.View.prototype.constructor.apply(this,arguments)}});z.ui.Store=Backbone.Collection.extend({retrieve:function(View){var v,_this=this;v=this.find(function(v){if(v.get(\"view\")instanceof View)return true});return v!=null?v.get(\"view\"):void 0},inject:function(view,View){var v;v=new Backbone.Model({view:view,View:view});this.add(v);return v!=null?v.get(\"view\"):void 0}});z.ui.Singleton=function(View){var Singleton,construct,store;construct=function(){var child;child=function(args){return View.apply(this,args)};child.prototype=View.prototype;return function(args){return new child(args)}};View.prototype.store=new z.ui.Store;store=View.prototype.store;return Singleton=function(){function Singleton(){var single;single=store.retrieve(View)||store.inject(construct()(arguments),View);return single}return Singleton}()};z.ui.UpgradeModal=z.ui.Base.extend({className:\"upgrade\",events:{\"click a\":\"close\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var _ref,_ref2;return{errors:(_ref=this.options)!=null?_ref.errors:void 0,hasErrors:((_ref2=this.options)!=null?_ref2.errors:void 0)!=null}},render:function(){this.$el.html(JST.common_upgrade_modal(this.context()));return this},close:function(e){var _ref;return(_ref=this.modal)!=null?_ref.close():void 0}});z.ui.ErrorModal=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},render:function(){var view;view={statusCode:this.options.statusCode,statusText:this.options.statusText,responseText:this.options.responseText};this.$el.html(\"<div style='padding: 0 50px;'>\"+view.statusCode+\" Error</div>\");return this}});z.ui.RestartModal=z.ui.Base.extend({initialize:function(options){return _.bindAll(this)},render:function(){var view;view={};this.$el.html(\"<div style='padding: 0 50px;'>Server is restarting (502 error).</div>\");return this}});z.model.ErrorHandler=z.model.Base.extend({initialize:function(){var _this=this;_.bindAll(this);this.registerAjaxHandler();this.tripwire=_.after(10,this.leave);return setInterval(function(){return _this.tripwire=_.after(10,_this.leave)},60*1e3)},leave:function(){return window.location.href=\"/wtf\"},registerAjaxHandler:function(){var _this=this;return $(document).ajaxError(function(e,xhr,settings){var msg,responseText,statusCode,statusText,url,_ref,_ref2;statusCode=xhr.status;statusText=xhr.statusText;responseText=xhr.responseText;url=settings.url;if(_this.filterForUpgrade(statusCode))_this.showUpgradeMessage(xhr);if(_this.filterForRestartMessage(statusCode))_this.showRestartMessage();if(_this.filterForErrorMessage(statusCode)){_this.tripwire();_this.showErrorMessage(statusCode,statusText,responseText)}if(_this.filterForTracking(statusCode)){try{return msg=(_ref=JSON.parse(responseText))!=null?(_ref2=_ref.errors)!=null?_ref2.join(\", \"):void 0:void 0}catch(error){return msg=responseText}}})},showErrorMessage:function(statusCode,statusText,responseText){var modal,options;options={statusCode:statusCode,statusText:statusText,responseText:responseText};return modal=new z.ui.Modal({view:new z.ui.ErrorModal(options)})},showRestartMessage:function(){var modal;return modal=new z.ui.Modal({view:new z.ui.RestartModal({})})},showUpgradeMessage:function(xhr){var modal,_ref;return modal=new z.ui.Modal({view:new z.ui.UpgradeModal({errors:((_ref=JSON.parse(xhr.responseText))!=null?_ref.errors:void 0)||[]})})},filterForRestartMessage:function(statusCode){if(statusCode===502)return true},filterForErrorMessage:function(statusCode){if(statusCode===502)return false;if(statusCode===503)return false;if(500<=statusCode&&statusCode<600)return true},filterForTracking:function(statusCode){if(405<=statusCode&&statusCode<600)return true},filterForUpgrade:function(statusCode){if(statusCode===426)return true}});z.ui.RenameModal=z.ui.Base.extend({className:\"rename\",events:{\"click .save\":\"submit\",\"submit .name\":\"submit\"},initialize:function(options){this.options=options;if(!(options.save!=null))throw\"save required\";return _.bindAll(this)},context:function(){var context;context={value:this.options.value};return context},render:function(){this.$el.html(JST.common_rename_modal(this.context()));this.$(\"input\").first().focus();return this},submit:function(e){if(e!=null)e.preventDefault();this.options.save(this.$el.find(\"input\").val());return this.modal.close()}});z.ui.ShareZapModal=z.ui.Base.extend({className:\"share-zap\",events:{\"click .submit\":\"submit\",\"submit form\":\"submit\",\"change .disabler\":\"disabler\"},initialize:function(options){var renderSubmit;this.options=options;_.bindAll(this);renderSubmit=_.debounce(this.renderSubmit,40);this.form=new z.model.FormSet({});this.form.on(\"change:valid\",renderSubmit,this);this.read=this.options.read;this.write=this.options.write;this.recipe=null;this.readNeeds=new z.model.ParamFormSet([],{node:this.read});this.writeNeeds=new z.model.ParamFormSet([],{node:this.write});if(this.read.id){return z.store.set(this.read.id+\"-shared\",\"yes\",{expires:1})}},context:function(){var context;context={};context.zapTitle=this.read.getTitle();context.readClass=this.read.serviceImageClass();context.writeClass=this.write.serviceImageClass();return context},render:function(){var context;context=this.context();this.$el.html(JST.common_share_zap_modal(context));this.$paramform=this.$(\"paramform\");this.renderForm();return this},thanksContext:function(){var declaration,e,out,read_service,what_is_zapier,write_service,zapier_image,_ref;out={};out.recipe=(_ref=this.recipe)!=null?_ref.toJSON():void 0;if(out.recipe){e=encodeURIComponent;read_service=z.app.services.get(this.read.get(\"selected_api\"));write_service=z.app.services.get(this.write.get(\"selected_api\"));zapier_image=z.cfg.mediaURL+\"images/frontend/placeholder/128x128.png\";declaration=\"I just connected \"+read_service.getName()+\" to \"+write_service.getName()+\" with Zapier!\";what_is_zapier=\"Zapier makes it easy to integrate hundreds of business web applications without writing a single line of code.\";out.twitter_href=\"https://twitter.com/intent/tweet?text=\"+e(declaration)+\"+\"+e(\"Check it out!\")+\"+\"+e(out.recipe.share_url);out.facebook_href=\"https://www.facebook.com/dialog/feed?app_id=234230510040096&redirect_uri=\"+e(\"https://zapier.com/\")+\"&link=\"+e(out.recipe.share_url_raw)+\"&name=\"+e(declaration)+\"&description=\"+e(what_is_zapier)+\"&picture=\"+e(zapier_image);out.linkedin_href=\"http://www.linkedin.com/shareArticle?mini=true&url=\"+e(out.recipe.share_url_raw)+\"&title=\"+e(declaration)+\"&summary=\"+e(what_is_zapier)+\"&source=\"+e(\"Zapier\");out.email_href=\"mailto:your@friend.com?subject=\"+e(declaration)+\"&body=\"+e(what_is_zapier)+\"+\"+e(out.recipe.share_url)}return out},renderThanks:function(){this.$el.html(JST.common_share_thanks_modal(this.thanksContext()));this.modal.reposition();return this},prunePrefillsAndEmpty:function(fields){var thing;return thing=6},renderForm:function(){var fields,loadReads,loadWrites,_this=this;fields=[{key:\"description\",label:\"What problem does this Zap solve?\",type:\"text\",required:true,help_text:\"Briefly describe what problem this Zap solves for you, and how it solves it.\"},{key:\"directions\",type:\"copy\",required:false,help_text_html:'<h3>Customize Template Fields</h3><span class=\"arr\">&darr;</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checked fields below will be shared.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Changes made here <strong>will not</strong> affect your zap.'}];loadReads=function(cb){return _this.readNeeds.fetch({cache:false,success:function(){return cb()},error:function(){return cb()}})};loadWrites=function(cb){return _this.writeNeeds.fetch({cache:false,success:function(){return cb()},error:function(){return cb()}})};this.setMode(\"loading\",\"fields\");return async.series([loadReads,loadWrites],function(err,result){_this.setMode(\"loaded\",\"fields\");_this.readNeeds.each(function(field){field=field.toJSON();if(field.list!=null)delete field.list;return _.each(_this.read.get(\"params\"),function(value,key,list){if(field.key===key&&value&&!field.prefill){field.label=\"Trigger: \"+(field.label||_.superHumanize(field.key));field.key=\"read_data__params__\"+field.key;field.required=false;field.value=value;return fields.push(field)}})});_this.writeNeeds.each(function(field){field=field.toJSON();if(field.list!=null)delete field.list;return _.each(_this.write.get(\"params\"),function(value,key,list){if(field.key===key&&value&&!field.prefill){field.label=\"Action: \"+(field.label||_.superHumanize(field.key));field.key=\"write_data__params__\"+field.key;field.required=false;field.value=value;return fields.push(field)}})});_this.form.reset(fields);_this.paramform=new z.ui.ParamForm({form:_this.form,prettypills:true});_this.$paramform.html(_this.paramform.render().el);_.each(_this.$paramform.find(\".field\").not(\".field-description,.field-directions\"),function(el){var input,name;el=$(el);name=el.find(\"[data-id]\").attr(\"data-id\");input=$(\"<input />\").attr({name:\"hide__\"+name,\"org-name\":name,type:\"checkbox\",\"class\":\"disabler\",checked:\"true\",title:\"Uncheck to not share this field with your Zap.\"});el.prepend($('<small class=\"\">'));return el.prepend(input)});_this.modal.reposition();return _this.renderSubmit()})},disabler:function(e){var referenced,sel;if(e!=null)e.preventDefault();sel=$.escapeSel($(e.currentTarget).attr(\"org-name\"));referenced=this.$paramform.find(\"[data-id=\"+sel+\"]\").parent().parent();if($(e.currentTarget).is(\":checked\")){return referenced.removeClass(\"disabled\")}else{return referenced.addClass(\"disabled\")}},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},submit:function(e){var data,disabled_names,error,success,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");data=this.form.getValues();success=function(model,resp,opts){var _ref;_this.recipe=new z.model.Recipe(resp);_this.read.set({has_shared:true});z.app.track[\"new\"](\"Shared Zap\",{path:window.location.pathname});if((_ref=_this.options.success)!=null)_ref.call(_this,_this.recipe);return _this.renderThanks()};error=function(model,xhr,opts){var errors,_ref;_this.setMode(\"enable\",\"submit\");errors=z.useful.errors(xhr);_this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(errors);return(_ref=_this.options.error)!=null?_ref.apply(_this,arguments):void 0};disabled_names=_.map(this.$paramform.find(\".disabler:not(:checked)\"),function(el){return $(el).attr(\"org-name\")});_.each(disabled_names,function(disabled_name){return delete data[disabled_name]});data=_.unflatten(_.compactObject(data));return this.options.read.share(data,{success:success,error:error})}});z.ui.AuthErrorModal=z.ui.Base.extend({className:\"raw-error\",initialize:function(options){this.options=options;_.bindAll(this);if(this.options.auth!=null){return this.service=z.app.services.get(this.options.auth.get(\"selected_api\"))}},context:function(){var context,_ref;return context={type:this.options.type,hasUpfronts:(_ref=this.service)!=null?_ref.hasUpfronts():void 0,message:this.options.message}},render:function(){this.$el.html(JST.common_auth_error_modal(this.context()));return this}});z.ui.CollectEmailModal=z.ui.Base.extend({className:\"collect-email\",events:{\"submit form\":\"submit\",\"click input[type=submit]\":\"submit\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){},render:function(){this.$el.html(JST.common_collect_email_modal(this.context()));z.useful.placeholders(this.$el);return this},submit:function(e){var email,options,s1,s2,_this=this;if(e!=null)e.preventDefault();this.$(\".feedback\").removeClass(\"success error hide\").addClass(\"hide\");email=this.$(\"#email\").val();s1=this.options.s1;s2=this.options.s2;options={url:\"/api/v2/email/\"+s1+\"/\"+s2,type:\"post\",dataType:\"json\",data:JSON.stringify({email:email}),success:function(model,resp){var _ref;_this.$(\".feedback\").addClass(\"success\").removeClass(\"hide\").text(\"Thank you! We will email you when we have news.\");_.delay(function(){return _this.modal.close()},3e3);return(_ref=_this.options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(model,xhr){return this.$(\".feedback\").addClass(\"error\").removeClass(\"hide\").text(z.useful.errors(xhr))}};return Backbone.sync(\"create\",this,options)}});z.ui.AuthRequestModal=z.ui.Base.extend({className:\"request-auth\",events:{\"click .submit\":\"submit\",\"submit form\":\"submit\"},initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,options);this.form=new z.model.FormSet({});return this.form.on(\"change:valid\",this.renderSubmit,this)},context:function(){var context;context={service:this.options.service};return context},render:function(){this.$el.html(JST.common_auth_request_modal(this.context()));this.$paramform=this.$(\"paramform\");this.renderForm();return this},renderForm:function(){var fields;fields=[{key:\"email\",label:\"Email Address\",type:\"unicode\",required:true,help_text:\"The person you need access from.\"}];this.form.reset(fields);this.paramform=new z.ui.ParamForm({form:this.form});return this.$paramform.html(this.paramform.render().el)},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},submit:function(e){var data,error,success,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");data=this.form.getValues();data[\"selected_api\"]=this.options.service.get(\"key\");success=function(model,resp){_this.$(\".feedback\").removeClass(\"hide\").text(\"Request has been sent!\");return _.delay(function(){return _this.modal.close()},3500)};error=function(model,xhr){var errors;errors=z.useful.errors(xhr);return _this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(errors)};return z.app.auths.request(data,{success:success,error:error})}});z.ui.AuthEditModal=z.ui.Base.extend({className:\"menu with-hover\",events:{\"click .rename\":\"rename\",\"click .manage\":\"manage\",\"click .delete\":\"delete\"},initialize:function(options){this.options=options;if(!(options.auth!=null))throw\"auth required\";return _.bindAll(this)},context:function(){var context;context={onEditor:this.options.onEditor,od:this.options.auth.id};return context},render:function(){this.$el.html(JST.common_auth_edit_modal(this.context()));return this},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.options.auth.save({title:value})};this.modal.close();return modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.options.auth.get(\"title\"),save:save})})},manage:function(e){if(e!=null)e.preventDefault();this.modal.close();return Backbone.history.navigate(\"app/settings/authorizations\",{trigger:true})},\"delete\":function(e){var context,destroy,message,modal,_this=this;if(e!=null)e.preventDefault();destroy=function(value){return _this.options.auth.destroy()};context={service:this.options.auth.get(\"selected_api\"),title:this.options.auth.get(\"title\")};message=new Handlebars.SafeString(JST.common_auth_delete_message(context));this.modal.close();return modal=new z.ui.Modal({view:new z.ui.ConfirmModal({message:message,yes:destroy})})}});z.ui.DataTableModal=z.ui.Base.extend({className:\"data-table\",events:{\"click td.value\":\"clickValue\"},initialize:function(options){this.options=options;if(!(options.data!=null))throw\"data required\";return _.bindAll(this)},render:function(){this.$el.html(JST.common_data_table_modal({data:this.options.data}));return this},clickValue:function(e){return this.$(e.currentTarget).toggleClass(\"nomax\")}});z.ui.MenuModal=z.ui.Base.extend({className:\"menu with-hover\",events:{\"click a\":\"close\",\"click [data-nav=logout]\":\"logout\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={email:z.app.account.get(\"email\"),developer:z.app.account.isDeveloper()};return context},render:function(){this.$el.html(JST.common_menu_modal(this.context()));this.$(\"input\").first().focus();return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},logout:function(e){if(e!=null)e.preventDefault();Backbone.cache.lawnchair.nuke();return z.useful.goto(\"/logout\")}});z.ui.ModalContentHTML=z.ui.Base.extend({html:null,className:\"plain-html\",initialize:function(options){this.options=options;_.bindAll(this);return this.html=options.view},render:function(){this.$el.html(this.html);this.$el.addClass(this.options[\"class\"]);return this}});z.ui.Modal=z.ui.Base.extend({tagName:\"div\",className:\"modal-layer\",events:{click:\"click\",\"click .close\":\"close\",\"click .x\":\"close\"},initialize:function(options){var _this=this;this.options=options;if(!(options.view!=null))throw\"view required\";_.bindAll(this);if(!(this.options.autoFocus!=null))this.options.autoFocus=true;if(!(this.options.shortenToFit!=null))this.options.shortenToFit=false;this.delegateEvents(_.extend(this.events,this.options.events));this.view=this.options.view;if(_.isString(this.options.view)){this.view=new z.ui.ModalContentHTML(this.options)}this.view.modal=this;this.reposition=_.bind(_.throttle(this.position,50),this);this.on(\"remove\",function(){var _ref,_ref2;_this.view.remove();if((_ref=$(window))!=null)_ref.off(\"resize\",_this.reposition);if((_ref2=$(window))!=null)_ref2.off(\"scroll\",_this.reposition);z.app.off(\"render\",_this.reposition);Backbone.history.off(\"route\",_this.clearClicks);return z.app.off(\"click\",_this.addClick)});return this.render()},render:function(){var target,_ref,_ref2,_this=this;this.clicks=_.clone(z.app.clicks);$(window).on(\"resize\",this.reposition);$(window).on(\"scroll\",this.reposition);z.app.on(\"click\",this.addClick);Backbone.history.on(\"route\",this.clearClicks);z.app.on(\"render\",this.reposition);this.setMode(\"is\",\"open\");this.$el.html(JST.common_base_modal(this.options));this.$container=this.$(\".modal-container\");this.$modal=this.$(\".modal\");this.$modal.html(this.view.render().el);target=$(\"body .modal-layer\").last();if(target.length>0){this.$el.insertAfter(target)}else{this.$el.appendTo($(\"body\"))}if(!this.haveTarget()){this.$el.removeClass(\"with-dim\").addClass(\"with-dim\");this.renderDim()}if((_ref=this.options)!=null?_ref.noLayer:void 0){this.$el.removeClass(\"no-layer\").addClass(\"no-layer\")}if((_ref2=this.options)!=null?_ref2.noBackgroundClose:void 0){this.$el.addClass(\"no-bg-close\")}if(this.options.width!=null){this.$container.css(\"width\",this.options.width)}if(this.options.width!=null)this.$modal.css(\"width\",this.options.width);_.defer(function(){return _this.position()});if(z.cfg.browser!==\"Explorer\"&&this.options.autoFocus){_.defer(function(){return _this.$(\"input\").first().focus()})}if(this.options.shortenToFit){_.defer(function(){return _this.shortenToFit()})}return this},setLayerSize:function(){return this.$el.css(\"height\",$(\"body\").height())},addClick:function(e){this.clicks.unshift(e);return this.clicks=this.clicks.slice(0,10)},clearClicks:function(){return this.clicks=[]},position:function(){var bheight,bwidth,click,height,width,x,y,_ref,_ref2,_ref3,_ref4,_this=this;if(!(this.$modal!=null))return;if(this.haveTarget()){x=$(this.options.target).offset().left;y=$(this.options.target).offset().top;this.setMode(\"not\",\"global\")}else if(((_ref=z.app.partner)!=null?_ref.isPartnerSession():void 0)&&((_ref2=z.app.partner)!=null?_ref2.hasIframeJs:void 0)){click=_.find(this.clicks,function(click){return click.clientY!=null});_ref3=z.useful.viewportSize(),bwidth=_ref3[0],bheight=_ref3[1];width=this.$modal.outerWidth(true);height=this.$modal.outerHeight(true);x=bwidth/2-width/2;y=click!=null?click.clientY-height/2:50;this.setMode(\"is\",\"global\")}else{_ref4=z.useful.viewportSize(),bwidth=_ref4[0],bheight=_ref4[1];width=this.$modal.outerWidth(true);height=this.$modal.outerHeight(true);x=bwidth/2-width/2;y=bheight*(9/20)-height/2;if(y<40){y=40;bheight-=60}this.setMode(\"is\",\"global\")}if(this.options.x!=null)x+=Number(this.options.x);if(this.options.y!=null)y+=Number(this.options.y);if(this.haveTarget()){this.$container.css(\"left\",x);this.$container.css(\"top\",y)}else{this.$modal.css(\"maxHeight\",bheight);if(this.$modal.height()>=$(\".modal-container\").height()){this.$modal.css(\"padding-bottom\",\"60px\")}}return this.$modal.removeClass(\"invisible\")},haveTarget:function(){return this.options.target!=null&&this.options.target.length>0},targetWidth:function(){var _ref;return(_ref=$(this.options.target))!=null?_ref.outerWidth():void 0},renderDim:function(){var open;open=this.countOpen(true);$(\".header, .app, .footer\").removeClass(\"dim\");$(\".modal-container\").removeClass(\"dim\").addClass(\"dim\");return $(\".modal-container\").last().removeClass(\"dim\")},countOpen:function(withDim){var search;if(withDim==null)withDim=false;search=\"body .modal-layer\";if(withDim)search+=\".with-dim\";return $(search).length},click:function(e){if(e!=null&&$(e.target).hasClass(\"modal-container\")){return this.close()}if(e!=null&&$(e.target).hasClass(\"modal-layer\"))return this.close()},close:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if(!this.isOpen())return;this.setMode(\"not\",\"open\");if((_ref=this.options)!=null){if(typeof _ref.close===\"function\")_ref.close()}this.remove();return this.renderDim()},isOpen:function(){return this.hasMode(\"is\",\"open\")},detach:function(){return this.$el.detach()},attach:function(){this.$el.appendTo($(\"body\"));return this.renderDim()},shortenToFit:function($el,i){var height;if(i==null)i=0;if(!($el!=null))$el=this.$(\".modal\").children().first();if(z.useful.elClippedByScreenBottom($el[0])&&i<50){height=$el.outerHeight();$el.css(\"height\",height-10);return this.shortenToFit($el,i+1)}}});z.ui.SelectModal=z.ui.Base.extend({className:\"select with-hover\",events:{\"click [data-key]\":\"click\",\"click a\":\"close\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){return _this.$el.off(\"mousewheel DOMMouseScroll\")})},context:function(){var context;context={choices:this.options.choices};return context},render:function(){var context;context=this.context();this.$el.html(JST.common_select_modal(context));z.useful.noBGScroll(this.$el);return this},click:function(e){var key,value;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();key=$(e.currentTarget).attr(\"data-key\");value=$(e.currentTarget).attr(\"data-value\");this.options.choose(key,value);return this.modal.close()},close:function(e){if(e!=null)e.preventDefault();return this.modal.close()}});z.ui.SinceYouBeenGoneModal=z.ui.Base.extend({className:\"since-you-been-gone\",initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.updates=this.options.model;return this.on(\"remove\",function(){return z.useful.noBGScrollOff(_this.modal.$el.find(\"div.modal\"))})},context:function(){var context;context={};context.updates=this.updates;return context},render:function(){this.$el.html(JST.common_since_you_been_gone_modal(this.context()));z.useful.noBGScroll(this.modal.$el.find(\"div.modal\"));return this},close:function(e){return this.modal.close()}});z.ui.ConfirmModal=z.ui.Base.extend({className:\"confirm\",events:{\"click .yes\":\"clickYes\",\"click .no\":\"clickNo\"},initialize:function(options){var _this=this;this.options=options;if(!(options.message!=null)&&!(options.jst!=null)){throw\"message or JST required\"}_.bindAll(this);$(document).on(\"keyup\",this.keyup);return this.on(\"remove\",function(){return $(document).off(\"keyup\",_this.keyup)})},context:function(){return{message:this.options.message}},render:function(){if(this.options.jst!=null){this.$el.html(this.options.jst())}else{this.$el.html(JST.common_confirm_modal(this.context()))}return this},clickYes:function(e){var _ref;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.yes)!=null?_ref.call(this):void 0},clickNo:function(e){var _ref;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.no)!=null?_ref.call(this):void 0},keyup:function(e){if(e.keyCode!=null&&e.keyCode===13)return this.clickYes()}});z.ui.AuthCreateModal=z.ui.Base.extend({className:\"new-auth\",events:{\"click .send-confirmation\":\"confirmation\",\"click .submit\":\"submit\",\"submit form\":\"submit\"},initialize:function(options){var _this=this;this.options=options;if(!(options.service!=null))throw\"service required\";_.bindAll(this);_.defaults(this,options);this.setMode(\"disable\",\"submit\");this.form=new z.model.FormSet(this.service.getUpfronts());this.setDefaultTitle();this.form.on(\"change:valid\",this.renderSubmit,this);this.on(\"remove\",function(){_this.stopPoll();return _this.paramform.remove()});this.oauthId=_.random(1e6,9999999);return z.oauth=function(url){var data,_ref;if(!_this.form.isValid())return;if(_this.hasMode(\"disable\",\"submit\"))return;if(!((_ref=_this.service.get(\"meta\"))!=null?_ref.oauth:void 0)){return}data=_this.form.getValues();data[\"id\"]=_this.oauthId;url=url+\"?\"+$.param(data);return z.useful.open(url,true,\"New Auth\")}},setDefaultTitle:function(){var name,row,service;row=this.form.get(\"title\");name=z.app.account.get(\"partner_email\")||z.app.account.get(\"email\");service=this.options.service.getName();return row.set({value:\"\"+name+\"'s \"+service+\" account\"})},context:function(){var context,url,_ref,_ref2;url=(_ref=this.service.get(\"meta\"))!=null?_ref.oauth_302_url:void 0;context={onclick:\"z.oauth('\"+url+\"');\",serviceHelpQueryString:$.param({q:\"How To Get Started with \"+((_ref2=this.service)!=null?_ref2.getName():void 0)})};return context},render:function(){this.$el.html(JST.common_auth_create_modal(this.context()));this.$paramform=this.$(\"paramform\");this.renderForm();this.renderSubmit();return this},renderForm:function(){this.paramform=new z.ui.ParamForm({form:this.form,prettypills:true});return this.$paramform.html(this.paramform.render().el)},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},confirmation:function(e){var data,error,key,row,s200,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"confirm\"))return;key=$(e.target).attr(\"data-id\");row=this.form.find(function(row){return row.get(\"key\")===key});row.set({sentConfirmation:true});s200=function(){_this.setMode(\"enable\",\"confirm\");return _this.confirmationButtonToText(key)};error=function(){_this.setMode(\"enable\",\"confirm\");return _this.$(\".send-confirmation\").text(\"Error sending PIN\")};this.filtered=this.form.filter(function(row){if(row.get(\"type\")===\"confirmation\")return false;return true});this.filtered=new z.model.FormSet(this.filtered);data=this.filtered.getValues();data.selected_api=this.service.get(\"key\");this.setMode(\"disable\",\"confirm\");this.$(\".feedback\").removeClass(\"error hide\").addClass(\"hide\");$(\".send-confirmation\").text(\"Sending PIN...\");return z.app.auths.create(data,{s200:s200,error:error})},confirmationButtonToText:function(key){this.$(\".input-confirmation\").removeClass(\"hide\");return this.$(\".send-confirmation\").removeClass(\"hide\").addClass(\"hide\")},confirmationTextToButton:function(){this.$(\".input-confirmation\").removeClass(\"hide\").addClass(\"hide\");return this.$(\".send-confirmation\").removeClass(\"hide\")},submit:function(e){var auth,authError,data,errorAdding,foundNewAuth,oauthError,oauthSuccess,successAdding,_ref,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");authError=function(message){var context,modal;context={service:_this.service,message:message,type:\"automatic\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context),force:true})};foundNewAuth=function(auth){var id,testError,testSuccess;id=auth.id;_this.$(\".feedback\").removeClass(\"hide\").text(\"Testing for problems...\");testSuccess=function(){var _base;z.app.auths.add(auth);if(typeof(_base=_this.options).success===\"function\"){_base.success(auth)}return _this.modal.close()};testError=function(model,xhr){_this.setMode(\"enable\",\"submit\");_this.$(\".feedback\").addClass(\"hide\").text(\"\");authError(z.useful.errors(xhr));return auth!=null?auth.destroy():void 0};return auth.test({success:testSuccess,error:testError})};oauthSuccess=function(json){var auth;_this.stopPoll();auth=new z.model.Auth({id:json.auth_id});auth.fetch();return foundNewAuth(auth)};oauthError=function(message){_this.stopPoll();_this.modal.close();return authError(message)};this.startPoll(1e3,360,this.oauthId,{success:oauthSuccess,error:oauthError});if((_ref=this.service.get(\"meta\"))!=null?_ref.oauth:void 0){return this.$(\".feedback\").removeClass(\"hide\").text(\"Looking for new Account...\")}else{successAdding=function(model,resp){_this.stopPoll();z.app.auths.add(model);return foundNewAuth(model)};errorAdding=function(model,xhr){var errors;_this.stopPoll();_this.setMode(\"enable\",\"submit\");errors=z.useful.errors(xhr);if(_.str.include(errors,\"Confirmation code did not match.\")){_this.$(\".send-confirmation\").text(\"Send PIN again\");_this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(\"Confirmation PIN did not match. Try again.\");return _this.confirmationTextToButton()}};data=this.form.getValues();data[\"selected_api\"]=this.service.get(\"key\");this.$(\".feedback\").removeClass(\"hide\").text(\"Working...\");return auth=new z.model.Auth(data).save({},{success:successAdding,error:errorAdding})}},startPoll:function(interval,maxiter,oauthId,options){return this.poll=z.app.auths.pollForNewAuth(1e3,360,this.oauthId,options)},stopPoll:function(){return clearInterval(this.poll)}});z.ui.CreateCollectionModal=z.ui.Base.extend({className:\"create-collection\",events:{\"click .save\":\"submit\",\"submit .name\":\"submit\"},initialize:function(options){var paginatedRecipes;this.options=options;_.bindAll(this);paginatedRecipes=new z.model.RecipeSet([],{pagination:{page:1,perPage:3},filters:{userid:z.app.account.id,status:\"all\"}});paginatedRecipes.fetch();options={recipes:paginatedRecipes};this.embedView=new z.ui.EmbededZaps({embed:z.app.embed});return this.sharedZapsView=new z.ui.EmbedSharedZaps(options)},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.common_create_collection_modal(this.context()));this.$shared=this.$(\".results\");this.$embed=this.$(\".embed\");this.$shared.html(this.sharedZapsView.render().el);this.$embed.html(this.embedView.render().el);return this},submit:function(e){if(e!=null)e.preventDefault();this.options.save(this.$el.find(\"input\").val());return this.modal.close()}});z.ui.UnpauseErrorModal=z.ui.Base.extend({className:\"raw-error\",initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;return context={message:this.options.message}},render:function(){this.$el.html(JST.common_unpause_error_modal(this.context()));return this}});z.ui.ServicePickerModal=z.ui.Base.extend({className:\"service-picker services\",PER_PAGE:21,SCROLL_TARGET:\".selector\",events:{\"click .reset\":\"reset\",\"keyup .search\":\"search\",\"click .selector .panel\":\"select\",\"mousedown .scroll\":\"beginManualScroll\"},initialize:function(options){var _this=this;\n_.bindAll(this);_.defaults(this,options);this.setMode(\"cannot\",\"reset\");return this.on(\"remove\",function(){_this.$el.off(\"mousewheel DOMMouseScroll\");return _this.$(\".selector\").off()},this)},context:function(){var context;context={search:this.state.get(\"search\")};return context},render:function(){this.$el.html(JST.common_service_picker_modal(this.context()));this.renderSelector();this.renderModes();this.$(this.SCROLL_TARGET).on(\"scroll\",this.scroll);z.useful.noBGScroll(this.$(\"ul.selector\"));return this},renderSelector:function(){var html,search,services,_this=this;search=this.getSearch().toLowerCase().replace(\" \",\"\");html=\"\";services=z.app.services.filter(function(service){var key,name;name=z.useful.squish(service.getName().toLowerCase());key=service.get(\"key\");if(!_.str.include(name,search))return false;return true});_.each(services,function(service){var context,key;key=service.get(\"key\");context={name:service.getName(),service:key,selected:false};return html+=JST.common_service_panel(context)});this.$(\".selector\").html(html);this.renderSelected();return _.defer(function(){return _this.renderScroll()})},renderSelected:function(){var _this=this;this.$(\".selected\").removeClass(\"selected\");return _.defer(function(){return _this.$(\".selector\").scrollTop(_this.state.get(\"scroll\"))})},renderModes:function(){var _ref;if(((_ref=this.getSearch())!=null?_ref.length:void 0)>0){return this.setMode(\"can\",\"reset\")}else{return this.setMode(\"cannot\",\"reset\")}},rerenderSelector:function(){this.renderSelector();return this.renderModes()},search:function(e){var _ref;if(e.keyCode!=null&&e.keyCode===13){if((_ref=this.$(\".selector .panel\").first())!=null){_ref.trigger(\"click\")}}this.state.set(\"search\",this.getSearch());this.rerenderSelector();return this.resetScroll()},reset:function(e){if(e!=null)e.preventDefault();this.$(\".search\").val(\"\");this.state.set(\"search\",\"\");this.rerenderSelector();return this.resetScroll()},getSearch:function(){return this.$(\".search\").val()},select:function(e){var key;if(e!=null)e.preventDefault();key=this.$(e.currentTarget).attr(\"id\");this.options.choose(key);return this.modal.close()},scroll:function(e){var barHeight,contentHeight,max,percent,pos,visualHeight;pos=this.$(this.SCROLL_TARGET).scrollTop();contentHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;visualHeight=this.$(this.SCROLL_TARGET).innerHeight();percent=pos/(contentHeight-visualHeight);barHeight=this.$(\".scroll\").innerHeight();max=visualHeight-barHeight;pos=Math.round(max*percent);this.$(\".scroll\").css(\"top\",pos+\"px\");if(e!=null){return this.state.set(\"scroll\",this.$(this.SCROLL_TARGET).scrollTop())}},renderScroll:function(){var height,percent,scrollHeight;height=this.$(this.SCROLL_TARGET).innerHeight();scrollHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;percent=height/scrollHeight;this.$(\".scroll\").css(\"height\",Math.round(height*percent)+\"px\");return this.scroll()},resetScroll:function(){this.$(\".scroll\").css(\"top\",\"0px\");return this.state.set(\"scroll\",this.$(this.SCROLL_TARGET).scrollTop())},beginManualScroll:function(e){if(e!=null)e.preventDefault();this.manualScroll=true;this.setMode(\"manual\",\"scroll\");this.scrollOffset=e.pageY-this.$(\".scroll\").offset().top;$(window).on(\"mouseup\",this.endManualScroll);return $(window).on(\"mousemove\",this.updateManualScroll)},updateManualScroll:function(e){var height,percent,rawPos,scrollHeight,top,y;if(!(e!=null))return;y=e.pageY-this.scrollOffset;top=this.$(this.SCROLL_TARGET).offset().top;height=this.$(this.SCROLL_TARGET).innerHeight();scrollHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;percent=(y-top)/height;rawPos=Math.round(scrollHeight*percent);return this.$(this.SCROLL_TARGET).scrollTop(rawPos)},endManualScroll:function(e){if(e!=null)e.preventDefault();this.setMode(\"no\",\"scroll\");$(window).off(\"mouseup\",this.endManualScroll);return $(window).off(\"mousemove\",this.updateManualScroll)}});z.ui.RunZap=z.ui.Base.extend({className:\"run-zap\",initialize:function(options){var _this=this;this.options=options;if(!(options.read!=null))throw\"read required\";_.bindAll(this);this.messages=[];this.on(\"remove\",function(){return clearInterval(_this.interval)});return this.run()},context:function(){var context;context={title:this.options.read.getTitle(),messages:this.messages,noItemsFound:this.noItemsFound};return context},render:function(){this.$el.html(JST.common_run_zap_modal(this.context()));return this},run:function(){var success,_this=this;this.noItemsFound=false;success=function(){_this.interval=setInterval(_this.status,1e3);return _.delay(function(){return clearInterval(_this.interval)},3e4)};return this.options.read.run({success:success})},status:function(){var complete,_this=this;complete=function(model,resp){_this.messages=resp.messages;_.each(_this.messages,function(message){if(_.str.include(message,\"Found 0\"))_this.noItemsFound=true;if(_.str.include(message,\"failed:\"))clearInterval(_this.interval);if(_.str.include(message,\"success:\")){return clearInterval(_this.interval)}});return _this.render()};return this.options.read.runStatus({success:complete,error:complete})}});z.ui.LoginModal=z.ui.Base.extend({className:\"login\",events:{\"click a\":\"close\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){return _this.$(\"form\").addClass(\"hide\").appendTo($(\"body\"))})},context:function(){},render:function(){var $el;$el=$(\"#login-form\");if(($el!=null?$el.length:void 0)>0){this.$el.html($el.removeClass(\"hide\"))}else{this.$el.html(JST.common_login_modal(this.context()))}z.useful.placeholders(this.$el);return this},close:function(e){return this.modal.close()}});z.ui.ParamForm=z.ui.Base.extend({className:\"paramform\",initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.views=[];this.options.form.on(\"add\",this.insertAdd);return this.on(\"remove\",function(){return _.each(_this.views,function(view){return view.remove()})},this)},render:function(){var _this=this;this.$el.empty();this.options.form.each(function(row){var view;view=new z.ui.ParamFormRow({model:row,form:_this.options.form,options:_this.options});_this.views.push(view);return _this.$el.append(view.render().el)});return this},insertAdd:function(model){var index,view;index=this.options.form.indexOf(model);view=new z.ui.ParamFormRow({model:model,form:this.options.form,options:this.options});this.views.push(view);return this.$(\".field\").eq(index-1).after(view.render().el)},refreshPrettypills:function(){var _this=this;return _.each(this.views,function(view){var _ref;if(view!=null)if((_ref=view.prettypill)!=null)_ref.refresh();return view!=null?view.prettypillHeight():void 0})}});z.ui.DeveloperAppParamForm=z.ui.ParamForm.extend({clearErrors:function(){this.$(\".field .errorlist\").empty().hide();return this.$el.parent().find(\".paramform > ul.errorlist\").empty().hide()},renderErrors:function(errors){var feedback,_this=this;this.clearErrors();_.each(errors,function(fieldErrors,fieldKey){var feedback,field;field=_this.$(\".field.field-\"+_.slugify(fieldKey));if(field.find(\".errorlist\").length>0){feedback=field.find(\".errorlist\").show()}else{feedback=$('<ul class=\"errorlist\"/>').appendTo(field)}return _.each(fieldErrors,function(error){return feedback.append($(\"<li/>\").html(error))})});if(errors!=null?errors.general:void 0){if(this.$el.parent().find(\".paramform > ul.errorlist\").length>0){feedback=this.$el.parent().find(\".paramform > ul.errorlist\").show()}else{feedback=$('<ul class=\"errorlist\"/>').appendTo(this.$el)}_.each(errors.general,function(error){return feedback.append($(\"<li/>\").html(error))})}}});var __indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};z.ui.ParamFormRow=z.ui.Base.extend({events:{\"change [data-input]\":\"hardChange\",\"input [data-input]\":\"softChange\",\"mousedown [data-input]\":\"fillButton\",\"mousedown .fill-button\":\"fillButton\",\"mousedown .add-placeholder\":\"addPlaceholder\",\"click .add\":\"listAdd\",\"click .remove\":\"listRemove\"},className:function(){var key,name,type,_ref,_ref2,_ref3;name=\"field\";if(type=this.model.get(\"type\"))name+=\" \"+type;if(((_ref=this.model)!=null?_ref.get(\"prefill\"):void 0)!=null){name+=\" prefill\"}if(this.model.get(\"choices\")||this.model.get(\"givefill\")){name+=\" selectfill\"}if(((_ref2=this.model)!=null?_ref2.get(\"list\"):void 0)!=null){name+=\" list\"}if(((_ref3=this.model)!=null?_ref3.get(\"input_format\"):void 0)!=null){name+=\" copy-button-container\"}if(key=_.slugify(this.model.get(\"key\")))name+=\" field-\"+key;return name},initialize:function(options){var clearPrefillCache,clearUserfillCache,_ref,_ref2,_ref3,_ref4,_this=this;this.options=options;_.bindAll(this);this.model=this.options.model;this.model.on(\"remove\",this.remove,this);this.model.state.on(\"change:busy\",this.checkBusy,this);this.model.on(\"change:list change:isChild\",this.renderParentChild,this);this.model.on(\"change:valid\",this.renderValid,this);this.model.on(\"change:value\",this.valueToClipButton,this);this.model.on(\"change:value change:display\",this.set,this);if((_ref=this.options.form)!=null){_ref.on(\"change\",this.renderRule,this)}this.node=(_ref2=this.options.options)!=null?(_ref3=_ref2.userfill)!=null?_ref3.node:void 0:void 0;if(this.node!=null){clearUserfillCache=_.debounce(function(){var _ref4,_ref5,_ref6;return Backbone.cache.clear((_ref4=_this.userfillModal)!=null?(_ref5=_ref4.view)!=null?(_ref6=_ref5.gives)!=null?_ref6.url():void 0:void 0:void 0)},40);this.node.on(\"change:selected_api change:action change:authentication_id\",clearUserfillCache,this)}if((_ref4=this.model)!=null?_ref4.node:void 0){clearPrefillCache=_.debounce(function(){var _ref5,_ref6,_ref7;delete _this.prefillSamples;return Backbone.cache.clear((_ref5=_this.prefillModal)!=null?(_ref6=_ref5.view)!=null?(_ref7=_ref6.samples)!=null?_ref7.url():void 0:void 0:void 0)},40);this.model.node.on(\"change:authentication_id\",clearPrefillCache,this)}return this.on(\"remove\",function(){var _ref5,_ref6,_ref7,_ref8;if((_ref5=_this.userfillModal)!=null)_ref5.close();if((_ref6=_this.prefillModal)!=null)_ref6.close();if((_ref7=_this.selectfillModal)!=null)_ref7.close();return(_ref8=_this.givefillModal)!=null?_ref8.close():void 0},this)},context:function(){var choices,context,_ref;context=_.extend({},this.model.toJSON(),{model:this.model});context.val=this.model.getDisplay();if(_.isArray(context.val)){context.val=context.val.join(\",\")}else if(this.model.get(\"type\")===\"json\"&&context.val!=null&&context.val){context.val=JSON.stringify(context.val,null,4)}else if(this.model.get(\"choices\")){choices=this.model.get(\"choices\");if($.isPlainObject(choices))context.val=choices[context.val]}context.userfill=this.options.options.userfill!=null&&this.model.isUserfill();context.userfillClass=(_ref=this.options.options.userfill)!=null?typeof _ref[\"class\"]===\"function\"?_ref[\"class\"]():void 0:void 0;context.cid=z.app.account.id;context.ccode=z.app.account.get(\"code\");context.givefill=this.model.get(\"givefill\")!=null;return context},template:function(){var type;type=this.model.get(\"type\");if(type===\"select\"){return JST.common_form_select_row(false)}else if(type===\"password\"){return JST.common_form_password_row(false)}else if(type===\"copy\"){return\"<div></div>\"}else if(type===\"text\"||type===\"json\"){return JST.common_form_text_row(false)}else if(type===\"confirmation\"){return JST.common_form_confirmation_row(false)}else if(type===\"file\"){return JST.common_form_file_row(false)}else if(type===\"upload\"){return JST.common_form_upload_row(false)}else if(type===\"prettypills\"){return JST.common_form_unicode_prettypill_row(false)}else if(type===\"unicode\"){return JST.common_form_unicode_row(false)}else if(type===\"checkbox\"){return JST.common_form_checkbox_row(false)}return JST.common_form_unicode_row(false)},render:function(){var context,template,_ref,_ref2,_ref3,_ref4,_this=this;template=this.template();context=this.context();context.row_html=z.useful.render(template,context);this.$el.html(JST.common_form_base_row(context));this.renderValid();this.renderClipboard();this.checkBusy();this.renderParentChild();this.renderRule();_.defer(function(){return _this.prettypills()});if((_ref=this.userfillModal)!=null)_ref.close();if((_ref2=this.prefillModal)!=null)_ref2.close();if((_ref3=this.selectfillModal)!=null)_ref3.close();if((_ref4=this.givefillModal)!=null)_ref4.close();return this},doesRuleApply:function(match,fieldValue,ruleValues){var coerce,_ref;if(!_.isArray(ruleValues))ruleValues=[ruleValues];ruleValues=_.map(ruleValues,function(val){return String(val)});coerce=function(val){return String(val)};if(match===\"iexact\"){coerce=function(val){return String(val).toLowerCase()}}ruleValues=_.map(ruleValues,coerce);return _ref=coerce(fieldValue),__indexOf.call(ruleValues,_ref)>=0},applyRule:function(rule,inverse,actionOverride){var action;if(inverse==null)inverse=false;if(actionOverride==null)actionOverride=null;action=actionOverride||rule.action;if(action===\"hide\"){if(inverse){this.$el.removeClass(\"hide\");return this.options.form.softAdd(this.model)}else{this.$el.addClass(\"hide\");return this.options.form.softRemove(this.model)}}else if(action===\"show\"){return this.applyRule(rule,!inverse,\"hide\")}},renderRule:function(){var rules,values,_this=this;rules=this.model.get(\"rules\")||[];values=this.options.form.getValues();if(!(rules!=null?rules.length:void 0))return;values=this.options.form.getValues();return _.each(rules,function(rule){var shouldApply;shouldApply=_this.doesRuleApply(rule.match,values[rule.key],rule.value);return _this.applyRule(rule,!shouldApply)})},renderValid:function(){var valid;valid=this.model.get(\"valid\");this.$el.removeClass(\"valid invalid\");if(valid!=null&&valid)this.$el.addClass(\"valid\");if(valid!=null&&!valid)return this.$el.addClass(\"invalid\")},renderParentChild:function(){this.$el.removeClass(\"list-child list-parent\");if(this.model.get(\"list\")&&this.model.get(\"parent\")){this.$el.addClass(\"list-child\")}if(this.model.get(\"list\")&&!this.model.get(\"parent\")){return this.$el.addClass(\"list-parent\")}},renderClipboard:function(){var $el,clip;if(this.model.get(\"input_format\")!=null){$el=this.$(\".copy-button\");clip=new z.useful.clipboard($el);return clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)})}},softChange:function(){var data;data=this.get();if((data!=null?data.value:void 0)!=null&&(data!=null?data.value:void 0)!==this.model.getValue()){return this.model.set(data)}if((data!=null?data.display:void 0)!=null&&(data!=null?data.display:void 0)!==this.model.getDisplay()){return this.model.set(data)}},hardChange:function(){var data;data=this.get();return this.model.save(data)},get:function(){var $el,data,key,prefill,type;type=this.model.get(\"type\");prefill=this.model.get(\"prefill\")!=null;$el=this.$(\"[data-input]\");data={};if(prefill){key=this.hasMode(\"not\",\"locked\")?\"value\":\"display\"}else{key=\"value\"}if(type===\"checkbox\"){data[key]=$el.prop(\"checked\")}else if(type===\"json\"){try{data[key]=JSON.parse($el.val())}catch(e){data[key]=$el.val()}}else if(this.prettypill!=null){data[key]=this.prettypill.getValue()}else{data[key]=$el.val()}return data},set:function(val){var $el,choices,data,type,_ref;if(this.model.get(\"list\")&&!(this.model.get(\"parent\")!=null))return;if(!_.isString(val))val=this.model.getDisplay();type=this.model.get(\"type\");$el=this.$(\"[data-input]\");data=this.get();if(val!=null&&((data!=null?data.value:void 0)===val||(data!=null?data.display:void 0)===val)){return}if(type===\"checkbox\"){return $el.prop(\"checked\",val)}else if(this.model.get(\"choices\")){choices=this.model.get(\"choices\");if($.isPlainObject(choices))val=choices[val]}else if(type===\"json\"){if(val!=null){val=JSON.stringify(val,null,4)}else{val=\"\"}}$el.val(val);return(_ref=this.prettypill)!=null?_ref.setValue(val!=null&&!_.isArray(val)?val:\"\"):void 0},focus:function(){var _this=this;if(this.prettypill!=null){return _.defer(function(){return _this.prettypill.editor.focus()})}else{return _.defer(function(){return _this.$(\"[data-input]\").first().focus()})}},blur:function(){var _this=this;if(this.prettypill!=null){return _.defer(function(){return _this.prettypill.editor.getInputField().blur()})}else{return _.defer(function(){return _this.$(\"[data-input]\").first().blur()})}},busy:function(){var _ref;this.blur();this.$el.removeClass(\"busy\").addClass(\"busy\");this.$(\"[data-input]\").prop({disabled:true});this.undelegateEvents();if(this.prettypill!=null){this.undelegatePrettypills();if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",\"nocursor\")}return this.prettypill.container.addClass(\"disabled\")}},notBusy:function(){var _ref;this.$el.removeClass(\"busy\");this.$(\"[data-input]\").prop({disabled:false});this.delegateEvents();if(this.prettypill!=null){this.delegatePrettypills();if(this.hasMode(\"not\",\"locked\")||!(this.model.get(\"prefill\")!=null)&&!(this.model.get(\"choices\")!=null)){if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",false)}}return this.prettypill.container.removeClass(\"disabled\")}},checkBusy:function(){if(!this.model.state.get(\"busy\")){return this.notBusy()}else{return this.busy()}},valueToClipButton:function(){var f,v;f=this.model.get(\"input_format\");if(f!=null){v=\"\";if((f!=null?f[0]:void 0)!=null)v=f[0]+v;v=v+this.model.getValue();if((f!=null?f[2]:void 0)!=null)v=v+f[2];v=_.template(v)({cid:z.app.account.get(\"id\"),ccode:z.app.account.get(\"code\")});return this.$(\"[data-clipboard-text]\").attr(\"data-clipboard-text\",v)}},fillButton:function(e){var _ref,_ref2,_ref3,_ref4;this.focus();if(this.hasMode(\"not\",\"locked\")&&!this.$(e.currentTarget).hasClass(\"fill-button\")){return}if(this.model.get(\"choices\")!=null||this.model.get(\"prefill\")!=null){this.setMode(\"is\",\"locked\");this.$(\"[data-input]\").prop({disabled:true});if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",\"nocursor\")}}if(this.model.get(\"prefill\")!=null){this.prefill(this.model.node,this.model.get(\"prefill\"),this.model.getValue(),this.model.get(\"choices\"))}else if(this.model.get(\"choices\")!=null){this.selectfill(this.model.get(\"choices\"),this.model.getValue())}else if(this.model.get(\"givefill\")){this.givefill((_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?(_ref4=_ref3.givefill)!=null?_ref4.node:void 0:void 0:void 0)}else if(this.options.options.userfill!=null&&this.model.isUserfill()&&this.$(e.currentTarget).hasClass(\"fill-button\")){this.userfill(this.node)}},addPlaceholder:function(e){if(this.options.options.userfill!=null&&this.model.isUserfill()&&this.$(e.currentTarget).hasClass(\"add-placeholder\")){return this.userfill(this.node)}},selectfill:function(choices,current){var $el,customValue,height,pick,placeholderValue,pos,view,x,y,_ref,_ref2,_ref3,_ref4,_this=this;if((_ref=this.selectfillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");if(this.prettypill!=null)$el=this.prettypillTarget();pick=function(pick){return _this.model.save({value:pick[\"key\"],display:null},{wait:true})};customValue=function(){var _ref2;_this.setMode(\"not\",\"locked\");_this.model.set({display:null});_this.$(\"[data-input]\").prop({disabled:false});if((_ref2=_this.prettypill)!=null){_ref2.editor.setOption(\"readOnly\",false)}_this.focus();return _this.prettypill.editor.focus()};placeholderValue=function(){var _ref2;if((_ref2=_this.selectfillModal)!=null)_ref2.close();return _this.userfill(_this.node,{pick:function(picked){var val;val=z.cfg.userfillOTag+picked.key+z.cfg.userfillETag;return _this.model.save({value:val,display:val},{wait:true})}})};view=new z.ui.SelectfillModal({pick:pick,target:$el,choices:choices,current:current,hideRawValue:(_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?_ref3.hideRawValue:void 0:void 0,options:{custom:customValue,placeholder:placeholderValue,fancychoices:(_ref4=this.options.options)!=null?_ref4.fancychoices:void 0}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;return this.selectfillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true})},prefill:function(node,prefill,current,fixedChoices){var $el,customValue,height,loadError,pick,placeholderValue,pos,view,x,y,_ref,_this=this;if((_ref=this.prefillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");if(this.prettypill!=null)$el=this.prettypillTarget();pick=function(pick){var display;display=pick!=null?pick.display:void 0;return _this.model.save({value:pick[\"key\"],display:display},{wait:true,success:function(){return _this.model.trigger(\"prefill\")}})};loadError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};customValue=function(){var _ref2;_this.setMode(\"not\",\"locked\");_this.model.set({display:null});_this.$(\"[data-input]\").prop({disabled:false});if((_ref2=_this.prettypill)!=null){_ref2.editor.setOption(\"readOnly\",false)}_this.focus();return _this.prettypill.editor.focus()};placeholderValue=function(){var _ref2;if((_ref2=_this.prefillModal)!=null)_ref2.close();return _this.userfill(_this.node,{pick:function(picked){var val;val=z.cfg.userfillOTag+picked.key+z.cfg.userfillETag;return _this.model.save({value:val,display:val},{wait:true})}})};if(!(this.prefillSamples!=null)){this.prefillSamples=new z.model.SampleSet([],{node:node,action:node.get(\"action\")})}view=new z.ui.PrefillModal({pick:pick,target:$el,node:node,samples:this.prefillSamples,formRow:this.model,prefill:prefill,current:current,fixedChoices:fixedChoices,options:{error:loadError,custom:customValue,placeholder:placeholderValue}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;this.prefillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true});return view.loadChoices()},userfill:function(node,options){var $el,eTag,elPos,fieldsError,fieldsLoaded,fieldsMissing,left,oTag,pick,pos,top,view,x,y,_ref,_this=this;z.store.set(\"userfill-click\",true);if((_ref=this.userfillModal)!=null?_ref.isOpen():void 0)return;if(!(this.prettypill!=null))return;$el=this.prettypillTarget();elPos=$el.offset();pos=(options!=null?options.coords:void 0)?options.coords:this.prettypill.getCursorCoords();left=(pos!=null?pos.left:void 0)-(elPos!=null?elPos.left:void 0);top=(pos!=null?pos.top:void 0)-(elPos!=null?elPos.top:void 0);x=left;y=top;if(!(x!=null)||x<5)x=5;if(!(y!=null)||y<25)y=25;x+=1;y+=12;oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;pick=function(picked){var key,val;key=picked.key;val=z.cfg.userfillOTag+key+z.cfg.userfillETag;if((options!=null?options.line:void 0)!=null&&(options!=null?options.ch:void 0)!=null&&(options!=null?options.length:void 0)!=null){_this.prettypill.replaceText(val,{line:options.line,ch:options.ch},options.length)}else{_this.prettypill.insertText(val)}return options!=null?typeof options.pick===\"function\"?options.pick(picked):void 0:void 0};fieldsMissing=function(){var view;_this.blur();view=new z.ui.MissingDataModal({success:function(){Backbone.cache.clear(_this.userfillModal.view.gives.url());return _this.userfill(node,options!=null?options.text:void 0)}});return _this.missingDataModal=new z.ui.Modal({view:view})};fieldsError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};fieldsLoaded=function(model,json){var fieldmap,meta,_ref2;fieldmap=model.exportMeta();if((_ref2=_this.prettypill)!=null){_ref2.setOption(\"replacements\",_.extend({},fieldmap,_this.prettyReplacements()))}if(_this.node!=null){meta=_this.node.get(\"meta\")||{};meta[\"fieldmap\"]=fieldmap;return _this.node.save({meta:meta},{loose:false})}};view=new z.ui.UserfillModal({pick:pick,target:$el,node:node,current:options!=null?options.textcurrent:void 0,options:{missing:fieldsMissing,error:fieldsError,success:fieldsLoaded}});if(x>$el.outerWidth())x=$el.outerWidth();if(y>$el.outerHeight())y=$el.outerHeight();this.userfillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true,close:function(){_this.removeEmptyUserfillTags;return _this.prettypill.clearActivePills()}});return view.loadChoices()},givefill:function(node){var $el,fieldsError,fieldsMissing,height,pick,pos,view,x,y,_ref,_ref2,_ref3,_this=this;if((_ref=this.givefillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");pick=function(pick){return _this.model.save({value:pick[\"key\"],display:null},{wait:true})};fieldsMissing=function(){var view;_this.blur();view=new z.ui.MissingDataModal({success:function(){var _ref2;if((_ref2=_this.missingDataModal)!=null)_ref2.close();Backbone.cache.clear(_this.givefillModal.view.gives.url());return _this.givefill(node)}});return _this.missingDataModal=new z.ui.Modal({view:view})};fieldsError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};view=new z.ui.GivefillModal({pick:pick,target:$el,givefill:true,node:node,hideRawValue:(_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?_ref3.hideRawValue:void 0:void 0,options:{missing:fieldsMissing,error:fieldsError}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;this.givefillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false});return view.loadChoices()},removeEmptyUserfillTags:function(){var $el,eTag,newVal,oTag,tags,val;$el=this.$(\"[data-input]\");oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;tags=oTag+eTag;if(!(tags!=null))return;val=$el.val();newVal=val.replace(new RegExp(tags,\"gm\"),\"\");if(val!==newVal){this.set(newVal);return $el.trigger(\"change\")}},listAdd:function(e){var collection;if(e!=null)e.preventDefault();collection=this.model.collection;collection.listAdd(this.model.get(\"parent\"));return collection.save()},listRemove:function(e){var collection;if(e!=null)e.preventDefault();collection=this.model.collection;collection.listRemove(this.model.id,this.model.get(\"parent\"));return collection.save()},prettypills:function(){var _ref;if(!((_ref=this.options.options)!=null?_ref.prettypills:void 0)){return}if(this.prettypill!=null)this.undelegatePrettypills();return this.prettypillsSetup()},prettyReplacements:function(){var humanize,_this=this;humanize=function(match){match=match.replace(/\\{\\{/g,\"\");match=match.replace(/\\}\\}/g,\"\");return _.superHumanize(match)};return{\"{{(?:(?!{{).)+}}\":{replaceWith:function(match){return humanize(match)},allowRegex:true}}},prettypillsSetup:function(){var classes,input,replacements,saved,tag,type,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_this=this;input=this.$(\"[data-input]\");tag=(_ref=input[0])!=null?_ref.nodeName.toLowerCase():void 0;type=this.model.get(\"type\");if((tag===\"input\"||tag===\"textarea\")&&type!==\"password\"){saved=(_ref2=this.node)!=null?(_ref3=_ref2.get(\"meta\"))!=null?_ref3.fieldmap:void 0:void 0;replacements=_.extend({},saved,this.prettyReplacements());this.prettypill=new PrettyPills(input[0],{showPills:true,replacements:replacements,mode:null,extraKeys:{Tab:false,\"Shift-Tab\":false}});classes=this.prettypill.container.attr(\"class\")+\" \";classes+=input.attr(\"class\");this.prettypill.container.attr(\"class\",classes);this.minInputHeight=type===\"text\"?\"100\":\"26\";this.prettypillHeight();this.delegatePrettypills();if(((_ref4=this.model)!=null?_ref4.get(\"choices\"):void 0)!=null||((_ref5=this.model)!=null?_ref5.get(\"prefill\"):void 0)!=null){this.setMode(\"is\",\"locked\");this.$(\"[data-input]\").prop({disabled:true});if((_ref6=this.prettypill)!=null){_ref6.editor.setOption(\"readOnly\",\"nocursor\")}}if(type!==\"text\"){return(_ref7=this.prettypill)!=null?_ref7.editor.addKeyMap({Enter:function(cm){return false}}):void 0}}},delegatePrettypills:function(){if(!(this.prettypill!=null))return;this.prettypill.on(\"input\",this.softChange);this.prettypill.on(\"input\",this.prettypillHeight);this.prettypill.on(\"change\",this.hardChange);this.prettypill.on(\"mousedown\",this.fillButton);this.prettypill.on(\"pillenter\",this.prettypillEnter);return this.prettypill.on(\"pillleave\",this.prettypillLeave)},undelegatePrettypills:function(){if(!(this.prettypill!=null))return;this.prettypill.off(\"input\",this.softChange);this.prettypill.off(\"input\",this.prettypillHeight);this.prettypill.off(\"change\",this.hardChange);this.prettypill.off(\"mousedown\",this.fillButton);this.prettypill.off(\"pillenter\",this.prettypillEnter);return this.prettypill.off(\"pillleave\",this.prettypillLeave)},prettypillTarget:function(){if(!(this.prettypill!=null))return;return this.$(this.prettypill.container)},prettypillEnter:function(e,options){var length,text,_ref;if((_ref=this.userfillModal)!=null?_ref.isOpen():void 0)return;text=options!=null?options.text:void 0;length=text.length;text=text.replace(z.cfg.userfillOTag,\"\");text=text.replace(z.cfg.userfillETag,\"\");return this.userfill(this.options.options.userfill.node,{text:text,line:options.line,ch:options.ch,length:length,coords:options.coords})},prettypillLeave:function(){var _ref;return(_ref=this.userfillModal)!=null?_ref.close():void 0},prettypillHeight:function(){if(!(this.prettypill!=null)){}}});z.ui.Preloader=z.ui.Base.extend({events:{\"click .retry button\":\"retry\"},initialize:function(options){var _this=this;_.bindAll(this);this.loading=false;this.fakeFirst=true;$(document).ajaxSend(function(){return _this.total+=1});return $(document).ajaxComplete(function(){_this.complete+=1;if(_this.fakeFirst&&_this.complete===1)return _this.complete+=1})},start:function(hardTotal){var _this=this;if(this.loading)return;this.loading=true;this.hardTotal=hardTotal;this.total=0;this.complete=0;this.percent=0;this.interval=setInterval(function(){return _this.renderProgress()},25);this.delay=_.delay(function(){return _this.timeout()},15e3);return this.render()},active:function(){return $.ajax.active},isLoading:function(){return this.loading},render:function(){this.$el.html(JST.preloader({}));this.renderProgress();return this},renderProgress:function(){var percent,total;total=this.hardTotal||this.total;percent=Math.ceil(this.complete/total*100)||0;if(percent>100)percent=100;if(this.percent===percent)return;this.percent=percent;$(\".preloader .progress\").animate({width:percent+\"%\"},200);return this},timeout:function(){this.setMode(\"is\",\"timeout\");clearInterval(this.interval);return clearTimeout(this.delay)},retry:function(e){if(e!=null)e.preventDefault();return z.app.viewport.refresh()},done:function(cb){clearInterval(this.interval);clearTimeout(this.delay);this.loading=false;this.approxTotal=null;return typeof cb===\"function\"?cb():void 0}});z.ui.Viewport=z.ui.Base.extend({events:{click:\"clickAnywhere\",\"click [data-nav]\":\"click\",\"click [data-contact-support]\":\"contactSupport\",'click [href=\"/support/\"]':\"contactSupport\",'click [href=\"mailto:contact@zapier.com\"]':\"contactSupport\",\"click .menu-login\":\"login\",\"click .menu-account\":\"menu\",\"click .links-container\":\"navMenu\"},initialize:function(options){Backbone.cache.on(\"syncing\",this.showSyncing,this);Backbone.cache.on(\"synced\",this.hideSyncing,this);return z.app.clicks=[]},clickAnywhere:function(e){var name;name=$(e.currentTarget).attr(\"data-record-click\");if(name){z.app.track[\"new\"](\"Click\",{name:name})}z.app.clicks.unshift(e);z.app.clicks=z.app.clicks.slice(0,10);return z.app.trigger(\"click\",e)},click:function(e){if(!$(e.target).attr(\"data-nav\")&&!$(e.currentTarget).attr(\"data-nav\")){return}if(z.app.preloader.isLoading())return;if(e!=null)e.preventDefault();if((typeof window.onbeforeunload===\"function\"?window.onbeforeunload():void 0)!=null){if(confirm(window.onbeforeunload()))return this.doNav(e)}else{return this.doNav(e)}},doNav:function(e){var target;target=$(e.target).attr(\"data-nav\")||$(e.currentTarget).attr(\"data-nav\");if((e!=null?e.ctrlKey:void 0)||(e!=null?e.metaKey:void 0)){return z.useful.open(\"/\"+target,null,null)}else{return Backbone.history.navigate(target,{trigger:true})}},refresh:function(){return Backbone.history.location.reload()},title:function(title){return typeof document!==\"undefined\"&&document!==null?document.title=title+z.cfg.title:void 0\n},dim:function(){return $(\".app, .header, .footer\").removeClass(\"dim\").addClass(\"dim\")},undim:function(){return $(\".app, .header, .footer\").removeClass(\"dim\")},login:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.loginModal)!=null)_ref.close();this.loginModal=new z.ui.Modal({view:new z.ui.LoginModal,target:this.$(\".menu-login\"),x:-234,y:55,noX:true});return this.$(\".links-container\").removeClass(\"open\")},menu:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();this.menuModal=new z.ui.Modal({view:new z.ui.MenuModal({className:\"main menu with-hover\"}),target:this.$(\".menu-account\"),x:-186,y:55,noX:true});return this.$(\".links-container\").removeClass(\"open\")},navMenu:function(e){return $(e.currentTarget).toggleClass(\"open\")},contactSupport:function(e){var modal;if(e!=null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.ContactModal})},showSyncing:function(){return this.$(\".sync\").removeClass(\"hide\")},hideSyncing:function(){return this.$(\".sync\").addClass(\"hide\")}});z.ui.TopBar=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={text:this.getText()};return context},render:function(){var context;context=this.context();if(context.text!=null){this.$el.removeClass(\"hide\");this.$(\"h1\").html(context.text)}else{this.$el.addClass(\"hide\")}return this},showSyncing:function(){return this.$(\".sync\").removeClass(\"hide\")},hideSyncing:function(){return this.$(\".sync\").addClass(\"hide\")},getText:function(){var active_card,amount,is_trialing,is_unlimited,logo,provider,status,trialDays,_ref,_ref2,_ref3;status=(_ref=z.app.account.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.status:void 0:void 0;is_trialing=z.app.account.get(\"is_trialing\");amount=z.app.account.getCurrentPlanAmount();active_card=(_ref3=z.app.account.get(\"billing\"))!=null?_ref3.active_card:void 0;is_unlimited=z.app.account.get(\"is_unlimited\");provider=z.app.account.get(\"provider\");if(!z.app.account.isLoggedIn()){return null}else if(false){logo=\"<i class='img32 \"+provider.selected_api+\"32x32'></i>\";return\"\"+logo+\" &nbsp; Your Zapier account is sponsored by \"+provider.title+\"! &nbsp; \"+logo+\" &nbsp; <a href='#' data-support-tags='sponsored-account'>Learn more.</a> &nbsp; \"+logo}else if(is_unlimited){return null}else if(is_trialing&&active_card!=null){return null}else if(is_trialing){trialDays=z.app.account.trialDaysLeft();if(trialDays>30){return\"You have \"+trialDays+\" days left in your extended trial.\"}else{return\"You have \"+trialDays+' days left in your trial &mdash; <a href=\"/app/settings/plans\" data-nav=\"app/settings/plans\">Choose the best plan for you</a>.'}}else if(status===\"past_due\"||status===\"unpaid\"){return'We couldn\\'t process your credit card! <a href=\"/app/settings\" data-nav=\"app/settings\">Update your credit card</a> to keep your Zaps running.'}else if(status===\"canceled\"){return'Your plan was canceled because we couldn\\'t process your payment. <a href=\"/app/settings\" data-nav=\"app/settings/plans\">Choose a plan</a> to get your Zaps running again.'}else{return null}}});z.ui.Home=z.ui.Base.extend({events:{\"click .carousel-dots .dot\":\"loadCustomerQuote\",\"click .carousel-nav .next\":\"nextCustomerQuote\",\"click .carousel-nav .previous\":\"previousCustomerQuote\"},initialize:function(){var maxSlideHeight;maxSlideHeight=0;this.$(\".slides .slide\").each(function(){$(this).css(\"display\",\"inline-block\");if($(this).height()>maxSlideHeight){return maxSlideHeight=$(this).height()}});this.$(\".slides\").css(\"height\",maxSlideHeight+\"px\");this.$(\".slides .slide\").css({display:\"none\"});this.$(\".slides .slide\").eq(0).addClass(\"show\");this.totalSlides=this.$(\".slides .slide\").length;return this.currentCarouselSlide=0},showCustomerSlide:function(index){this.$(\".carousel-dots .dot\").removeClass(\"active\");this.$(\".carousel-dots .dot\").eq(index).addClass(\"active\");this.$(\".slides .slide\").removeClass(\"show\");this.$(\".slides .slide\").eq(index).addClass(\"show\");this.currentCarouselSlide=index;return this.$(\".carousel-nav .previous\").removeClass(\"disabled\")},loadCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();index=this.$(e.currentTarget).index();return this.showCustomerSlide(index)},nextCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();if(this.currentCarouselSlide+1>=this.totalSlides){index=0}else{index=this.currentCarouselSlide+1}return this.showCustomerSlide(index)},previousCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).hasClass(\"disabled\"))return false;if(this.currentCarouselSlide===0){index=this.totalSlides-1}else{index=this.currentCarouselSlide-1}return this.showCustomerSlide(index)}});z.ui.ForgotPassword=z.ui.Singleton(z.ui.Base.extend({className:\"simple-page forgot\",events:{\"submit form\":\"submit\",\"click .submit\":\"submit\"},initialize:function(options){_.bindAll(this);this.code=options.code;return this.username=options.username},context:function(){var context;context={username:this.username};return context},render:function(){this.$el.html(JST.forgot_base(this.context()));if(this.code!=null&&this.username!=null){this.$el.append(JST.forgot_password(this.context()))}else{this.$el.append(JST.forgot_email(this.context()))}return this},submit:function(e){if(e!=null)e.preventDefault();if(this.code!=null&&this.username!=null){return this.submitPasswordForm()}else{return this.submitEmailForm()}},submitEmailForm:function(){var email,_this=this;email=this.$(\".email\").val();return z.app.account.sendForgotPasswordEmail(email,{success:function(json){return _this.$(\".feedback\").text(json.success).removeClass(\"hide error\").addClass(\"success\")},error:function(xhr){var errors;errors=z.useful.errors(xhr);_this.$(\".feedback\").text(errors).removeClass(\"hide success\").addClass(\"error\");return _.delay(function(){return _this.$(\".feedback\").addClass(\"hide\")},5e3)}})},submitPasswordForm:function(){var password1,password2,_this=this;password1=this.$(\".password1\").val();password2=this.$(\".password2\").val();return z.app.account.resetPassword(this.username,this.code,password1,password2,{success:function(json){_this.$(\".feedback\").text(json.success).removeClass(\"hide error\").addClass(\"success\");return z.useful.goto(\"/\")},error:function(xhr){var errors;errors=z.useful.errors(xhr);_this.$(\".feedback\").text(errors).removeClass(\"hide success\").addClass(\"error\");return _.delay(function(){return _this.$(\".feedback\").addClass(\"hide\")},3e3)}})}}));z.ui.Login=z.ui.Singleton(z.ui.Base.extend({className:\"simple-page login\",initialize:function(options){var _ref;this.options=options;_.bindAll(this);if(((_ref=z.app.account)!=null?_ref.id:void 0)!=null){return z.useful.goto(\"/app/dashboard\")}},context:function(){var context,_ref,_ref2,_ref3;context={status:this.options.status,querystring:(_ref=this.options)!=null?_ref.querystring:void 0,next:(_ref2=this.options)!=null?(_ref3=_ref2.querystring)!=null?_ref3.next:void 0:void 0};return context},render:function(){this.$el.html(JST.login(this.context()));return this}}));z.ui.Zapbook=z.ui.Base.extend({events:{\"click [data-service-sort]\":\"sortServices\",\"click [data-service-filter]\":\"filterServices\",\"click [data-use-template]\":\"useRecipe\",\"click [data-collect-email]\":\"collectEmail\",\"click [data-recipe-paginate-previous]\":\"prevRecipePage\",\"click [data-recipe-paginate-next]\":\"nextRecipePage\",\"click .start-button\":\"usePlain\"},RECIPES_PER_PAGE:4,initialize:function(options){this.options=options;this.recipePage=0;this.paginateRecipes();this.hashString=new z.useful.QueryString(Backbone.history.location.hash.replace(\"#\",\"\",1)).object;this.sorterKey=(this.hashString[\"sort\"]||this.sorterKey).replace(/[^-\\w]/g,\"\");this.filterKey=(this.hashString[\"filter\"]||this.filterKey).replace(/[^-\\w]/g,\"\");this.doFilter();return this.doSort()},paginateRecipes:function(){var index,pagination,recipe,recipes,_i,_len;recipes=this.$(\".zaps .zap-mini\");if(recipes){pagination=this.$(\".zaps\").next(\".pagination\");this.totalPages=Math.ceil(recipes.length/this.RECIPES_PER_PAGE)-1;if(this.totalPages>0)pagination.removeClass(\"hide\");this.$(\"[data-recipe-paginate-previous]\").hide();this.$(\"[data-recipe-paginate-next]\").hide();for(_i=0,_len=recipes.length;_i<_len;_i++){recipe=recipes[_i];index=_.indexOf(recipes,recipe)+1;$(recipe).hide();if(this.RECIPES_PER_PAGE*this.recipePage<index&&index<=this.RECIPES_PER_PAGE*this.recipePage+this.RECIPES_PER_PAGE){$(recipe).show()}}if(this.recipePage)this.$(\"[data-recipe-paginate-previous]\").show();if(this.recipePage!==this.totalPages){this.$(\"[data-recipe-paginate-next]\").show()}$(\"[data-recipe-paginate-page]\").text(this.recipePage+1);return $(\"[data-recipe-paginate-totals]\").text(this.totalPages+1)}},prevRecipePage:function(e){if(e!=null)e.preventDefault();if(this.recipePage>0){this.recipePage-=1;return this.paginateRecipes()}},nextRecipePage:function(e){if(e!=null)e.preventDefault();if(this.recipePage<this.totalPages){this.recipePage+=1;return this.paginateRecipes()}},usePlain:function(e){var qs,recipe,s1,s2,_ref,_ref2,_ref3,_ref4;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).attr(\"data-collect-email\")===\"true\")return;s1=this.$(e.currentTarget).attr(\"data-service-one\");s2=this.$(e.currentTarget).attr(\"data-service-two\");recipe=new z.model.Recipe;recipe.set({read_data:{selected_api:s1},write_data:{selected_api:s2},generated:true});if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0};return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}},useRecipe:function(e){var id,recipe,_this=this;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).attr(\"data-collect-email\")===\"true\")return;$(e.currentTarget).addClass(\"disabled\").html('<div class=\"spinning-star\"></div>');id=$(e.currentTarget).attr(\"data-use-template\");recipe=new z.model.Recipe({id:id});return recipe.fetch({success:function(recipe,resp){var qs,_ref,_ref2,_ref3,_ref4;if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={};if(recipe.get(\"generated\")){qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0}}else{qs={recipe_id:recipe.id}}return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}}})},alphabeticalSorter:function(element){var letterScore,letters;letters=$.trim($(element).text()).toLowerCase();letterScore=function(c,i){return Math.abs(c.charCodeAt(0)-122)/Math.pow(26,i)};return _.reduce(_.map(letters,letterScore),function(p,n){return p+n})},popularSorter:function(element){return Number($(element).attr(\"data-popularity\"))+1e3},recentSorter:function(element){return-(Number($(element).attr(\"data-days-age\"))+1e3)},premiumSorter:function(element){return Number($(element).attr(\"data-is-premium\"))*1e3},calcExtraScore:function(element){return{popular:this.popularSorter,alphabetical:this.alphabeticalSorter,recent:this.recentSorter,premium:this.premiumSorter}[this.sorterKey](element)+this.alphabeticalSorter(element)},score:function(element){var score;element=$(element);score=0;if(element.hasClass(\"filtered\"))score+=5e5;score+=this.calcExtraScore(element);return score},doSort:function(){var scored,_this=this;$(\"[data-service-sort]\").removeClass(\"active\");$('[data-service-sort=\"'+this.sorterKey+'\"]').addClass(\"active\");scored=_.sortBy($(\".services-grid .service\"),function(el){return _this.score(el)});return $(\".services-grid\").html(scored.reverse())},doFilter:function(){$(\"[data-service-filter]\").removeClass(\"active\");log('[data-service-filter=\"'+this.filterKey+'\"]');$('[data-service-filter=\"'+this.filterKey+'\"]').addClass(\"active\");$(\".services-grid .service\").addClass(\"opaque\");$(\".services-grid .service\").removeClass(\"filtered\");$(\".services-grid .service-\"+this.filterKey).removeClass(\"opaque\");if(this.filterKey!==\"all\"){return $(\".services-grid .service-\"+this.filterKey).addClass(\"filtered\")}},sorterKey:\"popular\",sortServices:function(e){if(e!=null)e.preventDefault();this.sorterKey=$(e.currentTarget).attr(\"data-service-sort\");this.doFilter();this.doSort();return this.setUrl()},filterKey:\"all\",filterServices:function(e){if(e!=null)e.preventDefault();this.filterKey=$(e.currentTarget).attr(\"data-service-filter\");this.doFilter();this.doSort();return this.setUrl()},setUrl:function(){var url;url=Backbone.history.location.pathname+\"#\"+$.param({sort:this.sorterKey,filter:this.filterKey});return Backbone.history.navigate(url,{replace:true})},collectEmail:function(e){var view;if(e!=null)e.preventDefault();view=new z.ui.CollectEmailModal({s1:this.options.s1,s2:this.options.s2});return this.collectEmailModal=new z.ui.Modal({view:view})}});z.ui.StatusModal=z.ui.Base.extend({html:null,className:\"status-modal\",initialize:function(options){this.options=options;_.bindAll(this);return this.html=options.html},render:function(){this.$el.html(this.html);this.$el.addClass(this.options[\"class\"]);return this}});z.ui.Status=z.ui.Base.extend({events:{\"click td.has-errors\":\"showErrors\"},initialize:function(options){var el;this.options=options;this.loaded=true;_.bindAll(this,\"scolled\");$(document).scroll(_.throttle(this.scolled,100));el=this.$el.find(\"table\");return this.tableHeights=[el.offset().top,el.height()]},scolled:function(e){var tableHeight,tableTop,winLeft,winTop,_ref,_ref2;_ref=this.tableHeights,tableTop=_ref[0],tableHeight=_ref[1];_ref2=z.useful.viewportScroll(),winLeft=_ref2[0],winTop=_ref2[1];if(winTop>tableTop&&tableTop+tableHeight-35>winTop){return this.$el.find(\"table\").addClass(\"fixed-head\")}else{return this.$el.find(\"table\").removeClass(\"fixed-head\")}},showErrors:function(e){return this.modal=new z.ui.Modal({view:new z.ui.StatusModal({html:$(e.currentTarget).find(\".status-modal-html\").html()})})}});z.ui.DeveloperAppCommonForm=z.ui.Base.extend({events:{\"click .save\":\"save\"},form:null,initialize:function(options){this.options=options;_.bindAll(this);z.app.developer.form.on(\"error\",this.saveError);z.app.developer.form.on(\"invalid\",this.saveError);return z.app.developer.form.on(\"saveSuccess\",this.saveSuccess)},save:function(e){if(e!=null)e.preventDefault();z.app.developer.form.save()},saveSuccess:function(){throw\"You should implement your own saveSuccess method\"},saveError:function(form,errors){this.form.renderErrors(errors)}});z.ui.DeveloperAppCommonSummary=z.ui.Base.extend({tagName:\"tr\",className:\"summary-block\",events:{\"click .delete\":\"delete\"},initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.model!=null))throw\"model required\";return this.setMode(\"default\",\"delete\")},attributes:function(){return{\"data-id\":this.options.model.id}},render:function(){if(!z.app.developer.app.isEditable()){this.$el.find(\"a\").removeAttr(\"href\").removeAttr(\"data-nav\").addClass(\"disabled\");this.undelegateEvents()}return this},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.model.destroy({wait:true,success:function(){return _this.$el.animate({opacity:0},350,function(){return _this.remove()})},error:function(model,xhr,options){var errors;errors=z.useful.errors(xhr);return new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}})}});z.ui.DeveloperAppCommonSection=z.ui.Base.extend({className:\"section\",initialize:function(options){this.options=options;return _.bindAll(this)},renderRows:function(models,summaryView){var container;this.$el.find(\".section-content table tbody\").html(\"\");container=this.$el.find(\".section-content table tbody\");return models.each(function(model){var view;view=new summaryView({model:model});return container.append(view.render().el)},this)},render:function(models,summaryView,emptyTemplate){if(models.length>0){this.renderRows(models,summaryView)}else if(emptyTemplate){this.$el.find(\".section-content\").html(emptyTemplate(this.context()))}if(!z.app.developer.app.isEditable()){this.$el.find(\"a\").removeAttr(\"href\").removeAttr(\"data-nav\").addClass(\"disabled\");this.undelegateEvents();this.$el.find(\"div.warning\").hide()}return this}});z.ui.DashboardSearch=z.ui.Base.extend({events:{\"keyup input\":\"search\",\"click .clear\":\"clear\"},initialize:function(options){this.options=options;_.bindAll(this);this.setMode(\"no\",\"text\");this.model=this.options.model;this.initSearch();return this.search=_.debounce(this._search,300)},initSearch:function(){var mode,val;val=z.store.get(\"dashboard-search\");if(val!=null){this.model.set({search:val})}mode=(val!=null?val.length:void 0)>0?\"has\":\"no\";return this.setMode(mode,\"text\")},context:function(){var context;context={readCount:z.app.reads.length,search:this.model.get(\"search\"),selected:this.options.shared?\"shared\":\"dashboard\"};return context},render:function(){this.$el.html(JST.dashboard_search(this.context()));z.useful.placeholders(this.$el);return this},_search:function(){var mode,val;val=this.$(\"input\").val();z.store.set(\"dashboard-search\",val,{expires:0});this.model.set({search:val});mode=(val!=null?val.length:void 0)>0?\"has\":\"no\";return this.setMode(mode,\"text\")},clear:function(e){var val;val=\"\";this.$(\"input\").val(val);z.store.set(\"dashboard-search\",val,{expires:0});this.model.set({search:null});return this.setMode(\"no\",\"text\")}});z.ui.SubscribeBlock=z.ui.Base.extend({className:\"widget subscribe\",events:{\"click .button\":\"subscribe\"},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.dashboard_subscribe(this.context()));return this},subscribe:function(){var _this=this;z.app.account.save({is_subscribed_to_blog:true});return this.$(\".subscribe-info\").fadeOut(\"slow\",function(){return _this.$(\".subscribe-message\").fadeIn(\"fast\")})}});z.ui.LimitsBlock=z.ui.Base.extend({className:\"widget limits\",initialize:function(){z.app.reads.on(\"change:paused add remove destroy\",this.refresh,this);z.app.accountLimits.on(\"change\",this.rerender,this);return this.debounceRender=_.debounce(this.render,1e3)},context:function(){var context;context={};context.limits=z.app.accountLimits.toJSON();return context},render:function(){this.$el.html(JST.dashboard_limits(this.context()));return this},rerender:function(){var limits,_this=this;limits=z.app.accountLimits.toJSON().allotment;return _.each(limits,function(limit){var name;name=_.slugify(limit.name);_this.$(\"#\"+name+\" .bar\").css(\"width\",limit.percent+\"%\");return _this.debounceRender()})},refresh:function(){var _this=this;return _.defer(function(){return z.app.accountLimits.fetch({cache:false})})}});z.ui.LogsBlock=z.ui.Base.extend({className:\"widget activities\",initialize:function(){_.bindAll(this);return z.app.stream.on(\"add remove reset\",this.render,this)},context:function(){var context,logs,_this=this;context={};logs=z.app.stream.filter(function(item){var _ref;return((_ref=item.get(\"data\"))!=null?_ref.status:void 0)!==\"halted\"});context.logs=logs.map(function(item){var l;l=item.toJSON();l.title=item.getTitle();return l});return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_logs(context));return this}});z.ui.PartnerText=z.ui.Base.extend({events:{\"click a\":\"next\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,readService,writeService,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;readService=z.app.services.get((_ref=z.app.recipes)!=null?_ref.at(0).get(\"read_data\")[\"selected_api\"]:void 0);writeService=z.app.services.get((_ref2=z.app.recipes)!=null?_ref2.at(0).get(\"write_data\")[\"selected_api\"]:void 0);context={recipes:(_ref3=z.app.recipes)!=null?_ref3.toJSON():void 0,service:z.app.services.get((_ref4=z.app.partner.get(\"zap\"))!=null?_ref4.selected_api:void 0).getName(),readService:(_ref5=z.app.recipes)!=null?_ref5.at(0).get(\"read_service_selected_api\"):void 0,writeService:(_ref6=z.app.recipes)!=null?_ref6.at(0).get(\"write_service_selected_api\"):void 0,readAction:readService.getActionName((_ref7=z.app.recipes)!=null?_ref7.at(0).get(\"read_data\")[\"action\"]:void 0,\"read\"),writeAction:writeService.getActionName((_ref8=z.app.recipes)!=null?_ref8.at(0).get(\"write_data\")[\"action\"]:void 0,\"write\")};return context},render:function(){this.$el.html(JST.dashboard_partner_text(this.context()));return this},next:function(e){var next,step;if(e!=null)e.preventDefault();step=this.$(e.currentTarget).closest(\"div.step\");next=step.next(\"div.step\");step.removeClass(\"hide\").addClass(\"hide\");return next.removeClass(\"hide\")}});z.ui.SharedZap=z.ui.Base.extend({tagName:\"div\",className:\"zap-mini dashboard\",events:{\"click .open-menu\":\"menu\",click:\"permalink\"},attributes:function(){var _ref;return{\"data-shared-id\":(_ref=this.options.recipe)!=null?_ref.id:void 0}},initialize:function(options){var render;this.options=options;_.bindAll(this);_.defaults(this,this.options);this.recipe.on(\"change:description\",this.render);return render=_.debounce(this.render,40)},context:function(){var context,readService,writeService;readService=z.app.services.get(this.recipe.get(\"read_service_selected_api\"));writeService=z.app.services.get(this.recipe.get(\"write_service_selected_api\"));context={title:this.recipe.get(\"title\"),description:this.recipe.get(\"description\"),cssReadClass:readService.getImageClass(),cssWriteClass:writeService.getImageClass()};return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_shared_zap(context));return this},menu:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.SharedZapMenu({recipe:this.recipe}),target:this.$(\".open-menu\"),x:-215,y:48,noX:true})},permalink:function(e){var $elX,menuX,x,_ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();$elX=this.$el.offset().left;x=e.pageX-$elX;menuX=this.$(\".open-menu\").offset().left-$elX;if(x<menuX){return z.useful.goto(this.options.recipe.get(\"url\"))}else{return this.menu(e)}}});z.ui.SharedZapMenu=z.ui.Base.extend({className:\"zap-menu-modal menu with-hover\",events:{\"click .rename\":\"rename\",\"click .permalink\":\"permalink\",\"click .delete\":\"delete\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.dashboard_shared_zap_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.$el.animate({opacity:0},350,function(){_this.close();return _this.options.recipe.destroy()})},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.options.recipe.save({description:value})};console.log(save);modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.options.recipe.get(\"description\"),save:save})});return this.close()},permalink:function(e){if(e!=null)e.preventDefault();z.useful.goto(this.options.recipe.get(\"url\"));return this.close()}});z.ui.Zaps=z.ui.Base.extend({initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,this.options);z.app.reads.on(\"remove\",this[\"delete\"],this);z.app.reads.on(\"add\",this.add,this);z.app.writes.on(\"add\",this.add,this);z.app.reads.on(\"change:paused\",this.move,this);this.views=[];return this.options.search.on(\"change:search\",this.renderSearch,this)},live:function(read){return read.isLive()},paused:function(read){return!read.isLive()&&read.isComplete()},unfinished:function(read){return!read.isComplete()},setEmptyModes:function(){this.setMode(!z.app.reads.any(this.live),\"live-empty\");this.setMode(!z.app.reads.any(this.paused),\"paused-empty\");return this.setMode(!z.app.reads.any(this.unfinished),\"unfinished-empty\")},context:function(){var context;context={isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var renderSearch,_this=this;this.$el.html(JST.dashboard_zaps(this.context()));this.setEmptyModes();this.$live=this.$(\".live-block\");this.$paused=this.$(\".paused-block\");this.$unfinished=this.$(\".unfinished-block\");renderSearch=_.after(z.app.reads.length,this.renderSearch);z.app.reads.each(function(read){return _.defer(function(){_this.add(read);return renderSearch()})});return this},add:function(model){var $el,read,view,write;if(!((model!=null?model.isLive:void 0)!=null)){read=z.app.reads.get(model.get(\"read_id\"));write=model}else{read=model;write=z.app.writes.get(model.get(\"write_ids\")[0])}if(!(read!=null)||!(write!=null))return;view=_.find(this.views,function(view){return view.id===read.id});if(this.live(read))$el=this.$live;if(this.paused(read))$el=this.$paused;if(this.unfinished(read))$el=this.$unfinished;if(view!=null){view.$el.appendTo($el);view.delegateEvents()}else{view=new z.ui.Zap({read:read,write:write,zaps:this});view.id=read.id;$el.append(view.render().el);this.views.push(view)}return this.setEmptyModes()},\"delete\":function(model){var view;view=_.find(this.views,function(view){return view.id===model.id});if(view!=null)view.remove();this.views=_.without(this.views,view);return this.setEmptyModes()},move:function(model){var $el,view;view=_.find(this.views,function(view){return view.id===model.id});if(!(view!=null))return;if(this.live(model))$el=this.$live;if(this.paused(model))$el=this.$paused;if(this.unfinished(model))$el=this.$unfinished;view.undelegateEvents();view.$el.appendTo($el);view.delegateEvents();return this.setEmptyModes()},renderSearch:function(){var _this=this;return this.$(\".zap-mini\").each(function(i,el){var $el,read,write;$el=$(el);read=z.app.reads.get($el.attr(\"data-read-id\"));write=z.app.writes.get($el.attr(\"data-write-id\"));$el.removeClass(\"hide\");if(!_this.searchMatch(read,write))return $el.addClass(\"hide\")})},regex:{selected_api:/selected_api:(\"[^\"]+\"|[\\w]+)/g,params:/params:(\"[^\"]+\"|[\\w]+)/g,action:/action:(\"[^\"]+\"|[\\w]+)/g,status:/status:(\"[^\"]+\"|[\\w]+)/g},searchMatch:function(read,write){var any,each,haystack,m,needle,needles,q,_i,_len,_ref,_ref2,_this=this;q=this.search.get(\"search\")||\"\";needles=q.split(\"OR\");any=[];for(_i=0,_len=needles.length;_i<_len;_i++){needle=needles[_i];each=[];if(m=needle.match(this.regex.selected_api)){each.push(_.all(m,function(match){match=match.replace(\"selected_api:\",\"\");needle=needle.replace(\"selected_api:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return read.get(\"selected_api\")===match||write.get(\"selected_api\")===match}))}if(m=needle.match(this.regex.action)){each.push(_.all(m,function(match){match=match.replace(\"action:\",\"\");needle=needle.replace(\"action:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return read.get(\"action\")===match||write.get(\"action\")===match}))}if(m=needle.match(this.regex.params)){each.push(_.all(m,function(match){match=match.replace(\"params:\",\"\");needle=needle.replace(\"params:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return _.str.include(JSON.stringify(read.get(\"params\")),match)||_.str.include(JSON.stringify(write.get(\"params\")),match)}))}if(m=needle.match(this.regex.status)){each.push(_.all(m,function(match){var status;match=match.replace(\"status:\",\"\");needle=needle.replace(\"status:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;status=!read.isComplete()?\"unfinished\":null;if(!(status!=null))status=read.isLive()?\"live\":\"paused\";return _.str.include(status,match)}))}needle=_.trim(needle.toLowerCase());haystack=\"\";haystack+=(read!=null?read.get(\"title\"):void 0)+\" \";haystack+=(read!=null?read.get(\"action\"):void 0)+\" \";haystack+=((_ref=z.app.services.get(read!=null?read.get(\"selected_api\"):void 0))!=null?_ref.getName():void 0)+\" \";haystack+=(write!=null?write.get(\"title\"):void 0)+\" \";haystack+=(write!=null?write.get(\"action\"):void 0)+\" \";haystack+=((_ref2=z.app.services.get(write!=null?write.get(\"selected_api\"):void 0))!=null?_ref2.getName():void 0)+\" \";haystack=haystack.toLowerCase();if((needle!=null?needle.length:void 0)>0){each.push(_.str.include(haystack,needle))}if(_.any(each,function(e){return!e})){any.push(false)}else{any.push(true)}}return _.any(any,function(a){return a})}});z.ui.CreateBlock=z.ui.Base.extend({className:\"widget create\",context:function(){var context;context={isPartner:z.app.partner.isPartnerSession()};return context},render:function(){this.$el.html(JST.dashboard_create(this.context()));return this}});z.ui.PartnerZaps=z.ui.Base.extend({events:{\"click button[data-template-id]\":\"useRecipe\"},initialize:function(options){this.options=options;_.bindAll(this);this.setMode(\"no\",\"text\");return this.model=this.options.model},context:function(){var context,_ref,_ref2;context={recipes:(_ref=z.app.recipes)!=null?_ref.toJSON():void 0,service:z.app.services.get((_ref2=z.app.partner.get(\"zap\"))!=null?_ref2.selected_api:void 0).getName(),button:this.options.button};return context},render:function(){this.$el.html(JST.dashboard_partner_zaps(this.context()));return this},useRecipe:function(e){var recipe;if(e!=null)e.preventDefault();$(e.currentTarget).attr(\"disabled\",true);recipe=z.app.recipes.get($(e.currentTarget).attr(\"data-template-id\"));return recipe.startUsing({success:function(read,write){$(e.currentTarget).attr(\"disabled\",false);return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}});z.ui.SharedZaps=z.ui.Base.extend({initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,this.options);z.app.recipes.on(\"remove\",this[\"delete\"],this);z.app.recipes.on(\"add\",this.add,this);this.views=[];return this.options.search.on(\"change:search\",this.renderSearch,this)},setEmptyModes:function(){return this.setMode(!z.app.recipes.any(),\"shared-empty\")},context:function(){var context;context={};return context},render:function(){var renderSearch,_this=this;this.$el.html(JST.dashboard_shared_zaps(this.context()));this.setEmptyModes();this.$shared=this.$(\".shared-zaps\");renderSearch=_.after(z.app.recipes.length,this.renderSearch);z.app.recipes.each(function(recipe){return _.defer(function(){_this.add(recipe);return renderSearch()})});return this},add:function(model){var view;view=_.find(this.views,function(view){return view.id===model.id});if(view!=null){view.$el.appendTo(this.$shared);view.delegateEvents()}else{view=new z.ui.SharedZap({recipe:model,zaps:this});view.id=model.id;this.$shared.append(view.render().el);this.views.push(view)}return this.setEmptyModes()},\"delete\":function(model){var view;view=_.find(this.views,function(view){return view.id===model.id});if(view!=null)view.remove();this.views=_.without(this.views,view);return this.setEmptyModes()},renderSearch:function(){var _this=this;return this.$(\".zap-mini\").each(function(i,el){var $el,recipe;$el=$(el);recipe=z.app.recipes.get($el.attr(\"data-shared-id\"));$el.removeClass(\"hide\");if(!_this.searchMatch(recipe))return $el.addClass(\"hide\")})},regex:{selected_api:/selected_api:(\"[^\"]+\"|[\\w]+)/g,params:/params:(\"[^\"]+\"|[\\w]+)/g,action:/action:(\"[^\"]+\"|[\\w]+)/g,status:/status:(\"[^\"]+\"|[\\w]+)/g},searchMatch:function(recipe){var any,each,haystack,m,needle,needles,q,_i,_len,_ref,_ref2,_this=this;q=this.search.get(\"search\")||\"\";needles=q.split(\"OR\");any=[];for(_i=0,_len=needles.length;_i<_len;_i++){needle=needles[_i];\neach=[];if(m=needle.match(this.regex.selected_api)){each.push(_.all(m,function(match){match=match.replace(\"selected_api:\",\"\");needle=needle.replace(\"selected_api:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return recipe.get(\"read_service_selected_api\")===match||recipe.get(\"write_service_selected_api\")===match}))}if(m=needle.match(this.regex.action)){each.push(_.all(m,function(match){match=match.replace(\"action:\",\"\");needle=needle.replace(\"action:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return recipe.get(\"read_data\").action===match||recipe.get(\"write_data\").action===match}))}if(m=needle.match(this.regex.params)){each.push(_.all(m,function(match){match=match.replace(\"params:\",\"\");needle=needle.replace(\"params:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return _.str.include(JSON.stringify(recipe.get(\"read_data\").params),match)||_.str.include(JSON.stringify(recipe.get(\"write_data\").params),match)}))}needle=_.trim(needle.toLowerCase());haystack=\"\";haystack+=(recipe!=null?recipe.get(\"title\"):void 0)+\" \";haystack+=(recipe!=null?recipe.get(\"read_data\").action:void 0)+\" \";haystack+=((_ref=z.app.services.get(recipe!=null?recipe.get(\"read_data\").selected_api:void 0))!=null?_ref.getName():void 0)+\" \";haystack+=(recipe!=null?recipe.get(\"write_data\").action:void 0)+\" \";haystack+=((_ref2=z.app.services.get(typeof wrecipe!==\"undefined\"&&wrecipe!==null?wrecipe.get(\"write_data\").selected_api:void 0))!=null?_ref2.getName():void 0)+\" \";haystack=haystack.toLowerCase();if((needle!=null?needle.length:void 0)>0){each.push(_.str.include(haystack,needle))}if(_.any(each,function(e){return!e})){any.push(false)}else{any.push(true)}}return _.any(any,function(a){return a})}});z.ui.BonusBlock=z.ui.Base.extend({className:\"widget bonuses\",initialize:function(){z.app.accountBonuses.on(\"change\",this.debounceRender,this);return this.debounceRender=_.debounce(this.render,1e3)},context:function(){var context;context={};context.bonuses=z.app.accountBonuses.toJSON();_.each(context.bonuses,function(bonus){bonus.earned=false;bonus.partial_earned=false;if(bonus.limit===1&&bonus.times_earned>0)bonus.earned=true;if(bonus.limit!==1&&bonus.times_earned===bonus.limit){bonus.earned=true}if(bonus.limit!==1&&bonus.times_earned>0){return bonus.partial_earned=true}});return context},render:function(){if(!z.app.account.isFree())return this;this.$el.html(JST.dashboard_bonus(this.context()));this.refresh();return this},refresh:function(){return z.app.accountBonuses.fetch({expiry:2e3})}});z.ui.CollectionBlock=z.ui.Base.extend({className:\"widget collection center\",events:{\"click .button\":\"click\"},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.dashboard_collection(this.context()));return this},click:function(){var modal;if(typeof e!==\"undefined\"&&e!==null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.CreateCollectionModal({})})}});z.ui.Zap=z.ui.Base.extend({tagName:\"div\",className:\"zap-mini dashboard\",attributes:function(){var _ref,_ref2;return{\"data-read-id\":(_ref=this.options.read)!=null?_ref.id:void 0,\"data-write-id\":(_ref2=this.options.write)!=null?_ref2.id:void 0}},events:{\"click .open-menu\":\"menu\",\"click .toggle .hit-target\":\"toggle\",\"click .count\":\"tag\",click:\"edit\"},initialize:function(options){var render;this.options=options;if(!(this.options.read!=null))throw\"read required\";if(!(this.options.write!=null))throw\"write required\";_.bindAll(this);_.defaults(this,this.options);render=_.debounce(this.render,40);this.setMode(this.state.get(\"open\")||\"not\",\"open\");this.setMode(this.state.get(\"paused\")||this.read.get(\"paused\"),\"paused\");this.setMode(this.state.get(\"delete\")||this.read.get(\"delete\"),\"delete\");this.read.on(\"change:title\",render,this);this.read.on(\"change:selected_api\",render,this);this.read.on(\"change:has_shared\",render,this);this.write.on(\"change:selected_api\",render,this);return z.app.stream.on(\"add remove reset\",render,this)},context:function(){var context,readService,t;readService=z.app.services.get(this.read.get(\"selected_api\"));context={};context.read=this.read.toJSON();context.write=this.write.toJSON();context.title=this.read.getTitle();context.cssReadClass=this.read.serviceImageClass();context.cssWriteClass=this.write.serviceImageClass();context.canRun=!(readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0);context.isStaff=z.app.account.isStaff();context.isComplete=this.read.isComplete();context.unseen=z.app.stream.unseen(this.write.get(\"id\"));t=z.useful.render(\"{{s}}\",{s:this.read.get(\"collect_errors\").join(\"<br />\")});context.errorString=new Handlebars.SafeString(t);return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_zap(context));return this},edit:function(e){var $elX,menuX,toggleX,x,_ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();$elX=this.$el.offset().left;x=e.pageX-$elX;if(this.$(\".toggle\").length>0){toggleX=this.$(\".toggle\").offset().left-$elX;menuX=this.$(\".open-menu\").offset().left-$elX;if(x<toggleX){return Backbone.history.navigate(\"app/editor/\"+this.read.id,{trigger:true})}else if(x<menuX){return this.toggle(e)}else{return this.menu(e)}}else{menuX=this.$(\".open-menu\").offset().left-$elX;if(x<menuX){return Backbone.history.navigate(\"app/editor/\"+this.read.id,{trigger:true})}else{return this.menu(e)}}},menu:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.ZapMenu({read:this.read,write:this.write}),target:this.$(\".open-menu\"),x:-215,y:48,noX:true})},toggle:function(e){if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if(this.read.get(\"paused\")){return this.unpause(e)}else{return this.pause(e)}},pause:function(e){var _this=this;return this.$el.animate({opacity:.25},350,function(){return _this.read.pause({wait:true,success:function(){_this.$el.animate({opacity:1},350,function(){return _this.render()});return _this.setMode(\"is\",\"paused\")}})})},unpause:function(e){var _this=this;return this.$el.animate({opacity:.25},350,function(){return _this.read.unpause({wait:true,error:function(model,xhr){var error,modal;_this.$el.animate({opacity:1},350,function(){});_this.setMode(\"is\",\"paused\");if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})},success:function(){_this.$el.animate({opacity:1},350,function(){return _this.render()});return _this.setMode(\"not\",\"paused\")}})})},tag:function(e){return e!=null?e.stopPropagation():void 0}});z.ui.ZapMenu=z.ui.Base.extend({className:\"zap-menu-modal menu with-hover\",events:{\"click .edit\":\"edit\",\"click .logs\":\"logs\",\"click .copy\":\"copy\",\"click .rename\":\"rename\",\"click .share\":\"share\",\"click .delete\":\"delete\",\"click .recipe\":\"recipe\",\"click .instant\":\"instant\",\"click .run\":\"run\"},initialize:function(options){this.options=options;_.bindAll(this);this.read=this.options.read;return this.write=this.options.write},context:function(){var context,readService;readService=z.app.services.get(this.read.get(\"selected_api\"));context={};context.read=this.read.toJSON();context.write=this.write.toJSON();context.title=this.read.getTitle();context.cssReadClass=this.read.serviceImageClass();context.cssWriteClass=this.write.serviceImageClass();context.canRun=!(readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0);context.isStaff=z.app.account.isStaff();context.isComplete=this.read.isComplete();context.unseen=z.app.stream.unseen(this.write.get(\"id\"));context.canShare=this.read.canShare()&&this.write.canShare();return context},render:function(){this.$el.html(JST.dashboard_zap_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},run:function(e){var modal;if(e!=null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.RunZap({read:this.read})})},edit:function(e){if(e!=null)e.preventDefault();return this.close()},logs:function(e){if(e!=null)e.preventDefault();return this.close()},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.$el.animate({opacity:0},350,function(){_this.close();return _this.read.destroy()})},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.read.save({title:value})};modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.read.getTitle(),save:save})});return this.close()},share:function(e){if(e!=null)e.preventDefault();this.shareZapModal=new z.ui.Modal({view:new z.ui.ShareZapModal({read:this.read,write:this.write})});return this.close()},copy:function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"copy\")===\"working\")return;this.setMode(\"working\",\"copy\");return this.read.copy({success:function(){return _.delay(function(){_this.setMode(\"default\",\"copy\");return _this.close()},1e3)}})},getRecipeURL:function(){var base,qs;base=\"/admin/snapbook/recipe/add/\";qs=$.param({title:\"\"+_.superHumanize(this.read.get(\"action\"))+\" to \"+_.superHumanize(this.write.get(\"action\")),read:this.read.get(\"selected_api\"),write:this.write.get(\"selected_api\"),read_action:this.read.get(\"action\"),write_action:this.write.get(\"action\"),read_params:JSON.stringify(this.read.get(\"params\")),write_params:JSON.stringify(this.write.get(\"params\"))});return\"\"+base+\"?\"+qs},recipe:function(e){var options,target,url,win;if(e!=null)e.preventDefault();url=this.getRecipeURL();target=null;options=\"height=600,width=980,resizable=yes,scrollbars=yes\";win=z.useful.open(url,target,options).focus();return this.close()},instant:function(e){if(e!=null)e.preventDefault()}});z.ui.Support=z.ui.Base.extend({events:{click:\"open\"},initialize:function(options){var _this=this;_.bindAll(this);return Backbone.history.on(\"route\",function(){_this.render();if(_.str.include(Backbone.history.fragment,\"help/\")){return $(\".support-button\").addClass(\"on-help\")}else{return $(\".support-button\").removeClass(\"on-help\")}})},open:function(e){if(e!=null)e.preventDefault();if(_.str.include(Backbone.history.fragment,\"help/\")){return this.contactSupport()}else{return z.useful.goto(\"/help\")}},contactSupport:function(){var modal;return modal=new z.ui.Modal({view:new z.ui.ContactModal})},context:function(){var context;context={};if(_.str.include(Backbone.history.fragment,\"help/\")){context[\"label\"]=\"Contact us\"}else{context[\"label\"]=\"Get help\"}return context},render:function(){this.$el.html(JST.support_base(this.context()));return this}});z.ui.ContactModal=z.ui.Base.extend({className:\"support-question\",events:{\"click button.submit\":\"submit\"},initialize:function(options){var _ref,_ref2,_ref3,_this=this;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}this.IDENTIFIER=[{key:\"full_name\",label:\"Your full name.\",type:\"unicode\",required:true},{key:\"email\",label:\"Your email address.\",type:\"unicode\",required:true}];this.CHOICES=[\"I have a question before signing up.\",\"I can't access my account.\",\"I can't get my zap to work.\",\"I got an error on my zap.\",\"I have a billing/pricing question.\",\"Some other issue.\"];if((_ref2=z.app.account)!=null?_ref2.id:void 0){this.IDENTIFIER=[];this.CHOICES=[\"I can't get my zap to work.\",\"I got an error on my zap.\",\"I have a billing/pricing question.\",\"I have a request for a new feature or supported service.\",\"Some other issue.\"]}this.fields=[{key:\"question_type\",label:\"What do you need help with?\",choices:this.CHOICES,type:\"prettypills\",required:true}];this.form=new z.model.FormSet(this.fields);this.form.on(\"change\",this.formChange,this);this.form.on(\"add reset\",this.render,this);this.setMode(\"cannot\",\"save\");if(((_ref3=z.app.account)!=null?_ref3.id:void 0)&&(!(z.app.reads!=null)||!(z.app.services!=null))){return async.parallel({services:async.fetch(new z.model.ServiceSet),reads:async.fetch(new z.model.ReadSet)},function(err,models){_.extend(z.app,models);return _this.render()})}},context:function(){var context,_ref;context={button:(_ref=this.options)!=null?_ref.button:void 0,mediaUrl:window.mediaUrl};return context},render:function(){var view;this.$el.html(JST.support_contact_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.form,prettypills:true});this.$paramform.html(view.render().el);return this},formChange:function(e){var ZAP_FORM,choice_fields,extended_fields,fields,_ref,_ref2,_ref3;fields=this.form.toJSON().slice(0,1);ZAP_FORM=[{key:\"zap\",label:\"Which zap is having the issue?\",help_text:\"Please do not delete/modify the zap! We will need to use it to debug.\",type:\"unicode\",choices:(_ref=z.app.reads)!=null?_ref.map(function(read){return\"\"+(read.getTitle()||\"Unnamed Zap\")+\" (https://zapier.com/app/edit/\"+read.id+\")\"}):void 0,required:true},{key:\"message\",label:\"Describe the problem you are having. What did you want to happen?\",help_text:\"The more details you provide the faster/better we can respond! For example, let us know what you tried already, or what you expected to happen, etc...\",type:\"text\",required:true},{key:\"media_urls\",label:\"Videos/Screenshots URL\",help_text_html:'<p>Videos/Screenshots are the best way to show us <em>exactly</em> what is going on. Use a service like <strong><a target=\"_new\" href=\"http://imgur.com/\">Imgur</a></strong> to upload images, or a service like <strong><a target=\"_new\" href=\"http://www.techsmith.com/jing.html\">Jing</a></strong> to share videos.</p>',type:\"unicode\",required:false}];if(!((_ref2=z.app.account)!=null?_ref2.id:void 0)){ZAP_FORM=[{key:\"login\",help_text_html:'<br /><p class=\"red\"><em>You need to <a href=\"/app/login?next='+window.location.pathname+'\">login first</a> if you want to ask a zap specific question!</em></p>',type:\"copy\",required:true}]}if(fields[0][\"value\"]&&this.currentType!==fields[0][\"value\"]){this.currentType=fields[0][\"value\"];choice_fields={\"I have a question before signing up.\":this.IDENTIFIER.concat([{key:\"message\",label:\"What is your question?\",help_text:\"The more details you provide, the faster we can respond!\",type:\"text\",required:true}]),\"I can't access my account.\":this.IDENTIFIER.concat([{key:\"message\",label:\"More information.\",help_text:\"Please provide any identifying information you might have about the inaccessible account (company name, alternate emails, usernames, etc...).\",type:\"text\",required:false}]),\"I can't get my zap to work.\":this.IDENTIFIER.concat(ZAP_FORM),\"I got an error on my zap.\":this.IDENTIFIER.concat(ZAP_FORM),\"I have a request for a new feature or supported service.\":this.IDENTIFIER.concat([{key:\"service\",label:\"Which service does this pertain to?\",type:\"unicode\",choices:[\"Suggest New Service\"].concat((_ref3=z.app.services)!=null?_ref3.filter(function(service){var _ref4;return!((_ref4=service.get(\"meta\"))!=null?_ref4.hide:void 0)}).map(function(service){return\"\"+service.getName()}):void 0),required:true},{key:\"message\",label:\"Provide more details.\",type:\"text\",required:true}]),\"I have a billing/pricing question.\":this.IDENTIFIER.concat([{key:\"message\",label:\"Ask away! The more details you provide, the faster we can respond!\",type:\"text\",required:true}]),\"Some other issue.\":this.IDENTIFIER.concat([{key:\"message\",label:\"Describe the issue you are having.\",help_text:\"The more details you provide, the faster we can respond!\",type:\"text\",required:true},{key:\"media_urls\",label:\"Videos/Screenshots URL\",help_text_html:'<p>Videos/Screenshots are the best way to show us <em>exactly</em> what is going on. Use a service like <strong><a target=\"_new\" href=\"http://imgur.com/\">Imgur</a></strong> to upload images, or a service like <strong><a target=\"_new\" href=\"http://www.techsmith.com/jing.html\">Jing</a></strong> to share videos.</p>',type:\"unicode\",required:false}])};extended_fields=choice_fields[this.currentType];this.form.reset(fields.concat(extended_fields));this.modal.reposition()}if(this.form.isValid()){return this.setMode(\"can\",\"save\")}else{return this.setMode(\"cannot\",\"save\")}},submit:function(e){var values;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"cannot\",\"save\"))return;this.setMode(\"cannot\",\"save\");this.$(\".feedback\").text(\"\").removeClass(\"error\");this.$(\"button\").text(\"Sending...\");values=this.form.getValues();values.current_url=String(window.location.href);return this.save(values)},saveSuccess:function(model){var _this=this;this.$(\".submitter\").html('<em class=\"lighter\">Got it! We will respond via email as soon as possible!</em> <a class=\"close\">Close this.</a>');return setTimeout(function(){return _this.modal.close()},1e4)},saveError:function(model,xhr){var errors;this.setMode(\"can\",\"save\");errors=z.useful.errors(xhr);this.$(\".feedback\").text(errors).addClass(\"error\");return this.$(\"button\").text(\"Send Support Request\")},save:function(values){return $.ajax({url:z.cfg.api+\"/support/contact\",type:\"POST\",data:JSON.stringify(values),dataType:\"json\",contentType:\"application/json\",success:this.saveSuccess,error:this.saveError})}});z.ui.SupportNote=z.ui.Base.extend({events:{\"click [data-support-vote]\":\"vote\"},initialize:function(options){this.options=options;return _.bindAll(this)},vote:function(e){var helpful,success,_this=this;helpful=$(e.currentTarget).attr(\"data-support-vote\");success=function(){return _this.$el.find(\".vote\").text(\"Thanks! This helps us provide better support.\")};return this.options.note.vote({success:success},helpful)},context:function(){var context,_ref;context=this.options.note.toJSON();context=_.extend(context,{first:this.options.first,more:this.options.more,isStaff:(_ref=z.app.account)!=null?_ref.get(\"is_staff\"):void 0});return context},render:function(){var context;context=this.context();this.$el.html(JST.support_note(context));return this}});z.ui.Plans=z.ui.Base.extend({events:{\"click .toggle-interval .switch\":\"switch\",\"click .toggle-interval .toggle-container\":\"toggle\",\"click [data-explain-highlight]\":\"highlight\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);return this.variant=\"month\"},context:function(){var context;context={services:z.app.services,monthly:this.variant===\"month\",plans:z.app.plans.getIntervalPlans(this.variant)};return context},toggle:function(e){var t;t=$(e.currentTarget);if(t.hasClass(\"on\")){this.variant=\"month\"}else{this.variant=\"year\"}t.toggleClass(\"on\");this.render();return this.normalizePlanHeight()},\"switch\":function(e){var t;if(e!=null)e.preventDefault();t=$(e.currentTarget);t.parent().toggleClass(\"on\");this.variant=t.attr(\"data-pricing-interval\");this.render();return this.normalizePlanHeight()},highlight:function(e){var highlightThis,target;highlightThis=$(e.currentTarget).attr(\"data-explain-highlight\");this.$el.find(\"[data-explain]\").removeClass(\"highlighted\");target=this.$el.find('[data-explain=\"'+highlightThis+'\"]');return $(\"html, body\").animate({scrollTop:target.offset().top-100},100,function(){return target.addClass(\"highlighted\")})},render:function(){var context;context=this.context();this.$el.html(JST.pricing_plans(context));return this},normalizePlanHeight:function(cb){var height,plan_boxes;plan_boxes=this.$el.find(\".plan .features\");height=_.max(_.map(plan_boxes,function(el){return $(el).height()}));if(height){plan_boxes.css({height:height+\"px\"})}return typeof cb===\"function\"?cb():void 0}});z.ui.DeveloperAppRequests=z.ui.Base.extend({events:{\"click #request-log-controls button\":\"loadRequestLogs\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_requests(this.context()));this.loadRequestLogs();return this},displayRequest:function(html){var backLink,origScroll,requestLog,requestLogControls,requestLogList,requsetDetails;requestLog=this.$el.find(\"#request-log\");requestLogControls=this.$el.find(\"#request-log-controls\");requestLogList=requestLog.find(\"table\");origScroll=$(\"body\").scrollTop();requsetDetails=$(\"<div>\").append(html);backLink=$('<a href=\"#\">Back to List</a>').on(\"click\",function(e){e.preventDefault();requsetDetails.remove();requestLogControls.show();requestLogList.show();return $(\"body\").scrollTop(origScroll)});requsetDetails.prepend(backLink);requestLogControls.hide();requestLogList.hide();requestLog.append(requsetDetails);return $(\"body\").scrollTop(0)},loadRequestLogs:function(){var ajaxifyRequestLinks,refreshIcon,requestLog,_this=this;requestLog=this.$el.find(\"#request-log\");ajaxifyRequestLinks=function(){return $(\"#request-log table a\").on(\"click\",function(e){var url;e.preventDefault();url=$(e.target).attr(\"href\")+\"?wrap=false\";return $.ajax(url,{success:_this.displayRequest})})};refreshIcon=$(\"#request-log-controls button\");refreshIcon.html(\"Loading...\");return $.ajax(\"/developer/app/\"+z.app.developer.app.id+\"/requests?wrap=false\",{success:function(html){requestLog.find(\"table\").remove();requestLog.append(html);ajaxifyRequestLinks();refreshIcon.html(\"Done\");return setTimeout(function(){return refreshIcon.html(\"Refresh\")},1500)}})}});z.ui.DeveloperAppAuthFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_auth_field_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppAuthFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"auth field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),app:z.app.developer.app.toJSON(),isWizard:this.options.isWizard}},render:function(){this.$el.html(JST.developer_app_edit_auth_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref,_ref2;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.authFields.add(model)}if((_ref2=this.options)!=null?_ref2.isWizard:void 0){next=\"/auth/edit/fields\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+next,{trigger:true})}});z.ui.DeveloperAppTriggerFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_trigger_field_table_row(this.context()));return this}});z.ui.DeveloperAppTriggerFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"trigger field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_edit_trigger_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var _ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){this.options.trigger.fields.add(model)}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/triggers/\"+this.options.trigger.get(\"id\")+\"/fields\",{trigger:true})}});z.ui.DeveloperAppAuth=z.ui.DeveloperAppCommonSection.extend({events:{\"click .save-sortable\":\"saveSortable\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},context:function(){var allWarnings,warnings;allWarnings=z.app.developer.app.get(\"warnings\");warnings=[];if(allWarnings!=null?allWarnings.auth_mapping:void 0){warnings=warnings.concat(allWarnings.auth_mapping)}if(allWarnings!=null?allWarnings.oauth_data:void 0){warnings=warnings.concat(allWarnings.oauth_data)}return{app:z.app.developer.app.toJSON(),warnings:warnings}},renderRows:function(){return z.ui.DeveloperAppCommonSection.prototype.renderRows.apply(this,[z.app.developer.app.authFields,z.ui.DeveloperAppAuthFieldSummary])},render:function(){this.$el.html(JST.developer_app_auth(this.context()));return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.authFields,z.ui.DeveloperAppAuthFieldSummary,JST.developer_app_auth_empty_section])},gotSorted:false,saveSortable:function(){var _this=this;this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save-sortable\").text(\"Saving...\");this.$el.find(\".save-sortable\").attr(\"disabled\",\"disabled\");return z.app.developer.app.authFields.saveSort({success:function(){_this.$el.find(\".save-sortable\").text(\"Success!\");return _.delay(function(){return _this.$el.find(\".save-sortable\").hide()},1e3)},error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));_this.$el.find(\".save-sortable\").text(\"Save Sorting\");return _this.$el.find(\".save-sortable\").removeAttr(\"disabled\",\"disabled\")}})},sortFields:function(id,pad){this.$el.find(\".save-sortable\").show();this.gotSorted=true;z.app.developer.app.authFields.models=z.app.developer.app.authFields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});z.app.developer.app.authFields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)}});z.ui.DeveloperAppAuthSettings=z.ui.DeveloperAppCommonForm.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_auth_settings(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppTriggerFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},renderRows:function(){var fieldContainer;this.$el.find(\".trigger-fields tbody\").html(\"\");fieldContainer=this.$el.find(\".trigger-fields tbody\");return this.options.trigger.fields.each(function(field){var view;view=new z.ui.DeveloperAppTriggerFieldSummary({trigger:this.options.trigger,model:field});return fieldContainer.append(view.render().el)},this)},render:function(){this.$el.html(JST.developer_app_trigger_fields(this.context()));this.renderRows();return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;this.options.trigger.fields.models=this.options.trigger.fields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});this.options.trigger.fields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(){var goNextUrl,_this=this;goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/triggers/\"+_this.options.trigger.get(\"id\")+\"/edit/backend\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return this.options.trigger.fields.saveSort({success:goNextUrl,error:function(){this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppTriggers=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_triggers(this.context()));z.app.developer.app.triggers.sort();return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.triggers,z.ui.DeveloperAppTriggerSummary,JST.developer_app_triggers_empty_section])}});z.ui.DeveloperAppActionEditor=z.ui.Base.extend({className:\"action-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_action(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppActionEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_action_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.actions.add(model)}if(this.section===\"appearance\"){next=\"actions/\"+model.get(\"id\")+\"/edit/fields\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/\"+next,{trigger:true})}});z.ui.DeveloperAppActionFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},renderRows:function(){var fieldContainer;this.$el.find(\".action-fields tbody\").html(\"\");fieldContainer=this.$el.find(\".action-fields\");return this.options.action.fields.each(function(field){var view;view=new z.ui.DeveloperAppActionFieldSummary({action:this.options.action,model:field});return fieldContainer.append(view.render().el)},this)},render:function(){var fieldContainer;this.$el.html(JST.developer_app_action_fields(this.context()));fieldContainer=this.$el.find(\".action-fields\");this.options.action.fields.each(function(field){var view;view=new z.ui.DeveloperAppActionFieldSummary({action:this.options.action,model:field});return fieldContainer.append(view.render().el)},this);return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;this.options.action.fields.models=this.options.action.fields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});this.options.action.fields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));\nreturn this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(e){var goNextUrl,_this=this;if(e!=null)e.preventDefault();goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/actions/\"+_this.options.action.get(\"id\")+\"/edit/backend\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return this.options.action.fields.saveSort({success:goNextUrl,error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return _this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppTriggerEditor=z.ui.Base.extend({className:\"trigger-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_trigger(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppTriggerEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_trigger_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.triggers.add(model)}if(this.section===\"appearance\"){next=\"triggers/\"+model.get(\"id\")+\"/edit/fields\"}else if(this.section===\"backend\"){next=\"triggers/\"+model.get(\"id\")+\"/edit/sample\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/\"+next,{trigger:true})}});z.ui.DeveloperAppInvite=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_invite(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var modal;this.form.clearErrors();modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_invite_success_modal({numSent:response!=null?response.count:void 0})})}});z.ui.DeveloperAppScripting=z.ui.Base.extend({className:\"scripting-new\",events:{\"click .save\":\"save\",\"click .links\":\"links\",\"click .go-back\":\"back\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){var _ref;if((_ref=_this.menuModal)!=null)_ref.close();return window.onbeforeunload=null})},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){var _this=this;this.$el.html(JST.developer_app_scripting(this.context()));this.editor=CodeMirror.fromTextArea(this.$(\"textarea\")[0],{lineNumbers:true,lineWrapping:true,indentUnit:4,matchBrackets:true,mode:\"javascript\"});this.editor.on(\"change\",_.debounce(this.stale,500));_.defer(function(){return _this.editor.refresh()});return this},save:function(e){var _this=this;if(e!=null)e.preventDefault();z.app.developer.app.save({js:this.editor.getValue()},{success:function(){_this.$(\".save\").text(\"Saved!\");return window.onbeforeunload=null},error:function(){return _this.$(\".save\").text(\"Error!\")}});return this.$(\".save\").text(\"Saving...\")},links:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.ScriptingLinksMenu({}),target:this.$(\".buttons\"),x:-100,y:40,noX:true})},stale:function(){var current,saved,_this=this;saved=_.str.clean(z.app.developer.app.get(\"js\"));current=_.str.clean(this.editor.getValue());if(saved!==current){window.onbeforeunload=function(){return\"You have unsaved changes! Are you sure you want to leave?\"};return this.$(\".save\").text(\"Save\")}else{return window.onbeforeunload=null}},back:function(e){var go,id,_this=this;if(e!=null)e.preventDefault();id=z.app.developer.app.id;go=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+id,{trigger:true})};if(window.onbeforeunload!=null){if(confirm(window.onbeforeunload()))return go()}else{return go()}}});z.ui.ScriptingLinksMenu=z.ui.Base.extend({className:\"developer-app-scripting-menu-modal menu with-hover\",events:{\"click a\":\"close\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={app:z.app.developer.app.toJSON()};return context},render:function(){this.$el.html(JST.developer_app_scripting_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})}});z.ui.DeveloperAppTriggerSampleResult=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);return z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments)},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),isNew:z.app.developer.form.wrappedModel.isNew()}},render:function(){var _this=this;this.$el.html(JST.developer_app_trigger_sample_result(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();z.app.developer.form.get(\"sample\").on(\"change\",this.updateSaveButtonCopy);this.overrideForms={};_.each(this.options.triggerSample.get(\"overrides\"),function(override){var overrideEl,overrideModel,overrideView;overrideModel=new z.model.DeveloperAppFormSet([_this.buildOverrideLabelFormRow(override),_this.buildOverrideImportantFormRow(override)]);_this.overrideForms[override.key]=overrideModel;overrideEl=$(\"<div></div>\").html(JST.developer_app_trigger_sample_override_form({key:override.key}));overrideView=new z.ui.DeveloperAppParamForm({form:overrideModel,el:overrideEl.find(\"form\")});overrideView.render();return _this.$el.find(\"#override-container\").append(overrideEl)});return this},save:function(e){var overrides,_this=this;if(e!=null)e.preventDefault();overrides=this.options.triggerSample.get(\"overrides\");_.each(overrides,function(override){var values;values=_this.overrideForms[override.key].getValues();return override=_.extend(override,values)});z.app.developer.form.save()},saveSuccess:function(model,response,options){var _ref;if((_ref=z.app.developer.form.wrappedModel.changed)!=null?_ref.sample:void 0){this.render()}else{Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}},buildOverrideLabelFormRow:function(override){return new z.model.FormRow({key:\"label\",value:override!=null?override.label:void 0,required:false,label:\"Label\",type:\"unicode\",help_text:\"\"})},buildOverrideImportantFormRow:function(override){return new z.model.FormRow({key:\"important\",value:override!=null?override.important:void 0,required:false,label:\"Important\",type:\"checkbox\"})},updateSaveButtonCopy:function(e){this.$el.find(\"button.save\").text(\"Parse Sample\");this.$el.find(\"#override-container\").slideUp()}});z.ui.DeveloperAppActivation=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:z.app.developer.app.toJSON(),hasErrors:this.options.audit.hasErrors()}},render:function(){var auditView;this.$el.html(JST.developer_app_global_activation(this.context()));auditView=new z.ui.DeveloperAppAudit({audit:this.options.audit});this.$el.find(\".developer-app-audit\").html(auditView.render().el);if(!this.options.audit.hasErrors()){this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render()}return this},saveSuccess:function(model,response,options){var modal;modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_global_activation_success_modal()});modal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})})}});z.ui.DeveloperAppMeta=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:this.options.app.toJSON()}},render:function(){var fileInput,_this=this;this.$el.html(JST.developer_app_meta(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();if(this.options.app.get(\"id\")!=null){fileInput=this.$el.find('input[type=\"file\"]');fileInput.attr(\"data-url\",\"\"+z.cfg.devapi+\"/apps/\"+this.options.app.get(\"id\")+\"/image\");fileInput.fileupload({dataType:\"json\",add:function(e,data){return z.app.developer.form.setFileUpload(data)}})}else{this.$el.find(\"div.field-image\").hide()}return this},saveSuccess:function(model,response,options){var _ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app=model;if(z.app.developer.apps!=null)z.app.developer.apps.add(model)}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppMigrate=z.ui.Base.extend({className:\"developer-app\",initialize:function(options){this.options=options;return _.bindAll(this)},events:{\"click .save\":\"next\"},context:function(){return{app:z.app.developer.app.toJSON(),hasErrors:this.options.audit.hasErrors()}},render:function(){var auditView;this.$el.html(JST.developer_app_migrate(this.context()));auditView=new z.ui.DeveloperAppAudit({audit:this.options.audit});this.$el.find(\".developer-app-audit\").html(auditView.render().el);return this},next:function(){return $.ajax({type:\"POST\",url:z.cfg.devapi+\"/apps/migrations\",data:JSON.stringify({old_app:this.options.oldAppId,new_app:z.app.developer.app.get(\"id\")}),dataType:\"json\",contentType:\"application/json\",success:function(data,xhr){var modal;modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_migrate_success_modal()});return modal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}});z.ui.DeveloperAppChooseMigrationTarget=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},events:{\"click .save\":\"next\"},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_migrate_choose_target(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},next:function(){var old_app_id;if(typeof e!==\"undefined\"&&e!==null)e.preventDefault();if(z.app.developer.form.isValid()){old_app_id=z.app.developer.form.getValues()[\"old_app\"];Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/migrate/\"+old_app_id,{trigger:true})}}});z.ui.DeveloperAppAuthEditor=z.ui.Base.extend({className:\"auth-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_auth_editor(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppAuthEditorScheme=z.ui.Base.extend({events:{\"click #use-basic-auth\":\"enableBasicAuth\",\"click #use-api-key\":\"showApiKeySubMenu\",\"click #use-oauthv2\":\"showOauthV2SubMenu\",\"click #use-digest-auth\":\"enableDigestAuth\",\"click #api-key-sub-type button\":\"enableApiKey\",\"click #oauthv2-sub-type button\":\"enableOauthV2\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON(),devpath:z.cfg.devpath}},render:function(){this.$el.html(JST.developer_app_auth_choose_scheme(this.context()));return this},saveAuthFieldsAndNext:function(){var saves,_this=this;saves=[];z.app.developer.app.authFields.each(function(field){return saves.push(function(cb){return field.save({required:true},{success:function(){return cb()}})})});async.parallel(saves,function(err,models){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/auth/edit/fields\",{trigger:true})})},enableBasicAuth:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",1);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Username\",key:\"username\",type_of:\"unicode\"},{app:z.app.developer.app});z.app.developer.app.authFields.add({label:\"Password\",key:\"password\",type_of:\"password\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}},showApiKeySubMenu:function(e){e.preventDefault();this.$el.find(\"#api-key-sub-type\").show();return this.$el.find(\"#oauthv2-sub-type\").hide()},enableApiKey:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",this.$(e.target).val());if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"API Key\",key:\"api_key\",type_of:\"unicode\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}},showOauthV2SubMenu:function(e){e.preventDefault();this.$el.find(\"#api-key-sub-type\").hide();return this.$el.find(\"#oauthv2-sub-type\").show()},enableOauthV2:function(e){var authType;authType=parseInt(this.$(e.target).val());z.app.developer.app.set(\"auth_type\",authType);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Access Token\",key:\"access_token\",type_of:\"unicode\"},{app:z.app.developer.app});if(authType===6){z.app.developer.app.authFields.add({label:\"Refresh Token\",key:\"refresh_token\",type_of:\"unicode\"},{app:z.app.developer.app})}this.saveAuthFieldsAndNext()}},enableDigestAuth:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",7);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Username\",key:\"username\",type_of:\"unicode\"},{app:z.app.developer.app});z.app.developer.app.authFields.add({label:\"Password\",key:\"password\",type_of:\"password\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}}});z.ui.DeveloperAppAuthEditorFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},context:function(){return{app:z.app.developer.app.toJSON(),devpath:z.cfg.devpath}},renderRows:function(){var container;container=this.$el.find(\".table tbody\");container.html(\"\");return z.app.developer.app.authFields.each(function(model){var view;view=new z.ui.DeveloperAppAuthFieldSummary({model:model});return container.append(view.render().el)},this)},render:function(){if(z.app.developer.app.authFields.size()>0){this.$el.html(JST.developer_app_auth_editor_fields(this.context()));this.renderRows()}else{this.$el.html(JST.developer_app_auth_empty_fields(this.context()))}if(z.app.developer.app.authFields.size()>0){this.$el.find(\".table tbody\").find(\"a[data-nav]\").each(function(index,elem){elem=$(elem);elem.attr(\"data-nav\",elem.attr(\"data-nav\").replace(\"auth/\",\"auth/edit/\").slice(0,-5));elem.attr(\"href\",elem.attr(\"href\").replace(\"auth/\",\"auth/edit/\").slice(0,-5))})}return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;z.app.developer.app.authFields.models=z.app.developer.app.authFields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});z.app.developer.app.authFields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(e){var goNextUrl,_this=this;if(e!=null)e.preventDefault();goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/auth/edit/mapping\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return z.app.developer.app.authFields.saveSort({success:goNextUrl,error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return _this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppAuthEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_auth_editor_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();this.form.$el.find(\"div.field-auth-type\").hide();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperApp=z.ui.Base.extend({className:\"developer-app\",events:{\"click #make-global\":\"showMakeGlobalModal\",\"click #enable-invite\":\"showEnableInviteModal\",\"click #clone-app\":\"cloneApp\",\"click #revert-app\":\"revertApp\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON(),isEditable:z.app.developer.app.isEditable(),isActive:z.app.developer.app.get(\"status\")>0}},render:function(){var wrapper;this.$el.html(JST.developer_app(this.context()));wrapper=this.$el.find(\"div.all-wrapper\");if(!_.isEmpty(z.app.developer.app.get(\"stats\"))){wrapper.append(this.options.subViews.stats.render().el)}wrapper.append(this.options.subViews.auth.render().el);wrapper.append(this.options.subViews.triggers.render().el);wrapper.append(this.options.subViews.actions.render().el);return this},showMakeGlobalModal:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_global_modal,yes:function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/activate\",{trigger:true})}})})},showEnableInviteModal:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_invite_modal,yes:function(){var id;id=z.app.developer.app.get(\"id\");return $.ajax({url:z.cfg.devapi+(\"/apps/\"+id+\"/invite_activation\"),type:\"POST\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(){var successModal;modal.close();successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_invite_activation_success_modal()});return successModal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.loadUrl()})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}})})},cloneApp:function(e){e.preventDefault();$.ajax({url:z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/clones\"),type:\"POST\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(data){var successModal;z.app.developer.isAppSetCacheStale=true;successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_clone_success_modal()});return successModal.on(\"remove\",function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+data.id,{trigger:true})})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})},revertApp:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_revert_modal,yes:function(){return $.ajax({url:z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/activation\"),type:\"DELETE\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(data){var successModal;modal.close();successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_revert_success_modal()});return successModal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.loadUrl()})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}})})}});z.ui.DeveloperAppSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){var statusMap;statusMap={0:\"Private\",1:\"Pending\",2:\"Invite-Only\",3:\"Global\"};return{app:this.model.toJSON(),prettyStatus:statusMap[this.model.get(\"status\")]}},render:function(){this.$el.html(JST.developer_app_table_row(this.context()));return this}});z.ui.DeveloperAppTriggerSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){var sourceMap;sourceMap={polling:\"Polling\",\"static-webhooks\":\"Static Webhooks\",\"payload-subscriptions\":\"REST Hooks\",\"notification-subscriptions\":\"Notification REST Hooks\"};return{trigger:this.model.toJSON(),app:z.app.developer.app.toJSON(),prettySource:sourceMap[this.model.get(\"source\")]}},render:function(){this.$el.html(JST.developer_app_trigger_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppTriggerSettings=z.ui.DeveloperAppCommonForm.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){var formChoices;formChoices=z.app.developer.form.get(\"test_trigger\").get(\"choices\");if(_.keys(formChoices).length+1!==z.app.developer.app.triggers.size()){formChoices={\"null\":\"None\"};z.app.developer.app.triggers.each(function(trigger){return formChoices[trigger.id]=trigger.get(\"label\")});z.app.developer.form.get(\"test_trigger\").set(\"choices\",formChoices)}this.$el.html(JST.developer_app_trigger_settings(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppAudit=z.ui.Base.extend({context:function(){var errors,warnings;errors=[];_.each(this.options.audit.get(\"errors\"),function(errorsForObject,objectName,array){return errors.push({name:objectName,errors:errorsForObject})});warnings=[];_.each(this.options.audit.get(\"warnings\"),function(warningsForObject,objectName,array){return warnings.push({name:objectName,warnings:warningsForObject})});return{errors:errors,warnings:warnings}},render:function(){this.$el.html(JST.developer_app_audit(this.context()));return this}});z.ui.DeveloperDashboard=z.ui.Base.extend({className:\"dashboard\",initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{activeCount:z.app.developer.apps.where({status:3}).length,inviteCount:z.app.developer.apps.where({status:2}).length,pendingCount:z.app.developer.apps.where({status:1}).length,privateCount:z.app.developer.apps.where({status:0}).length}},render:function(){var activeContainer,inviteContainer,pendingContainer,privateContainer;this.$el.html(JST.developer_dashboard(this.context()));privateContainer=this.$el.find(\".private-developer-apps tbody\");pendingContainer=this.$el.find(\".pending-developer-apps tbody\");inviteContainer=this.$el.find(\".invite-developer-apps tbody\");activeContainer=this.$el.find(\".active-developer-apps tbody\");_.each(z.app.developer.apps.sortBy(\"title\"),function(app){var view;view=new z.ui.DeveloperAppSummary({model:app});if(app.get(\"status\")===0){return privateContainer.append(view.render().el)}else if(app.get(\"status\")===1){return pendingContainer.append(view.render().el)}else if(app.get(\"status\")===2){return inviteContainer.append(view.render().el)}else{return activeContainer.append(view.render().el)}},this);return this}});z.ui.DeveloperAppActions=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_actions(this.context()));z.app.developer.app.actions.sort();return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.actions,z.ui.DeveloperAppActionSummary,JST.developer_app_actions_empty_section])}});z.ui.DeveloperAppStats=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_stats(this.context()));return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.stats(),z.ui.DeveloperAppStatsSummary])}});z.ui.DeveloperAppStatsSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{stat:this.model.toJSON()}},render:function(){this.$el.html(JST.developer_app_stats_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppActionFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_action_field_table_row(this.context()));return this}});z.ui.DeveloperAppActionFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"action field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_edit_action_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var actionId,appId,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){this.options.action.fields.add(model)}appId=z.app.developer.app.get(\"id\");actionId=this.options.action.get(\"id\");Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+appId+\"/actions/\"+actionId+\"/fields\",{trigger:true})}});z.ui.DeveloperAppActionSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{action:this.model.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_action_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.SelectfillModal=z.ui.Base.extend({className:\"selectfill-wrapper select\",STILL_LOADING:[[\"Loading choices ...\",\"Still loading choices ...\",\"Still still loading choices (hang tight, can take a minute) ...\"],[\"Knocking on {{#plural}}{{service}}{{/plural}} door ...\",\"Waiting for {{service}} to answer ...\",\"Still waiting on {{service}} (stick with us; can take a few minutes) ...\"],[\"Releasing the carrier pigeons ...\",\"Waiting for the pigeons to return ...\",\"Still waiting on the pigeons (stick with us; can take a few minutes) ...\"],[\"Commence thumb twiddling ...\",\"{{service}} is sure taking their time ...\",\"Still twiddling thumbs (stick with us; can take a few minutes) ...\"]],events:{\"mousedown li\":\"clickField\",\"mousemove li\":\"mousemove\",\"mousedown li.custom-value\":\"customValue\",\"mousedown li.placeholder-value\":\"placeholderValue\"},initialize:function(options){var i,_ref,_ref2,_ref3,_ref4,_this=this;this.options=options;_.bindAll(this);this.hideRawValue=(_ref=this.options)!=null?_ref.hideRawValue:void 0;this.target=(_ref2=this.options)!=null?_ref2.target:void 0;this.choices=this.getChoices((_ref3=this.options)!=null?_ref3.choices:void 0);this.current=(_ref4=this.options)!=null?_ref4.current:void 0;$(document).on(\"keydown\",this.keydown);i=_.random(0,this.STILL_LOADING.length-1);this.loadingMsg=this.STILL_LOADING[i];return this.on(\"remove\",function(){$(document).off(\"keydown\",_this.keydown);return z.useful.noBGScrollOff(_this.$el)})},getChoices:function(choices){var k,newChoices,v,_i,_len;newChoices=[];if(!_.isArray(choices)){for(k in choices){v=choices[k];newChoices.push({key:k,display:v,val:k})}}else if(_.isArray(choices)&&_.any(choices,function(i){return _.isString(i)})){for(_i=0,_len=choices.length;_i<_len;_i++){v=choices[_i];newChoices.push({key:v,display:v,val:null})}}else{newChoices=choices}this.setMode(\"show\",\"empty-value\");return _.filter(newChoices,function(choice){return Boolean(choice.key)})},parseGives:function(gives){var choices,_this=this;choices=gives!=null?gives.map(function(give){return{key:give.getKey(),display:give.getLabel(),val:give.getSample(),type:give.get(\"type\")}}):void 0;choices=choices!=null?choices.filter(function(choice){return!_.str.include(choice.key,\"zap_meta\")}):void 0;return _.filter(choices,function(choice){return Boolean(choice.key)})},context:function(){var context,_ref,_ref2,_ref3;context={choices:this.choices,fancychoices:(_ref=this.options.options)!=null?_ref.fancychoices:void 0,hideRawValue:this.hideRawValue};if(this.node!=null||((_ref2=this.options)!=null?_ref2.useGives:void 0)){context.loadingMsg=this.loadingMsg;context.service=(_ref3=z.app.services.get(this.node.get(\"selected_api\")))!=null?_ref3.getName():void 0}return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_selectfill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"min-width\",this.modal.targetWidth());return this},highlightDefault:function(){var $el,_this=this;this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").filter(function(i,el){return $(el).attr(\"data-key\")===_this.current});if(this.current!=null&&($el!=null?$el.length:void 0)>0){$el.addClass(\"hover\")}else{this.$(\"li:not(.hide)\").first().addClass(\"hover\")}if(this.current!=null&&($el!=null?$el.length:void 0)>0){return _.defer(function(){return _this.$el.scrollTo($el)})}},clickField:function(e){var $el,display,id,key,val,_ref;if(e!=null)e.preventDefault();$el=this.$(\"li.hover\").first();key=$el.attr(\"data-key\");display=$el.attr(\"data-display\");val=$el.attr(\"data-val\");id=$el.attr(\"data-id\");if(id===\"load-more\"||id===\"custom-value\"||id===\"placeholder-value\"){return}if((_ref=this.options)!=null){if(typeof _ref.pick===\"function\"){_ref.pick({key:key,display:display,val:val})}}return this.modal.close()},mousemove:function(e){this.$(\"li\").removeClass(\"hover\");return this.$(e.currentTarget).addClass(\"hover\")},keydown:function(e){if(e.keyCode===13)this.clickField(e);if(e.keyCode===38)this.moveUp(e);if(e.keyCode===40)this.moveDown(e);if(e.keyCode===9)return this.modal.close()},moveUp:function(e){var $el,h,idx;if(e!=null)e.preventDefault();idx=this.$(\"li.hover\").index();this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").eq(idx).prevAll(\"li:not(.hide)\").eq(0).addClass(\"hover\");if(this.$(\"li.hover\").length===0){$el=this.$(\"li:not(.hide)\").first().addClass(\"hover\")}h=$el.outerHeight();if(($el!=null?$el.length:void 0)>0&&this.highlightOutOfView()){return this.$el.scrollTo({left:\"=0px\",top:\"-=\"+h})}},moveDown:function(e){var $el,h,idx;if(e!=null)e.preventDefault();idx=this.$(\"li.hover\").index();this.$(\"li\").removeClass(\"hover\");\n$el=this.$(\"li\").eq(idx).nextAll(\"li:not(.hide)\").first().addClass(\"hover\");if(this.$(\"li.hover\").length===0){$el=this.$(\"li:not(.hide)\").last().addClass(\"hover\")}h=$el.outerHeight();if(($el!=null?$el.length:void 0)>0&&this.highlightOutOfView()){return this.$el.scrollTo({left:\"+=0px\",top:\"+=\"+h})}},highlightOutOfView:function(){var $el,frameHeight,frameScrollTop,outBottom,outTop,targetHeight,targetScrollTop;$el=this.$(\"li.hover\");if($el.length===0)return;frameScrollTop=this.$el.scrollTop();frameHeight=this.$el.innerHeight();targetScrollTop=$el.position().top;targetHeight=$el.innerHeight();outBottom=targetScrollTop+targetHeight>frameHeight;outTop=targetScrollTop<0;return outBottom||outTop},customValue:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();if((_ref=this.options)!=null){if((_ref2=_ref.options)!=null){if(typeof _ref2.custom===\"function\")_ref2.custom()}}return this.modal.close()},placeholderValue:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();if((_ref=this.options)!=null){if((_ref2=_ref.options)!=null){if(typeof _ref2.placeholder===\"function\")_ref2.placeholder()}}return this.modal.close()}});z.ui.PrefillModal=z.ui.SelectfillModal.extend({className:\"prefill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"keyup input.searcher\":\"search\",\"mousedown li.load-more\":\"loadMore\"})},initialize:function(options){var _ref;this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=this.options.node;this.formRow=this.options.formRow;this.prefill=this.options.prefill;this.samples=options.samples;this.fixedChoices=z.ui.SelectfillModal.prototype.getChoices.apply(this,[(_ref=this.options)!=null?_ref.fixedChoices:void 0]);this.lastSamplesLength=0;if(this.samples.allLoaded)this.setMode(\"hide\",\"load-more\");return this.state.on(\"change:choices\",this.render,this)},getChoices:function(choices){var k,newChoices,v;newChoices=[];for(k in choices){v=choices[k];newChoices.push({key:k,display:v,val:k})}return _.filter(newChoices,function(choice){return Boolean(choice.key)})},context:function(){var choices,context,_ref;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);choices=((_ref=this.fixedChoices)!=null?_ref.length:void 0)>0?this.fixedChoices.concat(this.choices):this.choices;context=_.extend(context,{choices:choices,search:this.searchString,trigger:this.node.isRead()});return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_prefill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"width\",this.modal.targetWidth());return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_ref,_ref2,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);options={success:function(map){var _ref,_ref2;_this.choices=_this.getChoices(map);clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");if(_this.samples.length<=_this.lastSamplesLength){_this.setMode(\"hide\",\"load-more\");_this.samples.allLoaded=true}_this.lastSamplesLength=_this.samples.length;return(_ref=_this.options.options)!=null?(_ref2=_ref.success)!=null?_ref2.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2;_this.error=z.useful.errors(xhr);clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");_this.setMode(\"hide\",\"load-more\");return(_ref=_this.options.options)!=null?(_ref2=_ref.error)!=null?_ref2.apply(_this,arguments):void 0:void 0}};if(!(((_ref=this.formRow)!=null?_ref.collection:void 0)!=null)){return(_ref2=this.modal)!=null?_ref2.close():void 0}return this.samples.prefillMap(this.prefill,this.formRow.collection.getValues(),options)},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)},loadMore:function(e){if(e!=null)e.preventDefault();this.samples.setPage(this.samples.getPage()+1);return this.loadChoices()}});z.ui.UserfillModal=z.ui.SelectfillModal.extend({className:\"userfill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"click button.missing\":\"clickMissing\",\"keyup input.searcher\":\"search\"})},initialize:function(options){this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=this.options.node;this.missing=false;return this.state.on(\"change:choices\",this.render,this)},context:function(){var context;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);context=_.extend(context,{choices:this.choices,missing:this.missing,search:this.searchString});return context},render:function(){var context,_ref;context=this.context();this.$el.html(JST.editor_userfill_modal(context));z.useful.noBGScroll(this.$el);if((_ref=this.options.options)!=null?_ref.flexWidth:void 0){this.$el.css(\"width\",this.modal.targetWidth())}return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);this.gives=new z.model.FieldSet([],{node:this.node});options={data:{zap_meta_limit:3,zap_meta_hydrate:true},success:function(model,json,resp){var _ref,_ref2,_ref3,_ref4,_ref5;_this.setMode(\"hide\",\"empty-value\");_this.choices=_this.parseGives(model);if(_this.choices.length===0){_this.modal.close();return(_ref=_this.options.options)!=null?(_ref2=_ref.missing)!=null?_ref2.apply(_this,arguments):void 0:void 0}_this.missing=(resp!=null?(_ref3=resp.xhr)!=null?_ref3.status:void 0:void 0)===206;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");return(_ref4=_this.options.options)!=null?(_ref5=_ref4.success)!=null?_ref5.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");_this.modal.close();return(_ref=_this.options.options)!=null?(_ref2=_ref.error)!=null?_ref2.apply(_this,arguments):void 0:void 0}};return this.gives.fetch(options)},clickMissing:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.options)!=null?(_ref2=_ref.missing)!=null?_ref2.apply(this,arguments):void 0:void 0},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)}});z.ui.GivefillModal=z.ui.SelectfillModal.extend({className:\"givefill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"keyup input.searcher\":\"search\"})},initialize:function(options){var _ref;this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=(_ref=this.options)!=null?_ref.node:void 0;return this.state.on(\"change:choices\",this.render,this)},context:function(){var context;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);context=_.extend(context,{search:this.searchString});return context},render:function(){var context,_ref;context=this.context();this.$el.html(JST.editor_givefill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"width\",(_ref=$(this.options.target))!=null?_ref.outerWidth():void 0);return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);this.gives=new z.model.FieldSet([],{node:this.node});options={data:{zap_meta_limit:3,zap_meta_hydrate:true},success:function(model,json,resp){var _ref,_ref2,_ref3,_ref4,_ref5;_this.choices=_this.parseGives(model);if(_this.choices.length===0){if((_ref=_this.modal)!=null)_ref.close();return(_ref2=_this.options.options)!=null?(_ref3=_ref2.missing)!=null?_ref3.apply(_this,arguments):void 0:void 0}clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");return(_ref4=_this.options.options)!=null?(_ref5=_ref4.success)!=null?_ref5.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2,_ref3;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");if((_ref=_this.modal)!=null)_ref.close();return(_ref2=_this.options.options)!=null?(_ref3=_ref2.error)!=null?_ref3.apply(_this,arguments):void 0:void 0}};return this.gives.fetch(options)},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)}});z.ui.MissingDataModal=z.ui.Base.extend({className:\"missing-data\",events:{\"click .active>button\":\"buttonClick\",\"click .webhook-url\":\"highlight\"},initialize:function(options){var action,read,readService,service,_this=this;this.options=options;_.bindAll(this);this.samples=new z.model.SampleSet([],{node:z.app.read});service=z.app.services.get(z.app.read.get(\"selected_api\"));action=z.app.read.get(\"action\");this.isHook=service!=null?service.isHook(action,\"read\"):void 0;this.notSubHook=!(service!=null?service.isSubHook(action,\"read\"):void 0);this.step=this.isHook?1:2;read=z.app.read.toJSON();readService=z.app.services.get(z.app.read.get(\"selected_api\"));if(readService.isSubHook(read.action,\"read\")){this.initHook();return this.on(\"remove\",function(){return z.app.read.tearDownHook()})}},initHook:function(){var success,_this=this;this.initConnection=true;success=function(){_this.initConnection=false;return _this.render()};return z.app.read.subscribeHook({success:function(model,resp){return success()},error:function(model,xhr){var context,html;if((xhr!=null?xhr.status:void 0)===409)return success();_this.initConnection=false;_this.close();context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_hook_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},context:function(){var action,context,read,service;read=z.app.read.toJSON();service=z.app.services.get(z.app.read.get(\"selected_api\"));action=z.app.read.get(\"action\");context={read:read,readModel:z.app.read,service:service,step:this.step,initConnection:this.initConnection,filters:this.getFilterTable(),action:action,isHook:this.isHook,notSubHook:this.notSubHook};return context},renderClipboard:function(){var $el,clip,_this=this;$el=this.$(\".copy-button\");if($el){clip=new z.useful.clipboard($el);clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)});return this.modal.on(\"reposition\",function(){return clip.reposition()})}},render:function(){this.$el.html(JST.editor_missing_data_modal(this.context()));this.renderClipboard();return this},getFilterTable:function(){var _this=this;return _.compact(z.app.readNeeds.map(function(i){var f,k,v;if(i.isListParent())return false;k=i.getLabel();v=i.getDisplay();f=i.get(\"input_format\");if(f!=null){if((f!=null?f[0]:void 0)!=null)v=f[0]+v;if((f!=null?f[2]:void 0)!=null)v=v+f[2];v=_.template(v)({cid:z.app.account.id,ccode:z.app.account.get(\"code\")})}if(v!=null){return{k:k,v:v}}return false}))},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},buttonClick:function(e){var step;if(e!=null)e.preventDefault();step=this.$(e.currentTarget).attr(\"data-step\");if(step===\"1\")this.nextStep(e);if(this.isHook){if(step===\"2\"){this.nextStep(e);this.waitForData(e)}if(step===\"4\")return this.done(e)}else{if(step===\"2\")this.nextStep(e);if(step===\"3\")this.loadData(e);if(step===\"4\")return this.done(e)}},nextStep:function(e){this.step+=1;return this.render()},waitForData:function(e){var _this=this;this.sampleInterval=setInterval(function(){return _this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},z.app.read.getParams()),success:function(model,json,resp){if(model.length>0){_this.setMode(\"hide\",\"loading-samples\");_this.setMode(\"show\",\"found-samples\");clearInterval(_this.sampleInterval);return _this.nextStep()}},error:function(model,xhr){var context,html;clearInterval(_this.sampleInterval);context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},5e3);return this.on(\"remove\",function(){return clearInterval(_this.sampleInterval)})},loadData:function(e){var _this=this;if(this.$(e.currentTarget).hasClass(\"disabled\"))return;this.$(e.currentTarget).text(\"Loading...\").addClass(\"disabled\");this.setMode(\"hide\",\"no-samples\");return this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},z.app.read.getParams()),success:function(model,json,resp){if(model.length>0){return _this.nextStep()}else{_this.setMode(\"show\",\"no-samples\");return _this.render()}},error:function(model,xhr){var context,html;context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},done:function(e){var _ref;if((_ref=this.options)!=null){if(typeof _ref.success===\"function\")_ref.success()}return this.close()},close:function(){return this.modal.close()}});z.ui.CustomFilterRow=z.ui.Base.extend({className:\"advanced-filter\",events:{\"click .remove\":\"destroy\",\"change .field-value input\":\"updateModel\"},initialize:function(options){var fields,_this=this;_.bindAll(this);_.defaults(this,options);this.model=options.rule;this.model.on(\"destroy\",function(){return _this.remove()},this);this.model.on(\"change\",this.render,this);this.matchChoices={iexact:\"(Text) Exactly matches\",\"not-iexact\":\"(Text) Does not exactly match\",icontains:\"(Text) Contains\",\"not-icontains\":\"(Text) Does not contain\",istartswith:\"(Text) Starts with\",\"not-istartswith\":\"(Text) Does not start with\",iendswith:\"(Text) Ends with\",\"not-iendswith\":\"(Text) Does not end with\",igreater:\"(Number) Greater than\",iless:\"(Number) Less than\",idategreater:\"(Date/time) Greater than\",idateless:\"(Date/time) Less than\",idateequal:\"(Date/time) Equals\",iexist:\"Exists\",\"not-iexist\":\"Does not exist\"};fields=[{key:\"key\",type:\"select\",hideLabel:true,givefill:{node:z.app.read},value:this.model.get(\"key\")!=null?this.model.get(\"key\"):void 0,placeholder:\"Key\"},{key:\"match\",hideLabel:true,type:\"select\",hideRawValue:true,choices:this.matchChoices,placeholder:\"Matches\"},{key:\"value\",type:\"unicode\",hideLabel:true,required:false,value:this.model.get(\"value\")!=null?this.model.get(\"value\"):void 0,placeholder:\"Value\"}];this.form=new z.model.FormSet(fields);this.paramform=new z.ui.ParamForm({form:this.form});return _.each(this.form.models,function(row){if(row.options.type===\"select\"){return row.on(\"change\",_this.updateModel,_this)}})},context:function(){var context;context={group:this.model.get(\"group\"),index:this.index};return context},render:function(){var match;this.$el.html(JST.editor_custom_filter_row(this.context()));this.$(\"paramform\").replaceWith(this.paramform.render().el);match=this.model.get(\"match\");if(match===\"iexist\"){this.setMode(\"hide\",\"field-value\")}else{this.setMode(\"show\",\"field-value\")}if(this.model.get(\"action\")===\"stop\")match=\"not-\"+match;this.$(\".field-match input\").val(this.matchChoices[match]);return this},destroy:function(){return this.model.destroy()},updateModel:function(){var action,check,data,fields,key,match,value;key=this.$(\".field-key input\").val();match=_.invert(this.matchChoices)[this.$(\".field-match input\").val()];value=this.$(\".field-value input\").val();action=\"continue\";if(_.str.startsWith(match,\"not-\")){match=match.replace(\"not-\",\"\");action=\"stop\"}data={key:key,match:match,value:value,action:action};this.model.set(data);fields=[key,match,action];check=_.all(fields,function(field){if(field!=null&&field!==\"\")return true});if(check)this.model.save();if(match===\"iexist\"){return this.setMode(\"hide\",\"field-value\")}else{return this.setMode(\"show\",\"field-value\")}}});z.ui.TestStep=z.ui.Base.extend({className:\"test-zap\",events:{\"click .skip a\":\"skip\",\"click .load\":\"load\",\"click .webhook-url\":\"highlightWebhook\",\"click [data-sample-read-id]\":\"openReadData\",\"click [data-sample-write-id]\":\"openWriteData\",\"click .continue\":\"continue\",\"click [data-send-sample-id]\":\"send\",\"click .custom-filters\":\"scrollToFilters\"},initialize:function(options){var render,stale;this.options=options;_.bindAll(this);this.read=this.options.read;this.write=this.options.write;this.writeNeeds=this.options.writeNeeds;this.readNeeds=this.options.readNeeds;this.rules=this.options.rules;render=_.debounce(this.render,40);stale=_.debounce(this.stale,40);this.read.on(\"change:selected_api change:authentication_id change:action\",render,this);this.read.on(\"change:selected_api change:authentication_id change:action\",stale,this);this.rules.on(\"change add remove\",stale,this);this.readNeeds.on(\"change\",render,this);this.writeNeeds.on(\"change\",render,this);this.samples=new z.model.SampleSet([],{node:z.app.read});this.samples.on(\"reset\",render,this);return this.setMode(\"no\",\"samples\")},context:function(){var authValid,context,readService,show,writeService,_ref,_this=this;readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));authValid=this.read.get(\"authentication_id\")!=null||!(readService!=null?readService.needsAuth():void 0);show=this.readNeeds.isValid()&&authValid&&this.writeNeeds.isValid();if((_ref=this.samples)!=null){_ref.each(function(sample,i){var action,noun;noun=_this.read.getActionNoun();sample.num=i+1;sample.readSummary=sample.summary(sample.toJSON(),{\"default\":\"Sample \"+noun});action=_this.write.getActionLabel();return sample.writeSummary=sample.summary(sample.buildWrite(_this.write.get(\"params\")),{\"default\":action})})}context={flow:this.options.flow,show:show,readService:readService,writeService:writeService,readNoun:this.read.getActionNoun(),samples:this.samples,filters:_.compact(this.readNeeds.map(function(i){var k,v;if(i.isListParent())return false;k=i.getLabel();v=i.getDisplay();if(v!=null){return{k:k,v:v}}return false}))};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_test(context));return this},skip:function(e){if(e!=null)e.preventDefault();this.setMode(\"hide\",\"skip\");return z.app.editor.next(this)},stale:function(){this.samples.reset();return this.setMode(\"no\",\"samples\")},load:function(e,cache){var loadFields,loadSamples,_this=this;if(cache==null)cache=false;if(e!=null)e.preventDefault();if(this.hasMode(\"loading\",\"samples\"))return;this.$(\".load\").text(\"Loading...\");this.loadingTimer=_.delay(function(){return _this.$(\".load\").text(\"Still Loading...\")},3e3);this.setMode(\"loading\",\"samples\");loadSamples=function(cb){return _this.samples.fetch({cache:cache,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:3},_this.read.getParams()),success:function(model,json,resp){if(model.length>0){return typeof cb===\"function\"?cb():void 0}else{clearInterval(_this.loadingTimer);_this.setMode(\"no\",\"samples\");return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal({success:function(){return _this.load.apply(_this,[e,false])}})})}},error:function(model,xhr){var context,html,modal;_this.setMode(\"no\",\"samples\");clearInterval(_this.loadingTimer);context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})};loadFields=function(cb){_this.fields=new z.model.FieldSet([],{node:z.app.read});return _this.fields.fetch({cache:cache,data:{zap_meta_combine:false},success:function(model,json,resp){return cb()},error:function(model,xhr){var context,html,modal;_this.setMode(\"no\",\"samples\");clearInterval(_this.loadingTimer);context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})};return async.series([loadSamples,loadFields],function(err,results){clearInterval(_this.loadingTimer);_this.setMode(\"loaded\",\"samples\");return _this.render()})},highlightWebhook:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},openReadData:function(e){var customs,data,modal,pos;if(e!=null)e.preventDefault();pos=this.$(e.currentTarget).attr(\"data-sample-read-id\");customs=this.fields.toJSON();data={};_.each(this.samples.at(pos).buildRead(),function(v,k){return data[customs[k]||_.superHumanize(k)]=v});if(data.zap_meta_filter!=null)delete data.zap_meta_filter;return modal=new z.ui.Modal({view:new z.ui.DataTableModal({data:data})})},openWriteData:function(e){var customs,data,modal,pos,rendered;if(e!=null)e.preventDefault();pos=this.$(e.currentTarget).attr(\"data-sample-write-id\");data={};customs=this.fields.toJSON();rendered=this.samples.at(pos).buildWrite(this.write.get(\"params\"));_.each(rendered,function(v,k){return data[customs[k]||_.superHumanize(k)]=v});return modal=new z.ui.Modal({view:new z.ui.DataTableModal({data:data})})},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},send:function(e){var $el,data,options,pos,raw,replaced,sample,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.hasClass(\"working\"))return;pos=$el.attr(\"data-send-sample-id\");sample=this.samples.at(pos);replaced=this.samples.at(pos).buildWrite(this.write.get(\"params\"),{sanitize:false});raw=sample.toJSON();data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");$el.addClass(\"working\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");return $el.removeClass(\"working\")},error:function(model,xhr){var context,html,modal,service,_ref;clearInterval(_this.loadingTimer);service=(_ref=z.app.services.get(_this.write.get(\"selected_api\")))!=null?_ref.getName():void 0;$el.text(\"Send!\");$el.removeClass(\"working\");context={key:_this.write.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};return this.write.write(this.write.get(\"action\"),data,options)},scrollToFilters:function(e){var options;if(e!=null)e.preventDefault();options={offset:{left:0,top:-25}};return $.scrollTo('a[id=\"custom-filters\"]',200,options)}});z.ui.AuthStep=z.ui.Base.extend({className:\"auths\",events:{\"click li.auth\":\"select\",\"click .test\":\"test\",\"click .add\":\"add\",\"click .continue\":\"continue\",\"click .webhook-url\":\"highlight\"},initialize:function(options){var render,renderTest,_this=this;this.options=options;_.bindAll(this);this.model=this.options.isTrigger?this.options.read:this.options.write;render=_.debounce(this.render,40);renderTest=_.debounce(this.renderTest,40);this.setMode(\"disable\",\"continue\");this.model.on(\"change:selected_api\",render,this);this.model.on(\"change:action\",render,this);this.state.on(\"change\",renderTest,this);this.model.on(\"change:authentication_id\",function(){render();return renderTest()},this);z.app.auths.on(\"remove\",function(model){if(model.id===_this.model.get(\"authentication_id\")){return _this.model.save({authentication_id:null},{wait:true})}},this);z.app.auths.on(\"add remove\",render,this);z.app.auths.on(\"change:title\",render,this);return this.on(\"remove\",function(){return _this.$(\"select.auths\").off(\"change\",_this.selectChange)})},get:function(){return this.model.get(\"authentication_id\")},set:function(id){return this.model.save({authentication_id:Number(id)},{wait:true})},unset:function(){return this.model.save({authentication_id:null},{wait:true})},show:function(){return this.checkAutoSelect()},checkAutoSelect:function(){var auths,_ref;auths=z.app.auths.getByKey(this.model.get(\"selected_api\"));if(((_ref=this.options)!=null?_ref.flow:void 0)&&(auths!=null?auths.length:void 0)===1){return this.set(auths[0].id)}},context:function(){var accountSatisfied,action,auths,context,isHook,key,service,which;key=this.model.get(\"selected_api\");service=z.app.services.get(key);action=this.model.get(\"action\");which=this.options.isTrigger?\"read\":\"write\";isHook=(service!=null?service.isHook(action,which):void 0)&&!(service!=null?service.isSubHook(action,which):void 0);accountSatisfied=(service!=null?service.needsAuth():void 0)&&this.get()!=null||!(service!=null?service.needsAuth():void 0);auths=z.app.auths.where({selected_api:this.model.get(\"selected_api\")});context={flow:this.options.flow,key:key,selected:this.get(),testStatus:this.state.get(this.get()),needsAuth:service!=null?service.needsAuth():void 0,isHook:isHook,showContinue:this.options.flow,auths:auths,hasAtLeastOneAuth:z.app.auths.hasAtLeastOneAuth(key),show:this.model.get(\"action\")!=null,service:service,action:action,which:which,model:this.model};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_auth(context));this.renderContinue();this.renderTest();this.initSelect(context);this.renderClipboard();return this},renderClipboard:function(){var $el,action,clip,isHook,key,service,which;key=this.model.get(\"selected_api\");service=z.app.services.get(key);action=this.model.get(\"action\");which=this.options.isTrigger?\"read\":\"write\";isHook=(service!=null?service.isHook(action,which):void 0)&&!(service!=null?service.isSubHook(action,which):void 0);if(isHook){$el=this.$(\".copy-button\");clip=new z.useful.clipboard($el);return clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)})}},initSelect:function(context){this.$(\"select.auths\").select2({containerCssClass:\"select2-editor-auth larger\",dropdownCssClass:\"select2-editor-auth\",formatResult:_.bind(this.formatResult,this,context.service),formatSelection:_.bind(this.formatSelection,this,context.service),escapeMarkup:function(s){return s},matcher:this.matcher});this.$(\"select.auths\").off(\"change\",this.selectChange);return this.$(\"select.auths\").on(\"change\",this.selectChange)},selectChange:function(e){if(e.val===\"new\"){this.$(\"select.auths\").select2(\"val\",this.get());return this.add(e)}else{return this.set(e.val)}},formatResult:function(service,row){return this.formatSelection.apply(this,arguments)},formatSelection:function(service,row){var html,icon,img,text;if(!row.id)return row.text;icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;if(row.id===\"new\"){img=\"fa fa-plus\"}else{img=\"img32 \"+icon}text=_.escape(row.text);html='<i class=\"'+img+'\"></i> <t>'+text+\"</t>\";return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},select:function(e){var id;if(e!=null)e.preventDefault();id=this.$(e.currentTarget).attr(\"id\");if(String(this.get())!==String(id)){return this.set(id)}else{return this.unset()}},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},test:function(e){var auth,error,id,success,_this=this;if(e!=null)e.preventDefault();id=this.get();auth=z.app.auths.get(id);if(this.state.get(id)===\"testing\"||this.state.get(id)===\"slow\")return;this.state.set(id,\"testing\");success=function(){return _this.state.set(id,\"success\")};error=function(model,xhr){var context,errors,modal;errors=z.useful.errors(xhr);_this.state.set(id,\"error\");context={auth:auth,message:errors,type:\"manual\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context)})};z.app.auths.get(id).test({success:success,error:error});return _.delay(function(){if(_this.state.get(id)===\"testing\")return _this.state.set(id,\"slow\")},3e3)},add:function(e){var context,key,modal,service,success,_this=this;if(e!=null)e.preventDefault();key=this.model.get(\"selected_api\");service=z.app.services.get(key);z.app.auths.on(\"add\",function(model){return _this.set(model.id)},this);success=function(auth){_this.state.set(auth.id,\"success\");return z.app.auths.off(\"add\",null,_this)};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},renderContinue:function(){var mode,needsAuth,service;service=z.app.services.get(this.model.get(\"selected_api\"));needsAuth=service!=null?service.needsAuth():true;mode=this.get()!=null||!needsAuth?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},renderTest:function(){var $el,status;status=this.state.get(this.get());$el=this.$(\"button.test\");if(status===\"success\"){$el.removeClass(\"success error\").addClass(\"success\");return $el.replaceWith('<span class=\"success\"><i class=\"fa fa-ok\"></i> Account is working.</span>')}else if(status===\"error\"){$el.removeClass(\"success error\").addClass(\"error\");return $el.text(\"Account not working\")}else if(status===\"testing\"){$el.removeClass(\"success error\");return $el.text(\"Testing...\")}else if(status===\"slow\"){$el.removeClass(\"success error\");return $el.text(\"Still testing...\")}else{$el.text(\"Test this Account\");return $el.removeClass(\"success error\")}}});z.ui.FilterStep=z.ui.Base.extend({className:\"filters\",events:{\"click button.continue\":\"continue\",\"click button.retry-fields\":\"loadNeeds\",\"click button.or\":\"or\",\"click .custom .add\":\"add\",\"click .show-custom .add\":\"add\"},initialize:function(options){var render,renderContinue,updateModel,updateNeeds,_this=this;this.options=options;_.bindAll(this);this.model=this.options.read;this.readNeeds=this.options.readNeeds;this.rules=this.options.rules;this.setMode(\"disable\",\"continue\");render=_.debounce(this.render,40);renderContinue=_.debounce(this.renderContinue,40);updateModel=_.debounce(this.updateModel,40);updateNeeds=_.debounce(this.updateNeeds,40);\nthis.state.on(\"change:fields\",render,this);this.model.on(\"change:selected_api change:action change:authentication_id\",render,this);this.views=[];this.rules.on(\"add remove reset\",render,this);this.rules.on(\"change\",this.stripAnd,this);this.rules.on(\"change remove\",this.updateRules,this);this.on(\"remove\",function(){_.each(_this.views,function(view){return view.remove()});return _this.views=[]});this.renderGroups();this.paramform=new z.ui.ParamForm({form:this.readNeeds,prettypills:true,fancychoices:true});this.model.on(\"change:action change:authentication_id\",updateNeeds,this);this.readNeeds.on(\"change:value\",renderContinue,this);return this.loadNeedsAndRender()},updateNeeds:function(){var _this=this;return this.loadNeeds({success:function(){return _this.readNeeds.initData({success:function(){return _.defer(function(){return _this.renderForm()})}})}})},loadNeedsAndRender:function(){var _this=this;return this.loadNeeds({success:function(){return _.defer(function(){return _this.renderForm()})}})},loadNeeds:function(options){var _this=this;this.setMode(\"loading\",\"fields\");return this.readNeeds.fetch({cache:false,success:function(model,json,resp){var _ref;_this.setMode(\"loaded\",\"fields\");if((json!=null?json.length:void 0)===0){_this.setMode(\"zero\",\"fields\")}return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref;_this.setMode(\"error\",\"fields\");return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}})},context:function(){var authValid,context,service,show;service=z.app.services.get(this.model.get(\"selected_api\"));authValid=this.model.get(\"authentication_id\")!=null||!(service!=null?service.needsAuth():void 0);show=service!=null&&this.model.get(\"action\")!=null&&authValid;context={state:this.state.toJSON(),flow:this.options.flow,show:show,form:this.readNeeds,read:this.model.toJSON(),service:service};context=_.extend(context,{rules:this.rules});return context},render:function(){var context,groupIds,index,_this=this;context=this.context();this.detachForm();this.$el.html(JST.editor_filter(context));this.attachForm();this.renderContinue();this.$groups=this.$(\".groups\");groupIds=this.rules.getGroups();index=1;_.each(groupIds,function(id,i){var $el,$or,rules;$el=$('<div class=\"group\"></div>').attr(\"data-group\",id);$el.appendTo(_this.$groups);if(i>0){$or=$('<div class=\"or\"></div>').text(\"OR\");$or.insertBefore($el)}rules=_this.rules.where({group:id});return _.each(rules,function(rule){var view;view=new z.ui.CustomFilterRow({rule:rule,samples:_this.samples,index:index});view.render().$el.appendTo($el);_this.views.push(view);return index+=1})});this.stripAnd();this.renderGroups();return this},show:function(){var _ref;return(_ref=this.paramform)!=null?_ref.refreshPrettypills():void 0},detachForm:function(){return this.paramform.$el.detach()},attachForm:function(){return this.$(\"paramform\").replaceWith(this.paramform.$el)},renderForm:function(){return this.paramform.render()},renderContinue:function(){var mode;mode=this.readNeeds.isValid()?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},renderGroups:function(){if(this.rules.length>0){this.setMode(\"show\",\"custom\");return this.setMode(\"hide\",\"custom-toggle\")}else{this.setMode(\"hide\",\"custom\");return this.setMode(\"show\",\"custom-toggle\")}},destroyRules:function(){var _this=this;return this.rules.each(function(rule){return rule.destroy()})},stripAnd:function(){return this.$(\".group\").each(function(){return $(this).find(\".and\").last().text(\"\")})},updateRules:function(){var ids;ids=_.compact(this.rules.pluck(\"id\"));return this.options.read.set({rule_ids:ids},{silent:true})},add:function(e){var id,rule;if(e!=null)e.preventDefault();id=this.$(e.currentTarget).attr(\"data-group\");if(!(id!=null))id=this.rules.getMaxGroup();rule=new z.model.Rule({group:Number(id)});rule.setRead(this.options.read);return this.rules.add(rule)},or:function(e){var id,rule;if(e!=null)e.preventDefault();id=this.rules.getMaxGroup()+1;rule=new z.model.Rule({group:Number(id)});rule.setRead(this.options.read);return this.rules.add(rule)}});z.ui.MapStep=z.ui.Base.extend({className:\"map\",events:{\"click button\":\"continue\",\"click button.retry-fields\":\"loadNeeds\",\"click .enable-live-preview\":\"enableLivePreview\"},initialize:function(options){var insertPreviewContainer,loadNeedsAndRender,render,renderContinue,renderPreview,updateModel,updateNeeds,_this=this;this.options=options;_.bindAll(this);this.model=this.options.write;this.read=this.options.read;this.readNeeds=this.options.readNeeds;this.writeNeeds=this.options.writeNeeds;this.setMode(\"disable\",\"continue\");render=_.debounce(this.render,40);renderContinue=_.debounce(this.renderContinue,40);updateModel=_.debounce(this.updateModel,40);loadNeedsAndRender=_.debounce(this.loadNeedsAndRender,40);updateNeeds=_.debounce(this.updateNeeds,40);renderPreview=_.debounce(this.renderPreview,40);insertPreviewContainer=_.debounce(this.insertPreviewContainer,40);this.read.on(\"change:selected_api change:action change:authentication_id\",render,this);this.model.on(\"change:selected_api change:action change:authentication_id\",render,this);this.samples=new z.model.SampleSet([],{node:z.app.read});this.writeNeeds.on(\"change:value\",function(){return renderPreview()},this);this.writeNeeds.on(\"add\",function(){insertPreviewContainer();return renderPreview()},this);this.samples.on(\"reset\",renderPreview,this);this.read.on(\"change:selected_api change:action change:authentication_id\",function(){return _this.samples.reset()},this);this.read.on(\"change:selected_api\",function(){return _this.renderForm()},this);this.paramform=new z.ui.ParamForm({form:this.writeNeeds,prettypills:true,fancychoices:true,userfill:{\"class\":this.userfillClass,node:this.read}});this.model.on(\"change:action change:authentication_id\",updateNeeds,this);this.readNeeds.on(\"change:value\",render,this);this.writeNeeds.on(\"change:value\",renderContinue,this);this.writeNeeds.on(\"prefill\",updateNeeds,this);this.writeNeeds.on(\"change:value\",renderContinue,this);loadNeedsAndRender();return this.on(\"remove\",function(){var _ref;return(_ref=_this.paramform)!=null?_ref.remove():void 0},this)},updateNeeds:function(){var _this=this;return this.loadNeeds({success:function(){return _this.writeNeeds.initData({success:function(){return _.defer(function(){return _this.renderForm()})}})}})},loadNeedsAndRender:function(){var _this=this;return this.loadNeeds({success:function(){return _.defer(function(){return _this.renderForm()})}})},loadNeeds:function(options){var _this=this;this.setMode(\"loading\",\"fields\");return this.writeNeeds.fetch({cache:false,success:function(model,json,resp){var _ref,_ref2;_this.setMode(\"loaded\",\"fields\");if((resp!=null?(_ref=resp.xhr)!=null?_ref.status:void 0:void 0)===206){_this.setMode(\"error\",\"fields\")}if((json!=null?json.length:void 0)===0){_this.setMode(\"zero\",\"fields\")}return options!=null?(_ref2=options.success)!=null?_ref2.apply(_this,arguments):void 0:void 0},error:function(){var _ref;_this.setMode(\"error\",\"fields\");return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}})},context:function(){var authValid,context,readAction,readNeedsValid,readService,show,writeAction,writeService;readService=z.app.services.get(this.read.get(\"selected_api\"));readAction=readService!=null?readService.getActionName(this.read.get(\"action\"),\"read\",\"true\"):void 0;writeService=z.app.services.get(this.model.get(\"selected_api\"));writeAction=writeService!=null?writeService.getActionName(this.model.get(\"action\"),\"write\",\"true\"):void 0;readNeedsValid=this.readNeeds.isValid();authValid=this.model.get(\"authentication_id\")!=null||!(writeService!=null?writeService.needsAuth():void 0);show=readService!=null&&readAction!=null&&writeService!=null&&writeAction!=null&&readNeedsValid&&authValid;context={state:this.state.toJSON(),flow:this.options.flow,show:show,form:this.writeNeeds,service:writeService,write:this.model.toJSON(),readService:readService,readAction:readAction,writeService:writeService,writeAction:writeAction};return context},render:function(){var context;context=this.context();this.detachForm();this.$el.html(JST.editor_map(context));this.attachForm();this.renderContinue();return this},show:function(){var _ref;return(_ref=this.paramform)!=null?_ref.refreshPrettypills():void 0},detachForm:function(){return this.paramform.$el.detach()},attachForm:function(){return this.$(\"paramform\").replaceWith(this.paramform.$el)},renderForm:function(){this.paramform.render();this.insertPreviewContainer();return this.renderPreview()},userfillClass:function(){var readService;readService=z.app.services.get(this.read.get(\"selected_api\"));return readService.getImageClass(\"16x16\")},renderContinue:function(){var mode;mode=this.writeNeeds.isValid()&&this.hasMode(\"loaded\",\"fields\")?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},insertPreviewContainer:function(){var _this=this;return this.paramform.$el.find(\".input\").each(function(i,el){var _ref;if(((_ref=$(el).parent().find(\".live-preview\"))!=null?_ref.length:void 0)===0){return $(el).parent().append($('<div class=\"live-preview hide\"></div>'))}})},renderPreview:function(){var sample,_this=this;sample=false;if(this.samples.length>0)sample=this.samples.at(0);return this.writeNeeds.each(function(field){var $el,key,map,value;key=field.get(\"key\");$el=_this.paramform.$el.find(\".field-\"+_.slugify(key)+\" .live-preview\");if(field.get(\"prefill\")!=null){}else if(field.get(\"input_format\")!=null){return $el.remove()}else if(!sample&&!(field.get(\"prefill\")!=null)){$el.html('<a class=\"enable-live-preview\">Preview this field with sample data.</a>');return $el.removeClass(\"hide\")}else if(field.getValue()!=null&&field.getValue()!==\"\"){map=sample.buildWrite({sample:field.getValue()},{sanitize:true});value=map.sample;$el.html($(\"<div/>\").text(value).html().split(\" \").join(\"&nbsp;\").split(\"\\n\").join(\"<br>\"));return $el.removeClass(\"hide\")}else{$el.html(\"<em>Add text and/or placeholders to the field above to preview.</em>\");return $el.removeClass(\"hide\")}})},enableLivePreview:function(e){var showMissing,_ref,_this=this;e.preventDefault();if(this.$(e.currentTarget).hasClass(\"disabled\"))return;if((_ref=this.samples)!=null?_ref.length:void 0){return this.renderContinue()}showMissing=function(){var _ref2;_this.$(e.currentTarget).text(\"Preview this field with sample data.\").removeClass(\"disabled\");if(!((_ref2=_this.samples)!=null?_ref2.length:void 0)){return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal({success:function(){return _this.renderContinue()}})})}};this.$(e.currentTarget).text(\"loading sample data to preview...\").addClass(\"disabled\");return this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},this.read.getParams()),success:function(model,json,resp){if(model.length>0){}else{return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal})}},error:function(model,xhr){var context,html,modal;context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})}});z.ui.ServiceActionStep=z.ui.Base.extend({className:\"step services-actions\",events:{\"change #trigger-service\":\"changeService\",\"change #action-service\":\"changeService\",\"change #trigger\":\"changeAction\",\"change #action\":\"changeAction\",\"click button\":\"continue\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.setMode(\"disable\",\"continue\");this.setMode(\"hide\",\"triggers\");this.setMode(\"hide\",\"actions\");z.app.read.on(\"change:selected_api change:action\",this.render,this);z.app.write.on(\"change:selected_api change:action\",this.render,this);this.buildServiceMatchIndex();this.state.on(\"change:saving\",this.renderLocks,this);this.state.set({showTriggerAll:false,showActionAll:false});$(document).on(\"mouseenter\",\".right li.select2-result-selectable\",this.showActionCard);$(document).on(\"mouseenter\",\".left li.select2-result-selectable\",this.showTriggerCard);$(document).on(\"mouseleave\",\"li.select2-result-selectable\",this.hideCards);$(document).on(\"keypress\",\".select2-editor-service input.select2-input\",this.hideCards);return this.on(\"remove\",function(){$(document).off(\"mouseenter\",\".right li.select2-result-selectable\",_this.showActionCard);$(document).off(\"mouseenter\",\".left li.select2-result-selectable\",_this.showTriggerCard);$(document).off(\"mouseleave\",\"li.select2-result-selectable\",_this.hideCards);return $(document).off(\"keypress\",\".select2-editor-service input.select2-input\",_this.hideCards)})},context:function(){var context,readAction,readActions,showActionExpand,showTriggerExpand,writeAction,writeActions,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;this.readServices=z.app.services.filter(function(service){var _ref;if(z.app.read.get(\"selected_api\")===service.get(\"key\"))return true;if(!service.hasReads())return false;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.writeServices=z.app.services.filter(function(service){var _ref;if(z.app.write.get(\"selected_api\")===service.get(\"key\"))return true;if(!service.hasWrites())return false;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.readService=z.app.services.get(this.options.read.get(\"selected_api\"));this.writeService=z.app.services.get(this.options.write.get(\"selected_api\"));readAction=this.options.read.get(\"action\");this.readActions=(_ref=this.readService)!=null?typeof _ref.getActions===\"function\"?_ref.getActions(\"read\",readAction):void 0:void 0;if(readAction!=null&&this.readService!=null&&!this.readService.isActionImportant(\"read\",readAction)){this.state.set({showTriggerAll:true})}writeAction=this.options.write.get(\"action\");this.writeActions=(_ref2=this.writeService)!=null?typeof _ref2.getActions===\"function\"?_ref2.getActions(\"write\",writeAction):void 0:void 0;if(writeAction!=null&&this.writeService!=null&&!this.writeService.isActionImportant(\"write\",writeAction)){this.state.set({showActionAll:true})}if(!this.state.get(\"showTriggerAll\")){readActions=_.filter(this.readActions,function(action){return action.important});if(((_ref3=this.readActions)!=null?_ref3.length:void 0)!==(readActions!=null?readActions.length:void 0)){showTriggerExpand=true}this.readActions=readActions}if(!this.state.get(\"showActionAll\")){writeActions=_.filter(this.writeActions,function(action){return action.important});if(((_ref4=this.writeActions)!=null?_ref4.length:void 0)!==(writeActions!=null?writeActions.length:void 0)){showActionExpand=true}this.writeActions=writeActions}context={readServices:this.readServices,readActions:this.readActions,writeServices:this.writeServices,writeActions:this.writeActions,showTriggerExpand:showTriggerExpand,showActionExpand:showActionExpand,flow:this.options.flow,partnerService:(_ref5=z.app.services.get((_ref6=z.app.partner.get(\"zap\"))!=null?_ref6.selected_api:void 0))!=null?_ref5.getName():void 0,isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_service_action(context));this.$(\"#trigger-service\").val(this.options.read.get(\"selected_api\"));this.$(\"#action-service\").val(this.options.write.get(\"selected_api\"));this.$(\"#trigger-service\").select2({containerCssClass:\"select2-editor-service larger\",dropdownCssClass:\"select2-editor-service wide left\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcherService});this.$(\"#action-service\").select2({containerCssClass:\"select2-editor-service larger\",dropdownCssClass:\"select2-editor-service wide right\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcherService});this.$(\"#trigger\").val(this.options.read.get(\"action\"));this.$(\"#action\").val(this.options.write.get(\"action\"));this.$(\"#trigger\").select2({containerCssClass:\"select2-editor-action\",dropdownCssClass:\"select2-editor-action wide left\",formatResult:_.bind(this.actionFormatResult,this,this.readService),formatSelection:_.bind(this.actionFormatSelection,this,this.readService),escapeMarkup:function(s){return s},matcher:this.matcher});this.$(\"#action\").select2({containerCssClass:\"select2-editor-action\",dropdownCssClass:\"select2-editor-action wide right\",formatResult:_.bind(this.actionFormatResult,this,this.writeService),formatSelection:_.bind(this.actionFormatSelection,this,this.writeService),escapeMarkup:function(s){return s},matcher:this.matcher});if(this.readService!=null)this.setMode(\"show\",\"triggers\");if(this.writeService!=null)this.setMode(\"show\",\"actions\");this.renderContinue();this.renderLocks();return this},renderLocks:function(){if(this.hasMode(\"is\",\"saving\")){this.$(\".picker.services .trigger select\").select2(\"disable\");this.$(\".picker.services .action select\").select2(\"disable\");this.$(\"select#trigger\").select2(\"disable\");return this.$(\"select#action\").select2(\"disable\")}else{this.$(\".picker.services .trigger select\").select2(\"enable\");this.$(\".picker.services .action select\").select2(\"enable\");this.$(\"select#trigger\").select2(\"enable\");return this.$(\"select#action\").select2(\"enable\")}},showActionCard:function(e){var _this=this;clearTimeout(this.actionCardTimeout);return this.actionCardTimeout=_.delay(function(){var actions,key,view;key=$(e.currentTarget).find(\"t[data-id]\").attr(\"data-id\");if(!(key!=null))return;actions=z.app.services.get(key).getActions(\"write\");view=JST.editor_action_card({action:actions,which:\"Action\"});return _this.actionCard=new z.ui.Modal({\"class\":\"action-card\",view:view,target:$(e.currentTarget),x:-260,y:0,noX:true,noLayer:true})},750)},showTriggerCard:function(e){var _this=this;clearTimeout(this.triggerCardTimeout);return this.triggerCardTimeout=_.delay(function(){var key,triggers,view;key=$(e.currentTarget).find(\"t[data-id]\").attr(\"data-id\");if(!(key!=null))return;triggers=z.app.services.get(key).getActions(\"read\");view=JST.editor_action_card({action:triggers,which:\"Trigger\"});return _this.actionCard=new z.ui.Modal({\"class\":\"action-card\",view:view,target:$(e.currentTarget),x:90,y:0,noX:true,noLayer:true})},750)},hideCards:function(){var _ref,_ref2;clearTimeout(this.actionCardTimeout);clearTimeout(this.triggerCardTimeout);if((_ref=this.triggerCard)!=null)_ref.close();return(_ref2=this.actionCard)!=null?_ref2.close():void 0},buildServiceMatchIndex:function(){var _this=this;this.serviceIndex={};return z.app.services.each(function(service){var actions,categories,index,triggers;index=\"\";triggers=service.getActions(\"read\");actions=service.getActions(\"write\");categories=service.getCategories();_.each(triggers,function(trigger){return index+=service.getActionName(trigger.key,\"read\",\"true\")+\" \"});_.each(actions,function(action){return index+=service.getActionName(action.key,\"write\",\"true\")+\" \"});_.each(categories,function(category){return index+=category+\" \"});index+=service.getName().replace(\" \",\"\")+\" \";index=_.str.clean(index.toLowerCase());return _this.serviceIndex[service.getName()]=index})},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,key,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);key=service.get(\"key\");icon=service.getImageClass(\"32x32\");name=service.getName();key=_.escape(key);name=_.escape(name);icon=_.escape(icon);html='<i class=\"img32 '+icon+'\"></i> <t data-id=\"'+key+'\">'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},actionFormatSelection:function(service,row){var help,html,icon;if(!row.id)return row.text;help=$(row.element).attr(\"data-help\");icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;row.text=_.escape(row.text);html=\"<t>\"+row.text+\"</t>\";return html},actionFormatResult:function(service,row){var help,html,icon;if(!row.id)return row.text;if(row.id===\"showAll\"){return'<span class=\"showAll\">'+row.text+\"</span>\"}help=$(row.element).attr(\"data-help\");icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;row.text=_.escape(row.text);html=\"<t>\"+row.text+\"</t> <span>\"+help+\"</span>\";return html},matcherService:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=this.serviceIndex[haystack].toLowerCase();return _.str.include(haystack,needle)},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},changeService:function(e){var $el,data,model,val,which,_this=this;$el=this.$(e.currentTarget);this.hideCards();val=$el.val();which=_.str.include($el.attr(\"id\"),\"trigger\")?\"showTriggerAll\":\"showActionAll\";data={};data[which]=false;this.state.set(data);model=_.str.include($el.attr(\"id\"),\"trigger\")?this.options.read:this.options.write;which=_.str.include($el.attr(\"id\"),\"trigger\")?\"trigger\":\"action\";this.setMode(\"is\",\"saving\");return model.save({selected_api:val,action:null},{wait:true,complete:function(){return _this.setMode(\"not\",\"saving\")}})},changeAction:function(e){var $el,data,model,val,which,_this=this;$el=this.$(e.currentTarget);val=$el.val();if(val===\"showAll\"){which=_.str.include($el.attr(\"id\"),\"trigger\")?\"showTriggerAll\":\"showActionAll\";data={};data[which]=true;this.state.set(data);this.render();which=_.str.include($el.attr(\"id\"),\"trigger\")?\"trigger\":\"action\";return this.$(\"select#\"+which).select2(\"open\")}else{model=_.str.include($el.attr(\"id\"),\"trigger\")?this.options.read:this.options.write;this.setMode(\"is\",\"saving\");return model.save({action:val},{wait:true,complete:function(){return _this.setMode(\"not\",\"saving\")}})}},renderContinue:function(){var mode;mode=this.complete()?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},complete:function(){var action,bothSelected,parterService,partner,trigger,_ref;trigger=this.options.read.get(\"selected_api\")!=null&&this.options.read.get(\"action\")!=null;action=this.options.write.get(\"selected_api\")!=null&&this.options.write.get(\"action\")!=null;parterService=(_ref=z.app.partner.get(\"zap\"))!=null?_ref.selected_api:void 0;partner=parterService===this.options.read.get(\"selected_api\")||parterService===this.options.write.get(\"selected_api\");bothSelected=this.options.read.get(\"selected_api\")!=null&&this.options.write.get(\"selected_api\")!=null;if(parterService!=null&&!partner&&bothSelected){this.$(\".partner-feedback\").removeClass(\"hide\")}else{this.$(\".partner-feedback\").removeClass(\"hide\").addClass(\"hide\")}return trigger&&action&&(partner||!(parterService!=null))},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")}});z.ui.EnableStep=z.ui.Base.extend({className:\"enable\",events:{\"click .enable\":\"enable\",\"click input.title\":\"highlight\",\"change .title\":\"updateModel\"},initialize:function(options){var render;this.options=options;_.bindAll(this);this.read=this.options.read;this.write=this.options.write;this.readNeeds=this.options.readNeeds;this.writeNeeds=this.options.writeNeeds;render=_.debounce(this.render,40);this.read.on(\"change:selected_api change:action change:params change:paused change:errors\",render,this);this.write.on(\"change:selected_api change:action change:params change:errors\",render,this);this.readNeeds.on(\"change\",render,this);return this.writeNeeds.on(\"change\",render,this)},context:function(){var context,plan,polling,readService,writeService;readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));if(z.app.account.get(\"plan_id\")!=null){plan=z.app.plans.get(z.app.account.get(\"plan_id\"))}else{plan=z.app.plans.getTrialPlan()}polling=z.app.accountLimits.get(\"polling_interval\");context={flow:this.options.flow,errors:this.read.get(\"errors\").concat(this.write.get(\"errors\")),plan:plan,polling:polling,read:this.read.toJSON(),write:this.write.toJSON(),isHook:readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0,title:this.read.getTitle(true),readService:readService,writeService:writeService,ov:z.cfg.userfillOTag,cv:z.cfg.userfillETag};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_enable(context));z.useful.placeholders(this.$el);return this},updateModel:function(e){var title;if(e!=null)e.preventDefault();title=this.$(e.currentTarget).val();return this.read.save({title:title})},enable:function(e){var t,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"is\",\"disabled\"))return;this.setMode(\"is\",\"disabled\");this.$button=this.$(e.currentTarget);this.$button.text(\"Working...\");this.i=0;t=500;this.read.fetch({cache:false});return _.delay(function(){return _this.checkTimer=setInterval(function(){return _this.unpauseAjaxCheck()},500)},20)},unpauseAjaxCheck:function(){this.i+=1;if($.active===0)this.unpauseErrorCheck();if(this.i>20)return clearInterval(this.checkTimer)},unpauseErrorCheck:function(){var _this=this;return _.defer(function(){clearInterval(_this.checkTimer);if(!_this.read.hasErrors()){window.onbeforeunload=null;return _this.stripNonvisibleParams()}else{_this.setMode(\"not\",\"disabled\");return _this.$button.text(\"Make Zap Live\")}})},stripNonvisibleParams:function(){var stripped,_this=this;stripped={};z.app.writeNeeds.each(function(need){var key,_ref;key=need.get(\"key\");return stripped[key]=(_ref=z.app.write.get(\"params\"))!=null?_ref[key]:void 0});return z.app.write.save({params:stripped},{success:this.unpause,error:this.unpause})},unpause:function(){var error,success,_this=this;success=function(){var _ref;if(!((_ref=z.app.partner)!=null?_ref.isPartnerSession():void 0)){_this.shareZap()}Backbone.history.navigate(\"/app/dashboard\",{trigger:true});return _this.$button.text(\"Make Zap Live\")};error=function(model,xhr){var modal;_this.setMode(\"not\",\"disabled\");_this.$button.text(\"Make Zap Live\");if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})};return this.read.unpause({success:success,error:error})},shareZap:function(){var hasCookie,olderZap;hasCookie=z.store.get(this.read.id+\"-shared\")===\"yes\";olderZap=this.read.date&&(new Date).getTime()-this.read.date.getTime()>3*24*60*60*1e3;if(z.app.account.isFree()&&this.read.canShare()&&this.write.canShare()&&!hasCookie&&olderZap){this.shareZapModal=new z.ui.Modal({view:new z.ui.ShareZapModal({read:this.read,write:this.write})});return window.t=this.shareZapModal}},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()}});z.ui.ActionStep=z.ui.Base.extend({className:\"actions\",events:{\"click .showall\":\"showall\",\"click li.action\":\"select\"},test:function(e){return e!=null?e.preventDefault():void 0},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.model=this.isTrigger?this.read:this.write;this.state.set(\"showall\",false);if(this.model.get(\"selected_api\")!=null)this.setActions();if(this.model.get(\"selected_api\")!=null&&this.model.get(\"action\")!=null){this.setShowall()}this.model.on(\"change:selected_api\",function(){return _this.state.set(\"showall\",false)},this);this.model.on(\"change:selected_api\",this.render,this);this.model.on(\"change:action\",this.render,this);this.state.on(\"change:showall\",this.render,this);return this.model.on(\"change:action\",function(){if(_this.get()!=null)return z.app.editor.next(_this)},this)},get:function(){return this.model.get(\"action\")},set:function(action){return this.model.set(\"action\",action)},unset:function(){return this.model.set(\"action\",null)},context:function(){var context;context={anyAdvanced:this.anyAdvanced(),showall:this.state.get(\"showall\"),actions:this.actions,show:this.model.get(\"selected_api\")!=null};return context},render:function(){this.setActions();this.$el.html(JST.editor_action(this.context()));this.renderActions();return this},renderActions:function(){var _this=this;this.$(\"ul\").empty();return _.each(this.actions,function(action){var context;context=action;context.selected=context.key===_this.get();if(action.important||!_this.anyAdvanced()||_this.state.get(\"showall\")){return _this.$(\"ul\").append(JST.editor_action_row(context))}})},anyAdvanced:function(){var _this=this;return _.any(this.actions,function(action){return action.important===false})},setActions:function(){var service;service=z.app.services.get(this.model.get(\"selected_api\"));return this.actions=this.isTrigger?service!=null?service.getActions(\"read\"):void 0:service!=null?service.getActions(\"write\"):void 0},setShowall:function(){var selected,_this=this;selected=_.find(this.actions,function(action){return action.key===_this.get()});if((selected!=null?selected.important:void 0)===false){return this.state.set(\"showall\",true)}},showall:function(e){if(e!=null)e.preventDefault();return this.state.set(\"showall\",true)},select:function(e){var action;if(e!=null)e.preventDefault();action=this.$(e.currentTarget).attr(\"id\");if(this.get()!==action){return this.set(action)}else{return this.unset()}}});z.ui.Steps=z.ui.Base.extend({className:\"steps\",events:{\"click .unpause\":\"unpause\"},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.cap=0;_.each(this.steps(),function(step,name){return _this.state.set(name,\"none_visible\")});this.read.on(\"change:selected_api change:action change:paused\",this.render,this);return this.write.on(\"change:selected_api change:action\",this.render,this)},steps:function(){return{\"services-actions\":{step:1,view:z.app.editor.views.servicesActions},\"trigger-auth\":{step:2,view:z.app.editor.views.triggerAuth},\"action-auth\":{step:3,view:z.app.editor.views.actionAuth},filters:{step:4,view:z.app.editor.views.filters},map:{step:5,view:z.app.editor.views.map},test:{step:6,view:z.app.editor.views.test},enable:{step:7,view:z.app.editor.views.enable}}},context:function(){var context,readService,writeService;context={read:this.read.toJSON(),write:this.write.toJSON(),flow:this.flow};readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));context.readAction=readService!=null?readService.getActionName(this.read.get(\"action\"),\"read\",\"true\"):void 0;context.writeAction=writeService!=null?writeService.getActionName(this.write.get(\"action\"),\"write\",\"true\"):void 0;context.hasErrors=this.read.hasErrors();_.extend(context,this.state.toJSON());return context},renderSteps:function(){var steps;steps=this.steps();steps[\"services-actions\"].view.render();steps[\"trigger-auth\"].view.render();steps[\"action-auth\"].view.render();steps[\"filters\"].view.render();steps[\"map\"].view.render();steps[\"test\"].view.render();return steps[\"enable\"].view.render()},render:function(){var steps,_this=this;_.each(this.steps(),function(step,name){return _this.$(\"[data-id=\"+name+\"] content\").detach()});this.$el.html(JST.editor_steps(this.context()));steps=this.steps();this.$(\"[data-id=services-actions] content\").html(steps[\"services-actions\"].view.$el);this.$(\"[data-id=trigger-auth] content\").html(steps[\"trigger-auth\"].view.$el);this.$(\"[data-id=action-auth] content\").html(steps[\"action-auth\"].view.$el);this.$(\"[data-id=filters] content\").html(steps[\"filters\"].view.$el);this.$(\"[data-id=map] content\").html(steps[\"map\"].view.$el);this.$(\"[data-id=test] content\").html(steps[\"test\"].view.$el);this.$(\"[data-id=enable] content\").html(steps[\"enable\"].view.$el);\nthis.$(\".dial\").knob({max:this.$(\".dial\").length,readOnly:true,height:40,width:40,inputColor:\"#4d4d4d\",fgColor:\"#888888\",bgColor:\"#cccccc\"});return this},getPosition:function(step){var pos,_this=this;pos=0;_.each(this.steps(),function(eachStep,name){if(step===name)return pos=eachStep.step});return pos},showAllSteps:function(){var _this=this;return _.each(this.steps(),function(step,name){return _this.showAll(name)})},showNext:function(){var _this=this;return this.$(\"step.none_visible\").first().each(function(i,el){var options,step,view;step=$(el).attr(\"data-id\");view=_this.steps()[step].view;z.app.track[\"new\"](\"Editor Step: \"+step,{step:step,snap:z.app.read.id});_this.state.set(step,\"all_visible\");_this.setMode(\"all\",\"visible\",$(el));options={offset:{left:0,top:-25}};if(_this.getPosition(step)>0){_.defer(function(){if(z.app.partner.isPartnerSession()&&z.app.partner.hasIframeJs){return _.delay(function(){var event,target,_ref;target=(_ref=$(el).find(\".row\").eq(0).offset())!=null?_ref.top:void 0;event={event:\"scroll\",height:target};return typeof window!==\"undefined\"&&window!==null?window.top.postMessage(JSON.stringify(event),\"*\"):void 0},150)}else{return $.scrollTo($(el).find(\".row\").eq(0),200,options)}})}return view!=null?typeof view.show===\"function\"?view.show():void 0:void 0})},toggleStep:function(e){var step;if(e!=null)e.preventDefault();step=$(e.currentTarget).closest(\"step\").attr(\"data-id\");if(this.state.get(step)===\"all_visible\"){return this.showTitle(step)}else if(this.state.get(step)===\"title_visible\"){return this.showAll(step)}},showTitle:function(step){var $el;this.state.set(step,\"title_visible\");$el=this.$(\"[data-id=\"+step+\"]\");return this.setMode(\"title\",\"visible\",$el)},showAll:function(step){var $el;this.state.set(step,\"all_visible\");$el=this.$(\"[data-id=\"+step+\"]\");return this.setMode(\"all\",\"visible\",$el)},unpause:function(e){var error,success,_this=this;if(e!=null)e.preventDefault();success=function(){};error=function(model,xhr){var modal;if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})};return this.read.unpause({success:success,error:error})}});var __indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};z.ui.EmbedSharedZaps=z.ui.Base.extend({embeddedZaps:[],events:{\"click input.add-to-embed\":\"toggleOnEmbed\",\"click .page-nav .previous\":\"previous\",\"click .page-nav .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.on(\"add remove reset change\",this.render,this);this.recipes.on(\"fetch\",this.startFetching,this);this.recipes.on(\"add remove reset change\",this.doneFetching,this);this.embed=options.embed;return this.checkedBoxes=[]},previous:function(e){if(e!=null)e.preventDefault();return this.recipes.serverPrev()},next:function(e){if(e!=null)e.preventDefault();return this.recipes.serverNext()},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());return this.recipes.serverPage(page)},routingKey:function(checkbox){if(checkbox.prop(\"checked\"))return\"embed.template.add\";return\"embed.template.remove\"},toggleOnEmbed:function(e){var $checkbox;$checkbox=$(e.currentTarget);z.cfg.pubSub.trigger(this.routingKey($checkbox),{zap_id:$checkbox.val()});return this.checkedBoxes.push(parseInt($checkbox.val(),10))},context:function(){var context;context={recipes:this.recipes,pagination:this.recipes.pagination.toJSON()};return context},render:function(){this.$el.html(JST.explore_results(this.context()));this.$zaps=this.$(\".zaps\");this.renderSharedRecipes();return this},sharedRecipesContext:function(recipe){var context,_ref;context=_.extend(recipe.toJSON(),{checked:(_ref=recipe.id,__indexOf.call(this.checkedBoxes,_ref)>=0)});return context},renderSharedRecipes:function(){var html,_this=this;html=\"\";this.recipes.each(function(recipe){return html+=JST.share_recipe(_this.sharedRecipesContext(recipe))});if(html===\"\"){html='<div class=\"empty\">No Zaps shared! Try sharing a few services.</div>'}return this.$zaps.html(html)}});z.ui.EmbededZaps=z.ui.Base.extend({SHARABLE_SCRIPT:'<script type=\"text/javascript\" src=\"{{base_url}}/zapbook/embed/widget.js?zaps={{zaps}}\"></script>',embeddedZaps:[],events:{},initialize:function(options){var render,_ref;_.bindAll(this);_.defaults(this,options);render=_.debounce(this.render,40);_ref=[false,false],this.animating=_ref[0],this.fetching=_ref[1];this.embed=options.embed;this.embed.on(\"changed fetch sync\",render,this);this.embed.on(\"fetch\",this.startFetching,this);this.embed.on(\"add remove reset change\",this.doneFetching,this);this.embeddedZaps=[];z.cfg.pubSub.on(\"embed.template.add\",this.addZap,this);return z.cfg.pubSub.on(\"embed.template.remove\",this.removeZap,this)},addZap:function(params){this.embeddedZaps.push(params.zap_id);return this.fetchView()},removeZap:function(params){this.embeddedZaps=_.reject(this.embeddedZaps,function(id){return id===params.zap_id});return this.fetchView()},toTop:function(){var _this=this;this.animating=true;return $(\"html, body\").animate({scrollTop:0},200,function(){return setTimeout(function(){_this.animating=false;return _this.doneAnimating()},200)})},doneAnimating:function(){if(!this.animating&&!this.fetching)return this.$el.removeClass(\"loading\")},startFetching:function(){this.fetching=true;return this.$el.addClass(\"loading\")},doneFetching:function(){this.fetching=false;return this.doneAnimating()},fetchView:function(){this.embed.fetch({data:{zaps:this.embeddedZaps.join(\",\")}},{processData:true});return this.toTop()},render:function(){var context;this.$el.html(JST.share_embed({}));this.$sharer=this.$(\".sharer\");this.$sharer.append($(this.embed.get(\"html\")));context={base_url:window.location.origin,zaps:this.embeddedZaps.join(\",\")};this.$el.find(\".share-this\").val(_.template(this.SHARABLE_SCRIPT,context));this.$el.find(\".share-this\").on(\"click\",function(){return this.select()});return this}});z.ui.HistoryNav=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={id:this.options.id};return context},render:function(){var context;context=this.context();this.$el.html(JST.history_nav(context));return this}});z.ui.HistoryDetails=z.ui.Base.extend({events:{\"click .replay\":\"replay\",\"click .target:not(.container)\":\"toggle\",\"click .toggle-details\":\"toggle\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var changed,context,json,ra,read,rs,rsn,title,wa,write,ws,wsn,_this=this;json=this.options.streamItem.toJSON();json.children=this.options.streamItem.buildChildren();if(json.children!=null){json.children=_.map(json.children,function(child){child.dataDetails=_this.getDataDetails(child.type);return child})}context=json;if(json.type===\"write\"){write=z.app.writes.get(json.object_id);read=z.app.reads.filter(function(read){return read.get(\"write_ids\")[0]===(write!=null?write.id:void 0)});read=read[0]}else{read=z.app.reads.get(json.object_id);write=z.app.writes.get(read.get(\"write_ids\")[0])}changed=false;if(read!=null&&read.get(\"selected_api\")!==json.data.read_selected_api){changed=true;read=null}if(write!=null&&write.get(\"selected_api\")!==json.data.write_selected_api){changed=true;write=null}if(!(read!=null)){read=new z.model.Read({selected_api:json.data.read_selected_api,action:json.data.read_action,params:json.data.read_params})}if(!(write!=null)){write=new z.model.Write({selected_api:json.data.write_selected_api,action:json.data.write_action,params:json.data.write_params})}context.read=read.toJSON();context.write=write.toJSON();title=read.getTitle();rs=z.app.services.get(read.get(\"selected_api\"));ws=z.app.services.get(write.get(\"selected_api\"));rsn=(rs!=null?rs.getName():void 0)||read.get(\"selected_api\");ra=(rs!=null?rs.getActionName(read.get(\"action\"),\"read\",\"true\"):void 0)||read.get(\"action\");wsn=(ws!=null?ws.getName():void 0)||write.get(\"selected_api\");wa=(ws!=null?ws.getActionName(write.get(\"action\"),\"write\",\"true\"):void 0)||write.get(\"action\");if(!(title!=null)){title=\"\"+rsn+\" \"+ra+\" to \"+wsn+\" \"+wa;if(changed){title+=\" (Zap services changed)\"}else{title+=\" (Zap deleted)\"}}context.title=title;context.state=this.state.toJSON();return context},render:function(){var context;context=this.context();this.$el.html(JST.history_details(context));return this},toggle:function(e){var detail,el,target;if(e!=null)e.preventDefault();detail=this.$(e.currentTarget).parent();if(this.$(e.currentTarget).hasClass(\"toggle-details\")){target=this.$(e.currentTarget).next(\".target\")}else{target=this.$(e.currentTarget)}if(detail.find('[class*=\"fa-caret-\"]').hasClass(\"fa-caret-right\")){el=target.find(\".fa-caret-right\");el.removeClass(\"fa-caret-right\").addClass(\"fa-caret-down\");el=target.siblings(\".details\");el.removeClass(\"hide\");return detail.find(\".toggle-details\").text(\"Hide detail\")}else{el=target.find(\".fa-caret-down\");el.removeClass(\"fa-caret-down\").addClass(\"fa-caret-right\");el=target.siblings(\".details\");el.addClass(\"hide\");return detail.find(\".toggle-details\").text(\"Show detail\")}},getDataDetails:function(type){var action,data,event,fields,i,name,read,service,status,stream,title,unreplaced,write,zapHtml,_ref,_ref2;stream=(_ref=z.app.streamItem)!=null?_ref.toJSON():void 0;if(!(stream!=null))return{};if(stream.type===\"write\"){write=z.app.writes.get(stream.legacy_object_id||stream.object_id);read=z.app.reads.filter(function(read){return read.get(\"write_ids\")[0]===(write!=null?write.id:void 0)});read=read[0]}else{read=z.app.reads.get(stream.legacy_object_id||stream.object_id);write=z.app.writes.get(read.get(\"write_ids\")[0])}if(!(read!=null)){read=new z.model.Read({selected_api:stream.data.read_selected_api,action:stream.data.read_action,params:stream.data.read_params})}if(!(write!=null)){write=new z.model.Write({selected_api:stream.data.write_selected_api,action:stream.data.write_action,params:stream.data.write_params})}title=read.getTitle();if(title!=null){zapHtml='<a target=\"_new\" href=\"/app/editor/'+read.id+'\">'+title+'</a> <i class=\"fa fa-external-link\"></i>'}else{zapHtml=\"(Zap no longer exists, it was deleted)\"}zapHtml=new Handlebars.SafeString(zapHtml);if(type===\"manual\"){data={Event:\"This Zap was manually ran from the Zapier dashboard.\",Date:z.useful.prettyISO(stream.date)}}if(type===\"trigger_summary\"){status=((_ref2=_.keys(stream.data.write_raw_data))!=null?_ref2.length:void 0)>0?\"success\":\"error\";service=z.app.services.get(stream.data.read_selected_api);name=(service!=null?service.getName():void 0)||stream.data.read_selected_api;action=(service!=null?service.getActionName(stream.data.read_action,\"read\",\"true\"):void 0)||stream.data.read_action;if(status===\"success\")event=\"Found 1 new \"+action+\" from \"+name;if(status===\"error\")event=\"Error getting \"+action+\" from \"+name;data={Zap:zapHtml,Event:event,Date:z.useful.prettyISO(stream.date),Status:_.superHumanize(stream.data.status)};if(stream.data.message!=null&&status===\"error\"){data[\"Details\"]=stream.data.message}i=0;_.each(stream.data.write_raw_data,function(v,k){i+=1;if(!(v!=null)||v===\"\")v=\"<empty>\";return data[k]=v});if(i===0){data[\"Warning\"]=\"No data was sent to Zapier for this Trigger.\"}}if(type===\"action_summary\"){service=z.app.services.get(stream.data.write_selected_api);name=(service!=null?service.getName():void 0)||stream.data.write_selected_api;action=(service!=null?service.getActionName(stream.data.write_action,\"write\",\"true\"):void 0)||stream.data.write_action;if(stream.data.status===\"success\"){event=\"Sent 1 \"+action+\" to \"+name}if(stream.data.status===\"halted\"){event=\"Advanced Filters halted 1 \"+action}if(stream.data.status===\"error\"){event=\"Tried to send 1 \"+action+\" to \"+name}data={Zap:zapHtml,Event:event,Date:z.useful.prettyISO(stream.date),Status:_.superHumanize(stream.data.status)};if(stream.data.message!=null&&stream.data.status===\"error\"){data[\"Details\"]=stream.data.message}i=0;_.each(stream.data.write_replaced_data,function(v,k){i+=1;if(!(v!=null)||v===\"\")v=\"<empty>\";return data[k]=v});if(i===0){data[\"Warning\"]=\"There was no data (after replacing template variables) to send for this Action.\"}unreplaced=[];_.each(stream.data.write_params,function(v,k){if(!(stream.data.write_replaced_data[k]!=null)){return unreplaced.push(k)}});if(unreplaced.length>0){fields=unreplaced.join(\", \");data[\"Warning\"]=\"Some expected template variables did not exist in the Trigger data. The following fields were sent to \"+name+\" empty: \"+fields+\".\"}}return data},replay:function(e){var $el,account,data,id,modal,options,paid,raw,replaced,sample,view,write,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_this=this;if(e!=null)e.preventDefault();account=z.app.account.toJSON();paid=(account!=null?(_ref=account.billing)!=null?(_ref2=_ref.subscription)!=null?(_ref3=_ref2.plan)!=null?_ref3.amount:void 0:void 0:void 0:void 0)>0;z.app.track[\"new\"](\"Replay Action\",{paid:paid});if(!(account.is_trialing||account.is_staff||paid||account.provider)){view=new z.ui.UpgradeModal({errors:[\"Replaying old tasks requires a paid plan.\"]});modal=new z.ui.Modal({view:view});return false}$el=this.$(e.currentTarget);id=$el.closest(\".container\").attr(\"data-id\");sample=z.app.streamItem;replaced=(_ref4=sample.toJSON())!=null?(_ref5=_ref4.data)!=null?_ref5.write_replaced_data:void 0:void 0;raw=(_ref6=sample.toJSON())!=null?(_ref7=_ref6.data)!=null?_ref7.write_raw_data:void 0:void 0;data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={step:sample.id,success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");$el.removeClass(\"working\");data=sample.get(\"data\");data[\"status\"]=\"success\";return sample.save({data:data},{wait:true})},error:function(model,xhr){var context,html,service,_ref10,_ref8,_ref9;clearInterval(_this.loadingTimer);service=(_ref8=z.app.services.get((_ref9=sample.get(\"data\"))!=null?_ref9.write_selected_api:void 0))!=null?_ref8.getName():void 0;$el.html(\"Error!\");$el.removeClass(\"working\");context={key:(_ref10=sample.get(\"data\"))!=null?_ref10.write_selected_api:void 0,message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};write=new z.model.Write({id:sample.get(\"object_id\")});write.write((_ref8=sample.get(\"data\"))!=null?_ref8.write_action:void 0,data,options);return false}});z.ui.SendCSVModal=z.ui.Base.extend({className:\"send-csv-modal\",events:{\"click .send\":\"send\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,_ref,_ref2,_ref3,_ref4;context={};context.filters=z.app.stream.filters.toJSON();if((_ref=context.filters)!=null?_ref.write_id:void 0){context.zap=(_ref2=z.app.reads)!=null?_ref2.find(function(read){return _.indexOf(read.get(\"write_ids\"),parseInt(context.filters.write_id))!==-1}):void 0;context.zapName=(_ref3=context.zap)!=null?_ref3.getTitle():void 0}context.status=(_ref4=context.filters)!=null?_ref4.status:void 0;return context},render:function(){this.$el.html(JST.history_send_csv(this.context()));return this},send:function(options){var _this=this;if(options==null)options={};return $.ajax({url:z.cfg.api+\"/stream/send\",type:\"POST\",data:JSON.stringify(z.app.stream.filters.toJSON()),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.$el.find(\"button.submit\").hide();_this.$el.find(\".feedback\").html(\"<em>Success! Check your email in a few moments!</em>\");setTimeout(function(){return _this.modal.close()},5e3);return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0}})}});z.ui.History=z.ui.Base.extend({events:{\"click .replay\":\"replay\",\"click .page-nav .previous\":\"previous\",\"click .page-nav .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){this.options=options;_.bindAll(this);return z.app.stream.on(\"add remove reset\",this.render,this)},context:function(){var context;context={pagination:z.app.stream.pagination.toJSON(),isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var empty,_this=this;this.$el.html(JST.history_table(this.context()));this.$table=this.$(\"table\");empty=_.once(function(){return _this.$table.empty()});z.app.stream.each(function(item){var context,_ref;empty();context=item.toJSON();if(((_ref=context.timesince)!=null?_ref.length:void 0)<4&&_.str.endsWith(context.timesince,\"m\")){context.date=context.timesince+\" ago\"}else{context.date=z.useful.prettyISO(context.date)}if(context)return _this.$table.append(JST.history_row(context))});this.$el.append(JST.history_pagination(this.context()));return this},previous:function(e){if(e!=null)e.preventDefault();z.app.stream.serverPrev();return $.scrollTo($(\"#app\"),200)},next:function(e){if(e!=null)e.preventDefault();z.app.stream.serverNext();return $.scrollTo($(\"#app\"),200)},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());return z.app.stream.serverPage(page)},replay:function(e){var $el,account,data,id,modal,options,paid,raw,replaced,sample,view,write,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();account=z.app.account.toJSON();paid=(account!=null?(_ref=account.billing)!=null?(_ref2=_ref.subscription)!=null?(_ref3=_ref2.plan)!=null?_ref3.amount:void 0:void 0:void 0:void 0)>0;z.app.track[\"new\"](\"Replay Action\",{paid:paid});if(!(account.is_trialing||account.is_staff||paid||z.app.partner.isPartnerSession())){view=new z.ui.UpgradeModal({errors:[\"Replaying old tasks requires any paid plan.\"]});modal=new z.ui.Modal({view:view});return false}$el=this.$(e.currentTarget);id=$el.closest(\".history\").attr(\"data-id\");sample=z.app.stream.get(id);replaced=sample!=null?(_ref4=sample.toJSON().data)!=null?_ref4.write_replaced_data:void 0:void 0;raw=sample!=null?(_ref5=sample.toJSON().data)!=null?_ref5.write_raw_data:void 0:void 0;data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={step:sample.id,success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");$el.removeClass(\"working\");data=sample.get(\"data\");data[\"status\"]=\"success\";return sample.save({data:data},{wait:true})},error:function(model,xhr){var context,html,service,_ref6,_ref7,_ref8;clearInterval(_this.loadingTimer);service=(_ref6=z.app.services.get((_ref7=sample.get(\"data\"))!=null?_ref7.write_selected_api:void 0))!=null?_ref6.getName():void 0;$el.html(\"Error!\");$el.removeClass(\"working\");context={key:(_ref8=sample.get(\"data\"))!=null?_ref8.write_selected_api:void 0,message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};write=new z.model.Write({id:sample.get(\"object_id\")});write.write((_ref6=sample.get(\"data\"))!=null?_ref6.write_action:void 0,data,options);return false}});z.ui.SendCSVModal=z.ui.Base.extend({events:{\"click .send\":\"send\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,_ref,_ref2,_ref3,_ref4;context={};context.filters=z.app.stream.filters.toJSON();if((_ref=context.filters)!=null?_ref.write_id:void 0){context.zap=(_ref2=z.app.reads)!=null?_ref2.find(function(read){return _.indexOf(read.get(\"write_ids\"),parseInt(context.filters.write_id))!==-1}):void 0;context.zapName=(_ref3=context.zap)!=null?_ref3.getTitle():void 0}context.status=(_ref4=context.filters)!=null?_ref4.status:void 0;return context},render:function(){this.$el.html(JST.history_send_csv(this.context()));return this},send:function(options){var _this=this;if(options==null)options={};return $.ajax({url:z.cfg.api+\"/stream/send\",type:\"POST\",data:JSON.stringify(z.app.stream.filters.toJSON()),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.$el.find(\".bottom\").html(\"<em>Success! Check your email in a few moments!</em>\");setTimeout(function(){return _this.modal.close()},5e3);return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0}})}});z.ui.HistoryFilters=z.ui.Base.extend({events:{\"click .send-csv\":\"sendCSV\",\"click .refresh\":\"refresh\"},initialize:function(options){var fields,_this=this;this.options=options;_.bindAll(this);this.refresh=_.throttle(this._refresh,1e3);z.app.stream.filters.on(\"change\",this.updateCookie,this);z.app.stream.on(\"add remove reset\",this.updateCookie,this);fields=[{key:\"write_id\",type:\"select\",hideLabel:true,hideRawValue:true,choices:this.generateChoices(),value:z.app.stream.filters.toJSON().write_id||\"0\"},{key:\"status\",type:\"select\",hideLabel:true,hideRawValue:true,choices:{0:\"All Statuses\",success:\"Successful Only\",error:\"Errors Only\",halted:\"Filtered Only\"},value:z.app.stream.filters.toJSON().status||\"0\"}];this.form=new z.model.FormSet(fields);this.paramform=new z.ui.ParamForm({form:this.form});_.each(this.form.models,function(row){if(row.options.type===\"select\"){return row.on(\"change\",_this.filter,row)}});return this.updateCookie()},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.history_filters(this.context()));this.$(\"paramform\").replaceWith(this.paramform.render().el);return this},generateChoices:function(){var choices;choices={0:\"All zaps\"};_.each(this.getZaps(),function(zap,index,list){return choices[zap.write.id]=zap.title+\" (#\"+zap.read.id+\")\"});return choices},toggle:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).toggleClass(\"selected\")},filter:function(row){var key,url,value,_this=this;key=row.options.key;value=row.get(\"value\");url=\"/app/history?\";_.each(this.form.models,function(formRow){var thisKey,thisValue;thisKey=formRow.options.key;thisValue=formRow.get(\"value\");if(thisKey===\"write_id\"&&thisValue!==\"0\"){return url+=thisKey+\"=\"+thisValue+\"&\"}else if(thisKey===\"status\"&&thisValue!==\"0\"){return url+=thisKey+\"=\"+thisValue+\"&\"}});url=url.slice(0,-1);Backbone.history.navigate(url);if(value===\"0\")value=\"\";return z.app.stream.filters.set(key,value)},getZaps:function(){var zaps,_this=this;zaps=[];z.app.reads.each(function(read){var title,write;write=z.app.writes.get(read.get(\"write_ids\")[0]);title=read.getTitle();if(title!=null&&read!=null&&write!=null){return zaps.push({read:read.toJSON(),write:write.toJSON(),title:title})}});return zaps},_refresh:function(e){var done,oldHTML,_this=this;if(e!=null)e.preventDefault();oldHTML=this.$(e.currentTarget).html();this.$(e.currentTarget).text(\"Refreshing...\");done=function(){return _.delay(function(){return _this.$(e.currentTarget).html(oldHTML)},500)};return z.app.stream.fetch({cache:false,success:done,error:done})},sendCSV:function(e){return this.sendCSVModal=new z.ui.Modal({view:new z.ui.SendCSVModal({yes:null})})},updateCookie:function(){var cookie,date,write_id,_this=this;cookie=z.store.get(\"logs-seen\");cookie=cookie!=null?cookie:{};date=(new Date).toISOString();write_id=z.app.stream.filters.get(\"write_id\");if(write_id!=null)cookie[write_id]=date;z.app.stream.each(function(item){return cookie[item.get(\"legacy_object_id\")||item.get(\"object_id\")]=date});return z.store.set(\"logs-seen\",cookie)}});z.ui.ExploreSearch=z.ui.Base.extend({events:{\"click select#involve-service\":\"addServiceFilter\",\"click [data-remove-involve-service]\":\"removeServiceFilter\",\"change select[data-filter]\":\"filterUpdate\",\"click [data-clear-filter]\":\"clearFilter\",\"click .do-clear\":\"clearAllFilters\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.filters.on(\"change reset\",this.render,this);return this.buildServiceMatchIndex()},context:function(){var context,_this=this;this.services=z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.involvedServices=_.map(this.recipes.getServicesFilter(),function(value){if(_.str.include(value,\"API\")){return z.app.services.where({key:value})[0]}else{return z.app.services.where({slug:value})[0]}});context={services:this.services,involvedServices:this.involvedServices,filters:this.recipes.filters.toJSON(),anyFilters:_.any(_.values(this.recipes.filters.toJSON())),directLink:\"/app/explore?services=\"+this.recipes.filters.get(\"services\")};return context},addServiceFilter:function(e){var current,filterList,key;if(e!=null)e.preventDefault();key=z.app.services.get($(e.currentTarget).val()).get(\"slug\");current=this.recipes.getServicesFilter();if(!_.contains(current,key)){filterList=current.concat([key]);return this.recipes.applyServicesFilter(filterList)}},removeServiceFilter:function(e){var filterList,key;if(e!=null)e.preventDefault();filterList=this.recipes.getServicesFilter();key=$(e.currentTarget).attr(\"data-remove-involve-service\");return this.recipes.applyServicesFilter(_.without(filterList,key))},filterUpdate:function(e){var key,value;if(e!=null)e.preventDefault();key=$(e.currentTarget).attr(\"data-filter\");value=$(e.currentTarget).val();return this.recipes.filters.set(key,value)},clearFilter:function(e){var key,keys;if(e!=null)e.preventDefault();keys=$(e.currentTarget).attr(\"data-clear-filter\");return this.recipes.filters.set(_.object(function(){var _i,_len,_ref,_results;_ref=keys.split(\" \");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){key=_ref[_i];_results.push([key,null])}return _results}()))},clearAllFilters:function(e){if(e!=null)e.preventDefault();return this.recipes.clearFilters()},render:function(){var context;context=this.context();this.$el.html(JST.explore_search(context));this.$(\"#single-service\").val(this.recipes.filters.get(\"services\"));this.$(\"#trigger-service\").val(this.recipes.filters.get(\"read_service\"));this.$(\"#action-service\").val(this.recipes.filters.get(\"write_service\"));this.$(\".services select\").select2({containerCssClass:\"select2-explore-service larger\",dropdownCssClass:\"select2-explore-service wide left\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcher});return this},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,key,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);key=service.get(\"key\");icon=service.getImageClass(\"32x32\");name=service.getName();icon=_.escape(icon);key=_.escape(key);name=_.escape(name);html='<i class=\"img32 '+icon+'\"></i> <t data-id=\"'+key+'\">'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=this.serviceIndex[haystack].toLowerCase();return _.str.include(haystack,needle)},buildServiceMatchIndex:function(){var _this=this;this.serviceIndex={};return z.app.services.each(function(service){var actions,categories,index,triggers;index=\"\";triggers=service.getActions(\"read\");actions=service.getActions(\"write\");categories=service.getCategories();_.each(triggers,function(trigger){return index+=service.getActionName(trigger.key,\"read\",\"true\")+\" \"});_.each(actions,function(action){return index+=service.getActionName(action.key,\"write\",\"true\")+\" \"});_.each(categories,function(category){return index+=category+\" \"});index+=service.getName()+\" \";index=_.str.clean(index.toLowerCase());return _this.serviceIndex[service.getName()]=index})}});z.ui.ExploreResults=z.ui.Base.extend({events:{\"click .use-this\":\"useRecipe\",\"click .previous\":\"previous\",\"click .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){var _ref;_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.on(\"add remove reset change\",this.render,this);_ref=[false,false],this.animating=_ref[0],this.fetching=_ref[1];this.recipes.on(\"fetch\",this.startFetching,this);return this.recipes.on(\"add remove reset change\",this.doneFetching,this)},toTop:function(){var _this=this;this.animating=true;return $(\"html, body\").animate({scrollTop:0},200,function(){return setTimeout(function(){_this.animating=false;return _this.doneAnimating()},200)})},doneAnimating:function(){if(!this.animating&&!this.fetching)return this.$el.removeClass(\"loading\")},startFetching:function(){this.fetching=true;return this.$el.addClass(\"loading\")},doneFetching:function(){this.fetching=false;return this.doneAnimating()},previous:function(e){if(e!=null)e.preventDefault();this.recipes.serverPrev();return this.toTop()},next:function(e){if(e!=null)e.preventDefault();this.recipes.serverNext();return this.toTop()},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());this.recipes.serverPage(page);return this.toTop()},useRecipe:function(e){var qs,recipe,_ref,_ref2,_ref3,_ref4;if(e!=null)e.preventDefault();$(e.currentTarget).attr(\"disabled\",true);$(e.currentTarget).addClass(\"disabled\");$(e.currentTarget).html('<div class=\"spinning-star\"></div>');recipe=this.recipes.get($(e.currentTarget).attr(\"data-id\"));if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={};if(recipe.get(\"generated\")){qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0}}else{qs={recipe_id:recipe.id}}return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}},context:function(){var context;context={recipes:this.recipes,pagination:this.recipes.pagination.toJSON()};return context},render:function(){var html,_this=this;this.$el.html(JST.explore_results(this.context()));this.$container=this.$(\".zaps\");html=\"\";this.recipes.each(function(recipe){return html+=JST.explore_recipe(recipe.toJSON())});if(html===\"\"){html='<div class=\"empty\">No Zaps to show! Try choosing different services.</div>'}this.$container.html(html);return this}});z.ui.SignUpWhy=z.ui.Base.extend({events:{\"click .render\":\"render\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.querystring=options!=null?options.querystring:void 0;return this.recipe=options!=null?options.recipe:void 0},selectedPlan:function(){if(this.querystring.plan)return z.app.plans.get(this.querystring.plan);return null},readService:function(){if(this.recipe)return this.recipe.readService();return null},readAction:function(){var read_action,_ref,_ref2;read_action=(_ref=this.recipe)!=null?_ref.get(\"read_data\").action:void 0;if(read_action){return(_ref2=this.readService())!=null?_ref2.getActionMeta(read_action):void 0}return null},writeService:function(){if(this.recipe)return this.recipe.writeService();return null},writeAction:function(){var write_action,_ref,_ref2;write_action=(_ref=this.recipe)!=null?_ref.get(\"write_data\").action:void 0;if(write_action){return(_ref2=this.writeService())!=null?_ref2.getActionMeta(write_action,\"write\"):void 0}},context:function(){var context;context={selectedPlan:this.selectedPlan(),readService:this.readService(),readAction:this.readAction(),writeService:this.writeService(),writeAction:this.writeAction(),services:_.shuffle(z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0){return false}return true}))};return context},render:function(){var context;context=this.context();this.$el.html(JST.signup_why(context));return this}});z.ui.SignUpForm=z.ui.Base.extend({tagName:\"div\",className:\"form\",events:{\"click button.submit\":\"submitForm\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);return this.recipe=options!=null?options.recipe:void 0},setFormError:function(error){this.$(\".errors span\").text(error);\nthis.$(\".errors\").removeClass(\"hide\");return this.$(\"button\").attr(\"disabled\",false)},resetFormError:function(){this.$(\".errors\").addClass(\"hide\");return this.$(\"button\").attr(\"disabled\",true)},createAccount:function(cb){var _this=this;z.app.account.set(this.form.getValues(),{trigger:false});z.app.account.set({timezone:z.useful.getUserTimezone()},{trigger:false});return z.app.account.save({},{success:function(model,response,options){z.app.account.accountCreated();return typeof cb===\"function\"?cb():void 0},error:function(model,xhr,options){var response,_ref;response=JSON.parse(xhr.responseText);_this.setFormError((_ref=response.errors)!=null?_ref.join(\", \"):void 0);return typeof cb===\"function\"?cb():void 0}})},doRedirect:function(cb){var _ref,_this=this;if(z.app.account.isLoggedIn()){if(((_ref=this.querystring)!=null?_ref.next:void 0)!=null){return z.useful.goto(decodeURI(this.querystring.next))}else if(this.recipe){return this.recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{return Backbone.history.navigate(\"/app/dashboard\",{trigger:true})}}},refreshChrome:function(cb){z.useful.refreshChrome();return typeof cb===\"function\"?cb():void 0},submitForm:function(){var _this=this;this.resetFormError();if(this.form.isValid()){return async.series([this.createAccount,this.refreshChrome,this.doRedirect],function(err,results){})}else{return this.setFormError(\"Please double-check the form is complete and valid.\")}},signUpFields:function(){return[{key:\"email\",label:\"Email\",placeholder:\"You'll use this to login...\",type:\"unicode\",required:true,validator:function(model,collection){var data,email;data=collection.getValues();email=data.email||\"\";return/\\S+@\\S+\\.\\S+/.test(email)}},{key:\"first_name\",label:\"First Name\",placeholder:\"What your mother calls you...\",type:\"unicode\",required:true},{key:\"last_name\",label:\"Last Name\",placeholder:\"What your army buddies call you...\",type:\"unicode\",required:true},{key:\"password1\",label:\"Password\",placeholder:\"Be sure to keep this private...\",type:\"password\",required:true},{key:\"terms\",label:\"Terms of Service\",type:\"checkbox\",required:true,help_text_html:'I agree to Zapier\\'s <a href=\"/terms\" target=\"_new\">Terms of Service</a>'},{key:\"updates\",label:\"Get Zapier Updates\",type:\"checkbox\",required:false,\"default\":true,help_text:\"Receive 1 weekly email about new services, triggers and actions available on Zapier.\"}]},render:function(){this.$el.html(JST.signup_form({}));this.form=new z.model.FormSet(this.signUpFields());this.signupform=new z.ui.ParamForm({form:this.form});this.$(\"signupform\").replaceWith(this.signupform.render().el);return this}});z.ui.PersonaFormModal=z.ui.Base.extend({className:\"persona-modal\",events:{submit:\"submitPersona\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={};context.personas=z.useful.equalChunks(PERSONAS||[],2);context.first_personas=context.personas[0];context.second_personas=context.personas[1];return context},render:function(){this.$el.html(JST.signup_persona_modal(this.context()));return this},submitPersona:function(ev){var personas;if(ev!=null)ev.preventDefault();z.store.set(\"showPersonaModal\",null);personas=_.map($(\".persona-modal :checked\").get(),function(persona){return persona.value}).join(\",\");z.app.account.save({personas:personas});return this.modal.close()}});z.ui.ExtraSettings=z.ui.Base.extend({events:{\"click .advanced\":\"advanced\",\"click .close\":\"close\"},initialize:function(){return _.bindAll(this)},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.settings_extra(this.context()));return this},advanced:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"disable_ssl_check\",label:\"Disable SSL Certificate Checks?\",help_text_html:'Only disable this if you\\'re experiencing problems and understand the risks in doing so. <a href=\"https://zapier.com/blog/2013/04/09/ssl-certificates-and-zapier/\" target=\"_new\">Learn more here</a>.',type:\"unicode\",choices:[\"no\",\"yes\"],required:false,value:z.app.account.get(\"disable_ssl_check\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},close:function(e){var fields,form,modal,save;if(e!=null)e.preventDefault();fields=[{key:\"word\",label:\"Confirm Delete\",help_text:'Confirm you really want to permanently delete your account by typing \"DELETE\" in all caps below.',type:\"unicode\",required:true,validator:function(model,collection){var data;data=collection.getValues();return data.word===\"DELETE\"}},{key:\"password\",label:\"Verify Current Password\",help_text:\"Verify your current password to delete your account.\",type:\"password\",required:true}];form=new z.model.FormSet(fields);save=function(values){var _this=this;if(values.word!==\"DELETE\"){this.saveError.call(this,this,{responseText:\"Confirmation word did not match.\"});return}return z.app.account.destroy({wait:true,data:JSON.stringify({password:values.password}),success:function(){return z.useful.goto(\"/\")},error:this.saveError})};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,button:\"Delete Account\",title:\"Permanently Delete Account and Data\"})})}});z.ui.Auths=z.ui.Base.extend({events:{\"click button.test\":\"test\",\"click button.reconnect\":\"replace\",\"click button.rename\":\"rename\",\"click button.disconnect\":\"delete\"},initialize:function(options){var render,_this=this;this.options=options;_.bindAll(this);render=_.debounce(this.render,40);z.app.auths.on(\"change add remove reset\",render,this);z.app.services.on(\"change add remove reset\",render,this);this.on(\"remove\",function(){return _this.$(\"select\").off(\"change\",_this.selectChange)});if(this.options.addService!=null){if(parseInt(this.options.addService)){return this.replaceAuth(this.options.addService)}else{return this.addAuth(this.options.addService)}}},context:function(){var auths,context,services,_this=this;this.applyCounts();auths=z.app.auths.toJSON();auths=z.app.auths.map(function(each){var auth,d;auth=each.toJSON();auth[\"name\"]=each.getName();d=new Date(auth[\"date\"]);auth[\"prettyDate\"]=[d.getMonth()+1,d.getDate(),d.getFullYear()].join(\"/\");return auth});services=z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.needsAuth())return false;return true});context={auths:auths,services:services};return context},render:function(){this.$el.html(JST.settings_auths(this.context()));this.$(\"select\").select2({containerCssClass:\"select2-auths-service\",dropdownCssClass:\"select2-auths-service wide right\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcher,allowClear:true});this.$(\"select\").off(\"change\",this.selectChange);this.$(\"select\").on(\"change\",this.selectChange);return this},selectChange:function(e){var key,which;key=this.$(e.currentTarget).val();which=this.$(e.currentTarget).attr(\"data-which\");this.$(e.currentTarget).select2(\"val\",\"\");if(which===\"add\")this.addAuth(key);if(which===\"request\")return this.requestAuth(key)},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);icon=service.getImageClass(\"32x32\");name=service.getName();icon=_.escape(icon);name=_.escape(name);html='<i class=\"img32 '+icon+'\"></i> <t>'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},applyCounts:function(){var _this=this;return z.app.auths.each(function(auth){var count;count=0;z.app.reads.each(function(read){var write,_ref;write=z.app.writes.get((_ref=read.get(\"write_ids\"))!=null?_ref[0]:void 0);if(read.get(\"authentication_id\")===auth.get(\"id\")||(write!=null?write.get(\"authentication_id\"):void 0)===auth.get(\"id\")){return count+=1}});return auth.set({used:count})})},addAuth:function(key){var context,modal,service,success,_this=this;service=z.app.services.get(key);success=function(auth){return _this.render()};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},requestAuth:function(key){var context,modal,service,success,_this=this;service=z.app.services.get(key);success=function(auth){return _this.render()};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthRequestModal(context)})},replaceAuth:function(oldAuthId){var context,modal,oldAuth,service,success,_this=this;oldAuth=z.app.auths.get(oldAuthId);if(!oldAuth)return;success=function(newAuth){return oldAuth.swap(newAuth.id,{success:function(model,resp){return async.parallel({reads:function(cb){return z.app.reads.fetch({cache:false,reset:true,success:cb})},writes:function(cb){return z.app.writes.fetch({cache:false,reset:true,success:cb})}},function(err,results){return _this.render()})}})};service=z.app.services.get(oldAuth.get(\"selected_api\"));context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},replace:function(e){var $el,id;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);id=$el.attr(\"data-id\");return this.replaceAuth(id)},rename:function(e){var $el,auth,id,modal,save,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);id=$el.attr(\"data-id\");auth=z.app.auths.get(id);save=function(value){return auth.save({title:value})};return modal=new z.ui.Modal({view:new z.ui.RenameModal({value:auth.get(\"title\"),save:save})})},\"delete\":function(e){var $el,auth,id,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.text()===\"Really?\"){id=$el.attr(\"data-id\");auth=z.app.auths.get(id);this.$(\"tr[data-id=\"+id+\"]\").addClass(\"destroying\");return this.$(\"tr[data-id=\"+id+\"]\").fadeOut(400,function(){return auth.destroy()})}else{this.$(e.currentTarget).text(\"Really?\").addClass(\"orange\");return _.delay(function(){var _ref;return(_ref=_this.$(e.currentTarget))!=null?_ref.text(\"Disconnect\").removeClass(\"orange\"):void 0},3e3)}},test:function(e){var $el,auth,id,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.text()===\"Testing...\")return;id=$el.attr(\"data-id\");auth=z.app.auths.get(id);$el.text(\"Testing...\").removeClass(\"success error\");return auth.test({success:function(model,resp){return $el.text(\"Connected!\").addClass(\"success\").attr(\"disabled\",true)},error:function(model,xhr){var context,errors,modal;$el.text(\"error!\").addClass(\"error\");errors=z.useful.errors(xhr);context={auth:auth,message:errors,type:\"manual\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context)})}})}});z.ui.PlanSelect=z.ui.Base.extend({events:{\"click .toggle-interval .switch\":\"switch\",\"click .toggle-interval .toggle-container\":\"toggle\",\"click button.change-plan\":\"changePlan\",\"click .coupon-form button\":\"useCoupon\",\"click .add-card\":\"addCard\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);return this.variant=((_ref=z.app.account.getCurrentPlan())!=null?_ref.get(\"interval\"):void 0)||\"month\"},context:function(){var context,_ref,_ref2,_ref3,_this=this;context={account:z.app.account,services:z.app.services,monthly:this.variant===\"month\",billing:z.app.account.get(\"billing\"),provider:z.app.account.get(\"provider\"),showCoupon:(_ref=this.options)!=null?_ref.showCoupon:void 0,coupon:this.couponDescription((_ref2=z.app.account.get(\"billing\"))!=null?(_ref3=_ref2.discount)!=null?_ref3.coupon:void 0:void 0),cached_coupon:z.app.account.get(\"cached_coupon\"),plans:z.app.plans.getIntervalPlans(this.variant).map(function(plan){plan.current=plan.get(\"current_plan\");plan.buttonText=\"Switch to this plan\";return plan})};return context},toggle:function(e){var t;t=this.$(e.currentTarget);if(t.hasClass(\"on\")){this.variant=\"month\"}else{this.variant=\"year\"}t.toggleClass(\"on\");return this.render()},\"switch\":function(e){var t;if(e!=null)e.preventDefault();t=this.$(e.currentTarget);t.parent().toggleClass(\"on\");this.variant=t.attr(\"data-pricing-interval\");return this.render()},changePlan:function(e){var changePlanWhy,done,el,error,isFree,lessCostly,oldText,plan,planId,sameInterval,_ref,_ref2,_this=this;if(e!=null)e.preventDefault();el=this.$(e.currentTarget);oldText=el.text();planId=el.attr(\"data-change-plan\");plan=z.app.plans.get(planId);lessCostly=plan.dollarsMo()<((_ref=z.app.account.getCurrentPlan())!=null?_ref.dollarsMo():void 0);sameInterval=plan.get(\"interval\")===((_ref2=z.app.account.getCurrentPlan())!=null?_ref2.get(\"interval\"):void 0);isFree=plan.isFree();if(el.hasClass(\"confirm\")){done=function(){_.defer(_this.render);if(_this.downgradeModal)return _this.downgradeModal.close()};error=function(model,xhr){var errors;errors=z.useful.errors(xhr);if(_this.downgradeModal)_this.downgradeModal.close();return _this.errorModal=new z.ui.Modal({view:errors+' You can update your credit card <a href=\"/app/settings/card\" data-nav=\"app/settings/card\">here</a>.'})};changePlanWhy=function(why){if(why==null)why=null;return z.app.account.switchPlan(planId,null,why,{success:done,error:error})};clearInterval(this.changeTimeout);el.attr(\"disabled\",true);el.text(oldText);if(lessCostly&&(sameInterval||isFree)){return this.downgradeModal=new z.ui.Modal({close:function(){return _this.render()},view:new z.ui.DowngradeModal({save:function(values){var why;why=\"\";_.each(values,function(value,key){if(value&&_.isBoolean(value)){return why+=\"Checked: \"+key+\"\\n\"}});if(values.comments)why+=\"Comments: \"+values.comments;return changePlanWhy(why)}})})}else{return changePlanWhy(null)}}else{this.changeTimeout=setTimeout(function(){el.text(oldText);return el.removeClass(\"confirm\")},3e3);el.text(\"Are you sure?\");return el.addClass(\"confirm\")}},useCoupon:function(e){var coupon,el,error,planId,success,_this=this;if(e!=null)e.preventDefault();el=this.$(e.currentTarget);el.addClass(\"disabled\");el.text(\"Working...\");planId=z.app.account.get(\"plan_id\");coupon=this.$(\"input.coupon-code\").val()||null;success=function(resp){var s;s=function(){_this.render();_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"success\");_this.$(\".coupon-form .feedback\").text(\"Coupon added: \"+resp.description);_this.$(\".coupon-form input\").val(\"\");el.text(\"Use Coupon\");return el.removeClass(\"disabled\")};e=function(){_this.render();_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"error\");_this.$(\".coupon-form .feedback\").text(\"Coupon is valid but could not apply.\");el.text(\"Use Coupon\");return el.removeClass(\"disabled\")};return z.app.account.switchPlan(planId,coupon,null,{success:s,error:e})};error=function(xhr){_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"error\");_this.$(\".coupon-form .feedback\").text(\"Coupon does not exist.\");el.removeClass(\"disabled\");return el.text(\"Use Coupon\")};return z.app.account.checkCoupon(coupon,{success:success,error:error})},sizeTable:function(){return this.$(\".overflow-container\").css({maxWidth:$(\"body\").width()})},render:function(){var context;context=this.context();this.$el.html(JST.settings_plans(context));this.sizeTable();return this},couponDescription:function(coupon){var desc;if(coupon!=null?coupon.amount_off:void 0){desc=\"$\"+coupon.amount_off/100+\" off\"}else if(coupon!=null?coupon.percent_off:void 0){desc=coupon.percent_off+\"% off\"}if((coupon!=null?coupon.duration:void 0)===\"repeating\"){desc=desc+\" for \"+(coupon!=null?coupon.duration_in_months:void 0)+\" months\"}else if((coupon!=null?coupon.duration:void 0)===\"once\"){desc=desc+\" for 1 month\"}else if((coupon!=null?coupon.duration:void 0)===\"forever\"){desc=desc+\" forever\"}return desc},addCard:function(e){var $el,card,cleanMonth,context,fields,form,html,joinPlan,mochoices,modal,now,planId,save,validateCard,validateCvc,validateExp,year,yearchoices,_ref,_ref2,_this=this;if(e!=null)e.preventDefault();card=(_ref=z.app.account.get(\"billing\"))!=null?_ref.active_card:void 0;context={};if(card!=null){context={type:card.type,last4:card.last4,expM:card.exp_month,expY:card.exp_year}}html=JST.settings_card(context);mochoices=[\"Jan (01)\",\"Feb (02)\",\"Mar (03)\",\"Apr (04)\",\"May (05)\",\"June (06)\",\"July (07)\",\"Aug (08)\",\"Sept (09)\",\"Oct (10)\",\"Nov (11)\",\"Dec (12)\"];yearchoices=[];now=(new Date).getFullYear();for(year=now,_ref2=now+13;now<=_ref2?year<=_ref2:year>=_ref2;now<=_ref2?year++:year--){yearchoices.push(String(year))}cleanMonth=function(month){var _ref3;return month!=null?(_ref3=month.match(/\\(([^\\)]+)\\)/))!=null?_ref3[1]:void 0:void 0};validateExp=function(model,collection){var month,_ref3,_ref4,_ref5,_ref6;month=cleanMonth((_ref3=collection.where({key:\"expmo\"}))!=null?(_ref4=_ref3[0])!=null?typeof _ref4.get===\"function\"?_ref4.get(\"value\"):void 0:void 0:void 0);year=(_ref5=collection.where({key:\"expyear\"}))!=null?(_ref6=_ref5[0])!=null?typeof _ref6.get===\"function\"?_ref6.get(\"value\"):void 0:void 0:void 0;return z.stripe.validateExpiry(month||\"0\",year||\"3000\")};validateCard=function(model,collection){return z.stripe.validateCardNumber(model.get(\"value\"))};validateCvc=function(model,collection){return z.stripe.validateCVC(model.get(\"value\"))};fields=[{key:\"name\",label:\"Cardholder Name\",help_text:\"Full name on the card.\",type:\"unicode\",required:true},{key:\"cardnumber\",label:\"Card Number\",type:\"unicode\",required:true,validator:validateCard},{key:\"expmo\",label:\"Month\",required:true,type:\"select\",choices:mochoices,validator:validateExp},{key:\"expyear\",label:\"Year\",required:true,type:\"select\",choices:yearchoices,validator:validateExp},{key:\"cvc\",label:\"CVC\",type:\"unicode\",required:true,validator:validateCvc}];form=new z.model.FormSet(fields);$el=this.$(e.currentTarget);planId=$el.attr(\"data-change-plan\");joinPlan=function(){var done;done=function(){return _.defer(_this.render)};$el.html(\"Upgrading...\");return z.app.account.switchPlan(planId,null,null,{success:done,error:done})};save=function(values){var error,stripeHandler,success,_this=this;success=this.saveSuccess;error=this.saveError;stripeHandler=function(status,response){var token;if(response.error){return error.call(_this,_this,{responseText:response.error.message})}else{token=response.id;return z.app.account.saveCard(token,{success:function(){joinPlan(e);return success.apply(this,arguments)},error:error})}};return z.stripe.createToken({name:values.name,number:values.cardnumber,cvc:values.cvc,exp_month:cleanMonth(values.expmo),exp_year:values.expyear},stripeHandler)};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({button:\"Save card and upgrade\",form:form,save:save})})}});z.ui.DowngradeModal=z.ui.Base.extend({className:\"settings-changer downgrade\",events:{\"click button.submit\":\"submit\",keyup:\"submit\"},initialize:function(options){var fields,requireOne,_ref;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}this.setMode(\"not\",\"saving\");requireOne=function(field,form){var val,_this=this;val=form.any(function(field){return field.get(\"value\")});return val};fields=[{label:\"Let us know why you are downgrading.\",help_text:\"Don't have the budget.\",key:\"Don't have the budget.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Only needed it for a short time.\",key:\"Only needed it for a short time.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Doesn't do what I need.\",key:\"Doesn't do what I need.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Stopped using the trigger/action service.\",key:\"Stopped using the trigger/action service.\",type:\"checkbox\",required:false,validator:requireOne},{key:\"comments\",label:\"Comments?\",help_text:\"We are a small team and details help us improve the product, so every little bit helps!\",type:\"text\",required:false,validator:requireOne}];return this.form=new z.model.FormSet(fields)},context:function(){var context;context={button:\"Downgrade my account\"};return context},render:function(){var view;this.$el.html(JST.settings_settings_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.form});this.$paramform.html(view.render().el);return this},submit:function(e){var _ref;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"is\",\"saving\"))return;if(!((_ref=this.form)!=null?_ref.isValid():void 0)){return this.$(\".feedback\").html(\"We're a small team here at Zapier and would really appreciate your feedback, double check you filled out the required field above. Thank you!\").addClass(\"error\")}else{this.$(\".feedback\").html(\"\").removeClass(\"error\")}this.setMode(\"is\",\"saving\");this.$(\"button\").attr(\"disabled\",\"true\").text(\"Downgrading...\");return this.save(this.form.getValues())},save:function(values){return log(\"to be overwritten\")}});z.ui.Invoices=z.ui.Base.extend({events:{\"click .details\":\"toggleDetails\"},initialize:function(){_.bindAll(this);z.app.account.on(\"change\",this.render,this);return z.app.invoices.on(\"change reset\",this.render,this)},context:function(){var context,d,date,m,periodEnd,y,_ref,_ref2,_ref3,_ref4,_ref5,_ref6;context={};if(((_ref=z.app.account.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.current_period_end:void 0:void 0)!=null&&!((_ref3=z.app.account.get(\"billing\"))!=null?(_ref4=_ref3.subscription)!=null?_ref4.cancel_at_period_end:void 0:void 0)){periodEnd=(_ref5=z.app.account.get(\"billing\"))!=null?(_ref6=_ref5.subscription)!=null?_ref6.current_period_end:void 0:void 0;date=new Date(periodEnd*1e3);d=date.getDate();m=date.getMonth()+1;y=date.getFullYear();context.billing_period_start_date=\"\"+m+\"-\"+d+\"-\"+y}return context},render:function(){var $invoices,html,_this=this;this.$el.html(JST.settings_invoices(this.context()));$invoices=this.$(\"#invoices\");html=\"\";z.app.invoices.each(function(invoice){var json;json=invoice.toFancyJSON();json.cid=invoice.cid;return html+=JST.settings_invoice(json)});if(html!==\"\")$invoices.html(html);return this},toggleDetails:function(e){var id;if(e!=null)e.preventDefault();id=$(e.currentTarget).attr(\"id\");this.$(\".invoice-details\").hide();return this.$el.find(\"#\"+id+\".invoice-details\").toggle()}});z.ui.SettingsOverview=z.ui.Base.extend({initialize:function(){var render;_.bindAll(this);render=_.debounce(this.render,40);z.app.account.on(\"change\",render,this);return z.app.plans.on(\"change\",render,this)},context:function(){var context,_ref;context=z.app.account.toJSON();context.plan=(_ref=z.app.account.getCurrentPlan())!=null?_ref.toJSON():void 0;context.status=this.getStatus();return context},render:function(){this.$el.html(JST.settings_overview(this.context()));return this},getStatus:function(){if(z.app.account.get(\"is_unlimited\"))return\"Unlimited\";if(z.app.account.get(\"is_trialing\"))return\"Trialing\";if(z.app.account.get(\"plan_active\"))return\"Active\";return\"Inactive\"}});z.ui.MyAccountSettings=z.ui.Base.extend({events:{\"click .account\":\"account\",\"click .email\":\"email\",\"click .user\":\"user\",\"click .advanced\":\"advanced\",\"click .close\":\"close\",\"click .bonus\":\"bonus\",\"click .auth\":\"auth\"},CONFIRM_PASSWORD_FIELD:{key:\"password\",label:\"Verify Current Password\",help_text:\"Please enter your password to make changes to these settings.\",type:\"password\",required:true},initialize:function(){return _.bindAll(this)},context:function(){var context;context={account:z.app.account.attributes};return context},render:function(){this.$el.html(JST.settings_my_account(this.context()));return this},bonus:function(e){if(e!=null)e.preventDefault();return z.useful.goto(\"/rewards\")},auth:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/authorizations\",{trigger:true})},account:function(e){var emailConfirmField,fields,form,modal;if(e!=null)e.preventDefault();if(z.app.account.get(\"email_confirmed\")){emailConfirmField={label:\"Confirm Email Address\",help_text_html:'<i class=\"icon-check\"></i> Your email address is confirmed.',type:\"copy\",required:false}}else{emailConfirmField={label:\"Confirm Email Address\",help_text_html:'<button class=\"confirm-email light smaller\">Send confirmation email</button>',type:\"copy\",required:false}}fields=[{key:\"email\",label:\"Email Address\",help_text:\"Make sure you can receive email at this address.\",type:\"unicode\",required:false,value:z.app.account.get(\"email\")},emailConfirmField,{key:\"password1\",label:\"New Password\",help_text:\"Leave this blank if you don't want to change your password.\",type:\"password\",required:false},{key:\"password2\",label:\"Confirm New Password\",help_text:\"Leave this blank if you don't want to change your password.\",type:\"password\",required:false},this.CONFIRM_PASSWORD_FIELD];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},email:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"manage_email_settings\",label:\"Manage Email Settings\",help_text_html:'<a target=\"_new\" href=\"/subscription/opt-out/manage/\">Manage all email subscription settings</a>.',required:false,type:\"copy\"},{key:\"summary_schedule\",label:\"Summary Schedule\",help_text:\"Daily or weekly summary of the tasks Zapier has performed.\",type:\"unicode\",choices:\"weekly,daily,never\",required:false,\"default\":z.app.account.get(\"summary_schedule\")},{key:\"alert_triggers\",label:\"Send Alerts on Failed Trigger\",help_text:'The recommended setting is \"never\". \"Repeated\" means we will only alert you once after 5 errors in a 24 hour cycle.',type:\"unicode\",choices:\"never,repeated,always\",required:false,\"default\":z.app.account.get(\"alert_triggers\")},{key:\"alert_actions\",label:\"Send Alerts on Failed Action\",help_text:'The recommended setting is \"always\". \"Repeated\" means we will only alert you once after 5 errors in a 24 hour cycle.',type:\"unicode\",choices:\"never,repeated,always\",required:false,\"default\":z.app.account.get(\"alert_actions\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},user:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"first_name\",label:\"First Name\",type:\"unicode\",required:false,value:z.app.account.get(\"first_name\")},{key:\"last_name\",label:\"Last Name\",type:\"unicode\",required:false,value:z.app.account.get(\"last_name\")},{key:\"company_name\",label:\"Company Name/Billing Info\",help_text:\"Mostly used in invoices, but can help us identify accounts.\",type:\"text\",required:false,value:z.app.account.get(\"company_name\")},{label:\"Change Your Profile Picture\",help_text_html:'We use Gravatar, a service that associates an avatar image with your email address.<br /><a target=\"_new\" href=\"https://en.gravatar.com/site/login/\">Change your Gravatar here.</a>',type:\"copy\",required:false},{key:\"timezone\",label:\"Set Your Timezone\",help_text:\"In the event that a service does not pass datetimes with timezone information (when a Zap runs), we can use this setting.\",type:\"unicode\",choices:z.app.account.get(\"timezone_choices\"),required:false,\"default\":z.app.account.get(\"timezone\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},advanced:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"disable_ssl_check\",label:\"Disable SSL Certificate Checks?\",help_text_html:'Only disable this if you\\'re experiencing problems and understand the risks in doing so. <a href=\"https://zapier.com/blog/2013/04/09/ssl-certificates-and-zapier/\" target=\"_new\">Learn more here</a>.',type:\"unicode\",choices:[\"no\",\"yes\"],required:false,value:z.app.account.get(\"disable_ssl_check\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},close:function(e){var fields,form,modal,save;if(e!=null)e.preventDefault();fields=[{key:\"word\",label:\"Confirm Delete\",help_text:'Confirm you really want to permanently delete your account by typing \"DELETE\" in all caps below.',type:\"unicode\",required:true,validator:function(model,collection){var data;data=collection.getValues();return data.word===\"DELETE\"}},{key:\"password\",label:\"Verify Current Password\",help_text:\"Verify your current password to delete your account.\",type:\"password\",required:true}];form=new z.model.FormSet(fields);save=function(values){var _this=this;if(values.word!==\"DELETE\"){this.saveError.call(this,this,{responseText:\"Confirmation word did not match.\"});return}return z.app.account.destroy({wait:true,data:JSON.stringify({password:values.password}),success:function(){return z.useful.goto(\"/\")},error:this.saveError})};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,button:\"Delete Account\",title:\"Permanently Delete Account and Data\"})})}});z.ui.BillingSettings=z.ui.Base.extend({events:{\"click .plans\":\"plans\",\"click .card\":\"card\",\"click .invoice\":\"invoice\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);if((_ref=this.options)!=null?_ref.card:void 0)return this.card()},context:function(){var context,plan_name,plan_rate,_ref,_ref2,_ref3,_ref4,_this=this;plan_name=\"Here\";plan_rate=\"\";z.app.plans.getIntervalPlans(this.variant).map(function(plan){if(plan.get(\"current_plan\")){plan_name=plan.get(\"name\");return plan_rate=\"$\"+plan.dollarsMo()+\"/month\"}});context={plan_name:plan_name,plan_rate:plan_rate};context[\"last4\"]=(_ref=z.app.account.toJSON().billing)!=null?(_ref2=_ref.cards)!=null?(_ref3=_ref2.data)!=null?(_ref4=_ref3[0])!=null?_ref4.last4:void 0:void 0:void 0:void 0;return context},render:function(){this.$el.html(JST.settings_billing(this.context()));return this},plans:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/plans\",{trigger:true})},invoice:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/invoices\",{trigger:true})},card:function(e){var card,context,fields,form,html,modal,save,validateCard,validateCvc,validateExp,_ref,_ref2;if(e!=null)if(typeof e.preventDefault===\"function\")e.preventDefault();card=(_ref=z.app.account.get(\"billing\"))!=null?_ref.active_card:void 0;context={};if(card!=null){context={type:card.type,last4:card.last4,expM:card.exp_month,expY:card.exp_year}}html=JST.settings_card(context);validateExp=function(model,collection){var month,year,_ref2,_ref3,_ref4,_ref5;month=(_ref2=collection.where({key:\"expmo\"}))!=null?(_ref3=_ref2[0])!=null?typeof _ref3.get===\"function\"?_ref3.get(\"value\"):void 0:void 0:void 0;year=(_ref4=collection.where({key:\"expyear\"}))!=null?(_ref5=_ref4[0])!=null?typeof _ref5.get===\"function\"?_ref5.get(\"value\"):void 0:void 0:void 0;return z.stripe.validateExpiry(month||\"0\",year||\"3000\")};validateCard=function(model,collection){return z.stripe.validateCardNumber(model.get(\"value\"))};validateCvc=function(model,collection){return z.stripe.validateCVC(model.get(\"value\"))};fields=[{label:\"Card on File\",help_text_html:html,type:\"copy\",required:false},{key:\"name\",label:\"Cardholder Name\",help_text:\"Fill out the rest of the form if you'd like to update the credit card you have on file.\",type:\"unicode\",required:true},{key:\"cardnumber\",label:\"Card Number\",type:\"unicode\",required:true,validator:validateCard},{key:\"expmo\",label:\"Month\",required:true,type:\"select\",placeholder:\"MM\",validator:validateExp},{key:\"expyear\",label:\"Year\",required:true,type:\"select\",placeholder:\"YYYY\",validator:validateExp},{key:\"cvc\",label:\"CVC\",type:\"unicode\",required:true,validator:validateCvc}];form=new z.model.FormSet(fields);save=function(values){var stripeHandler,_this=this;stripeHandler=function(status,response){var token;\nif(response.error){return _this.saveError.call(_this,_this,{responseText:response.error.message})}else{token=response.id;return z.app.account.saveCard(token,{success:_this.saveSuccess,error:_this.saveError})}};return z.stripe.createToken({name:values.name,number:values.cardnumber,cvc:values.cvc,exp_month:values.expmo,exp_year:values.expyear},stripeHandler)};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,title:(_ref2=this.$(e!=null?e.currentTarget:void 0))!=null?_ref2.text():void 0})})}});z.ui.AccountSettingsModal=z.ui.Base.extend({className:\"settings-changer\",events:{\"click .confirm-email\":\"sendEmailConfirmation\",\"click button.submit\":\"submit\",keyup:\"submit\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}return this.setMode(\"not\",\"saving\")},context:function(){var context;context={button:this.options.button,title:this.options.title};return context},render:function(){var view;this.$el.html(JST.settings_settings_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.options.form});this.$paramform.html(view.render().el);return this},submit:function(e){var values;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"is\",\"saving\"))return;this.setMode(\"is\",\"saving\");this.$(\".feedback\").html(\"\").removeClass(\"error\");this.$(\"button\").text(\"Working...\");values=this.options.form.getValues();return this.save(values)},saveSuccess:function(model){var text;this.unsetHelpers();this.setMode(\"not\",\"saving\");text=this.options.button!=null?this.options.button:\"Save changes\";this.$(\"button\").text(text);return this.modal.close()},saveError:function(model,xhr){var errors,text;this.unsetHelpers();this.setMode(\"not\",\"saving\");errors=z.useful.errors(xhr);this.$(\".feedback\").html(errors).addClass(\"error\");text=this.options.button!=null?this.options.button:\"Save changes\";return this.$(\"button\").text(text)},save:function(values){return z.app.account.save(values,{success:this.saveSuccess,error:this.saveError,wait:true,patch:true})},sendEmailConfirmation:function(e){var error,success,_this=this;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).hasClass(\"success\"))return;success=function(model,resp){return _this.$(\".confirm-email\").addClass(\"success\").text(\"Sent! Check your email\")};error=function(model,xhr){return _this.$(\".confirm-email\").addClass(\"error\").text(\"Error sending confirmation email\")};return z.app.account.sendEmailConfirmation({success:success,error:error})},unsetHelpers:function(){z.app.account.unset(\"password\",{silent:true});z.app.account.unset(\"password1\",{silent:true});z.app.account.unset(\"password2\",{silent:true});return z.app.account.unset(\"coupon\",{silent:true})}});\n/*\n//@ sourceMappingURL=https://zapier.cachefly.net/static/CUEboR/build/app.js.map\n*/"
      },
      "https://zapier.cachefly.net/static/CUEw7C/build/app.js": {
         "pageUrl": "https://zapier.com/zapbook/dropbox/",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEw7C/build/app.js",
         "body": "window.z={};z.cfg={};z.model={};z.ui={};z.controllers={};z.app={};z.jst={};z.useful={};z.store={};z.tests=window.tests;z.cfg.api=\"/api/v2\";z.cfg.newapi=\"/api/v2\";z.cfg.devapi=\"/api/developer/v1\";z.cfg.devpath=\"developer/v2/builder\";if(typeof DEBUG!==\"undefined\"&&DEBUG!==null)z.cfg.debug=DEBUG;if(typeof mediaUrl!==\"undefined\"&&mediaUrl!==null){z.cfg.mediaURL=mediaUrl}if(typeof path!==\"undefined\"&&path!==null)z.cfg.path=path;z.cfg.hasPushState=window.history.pushState!=null;if(typeof STRIPE_PUB_API_KEY!==\"undefined\"&&STRIPE_PUB_API_KEY!==null){z.cfg.stripePubApiKey=STRIPE_PUB_API_KEY}z.cfg.pubSub={};_.extend(z.cfg.pubSub,Backbone.Events);if(typeof TITLE_APPEND!==\"undefined\"&&TITLE_APPEND!==null){z.cfg.title=TITLE_APPEND}z.cfg.cursorLoadAnimTimeout=0;z.cfg.location=window.location;z.cfg.defaultSupportTags=\"default\";z.useful.pluralize=typeof owl!==\"undefined\"&&owl!==null?owl.pluralize:void 0;z.cfg.userfillOTag=\"{{\";z.cfg.userfillETag=\"}}\";if(typeof PARTNER_ENVIRONMENT!==\"undefined\"&&PARTNER_ENVIRONMENT!==null){z.cfg.partner=PARTNER_ENVIRONMENT}window.$(document).ready(function(){var $el,csrfSafeMethod,invalidatePersist,loadModels,postSizeEvents,sameOrigin,start,track,url,_this=this;if(!$.cookie(\"csrftoken\")){$.ajax(\"\"+z.cfg.api+\"/csrf\",{success:function(){var csrf;csrf=$.cookie(\"csrftoken\");z.cfg.renderContext.csrf=csrf;return $('input[name=\"csrfmiddlewaretoken\"]',document).val(csrf)}})}csrfSafeMethod=function(method){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(method)};sameOrigin=function(url){var host,origin,protocol,sr_origin;host=document.location.host;protocol=document.location.protocol;sr_origin=\"//\"+host;origin=protocol+sr_origin;return url===origin||url.slice(0,origin.length+1)===origin+\"/\"||url===sr_origin||url.slice(0,sr_origin.length+1)===sr_origin+\"/\"||!/^(\\/\\/|http:|https:).*/.test(url)};window.$(document).ajaxSend(function(event,xhr,settings){if(!csrfSafeMethod(settings.type)&&sameOrigin(settings.url)){return xhr.setRequestHeader(\"X-CSRFToken\",$.cookie(\"csrftoken\"))}});_.extend(z.app,Backbone.Events);z.cfg.browser=window.BrowserDetect.browser;z.cfg.isMobile=window.mobilecheck(0);z.cfg.renderContext={mediaURL:z.cfg.mediaURL,csrf:$.cookie(\"csrftoken\"),path:z.cfg.path,devpath:z.cfg.devpath,tests:z.tests};_.mixin(_.str.exports());_.str.include(\"Underscore.string\",\"string\");z.stripe=window.Stripe;z.stripe.setPublishableKey(z.cfg.stripePubApiKey);_.templateSettings={interpolate:/\\{\\{(.+?)\\}\\}/g};if(window.JST!=null)z.jst=window.JST;z.useful.clipboard=window.ZeroClipboard;z.useful.clipboard.setDefaults({moviePath:\"\"+z.cfg.mediaURL+\"images/flash/ZeroClipboard.swf\",trustedOrigins:[window.location.protocol+\"//\"+window.location.host],hoverClass:\"hover\",activeClass:\"active\",allowScriptAccess:\"always\"});$(\"img.retina\").retina();$(\".video\").loadYoutubeVideo();$el=$(z.useful.render(JST.common_login_modal({}))).addClass(\"hide\");$el.appendTo($(\"body\"));if(typeof preload!==\"undefined\"&&preload!==null?preload.account:void 0){url=_.result(z.model.Account.prototype,\"url\");Backbone.cache.set(url,typeof preload!==\"undefined\"&&preload!==null?preload.account:void 0);url=_.result(z.model.AccountLimits.prototype,\"url\");Backbone.cache.set(url,typeof preload!==\"undefined\"&&preload!==null?preload.account.limits:void 0)}z.app.errorHandler=new z.model.ErrorHandler;z.app.track=new z.model.Track;z.app.simple=new z.controllers.Simple;z.app.home=new z.controllers.Home;z.app.server=new z.controllers.Server;z.app.dashboard=new z.controllers.Dashboard;z.app.editor=new z.controllers.Editor;z.app.explore=new z.controllers.Explore;z.app.pricing=new z.controllers.Pricing;z.app.signup=new z.controllers.SignUp;z.app.zapbook=new z.controllers.Zapbook;z.app.status=new z.controllers.Status;z.app.settings=new z.controllers.Settings;z.app.history=new z.controllers.History;z.app.support=new z.controllers.Support;z.app.sharedzaps=new z.controllers.SharedZaps;z.app.developer=new z.controllers.Developer;z.app.topbar=new z.ui.TopBar({el:$(\".topbar\")});z.app.viewport=new z.ui.Viewport({el:$(\"body\")});z.app.support.view=new z.ui.Support({el:$(\"#support\")});z.app.preloader=new z.ui.Preloader({el:$(\"#app\")});z.app.partner=new z.model.Partner(z.cfg.partner);window.partnerChecks(window.location.pathname);if(z.app.partner.isPartnerSession()){postSizeEvents=function(){return _.defer(function(){var e,_ref;if(z.app.partner.hasIframeJs){e={event:\"resize\",height:$(\"body\").outerHeight(),width:$(\"body\").outerWidth()};return(_ref=window.top)!=null?_ref.postMessage(JSON.stringify(e),\"*\"):void 0}})};z.app.on(\"render\",postSizeEvents)}loadModels=function(cb){var _this=this;return async.parallel({account:async.fetch(new z.model.Account),accountLimits:async.fetch(new z.model.AccountLimits)},function(err,models){_.extend(z.app,models);if(err!=null)log(\"error: \",err,models);if(z.app.account.id!=null){$(\"#header .logo a\").attr(\"data-nav\",\"app/dashboard\")}z.app.topbar.render();z.app.support.view.render();return typeof cb===\"function\"?cb():void 0})};invalidatePersist=function(cb){var _this=this;return Backbone.cache.lawnchair.get(\"user\",function(obj){var callback,id;id=obj!=null?obj.id:void 0;callback=function(){return cb()};if(z.app.account.id!=null&&id!=null&&z.app.account.id!==id){return async.parallel([function(cb){return Backbone.cache.clear(\"user\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/account\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/read\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/write\",cb,true)},function(cb){return Backbone.cache.clear(\"/api/v2/stream\",cb,true)}],function(err,results){return Backbone.cache.set(null,null,callback,false,{key:\"user\",id:z.app.account.id})})}else if(z.app.account.id!=null){return async.parallel([function(cb){return Backbone.cache.clear(\"user\",cb,true)}],function(err,results){return Backbone.cache.set(null,null,callback,false,{key:\"user\",id:z.app.account.id})})}else{return typeof cb===\"function\"?cb():void 0}},true)};start=function(cb){var found;found=Backbone.history.start({hashChange:false,pushState:true,root:\"/\"});log(\"global environment `z`: \",z);if(!found&&_.str.startsWith(Backbone.history.fragment,\"app/\")){z.useful.goto(\"/404\")}return typeof cb===\"function\"?cb():void 0};track=function(cb){var cookie,count,haystack,name,referrer,route;haystack=window.location.pathname;referrer=document.referrer;name=\"zapier-visit\";cookie=z.store.get(name);if(!(cookie!=null)){z.store.set(name,\"true\");z.app.track[\"new\"](\"Visit Zapier (all)\",{referrer:referrer})}name=\"zapier-landing\";cookie=z.store.get(name);if(!(cookie!=null)){count=haystack.split(\"/\").length-1;if(count===0){route=\"home\"}else if(count===1){route=\"home\"}else if(_.str.include(haystack,\"zapbook\")&&count===2){route=\"zb no service\"}else if(_.str.include(haystack,\"zapbook\")&&count===3){route=\"zb one service\"}else if(_.str.include(haystack,\"zapbook\")&&count===4){route=\"zb two service\"}else if(_.str.include(haystack,\"zapbook\")&&count===5){route=\"zb recipe\"}else if(_.str.include(haystack,\"zapbook\")&&count===6){route=\"zb recipe\"}else{route=\"other\"}if(route!=null){z.store.set(name,\"true\");return z.app.track[\"new\"](\"Landing Page: \"+route,{path:haystack,referrer:referrer})}}};return async.series([loadModels,invalidatePersist,start,track])});var $,methods;$=jQuery;methods={insert:function(value){var after,before,o,pos;o=this[0];pos=methods[\"getCaretPosition\"].apply(this);before=o.value.substring(0,pos);after=o.value.substring(pos,o.value.length);$(o).val(before+value+after);pos+=value.length;methods[\"setCaretPosition\"].apply(this,[pos]);return pos},getCaretPosition:function(){var caretPos,o,sel;o=this[0];caretPos=0;if(document.selection){o.focus();sel=document.selection.createRange();sel.moveStart(\"character\",-o.value.length);caretPos=sel.text.length}else if(o.selectionStart||o.selectionStart===\"0\"){caretPos=o.selectionStart}return caretPos},setCaretPosition:function(pos){var f,o,_this=this;o=this[0];if(o.setSelectionRange){o.focus();return o.setSelectionRange(pos,pos)}else if(o.createTextRange){f=function(){return o.focus()};setTimeout(f,10);f=function(o,pos){var range;range=o.createTextRange();range.collapse(true);range.moveEnd(\"character\",pos);range.moveStart(\"character\",pos);return range.select()};setTimeout(function(){return f(o,pos)},20);return pos}}};$.fn.atCaret=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method===\"object\"||!method){return methods.init.apply(this,arguments)}else{return $.error(\"Method \"+method+\" does not exist on jQuery.atCaret\")}};z.store={length:function(){return window.localStorage.length},remove:_.bind(window.localStorage.removeItem,window.localStorage),clear:_.bind(window.localStorage.clear,window.localStorage),get:function(key){var expire,getItem,item,val;getItem=_.bind(window.localStorage.getItem,window.localStorage);item=getItem(key);try{item=JSON.parse(item);expire=item[0];try{val=JSON.parse(item[1])}catch(e){val=val}if(expire<(new Date).getTime()){val=null;z.store.remove(key)}}catch(e){val=null}return val},set:function(key,val,options){var expire,setItem;if(options==null)options={};expire=options!=null?options.expire:void 0;if(!(expire!=null))expire=1e3*60*60*24*365*100;expire+=(new Date).getTime();if(_.isObject(val))val=JSON.stringify(val);setItem=_.bind(window.localStorage.setItem,window.localStorage);return setItem(key,JSON.stringify([expire,val]))}};var getValue,indexedDBValid,methodMap,_this=this;if(!((typeof Backbone!==\"undefined\"&&Backbone!==null?Backbone.sync:void 0)!=null)){throw\"Backbone not ready yet\"}Backbone.cache={};Backbone.cache.store={};Backbone.cache.queue={};Backbone.cache.pending={};Backbone.cache.persistPending=0;Backbone.cache.lawnchair=new Lawnchair({},function(){});indexedDBValid=function(callback){var idb,request;idb=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB;if(!idb)return callback(false);if(!idb)return callback(false);request=idb.open(\"test\",3);request.onsucess=function(){return callback(true)};return request.onerror=function(){return callback(false)}};indexedDBValid(function(valid){var adapters;if(!valid){log(\"* Falling back to not using indexed-db adapater (is not available)\");adapters=_.filter(Lawnchair.adapters,function(adpt){return adpt.adapter!==\"indexed-db\"});adapters=_.map(adapters,function(adpt){return adpt.adapter});return Backbone.cache.lawnchair=new Lawnchair({adapter:adapters},function(){})}});_.extend(Backbone.cache,Backbone.Events);Backbone.cache.defaults={expiry:10*60*1e3};Backbone.cache.sync=Backbone.sync;methodMap={create:\"POST\",update:\"PUT\",\"delete\":\"DELETE\",read:\"GET\",patch:\"PATCH\"};getValue=function(object,prop){if(!(object!=null)||!(object[prop]!=null))return null;if(_.isFunction(object[prop]))return object[prop]();return object[prop]};Backbone.cache.set=function(key,resp,cb,noPersist,json){var error,message;if(noPersist==null)noPersist=false;if(json==null)json=null;key=_.str.trim(key);if(!(json!=null)){json={key:key,resp:resp}}if(key!=null)Backbone.cache.store[key]=json;try{if(!noPersist)return Backbone.cache.lawnchair.save(json,cb)}catch(e){message=\"CAUGHT: \"+e;error={message:message,url:window.path,linenumber:null,trace:null};return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:error}),url:z.cfg.api+\"/events/errors\",contentType:\"application/json\",dataType:\"json\"})}};Backbone.cache.get=function(key,cb,persist){key=_.str.trim(key);if(persist){if(key===\"all\"){return Backbone.cache.lawnchair.all(cb)}else{return Backbone.cache.lawnchair.get(key,cb)}}else{if(key===\"all\"){return typeof cb===\"function\"?cb(Backbone.cache.store):void 0}else{return typeof cb===\"function\"?cb(Backbone.cache.store[key]):void 0}}};Backbone.cache.clear=function(key,cb,persist,loose){if(loose==null)loose=true;key=_.str.trim(key);return Backbone.cache.get(\"all\",function(all){var deletes,filtered,item,_i,_len,_this=this;filtered=_.filter(all,function(item){if(loose){return _.str.include(item!=null?item.key:void 0,key)}else{return(item!=null?item.key:void 0)===key}});deletes=[];for(_i=0,_len=filtered.length;_i<_len;_i++){item=filtered[_i];deletes.push(function(cb){return Backbone.cache.lawnchair.remove(item.key,cb)});delete Backbone.cache.store[item.key]}return async.parallel(deletes,function(err,results){return typeof cb===\"function\"?cb():void 0})},persist)};Backbone.sync=function(method,model,options){var bc,cUrl,clearing,copyOptions,loose,type,url,_ref;if(options==null)options={};copyOptions=_.clone(options);type=methodMap[method];url=options.url!=null?options.url:getValue(model,\"url\");loose=options.loose;if(type===\"GET\"&&url!=null&&(options!=null?options.data:void 0)!=null&&!_.isEmpty(options!=null?options.data:void 0)){url+=_.str.include(url,\"?\")?\"&\":\"?\";url+=$.param(options.data)}if(options.cache===false||_.contains([\"PUT\",\"POST\",\"PATCH\",\"DELETE\"],type)){if(!options.persist){clearing=true;bc=options.cache===false?\"cache=false\":type;log(\"  clearing cache b/c \"+bc,url);if(url!=null)Backbone.cache.clear(url,null,null,loose);if(_.contains([\"DELETE\",\"PUT\"],type)&&(model!=null?(_ref=model.collection)!=null?_ref.url:void 0:void 0)!=null){cUrl=getValue(model.collection,\"url\");log(\"  also clearing cache b/c coll\",cUrl);Backbone.cache.clear(cUrl,null,null,loose)}if(options.cache!=null)delete options.cache}}return Backbone.cache.get(url,function(obj){var error,pending,queue,success,_ref2,_this=this;if(_.contains([\"GET\"],type)){if(obj!=null&&!clearing){log(\"+ from cache:\",url);options.success(model,obj.resp,options);if(options.persist){_.defer(function(){log(\"~ backgrounding real request\",url);copyOptions.cache=true;copyOptions.persist=false;copyOptions.update=true;copyOptions.success=function(){log(\"~~ background synced\",url);Backbone.cache.persistPending-=1;if(Backbone.cache.persistPending===0){return Backbone.cache.trigger(\"synced\")}};copyOptions.error=function(){Backbone.cache.persistPending-=1;if(Backbone.cache.persistPending===0){return Backbone.cache.trigger(\"synced\")}};Backbone.cache.persistPending+=1;if(Backbone.cache.persistPending===1){Backbone.cache.trigger(\"syncing\")}copyOptions.headers=_.extend({},copyOptions!=null?copyOptions.headers:void 0,{\"X-Can-304\":true});return model.fetch(copyOptions)})}model.trigger(\"sync\",model,obj.resp,options);return}if((pending=Backbone.cache.pending[url])!=null){pending.unshift({method:method,model:model,options:options});return}success=options!=null?options.success:void 0;options.success=function(model,resp,opts){var item,_ref2,_ref3;Backbone.cache.set(url,resp,function(){},model.noPersist);opts.success=success;pending=(_ref2=Backbone.cache.pending[url])!=null?_ref2:[{method:method,model:model,options:opts}];_.each(pending,function(item){var _base;return typeof(_base=item.options).success===\"function\"?_base.success(item.model,resp,item.options):void 0});delete Backbone.cache.pending[url];item=(_ref3=Backbone.cache.queue[url])!=null?_ref3.shift():void 0;if(item!=null){model.set(item.json);return Backbone.sync(method,model,item.options)}};error=options!=null?options.error:void 0;options.error=function(model,resp,opts){var item,_ref2,_ref3;opts.error=error;pending=(_ref2=Backbone.cache.pending[url])!=null?_ref2:[{method:method,model:model,options:opts}];_.each(pending,function(item){var _base;return typeof(_base=item.options).error===\"function\"?_base.error(item.model,resp,item.options):void 0});delete Backbone.cache.pending[url];item=(_ref3=Backbone.cache.queue[url])!=null?_ref3.shift():void 0;if(item!=null){model.set(item.json);return Backbone.sync(method,model,item.options)}}}if(_.contains([\"PUT\"],type)){if((pending=Backbone.cache.pending[url])!=null){queue=(_ref2=Backbone.cache.queue[url])!=null?_ref2:[];queue.push({options:options,json:model.toJSON()});Backbone.cache.queue[url]=queue;log(\"? locking request for later\",url);return}}log(\"- \"+type+\" request:\",url);return Backbone.cache.sync(method,model,options)},options!=null?options.persist:void 0)};_.mixin({compactObject:function(obj){_.each(obj,function(v,k){if(!v)return delete obj[k]});return obj},superHumanize:function(string){var humanize,out,subs,words;humanize=function(str){return _.str.capitalize(_.str.underscored(str).replace(/_/g,\" \"))};out=_.str.titleize(humanize(string));words=_.str.words(out);subs={Url:\"URL\",Uri:\"URI\",Html:\"HTML\",Id:\"ID\",id:\"ID\"};_.each(subs,function(v,k){var index;index=words.indexOf(k);if(index!==-1)return words[index]=v});return words.join(\" \")},wordenshtein:function(str1,str2){str1=str1.toLowerCase().replace(/[^\\w ]/g,\" \");str1=_.str.words(str1).sort().join(\" \");str2=str2.toLowerCase().replace(/[^\\w ]/g,\" \");str2=_.str.words(str2).sort().join(\" \");return _.str.levenshtein(str1,str2)},flattenObj:function(input,splitter){var flatObject,k,output,x;if(splitter==null)splitter=\"__\";output={};for(k in input){if(!input.hasOwnProperty(k))continue;if(typeof input[k]===\"object\"){flatObject=this.flattenObj(input[k],splitter);for(x in flatObject){if(!flatObject.hasOwnProperty(x))continue;output[k+splitter+x]=flatObject[x]}}else{output[k]=input[k]}}return output},unflatten:function(input,splitter){var k,key,output,part,parts,t;if(splitter==null)splitter=\"__\";output={};for(k in input){t=output;parts=k.split(splitter);key=parts.pop();while(parts.length){part=parts.shift();t=t[part]=t[part]||{}}t[key]=input[k]}return output}});var $;$=jQuery;$.fn.extend({setMode:function(state,group){var mode,re;group=group||\"mode\";re=new RegExp(\"\\\\w+_\"+group+\"(\\\\s|$)\",\"g\");mode=!(state!=null)?\"\":state+\"_\"+group;this.each(function(){return this.className=(this.className.replace(re,\"\")+\" \"+mode).replace(/\\s\\s/g,\" \")});return mode},hasMode:function(state,group){var has,mode,re;group=group||\"mode\";re=new RegExp(\"\\\\w+_\"+group+\"(\\\\s|$)\",\"g\");mode=!(state!=null)?\"\":state+\"_\"+group;has=$(this).hasClass(mode);return has}});$.fn.retina=function(retina_part){var settings;settings={retina_part:\"@2x\"};if(retina_part){jQuery.extend(settings,{retina_part:retina_part})}if(window.devicePixelRatio>=2){this.each(function(index,el){var checkForRetina,new_image_src;el=$(el);if(!el.attr(\"src\"))return;checkForRetina=new RegExp(\"(.+)(\"+settings[\"retina_part\"]+\"\\\\.\\\\w{3,4})\");if(checkForRetina.test(el.attr(\"src\")))return;new_image_src=el.attr(\"src\").replace(/(.+)(\\.\\w{3,4})$/,\"$1\"+settings[\"retina_part\"]+\"$2\");return $.ajax({url:new_image_src,type:\"HEAD\",success:function(){el.attr(\"height\",el.height());el.attr(\"width\",el.width());return el.attr(\"src\",new_image_src)}})})}return this};$.fn.loadYoutubeVideo=function(){var t,youtubeId;t=$(this);youtubeId=t.attr(\"data-youtubeid\");t.on(\"click\",function(){t.removeClass(\"video\");return t.html('<iframe class=\"\" width=\"460\" height=\"259\" src=\"https://www.youtube.com/embed/'+youtubeId+'?rel=0&amp;wmode=transparent&amp;showinfo=0&amp;theme=light&amp;autohide=1&amp;autoplay=1\" frameborder=\"0\" allowfullscreen></iframe>')});return this};var __slice=Array.prototype.slice;Handlebars.registerHelper(\"render\",function(templateString,options){var c,rendered;if(!(templateString!=null))return;c=_.extend({},options!=null?options.hash:void 0,options!=null?options.hash.context:void 0);rendered=Handlebars.compile(templateString)(c);return rendered});Handlebars.registerHelper(\"JST\",function(name,options){var rendered,_ref;rendered=JST[name](options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0);return new Handlebars.SafeString(rendered)});Handlebars.registerHelper(\"slugify\",function(string){return _.str.slugify(string)});Handlebars.registerHelper(\"try\",function(){var options,tries,value,_i,_this=this;tries=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.find(tries,function(each,i){value=_.result(tries,i);if(value!=null&&value!==\"\")return true});if(!(value!=null))value=_.last(tries);value=_.result([value],0);return value});Handlebars.registerHelper(\"filter\",function(array,filter,options){var buffer,context,render,_ref,_this=this;buffer=\"\";if(array instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;array=array.apply(context,null)}if((array!=null?array.length:void 0)>0){render=function(each){if(context=filter(each))return buffer+=options.fn(context)};if(array instanceof Backbone.Collection){array.each(function(each){return render(each)})}else if(array instanceof Array){_.each(array,function(each){return render(each)})}return buffer}else{return options.inverse(this)}});Handlebars.registerHelper(\"each\",function(array,options){var buffer,context,count,max,meta,renderArray,renderHash,_ref,_ref2,_this=this;buffer=\"\";count=0;max=options!=null?(_ref=options.hash)!=null?_ref.max:void 0:void 0;meta=function(each){if(count%2===0)each._even=true;if(count%2!==0)each._odd=true;each._idx=count;count=count+1;return each};renderArray=function(each){each=meta(each);if(max!=null&&count>max)return;return buffer+=options.fn(each)};renderHash=function(value,key){var each;each={key:key,value:value};each=meta(each);if(max!=null&&count>max)return;return buffer+=options.fn(each)};if(array instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;array=array.apply(context,null)}if(array instanceof Backbone.Collection&&(array!=null?array.length:void 0)>0){array.each(function(each){return renderArray(each)})}else if(array instanceof Array&&(array!=null?array.length:void 0)>0){_.each(array,function(each){return renderArray(each)})}else if(array instanceof Object){_.each(array,function(val,key){return renderHash(val,key)})}if(buffer!==\"\")return buffer;return options.inverse(this)});Handlebars.registerHelper(\"paginate\",function(coll,options){var buffer,onCurrentPage,render,_this=this;buffer=\"\";onCurrentPage=function(index,page,perPage){if((page-1)*perPage<=index&&index<page*perPage)return true;return false};render=function(each,index){var page,perPage;page=coll.frontendPagination.page;if(!(page!=null))page=1;perPage=coll.frontendPagination.perPage;if(!(perPage!=null))perPage=100;if(onCurrentPage(index,page,perPage))return buffer+=options.fn(each)};if((coll!=null?coll.length:void 0)>0?coll instanceof Backbone.Collection:void 0){coll.each(function(each,idx){return render(each,idx)})}if(buffer!==\"\")return buffer;return options.inverse(this)});Handlebars.registerHelper(\"log\",function(thing){log(\"(from template): \",thing);return\"\"});Handlebars.registerHelper(\"get\",function(model,key,options){var context,_ref,_ref2;context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;return model!=null?(_ref2=model.get)!=null?_ref2.call(context,key):void 0:void 0});Handlebars.registerHelper(\"call\",function(){var args,context,func,options,_i,_ref;func=arguments[0],args=3<=arguments.length?__slice.call(arguments,1,_i=arguments.length-1):(_i=1,[]),options=arguments[_i++];context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;return func!=null?func.apply(context,args):void 0});Handlebars.registerHelper(\"humanize\",function(string,key,options){return _.str.humanize(string)});Handlebars.registerHelper(\"ellipsis\",function(max,options){var string;string=options.fn(this);string=_.truncate(string,max,\"...\");return string});Handlebars.registerHelper(\"plural\",function(options){var plural,string,_ref;string=options.fn(this);plural=z.useful.pluralize(string.toLowerCase(),(_ref=options.hash)!=null?_ref.count:void 0);return plural});Handlebars.registerHelper(\"article\",function(options){var article,letter,string,v,vowel,vowels,_i,_len,_ref;string=options.fn(this);vowels=[\"a\",\"e\",\"i\",\"o\",\"u\"];vowel=false;letter=string.toLowerCase()[0];for(_i=0,_len=vowels.length;_i<_len;_i++){v=vowels[_i];if(letter===v)vowel=true}if(vowel)article=\"an \";if(!vowel)article=\"a \";if((_ref=options.hash)!=null?_ref.capitalize:void 0){article=_.str.capitalize(article)}return article+string});Handlebars.registerHelper(\"if\",function(value,options){var context,_ref;if(value instanceof Handlebars.SafeString)value=value.string;if(value instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value=value.apply(context,null)}value=Boolean(value);if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"unless\",function(value,options){var context,_ref;if(value instanceof Handlebars.SafeString)value=value.string;if(value instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value=value.apply(context,null)}value=Boolean(value);if(value!=null&&value){return options.inverse(this)}else{return options.fn(this)}});Handlebars.registerHelper(\"and\",function(){var ands,options,value,_i,_this=this;ands=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.all(ands,function(each,i){var context,_ref;if(each instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||_this;each=each.apply(context,null)}if(each!=null&&each)return true});if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"neither\",function(){var neithers,options,value,_i,_this=this;neithers=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),options=arguments[_i++];value=_.all(neithers,function(each,i){value=_.result(neithers,i);if(value!=null&&!value)return true});if(value!=null&&value){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"or\",function(value1,value2,options){var context,_ref,_ref2;if(value1 instanceof Handlebars.SafeString)value1=value1.string;if(value2 instanceof Handlebars.SafeString)value2=value2.string;if(value1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;value1=value1.apply(context,null)}if(value2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;value2=value2.apply(context,null)}if(value1!=null&&value1||value2!=null&&value2){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"hasAtLeastOne\",function(object,options){var context,_ref;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if(object instanceof Backbone.Collection&&(object!=null?object.length:void 0)>0){return options.fn(this)}else if(object instanceof Array&&(object!=null?object.length:void 0)>0){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"range\",function(number,options){var buffer,i,_ref;buffer=\"\";for(i=1,_ref=Number(number)+1;1<=_ref?i<_ref:i>_ref;1<=_ref?i++:i--){buffer+=options.fn(_.extend(this,{i:i}))}return buffer});Handlebars.registerHelper(\"hasExactly\",function(object,count,options){var context,_ref;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if(object instanceof Backbone.Collection&&(object!=null?object.length:void 0)===count){return options.fn(this)}else if(object instanceof Array&&(object!=null?object.length:void 0)===count){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"equals\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(val1===val2||String(val1)===String(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"notequals\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(val1!==val2&&String(val1)!==String(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"greater\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(Number(val1)>Number(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"less\",function(val1,val2,options){var context,_ref,_ref2;if(val1 instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;val1=val1.apply(context,null)}if(val2 instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;val2=val2.apply(context,null)}if(Number(val1)<Number(val2)){return options.fn(this)}else{return options.inverse(this)}});Handlebars.registerHelper(\"contains\",function(haystack,needle,options){var context,_ref,_ref2;if(haystack instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;haystack=haystack.apply(context,null)}if(needle instanceof Function){context=(options!=null?(_ref2=options.hash)!=null?_ref2.context:void 0:void 0)||this;needle=needle.apply(context,null)}if(_.isArray(haystack)){if(_.any(haystack,function(each){return each===needle})){return options.fn(this)}else{return options.inverse(this)}}if(_.isString(haystack)){if(_.str.include(haystack,needle)){return options.fn(this)}else{return options.inverse(this)}}});Handlebars.registerHelper(\"count\",function(object,options){var context,filtered,_ref,_ref2;if(object instanceof Function){context=(options!=null?(_ref=options.hash)!=null?_ref.context:void 0:void 0)||this;object=object.apply(context,null)}if((options!=null?(_ref2=options.hash)!=null?_ref2.filter:void 0:void 0)!=null){filtered=_.filter(object,function(each){return options!=null?options.hash.filter(each):void 0})}else{filtered=object}if(filtered!=null)return filtered.length;return\"0\"});Handlebars.registerHelper(\"appNameFromKey\",function(key){var s;s=z.app.services.get(key);if((s!=null?s.getName:void 0)!=null)return s.getName();return\"\"});Handlebars.registerHelper(\"prettyISO\",function(string){return z.useful.prettyISO(string)});Handlebars.registerHelper(\"toDollars\",function(int){var cents,dollars;int=Number(int);if(int>0){dollars=Math.floor(int/100)}else if(int<0){dollars=Math.ceil(int/100)}else{dollars=0}cents=\"0\"+(int-dollars*100);return dollars+\".\"+cents.substr(cents.length-2)});Handlebars.registerHelper(\"copyOverride\",function(service,action,which,copy,options){var override;override=service!=null?service.getCopyOverride(action,which,copy):void 0;if(override!=null)return override;return options.fn(this)});var useful,__indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};useful={QueryString:function(){function _Class(queryString){var pair,_ref;this.queryString=queryString;this.queryString||(this.queryString=(_ref=window.document.location.search)!=null?_ref.substr(1):void 0);this.pairs=Array();this.object={};if(__indexOf.call(this.queryString,\"=\")>=0){this.variables=this.queryString.split(\"&\");this.pairs=function(){var _i,_len,_ref2,_results;_ref2=this.variables;_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++){pair=_ref2[_i];_results.push(pair.split(\"=\"))}return _results}.call(this);this.object=_.object(this.pairs||Array())}}return _Class}(),prettyISO:function(string){var dt;dt=new Date(string);return dt.toLocaleDateString()+\" \"+dt.toLocaleTimeString()},summarize:function(data,max){var pos,s;if(max==null)max=50;if(!(data!=null)||data.length<max)return data;pos=Math.round(data.length/2)-Math.round(max/2);\ns=String(data).substr(pos,max).replace(/(\\r\\n|\\n|\\r)/gm,\"\");data=\"... \"+s+\" ...\";return data},whatPage:function(haystack,needle,perPage){var idx;idx=1;_.each(haystack,function(each,i){if(each===needle)return idx=i+1});return Math.ceil(idx/perPage)},maxPage:function(haystack,perPage){return Math.ceil(haystack.length/perPage)},errors:function(xhr){var body,error,_ref,_ref2,_ref3;try{body=JSON.parse(xhr.responseText);error=(body!=null?(_ref=body.error)!=null?_ref.join(\" \"):void 0:void 0)||(body!=null?(_ref2=body.errors)!=null?_ref2.join(\" \"):void 0:void 0)}catch(_error){}if(!error){if(xhr.status!=null&&xhr.statusText!=null){error=xhr.status+\": \"+xhr.statusText}else{error=(_ref3=xhr.responseText)!=null?_ref3.substring(0,150):void 0}}return error},open:function(url,target,options){var win;if(target==null)target=\"_blank\";win=typeof window!==\"undefined\"&&window!==null?window.open(url,target,options):void 0;win.focus();return win},\"goto\":function(url){return typeof window!==\"undefined\"&&window!==null?window.location.href=url:void 0},template:function(templateString){var _this=this;return function(){var context;if(arguments[0]===false)return templateString;z.app.trigger(\"render\");context=_.defaults({},z.cfg.renderContext,{z:z},arguments[0]);return z.useful.render(templateString,context)}},render:function(templateString,context,options){var rendered;rendered=Handlebars.compile(templateString,options).call(this,context);return rendered},chunks:function(array,chunkSize){return[].concat.apply([],_.map(array,function(item,i){return i%chunkSize?[]:[array.slice(i,i+chunkSize)]}))},equalChunks:function(array,chunks){var chunked;chunked=this.chunks(array,Math.ceil(array.length/chunks));return[].concat.apply([],_.map(_.range(chunks),function(item,i){return[chunked[i]||[]]}))},markdown:function(string){var converter;converter=new Showdown.converter;return converter.makeHtml(string)},placeholders:function($el){var _this=this;return _.defer(function(){var _ref;return $el!=null?(_ref=$el.find(\"input, textarea\"))!=null?_ref.placeholder():void 0:void 0})},viewportSize:function(){var viewPortHeight,viewPortWidth;if(typeof window.innerWidth!==\"undefined\"){viewPortWidth=window.innerWidth;viewPortHeight=window.innerHeight}else if(typeof document.documentElement!==\"undefined\"&&typeof document.documentElement.clientWidth!==\"undefined\"&&document.documentElement.clientWidth!==0){viewPortWidth=document.documentElement.clientWidth;viewPortHeight=document.documentElement.clientHeight}else{viewPortWidth=document.getElementsByTagName(\"body\")[0].clientWidth;viewPortHeight=document.getElementsByTagName(\"body\")[0].clientHeight}return[viewPortWidth,viewPortHeight]},viewportScroll:function(){var scrollx,scrolly;scrollx=$(window).scrollLeft();scrolly=$(window).scrollTop();return[scrollx,scrolly]},elClippedByScreenBottom:function(el){var edges,offset,size,viewport;offset=$(el).offset();offset.left=offset.left-z.useful.viewportScroll()[0];offset.top=offset.top-z.useful.viewportScroll()[1];size={width:$(el).outerWidth(),height:$(el).outerHeight()};viewport=z.useful.viewportSize();edges=[];edges.push(offset.top+size.height>viewport[1]);return _.any(edges,function(edge){return edge})},squish:function(string){return string.replace(/\\s/g,\"\")},noBGScroll:function(el){z.useful.noBGScrollOff(el);return $(el).on(\"mousewheel DOMMouseScroll\",function(e){var scrollTo;scrollTo=null;if(e.type===\"mousewheel\"){scrollTo=e.originalEvent.wheelDelta*-1}else if(e.type===\"DOMMouseScroll\"){scrollTo=40*e.originalEvent.detail}if(scrollTo){e.preventDefault();return $(this).scrollTop(scrollTo+$(this).scrollTop())}})},noBGScrollOff:function(el){return el.off(\"mousewheel DOMMouseScroll\")},refreshChrome:function(options){var _this=this;return $.ajax(\"/chrome.html\",{success:function(html){var $dom,$footer,$header;$dom=$(\"<div>\").html(html);$header=$dom.find(\"#header\");$footer=$dom.find(\"#footer\");$(\"#header\").replaceWith($header);$(\"#footer\").replaceWith($footer);return options!=null?options.success.apply(_this,arguments):void 0},error:function(){return options!=null?options.error.apply(_this,arguments):void 0}})},orderRelative:function(fullSeries,partialSeries){var orderRelative,orderedFullSeries;orderedFullSeries=_.sortBy(fullSeries,function(){return arguments[0]});orderRelative=_.map(partialSeries,function(i){return _.indexOf(orderedFullSeries,i)});if(_.any(orderRelative,function(i){return i===-1})){return false}orderRelative=_.map(orderRelative,function(i){return i+1});return orderRelative},getUserTimezone:function(){return this._calculateTimeZone()+\"\"},_calculateTimeZone:function(){var daylightTimeOffset,dst,hemisphere,jan1,jan2,june1,june2,rightNow,stdTimeOffset,temp;rightNow=new Date;jan1=new Date(rightNow.getFullYear(),0,1,0,0,0,0);june1=new Date(rightNow.getFullYear(),6,1,0,0,0,0);temp=jan1.toGMTString();jan2=new Date(temp.substring(0,temp.lastIndexOf(\" \")-1));temp=june1.toGMTString();june2=new Date(temp.substring(0,temp.lastIndexOf(\" \")-1));stdTimeOffset=(jan1-jan2)/(1e3*60*60);daylightTimeOffset=(june1-june2)/(1e3*60*60);dst=void 0;if(stdTimeOffset===!daylightTimeOffset){hemisphere=stdTimeOffset-daylightTimeOffset;if(hemisphere>=0)stdTimeOffset=daylightTimeOffset}return this._convert(stdTimeOffset)},_convert:function(value){var displayHours,hours,mins,secs;hours=parseInt(value);value-=parseInt(value);value*=60;mins=parseInt(value);value-=parseInt(value);value*=60;secs=parseInt(value);displayHours=hours;if(hours===0){displayHours=\"00\"}else if(hours>0){displayHours=hours<10?\"+0\"+hours:\"+\"+hours}else{displayHours=hours>-10?\"-0\"+Math.abs(hours):hours}mins=mins<10?\"0\"+mins:mins;return parseInt(displayHours).toFixed(1)}};_.extend(z.useful,useful);window.JST=useful.template;async.fetch=function(model,options){return function(callback){return model.fetch({cache:(options!=null?options.cache:void 0)!=null?options.cache:true,persist:(options!=null?options.persist:void 0)!=null?options.persist:false,success:function(results){return callback(null,model)},error:function(err){if(options!=null?options.canFail:void 0){return callback(null,model)}else{return callback(err,model)}}})}};Backbone.View.prototype.setMode=function(mode,group,el){if(this.state.get(group)===mode&&!(el!=null))return;if(!(mode!=null))return;if(mode===true)mode=\"is\";if(mode===false)mode=\"not\";$(el||this.el).setMode(mode,group);if(!(el!=null))this.state.set(group,mode);return z.app.trigger(\"render\")};Backbone.View.prototype.hasMode=function(mode,group,el){return $(el||this.el).hasMode(mode,group)};Backbone.View.prototype._remove=Backbone.View.prototype.remove;Backbone.View.prototype.remove=function(){this.trigger(\"remove\");this.off();this.$el.off();this._remove();return this};Backbone.Events._on=Backbone.Events.on;Backbone.Events.on=function(events,callback,context){this._on.apply(this,arguments);if(_.isObject(context)&&context.listenTo!=null){context.listenTo.call(context,this,name,callback)}return this};Backbone.Events.listenTo=function(object,events,callback){var listeners=this._listeners||(this._listeners={});var id=object._listenerId||(object._listenerId=_.uniqueId(\"l\"));listeners[id]=object;return this};_.extend(Backbone.View.prototype,Backbone.Events);_.extend(Backbone.Model.prototype,Backbone.Events);_.extend(Backbone.Collection.prototype,Backbone.Events);_.extend(Backbone.Router.prototype,Backbone.Events);z.model.Base=Backbone.Model.extend({initialize:function(attrs,options){var _this=this;this.loaded=attrs!=null;this.once(\"sync\",function(){return _this.loaded=true});if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}if(attrs!=null)arguments[0]=this.parse(attrs);return Backbone.Model.prototype.initialize.apply(this,arguments)}});z.model.BaseSet=Backbone.Collection.extend({initialize:function(models,options){var _this=this;this.loaded=models!=null;this.once(\"sync\",function(){return _this.loaded=true});if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}if(models!=null&&_.any(models,function(model){return!(model instanceof Backbone.Model)})){arguments[0]=this.parse(models)}return Backbone.Collection.prototype.initialize.apply(this,arguments)},parse:function(response){return response.objects||response}});z.model.Store=Backbone.Collection.extend({retrieve:function(model,Model,strict){var found,id,v,_this=this;if(strict==null)strict=false;id=Number(model.id);v=this.find(function(v){if(id===v.get(\"id\")||!strict&&v.get(\"model\")instanceof Model){return true}});found=v!=null?v.get(\"model\"):void 0;if(found!=null&&found instanceof Backbone.Model){found.set(_.extend(found.toJSON(),model.toJSON()));if(model.collection!=null)found.collection=model.collection}return found},inject:function(model,Model){var v;v=new Backbone.Model({id:Number(model.id),Model:model,model:model});this.add(v);return v!=null?v.get(\"model\"):void 0}});z.model.Singleton=function(Model,options){var Singleton,construct,store;construct=function(){var child;child=function(args){return Model.apply(this,args)};child.prototype=Model.prototype;return function(args){return new child(args)}};Model.prototype.store=new z.model.Store;store=Model.prototype.store;return Singleton=function(){function Singleton(){var model,single;model=construct()(arguments);single=store.retrieve(model,Model,options!=null?options.strict:void 0)||store.inject(model,Model);return single}return Singleton}()};z.model.StrictSingleton=function(Model){return z.model.Singleton(Model,{strict:true})};z.model.PaginationSet=z.model.BaseSet.extend({initialize:function(attrs,options){var pagination,_this=this;z.model.BaseSet.prototype.initialize.apply(this,arguments);pagination=(options!=null?options.pagination:void 0)||{};pagination=_.defaults(pagination,{perPage:15,page:1,pages:void 0,total:void 0,prev:void 0,next:void 0});this.pagination=new z.model.Base(pagination);this.paginationStore=this.pagination.toJSON();return this.pagination.on(\"change reset\",function(){_this.paginationStore=_this.pagination.toJSON();return _this.fetch()},this)},parse:function(response){var pagination;if(_.isArray(response))return response;pagination={perPage:response.per_page,page:response.page,pages:response.pages,total:response.total,prev:response.prev_url,next:response.next_url};this.pagination.set(pagination,{silent:true});this.pagination.set({hasPrev:this.hasPrev(),hasNext:this.hasNext()},{silent:true});return response.objects},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,{per_page:this.pagination.get(\"perPage\"),page:this.pagination.get(\"page\")});return z.model.BaseSet.prototype.fetch.call(this,options)},serverPrev:function(options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([_.max([page-1,1]),pages]),options)},serverNext:function(options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([page+1,pages]),options)},serverPage:function(target,options){var page,pages;if(options==null)options={};page=this.pagination.get(\"page\");pages=this.pagination.get(\"pages\");return this.pagination.set(\"page\",_.min([_.max([target,1]),pages]),options)},serverPageReset:function(options){if(options==null)options={};return this.pagination.set(\"page\",1,options)},hasPrev:function(){return this.pagination.get(\"page\")>1},hasNext:function(){return this.pagination.get(\"page\")<this.pagination.get(\"pages\")},count:function(){var count,total;total=this.pagination.get(\"total\");count=total!=null?total:this.length;return count}});z.model.Node=z.model.Base.extend({initialize:function(attrs,options){},getService:function(){return z.app.services.get(this.get(\"selected_api\"))},serviceImageClass:function(key){var _ref;if(key==null)key=\"32x32\";return(_ref=this.getService(z.app.services))!=null?_ref.getImageClass(key):void 0},serviceImageStyle:function(key){var _ref;if(key==null)key=\"32x32\";return(_ref=this.getService(z.app.services))!=null?_ref.getImageStyle(key):void 0},getParams:function(){return this.get(\"params\")},needsAuth:function(){var needsAuth,upfronts,_ref;upfronts=(_ref=z.app.services.get(this.get(\"selected_api\")))!=null?_ref.get(\"upfront_fields\"):void 0;needsAuth=upfronts!=null&&upfronts.length>0?true:false;return needsAuth},hasAuth:function(){if(!this.needsAuth())return true;if(this.needsAuth()&&this.get(\"authentication_id\")!=null)return true},isRead:function(){return this.get(\"write_ids\")!=null},isWrite:function(){return this.get(\"read_id\")!=null}});z.model.NodeSet=z.model.BaseSet.extend({model:z.model.Node});z.model.Write=z.model.StrictSingleton(z.model.Node.extend({urlRoot:z.cfg.api+\"/writes\",customNeeds:[],customGives:[],initialize:function(attrs,options){return z.model.Node.prototype.initialize.apply(this,arguments)},parse:function(response){if(response[\"lastchanged\"]!=null)delete response[\"lastchanged\"];if(response[\"date\"]!=null){this.date=new Date(response[\"date\"]);delete response[\"date\"]}return response},isComplete:function(){if(this.id!=null&&this.get(\"selected_api\")!=null&&this.get(\"action\")!=null&&this.get(\"read_id\")!=null&&this.get(\"errors\").length===0){return true}else{return false}},getActionMeta:function(){var _ref;return(_ref=this.getService())!=null?_ref.getActionMeta(this.get(\"action\"),\"write\"):void 0},getActionNoun:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s.getActionName(this.get(\"action\"),\"write\",\"true\");return noun},getActionLabel:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s.getActionName(this.get(\"action\"),\"write\",\"false\");return noun},write:function(action,data,options){var syncOptions,_this=this;syncOptions={url:\"\"+this.url()+\"/write/\"+action,type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)},canShare:function(){var globalService,_ref;globalService=(_ref=this.getService())!=null?_ref.get(\"public\"):void 0;return globalService}}));z.model.WriteSet=z.model.Singleton(z.model.NodeSet.extend({model:z.model.Write,url:z.cfg.api+\"/writes\"}));z.model.SavableSortSet=z.model.BaseSet.extend({saveSort:function(options){var syncOptions;syncOptions={type:\"PUT\",url:\"\"+this.url()+\"/sort\",data:JSON.stringify({ordering:this.map(function(field){return field.id})}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0,cache:false};return Backbone.sync(\"update\",this,syncOptions)}});z.model.DeveloperApp=z.model.Base.extend({urlRoot:z.cfg.devapi+\"/apps\",url:function(){return z.cfg.devapi+\"/apps/\"+this.get(\"id\")},isEditable:function(){return z.app.account.get(\"is_staff\")===true||this.get(\"status\")===0},parse:function(json){this.authFields=new z.model.DeveloperAppAuthFieldSet(json.auth_fields,{app:this});this.triggers=new z.model.DeveloperAppTriggerSet(json.triggers,{app:this});this.actions=new z.model.DeveloperAppActionSet(json.actions,{app:this});return json},stats:function(){var stats;stats=[];_.each(this.get(\"stats\"),function(items,type){return _.each(items,function(values,label){var item;item={Type:type,Label:label};return stats.push(_.extend(item,values))})});stats=new z.model.BaseSet(stats,{model:z.model.Base});return stats}});z.model.DeveloperAppSet=z.model.BaseSet.extend({model:z.model.DeveloperApp,url:z.cfg.devapi+\"/apps\"});z.model.DeveloperAppAuthField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/auth_fields\";z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppAuthFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppAuthField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/auth_fields\"}});z.model.DeveloperAppTrigger=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/triggers\";z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(json){this.fields=new z.model.DeveloperAppTriggerFieldSet(json.fields,{app:this.app,trigger:this});return json}});z.model.DeveloperAppTriggerSet=z.model.BaseSet.extend({model:z.model.DeveloperAppTrigger,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/triggers\"},comparator:function(item){var index;index=1;if(item.get(\"important\"))index=0;if(item.get(\"hide\"))index=2;return index}});z.model.DeveloperAppTriggerField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+(\"/apps/\"+this.app.get(\"id\")+\"/triggers/\"+options.trigger.get(\"id\")+\"/fields\");z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppTriggerFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppTriggerField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/triggers/\"+this.options.trigger.id+\"/fields\"}});z.model.DeveloperAppTriggerSampleResult=z.model.Base.extend({idAttribute:\"sample\",initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+(\"/apps/\"+this.options.appId+\"/triggers/\"+this.options.triggerId+\"/sample_result\")}});z.model.DeveloperAppAction=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+\"/apps/\"+this.app.get(\"id\")+\"/actions\";z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(json){this.fields=new z.model.DeveloperAppActionFieldSet(json.fields,{app:this.app,action:this});return json}});z.model.DeveloperAppActionSet=z.model.BaseSet.extend({model:z.model.DeveloperAppAction,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/actions\"},comparator:function(item){var index;index=1;if(item.get(\"important\"))index=0;if(item.get(\"hide\"))index=2;return index}});z.model.DeveloperAppActionField=z.model.Base.extend({initialize:function(attrs,options){this.app=options.app;this.urlRoot=z.cfg.devapi+(\"/apps/\"+this.app.get(\"id\")+\"/actions/\"+options.action.get(\"id\")+\"/fields\");z.model.Base.prototype.initialize.apply(this,arguments)}});z.model.DeveloperAppActionFieldSet=z.model.SavableSortSet.extend({model:z.model.DeveloperAppActionField,initialize:function(models,options){this.options=options;z.model.BaseSet.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/actions/\"+this.options.action.id+\"/fields\"}});z.model.DeveloperAppActivationRequest=z.model.Base.extend({initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},url:function(){return z.cfg.devapi+\"/apps/\"+this.options.app.id+\"/activation\"}});z.model.DeveloperAppAudit=z.model.Base.extend({initialize:function(attrs,options){this.options=options;z.model.Base.prototype.initialize.apply(this,arguments)},hasErrors:function(){return!$.isEmptyObject(this.get(\"errors\"))},url:function(){var url,_ref;url=z.cfg.devapi+\"/apps/\"+this.options.appId+\"/audit\";if((_ref=this.options)!=null?_ref.compareTo:void 0){url+=\"?compare_to=\"+this.options.compareTo}return url}});z.model.Recipe=z.model.Base.extend({urlRoot:z.cfg.api+\"/recipes\",noPersist:true,createRead:function(cb){var _this=this;this.read=new z.model.Read;return this.read.save(this.get(\"read_data\"),{success:function(){return typeof cb===\"function\"?cb():void 0}})},createWrite:function(cb){var data,_this=this;this.write=new z.model.Write;data=_.clone(this.get(\"write_data\"));data.read_id=this.read.id;return this.write.save(data,{success:function(){return typeof cb===\"function\"?cb():void 0}})},startUsing:function(options){var _this=this;if(options==null)options={};return async.series([function(cb){return _this.createRead(cb)},function(cb){return _this.createWrite(cb)}],function(err,models){if(err!=null){if(options!=null){if(typeof options.error===\"function\")options.error(err)}}(new z.model.ReadSet).fetch({cache:false,add:true});(new z.model.WriteSet).fetch({cache:false,add:true});return options!=null?typeof options.success===\"function\"?options.success(_this.read,_this.write):void 0:void 0})},readService:function(){var _ref;if((_ref=this.get(\"read_data\"))!=null?_ref.selected_api:void 0){return z.app.services.get(this.get(\"read_data\").selected_api)}return null},writeService:function(){var _ref;if((_ref=this.get(\"write_data\"))!=null?_ref.selected_api:void 0){return z.app.services.get(this.get(\"write_data\").selected_api)}return null}});z.model.RecipeSet=z.model.PaginationSet.extend({model:z.model.Recipe,url:z.cfg.api+\"/recipes\",noPersist:true,initialize:function(models,options){var filters,_this=this;z.model.PaginationSet.prototype.initialize.apply(this,arguments);this.services=this.format(options!=null?options.services:void 0);this.userid=this.format(options!=null?options.userid:void 0);this.categories=this.format(options!=null?options.categories:void 0);filters=(options!=null?options.filters:void 0)||{};filters=_.defaults(filters,{read_service:null,read_action:null,write_service:null,write_action:null,services:null,userid:null,categories:null});this.filters=new z.model.Base(filters);return this.filters.on(\"change reset\",function(){_this.serverPageReset({silent:true});return _this.fetch()},this)},format:function(rawList,location){var list;if(rawList!=null)list=_.compact(rawList);if((list!=null?list.length:void 0)>0)location=list.join(\",\");return location},applyServicesFilter:function(services,options){if(options==null)options={};return this.filters.set(\"services\",this.format(services),options)},getServicesFilter:function(){var _ref;return((_ref=this.filters.get(\"services\"))!=null?_ref.split(\",\"):void 0)||[]},applyUserFilter:function(userid,options){if(options==null)options={};return this.filters.set(\"userid\",this.format(userid),options)},applyCategoryFilter:function(categories,options){if(options==null)options={};return this.filters.set(\"categories\",this.format(categories),options)},clearFilters:function(){return this.filters.set({read_service:null,read_action:null,write_service:null,write_action:null,services:null,userid:null,categories:null})},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,_.compactObject(this.filters.toJSON()));this.trigger(\"fetch\");return z.model.PaginationSet.prototype.fetch.call(this,options)},comparator:function(model){return-model.get(\"used\")||0}});z.model.Auth=z.model.Base.extend({urlRoot:z.cfg.api+\"/auths\",validateModel:function(){if(!(this.get(\"key\")!=null))return false;return true},getService:function(services){var _ref;return(_ref=z.app.services)!=null?_ref.get(this.get(\"selected_api\")):void 0},getName:function(services){var base,name,_ref;base=(_ref=this.getService(services))!=null?_ref.getName():void 0;if(this.get(\"title\")!=null){name=this.get(\"title\")}else{name=\"\"+base+\" (\"+this.get(\"timesince\")+\" ago)\"}return name},test:function(options){var syncOptions,_this=this;if(options==null)options={};syncOptions={url:\"\"+this.url()+\"/test\",type:\"post\",data:\"{}\",dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)},destroy:function(options){return Backbone.Model.prototype.destroy.call(this,options)},swap:function(newAuthId,options){var syncOptions,_this=this;if(options==null)options={};syncOptions={url:\"\"+this.url()+\"/swap/\"+newAuthId,type:\"post\",data:\"{}\",dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.trigger(\"destroy\",_this,_this.collection,options);return(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(){var _ref;return(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0}};return Backbone.sync(\"create\",this,syncOptions)}});z.model.AuthSet=z.model.BaseSet.extend({model:z.model.Auth,url:z.cfg.api+\"/auths\",comparator:function(auth){var d;d=new Date(auth.get(\"date\"));return-d.getTime()},getByKey:function(key){var match;if(!(key!=null))return null;match=[];this.each(function(model){if(model.get(\"selected_api\")===key)return match.push(model)});return match},hasAtLeastOneAuth:function(key){var auth;auth=this.getByKey(key);if(auth!=null&&auth.length>0)return true;return false},create:function(data,options){var syncOptions;syncOptions={url:this.url,type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",statusCode:{200:options!=null?options.s200:void 0,201:options!=null?options.s201:void 0,202:options!=null?options.s202:void 0},error:function(e){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(this,arguments):void 0:void 0}};return Backbone.sync(\"create\",this,syncOptions)},request:function(data,options){var syncOptions;syncOptions={url:this.url+\"/request\",type:\"post\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},pollForNewAuth:function(interval,iters,id,options){var i,match,poll,_this=this;i=0;match=false;poll=function(){var error,success,syncOptions,_ref;success=function(model,resp){var status,_ref,_ref2;status=resp[\"status\"];log(\"oauth poll status: \",status);if(status===\"success\"){log(\"oauth success\",resp);clearInterval(poll);return(_ref=options.success)!=null?_ref.call(_this,resp):void 0}else if(status===\"error\"){log(\"oauth error\",resp);clearInterval(poll);return(_ref2=options.error)!=null?_ref2.call(_this,resp[\"message\"]):void 0}};error=function(model,xhr){};syncOptions={url:_this.url+(\"/oauth/\"+id),cache:false,type:\"get\",success:success,error:error};Backbone.sync(\"read\",_this,syncOptions);i=i+1;if(i===iters){log(\"oauth poll stopping, max iter\");clearInterval(poll);return(_ref=options.maxIter)!=null?_ref.call(_this):void 0}};poll=setInterval(poll,interval);return poll}});z.model.Stream=z.model.Base.extend({urlRoot:z.cfg.api+\"/stream\",getReadService:function(){var _ref,_ref2;return(_ref=z.app.services)!=null?_ref.get((_ref2=this.get(\"data\"))!=null?_ref2[\"read_selected_api\"]:void 0):void 0},getWriteService:function(){var _ref,_ref2;return(_ref=z.app.services)!=null?_ref.get((_ref2=this.get(\"data\"))!=null?_ref2[\"write_selected_api\"]:void 0):void 0},getRead:function(reads,writes){var write;if(this.get(\"type\")===\"write\"&&reads&&writes){write=writes!=null?writes.get(this.get(\"legacy_object_id\")||this.get(\"object_id\")):void 0;return reads!=null?reads.get(write!=null?write.get(\"read_id\"):void 0):void 0}return null},getTitle:function(){var data,read,read_action,title,write,write_action,_ref,_ref2;data=this.get(\"data\");if(data.message!=null){title=data.message}else{write=(_ref=z.app.writes)!=null?_ref.get(this.get(\"legacy_object_id\")||this.get(\"object_id\")):void 0;read=(_ref2=z.app.reads)!=null?_ref2.get(write!=null?write.get(\"read_id\"):void 0):void 0;if(read!=null){title=read.getTitle()}else{read_action=_.superHumanize(data.read_action);write_action=_.superHumanize(data.write_action);title=\"\"+read_action+\" to \"+write_action}}return title},buildChildren:function(){var action,children,jmessage,json,message,name,service,status,_ref,_ref2;json=this.toJSON();if(!(json!=null?json.data:void 0))return[];children=[];if(json.data.manual!=null&&json.data.manual===true){children.push({status:\"success\",message:\"Manually ran from dashboard\",date:json.date,type:\"manual\"})}status=((_ref=_.keys(json.data.write_raw_data))!=null?_ref.length:void 0)>0?\"success\":\"error\";service=z.app.services.get(json.data.read_selected_api);name=(service!=null?service.getName():void 0)||json.data.read_selected_api;action=(service!=null?service.getActionName(json.data.read_action,\"read\",\"true\"):void 0)||json.data.read_action;if(status===\"success\")message=\"Found 1 new \"+action+\" from \"+name;if(status===\"error\"){message=\"Error getting \"+action+\" from \"+name;if(json.data.message!=null)message=json.data.message}children.push({status:status,message:message,date:json.date,type:\"trigger_summary\"});if(json.data.message!=null)message=json.data.message;if(!(json.data.message!=null)){service=z.app.services.get(json.data.write_selected_api);name=(service!=null?service.getName():void 0)||json.data.write_selected_api;action=(service!=null?service.getActionName(json.data.write_action,\"write\",\"true\"):void 0)||json.data.write_action;if(json.data.status===\"success\"){message=\"Sent 1 \"+action+\" to \"+name}if(json.data.status===\"halted\"){jmessage=\"Advanced Filters halted 1 \"+action}if(json.data.status===\"error\"){message=\"Error sending 1 \"+action+\" to \"+name}}if(((_ref2=_.keys(json.data.write_raw_data))!=null?_ref2.length:void 0)>0){children.push({status:json.data.status,message:message,date:json.date,type:\"action_summary\"})}return children}});z.model.StreamSet=z.model.PaginationSet.extend({model:z.model.Stream,url:z.cfg.api+\"/stream\",initialize:function(models,options){var filters,_this=this;this.filterStore={};this.paginationStore={};z.model.PaginationSet.prototype.initialize.apply(this,arguments);filters=_.extend({},options!=null?options.filters:void 0);this.filters=new z.model.Base(filters);this.updateFilterStore();return this.filters.on(\"change reset\",function(){_this.serverPageReset({silent:true});_this.updateFilterStore();return _this.fetch()},this)},updateFilterStore:function(){return this.filterStore=this.filters.toJSON()},fetch:function(options){if(options==null)options={};if(!((options!=null?options.data:void 0)!=null))options.data={};options.data=_.extend(options.data,_.compactObject(this.filters.toJSON()));this.trigger(\"fetch\");return z.model.PaginationSet.prototype.fetch.call(this,options)},unseen:function(objectId){var all,cookie,unseen,_this=this;all=this.where({object_id:objectId});cookie=z.store.get(\"logs-seen\");unseen=_.filter(all,function(item){var seen;seen=cookie!=null?cookie[objectId]:void 0;if(!(seen!=null))return true;if(new Date(seen).getTime()>new Date(item.get(\"date\")).getTime()){return true}return false});return unseen!=null?unseen.length:void 0},comparator:function(model){var _ref;return-((_ref=new Date(model.get(\"date\")))!=null?_ref.getTime():void 0)}});z.model.Plan=z.model.Base.extend({urlRoot:function(){return z.cfg.api+\"/accounts/plans\"},getName:function(){return this.get(\"name\")},dollarsMo:function(){if(this.get(\"interval\")===\"year\")return this.dollars()/12;return this.dollars()},dollars:function(){return Math.floor(this.get(\"amount\")/100)},andCents:function(){return this.get(\"amount\")-this.dollars()*100\n},tasksMo:function(){var actions;actions=this.get(\"actions\");if(actions===-1)return new Handlebars.SafeString(\"&infin;\");return actions.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\")},zaps:function(){var zaps;zaps=this.get(\"zaps\")===-1?new Handlebars.SafeString(\"&infin;\"):this.get(\"zaps\");return zaps},pollInterval:function(){var interval_minutes;interval_minutes=this.get(\"polling_interval_minutes\");if(interval_minutes>=1440)return interval_minutes/1440;if(interval_minutes>60)return interval_minutes/60;return interval_minutes},pollIntervalTimeFrame:function(){var interval_minutes;interval_minutes=this.get(\"polling_interval_minutes\");if(interval_minutes>=1440)return\"Day\";if(interval_minutes>60)return\"Hour\";return\"Minute\"},pollSpeed:function(){var minutes;minutes=this.get(\"polling_interval_minutes\");if(minutes<10)return\"Fastest\";if(minutes<60)return\"Fast\";if(minutes>59)return\"Slow\"},blacklistedServices:function(key){var blacklisted_apps,_ref;if(key==null)key=\"blacklisted_apps\";blacklisted_apps=this.get(key);if(blacklisted_apps!=null?blacklisted_apps.length:void 0){return(_ref=z.app.services)!=null?_ref.filter(function(service){return blacklisted_apps.indexOf(service.get(\"key\"))!==-1}):void 0}else{return[]}},extraFeatures:function(){return this.get(\"meta\")},isYearly:function(){return this.get(\"interval\"===\"year\")},isMonthly:function(){return this.get(\"interval\"===\"month\")},isFree:function(){return this.dollars()===0}});z.model.PlanSet=z.model.BaseSet.extend({model:z.model.Plan,url:function(){var readId,_ref;readId=(_ref=this.read)!=null?_ref.id:void 0;return z.cfg.api+\"/accounts/plans\"},getFreePlan:function(){var plan,_this=this;plan=this.find(function(plan){if(plan.get(\"amount\")===0)return true});return plan},getCancelPlan:function(){return this.getFreePlan()},getTrialPlan:function(){var _this=this;this.comparator=function(model){return-model.get(\"amount\")};this.sort({silent:true});return this.at(1)},getIntervalPlans:function(which){var _this=this;if(which==null)which=\"month\";return this.filter(function(plan){return plan.get(\"interval\")===which||plan.get(\"amount\")===0})}});z.model.FormRow=z.model.Base.extend({TYPES:[\"password\",\"text\",\"copy\",\"datetime\",\"confirmation\",\"file\",\"unicode\",\"select\",\"bool\",\"checkbox\",\"string\",\"upload\",\"json\"],idAttribute:\"key\",isSoftRemoved:false,initialize:function(options){var _this=this;this.options=options;z.model.Base.prototype.initialize.apply(this,arguments);this.on(\"change:value\",function(){return _this.set({valid:_this.isValid()})});this.baseline();return this.originalCopy=this.toJSON()},reset:function(key){if(key){return this.set(key,this.originalCopy[key])}else{return this.set(this.originalCopy)}},baseline:function(){var choices,def,key,rawChoices,value,_ref,_ref2;_ref=this.toJSON();for(key in _ref){value=_ref[key];if(value!=null&&value===\"\")this.unset(key)}if(this.get(\"display\")!=null&&!(this.get(\"prefill\")!=null)){this.unset(\"display\")}if(!(this.get(\"required\")!=null)){this.set({required:!((_ref2=this.collection)!=null?_ref2.anyRequired():void 0)})}if(this.get(\"type\")===\"bool\"){this.set({choices:[\"yes\",\"no\"]})}def=this.get(\"default\");if(def!=null&&def!==\"\"&&!(this.getValue()!=null)){this.set({value:def})}if(_.isString(this.get(\"choices\"))){rawChoices=this.get(\"choices\");choices=rawChoices.split(\",\");choices=_.map(choices,function(choice){return choice=_.str.trim(choice)});if(_.every(choices,function(choice){return _.str.contains(choice,\"|\")})){choices=_.object(_.map(choices,function(choice){return choice.split(\"|\",2)}))}return this.set({choices:choices})}},save:function(attrs,options){return this.set(attrs,options)},validate:function(attrs,options){var isValid,value,_base;if(this.isSoftRemoved)return null;value=this.getValue();if(this.get(\"validator\")!=null){isValid=typeof(_base=this.get(\"validator\"))===\"function\"?_base(this,this.collection):void 0}else if(this.get(\"regex\")!=null){isValid=RegExp(this.get(\"regex\")).test(value)}else if(this.get(\"choices\")){if((value!=null?value.toString().length:void 0)>0){isValid=true}else{isValid=false}}else{isValid=!this.get(\"required\")||Boolean(value)}if(isValid){return null}else if(this.get(\"required\")){if((value!=null?value.toString().length:void 0)>0){return\"Invalid value\"}else{return\"Missing value\"}}else{return null}},getLabel:function(){if(this.get(\"label\")!=null)return this.get(\"label\");return _.superHumanize(this.get(\"key\"))},getDisplay:function(){if(this.get(\"display\")!=null)return this.get(\"display\");return this.get(\"value\")},getValue:function(){return this.get(\"value\")}});z.model.FormSet=z.model.BaseSet.extend({TYPES:z.model.FormRow.prototype.TYPES,model:z.model.FormRow,isValid:function(){var complete,errors,_this=this;complete=true;errors={};this.each(function(row){var valid;valid=row.isValid();complete=complete&&valid;if(!valid)errors[row.get(\"key\")]=[row.validationError]});if(!complete)this.trigger(\"invalid\",this,errors,null);return complete},getValues:function(){var data,_this=this;data={};this.each(function(each){var value;value=each.getValue();if(value!=null&&value&&value!==\"undefined\"){return data[each.get(\"key\")]=value}});return data},anyRequired:function(){return this.any(function(item){return item.get(\"required\")!=null})},softAdd:function(model){model.isSoftRemoved=false},softRemove:function(model){model.isSoftRemoved=true}});z.model.ParamFormRow=z.model.FormRow.extend({initialize:function(options){var onCollectionInit,_this=this;this.options=options;z.model.FormRow.prototype.initialize.apply(this,arguments);this.node=this.collection.node;this.state.set({busy:true});this.on(\"loaded\",this._baseline);onCollectionInit=function(state){var _ref,_ref2;if((_ref=_this.collection)!=null?(_ref2=_ref.state)!=null?_ref2.get(\"init\"):void 0:void 0){if(!_this.state.get(\"busy\")){return _this.state.set({busy:true})}}else{if(_this.state.get(\"busy\")){_this.state.set({busy:false})}return _this.trigger(\"loaded\")}};this.collection.state.on(\"change:init\",onCollectionInit,this);return this.collection.on(\"reset\",function(collection){if(!(_this.collection!=null)){return collection.state.off(null,null,_this)}})},baseline:function(){},_baseline:function(){z.model.FormRow.prototype.baseline.apply(this,arguments);if(this.get(\"prefill\")!=null&&!(this.getValue()!=null)&&this.get(\"display\")!=null){this.set({display:\"\"})}if(this.get(\"prefill\")!=null&&this.getValue()!=null&&!(this.get(\"display\")!=null)){return this.loadDisplay()}},save:function(attrs,options){var error,opts,success,_this=this;if(options==null)options={};if(!(this.collection!=null))return;if(attrs!=null)this.set(attrs);this.state.set({busy:true});success=function(){var _ref;_this.state.set({busy:false});return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(){var _ref;_this.state.set({busy:false});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};opts=_.extend({},options,{success:success,error:error});return this.collection.save(opts)},loadDisplay:function(){var options,samples,_this=this;if(!(this.collection!=null))return;this.state.set({busy:true});options={success:function(map){_this.state.set({busy:false});if(map[_this.getValue()]!=null){return _this.save({display:map[_this.getValue()]},{wait:true})}},error:function(model,xhr){return _this.state.set({busy:false})}};samples=new z.model.SampleSet([],{node:this.node,action:this.node.get(\"action\")});samples.prefillMap(this.get(\"prefill\"),this.collection.getValues(),options);return{hasTags:function(){var eTag,oTag,val;oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;val=this.getValue()||\"\";return val.indexOf(oTag)!==-1&&val.indexOf(eTag)!==-1}}},isUserfill:function(){if(this.get(\"prefill\")!=null&&this.get(\"prefill\")!==\"\")return false;if(this.get(\"choices\")!=null&&this.get(\"choice\")!==\"\")return false;if(this.get(\"type\")===\"checkbox\")return false;if(this.get(\"type\")===\"confirmation\")return false;if(this.get(\"type\")===\"copy\")return false;return true},isListParent:function(){return this.get(\"list\")&&!this.get(\"parent\")}});z.model.ParamFormSet=z.model.FormSet.extend({model:z.model.ParamFormRow,url:function(){return this.node.url()+\"/needs\"},initialize:function(models,options){z.model.FormSet.prototype.initialize.apply(this,arguments);this.node=options!=null?options.node:void 0;return this.once(\"sync\",this.initData)},stripMissing:function(params){var k,v,_ref;if(params==null)params={};for(k in params){v=params[k];if(!(((_ref=this.where({key:k}))!=null?_ref[0]:void 0)!=null)){delete params[k]}}return params},stripEmpty:function(params){var key,out,value;if(params==null)params={};out={};for(key in params){value=params[key];if(value!=null&&value!==\"\")out[key]=value}return out},applyPartner:function(params){var defaultKey,defaultVal,defaults,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(params==null)params={};if(this.node.get(\"selected_api\")!==((_ref=z.app.partner.get(\"zap\"))!=null?_ref.selected_api:void 0)){return params}if(this.node.isRead()){defaults=(_ref2=z.app.partner.get(\"zap\"))!=null?(_ref3=_ref2.defaults)!=null?(_ref4=_ref3.read)!=null?_ref4.params:void 0:void 0:void 0}else{defaults=(_ref5=z.app.partner.get(\"zap\"))!=null?(_ref6=_ref5.defaults)!=null?(_ref7=_ref6.write)!=null?_ref7.params:void 0:void 0:void 0}if(defaults){for(defaultKey in defaults){defaultVal=defaults[defaultKey];if(!(params[defaultKey]!=null)&&this.get(defaultKey)!=null){params[defaultKey]=defaultVal}}}return params},initData:function(options){var _this=this;this.state.set({init:true});return async.parallel([_.bind(this.loadFields,this)],function(err,results){var display,key,meta,model,params,value,_ref,_ref2,_ref3;params=_this.node.get(\"params\");meta=(_ref=_this.node.get(\"meta\"))!=null?_ref.parammap:void 0;if(!(meta!=null))meta={};if(!(params!=null))params={};params=_this.applyPartner(params);params=_this.unpackLists(params);meta=_this.unpackLists(meta,{update:true});for(key in params){value=params[key];model=_this.get(key);display=meta!=null?meta[key]:void 0;if(model!=null){model.set({value:value,display:display})}}_this.state.set({init:false});_.defer(function(){return _this.applyPartner()});if(err!=null){if(options!=null){if((_ref2=options.error)!=null)_ref2.apply(_this,err)}}if(results!=null){return options!=null?(_ref3=options.success)!=null?_ref3.apply(_this,results):void 0:void 0}})},loadFields:function(cb){var _this=this;if(!(this.node!=null))return cb();return this.node.fetch({success:function(){return cb()}})},save:function(options){var data,meta,oldParams,params,_ref,_ref2,_ref3,_this=this;if(!(this.node!=null))return;data={};oldParams=_.extend({},this.node.get(\"params\"));params={};this.each(function(row){return params[row.id]=row.get(\"value\")});params=this.packLists(params);params=this.stripEmpty(params);if(!_.isEqual(oldParams,params)){data=_.extend(data,{params:params})}oldParams=_.extend({},(_ref=this.node.get(\"meta\"))!=null?_ref.parammap:void 0);params={};this.each(function(row){return params[row.id]=row.get(\"display\")});params=this.packLists(params);params=this.stripEmpty(params);if(!_.isEqual(oldParams,params)){meta={parammap:params,fieldmap:(_ref2=this.node.get(\"meta\"))!=null?_ref2.fieldmap:void 0};data=_.extend(data,{meta:meta})}if(_.keys(data).length>0){return this.node.save(data,{success:function(){var _ref3;return options!=null?(_ref3=options.success)!=null?_ref3.apply(_this,arguments):void 0:void 0},error:function(){var _ref3;return options!=null?(_ref3=options.error)!=null?_ref3.apply(_this,arguments):void 0:void 0}})}else{return options!=null?(_ref3=options.success)!=null?_ref3.apply(this,{noop:true}):void 0:void 0}},unpackLists:function(params,options){var clone,i,key,model,models,skip,value,values,_len,_this=this;if(params==null)params={};if(options==null)options={};params=_.clone(params);this.each(function(model){var def,val;if(model.get(\"list\")){if(!(params[model.id]!=null)||!_.isArray(params[model.id])){def=(options!=null?options.update:void 0)?null:[null];val=params[model.id]!=null?[params[model.id]]:def;if(val!=null&&(val!=null?val[0]:void 0)!=null){if(_.isString(val[0]))val=val[0].split(\",\")}return params[model.id]=val}}});for(key in params){values=params[key];if(_.isArray(values)){for(i=0,_len=values.length;i<_len;i++){value=values[i];if(this.any(function(m){return m.get(\"parent\")===key&&m.getValue()===value})){if(options!=null)options.update=true}if(options!=null?options.update:void 0){models=this.where({parent:key});model=models[i];if((model!=null?model.id:void 0)!=null){params[model.id]=value}}else{if(this.get(key)!=null){skip=_.startsWith(key,\"__\")?true:false;if(!skip){clone=this.listAdd(key);params[clone.id]=value}}}}}}return params},packLists:function(params){var _this=this;if(params==null)params={};params=_.clone(params);this.each(function(model){var childs,values;if(model.get(\"list\")&&!model.get(\"parent\")){childs=_this.where({parent:model.id});childs=_.sortBy(childs,function(child){return child.get(\"order\")});values=[];_.each(childs,function(child){var val;val=params[child.id];if(val!=null)values.push(params[child.id]);return delete params[child.id]});values=values.join();return params[model.id]=values}});return params},listLength:function(parent){var childs;childs=this.where({parent:parent});return childs.length},listAdd:function(parent){var at,clone,i,json,model,newKey;model=this.get(parent);i=_.uniqueId();newKey=\"__\"+parent+i;if(!(this.get(newKey)!=null)){json=model.toJSON();json.key=newKey;json.value=null;json.display=null;json.order=i;json.parent=parent;clone=new this.model(json,{collection:this});clone.state.set(model.state.toJSON());at=1+this.indexOf(model)+this.listLength(parent);this.add(clone,{at:at})}return clone},listRemove:function(child,parent){var model;model=this.get(child);this.remove(model);if(parent!=null&&this.listLength(parent)===0){return this.listAdd(parent)}}});z.model.DeveloperAppFormRow=z.model.FormRow.extend({validate:function(attrs,options){var choices,isValid,value;if(this.isSoftRemoved)return null;value=this.getValue();if(this.get(\"choices\")){choices=this.get(\"choices\");if($.isArray(choices)&&choices.indexOf(value)>=0){isValid=true}else if($.isPlainObject(choices)&&choices[value]!=null){isValid=true}else{isValid=false}}else{return z.model.FormRow.prototype.validate.apply(this,arguments)}if(isValid){return null}else if(this.get(\"required\")){if((value!=null?value.toString().length:void 0)>0){return\"Invalid value\"}else{return\"Missing value\"}}else{return null}}});z.model.DeveloperAppFormSet=z.model.FormSet.extend({model:z.model.DeveloperAppFormRow,wrappedModel:null,fileToUpload:null,initialize:function(formRowModels,options){z.model.FormSet.prototype.initialize.apply(this,arguments);if(options!=null?options.model:void 0){return this.setWrappedModel(options!=null?options.model:void 0)}},setWrappedModel:function(model){this.wrappedModel=model;return this.initData()},setFileUpload:function(file){return this.fileToUpload=file},initData:function(){var _this=this;this.each(function(field){var currentValue;currentValue=_this.wrappedModel.get(field.id);return field.set(\"value\",currentValue)})},getValues:function(){var data,_this=this;data={};this.each(function(each){var value;value=each.getValue();if(value===\"null\")value=null;return data[each.get(\"key\")]=value});return data},save:function(){var _this=this;if(this.isValid()){if(this.fileToUpload){return this.fileToUpload.submit().done(function(data){_this.fileToUpload=null;return _this._saveForm()}).fail(function(xhr,textStatus,errorThrown){return _this._handleErrors(xhr)})}else{return this._saveForm()}}},_saveForm:function(){var values,_this=this;values=this.getValues();return this.wrappedModel.save(values,{wait:true,error:function(model,xhr,options){return _this._handleErrors(xhr)},success:function(model,response,options){_this.trigger(\"saveSuccess\",model,response,options)}})},_handleErrors:function(xhr){var errors,_ref;try{errors=JSON.parse(xhr.responseText).errors}catch(_error){}if(errors&&xhr.status===403){this.trigger(\"error\",this,errors,null)}else if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}});z.model.Invoice=z.model.Base.extend({getDateFormat:function(date){var day,month,year;if(typeof date===\"number\")date=new Date(date*1e3);day=date.getDate();month=date.getMonth()+1;year=date.getFullYear();return\"\"+month+\"/\"+day+\"/\"+year},getDollarFormat:function(int){var cents,dollars;if(int>0){dollars=Math.floor(int/100)}else if(int<0){dollars=Math.ceil(int/100)}else{dollars=0}cents=\"0\"+(int-dollars*100);return dollars+\".\"+cents.substr(cents.length-2)},toFancyJSON:function(obj){var isTimestamp,key,val;if(typeof obj!==\"object\")obj=this.toJSON();isTimestamp=function(num){return num>1318851380};for(key in obj){val=obj[key];if(typeof val===\"number\"){if(isTimestamp(val)){obj[key+\"_pretty\"]=this.getDateFormat(val)}else{obj[key+\"_pretty\"]=this.getDollarFormat(val)}}if(typeof val===\"object\"&&val)obj[key]=this.toFancyJSON(val)}return obj}});z.model.InvoiceSet=z.model.BaseSet.extend({model:z.model.Invoice,url:z.cfg.api+\"/accounts/me/invoices\"});z.model.SupportDefinition=z.model.Base.extend({url:z.cfg.api});z.model.SupportDefinitionSet=z.model.BaseSet.extend({model:z.model.SupportDefinition,url:z.cfg.api});z.model.Embed=z.model.Base.extend({url:\"\"+z.cfg.api+\"/embedded\"});z.model.Update=z.model.Base.extend({urlRoot:z.cfg.api+\"/updates\"});z.model.UpdateSet=z.model.PaginationSet.extend({model:z.model.Update,url:z.cfg.api+\"/updates\"});z.model.Rule=z.model.Base.extend({urlRoot:function(){var readId,_ref,_ref2,_ref3;readId=((_ref=this.collection)!=null?(_ref2=_ref.read)!=null?_ref2.id:void 0:void 0)||((_ref3=this.read)!=null?_ref3.id:void 0);return z.cfg.api+\"/reads/\"+readId+\"/rules\"},setRead:function(read){this.read=read;return this.set({read_id:read.id})}});z.model.RuleSet=z.model.BaseSet.extend({model:z.model.Rule,url:function(){var id,_ref;id=(_ref=this.read)!=null?_ref.id:void 0;return z.cfg.api+(\"/reads/\"+id+\"/rules\")},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);return this.setRead(options.read)},setRead:function(read){var _this=this;this.read=read;return this.each(function(rule){return rule.set({read_id:read.id})})},getGroups:function(){var groups;groups=_.map(this.toJSON(),function(rule){return Number(rule.group)});groups=_.uniq(groups).sort();return groups},getMaxGroup:function(){var max;max=_.max(this.getGroups());if(!(max!=null)||max===-Infinity)max=0;return Number(max)}});z.model.Sample=z.model.Base.extend({initialize:function(options){this.options=options;return z.model.Base.prototype.initialize.apply(this,arguments)},parse:function(resp){var id,_ref;if((id=(_ref=this.collection)!=null?_ref.idAttribute:void 0)!=null){this.idAttribute=id}return resp},summary:function(params,options){var key,s;if(params==null)params={};s=\"Sample Data\";if(options!=null?options[\"default\"]:void 0)s=options[\"default\"];if((key=this.collection.displayKey(params))!=null&&params[key]!=null){s=params[key]}return s},buildRead:function(data){if(!(data!=null))data=this.toJSON();data=this.sanitize(data);return data},buildWrite:function(params,options){var context,data,_this=this;data={};context=this.toJSON();_.each(params,function(tmpl,key){var render,value;render=function(tmpl,context){var value;try{value=_this.render(tmpl,context)}catch(e){value=\"(Error: mismatched {{}})\"}return value};if(_.isArray(tmpl)){value=_.map(tmpl,function(each){return render(each,context)})}else{value=render(tmpl,context)}return data[key]=value});if((options!=null?options.sanitize:void 0)!==false){data=this.sanitize(data)}return data},sanitize:function(data){var k,out,v;out={};for(k in data){v=data[k];if(_.str.include(k,\"zap_meta\"))continue;if(_.str.include(v,\"hydrate|||\"))v=\"(Exists but not shown)\";out[k]=v}return out},isFiltered:function(){return this.get(\"zap_meta_filter\")},getWhyFiltered:function(){var allIds,ids,ordered,_ref;ids=(_ref=this.get(\"zap_meta_filter\"))!=null?_ref.rule_ids:void 0;allIds=z.app.rules.map(function(rule){return rule.id});ordered=z.useful.orderRelative(allIds,ids);return _.str.toSentenceSerial(ordered)},render:function(tmpl,context){var k,regex,rendered,v;rendered=tmpl.toString();for(k in context){v=context[k];regex=new RegExp((\"{{\"+k+\"}}\").replace(/([.?*+^$[\\]\\\\(){}|-])/g,\"\\\\$1\"),\"g\");rendered=rendered.replace(regex,v)}return rendered.replace(\"{{}}\",\"\")}});z.model.SampleSet=z.model.BaseSet.extend({model:z.model.Sample,url:function(){var action;action=this.action!=null?\"/\"+this.action:\"\";return this.node.url()+\"/samples\"+action},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);this.node=options!=null?options.node:void 0;return this.action=options!=null?options.action:void 0},setIDKey:function(id){return this.idAttribute=id},prefillMap:function(prefill,data,options){var action,displayKeys,opts,payloadData,pfdata,targetKey,_this=this;pfdata=this.splitPrefill(prefill);action=pfdata[\"action\"];displayKeys=pfdata[\"displayKeys\"];targetKey=pfdata[\"targetKey\"];this.setIDKey(targetKey);this.action=action;payloadData=_.extend({zap_meta_limit:-1,zap_meta_hydrate:false,zap_meta_page:this.getPage(),zap_meta_prefill:true},data);if($.param(payloadData).length>4096){payloadData=_.map(payloadData,function(value,key){if(value.toString().length>256)return null;return[key,value]});payloadData=_.object(_.filter(payloadData,function(pair){return pair}))}opts={data:payloadData,update:true,remove:false,success:function(model,resp){var map,_ref;map=_this.doPrefillMap(model.toJSON(),displayKeys,targetKey);return options!=null?(_ref=options.success)!=null?_ref.call(_this,map):void 0:void 0},error:function(model,xhr){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}};return this.fetch(opts)},splitPrefill:function(prefillPath){var action,displayKeys,pfdata,targetKey,_ref;pfdata=prefillPath!=null?prefillPath.split(\".\"):void 0;action=pfdata!=null?pfdata[0]:void 0;targetKey=pfdata!=null?pfdata[1]:void 0;displayKeys=pfdata!=null?(_ref=pfdata[2])!=null?_ref.split(\",\"):void 0:void 0;return{action:action,targetKey:targetKey,displayKeys:displayKeys}},doPrefillMap:function(data,displayKeys,targetKey){var mapping,_this=this;mapping={};_.each(data,function(each){var displayKey,fallback,key,value,values,_i,_len;key=each[targetKey];value=\"\";if(displayKeys!=null){values=[];for(_i=0,_len=displayKeys.length;_i<_len;_i++){displayKey=displayKeys[_i];fallback=value.length>0?false:targetKey;values.push(each[_this.displayKey(each,displayKey,fallback)])}value=values.join(\" \")}else{value=each[_this.displayKey(each,null,targetKey)]}return mapping[key]=value});return mapping},displayKey:function(data,preferredKey,fallback){var defaults,key,_this=this;defaults=[\"name\",\"Name\",\"display\",\"Display\",\"title\",\"Title\",\"subject\",\"Subject\"];if(preferredKey!=null&&data[preferredKey]!=null&&data[preferredKey]!==\"\"){return preferredKey}if((typeof options!==\"undefined\"&&options!==null?options.fallback:void 0)===false){return null}key=_.find(defaults,function(key){if(data[key]!=null&&data[key]!==\"\")return true});if(key!=null)return key;return fallback;return displayKey},getPage:function(){var page;page=this.page!=null?this.page:0;return page},setPage:function(page){return this.page=page}});z.model.AccountLimits=z.model.Base.extend({url:z.cfg.api+\"/accounts/me/limits\"});z.model.AccountBonusSet=z.model.BaseSet.extend({url:z.cfg.api+\"/accounts/me/bonuses\"});z.model.Account=z.model.Base.extend({url:z.cfg.api+\"/accounts/me\",initialize:function(){var _this=this;z.model.Base.prototype.initialize.apply(this,arguments);return this.on(\"sync error\",function(){return _this.loaded=true})},isLoggedIn:function(){return this.id!=null},isStaff:function(){return this.get(\"is_staff\")},isDeveloper:function(){return this.get(\"is_developer\")},login:function(username,password,options){var data,_this=this;data={username:username,password:password};return $.ajax({url:z.cfg.api+\"/accounts/session\",type:\"PUT\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.fetch({cache:false});return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0},error:options!=null?options.error:void 0})},logout:function(options){var _this=this;return $.ajax({url:z.cfg.api+\"/accounts/session\",type:\"DELETE\",data:JSON.stringify(data),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;if(options!=null){if((_ref=options.success)!=null)_ref.apply(_this,arguments)}return global.router.goto(\"/\")},error:options!=null?options.error:void 0})},hasActiveCard:function(){var _ref;return((_ref=this.get(\"billing\"))!=null?_ref.active_card:void 0)!=null},switchPlan:function(planId,coupon,why,options){var error,opts,success,_this=this;if(coupon==null)coupon=null;if(why==null)why=null;if(options==null)options={};success=function(){var args,done;_this.unset(\"coupon\",{silent:true});args=arguments;done=_.after(2,function(){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,args):void 0:void 0});if(!z.app.plans)z.app.plans=new z.model.PlanSet;z.app.plans.fetch({cache:false,update:true,success:done,error:done});return _this.fetch({success:done,error:done})};error=function(){var _ref;_this.unset(\"coupon\",{silent:true});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};opts=_.extend(_.clone(options),{success:success,error:error,wait:true});return this.save({plan_id:planId,coupon:coupon,why:why},opts)},checkCoupon:function(coupon,options){return $.ajax({url:z.cfg.api+\"/accounts/coupon\",type:\"POST\",data:JSON.stringify({coupon:coupon}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},saveCard:function(token,options){var error,success,_this=this;success=function(){var _ref;_this.unset(\"card_token\",{silent:true});_this.fetch();return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(){var _ref;_this.unset(\"card_token\",{silent:true});return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};this.set({card_token:token},{silent:true});return this.save({},{success:success,error:error,wait:true})},deleteAccount:function(password,options){if(options==null)options={};options.data={password:password};return this.destroy(options)},accountCreated:function(){z.store.set(\"showPersonaModal\",true);z.store.set(\"guiderPreferences\",{editorMapping:z.tests.editorMappingGuiders});z.app.track.gaPageTrack(\"/app/signup/success\")},checkUsernameAvailable:_.throttle(this._checkUsernameAvailable,200),_checkUsernameAvailable:function(username,options){var data,error,success;data={username:username};return $.ajax({type:\"GET\",url:z.cfg.api+(\"/accounts/username?\"+$.param(data)),dataType:\"json\",contentType:\"application/json\"},success=options!=null?options.success:void 0,error=options!=null?options.error:void 0)},sendForgotPasswordEmail:function(email,options){return $.ajax({type:\"POST\",data:JSON.stringify({email:email}),url:z.cfg.api+\"/accounts/password/forgot\",dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},resetPassword:function(username,code,password1,password2,options){return $.ajax({type:\"POST\",data:JSON.stringify({username:username,code:code,password1:password1,password2:password2}),url:z.cfg.api+\"/accounts/password/reset\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0})},sendEmailConfirmation:function(options){var syncOptions;syncOptions={url:z.cfg.api+\"/accounts/me/confirm\",type:\"post\",data:JSON.stringify({}),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},trialDaysLeft:function(){var end,now;if(!this.isTrialing())return null;now=Math.round((new Date).getTime()/1e3);end=this.get(\"trial_end_date\");if(!(end!=null))return null;if(end<now)return 0;return Math.round((end-now)/(60*60*24))},isTrialing:function(){return!!this.get(\"trial_end_date\")},isFree:function(){return this.getCurrentPlanAmount()===0},getCurrentPlan:function(){var _ref;if(!z.app.plans)z.app.plans=new z.model.PlanSet;if(this.get(\"plan_id\")){return(_ref=z.app.plans)!=null?_ref.get(this.get(\"plan_id\")):void 0}return null},getCurrentPlanAmount:function(){var amount,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;amount=null;if(!(((_ref=this.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.plan:void 0:void 0)!=null)){amount=0}else if(((_ref3=this.get(\"billing\"))!=null?(_ref4=_ref3.subscription)!=null?(_ref5=_ref4.plan)!=null?_ref5.amount:void 0:void 0:void 0)!=null){amount=(_ref6=this.get(\"billing\"))!=null?(_ref7=_ref6.subscription)!=null?(_ref8=_ref7.plan)!=null?_ref8.amount:void 0:void 0:void 0}return amount},planId:function(){return this.get(\"plan_id\")},hasCard:function(){var card,_ref;card=(_ref=this.get(\"billing\"))!=null?_ref.active_card:void 0;return card!=null},isUnlimited:function(){var unlimited;unlimited=this.get(\"is_unlimited\");return unlimited!=null&&unlimited},isPaying:function(){var paying;paying=this.isTrialing()&&this.hasCard();return paying!=null&&paying}});z.model.Partner=z.model.Base.extend({initialize:function(){var _ref,_this=this;this.hasIframeJs=false;window.addEventListener(\"message\",function(e){var json;try{json=JSON.parse(e.data)}catch(e){return}if((json!=null?json.event:void 0)===\"exist\"){_this.hasIframeJs=true;return z.app.trigger(\"render\")}});if((_ref=window.top)!=null){_ref.postMessage(JSON.stringify({event:\"exist\"}),\"*\")}},isPartnerSession:function(){var _ref;return((_ref=_.keys(this.toJSON()))!=null?_ref.length:void 0)>0}});z.model.Cache=Backbone.Model.extend({url:function(){var url;url=\"/cache/\";if(this.key!=null)url+=this.key+\"/\";if(this.expiry!=null)url+=this.expiry;return z.cfg.api+url},setKey:function(key){return this.key=key},setExpiry:function(expiry){return this.expiry=expiry},parse:function(response){var filtered,_this=this;filtered={};_.each(response,function(v,k){if(_.isObject(v)&&_.keys(v)===0)return;if(_.isString(v)&&v===\"\")return;if(_.isArray(v)&&v.length===0)return;return filtered[k]=v});return filtered}});z.model.State=Backbone.Model.extend();z.model.SupportNote=z.model.Base.extend({urlRoot:z.cfg.api+\"/support/notes\",vote:function(options,helpful){var syncOptions;if(helpful==null)helpful=\"yes\";syncOptions={type:\"post\",data:JSON.stringify({helpful:helpful}),url:\"\"+this.url(),dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)}});z.model.SupportNoteSet=z.model.BaseSet.extend({model:z.model.SupportNote,url:z.cfg.api+\"/support/notes\"});z.model.Field=z.model.Base.extend({initialize:function(options){this.options=options;return z.model.Base.prototype.initialize.apply(this,arguments)},getKey:function(){return this.get(\"key\")},getLabel:function(){if(this.get(\"label\")!=null)return this.get(\"label\");return _.superHumanize(this.get(\"key\"))},getSample:function(){return this.get(\"zap_meta_sample\")}});z.model.FieldSet=z.model.BaseSet.extend({model:z.model.Field,url:function(){return this.node.url()+\"/gives\"},initialize:function(models,options){z.model.BaseSet.prototype.initialize.apply(this,arguments);return this.node=options!=null?options.node:void 0},exportMeta:function(){var humanize,meta;meta={};humanize=function(match){match=match.replace(/\\{\\{/g,\"\");match=match.replace(/\\}\\}/g,\"\");return _.superHumanize(match)};this.each(function(field){var key,label;key=z.cfg.userfillOTag+field.get(\"key\")+z.cfg.userfillETag;label=field.get(\"label\");if(!(label!=null))label=humanize(key);return meta[key]=label});return meta}});z.model.Read=z.model.StrictSingleton(z.model.Node.extend({urlRoot:z.cfg.api+\"/reads\",customNeeds:[],customGives:[],initialize:function(attrs,options){return z.model.Node.prototype.initialize.apply(this,arguments)\n},parse:function(response){if(response[\"lastchanged\"]!=null)delete response[\"lastchanged\"];if(response[\"date\"]!=null){this.date=new Date(response[\"date\"]);delete response[\"date\"]}if(response[\"fancy_title\"]!=null&&!(response[\"title\"]!=null)){response[\"title\"]=response[\"fancy_title\"]}delete response[\"fancy_title\"];return response},getFiltersIds:function(){return this.get(\"filter_ids\")},isComplete:function(){return this.id!=null&&this.get(\"selected_api\")!=null&&this.get(\"action\")!=null&&this.get(\"write_ids\").length>0&&this.get(\"collect_errors\").length===0},run:function(options){var syncOptions;syncOptions={type:\"get\",url:\"\"+this.url()+\"/run\",dataType:\"json\",contentType:\"application/json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0,cache:false};return Backbone.sync(\"read\",this,syncOptions)},runStatus:function(options){var syncOptions;syncOptions={type:\"get\",cache:false,url:\"\"+this.url()+\"/run/status\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"read\",this,syncOptions)},hasErrors:function(){var _ref;return((_ref=this.get(\"collect_errors\"))!=null?_ref.length:void 0)>0},getActionNoun:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s!=null?s.getActionName(this.get(\"action\"),\"read\",\"true\"):void 0;return noun},getActionLabel:function(){var noun,s;s=z.app.services.get(this.get(\"selected_api\"));noun=s!=null?s.getActionName(this.get(\"action\"),\"read\",\"false\"):void 0;return noun},isLive:function(){return!this.get(\"paused\")},canShare:function(){var globalService,hasShared,_ref;globalService=(_ref=this.getService())!=null?_ref.get(\"public\"):void 0;hasShared=this.get(\"has_shared\");return globalService&&!hasShared},share:function(data,options){var error,success,syncOptions,_this=this;success=function(model,resp,opts){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};error=function(model,xhr,opts){var _ref;return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};syncOptions={type:\"post\",cache:false,url:\"\"+this.url()+\"/share\",contentType:\"application/json\",dataType:\"json\",data:JSON.stringify(data),success:success,error:error};return Backbone.sync(\"create\",this,syncOptions)},getTitle:function(){return this.get(\"fancy_title\")||this.get(\"title\")},copy:function(options){var reqOptions,_this=this;reqOptions={type:\"post\",url:\"\"+this.url()+\"/copy\",contentType:\"application/json\",dataType:\"json\",success:function(){(new z.model.ReadSet).fetch({update:true,cache:false});(new z.model.WriteSet).fetch({update:true,cache:false});return options!=null?options.success.apply(_this,arguments):void 0},error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,reqOptions)},subscribeHook:function(options){var syncOptions;syncOptions={type:\"post\",url:\"\"+this.url()+\"/subscription\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"create\",this,syncOptions)},tearDownHook:function(options){var syncOptions;syncOptions={type:\"delete\",url:\"\"+this.url()+\"/subscription\",contentType:\"application/json\",dataType:\"json\",success:options!=null?options.success:void 0,error:options!=null?options.error:void 0};return Backbone.sync(\"destroy\",this,syncOptions)},pause:function(options){return this.save({paused:true},options)},unpause:function(options){var error,success,syncOptions,_this=this;success=function(model,resp,opts){success=function(){var _ref;return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0};return _this.fetch({cache:false,success:success})};error=function(model,xhr,opts){var _ref;if(xhr.status===409)return success();return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0};syncOptions={type:\"put\",cache:false,url:\"\"+this.url()+\"/unpause\",contentType:\"application/json\",dataType:\"json\",success:success,error:error};return Backbone.sync(\"update\",this,syncOptions)}}));z.model.ReadSet=z.model.Singleton(z.model.NodeSet.extend({model:z.model.Read,url:z.cfg.api+\"/reads\"}));var __hasProp=Object.prototype.hasOwnProperty;z.model.Service=z.model.Base.extend({url:z.cfg.api+\"/services\",idAttribute:\"key\",getName:function(){if(this.get(\"meta\").human_readable_key!=null){return this.get(\"meta\").human_readable_key}return this.get(\"key\")},getNameArticle:function(){var letter,v,vowel,vowels,_i,_len;vowels=[\"a\",\"e\",\"i\",\"o\",\"u\"];vowel=false;letter=this.getName().toLowerCase()[0];for(_i=0,_len=vowels.length;_i<_len;_i++){v=vowels[_i];if(letter===v)vowel=true}if(vowel)return\"an\";return\"a\"},isPremium:function(){return this.get(\"premium\")},hasReads:function(){if(this.countActions(this.get(\"read\"))>0)return true;return false},hasWrites:function(){if(this.countActions(this.get(\"write\"))>0)return true;return false},countActions:function(actions){var action,isEmpty;isEmpty=function(object){var key,value;if(object!=null?object.hide:void 0)return true;for(key in object){if(!__hasProp.call(object,key))continue;value=object[key];return false}return true};actions=function(){var _i,_len,_results;_results=[];for(_i=0,_len=actions.length;_i<_len;_i++){action=actions[_i];if(!isEmpty(action))_results.push(action)}return _results}();return actions.length},hasUpfronts:function(){var _ref;if(((_ref=this.get(\"upfront_fields\"))!=null?_ref.length:void 0)>1){return true}return false},needsAuth:function(){var _ref;if(((_ref=this.getUpfronts())!=null?_ref.length:void 0)>0){return true}if(this.get(\"oauth\"))return true;return false},getUpfronts:function(){var context,upfronts;upfronts=[];context={service:this.getName()};_.each(this.get(\"upfront_fields\"),function(field){var newField;newField={};_.each(field,function(v,k){if(_.isString(v))v=z.useful.render(v,context);return newField[k]=v});return upfronts.push(newField)});return upfronts},isHook:function(action,which,needsURL){var meta;if(which==null)which=\"read\";if(needsURL==null)needsURL=true;meta=this.getActionMeta(action,which);if(!(meta!=null))return;return Boolean(meta.hook)&&(!needsURL||meta.hook_url!=null)},isSubHook:function(action,which){var meta;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!(meta!=null))return;return Boolean(meta.hook_subscription)},getWebhookURL:function(action,which,object){var meta,template;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!((meta!=null?meta.hook_url:void 0)!=null))return;template=_.template(meta.hook_url);return template({cid:z.app.account.get(\"id\"),ccode:z.app.account.get(\"code\"),sid:object!=null?object.id:void 0,scode:object!=null?object.get(\"code\"):void 0,code:object!=null?object.get(\"code\"):void 0})},getWebhookDirections:function(action,which){var meta;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);if(!((meta!=null?meta.hook_url:void 0)!=null))return;return meta.hook_directions_html},getImageClass:function(size){var css,_ref;if(size==null)size=\"64x64\";if(((_ref=this.get(\"css\"))!=null?_ref[size]:void 0)!=null){css=this.get(\"css\")[size]}else{css=\"placeholder\"}return css},getCategories:function(){return this.get(\"categories\")},parseActions:function(actions,currentSelection){var filtered,_this=this;if(!_.any(actions,function(action){if((action!=null?action.important:void 0)===true)return true})){_.each(actions,function(action){action[\"important\"]=true;if(!(action.label!=null)){return action[\"label\"]=_.superHumanize(action.key)}})}filtered=_.filter(actions,function(action){return(action!=null?action.key:void 0)===currentSelection||!(action!=null?action.hide:void 0)});return filtered},getActionName:function(action,which,noverb){var meta,name,words,_this=this;if(which==null)which=\"read\";if(noverb==null)noverb=\"false\";noverb=noverb===\"true\";meta=this.getActionMeta(action,which);if(!(meta!=null))return;name=_.superHumanize(meta.key);if(meta.label!=null)name=meta.label;words=_.words(name);_.each([\"New\",\"Updated\",\"Update\",\"Changed\",\"Delete\",\"Create\",\"Add\",\"Added\",\"Set\",\"Send\",\"Submit\",\"Call\",\"Order\",\"Catch\",\"Copy\",\"Append\",\"/\",\"Move\",\"Remove\",\"Change\"],function(search){words[0]=words[0].replace(search,\"\");return words[0]=words[0].replace(search.toLowerCase(),\"\")});words[0]=words[0].replace(/^to$/i,\"\");if(noverb)name=words.join(\" \");if(noverb)name=name.replace(/\\((.+?)\\)/,\"\");name=_.trim(name);return name},getActions:function(which,currentSelection){if(which==null)which=\"read\";return this.parseActions(this.get(which),currentSelection)},getActionMeta:function(action,which){var each,_i,_len,_ref;if(which==null)which=\"read\";_ref=this.parseActions(this.get(which),action);for(_i=0,_len=_ref.length;_i<_len;_i++){each=_ref[_i];if(each.key===action)return each}},getCopyOverride:function(action,which,copy){var meta,_ref;if(which==null)which=\"read\";meta=this.getActionMeta(action,which);return meta!=null?(_ref=meta.editor_copy)!=null?_ref[copy]:void 0:void 0},isActionImportant:function(which,action){var actions,important,_this=this;if(which==null)which=\"read\";actions=this.getActions(which);important=_.any(actions,function(each){return each.key===action&&each.important!=null&&each.important});return important},anyImportantActions:function(which){var action,_i,_len,_ref;if(which==null)which=\"read\";_ref=this.get(which);for(_i=0,_len=_ref.length;_i<_len;_i++){action=_ref[_i];if(action.important!=null&&action.important)return true}return false},getNeeds:function(which,action){var allNeeds,need,needs,_this=this;if(which==null)which=\"read\";allNeeds=this.get(which);need=_.find(allNeeds,function(need){if(need.key===action)return true});needs=need!=null?need.needs:void 0;return needs}});z.model.ServiceSet=z.model.BaseSet.extend({model:z.model.Service,url:z.cfg.api+\"/services\",comparator:function(service){return service.getName()},visibleList:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true})},hasReads:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.hasReads())return false;return true})},hasWrites:function(){var _this=this;return this.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.hasWrites())return false;return true})},sortPageAlpha:function(perPage){var group,grouped,ordered,sorted,_i,_len,_ref,_this=this;ordered=this.sortBy(function(service){return service.get(\"order\")});grouped=_.groupBy(ordered,function(service,i){return Math.floor(i/perPage)});sorted=[];_ref=_.toArray(grouped);for(_i=0,_len=_ref.length;_i<_len;_i++){group=_ref[_i];sorted=sorted.concat(_.sortBy(group,function(service){return service.getName()}))}return this.reset(sorted)},sortOrder:function(perPage){var sorted,_this=this;sorted=this.sortBy(function(service){return service.get(\"order\")});return this.reset(sorted)}});z.model.Track=z.model.Base.extend({url:z.cfg.api+\"/events\",dupe:{},initialize:function(){var _this=this;z.model.Base.prototype.initialize.apply(this,arguments);_.bindAll(this);return Backbone.history.on(\"route\",function(){var path;path=Backbone.history.location.pathname;_this[\"new\"](\"navigate\",{path:path});if(!z.cfg.debug)return _this.gaPageTrack()})},\"new\":function(message,data){if(!(this.dupe[message]!=null)){this.dupe[message]=_.debounce(this.send,50)}return this.dupe[message](message,data)},send:function(message,data){if(z.cfg.debug){return log(\"tracking an event:\",message,data)}else{return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:data}),url:this.url,contentType:\"application/json\",dataType:\"json\"})}},gaPageTrack:function(path){var title;if(!(path!=null))path=Backbone.history.location.pathname;title=typeof document!==\"undefined\"&&document!==null?document.title:void 0;log(\"GA:\",title,path);if(typeof _gaq!==\"undefined\"&&_gaq!==null){_gaq.push([\"_trackPageview\",path])}return typeof ga===\"function\"?ga(\"send\",\"pageview\",{page:path,title:title}):void 0}});window.onerrordupe={};window.onerror=function(message,url,linenumber){var send,trace,_ref,_this=this;trace=(_ref=printStackTrace())!=null?_ref.join(\"\\n\\n\"):void 0;send=function(message,url,linenumber,trace){var error;error={message:message,url:url,linenumber:linenumber,trace:trace};return Backbone.ajax({type:\"POST\",data:JSON.stringify({message:message,data:error}),url:z.cfg.api+\"/events/errors\",contentType:\"application/json\",dataType:\"json\"})};if(!(window.onerrordupe[message]!=null)){window.onerrordupe[message]=_.debounce(send,50)}return window.onerrordupe[message](message,url,linenumber,trace)};var partnerChecks;z.controllers.Base=Backbone.Router.extend({constructor:function(options){var _this=this;Backbone.Router.prototype.constructor.apply(this,arguments);_.bindAll(this);Backbone.history.on(\"route\",this._route,this);Backbone.history.on(\"route\",function(){var _ref;if(((_ref=Backbone.history.getHash())!=null?_ref.length:void 0)<1){return $.scrollTo({top:0,left:0,duration:0})}},this)},_route:function(){var fragment,route;route=arguments[1];fragment=Backbone.history.fragment;if(!(route!=null))return;Backbone.history.last=fragment;if(!_.any(this.routes,function(v,k){return v===route})){if(typeof this.remove===\"function\")this.remove(route,fragment)}if(_.any(this.routes,function(v,k){return v===route})){return typeof this.match===\"function\"?this.match(route,fragment):void 0}},requireLogin:function(){var redirect,_this=this;redirect=function(){z.useful.goto(\"/app/login?next=/\"+Backbone.history.fragment);throw\"Login required!\"};if(z.app.account.loaded&&!z.app.account.isLoggedIn()){return redirect()}else{return z.app.account.once(\"sync\",function(){if(z.app.account.loaded&&!z.app.account.isLoggedIn())return redirect()})}}});partnerChecks=function(route,options){var allowed,iframed,pass,_this=this;if(options==null)options={};iframed=window!==(typeof window!==\"undefined\"&&window!==null?window.top:void 0);route=_.ltrim(route,\"/\");allowed=[\"app/edit\",\"app/explore\",\"app/dashboard\",\"app/history\",\"app/settings/authorizations\"];pass=true;if(z.app.partner.isPartnerSession()){pass=false;pass=_.any(allowed,function(allow){return _.str.include(route,allow)})}return pass};Backbone.history._navigate=Backbone.history.navigate;Backbone.history.navigate=function(){if(partnerChecks.apply(this,arguments)){return Backbone.history._navigate.apply(this,arguments)}};z.controllers.Settings=z.controllers.Base.extend({routes:{\"app/settings\":\"overview\",\"app/settings/\":\"overview\",\"app/settings/plans\":\"plans\",\"app/settings/plans/\":\"plans\",\"app/settings/plans/:showCoupon\":\"plans\",\"app/settings/invoices\":\"invoices\",\"app/settings/invoices/\":\"invoices\",\"app/settings/card\":\"card\",\"app/settings/card/\":\"card\",\"app/settings/authorizations\":\"auths\",\"app/settings/authorizations/\":\"auths\",\"app/settings/authorizations/:key\":\"auths\",\"app/settings/authorizations/replace/:key\":\"auths\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"settings\"},remove:function(){var _this=this;_.each(this.views,function(view){return view.remove()})},card:function(){this.options={card:true};return this.overview()},overview:function(options){this.requireLogin();z.app.viewport.title(\"Account Settings\");async.series([this.loadOverviewModels,this.loadOverview,this.renderOverview])},loadOverviewModels:function(cb){var _this=this;z.app.preloader.start(2);return async.parallel({accountBonuses:async.fetch(new z.model.AccountBonusSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadOverview:function(cb){$(\"#app\").html(JST.settings_base({}));this.$myAccount=$(\"#app .my-account\");this.$billing=$(\"#app .billing\");this.$extra=$(\"#app .extra\");this.views.myAccount=new z.ui.MyAccountSettings(this.options);this.views.billing=new z.ui.BillingSettings(this.options);this.views.extra=new z.ui.ExtraSettings(this.options);return typeof cb===\"function\"?cb():void 0},renderOverview:function(cb){this.$myAccount.html(this.views.myAccount.render().el);this.$billing.html(this.views.billing.render().el);this.$extra.html(this.views.extra.render().el);return typeof cb===\"function\"?cb():void 0},plans:function(showCoupon){this.showCoupon=showCoupon===\"coupon\";this.requireLogin();z.app.viewport.title(\"Plans\");async.series([this.loadPlanModels,this.loadPlans,this.renderPlans])},loadPlanModels:function(cb){var _this=this;z.app.preloader.start(1);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadPlans:function(cb){this.views.plans=new z.ui.PlanSelect({showCoupon:this.showCoupon});return typeof cb===\"function\"?cb():void 0},renderPlans:function(cb){$(\"#app\").html(this.views.plans.render().el);return typeof cb===\"function\"?cb():void 0},invoices:function(){this.requireLogin();z.app.viewport.title(\"Invoices\");async.series([this.loadInvoiceModels,this.loadInvoices,this.renderInvoices])},loadInvoiceModels:function(cb){var _this=this;z.app.preloader.start(1);return async.parallel({invoices:async.fetch(new z.model.InvoiceSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadInvoices:function(cb){this.views.invoices=new z.ui.Invoices({});return typeof cb===\"function\"?cb():void 0},renderInvoices:function(cb){$(\"#app\").html(this.views.invoices.render().el);return typeof cb===\"function\"?cb():void 0},auths:function(key){this.requireLogin();z.app.viewport.title(\"Connected Accounts\");this.addService=key;async.series([this.loadAuthModels,this.loadAuths,this.renderAuths])},loadAuthModels:function(cb){var _this=this;z.app.preloader.start(4);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),auths:async.fetch(new z.model.AuthSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadAuths:function(cb){this.views.auths=new z.ui.Auths({addService:this.addService});return typeof cb===\"function\"?cb():void 0},renderAuths:function(cb){$(\"#app\").html(this.views.auths.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.Explore=z.controllers.Base.extend({routes:{\"app/explore\":\"explore\",\"app/explore*qs\":\"explore\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"explore\"},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.search)!=null)_ref.off();return(_ref2=this.recipes)!=null?_ref2.off():void 0},explore:function(){z.app.track[\"new\"](\"Visit Page: explore\",{path:window.location.pathname});z.app.viewport.title(\"Explore\");async.series([this.loadModels,this.loadViews,this.renderViews])},storeFilters:function(filters){return z.store.set(\"recipe-filters\",filters,{expires:60*15})},restoreFilters:function(){var filters;filters={};filters=z.store.get(\"recipe-filters\")||{};_.extend(filters,_.object((new z.useful.QueryString).pairs||Array()));return filters},loadModels:function(cb){var recipeOptions,_this=this;z.app.preloader.start(3);recipeOptions={filters:this.restoreFilters(),pagination:{perPage:15}};return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),recipes:async.fetch(new z.model.RecipeSet([],recipeOptions),{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();z.app.recipes.filters.on(\"change\",function(){return _this.storeFilters(z.app.recipes.filters.toJSON())},_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={recipes:z.app.recipes};$(\"#app\").html(JST.explore_base({}));this.$search=$(\"#app .search\");this.$results=$(\"#app .results\");this.views.search=new z.ui.ExploreSearch(options);this.views.results=new z.ui.ExploreResults(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$search.html(this.views.search.render().el);this.$results.html(this.views.results.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.SignUp=z.controllers.Base.extend({routes:{\"app/signup\":\"signup\",\"app/signup?*querystring\":\"signup\"},views:{},match:function(){z.cfg.defaultSupportTags=\"signup\";if(!z.app.account.isLoggedIn()){return $(\"#header .hiring, #header .links-container, #header .menu-account, #header .menu-login\").addClass(\"hide\")}},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.sidebar)!=null)_ref.off();if((_ref2=this.recipes)!=null)_ref2.off();return $(\"#header .hiring, #header .links-container, #header .menu-account, #header .menu-login\").removeClass(\"hide\")},signup:function(){z.app.track[\"new\"](\"Visit Page: signup\",{path:window.location.pathname});z.app.viewport.title(\"Signup\");this.querystring=_.object((new z.useful.QueryString).pairs||Array());async.series([this.loadRecipe,this.loadModels,this.loadViews,this.renderViews])},loadRecipe:function(cb){var service,_this=this;z.app.preloader.start(3);this.recipe=null;if(this.querystring.recipe_id){return(this.recipe=new z.model.Recipe({id:this.querystring.recipe_id})).fetch({success:function(){return typeof cb===\"function\"?cb():void 0},error:function(){_this.recipe=null;return typeof cb===\"function\"?cb():void 0}})}else if(this.querystring.read_service||this.querystring.write_service){this.recipe=new z.model.Recipe({id:\"fake\",generated:true,read_data:{selected_api:this.querystring.read_service,action:this.querystring.read_action},write_data:{selected_api:this.querystring.write_service,action:this.querystring.write_action}});return typeof cb===\"function\"?cb():void 0}else if(this.querystring.next!=null&&_.str.include(this.querystring.next,\"API\")){service=this.querystring.next.match(\"(.*/)?(.*API)(.*)?\")[2];this.recipe=new z.model.Recipe({id:\"fake\",generated:true,read_data:{selected_api:service,action:null},write_data:{selected_api:null,action:null}});return typeof cb===\"function\"?cb():void 0}else{return typeof cb===\"function\"?cb():void 0}},loadModels:function(cb){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={querystring:this.querystring,recipe:this.recipe};$(\"#app\").html(JST.signup_base({}));this.$signUpWhy=$(\"#app .signup-why\");this.$signUpForm=$(\"#app .signup-form\");this.views.signUpWhy=new z.ui.SignUpWhy(options);this.views.signUpForm=new z.ui.SignUpForm(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$signUpWhy.html(this.views.signUpWhy.render().el);this.$signUpForm.html(this.views.signUpForm.render().el);this.$signUpForm.find(\"br\").first().remove();return typeof cb===\"function\"?cb():void 0}});z.controllers.Support=z.controllers.Base.extend({routes:{help:\"support\",\"help/\":\"support\",\"help/:qs\":\"support\",\"help/:qs/\":\"support\"},remove:function(route,fragment){return $(\".vote a\").off(\"click\",this.vote)},support:function(){var $el,para,paras,replaced,text,_i,_len,_this=this;if(Backbone.history.last!=null)Backbone.history.location.reload();z.app.supportDefinitions=new z.model.SupportDefinitionSet(typeof preload!==\"undefined\"&&preload!==null?preload.definitions:void 0);paras=$(\".content > p\");for(_i=0,_len=paras.length;_i<_len;_i++){para=paras[_i];$el=$(para);text=$el.html();replaced=text;z.app.supportDefinitions.each(function(def){var regex,replace,slug,title,word;word=def.get(\"word\");title=def.get(\"text\");slug=def.get(\"read_more\");return regex=slug!=null?(replace=$(\"<a class='def' href='/help/\"+slug+\"' data-title='\"+title+\"'>\"+word+\"</a>\")[0],_this.highlightWord($el[0],word,replace)):(replace=$(\"<span class='def' data-title='\"+title+\"'>\"+word+\"</span>\")[0],_this.highlightWord($el[0],word,replace))});$el.find(\".def\").each(function(){$el=$(this);if($el.position().left>=$el.parent().width()/2){return $el.addClass(\"left\")}})}return $(\".vote a\").on(\"click\",this.vote)},vote:function(e){var $el,helpful,id,url,_ref;if(e!=null)e.preventDefault();$el=$(e.currentTarget);if(!($el!=null))return;id=$el.attr(\"data-id\");helpful=(_ref=$(e.currentTarget))!=null?_ref.attr(\"data-option\"):void 0;$el.closest(\".option-container\").text(\"Thanks!\");url=\"\"+z.cfg.api+\"/support/notes/\"+id;return $.ajax({type:\"POST\",url:url,data:JSON.stringify({helpful:helpful})})},highlightWord:function(root,word,replace){var cut,highlightWords,textNodesUnder;textNodesUnder=function(root){var a,n,w;n=void 0;a=[];w=document.createTreeWalker(root,NodeFilter.SHOW_TEXT,null,false);while(n=w.nextNode()){a.push(n)}return a};cut=function(str,cutStart,cutEnd){return str.substr(0,cutStart)+str.substr(cutEnd+1)};highlightWords=function(n){var after,insert,match,next,_results;match=new RegExp(\"\\\\b\"+word+\"\\\\b\",\"g\").exec(n.nodeValue);_results=[];while(match!==null){insert=replace.cloneNode(true);after=n.splitText(match.index+match[0].length);n.nodeValue=cut(n.nodeValue,match.index,match.index+match[0].length);after.parentNode.insertBefore(insert,after);n=after;next=new RegExp(\"\\\\b\"+word+\"\\\\b\",\"g\").exec(n.nodeValue);_results.push(match=next)}return _results};return textNodesUnder(root).forEach(highlightWords)}});z.controllers.Server=z.controllers.Base.extend({routes:{\"referral*q\":\"nothing\",\"support*q\":\"nothing\",\"partner*q\":\"nothing\",\"developer*q\":\"nothing\",\"users*q\":\"nothing\",\"about*q\":\"nothing\",\"privacy*q\":\"nothing\",\"terms*q\":\"nothing\",\"support*q\":\"nothing\",\"engine*q\":\"nothing\",\"marketing/*q\":\"nothing\",\"zapbook/updates*q\":\"nothing\",\"zapbook/share*q\":\"nothing\",\"checks*q\":\"nothing\",\"login*q\":\"nothing\",\"subscription*q\":\"nothing\",\"blog*q\":\"nothing\",\"comments*q\":\"nothing\"},nothing:function(){if(Backbone.history.last!=null)Backbone.history.location.reload()}});z.controllers.Simple=z.controllers.Base.extend({routes:{\"app/forgot\":\"forgot\",\"app/forgot/\":\"forgot\",\"app/forgot/:username/:code\":\"forgot\",\"app/forgot/:username/:code/\":\"forgot\",\"app/login\":\"login\",\"app/login/\":\"login\",\"app/login?*qs\":\"login\",\"app/login/?*qs\":\"login\",\"app/login/:status\":\"login\",\"app/login/:status/\":\"login\",bonus:\"rewards\",\"bonus/\":\"rewards\"},remove:function(){var _ref;return(_ref=this.view)!=null?_ref.remove():void 0},forgot:function(username,code){z.app.viewport.title(\"Forgot Password\");this.view=new z.ui.ForgotPassword({username:username,code:code});$(\"#app\").html(this.view.render().el)},login:function(status){var querystring;z.app.viewport.title(\"Login\");querystring=_.object((new z.useful.QueryString).pairs||Array());this.view=new z.ui.Login({status:status,querystring:querystring});return $(\"#app\").html(this.view.render().el)},rewards:function(){if(Backbone.history.last!=null)return Backbone.history.location.reload()}});z.controllers.Home=z.controllers.Base.extend({routes:{\"\":\"home\",\"/\":\"home\"},remove:function(){var _this=this;$(window).off(\"focus\");$(window).off(\"blur\");_.each(this.views,function(view){return view.remove()});return this.views={}},home:function(){if(Backbone.history.last!=null)Backbone.history.location.reload();z.app.viewport.title(\"Automate the Web\");async.series([this.loadViews]);this.preload()},loadViews:function(cb){this.view=new z.ui.Home({el:$(\"#app\")});return typeof cb===\"function\"?cb():void 0},preload:function(){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){return typeof cb===\"function\"?cb():void 0})}});z.controllers.SharedZaps=z.controllers.Base.extend({routes:{\"app/share\":\"explore\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"explore\"},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});if((_ref=this.search)!=null)_ref.off();return(_ref2=this.recipes)!=null?_ref2.off():void 0},explore:function(){z.app.track[\"new\"](\"Visit Page: share\",{path:window.location.pathname});z.app.viewport.title(\"Explore\");return async.series([this.loadModels,this.loadViews,this.renderViews])},storeFilters:function(filters){return z.store.set(\"recipe-filters\",filters,{expires:60*15})},restoreFilters:function(){var filters;filters={};filters=z.store.get(\"recipe-filters\")||{};_.extend(filters,_.object((new z.useful.QueryString).pairs||Array()));return null},loadModels:function(cb){var recipeOptions,_this=this;z.app.preloader.start(3);recipeOptions={filters:{userid:z.app.account.id},pagination:{perPage:10}};return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),recipes:async.fetch(new z.model.RecipeSet([],recipeOptions),{persist:true}),embed:async.fetch(new z.model.Embed,{persist:false,cache:false})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();z.app.recipes.filters.on(\"change\",function(){return _this.storeFilters(z.app.recipes.filters.toJSON())},_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){var options;options={recipes:z.app.recipes};$(\"#app\").html(JST.share_base({}));this.$shared=$(\"#app .results\");this.$embed=$(\"#app .embed\");this.views.embed=new z.ui.EmbededZaps({embed:z.app.embed});this.views.sharedZapsView=new z.ui.SharedZaps(options);return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){console.log(\"render views got called!\");this.$shared.html(this.views.sharedZapsView.render().el);this.$embed.html(this.views.embed.render().el);return typeof cb===\"function\"?cb():void 0}});z.controllers.Zapbook=z.controllers.Base.extend({routes:{\"zapbook/\":\"zapbook\",\"zapbook/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/\":\"zapbook\",\"zapbook/:serviceOneSlug/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:qs\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:recipeId/:recipeSlug/\":\"zapbook\",\"zapbook/:serviceOneSlug/:serviceTwoSlug/:recipeId/:recipeSlug/:qs\":\"zapbook\"},zapbook:function(s1,s2,recipe,recipeSlug){if(Backbone.history.last!=null)Backbone.history.location.reload();this.view=new z.ui.Zapbook({el:$(\"#app\"),s1:s1,s2:s2,recipe:recipe,recipeSlug:recipeSlug});this.preload()},preload:function(){var _this=this;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){return typeof cb===\"function\"?cb():void 0})}});z.controllers.Status=z.controllers.Base.extend({routes:{\"status/\":\"status\"},sizeTable:function(){return $(\".overflow-container\").css({maxWidth:$(\"body\").width()})},status:function(){if(Backbone.history.last!=null)Backbone.history.location.reload();this.view=new z.ui.Status({el:$(\"#app\")});this.sizeTable()}});z.controllers.Editor=z.controllers.Base.extend({routes:{\"app/edit\":\"redirect\",\"app/edit/:id\":\"redirect\",\"app/editor\":\"create\",\"app/editor/\":\"create\",\"app/editor/recipe/:id\":\"fromRecipe\",\"app/editor/recipe/:id/\":\"fromRecipe\",\"app/editor/:id\":\"edit\",\"app/editor/:id/\":\"edit\",\"app/editor/:id/:step\":\"edit\",\"app/editor/:id/:step/\":\"edit\"},views:{},seen:[],redirect:function(id){var url;url=id!=null?\"app/editor/\"+id:\"app/editor\";return Backbone.history.navigate(url,{trigger:true,replace:true})},fromRecipe:function(id){var recipe;recipe=new z.model.Recipe({id:id});return recipe.fetch({success:function(recipe,resp){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}})},match:function(){return z.cfg.defaultSupportTags=\"editor\"\n},remove:function(){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});this.views={};this.seen=[];this.id=null;this.step=null;if((_ref=z.app.read)!=null)_ref.off();if((_ref2=z.app.write)!=null)_ref2.off();return window.onbeforeunload=null},create:function(){this.flow=true;z.app.viewport.title(\"Create New Zap\");z.app.preloader.start(7);return async.series([this.createModels,this.load,z.app.preloader.done])},edit:function(id,step){this.flow=false;this.id=id;this.step=step;z.app.viewport.title(\"Editor\");z.app.preloader.start(4);return async.series([this.load,z.app.preloader.done])},createModels:function(cb){var createRead,createWrite,navigate,read,updateRead,write,_this=this;read=new z.model.Read;write=new z.model.Write;createRead=function(cb){return read.save({},{success:function(){return cb()}})};createWrite=function(cb){return write.save({read_id:read.id},{success:function(){return cb()}})};updateRead=function(cb){return read.save({write_ids:[write.id]},{success:function(){return cb()}})};navigate=function(cb){_this.id=read.id;Backbone.history.navigate(\"app/editor/\"+_this.id,{replace:true});return cb()};return async.series([createRead,createWrite,updateRead,navigate,function(){return cb()}])},load:function(cb){var _this=this;return async.series([this.loadModels,this.loadViews,this.renderViews,function(){return cb()}])},loadModels:function(cb){var loginRedirect,models,_this=this;z.app.read=new z.model.Read({id:this.id});z.app.write=new z.model.Write;models={services:async.fetch(new z.model.ServiceSet,{persist:true}),auths:async.fetch(new z.model.AuthSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})};if(this.id!=null){models.read=async.fetch(z.app.read,{persist:true})}loginRedirect=_.once(function(){return z.useful.goto(\"/app/login?next=/\"+Backbone.history.fragment)});return async.parallel(models,function(err,models){var id,next,_ref;if(err!=null)return loginRedirect();_.extend(z.app,models);next=[];id=(_ref=z.app.read.get(\"write_ids\"))!=null?_ref[0]:void 0;if(id!=null){z.app.write.set({id:id})}if(id!=null){next.push(async.fetch(z.app.write,{persist:true}))}z.app.readNeeds=new z.model.ParamFormSet([],{node:z.app.read});z.app.writeNeeds=new z.model.ParamFormSet([],{node:z.app.write});z.app.rules=new z.model.RuleSet([],{read:z.app.read});id=z.app.read.id;if(id!=null){next.push(async.fetch(z.app.rules,{persist:true}))}next.push(function(){if(z.app.reads!=null&&z.app.writes!=null){if(!(z.app.reads.get(z.app.read.id)!=null)){z.app.reads.add(z.app.read)}if(!(z.app.reads.get(z.app.write.id)!=null)){z.app.writes.add(z.app.write)}}return typeof cb===\"function\"?cb():void 0});if(z.app.read.hasErrors())_this.flow=true;next.push(function(){return cb()});return async.series(next)})},loadViews:function(cb){var options;options={read:z.app.read,write:z.app.write,rules:z.app.rules,readNeeds:z.app.readNeeds,writeNeeds:z.app.writeNeeds,flow:this.flow};this.views.steps=new z.ui.Steps(_.extend({},options,{}));this.views.servicesActions=new z.ui.ServiceActionStep(_.extend({},options,{}));this.views.triggerAuth=new z.ui.AuthStep(_.extend({},options,{isTrigger:true}));this.views.filters=new z.ui.FilterStep(_.extend({},options,{}));this.views.actionAuth=new z.ui.AuthStep(_.extend({},options,{isTrigger:false}));this.views.map=new z.ui.MapStep(_.extend({},options,{isTrigger:false}));this.views.test=new z.ui.TestStep(_.extend({},options,{}));this.views.enable=new z.ui.EnableStep(_.extend({},options,{}));return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){var options;options={read:z.app.read,write:z.app.write};$(\"#app\").html(JST.editor_base(options));this.views.steps.renderSteps();$(\"#app .editor\").html(this.views.steps.render().el);if(!this.flow)this.views.steps.showAllSteps();if(this.flow)this.next();return typeof cb===\"function\"?cb():void 0},next:function(view){var step,_ref,_this=this;if(view!=null){step=view.$el.closest(\"[data-id]\").attr(\"data-id\");if(_.contains(this.seen,step)||!(step!=null))return;this.seen.push(step)}if(((_ref=this.seen)!=null?_ref.length:void 0)>0){window.onbeforeunload=function(){return\"This Zap is not done yet! Are you sure you want to leave?\"}}return this.views.steps.showNext()}});z.controllers.Pricing=z.controllers.Base.extend({routes:{\"app/pricing\":\"pricing\",\"app/pricing/\":\"pricing\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"pricing\"},remove:function(){var _ref,_this=this;_.each(this.views,function(view){return view.remove()});return(_ref=this.plans)!=null?_ref.off():void 0},pricing:function(){z.app.track[\"new\"](\"Visit Page: pricing\",{path:window.location.pathname});z.app.viewport.title(\"Pricing\");async.series([this.loadModels,this.loadViews,this.renderViews,this.normalizePlanHeight])},loadModels:function(cb){var _this=this;z.app.preloader.start(2);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),plans:async.fetch(new z.model.PlanSet,{persist:true})},function(err,models){if(err!=null)throw err;_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){$(\"#app\").html(JST.pricing_base({}));this.$plans=$(\"#app .pricing\");this.views.plans=new z.ui.Plans({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$plans.html(this.views.plans.render().el);this.views.plans.normalizePlanHeight();return typeof cb===\"function\"?cb():void 0}});z.controllers.Dashboard=z.controllers.Base.extend({routes:{\"app/dashboard\":\"dashboard\",\"app/dashboard/\":\"dashboard\"},views:{},match:function(){return z.cfg.defaultSupportTags=\"dashboard\"},remove:function(route,fragment){var _ref,_ref2,_this=this;_.each(this.views,function(view){return view.remove()});this.views={};if((_ref=this.modal)!=null)_ref.close();return(_ref2=z.app.updates)!=null?_ref2.off():void 0},dashboard:function(){this.requireLogin();z.app.viewport.title(\"Dashboard\");async.series([this.loadModels,this.loadViews,this.renderViews])},loadModels:function(cb){var calls,_ref,_ref2,_ref3,_this=this;z.app.preloader.start(3);this.search=new z.model.Base({search:(_ref=z.app.partner.get(\"dashboard\"))!=null?_ref.search:void 0});calls={accountBonuses:async.fetch(new z.model.AccountBonusSet,{persist:true}),services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{cache:false,persist:true}),writes:async.fetch(new z.model.WriteSet,{cache:false,persist:true}),stream:async.fetch(new z.model.StreamSet([],{pagination:{perPage:50},filters:{}}),{cache:false,persist:true}),updates:async.fetch(new z.model.UpdateSet,{persist:true})};if((_ref2=z.app.partner)!=null?_ref2.isPartnerSession():void 0){calls.recipes=async.fetch(new z.model.RecipeSet([],{pagination:{page:1},filters:{partner:(_ref3=z.app.account.get(\"provider\"))!=null?_ref3.public_key:void 0}}),{persist:true})}return async.parallel(calls,function(err,models){_.extend(z.app,models);z.app.preloader.done();z.app.updates.on(\"change\",_this.showAnyUpdates,_this);return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){$(\"#app\").html(JST.dashboard_base({}));if(z.app.partner.isPartnerSession()&&z.app.reads.length===0){$(\"#app .dashboard .empty\").show();this.$partnerText=$(\"#app .dashboard .empty .left\");this.$partnerZaps=$(\"#app .dashboard .empty .right\");this.views.partnerText=new z.ui.PartnerText({el:this.$partnerText});this.views.partnerZaps=new z.ui.PartnerZaps({el:this.$partnerZaps,button:true});return typeof cb===\"function\"?cb():void 0}if(z.app.partner.isPartnerSession()){this.$start=$(\"#app .main-col .start\");this.views.partnerStart=new z.ui.PartnerZaps({button:false})}this.$zaps=$(\"#app .main-col .zaps\");this.$search=$(\"#app .main-col .search\");this.$side=$(\"#app .side-col\");this.views.search=new z.ui.DashboardSearch({model:this.search});this.views.zaps=new z.ui.Zaps({search:this.search});this.views.create=new z.ui.CreateBlock({});this.views.subscribe=new z.ui.SubscribeBlock({});this.views.limits=new z.ui.LimitsBlock({});this.views.logs=new z.ui.LogsBlock({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){var showPersona;if(z.app.partner.isPartnerSession()&&z.app.reads.length===0){this.views.partnerText.render();this.views.partnerZaps.render();return typeof cb===\"function\"?cb():void 0}if(z.app.partner.isPartnerSession()){this.$start.html(this.views.partnerStart.render().el)}this.$search.html(this.views.search.render().el);this.$zaps.html(this.views.zaps.render().el);this.$side.append(this.views.create.render().el);if(!z.app.account.get(\"is_subscribed_to_blog\")){this.$side.append(this.views.subscribe.render().el)}this.$side.append(this.views.limits.render().el);this.$side.append(this.views.logs.render().el);showPersona=z.store.get(\"showPersonaModal\");if(showPersona){new z.ui.Modal({view:new z.ui.PersonaFormModal})}this.showAnyUpdates();return typeof cb===\"function\"?cb():void 0},showAnyUpdates:function(){var updates;updates=this.newUpdates();if(!_.isEmpty(updates)){return new z.ui.Modal({view:new z.ui.SinceYouBeenGoneModal({model:updates})})}},newUpdates:function(){var last;last=z.store.get(\"lastUpdateViewedDatetime\");z.store.set(\"lastUpdateViewedDatetime\",Date.now());if(!last)last=Date.parse(z.app.account.get(\"last_login\"));this.recentUpdates=_.filter(z.app.updates.toJSON(),function(update){return Date.parse(update.date)>last});return this.recentUpdates}});z.controllers.History=z.controllers.Base.extend({routes:{\"app/history\":\"all\",\"app/history/:id\":\"single\",\"app/history*qs\":\"all\"},views:{},remove:function(){var _this=this;_.each(this.views,function(view){return view.remove()});return this.views={}},all:function(){this.requireLogin();this.querystring=_.object((new z.useful.QueryString).pairs||Array());z.app.viewport.title(\"Task History\");async.series([this.loadModels,this.loadViews,this.renderViews])},loadModels:function(cb){var filters,pagination,_ref,_ref2,_this=this;z.app.preloader.start(4);filters=_.extend({},_.compactObject((_ref=z.app.stream)!=null?_ref.filterStore:void 0),this.querystring);pagination=((_ref2=z.app.stream)!=null?_ref2.paginationStore:void 0)||{};pagination.perPage=25;return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true}),stream:async.fetch(new z.model.StreamSet([],{pagination:pagination,filters:filters},{persist:true}))},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadViews:function(cb){$(\"#app\").html(JST.history_base({}));this.$filters=$(\"#app .head\");this.$all=$(\"#app .body\");this.views.filters=new z.ui.HistoryFilters({});this.views.all=new z.ui.History({});return typeof cb===\"function\"?cb():void 0},renderViews:function(cb){this.$filters.html(this.views.filters.render().el);this.$all.html(this.views.all.render().el);return typeof cb===\"function\"?cb():void 0},single:function(id){this.id=id;this.requireLogin();this.querystring=_.object((new z.useful.QueryString).pairs||Array());z.app.viewport.title(\"Task History \"+this.id);async.series([this.loadSingleModels,this.loadSingleViews,this.renderSingleViews])},loadSingleModels:function(cb){var _this=this;z.app.preloader.start(4);return async.parallel({services:async.fetch(new z.model.ServiceSet,{persist:true}),reads:async.fetch(new z.model.ReadSet,{persist:true}),writes:async.fetch(new z.model.WriteSet,{persist:true}),streamItem:async.fetch(new z.model.Stream({id:this.id},{persist:true}))},function(err,models){_.extend(z.app,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})},loadSingleViews:function(cb){$(\"#app\").html(JST.history_base({id:this.id}));this.$nav=$(\"#app .head\");this.$details=$(\"#app .body\");this.views.nav=new z.ui.HistoryNav({id:this.id});this.views.details=new z.ui.HistoryDetails({streamItem:z.app.streamItem});return typeof cb===\"function\"?cb():void 0},renderSingleViews:function(cb){this.$nav.html(this.views.nav.render().el);this.$details.html(this.views.details.render().el);return typeof cb===\"function\"?cb():void 0}});var DEVELOPER_ROUTES,_DEVELOPER_ROUTES;_DEVELOPER_ROUTES={\"(/)\":\"dashboard\",\"/app/create(/)\":\"create\",\"/app/:id(/)\":\"viewApp\",\"/app/:id/meta(/)\":\"meta\",\"/app/:id/requests(/)\":\"requests\",\"/app/:id/activate(/)\":\"activate\",\"/app/:id/invite(/)\":\"invite\",\"/app/:id/migrate/:old_id\":\"migrate\",\"/app/:id/migrate(/)\":\"chooseMigrationTarget\",\"/app/:id/scripting(/)\":\"scripting\",\"/app/:id/auth/edit/fields/create(/)\":\"createAuthFieldWizard\",\"/app/:id/auth/edit/fields/:fieldId(/)\":\"editAuthFieldWizard\",\"/app/:id/auth/edit/:section(/)\":\"authWizard\",\"/app/:id/auth/settings(/)\":\"authSettings\",\"/app/:id/auth/fields/create(/)\":\"createAuthField\",\"/app/:id/auth/fields/:fieldId/edit(/)\":\"editAuthField\",\"/app/:id/triggers(/)\":\"triggers\",\"/app/:id/triggers/create(/)\":\"createTrigger\",\"/app/:id/triggers/create/test(/)\":\"createTestTrigger\",\"/app/:id/triggers/settings(/)\":\"triggerSettings\",\"/app/:id/triggers/:trigger/edit(/)\":\"editTrigger\",\"/app/:id/triggers/:trigger/edit/fields(/)\":\"triggerFields\",\"/app/:id/triggers/:trigger/edit/sample(/)\":\"editTriggerSample\",\"/app/:id/triggers/:trigger/edit/:section(/)\":\"editTrigger\",\"/app/:id/triggers/:trigger/fields(/)\":\"triggerFields\",\"/app/:id/triggers/:trigger/fields/create(/)\":\"createTriggerField\",\"/app/:id/triggers/:trigger/fields/:field(/)\":\"editTriggerField\",\"/app/:id/actions(/)\":\"actions\",\"/app/:id/actions/create(/)\":\"createAction\",\"/app/:id/actions/:action/edit(/)\":\"editAction\",\"/app/:id/actions/:action/edit/fields(/)\":\"actionFields\",\"/app/:id/actions/:action/edit/:section(/)\":\"editAction\",\"/app/:id/actions/:action/fields(/)\":\"actionFields\",\"/app/:id/actions/:action/fields/create(/)\":\"createActionField\",\"/app/:id/actions/:action/fields/:field(/)\":\"editActionField\"};DEVELOPER_ROUTES=_.object(_.map(_.keys(_DEVELOPER_ROUTES),function(r){return z.cfg.devpath+r}),_.values(_DEVELOPER_ROUTES));z.controllers.Developer=z.controllers.Base.extend({routes:DEVELOPER_ROUTES,views:{},isAppCacheStale:false,isAppSetCacheStale:false,remove:function(){var _this=this;return _.each(this.views,function(view){return view.remove()})},loadApp:function(appId,cb,additionalModels){var models,_this=this;if(additionalModels==null)additionalModels={};if(!(z.app.developer.app!=null)||z.app.developer.app.get(\"id\")!==Number(appId)||z.app.developer.isAppCacheStale){z.app.developer.isAppCacheStale=false;models={app:async.fetch(new z.model.DeveloperApp({id:appId}),{cache:false,persist:false})}}else{models={}}_.extend(models,additionalModels);z.app.preloader.start(_.keys(models).length);return async.parallel(models,function(err,model){var allowedUrls;_.extend(z.app.developer,model);z.app.viewport.title(z.app.developer.app.get(\"title\")+\" - Dev Platform\");z.app.preloader.done();if(!z.app.developer.app.isEditable()){allowedUrls=[\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),\"/\"+z.cfg.devpath+\"/\"+z.app.developer.app.get(\"id\")+\"/invite\"];if(!_.contains(allowedUrls,Backbone.history.location.pathname)){Backbone.history.navigate(allowedUrls[0],{trigger:true});return}}return typeof cb===\"function\"?cb():void 0})},placeInWrapper:function(view){$(\"#app\").html(JST.developer_base({}));return $(\"#app .developer-content\").html(view.render().el)},dashboard:function(){var loadModels,renderViews,_this=this;this.requireLogin();z.app.viewport.title(\"Dashboard - Dev Platform\");loadModels=function(cb){var options;z.app.preloader.start(1);options={};if(z.app.developer.isAppSetCacheStale){z.app.developer.isAppSetCacheStale=false;options.cache=false;options.persist=false}return async.parallel({apps:async.fetch(new z.model.DeveloperAppSet,options)},function(err,models){if(!(z.app.developer!=null))z.app.developer={};_.extend(z.app.developer,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})};renderViews=function(cb){var supportContainer;_this.views.dashboard=new z.ui.DeveloperDashboard({});if($(\"#app\").length===0){supportContainer=$(\"#app .support.container\");supportContainer.find(\".search\").after('<div class=\"column three-quarters developer\" id=\"developer\"></div>').remove();supportContainer.find(\".content\").remove()}$(\"#app\").html(JST.developer_base({}));$(\"#app .developer-nav\").hide();$(\"#app .developer-content\").html(_this.views.dashboard.render().el);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},viewApp:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app=new z.ui.DeveloperApp({subViews:{stats:new z.ui.DeveloperAppStats({}),auth:new z.ui.DeveloperAppAuth({}),triggers:new z.ui.DeveloperAppTriggers({}),actions:new z.ui.DeveloperAppActions({})}});_this.placeInWrapper(_this.views.app);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},create:function(){this.meta(null)},meta:function(id){var app,formLoader,linkModels,loadModels,renderViews,_this=this;this.requireLogin();formLoader={form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/meta\"}))};if(id!=null){loadModels=function(cb){return _this.loadApp(id,cb,formLoader)}}else{z.app.viewport.title(\"Create Service - Dev Platform\");loadModels=function(cb){z.app.preloader.start(1);return async.parallel(formLoader,function(err,models){_.extend(z.app.developer,models);z.app.preloader.done();return typeof cb===\"function\"?cb():void 0})}}app=null;linkModels=function(cb){if(id!=null){app=z.app.developer.app}else{app=new z.model.DeveloperApp}z.app.developer.form.setWrappedModel(app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_meta=new z.ui.DeveloperAppMeta({app:app});_this.placeInWrapper(_this.views.app_meta);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},authWizard:function(id,section){var extraModels,loadModels,renderViews,_this=this;if(section==null)section=\"scheme\";this.requireLogin();extraModels={};if(section===\"mapping\"){extraModels.form=async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-settings\"}))}loadModels=function(cb){return _this.loadApp(id,cb,extraModels)};renderViews=function(cb){var options;options={section:section};if(section===\"scheme\"){options.sectionView=new z.ui.DeveloperAppAuthEditorScheme}else if(section===\"fields\"){options.sectionView=new z.ui.DeveloperAppAuthEditorFields}else{z.app.developer.form.setWrappedModel(z.app.developer.app);options.sectionView=new z.ui.DeveloperAppAuthEditorForm(options)}_this.views.app_auth_editor=new z.ui.DeveloperAppAuthEditor(options);_this.placeInWrapper(_this.views.app_auth_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},authSettings:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-settings\"}))})};linkModels=function(cb){z.app.developer.form.setWrappedModel(z.app.developer.app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_auth_settings=new z.ui.DeveloperAppAuthSettings({});_this.placeInWrapper(_this.views.app_auth_settings);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},createAuthFieldWizard:function(id){return this.editAuthField(id,null,true)},editAuthFieldWizard:function(id,fieldId){return this.editAuthField(id,fieldId,true)},createAuthField:function(id){return this.editAuthField(id,null)},editAuthField:function(id,fieldId,isWizard){var field,linkModels,loadModels,renderViews,_this=this;if(isWizard==null)isWizard=false;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/auth-field\"}))})};field=null;linkModels=function(cb){if(fieldId!=null){field=z.app.developer.app.authFields.get(fieldId)}else{field=new z.model.DeveloperAppAuthField({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_auth_field_editor=new z.ui.DeveloperAppAuthFieldEditor({field:field,isWizard:isWizard});_this.placeInWrapper(_this.views.app_auth_field_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggers:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app_triggers=new z.ui.DeveloperAppTriggers({});_this.placeInWrapper(_this.views.app_triggers);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createTrigger:function(id){return this.editTrigger(id,null,\"appearance\")},createTestTrigger:function(id){return this.editTrigger(id,null,\"appearance\",true)},editTrigger:function(id,triggerId,section,asTest){var formName,linkModels,loadModels,renderViews,sectionToFormNameMap,trigger,_this=this;if(section==null)section=\"appearance\";if(asTest==null)asTest=false;this.requireLogin();sectionToFormNameMap={appearance:\"trigger\",backend:\"trigger-source\"};formName=sectionToFormNameMap[section];loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/\"+formName}))})};trigger=null;linkModels=function(cb){if(triggerId!=null){trigger=z.app.developer.app.triggers.get(triggerId)}else if(asTest){trigger=new z.model.DeveloperAppTrigger({hide:true,important:false,test_trigger:true},{app:z.app.developer.app})}else{trigger=new z.model.DeveloperAppTrigger({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(trigger);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var options;options={trigger:trigger,section:section};options.sectionView=new z.ui.DeveloperAppTriggerEditorForm(options);_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor(options);_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},editTriggerSample:function(id,triggerId){var linkModels,loadModels,renderViews,triggerSample,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/sample\"})),triggerSample:async.fetch(new z.model.DeveloperAppTriggerSampleResult({},{appId:id,triggerId:triggerId}))})};triggerSample=null;linkModels=function(cb){triggerSample=z.app.developer.triggerSample;delete z.app.developer.triggerSample;z.app.developer.form.setWrappedModel(triggerSample);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView,trigger;trigger=z.app.developer.app.triggers.get(triggerId);sectionView=new z.ui.DeveloperAppTriggerSampleResult({trigger:trigger,triggerSample:triggerSample});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"sample\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggerFields:function(id,triggerId){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){var sectionView,trigger;trigger=z.app.developer.app.triggers.get(triggerId);sectionView=new z.ui.DeveloperAppTriggerFields({trigger:trigger});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createTriggerField:function(id,triggerId){return this.editTriggerField(id,triggerId,null)},editTriggerField:function(id,triggerId,fieldId){var field,linkModels,loadModels,renderViews,trigger,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/trigger-field\"}))})};field=null;trigger=null;linkModels=function(cb){trigger=z.app.developer.app.triggers.get(triggerId);if(fieldId!=null){field=trigger.fields.get(fieldId)}else{field=new z.model.DeveloperAppTriggerField({},{app:z.app.developer.app,trigger:trigger})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView;sectionView=new z.ui.DeveloperAppTriggerFieldEditor({field:field,trigger:trigger});_this.views.app_trigger_editor=new z.ui.DeveloperAppTriggerEditor({trigger:trigger,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_trigger_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},triggerSettings:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/trigger-settings?app_id=\"+id}))})};linkModels=function(cb){z.app.developer.form.setWrappedModel(z.app.developer.app);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_trigger_settings=new z.ui.DeveloperAppTriggerSettings({});_this.placeInWrapper(_this.views.app_trigger_settings);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},actions:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){_this.views.app_actions=new z.ui.DeveloperAppActions({});_this.placeInWrapper(_this.views.app_actions);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createAction:function(id){return this.editAction(id,null,\"appearance\")},editAction:function(id,actionId,section){var action,formName,linkModels,loadModels,renderViews,sectionToFormNameMap,_this=this;if(section==null)section=\"appearance\";this.requireLogin();sectionToFormNameMap={appearance:\"action\",backend:\"action-source\"};formName=sectionToFormNameMap[section];loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/\"+formName}))})};action=null;linkModels=function(cb){if(actionId!=null){action=z.app.developer.app.actions.get(actionId)}else{action=new z.model.DeveloperAppAction({},{app:z.app.developer.app})}z.app.developer.form.setWrappedModel(action);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var options;options={action:action,section:section};options.sectionView=new z.ui.DeveloperAppActionEditorForm(options);_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor(options);_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},actionFields:function(id,actionId){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb)};renderViews=function(cb){var action,sectionView;action=z.app.developer.app.actions.get(actionId);sectionView=new z.ui.DeveloperAppActionFields({action:action});_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor({action:action,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},createActionField:function(id,actionId){return this.editActionField(id,actionId,null)},editActionField:function(id,actionId,fieldId){var action,field,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/action-field\"}))})};field=null;action=null;linkModels=function(cb){action=z.app.developer.app.actions.get(actionId);if(fieldId!=null){field=action.fields.get(fieldId)}else{field=new z.model.DeveloperAppActionField({},{app:z.app.developer.app,action:action})}z.app.developer.form.setWrappedModel(field);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){var sectionView;sectionView=new z.ui.DeveloperAppActionFieldEditor({field:field,action:action});_this.views.app_action_editor=new z.ui.DeveloperAppActionEditor({action:action,section:\"fields\",sectionView:sectionView});_this.placeInWrapper(_this.views.app_action_editor);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},requests:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{})};renderViews=function(cb){_this.views.app_requests=new z.ui.DeveloperAppRequests;_this.placeInWrapper(_this.views.app_requests);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},activate:function(id){var activationRequest,audit,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/request-global\"})),audit:async.fetch(new z.model.DeveloperAppAudit([],{appId:id}),{cache:false,persist:false})})};audit=null;activationRequest=null;linkModels=function(cb){audit=z.app.developer.audit;delete z.app.developer.audit;activationRequest=new z.model.DeveloperAppActivationRequest([],{app:z.app.developer.app});z.app.developer.form.setWrappedModel(activationRequest);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_activation=new z.ui.DeveloperAppActivation({activationRequest:activationRequest,audit:audit});_this.placeInWrapper(_this.views.app_activation);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},invite:function(id){var linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.DeveloperAppFormSet([],{url:z.cfg.devapi+\"/forms/email-invite\"}))})};linkModels=function(cb){var model;model=new z.model.Base;model.urlRoot=z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/invites\");z.app.developer.form.setWrappedModel(model);return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_invite=new z.ui.DeveloperAppInvite;_this.placeInWrapper(_this.views.app_invite);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},chooseMigrationTarget:function(id){var loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.FormSet([],{url:z.cfg.devapi+\"/forms/migration-request\"}))})};renderViews=function(cb){_this.views.app_migrate_choose_target=new z.ui.DeveloperAppChooseMigrationTarget({form:z.app.developer.form});_this.placeInWrapper(_this.views.app_migrate_choose_target);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])},migrate:function(id,oldAppId){var audit,linkModels,loadModels,renderViews,_this=this;this.requireLogin();loadModels=function(cb){return _this.loadApp(id,cb,{form:async.fetch(new z.model.FormSet([],{url:z.cfg.devapi+\"/forms/migration-request\"})),audit:async.fetch(new z.model.DeveloperAppAudit([],{appId:id,compareTo:oldAppId}),{cache:false,persist:false})})};audit=null;linkModels=function(cb){audit=z.app.developer.audit;delete z.app.developer.audit;return typeof cb===\"function\"?cb():void 0};renderViews=function(cb){_this.views.app_migrate=new z.ui.DeveloperAppMigrate({audit:audit,oldAppId:oldAppId});_this.placeInWrapper(_this.views.app_migrate);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,linkModels,renderViews])},scripting:function(id){var loadModels,renderViews,_this=this;this.requireLogin();\nloadModels=function(cb){return _this.loadApp(id,cb,{})};renderViews=function(cb){_this.views.app_scripting=new z.ui.DeveloperAppScripting;_this.placeInWrapper(_this.views.app_scripting);return typeof cb===\"function\"?cb():void 0};async.series([loadModels,renderViews])}});z.ui.Base=Backbone.View.extend({constructor:function(options){if((options!=null?options.state:void 0)!=null&&options.state instanceof z.model.State){if(typeof this!==\"undefined\"&&this!==null)this.state=options.state}else{if(typeof this!==\"undefined\"&&this!==null){this.state=new z.model.State(options!=null?options.state:void 0)}}if(!(typeof this!==\"undefined\"&&this!==null)){console.log(\"Did not set up @state\",this,arguments)}Backbone.View.prototype.constructor.apply(this,arguments)}});z.ui.Store=Backbone.Collection.extend({retrieve:function(View){var v,_this=this;v=this.find(function(v){if(v.get(\"view\")instanceof View)return true});return v!=null?v.get(\"view\"):void 0},inject:function(view,View){var v;v=new Backbone.Model({view:view,View:view});this.add(v);return v!=null?v.get(\"view\"):void 0}});z.ui.Singleton=function(View){var Singleton,construct,store;construct=function(){var child;child=function(args){return View.apply(this,args)};child.prototype=View.prototype;return function(args){return new child(args)}};View.prototype.store=new z.ui.Store;store=View.prototype.store;return Singleton=function(){function Singleton(){var single;single=store.retrieve(View)||store.inject(construct()(arguments),View);return single}return Singleton}()};z.ui.UpgradeModal=z.ui.Base.extend({className:\"upgrade\",events:{\"click a\":\"close\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var _ref,_ref2;return{errors:(_ref=this.options)!=null?_ref.errors:void 0,hasErrors:((_ref2=this.options)!=null?_ref2.errors:void 0)!=null}},render:function(){this.$el.html(JST.common_upgrade_modal(this.context()));return this},close:function(e){var _ref;return(_ref=this.modal)!=null?_ref.close():void 0}});z.ui.ErrorModal=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},render:function(){var view;view={statusCode:this.options.statusCode,statusText:this.options.statusText,responseText:this.options.responseText};this.$el.html(\"<div style='padding: 0 50px;'>\"+view.statusCode+\" Error</div>\");return this}});z.ui.RestartModal=z.ui.Base.extend({initialize:function(options){return _.bindAll(this)},render:function(){var view;view={};this.$el.html(\"<div style='padding: 0 50px;'>Server is restarting (502 error).</div>\");return this}});z.model.ErrorHandler=z.model.Base.extend({initialize:function(){var _this=this;_.bindAll(this);this.registerAjaxHandler();this.tripwire=_.after(10,this.leave);return setInterval(function(){return _this.tripwire=_.after(10,_this.leave)},60*1e3)},leave:function(){return window.location.href=\"/wtf\"},registerAjaxHandler:function(){var _this=this;return $(document).ajaxError(function(e,xhr,settings){var msg,responseText,statusCode,statusText,url,_ref,_ref2;statusCode=xhr.status;statusText=xhr.statusText;responseText=xhr.responseText;url=settings.url;if(_this.filterForUpgrade(statusCode))_this.showUpgradeMessage(xhr);if(_this.filterForRestartMessage(statusCode))_this.showRestartMessage();if(_this.filterForErrorMessage(statusCode)){_this.tripwire();_this.showErrorMessage(statusCode,statusText,responseText)}if(_this.filterForTracking(statusCode)){try{return msg=(_ref=JSON.parse(responseText))!=null?(_ref2=_ref.errors)!=null?_ref2.join(\", \"):void 0:void 0}catch(error){return msg=responseText}}})},showErrorMessage:function(statusCode,statusText,responseText){var modal,options;options={statusCode:statusCode,statusText:statusText,responseText:responseText};return modal=new z.ui.Modal({view:new z.ui.ErrorModal(options)})},showRestartMessage:function(){var modal;return modal=new z.ui.Modal({view:new z.ui.RestartModal({})})},showUpgradeMessage:function(xhr){var modal,_ref;return modal=new z.ui.Modal({view:new z.ui.UpgradeModal({errors:((_ref=JSON.parse(xhr.responseText))!=null?_ref.errors:void 0)||[]})})},filterForRestartMessage:function(statusCode){if(statusCode===502)return true},filterForErrorMessage:function(statusCode){if(statusCode===502)return false;if(statusCode===503)return false;if(500<=statusCode&&statusCode<600)return true},filterForTracking:function(statusCode){if(405<=statusCode&&statusCode<600)return true},filterForUpgrade:function(statusCode){if(statusCode===426)return true}});z.ui.RenameModal=z.ui.Base.extend({className:\"rename\",events:{\"click .save\":\"submit\",\"submit .name\":\"submit\"},initialize:function(options){this.options=options;if(!(options.save!=null))throw\"save required\";return _.bindAll(this)},context:function(){var context;context={value:this.options.value};return context},render:function(){this.$el.html(JST.common_rename_modal(this.context()));this.$(\"input\").first().focus();return this},submit:function(e){if(e!=null)e.preventDefault();this.options.save(this.$el.find(\"input\").val());return this.modal.close()}});z.ui.ShareZapModal=z.ui.Base.extend({className:\"share-zap\",events:{\"click .submit\":\"submit\",\"submit form\":\"submit\",\"change .disabler\":\"disabler\"},initialize:function(options){var renderSubmit;this.options=options;_.bindAll(this);renderSubmit=_.debounce(this.renderSubmit,40);this.form=new z.model.FormSet({});this.form.on(\"change:valid\",renderSubmit,this);this.read=this.options.read;this.write=this.options.write;this.recipe=null;this.readNeeds=new z.model.ParamFormSet([],{node:this.read});this.writeNeeds=new z.model.ParamFormSet([],{node:this.write});if(this.read.id){return z.store.set(this.read.id+\"-shared\",\"yes\",{expires:1})}},context:function(){var context;context={};context.zapTitle=this.read.getTitle();context.readClass=this.read.serviceImageClass();context.writeClass=this.write.serviceImageClass();return context},render:function(){var context;context=this.context();this.$el.html(JST.common_share_zap_modal(context));this.$paramform=this.$(\"paramform\");this.renderForm();return this},thanksContext:function(){var declaration,e,out,read_service,what_is_zapier,write_service,zapier_image,_ref;out={};out.recipe=(_ref=this.recipe)!=null?_ref.toJSON():void 0;if(out.recipe){e=encodeURIComponent;read_service=z.app.services.get(this.read.get(\"selected_api\"));write_service=z.app.services.get(this.write.get(\"selected_api\"));zapier_image=z.cfg.mediaURL+\"images/frontend/placeholder/128x128.png\";declaration=\"I just connected \"+read_service.getName()+\" to \"+write_service.getName()+\" with Zapier!\";what_is_zapier=\"Zapier makes it easy to integrate hundreds of business web applications without writing a single line of code.\";out.twitter_href=\"https://twitter.com/intent/tweet?text=\"+e(declaration)+\"+\"+e(\"Check it out!\")+\"+\"+e(out.recipe.share_url);out.facebook_href=\"https://www.facebook.com/dialog/feed?app_id=234230510040096&redirect_uri=\"+e(\"https://zapier.com/\")+\"&link=\"+e(out.recipe.share_url_raw)+\"&name=\"+e(declaration)+\"&description=\"+e(what_is_zapier)+\"&picture=\"+e(zapier_image);out.linkedin_href=\"http://www.linkedin.com/shareArticle?mini=true&url=\"+e(out.recipe.share_url_raw)+\"&title=\"+e(declaration)+\"&summary=\"+e(what_is_zapier)+\"&source=\"+e(\"Zapier\");out.email_href=\"mailto:your@friend.com?subject=\"+e(declaration)+\"&body=\"+e(what_is_zapier)+\"+\"+e(out.recipe.share_url)}return out},renderThanks:function(){this.$el.html(JST.common_share_thanks_modal(this.thanksContext()));this.modal.reposition();return this},prunePrefillsAndEmpty:function(fields){var thing;return thing=6},renderForm:function(){var fields,loadReads,loadWrites,_this=this;fields=[{key:\"description\",label:\"What problem does this Zap solve?\",type:\"text\",required:true,help_text:\"Briefly describe what problem this Zap solves for you, and how it solves it.\"},{key:\"directions\",type:\"copy\",required:false,help_text_html:'<h3>Customize Template Fields</h3><span class=\"arr\">&darr;</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Checked fields below will be shared.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Changes made here <strong>will not</strong> affect your zap.'}];loadReads=function(cb){return _this.readNeeds.fetch({cache:false,success:function(){return cb()},error:function(){return cb()}})};loadWrites=function(cb){return _this.writeNeeds.fetch({cache:false,success:function(){return cb()},error:function(){return cb()}})};this.setMode(\"loading\",\"fields\");return async.series([loadReads,loadWrites],function(err,result){_this.setMode(\"loaded\",\"fields\");_this.readNeeds.each(function(field){field=field.toJSON();if(field.list!=null)delete field.list;return _.each(_this.read.get(\"params\"),function(value,key,list){if(field.key===key&&value&&!field.prefill){field.label=\"Trigger: \"+(field.label||_.superHumanize(field.key));field.key=\"read_data__params__\"+field.key;field.required=false;field.value=value;return fields.push(field)}})});_this.writeNeeds.each(function(field){field=field.toJSON();if(field.list!=null)delete field.list;return _.each(_this.write.get(\"params\"),function(value,key,list){if(field.key===key&&value&&!field.prefill){field.label=\"Action: \"+(field.label||_.superHumanize(field.key));field.key=\"write_data__params__\"+field.key;field.required=false;field.value=value;return fields.push(field)}})});_this.form.reset(fields);_this.paramform=new z.ui.ParamForm({form:_this.form,prettypills:true});_this.$paramform.html(_this.paramform.render().el);_.each(_this.$paramform.find(\".field\").not(\".field-description,.field-directions\"),function(el){var input,name;el=$(el);name=el.find(\"[data-id]\").attr(\"data-id\");input=$(\"<input />\").attr({name:\"hide__\"+name,\"org-name\":name,type:\"checkbox\",\"class\":\"disabler\",checked:\"true\",title:\"Uncheck to not share this field with your Zap.\"});el.prepend($('<small class=\"\">'));return el.prepend(input)});_this.modal.reposition();return _this.renderSubmit()})},disabler:function(e){var referenced,sel;if(e!=null)e.preventDefault();sel=$.escapeSel($(e.currentTarget).attr(\"org-name\"));referenced=this.$paramform.find(\"[data-id=\"+sel+\"]\").parent().parent();if($(e.currentTarget).is(\":checked\")){return referenced.removeClass(\"disabled\")}else{return referenced.addClass(\"disabled\")}},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},submit:function(e){var data,disabled_names,error,success,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");data=this.form.getValues();success=function(model,resp,opts){var _ref;_this.recipe=new z.model.Recipe(resp);_this.read.set({has_shared:true});z.app.track[\"new\"](\"Shared Zap\",{path:window.location.pathname});if((_ref=_this.options.success)!=null)_ref.call(_this,_this.recipe);return _this.renderThanks()};error=function(model,xhr,opts){var errors,_ref;_this.setMode(\"enable\",\"submit\");errors=z.useful.errors(xhr);_this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(errors);return(_ref=_this.options.error)!=null?_ref.apply(_this,arguments):void 0};disabled_names=_.map(this.$paramform.find(\".disabler:not(:checked)\"),function(el){return $(el).attr(\"org-name\")});_.each(disabled_names,function(disabled_name){return delete data[disabled_name]});data=_.unflatten(_.compactObject(data));return this.options.read.share(data,{success:success,error:error})}});z.ui.AuthErrorModal=z.ui.Base.extend({className:\"raw-error\",initialize:function(options){this.options=options;_.bindAll(this);if(this.options.auth!=null){return this.service=z.app.services.get(this.options.auth.get(\"selected_api\"))}},context:function(){var context,_ref;return context={type:this.options.type,hasUpfronts:(_ref=this.service)!=null?_ref.hasUpfronts():void 0,message:this.options.message}},render:function(){this.$el.html(JST.common_auth_error_modal(this.context()));return this}});z.ui.CollectEmailModal=z.ui.Base.extend({className:\"collect-email\",events:{\"submit form\":\"submit\",\"click input[type=submit]\":\"submit\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){},render:function(){this.$el.html(JST.common_collect_email_modal(this.context()));z.useful.placeholders(this.$el);return this},submit:function(e){var email,options,s1,s2,_this=this;if(e!=null)e.preventDefault();this.$(\".feedback\").removeClass(\"success error hide\").addClass(\"hide\");email=this.$(\"#email\").val();s1=this.options.s1;s2=this.options.s2;options={url:\"/api/v2/email/\"+s1+\"/\"+s2,type:\"post\",dataType:\"json\",data:JSON.stringify({email:email}),success:function(model,resp){var _ref;_this.$(\".feedback\").addClass(\"success\").removeClass(\"hide\").text(\"Thank you! We will email you when we have news.\");_.delay(function(){return _this.modal.close()},3e3);return(_ref=_this.options.success)!=null?_ref.apply(_this,arguments):void 0},error:function(model,xhr){return this.$(\".feedback\").addClass(\"error\").removeClass(\"hide\").text(z.useful.errors(xhr))}};return Backbone.sync(\"create\",this,options)}});z.ui.AuthRequestModal=z.ui.Base.extend({className:\"request-auth\",events:{\"click .submit\":\"submit\",\"submit form\":\"submit\"},initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,options);this.form=new z.model.FormSet({});return this.form.on(\"change:valid\",this.renderSubmit,this)},context:function(){var context;context={service:this.options.service};return context},render:function(){this.$el.html(JST.common_auth_request_modal(this.context()));this.$paramform=this.$(\"paramform\");this.renderForm();return this},renderForm:function(){var fields;fields=[{key:\"email\",label:\"Email Address\",type:\"unicode\",required:true,help_text:\"The person you need access from.\"}];this.form.reset(fields);this.paramform=new z.ui.ParamForm({form:this.form});return this.$paramform.html(this.paramform.render().el)},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},submit:function(e){var data,error,success,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");data=this.form.getValues();data[\"selected_api\"]=this.options.service.get(\"key\");success=function(model,resp){_this.$(\".feedback\").removeClass(\"hide\").text(\"Request has been sent!\");return _.delay(function(){return _this.modal.close()},3500)};error=function(model,xhr){var errors;errors=z.useful.errors(xhr);return _this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(errors)};return z.app.auths.request(data,{success:success,error:error})}});z.ui.AuthEditModal=z.ui.Base.extend({className:\"menu with-hover\",events:{\"click .rename\":\"rename\",\"click .manage\":\"manage\",\"click .delete\":\"delete\"},initialize:function(options){this.options=options;if(!(options.auth!=null))throw\"auth required\";return _.bindAll(this)},context:function(){var context;context={onEditor:this.options.onEditor,od:this.options.auth.id};return context},render:function(){this.$el.html(JST.common_auth_edit_modal(this.context()));return this},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.options.auth.save({title:value})};this.modal.close();return modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.options.auth.get(\"title\"),save:save})})},manage:function(e){if(e!=null)e.preventDefault();this.modal.close();return Backbone.history.navigate(\"app/settings/authorizations\",{trigger:true})},\"delete\":function(e){var context,destroy,message,modal,_this=this;if(e!=null)e.preventDefault();destroy=function(value){return _this.options.auth.destroy()};context={service:this.options.auth.get(\"selected_api\"),title:this.options.auth.get(\"title\")};message=new Handlebars.SafeString(JST.common_auth_delete_message(context));this.modal.close();return modal=new z.ui.Modal({view:new z.ui.ConfirmModal({message:message,yes:destroy})})}});z.ui.DataTableModal=z.ui.Base.extend({className:\"data-table\",events:{\"click td.value\":\"clickValue\"},initialize:function(options){this.options=options;if(!(options.data!=null))throw\"data required\";return _.bindAll(this)},render:function(){this.$el.html(JST.common_data_table_modal({data:this.options.data}));return this},clickValue:function(e){return this.$(e.currentTarget).toggleClass(\"nomax\")}});z.ui.MenuModal=z.ui.Base.extend({className:\"menu with-hover\",events:{\"click a\":\"close\",\"click [data-nav=logout]\":\"logout\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={email:z.app.account.get(\"email\"),developer:z.app.account.isDeveloper()};return context},render:function(){this.$el.html(JST.common_menu_modal(this.context()));this.$(\"input\").first().focus();return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},logout:function(e){if(e!=null)e.preventDefault();Backbone.cache.lawnchair.nuke();return z.useful.goto(\"/logout\")}});z.ui.ModalContentHTML=z.ui.Base.extend({html:null,className:\"plain-html\",initialize:function(options){this.options=options;_.bindAll(this);return this.html=options.view},render:function(){this.$el.html(this.html);this.$el.addClass(this.options[\"class\"]);return this}});z.ui.Modal=z.ui.Base.extend({tagName:\"div\",className:\"modal-layer\",events:{click:\"click\",\"click .close\":\"close\",\"click .x\":\"close\"},initialize:function(options){var _this=this;this.options=options;if(!(options.view!=null))throw\"view required\";_.bindAll(this);if(!(this.options.autoFocus!=null))this.options.autoFocus=true;if(!(this.options.shortenToFit!=null))this.options.shortenToFit=false;this.delegateEvents(_.extend(this.events,this.options.events));this.view=this.options.view;if(_.isString(this.options.view)){this.view=new z.ui.ModalContentHTML(this.options)}this.view.modal=this;this.reposition=_.bind(_.throttle(this.position,50),this);this.on(\"remove\",function(){var _ref,_ref2;_this.view.remove();if((_ref=$(window))!=null)_ref.off(\"resize\",_this.reposition);if((_ref2=$(window))!=null)_ref2.off(\"scroll\",_this.reposition);z.app.off(\"render\",_this.reposition);Backbone.history.off(\"route\",_this.clearClicks);return z.app.off(\"click\",_this.addClick)});return this.render()},render:function(){var target,_ref,_ref2,_this=this;this.clicks=_.clone(z.app.clicks);$(window).on(\"resize\",this.reposition);$(window).on(\"scroll\",this.reposition);z.app.on(\"click\",this.addClick);Backbone.history.on(\"route\",this.clearClicks);z.app.on(\"render\",this.reposition);this.setMode(\"is\",\"open\");this.$el.html(JST.common_base_modal(this.options));this.$container=this.$(\".modal-container\");this.$modal=this.$(\".modal\");this.$modal.html(this.view.render().el);target=$(\"body .modal-layer\").last();if(target.length>0){this.$el.insertAfter(target)}else{this.$el.appendTo($(\"body\"))}if(!this.haveTarget()){this.$el.removeClass(\"with-dim\").addClass(\"with-dim\");this.renderDim()}if((_ref=this.options)!=null?_ref.noLayer:void 0){this.$el.removeClass(\"no-layer\").addClass(\"no-layer\")}if((_ref2=this.options)!=null?_ref2.noBackgroundClose:void 0){this.$el.addClass(\"no-bg-close\")}if(this.options.width!=null){this.$container.css(\"width\",this.options.width)}if(this.options.width!=null)this.$modal.css(\"width\",this.options.width);_.defer(function(){return _this.position()});if(z.cfg.browser!==\"Explorer\"&&this.options.autoFocus){_.defer(function(){return _this.$(\"input\").first().focus()})}if(this.options.shortenToFit){_.defer(function(){return _this.shortenToFit()})}return this},setLayerSize:function(){return this.$el.css(\"height\",$(\"body\").height())},addClick:function(e){this.clicks.unshift(e);return this.clicks=this.clicks.slice(0,10)},clearClicks:function(){return this.clicks=[]},position:function(){var bheight,bwidth,click,height,width,x,y,_ref,_ref2,_ref3,_ref4,_this=this;if(!(this.$modal!=null))return;if(this.haveTarget()){x=$(this.options.target).offset().left;y=$(this.options.target).offset().top;this.setMode(\"not\",\"global\")}else if(((_ref=z.app.partner)!=null?_ref.isPartnerSession():void 0)&&((_ref2=z.app.partner)!=null?_ref2.hasIframeJs:void 0)){click=_.find(this.clicks,function(click){return click.clientY!=null});_ref3=z.useful.viewportSize(),bwidth=_ref3[0],bheight=_ref3[1];width=this.$modal.outerWidth(true);height=this.$modal.outerHeight(true);x=bwidth/2-width/2;y=click!=null?click.clientY-height/2:50;this.setMode(\"is\",\"global\")}else{_ref4=z.useful.viewportSize(),bwidth=_ref4[0],bheight=_ref4[1];width=this.$modal.outerWidth(true);height=this.$modal.outerHeight(true);x=bwidth/2-width/2;y=bheight*(9/20)-height/2;if(y<40){y=40;bheight-=60}this.setMode(\"is\",\"global\")}if(this.options.x!=null)x+=Number(this.options.x);if(this.options.y!=null)y+=Number(this.options.y);if(this.haveTarget()){this.$container.css(\"left\",x);this.$container.css(\"top\",y)}else{this.$modal.css(\"maxHeight\",bheight);if(this.$modal.height()>=$(\".modal-container\").height()){this.$modal.css(\"padding-bottom\",\"60px\")}}return this.$modal.removeClass(\"invisible\")},haveTarget:function(){return this.options.target!=null&&this.options.target.length>0},targetWidth:function(){var _ref;return(_ref=$(this.options.target))!=null?_ref.outerWidth():void 0},renderDim:function(){var open;open=this.countOpen(true);$(\".header, .app, .footer\").removeClass(\"dim\");$(\".modal-container\").removeClass(\"dim\").addClass(\"dim\");return $(\".modal-container\").last().removeClass(\"dim\")},countOpen:function(withDim){var search;if(withDim==null)withDim=false;search=\"body .modal-layer\";if(withDim)search+=\".with-dim\";return $(search).length},click:function(e){if(e!=null&&$(e.target).hasClass(\"modal-container\")){return this.close()}if(e!=null&&$(e.target).hasClass(\"modal-layer\"))return this.close()},close:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if(!this.isOpen())return;this.setMode(\"not\",\"open\");if((_ref=this.options)!=null){if(typeof _ref.close===\"function\")_ref.close()}this.remove();return this.renderDim()},isOpen:function(){return this.hasMode(\"is\",\"open\")},detach:function(){return this.$el.detach()},attach:function(){this.$el.appendTo($(\"body\"));return this.renderDim()},shortenToFit:function($el,i){var height;if(i==null)i=0;if(!($el!=null))$el=this.$(\".modal\").children().first();if(z.useful.elClippedByScreenBottom($el[0])&&i<50){height=$el.outerHeight();$el.css(\"height\",height-10);return this.shortenToFit($el,i+1)}}});z.ui.SelectModal=z.ui.Base.extend({className:\"select with-hover\",events:{\"click [data-key]\":\"click\",\"click a\":\"close\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){return _this.$el.off(\"mousewheel DOMMouseScroll\")})},context:function(){var context;context={choices:this.options.choices};return context},render:function(){var context;context=this.context();this.$el.html(JST.common_select_modal(context));z.useful.noBGScroll(this.$el);return this},click:function(e){var key,value;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();key=$(e.currentTarget).attr(\"data-key\");value=$(e.currentTarget).attr(\"data-value\");this.options.choose(key,value);return this.modal.close()},close:function(e){if(e!=null)e.preventDefault();return this.modal.close()}});z.ui.SinceYouBeenGoneModal=z.ui.Base.extend({className:\"since-you-been-gone\",initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.updates=this.options.model;return this.on(\"remove\",function(){return z.useful.noBGScrollOff(_this.modal.$el.find(\"div.modal\"))})},context:function(){var context;context={};context.updates=this.updates;return context},render:function(){this.$el.html(JST.common_since_you_been_gone_modal(this.context()));z.useful.noBGScroll(this.modal.$el.find(\"div.modal\"));return this},close:function(e){return this.modal.close()}});z.ui.ConfirmModal=z.ui.Base.extend({className:\"confirm\",events:{\"click .yes\":\"clickYes\",\"click .no\":\"clickNo\"},initialize:function(options){var _this=this;this.options=options;if(!(options.message!=null)&&!(options.jst!=null)){throw\"message or JST required\"}_.bindAll(this);$(document).on(\"keyup\",this.keyup);return this.on(\"remove\",function(){return $(document).off(\"keyup\",_this.keyup)})},context:function(){return{message:this.options.message}},render:function(){if(this.options.jst!=null){this.$el.html(this.options.jst())}else{this.$el.html(JST.common_confirm_modal(this.context()))}return this},clickYes:function(e){var _ref;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.yes)!=null?_ref.call(this):void 0},clickNo:function(e){var _ref;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.no)!=null?_ref.call(this):void 0},keyup:function(e){if(e.keyCode!=null&&e.keyCode===13)return this.clickYes()}});z.ui.AuthCreateModal=z.ui.Base.extend({className:\"new-auth\",events:{\"click .send-confirmation\":\"confirmation\",\"click .submit\":\"submit\",\"submit form\":\"submit\"},initialize:function(options){var _this=this;this.options=options;if(!(options.service!=null))throw\"service required\";_.bindAll(this);_.defaults(this,options);this.setMode(\"disable\",\"submit\");this.form=new z.model.FormSet(this.service.getUpfronts());this.setDefaultTitle();this.form.on(\"change:valid\",this.renderSubmit,this);this.on(\"remove\",function(){_this.stopPoll();return _this.paramform.remove()});this.oauthId=_.random(1e6,9999999);return z.oauth=function(url){var data,_ref;if(!_this.form.isValid())return;if(_this.hasMode(\"disable\",\"submit\"))return;if(!((_ref=_this.service.get(\"meta\"))!=null?_ref.oauth:void 0)){return}data=_this.form.getValues();data[\"id\"]=_this.oauthId;url=url+\"?\"+$.param(data);return z.useful.open(url,true,\"New Auth\")}},setDefaultTitle:function(){var name,row,service;row=this.form.get(\"title\");name=z.app.account.get(\"partner_email\")||z.app.account.get(\"email\");service=this.options.service.getName();return row.set({value:\"\"+name+\"'s \"+service+\" account\"})},context:function(){var context,url,_ref,_ref2;url=(_ref=this.service.get(\"meta\"))!=null?_ref.oauth_302_url:void 0;context={onclick:\"z.oauth('\"+url+\"');\",serviceHelpQueryString:$.param({q:\"How To Get Started with \"+((_ref2=this.service)!=null?_ref2.getName():void 0)})};return context},render:function(){this.$el.html(JST.common_auth_create_modal(this.context()));this.$paramform=this.$(\"paramform\");this.renderForm();this.renderSubmit();return this},renderForm:function(){this.paramform=new z.ui.ParamForm({form:this.form,prettypills:true});return this.$paramform.html(this.paramform.render().el)},renderSubmit:function(){if(this.form.isValid()){return this.setMode(\"enable\",\"submit\")}else{return this.setMode(\"disable\",\"submit\")}},confirmation:function(e){var data,error,key,row,s200,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"confirm\"))return;key=$(e.target).attr(\"data-id\");row=this.form.find(function(row){return row.get(\"key\")===key});row.set({sentConfirmation:true});s200=function(){_this.setMode(\"enable\",\"confirm\");return _this.confirmationButtonToText(key)};error=function(){_this.setMode(\"enable\",\"confirm\");return _this.$(\".send-confirmation\").text(\"Error sending PIN\")};this.filtered=this.form.filter(function(row){if(row.get(\"type\")===\"confirmation\")return false;return true});this.filtered=new z.model.FormSet(this.filtered);data=this.filtered.getValues();data.selected_api=this.service.get(\"key\");this.setMode(\"disable\",\"confirm\");this.$(\".feedback\").removeClass(\"error hide\").addClass(\"hide\");$(\".send-confirmation\").text(\"Sending PIN...\");return z.app.auths.create(data,{s200:s200,error:error})},confirmationButtonToText:function(key){this.$(\".input-confirmation\").removeClass(\"hide\");return this.$(\".send-confirmation\").removeClass(\"hide\").addClass(\"hide\")},confirmationTextToButton:function(){this.$(\".input-confirmation\").removeClass(\"hide\").addClass(\"hide\");return this.$(\".send-confirmation\").removeClass(\"hide\")},submit:function(e){var auth,authError,data,errorAdding,foundNewAuth,oauthError,oauthSuccess,successAdding,_ref,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"submit\"))return;this.setMode(\"disable\",\"submit\");authError=function(message){var context,modal;context={service:_this.service,message:message,type:\"automatic\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context),force:true})};foundNewAuth=function(auth){var id,testError,testSuccess;id=auth.id;_this.$(\".feedback\").removeClass(\"hide\").text(\"Testing for problems...\");testSuccess=function(){var _base;z.app.auths.add(auth);if(typeof(_base=_this.options).success===\"function\"){_base.success(auth)}return _this.modal.close()};testError=function(model,xhr){_this.setMode(\"enable\",\"submit\");_this.$(\".feedback\").addClass(\"hide\").text(\"\");authError(z.useful.errors(xhr));return auth!=null?auth.destroy():void 0};return auth.test({success:testSuccess,error:testError})};oauthSuccess=function(json){var auth;_this.stopPoll();auth=new z.model.Auth({id:json.auth_id});auth.fetch();return foundNewAuth(auth)};oauthError=function(message){_this.stopPoll();_this.modal.close();return authError(message)};this.startPoll(1e3,360,this.oauthId,{success:oauthSuccess,error:oauthError});if((_ref=this.service.get(\"meta\"))!=null?_ref.oauth:void 0){return this.$(\".feedback\").removeClass(\"hide\").text(\"Looking for new Account...\")}else{successAdding=function(model,resp){_this.stopPoll();z.app.auths.add(model);return foundNewAuth(model)};errorAdding=function(model,xhr){var errors;_this.stopPoll();_this.setMode(\"enable\",\"submit\");errors=z.useful.errors(xhr);if(_.str.include(errors,\"Confirmation code did not match.\")){_this.$(\".send-confirmation\").text(\"Send PIN again\");_this.$(\".feedback\").removeClass(\"hide\").addClass(\"error\").text(\"Confirmation PIN did not match. Try again.\");return _this.confirmationTextToButton()}};data=this.form.getValues();data[\"selected_api\"]=this.service.get(\"key\");this.$(\".feedback\").removeClass(\"hide\").text(\"Working...\");return auth=new z.model.Auth(data).save({},{success:successAdding,error:errorAdding})}},startPoll:function(interval,maxiter,oauthId,options){return this.poll=z.app.auths.pollForNewAuth(1e3,360,this.oauthId,options)},stopPoll:function(){return clearInterval(this.poll)}});z.ui.UnpauseErrorModal=z.ui.Base.extend({className:\"raw-error\",initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;return context={message:this.options.message}},render:function(){this.$el.html(JST.common_unpause_error_modal(this.context()));return this}});z.ui.ServicePickerModal=z.ui.Base.extend({className:\"service-picker services\",PER_PAGE:21,SCROLL_TARGET:\".selector\",events:{\"click .reset\":\"reset\",\"keyup .search\":\"search\",\"click .selector .panel\":\"select\",\"mousedown .scroll\":\"beginManualScroll\"},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.setMode(\"cannot\",\"reset\");return this.on(\"remove\",function(){_this.$el.off(\"mousewheel DOMMouseScroll\");return _this.$(\".selector\").off()},this)},context:function(){var context;context={search:this.state.get(\"search\")};return context},render:function(){this.$el.html(JST.common_service_picker_modal(this.context()));this.renderSelector();this.renderModes();this.$(this.SCROLL_TARGET).on(\"scroll\",this.scroll);z.useful.noBGScroll(this.$(\"ul.selector\"));return this},renderSelector:function(){var html,search,services,_this=this;search=this.getSearch().toLowerCase().replace(\" \",\"\");html=\"\";services=z.app.services.filter(function(service){var key,name;name=z.useful.squish(service.getName().toLowerCase());key=service.get(\"key\");if(!_.str.include(name,search))return false;return true});_.each(services,function(service){var context,key;key=service.get(\"key\");context={name:service.getName(),service:key,selected:false};return html+=JST.common_service_panel(context)});this.$(\".selector\").html(html);this.renderSelected();return _.defer(function(){return _this.renderScroll()})},renderSelected:function(){var _this=this;this.$(\".selected\").removeClass(\"selected\");return _.defer(function(){return _this.$(\".selector\").scrollTop(_this.state.get(\"scroll\"))\n})},renderModes:function(){var _ref;if(((_ref=this.getSearch())!=null?_ref.length:void 0)>0){return this.setMode(\"can\",\"reset\")}else{return this.setMode(\"cannot\",\"reset\")}},rerenderSelector:function(){this.renderSelector();return this.renderModes()},search:function(e){var _ref;if(e.keyCode!=null&&e.keyCode===13){if((_ref=this.$(\".selector .panel\").first())!=null){_ref.trigger(\"click\")}}this.state.set(\"search\",this.getSearch());this.rerenderSelector();return this.resetScroll()},reset:function(e){if(e!=null)e.preventDefault();this.$(\".search\").val(\"\");this.state.set(\"search\",\"\");this.rerenderSelector();return this.resetScroll()},getSearch:function(){return this.$(\".search\").val()},select:function(e){var key;if(e!=null)e.preventDefault();key=this.$(e.currentTarget).attr(\"id\");this.options.choose(key);return this.modal.close()},scroll:function(e){var barHeight,contentHeight,max,percent,pos,visualHeight;pos=this.$(this.SCROLL_TARGET).scrollTop();contentHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;visualHeight=this.$(this.SCROLL_TARGET).innerHeight();percent=pos/(contentHeight-visualHeight);barHeight=this.$(\".scroll\").innerHeight();max=visualHeight-barHeight;pos=Math.round(max*percent);this.$(\".scroll\").css(\"top\",pos+\"px\");if(e!=null){return this.state.set(\"scroll\",this.$(this.SCROLL_TARGET).scrollTop())}},renderScroll:function(){var height,percent,scrollHeight;height=this.$(this.SCROLL_TARGET).innerHeight();scrollHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;percent=height/scrollHeight;this.$(\".scroll\").css(\"height\",Math.round(height*percent)+\"px\");return this.scroll()},resetScroll:function(){this.$(\".scroll\").css(\"top\",\"0px\");return this.state.set(\"scroll\",this.$(this.SCROLL_TARGET).scrollTop())},beginManualScroll:function(e){if(e!=null)e.preventDefault();this.manualScroll=true;this.setMode(\"manual\",\"scroll\");this.scrollOffset=e.pageY-this.$(\".scroll\").offset().top;$(window).on(\"mouseup\",this.endManualScroll);return $(window).on(\"mousemove\",this.updateManualScroll)},updateManualScroll:function(e){var height,percent,rawPos,scrollHeight,top,y;if(!(e!=null))return;y=e.pageY-this.scrollOffset;top=this.$(this.SCROLL_TARGET).offset().top;height=this.$(this.SCROLL_TARGET).innerHeight();scrollHeight=this.$(this.SCROLL_TARGET)[0].scrollHeight;percent=(y-top)/height;rawPos=Math.round(scrollHeight*percent);return this.$(this.SCROLL_TARGET).scrollTop(rawPos)},endManualScroll:function(e){if(e!=null)e.preventDefault();this.setMode(\"no\",\"scroll\");$(window).off(\"mouseup\",this.endManualScroll);return $(window).off(\"mousemove\",this.updateManualScroll)}});z.ui.RunZap=z.ui.Base.extend({className:\"run-zap\",initialize:function(options){var _this=this;this.options=options;if(!(options.read!=null))throw\"read required\";_.bindAll(this);this.messages=[];this.on(\"remove\",function(){return clearInterval(_this.interval)});return this.run()},context:function(){var context;context={title:this.options.read.getTitle(),messages:this.messages,noItemsFound:this.noItemsFound};return context},render:function(){this.$el.html(JST.common_run_zap_modal(this.context()));return this},run:function(){var success,_this=this;this.noItemsFound=false;success=function(){_this.interval=setInterval(_this.status,1e3);return _.delay(function(){return clearInterval(_this.interval)},3e4)};return this.options.read.run({success:success})},status:function(){var complete,_this=this;complete=function(model,resp){_this.messages=resp.messages;_.each(_this.messages,function(message){if(_.str.include(message,\"Found 0\"))_this.noItemsFound=true;if(_.str.include(message,\"failed:\"))clearInterval(_this.interval);if(_.str.include(message,\"success:\")){return clearInterval(_this.interval)}});return _this.render()};return this.options.read.runStatus({success:complete,error:complete})}});z.ui.LoginModal=z.ui.Base.extend({className:\"login\",events:{\"click a\":\"close\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){return _this.$(\"form\").addClass(\"hide\").appendTo($(\"body\"))})},context:function(){},render:function(){var $el;$el=$(\"#login-form\");if(($el!=null?$el.length:void 0)>0){this.$el.html($el.removeClass(\"hide\"))}else{this.$el.html(JST.common_login_modal(this.context()))}z.useful.placeholders(this.$el);return this},close:function(e){return this.modal.close()}});z.ui.ParamForm=z.ui.Base.extend({className:\"paramform\",initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.views=[];this.options.form.on(\"add\",this.insertAdd);return this.on(\"remove\",function(){return _.each(_this.views,function(view){return view.remove()})},this)},render:function(){var _this=this;this.$el.empty();this.options.form.each(function(row){var view;view=new z.ui.ParamFormRow({model:row,form:_this.options.form,options:_this.options});_this.views.push(view);return _this.$el.append(view.render().el)});return this},insertAdd:function(model){var index,view;index=this.options.form.indexOf(model);view=new z.ui.ParamFormRow({model:model,form:this.options.form,options:this.options});this.views.push(view);return this.$(\".field\").eq(index-1).after(view.render().el)},refreshPrettypills:function(){var _this=this;return _.each(this.views,function(view){var _ref;if(view!=null)if((_ref=view.prettypill)!=null)_ref.refresh();return view!=null?view.prettypillHeight():void 0})}});z.ui.DeveloperAppParamForm=z.ui.ParamForm.extend({clearErrors:function(){this.$(\".field .errorlist\").empty().hide();return this.$el.parent().find(\".paramform > ul.errorlist\").empty().hide()},renderErrors:function(errors){var feedback,_this=this;this.clearErrors();_.each(errors,function(fieldErrors,fieldKey){var feedback,field;field=_this.$(\".field.field-\"+_.slugify(fieldKey));if(field.find(\".errorlist\").length>0){feedback=field.find(\".errorlist\").show()}else{feedback=$('<ul class=\"errorlist\"/>').appendTo(field)}return _.each(fieldErrors,function(error){return feedback.append($(\"<li/>\").html(error))})});if(errors!=null?errors.general:void 0){if(this.$el.parent().find(\".paramform > ul.errorlist\").length>0){feedback=this.$el.parent().find(\".paramform > ul.errorlist\").show()}else{feedback=$('<ul class=\"errorlist\"/>').appendTo(this.$el)}_.each(errors.general,function(error){return feedback.append($(\"<li/>\").html(error))})}}});var __indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};z.ui.ParamFormRow=z.ui.Base.extend({events:{\"change [data-input]\":\"hardChange\",\"input [data-input]\":\"softChange\",\"mousedown [data-input]\":\"fillButton\",\"mousedown .fill-button\":\"fillButton\",\"mousedown .add-placeholder\":\"addPlaceholder\",\"click .add\":\"listAdd\",\"click .remove\":\"listRemove\"},className:function(){var key,name,type,_ref,_ref2;name=\"field\";if(type=this.model.get(\"type\"))name+=\" \"+type;if(((_ref=this.model)!=null?_ref.get(\"prefill\"):void 0)!=null){name+=\" prefill\"}if(this.model.get(\"choices\")||this.model.get(\"givefill\")){name+=\" selectfill\"}if(((_ref2=this.model)!=null?_ref2.get(\"list\"):void 0)!=null){name+=\" list\"}if(key=_.slugify(this.model.get(\"key\")))name+=\" field-\"+key;return name},initialize:function(options){var clearPrefillCache,clearUserfillCache,_ref,_ref2,_ref3,_ref4,_this=this;this.options=options;_.bindAll(this);this.model=this.options.model;this.model.on(\"remove\",this.remove,this);this.model.state.on(\"change:busy\",this.checkBusy,this);this.model.on(\"change:list change:isChild\",this.renderParentChild,this);this.model.on(\"change:valid\",this.renderValid,this);this.model.on(\"change:value\",this.valueToClipButton,this);this.model.on(\"change:value change:display\",this.set,this);if((_ref=this.options.form)!=null){_ref.on(\"change\",this.renderRule,this)}this.node=(_ref2=this.options.options)!=null?(_ref3=_ref2.userfill)!=null?_ref3.node:void 0:void 0;if(this.node!=null){clearUserfillCache=_.debounce(function(){var _ref4,_ref5,_ref6;return Backbone.cache.clear((_ref4=_this.userfillModal)!=null?(_ref5=_ref4.view)!=null?(_ref6=_ref5.gives)!=null?_ref6.url():void 0:void 0:void 0)},40);this.node.on(\"change:selected_api change:action change:authentication_id\",clearUserfillCache,this)}if((_ref4=this.model)!=null?_ref4.node:void 0){clearPrefillCache=_.debounce(function(){var _ref5,_ref6,_ref7;delete _this.prefillSamples;return Backbone.cache.clear((_ref5=_this.prefillModal)!=null?(_ref6=_ref5.view)!=null?(_ref7=_ref6.samples)!=null?_ref7.url():void 0:void 0:void 0)},40);this.model.node.on(\"change:authentication_id\",clearPrefillCache,this)}return this.on(\"remove\",function(){var _ref5,_ref6,_ref7,_ref8;if((_ref5=_this.userfillModal)!=null)_ref5.close();if((_ref6=_this.prefillModal)!=null)_ref6.close();if((_ref7=_this.selectfillModal)!=null)_ref7.close();return(_ref8=_this.givefillModal)!=null?_ref8.close():void 0},this)},context:function(){var choices,context,_ref;context=_.extend({},this.model.toJSON(),{model:this.model});context.val=this.model.getDisplay();if(_.isArray(context.val)){context.val=context.val.join(\",\")}else if(this.model.get(\"type\")===\"json\"&&context.val!=null&&context.val){context.val=JSON.stringify(context.val,null,4)}else if(this.model.get(\"choices\")){choices=this.model.get(\"choices\");if($.isPlainObject(choices))context.val=choices[context.val]}context.userfill=this.options.options.userfill!=null&&this.model.isUserfill();context.userfillClass=(_ref=this.options.options.userfill)!=null?typeof _ref[\"class\"]===\"function\"?_ref[\"class\"]():void 0:void 0;context.cid=z.app.account.id;context.ccode=z.app.account.get(\"code\");context.givefill=this.model.get(\"givefill\")!=null;return context},template:function(){var type;type=this.model.get(\"type\");if(type===\"select\"){return JST.common_form_select_row(false)}else if(type===\"password\"){return JST.common_form_password_row(false)}else if(type===\"copy\"){return\"<div></div>\"}else if(type===\"text\"||type===\"json\"){return JST.common_form_text_row(false)}else if(type===\"confirmation\"){return JST.common_form_confirmation_row(false)}else if(type===\"file\"){return JST.common_form_file_row(false)}else if(type===\"upload\"){return JST.common_form_upload_row(false)}else if(type===\"prettypills\"){return JST.common_form_unicode_prettypill_row(false)}else if(type===\"unicode\"){return JST.common_form_unicode_row(false)}else if(type===\"checkbox\"){return JST.common_form_checkbox_row(false)}return JST.common_form_unicode_row(false)},render:function(){var context,template,_ref,_ref2,_ref3,_ref4,_this=this;template=this.template();context=this.context();context.row_html=z.useful.render(template,context);this.$el.html(JST.common_form_base_row(context));this.renderValid();this.renderClipboard();this.checkBusy();this.renderParentChild();this.renderRule();_.defer(function(){return _this.prettypills()});if((_ref=this.userfillModal)!=null)_ref.close();if((_ref2=this.prefillModal)!=null)_ref2.close();if((_ref3=this.selectfillModal)!=null)_ref3.close();if((_ref4=this.givefillModal)!=null)_ref4.close();return this},doesRuleApply:function(match,fieldValue,ruleValues){var coerce,_ref;if(!_.isArray(ruleValues))ruleValues=[ruleValues];ruleValues=_.map(ruleValues,function(val){return String(val)});coerce=function(val){return String(val)};if(match===\"iexact\"){coerce=function(val){return String(val).toLowerCase()}}ruleValues=_.map(ruleValues,coerce);return _ref=coerce(fieldValue),__indexOf.call(ruleValues,_ref)>=0},applyRule:function(rule,inverse,actionOverride){var action;if(inverse==null)inverse=false;if(actionOverride==null)actionOverride=null;action=actionOverride||rule.action;if(action===\"hide\"){if(inverse){this.$el.removeClass(\"hide\");return this.options.form.softAdd(this.model)}else{this.$el.addClass(\"hide\");return this.options.form.softRemove(this.model)}}else if(action===\"show\"){return this.applyRule(rule,!inverse,\"hide\")}},renderRule:function(){var rules,values,_this=this;rules=this.model.get(\"rules\")||[];values=this.options.form.getValues();if(!(rules!=null?rules.length:void 0))return;values=this.options.form.getValues();return _.each(rules,function(rule){var shouldApply;shouldApply=_this.doesRuleApply(rule.match,values[rule.key],rule.value);return _this.applyRule(rule,!shouldApply)})},renderValid:function(){var valid;valid=this.model.get(\"valid\");this.$el.removeClass(\"valid invalid\");if(valid!=null&&valid)this.$el.addClass(\"valid\");if(valid!=null&&!valid)return this.$el.addClass(\"invalid\")},renderParentChild:function(){this.$el.removeClass(\"list-child list-parent\");if(this.model.get(\"list\")&&this.model.get(\"parent\")){this.$el.addClass(\"list-child\")}if(this.model.get(\"list\")&&!this.model.get(\"parent\")){return this.$el.addClass(\"list-parent\")}},renderClipboard:function(){var $el,clip;if(this.model.get(\"input_format\")!=null){$el=this.$(\".copy-button\");clip=new z.useful.clipboard($el);return clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)})}},softChange:function(){var data;data=this.get();if((data!=null?data.value:void 0)!=null&&(data!=null?data.value:void 0)!==this.model.getValue()){return this.model.set(data)}if((data!=null?data.display:void 0)!=null&&(data!=null?data.display:void 0)!==this.model.getDisplay()){return this.model.set(data)}},hardChange:function(){var data;data=this.get();return this.model.save(data)},get:function(){var $el,data,key,prefill,type;type=this.model.get(\"type\");prefill=this.model.get(\"prefill\")!=null;$el=this.$(\"[data-input]\");data={};if(prefill){key=this.hasMode(\"not\",\"locked\")?\"value\":\"display\"}else{key=\"value\"}if(type===\"checkbox\"){data[key]=$el.prop(\"checked\")}else if(type===\"json\"){try{data[key]=JSON.parse($el.val())}catch(e){data[key]=$el.val()}}else if(this.prettypill!=null){data[key]=this.prettypill.getValue()}else{data[key]=$el.val()}return data},set:function(val){var $el,choices,data,type,_ref;if(this.model.get(\"list\")&&!(this.model.get(\"parent\")!=null))return;if(!_.isString(val))val=this.model.getDisplay();type=this.model.get(\"type\");$el=this.$(\"[data-input]\");data=this.get();if(val!=null&&((data!=null?data.value:void 0)===val||(data!=null?data.display:void 0)===val)){return}if(type===\"checkbox\"){return $el.prop(\"checked\",val)}else if(this.model.get(\"choices\")){choices=this.model.get(\"choices\");if($.isPlainObject(choices))val=choices[val]}else if(type===\"json\"){if(val!=null){val=JSON.stringify(val,null,4)}else{val=\"\"}}$el.val(val);return(_ref=this.prettypill)!=null?_ref.setValue(val!=null&&!_.isArray(val)?val:\"\"):void 0},focus:function(){var _this=this;if(this.prettypill!=null){return _.defer(function(){return _this.prettypill.editor.focus()})}else{return _.defer(function(){return _this.$(\"[data-input]\").first().focus()})}},blur:function(){var _this=this;if(this.prettypill!=null){return _.defer(function(){return _this.prettypill.editor.getInputField().blur()})}else{return _.defer(function(){return _this.$(\"[data-input]\").first().blur()})}},busy:function(){var _ref;this.blur();this.$el.removeClass(\"busy\").addClass(\"busy\");this.$(\"[data-input]\").prop({disabled:true});this.undelegateEvents();if(this.prettypill!=null){this.undelegatePrettypills();if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",\"nocursor\")}return this.prettypill.container.addClass(\"disabled\")}},notBusy:function(){var _ref;this.$el.removeClass(\"busy\");this.$(\"[data-input]\").prop({disabled:false});this.delegateEvents();if(this.prettypill!=null){this.delegatePrettypills();if(this.hasMode(\"not\",\"locked\")||!(this.model.get(\"prefill\")!=null)&&!(this.model.get(\"choices\")!=null)){if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",false)}}return this.prettypill.container.removeClass(\"disabled\")}},checkBusy:function(){if(!this.model.state.get(\"busy\")){return this.notBusy()}else{return this.busy()}},valueToClipButton:function(){var f,v;f=this.model.get(\"input_format\");if(f!=null){v=\"\";if((f!=null?f[0]:void 0)!=null)v=f[0]+v;v=v+this.model.getValue();if((f!=null?f[2]:void 0)!=null)v=v+f[2];v=_.template(v)({cid:z.app.account.get(\"id\"),ccode:z.app.account.get(\"code\")});return this.$(\"[data-clipboard-text]\").attr(\"data-clipboard-text\",v)}},fillButton:function(e){var _ref,_ref2,_ref3,_ref4;this.focus();if(this.hasMode(\"not\",\"locked\")&&!this.$(e.currentTarget).hasClass(\"fill-button\")){return}if(this.model.get(\"choices\")!=null||this.model.get(\"prefill\")!=null){this.setMode(\"is\",\"locked\");this.$(\"[data-input]\").prop({disabled:true});if((_ref=this.prettypill)!=null){_ref.editor.setOption(\"readOnly\",\"nocursor\")}}if(this.model.get(\"prefill\")!=null){this.prefill(this.model.node,this.model.get(\"prefill\"),this.model.getValue(),this.model.get(\"choices\"))}else if(this.model.get(\"choices\")!=null){this.selectfill(this.model.get(\"choices\"),this.model.getValue())}else if(this.model.get(\"givefill\")){this.givefill((_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?(_ref4=_ref3.givefill)!=null?_ref4.node:void 0:void 0:void 0)}else if(this.options.options.userfill!=null&&this.model.isUserfill()&&this.$(e.currentTarget).hasClass(\"fill-button\")){this.userfill(this.node)}},addPlaceholder:function(e){if(this.options.options.userfill!=null&&this.model.isUserfill()&&this.$(e.currentTarget).hasClass(\"add-placeholder\")){return this.userfill(this.node)}},selectfill:function(choices,current){var $el,customValue,height,pick,placeholderValue,pos,view,x,y,_ref,_ref2,_ref3,_ref4,_this=this;if((_ref=this.selectfillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");if(this.prettypill!=null)$el=this.prettypillTarget();pick=function(pick){return _this.model.save({value:pick[\"key\"],display:null},{wait:true})};customValue=function(){var _ref2;_this.setMode(\"not\",\"locked\");_this.model.set({display:null});_this.$(\"[data-input]\").prop({disabled:false});if((_ref2=_this.prettypill)!=null){_ref2.editor.setOption(\"readOnly\",false)}_this.focus();return _this.prettypill.editor.focus()};placeholderValue=function(){var _ref2;if((_ref2=_this.selectfillModal)!=null)_ref2.close();return _this.userfill(_this.node,{pick:function(picked){var val;val=z.cfg.userfillOTag+picked.key+z.cfg.userfillETag;return _this.model.save({value:val,display:val},{wait:true})}})};view=new z.ui.SelectfillModal({pick:pick,target:$el,choices:choices,current:current,hideRawValue:(_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?_ref3.hideRawValue:void 0:void 0,options:{custom:customValue,placeholder:placeholderValue,fancychoices:(_ref4=this.options.options)!=null?_ref4.fancychoices:void 0}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;return this.selectfillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true})},prefill:function(node,prefill,current,fixedChoices){var $el,customValue,height,loadError,pick,placeholderValue,pos,view,x,y,_ref,_this=this;if((_ref=this.prefillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");if(this.prettypill!=null)$el=this.prettypillTarget();pick=function(pick){var display;display=pick!=null?pick.display:void 0;return _this.model.save({value:pick[\"key\"],display:display},{wait:true,success:function(){return _this.model.trigger(\"prefill\")}})};loadError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};customValue=function(){var _ref2;_this.setMode(\"not\",\"locked\");_this.model.set({display:null});_this.$(\"[data-input]\").prop({disabled:false});if((_ref2=_this.prettypill)!=null){_ref2.editor.setOption(\"readOnly\",false)}_this.focus();return _this.prettypill.editor.focus()};placeholderValue=function(){var _ref2;if((_ref2=_this.prefillModal)!=null)_ref2.close();return _this.userfill(_this.node,{pick:function(picked){var val;val=z.cfg.userfillOTag+picked.key+z.cfg.userfillETag;return _this.model.save({value:val,display:val},{wait:true})}})};if(!(this.prefillSamples!=null)){this.prefillSamples=new z.model.SampleSet([],{node:node,action:node.get(\"action\")})}view=new z.ui.PrefillModal({pick:pick,target:$el,node:node,samples:this.prefillSamples,formRow:this.model,prefill:prefill,current:current,fixedChoices:fixedChoices,options:{error:loadError,custom:customValue,placeholder:placeholderValue}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;this.prefillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true});return view.loadChoices()},userfill:function(node,options){var $el,eTag,elPos,fieldsError,fieldsLoaded,fieldsMissing,left,oTag,pick,pos,top,view,x,y,_ref,_this=this;z.store.set(\"userfill-click\",true);if((_ref=this.userfillModal)!=null?_ref.isOpen():void 0)return;if(!(this.prettypill!=null))return;$el=this.prettypillTarget();elPos=$el.offset();pos=(options!=null?options.coords:void 0)?options.coords:this.prettypill.getCursorCoords();left=(pos!=null?pos.left:void 0)-(elPos!=null?elPos.left:void 0);top=(pos!=null?pos.top:void 0)-(elPos!=null?elPos.top:void 0);x=left;y=top;if(!(x!=null)||x<5)x=5;if(!(y!=null)||y<25)y=25;x+=1;y+=12;oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;pick=function(picked){var key,val;key=picked.key;val=z.cfg.userfillOTag+key+z.cfg.userfillETag;if((options!=null?options.line:void 0)!=null&&(options!=null?options.ch:void 0)!=null&&(options!=null?options.length:void 0)!=null){_this.prettypill.replaceText(val,{line:options.line,ch:options.ch},options.length)}else{_this.prettypill.insertText(val)}return options!=null?typeof options.pick===\"function\"?options.pick(picked):void 0:void 0};fieldsMissing=function(){var view;_this.blur();view=new z.ui.MissingDataModal({success:function(){Backbone.cache.clear(_this.userfillModal.view.gives.url());return _this.userfill(node,options!=null?options.text:void 0)}});return _this.missingDataModal=new z.ui.Modal({view:view})};fieldsError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};fieldsLoaded=function(model,json){var fieldmap,meta,_ref2;fieldmap=model.exportMeta();if((_ref2=_this.prettypill)!=null){_ref2.setOption(\"replacements\",_.extend({},fieldmap,_this.prettyReplacements()))}if(_this.node!=null){meta=_this.node.get(\"meta\")||{};meta[\"fieldmap\"]=fieldmap;return _this.node.save({meta:meta},{loose:false})}};view=new z.ui.UserfillModal({pick:pick,target:$el,node:node,current:options!=null?options.textcurrent:void 0,options:{missing:fieldsMissing,error:fieldsError,success:fieldsLoaded}});if(x>$el.outerWidth())x=$el.outerWidth();if(y>$el.outerHeight())y=$el.outerHeight();this.userfillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false,shortenToFit:true,close:function(){_this.removeEmptyUserfillTags;return _this.prettypill.clearActivePills()}});return view.loadChoices()},givefill:function(node){var $el,fieldsError,fieldsMissing,height,pick,pos,view,x,y,_ref,_ref2,_ref3,_this=this;if((_ref=this.givefillModal)!=null)_ref.close();$el=this.$(\"[data-input]\");pick=function(pick){return _this.model.save({value:pick[\"key\"],display:null},{wait:true})};fieldsMissing=function(){var view;_this.blur();view=new z.ui.MissingDataModal({success:function(){var _ref2;if((_ref2=_this.missingDataModal)!=null)_ref2.close();Backbone.cache.clear(_this.givefillModal.view.gives.url());return _this.givefill(node)}});return _this.missingDataModal=new z.ui.Modal({view:view})};fieldsError=function(model,xhr){var html,modal;_this.blur();html=JST.editor_api_error_modal({key:node.get(\"selected_api\"),message:z.useful.errors(xhr)});return modal=new z.ui.Modal({view:html})};view=new z.ui.GivefillModal({pick:pick,target:$el,givefill:true,node:node,hideRawValue:(_ref2=this.model)!=null?(_ref3=_ref2.options)!=null?_ref3.hideRawValue:void 0:void 0,options:{missing:fieldsMissing,error:fieldsError}});pos=$el.position();height=$el.outerHeight();x=pos.left;y=pos.top+height;this.givefillModal=new z.ui.Modal({view:view,target:$el,x:x,y:y,noX:true,autoFocus:false});return view.loadChoices()},removeEmptyUserfillTags:function(){var $el,eTag,newVal,oTag,tags,val;$el=this.$(\"[data-input]\");oTag=z.cfg.userfillOTag;eTag=z.cfg.userfillETag;tags=oTag+eTag;if(!(tags!=null))return;val=$el.val();newVal=val.replace(new RegExp(tags,\"gm\"),\"\");if(val!==newVal){this.set(newVal);return $el.trigger(\"change\")}},listAdd:function(e){var collection;if(e!=null)e.preventDefault();collection=this.model.collection;collection.listAdd(this.model.get(\"parent\"));return collection.save()},listRemove:function(e){var collection;if(e!=null)e.preventDefault();collection=this.model.collection;collection.listRemove(this.model.id,this.model.get(\"parent\"));return collection.save()},prettypills:function(){var _ref;if(!((_ref=this.options.options)!=null?_ref.prettypills:void 0)){return}if(this.prettypill!=null)this.undelegatePrettypills();return this.prettypillsSetup()},prettyReplacements:function(){var humanize,_this=this;humanize=function(match){match=match.replace(/\\{\\{/g,\"\");match=match.replace(/\\}\\}/g,\"\");return _.superHumanize(match)};return{\"{{(?:(?!{{).)+}}\":{replaceWith:function(match){return humanize(match)},allowRegex:true}}},prettypillsSetup:function(){var classes,input,replacements,saved,tag,type,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_this=this;input=this.$(\"[data-input]\");tag=(_ref=input[0])!=null?_ref.nodeName.toLowerCase():void 0;type=this.model.get(\"type\");if((tag===\"input\"||tag===\"textarea\")&&type!==\"password\"){saved=(_ref2=this.node)!=null?(_ref3=_ref2.get(\"meta\"))!=null?_ref3.fieldmap:void 0:void 0;replacements=_.extend({},saved,this.prettyReplacements());this.prettypill=new PrettyPills(input[0],{showPills:true,replacements:replacements,mode:null,extraKeys:{Tab:false,\"Shift-Tab\":false}});classes=this.prettypill.container.attr(\"class\")+\" \";classes+=input.attr(\"class\");this.prettypill.container.attr(\"class\",classes);this.minInputHeight=type===\"text\"?\"100\":\"26\";this.prettypillHeight();this.delegatePrettypills();if(((_ref4=this.model)!=null?_ref4.get(\"choices\"):void 0)!=null||((_ref5=this.model)!=null?_ref5.get(\"prefill\"):void 0)!=null){this.setMode(\"is\",\"locked\");this.$(\"[data-input]\").prop({disabled:true});if((_ref6=this.prettypill)!=null){_ref6.editor.setOption(\"readOnly\",\"nocursor\")}}if(type!==\"text\"){return(_ref7=this.prettypill)!=null?_ref7.editor.addKeyMap({Enter:function(cm){return false}}):void 0}}},delegatePrettypills:function(){if(!(this.prettypill!=null))return;this.prettypill.on(\"input\",this.softChange);this.prettypill.on(\"input\",this.prettypillHeight);this.prettypill.on(\"change\",this.hardChange);this.prettypill.on(\"mousedown\",this.fillButton);this.prettypill.on(\"pillenter\",this.prettypillEnter);return this.prettypill.on(\"pillleave\",this.prettypillLeave)},undelegatePrettypills:function(){if(!(this.prettypill!=null))return;this.prettypill.off(\"input\",this.softChange);this.prettypill.off(\"input\",this.prettypillHeight);this.prettypill.off(\"change\",this.hardChange);this.prettypill.off(\"mousedown\",this.fillButton);this.prettypill.off(\"pillenter\",this.prettypillEnter);return this.prettypill.off(\"pillleave\",this.prettypillLeave)},prettypillTarget:function(){if(!(this.prettypill!=null))return;return this.$(this.prettypill.container)},prettypillEnter:function(e,options){var length,text,_ref;if((_ref=this.userfillModal)!=null?_ref.isOpen():void 0)return;text=options!=null?options.text:void 0;length=text.length;text=text.replace(z.cfg.userfillOTag,\"\");text=text.replace(z.cfg.userfillETag,\"\");return this.userfill(this.options.options.userfill.node,{text:text,line:options.line,ch:options.ch,length:length,coords:options.coords})},prettypillLeave:function(){var _ref;return(_ref=this.userfillModal)!=null?_ref.close():void 0},prettypillHeight:function(){if(!(this.prettypill!=null)){}}});z.ui.Preloader=z.ui.Base.extend({events:{\"click .retry button\":\"retry\"},initialize:function(options){var _this=this;_.bindAll(this);this.loading=false;this.fakeFirst=true;$(document).ajaxSend(function(){return _this.total+=1});return $(document).ajaxComplete(function(){_this.complete+=1;if(_this.fakeFirst&&_this.complete===1)return _this.complete+=1})},start:function(hardTotal){var _this=this;if(this.loading)return;this.loading=true;this.hardTotal=hardTotal;this.total=0;this.complete=0;this.percent=0;this.interval=setInterval(function(){return _this.renderProgress()},25);this.delay=_.delay(function(){return _this.timeout()},15e3);return this.render()},active:function(){return $.ajax.active},isLoading:function(){return this.loading},render:function(){this.$el.html(JST.preloader({}));this.renderProgress();return this},renderProgress:function(){var percent,total;total=this.hardTotal||this.total;percent=Math.ceil(this.complete/total*100)||0;if(percent>100)percent=100;if(this.percent===percent)return;this.percent=percent;$(\".preloader .progress\").animate({width:percent+\"%\"},200);return this},timeout:function(){this.setMode(\"is\",\"timeout\");clearInterval(this.interval);return clearTimeout(this.delay)},retry:function(e){if(e!=null)e.preventDefault();return z.app.viewport.refresh()},done:function(cb){clearInterval(this.interval);clearTimeout(this.delay);this.loading=false;this.approxTotal=null;return typeof cb===\"function\"?cb():void 0}});z.ui.Viewport=z.ui.Base.extend({events:{click:\"clickAnywhere\",\"click [data-nav]\":\"click\",\"click [data-contact-support]\":\"contactSupport\",'click [href=\"/support/\"]':\"contactSupport\",'click [href=\"mailto:contact@zapier.com\"]':\"contactSupport\",\"click .menu-login\":\"login\",\"click .menu-account\":\"menu\",\"click .links-container\":\"navMenu\"},initialize:function(options){Backbone.cache.on(\"syncing\",this.showSyncing,this);Backbone.cache.on(\"synced\",this.hideSyncing,this);return z.app.clicks=[]},clickAnywhere:function(e){var name;name=$(e.currentTarget).attr(\"data-record-click\");if(name){z.app.track[\"new\"](\"Click\",{name:name})}z.app.clicks.unshift(e);z.app.clicks=z.app.clicks.slice(0,10);return z.app.trigger(\"click\",e)},click:function(e){if(!$(e.target).attr(\"data-nav\")&&!$(e.currentTarget).attr(\"data-nav\")){return}if(z.app.preloader.isLoading())return;if(e!=null)e.preventDefault();if((typeof window.onbeforeunload===\"function\"?window.onbeforeunload():void 0)!=null){if(confirm(window.onbeforeunload()))return this.doNav(e)}else{return this.doNav(e)}},doNav:function(e){var target;target=$(e.target).attr(\"data-nav\")||$(e.currentTarget).attr(\"data-nav\");if((e!=null?e.ctrlKey:void 0)||(e!=null?e.metaKey:void 0)){return z.useful.open(\"/\"+target,null,null)}else{return Backbone.history.navigate(target,{trigger:true})}},refresh:function(){return Backbone.history.location.reload()},title:function(title){return typeof document!==\"undefined\"&&document!==null?document.title=title+z.cfg.title:void 0},dim:function(){return $(\".app, .header, .footer\").removeClass(\"dim\").addClass(\"dim\")},undim:function(){return $(\".app, .header, .footer\").removeClass(\"dim\")},login:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.loginModal)!=null)_ref.close();this.loginModal=new z.ui.Modal({view:new z.ui.LoginModal,target:this.$(\".menu-login\"),x:-234,y:55,noX:true});return this.$(\".links-container\").removeClass(\"open\")},menu:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();this.menuModal=new z.ui.Modal({view:new z.ui.MenuModal({className:\"main menu with-hover\"}),target:this.$(\".menu-account\"),x:-186,y:55,noX:true});return this.$(\".links-container\").removeClass(\"open\")},navMenu:function(e){return $(e.currentTarget).toggleClass(\"open\")},contactSupport:function(e){var modal;if(e!=null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.ContactModal})},showSyncing:function(){return this.$(\".sync\").removeClass(\"hide\")},hideSyncing:function(){return this.$(\".sync\").addClass(\"hide\")}});z.ui.TopBar=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={text:this.getText()};return context},render:function(){var context;context=this.context();if(context.text!=null){this.$el.removeClass(\"hide\");\nthis.$(\"h1\").html(context.text)}else{this.$el.addClass(\"hide\")}return this},showSyncing:function(){return this.$(\".sync\").removeClass(\"hide\")},hideSyncing:function(){return this.$(\".sync\").addClass(\"hide\")},getText:function(){var active_card,amount,is_trialing,is_unlimited,logo,provider,status,trialDays,_ref,_ref2,_ref3;status=(_ref=z.app.account.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.status:void 0:void 0;is_trialing=z.app.account.get(\"is_trialing\");amount=z.app.account.getCurrentPlanAmount();active_card=(_ref3=z.app.account.get(\"billing\"))!=null?_ref3.active_card:void 0;is_unlimited=z.app.account.get(\"is_unlimited\");provider=z.app.account.get(\"provider\");if(!z.app.account.isLoggedIn()){return null}else if(false){logo=\"<i class='img32 \"+provider.selected_api+\"32x32'></i>\";return\"\"+logo+\" &nbsp; Your Zapier account is sponsored by \"+provider.title+\"! &nbsp; \"+logo+\" &nbsp; <a href='#' data-support-tags='sponsored-account'>Learn more.</a> &nbsp; \"+logo}else if(is_unlimited){return null}else if(is_trialing&&active_card!=null){return null}else if(is_trialing){trialDays=z.app.account.trialDaysLeft();if(trialDays>30){return\"You have \"+trialDays+\" days left in your extended trial.\"}else{return\"You have \"+trialDays+' days left in your trial &mdash; <a href=\"/app/settings/plans\" data-nav=\"app/settings/plans\">Choose the best plan for you</a>.'}}else if(status===\"past_due\"||status===\"unpaid\"){return'We couldn\\'t process your credit card! <a href=\"/app/settings\" data-nav=\"app/settings\">Update your credit card</a> to keep your Zaps running.'}else if(status===\"canceled\"){return'Your plan was canceled because we couldn\\'t process your payment. <a href=\"/app/settings\" data-nav=\"app/settings/plans\">Choose a plan</a> to get your Zaps running again.'}else if(z.app.account.get(\"show_beta_link\")){if(_.str.contains(window.location.origin,\"beta.zapier\")){return'<a href=\"https://zapier.com/app/dashboard\">Click here to switch back to the new design.</a>'}else{return'This is our new design! <a href=\"https://zapier.wufoo.com/forms/new-design-feedback/\" target=\"_new\">Give us feedback/report bugs</a> or <a href=\"https://beta.zapier.com/app/dashboard\">log in to the temporary old version</a>.'}}else{return null}}});z.ui.Home=z.ui.Base.extend({events:{\"click .carousel-dots .dot\":\"loadCustomerQuote\",\"click .carousel-nav .next\":\"nextCustomerQuote\",\"click .carousel-nav .previous\":\"previousCustomerQuote\"},initialize:function(){var maxSlideHeight;maxSlideHeight=0;this.$(\".slides .slide\").each(function(){$(this).css(\"display\",\"inline-block\");if($(this).height()>maxSlideHeight){return maxSlideHeight=$(this).height()}});this.$(\".slides\").css(\"height\",maxSlideHeight+\"px\");this.$(\".slides .slide\").css({display:\"none\"});this.$(\".slides .slide\").eq(0).addClass(\"show\");this.totalSlides=this.$(\".slides .slide\").length;return this.currentCarouselSlide=0},showCustomerSlide:function(index){this.$(\".carousel-dots .dot\").removeClass(\"active\");this.$(\".carousel-dots .dot\").eq(index).addClass(\"active\");this.$(\".slides .slide\").removeClass(\"show\");this.$(\".slides .slide\").eq(index).addClass(\"show\");this.currentCarouselSlide=index;return this.$(\".carousel-nav .previous\").removeClass(\"disabled\")},loadCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();index=this.$(e.currentTarget).index();return this.showCustomerSlide(index)},nextCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();if(this.currentCarouselSlide+1>=this.totalSlides){index=0}else{index=this.currentCarouselSlide+1}return this.showCustomerSlide(index)},previousCustomerQuote:function(e){var index;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).hasClass(\"disabled\"))return false;if(this.currentCarouselSlide===0){index=this.totalSlides-1}else{index=this.currentCarouselSlide-1}return this.showCustomerSlide(index)}});z.ui.ForgotPassword=z.ui.Singleton(z.ui.Base.extend({className:\"simple-page forgot\",events:{\"submit form\":\"submit\",\"click .submit\":\"submit\"},initialize:function(options){_.bindAll(this);this.code=options.code;return this.username=options.username},context:function(){var context;context={username:this.username};return context},render:function(){this.$el.html(JST.forgot_base(this.context()));if(this.code!=null&&this.username!=null){this.$el.append(JST.forgot_password(this.context()))}else{this.$el.append(JST.forgot_email(this.context()))}return this},submit:function(e){if(e!=null)e.preventDefault();if(this.code!=null&&this.username!=null){return this.submitPasswordForm()}else{return this.submitEmailForm()}},submitEmailForm:function(){var email,_this=this;email=this.$(\".email\").val();return z.app.account.sendForgotPasswordEmail(email,{success:function(json){return _this.$(\".feedback\").text(json.success).removeClass(\"hide error\").addClass(\"success\")},error:function(xhr){var errors;errors=z.useful.errors(xhr);_this.$(\".feedback\").text(errors).removeClass(\"hide success\").addClass(\"error\");return _.delay(function(){return _this.$(\".feedback\").addClass(\"hide\")},5e3)}})},submitPasswordForm:function(){var password1,password2,_this=this;password1=this.$(\".password1\").val();password2=this.$(\".password2\").val();return z.app.account.resetPassword(this.username,this.code,password1,password2,{success:function(json){_this.$(\".feedback\").text(json.success).removeClass(\"hide error\").addClass(\"success\");return z.useful.goto(\"/\")},error:function(xhr){var errors;errors=z.useful.errors(xhr);_this.$(\".feedback\").text(errors).removeClass(\"hide success\").addClass(\"error\");return _.delay(function(){return _this.$(\".feedback\").addClass(\"hide\")},3e3)}})}}));z.ui.Login=z.ui.Singleton(z.ui.Base.extend({className:\"simple-page login\",initialize:function(options){var _ref;this.options=options;_.bindAll(this);if(((_ref=z.app.account)!=null?_ref.id:void 0)!=null){return z.useful.goto(\"/app/dashboard\")}},context:function(){var context,_ref,_ref2,_ref3;context={status:this.options.status,querystring:(_ref=this.options)!=null?_ref.querystring:void 0,next:(_ref2=this.options)!=null?(_ref3=_ref2.querystring)!=null?_ref3.next:void 0:void 0};return context},render:function(){this.$el.html(JST.login(this.context()));return this}}));z.ui.Zapbook=z.ui.Base.extend({events:{\"click [data-service-sort]\":\"sortServices\",\"click [data-service-filter]\":\"filterServices\",\"click [data-use-template]\":\"useRecipe\",\"click [data-collect-email]\":\"collectEmail\",\"click [data-recipe-paginate-previous]\":\"prevRecipePage\",\"click [data-recipe-paginate-next]\":\"nextRecipePage\",\"click .start-button\":\"usePlain\"},RECIPES_PER_PAGE:4,initialize:function(options){this.options=options;this.recipePage=0;this.paginateRecipes();this.hashString=new z.useful.QueryString(Backbone.history.location.hash.replace(\"#\",\"\",1)).object;this.sorterKey=(this.hashString[\"sort\"]||this.sorterKey).replace(/[^-\\w]/g,\"\");this.filterKey=(this.hashString[\"filter\"]||this.filterKey).replace(/[^-\\w]/g,\"\");this.doFilter();return this.doSort()},paginateRecipes:function(){var index,pagination,recipe,recipes,_i,_len;recipes=this.$(\".zaps .zap-mini\");if(recipes){pagination=this.$(\".zaps\").next(\".pagination\");this.totalPages=Math.ceil(recipes.length/this.RECIPES_PER_PAGE)-1;if(this.totalPages>0)pagination.removeClass(\"hide\");this.$(\"[data-recipe-paginate-previous]\").hide();this.$(\"[data-recipe-paginate-next]\").hide();for(_i=0,_len=recipes.length;_i<_len;_i++){recipe=recipes[_i];index=_.indexOf(recipes,recipe)+1;$(recipe).hide();if(this.RECIPES_PER_PAGE*this.recipePage<index&&index<=this.RECIPES_PER_PAGE*this.recipePage+this.RECIPES_PER_PAGE){$(recipe).show()}}if(this.recipePage)this.$(\"[data-recipe-paginate-previous]\").show();if(this.recipePage!==this.totalPages){this.$(\"[data-recipe-paginate-next]\").show()}$(\"[data-recipe-paginate-page]\").text(this.recipePage+1);return $(\"[data-recipe-paginate-totals]\").text(this.totalPages+1)}},prevRecipePage:function(e){if(e!=null)e.preventDefault();if(this.recipePage>0){this.recipePage-=1;return this.paginateRecipes()}},nextRecipePage:function(e){if(e!=null)e.preventDefault();if(this.recipePage<this.totalPages){this.recipePage+=1;return this.paginateRecipes()}},usePlain:function(e){var qs,recipe,s1,s2,_ref,_ref2,_ref3,_ref4;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).attr(\"data-collect-email\")===\"true\")return;s1=this.$(e.currentTarget).attr(\"data-service-one\");s2=this.$(e.currentTarget).attr(\"data-service-two\");recipe=new z.model.Recipe;recipe.set({read_data:{selected_api:s1},write_data:{selected_api:s2},generated:true});if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0};return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}},useRecipe:function(e){var id,recipe,_this=this;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).attr(\"data-collect-email\")===\"true\")return;$(e.currentTarget).addClass(\"disabled\").html('<div class=\"spinning-star\"></div>');id=$(e.currentTarget).attr(\"data-use-template\");recipe=new z.model.Recipe({id:id});return recipe.fetch({success:function(recipe,resp){var qs,_ref,_ref2,_ref3,_ref4;if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={};if(recipe.get(\"generated\")){qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0}}else{qs={recipe_id:recipe.id}}return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}}})},alphabeticalSorter:function(element){var letterScore,letters;letters=$.trim($(element).text()).toLowerCase();letterScore=function(c,i){return Math.abs(c.charCodeAt(0)-122)/Math.pow(26,i)};return _.reduce(_.map(letters,letterScore),function(p,n){return p+n})},popularSorter:function(element){return Number($(element).attr(\"data-popularity\"))+1e3},recentSorter:function(element){return-(Number($(element).attr(\"data-days-age\"))+1e3)},premiumSorter:function(element){return Number($(element).attr(\"data-is-premium\"))*1e3},calcExtraScore:function(element){return{popular:this.popularSorter,alphabetical:this.alphabeticalSorter,recent:this.recentSorter,premium:this.premiumSorter}[this.sorterKey](element)+this.alphabeticalSorter(element)},score:function(element){var score;element=$(element);score=0;if(element.hasClass(\"filtered\"))score+=5e5;score+=this.calcExtraScore(element);return score},doSort:function(){var scored,_this=this;$(\"[data-service-sort]\").removeClass(\"active\");$('[data-service-sort=\"'+this.sorterKey+'\"]').addClass(\"active\");scored=_.sortBy($(\".services-grid .service\"),function(el){return _this.score(el)});return $(\".services-grid\").html(scored.reverse())},doFilter:function(){$(\"[data-service-filter]\").removeClass(\"active\");log('[data-service-filter=\"'+this.filterKey+'\"]');$('[data-service-filter=\"'+this.filterKey+'\"]').addClass(\"active\");$(\".services-grid .service\").addClass(\"opaque\");$(\".services-grid .service\").removeClass(\"filtered\");$(\".services-grid .service-\"+this.filterKey).removeClass(\"opaque\");if(this.filterKey!==\"all\"){return $(\".services-grid .service-\"+this.filterKey).addClass(\"filtered\")}},sorterKey:\"popular\",sortServices:function(e){if(e!=null)e.preventDefault();this.sorterKey=$(e.currentTarget).attr(\"data-service-sort\");this.doFilter();this.doSort();return this.setUrl()},filterKey:\"all\",filterServices:function(e){if(e!=null)e.preventDefault();this.filterKey=$(e.currentTarget).attr(\"data-service-filter\");this.doFilter();this.doSort();return this.setUrl()},setUrl:function(){var url;url=Backbone.history.location.pathname+\"#\"+$.param({sort:this.sorterKey,filter:this.filterKey});return Backbone.history.navigate(url,{replace:true})},collectEmail:function(e){var view;if(e!=null)e.preventDefault();view=new z.ui.CollectEmailModal({s1:this.options.s1,s2:this.options.s2});return this.collectEmailModal=new z.ui.Modal({view:view})}});z.ui.StatusModal=z.ui.Base.extend({html:null,className:\"status-modal\",initialize:function(options){this.options=options;_.bindAll(this);return this.html=options.html},render:function(){this.$el.html(this.html);this.$el.addClass(this.options[\"class\"]);return this}});z.ui.Status=z.ui.Base.extend({events:{\"click td.has-errors\":\"showErrors\"},initialize:function(options){var el;this.options=options;this.loaded=true;_.bindAll(this,\"scolled\");$(document).scroll(_.throttle(this.scolled,100));el=this.$el.find(\"table\");return this.tableHeights=[el.offset().top,el.height()]},scolled:function(e){var tableHeight,tableTop,winLeft,winTop,_ref,_ref2;_ref=this.tableHeights,tableTop=_ref[0],tableHeight=_ref[1];_ref2=z.useful.viewportScroll(),winLeft=_ref2[0],winTop=_ref2[1];if(winTop>tableTop&&tableTop+tableHeight-35>winTop){return this.$el.find(\"table\").addClass(\"fixed-head\")}else{return this.$el.find(\"table\").removeClass(\"fixed-head\")}},showErrors:function(e){return this.modal=new z.ui.Modal({view:new z.ui.StatusModal({html:$(e.currentTarget).find(\".status-modal-html\").html()})})}});z.ui.DeveloperAppCommonForm=z.ui.Base.extend({events:{\"click .save\":\"save\"},form:null,initialize:function(options){this.options=options;_.bindAll(this);z.app.developer.form.on(\"error\",this.saveError);z.app.developer.form.on(\"invalid\",this.saveError);return z.app.developer.form.on(\"saveSuccess\",this.saveSuccess)},save:function(e){if(e!=null)e.preventDefault();z.app.developer.form.save()},saveSuccess:function(){throw\"You should implement your own saveSuccess method\"},saveError:function(form,errors){this.form.renderErrors(errors)}});z.ui.DeveloperAppCommonSummary=z.ui.Base.extend({tagName:\"tr\",className:\"summary-block\",events:{\"click .delete\":\"delete\"},initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.model!=null))throw\"model required\";return this.setMode(\"default\",\"delete\")},attributes:function(){return{\"data-id\":this.options.model.id}},render:function(){if(!z.app.developer.app.isEditable()){this.$el.find(\"a\").removeAttr(\"href\").removeAttr(\"data-nav\").addClass(\"disabled\");this.undelegateEvents()}return this},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.model.destroy({wait:true,success:function(){return _this.$el.animate({opacity:0},350,function(){return _this.remove()})},error:function(model,xhr,options){var errors;errors=z.useful.errors(xhr);return new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}})}});z.ui.DeveloperAppCommonSection=z.ui.Base.extend({className:\"section\",initialize:function(options){this.options=options;return _.bindAll(this)},renderRows:function(models,summaryView){var container;this.$el.find(\".section-content table tbody\").html(\"\");container=this.$el.find(\".section-content table tbody\");return models.each(function(model){var view;view=new summaryView({model:model});return container.append(view.render().el)},this)},render:function(models,summaryView,emptyTemplate){if(models.length>0){this.renderRows(models,summaryView)}else if(emptyTemplate){this.$el.find(\".section-content\").html(emptyTemplate(this.context()))}if(!z.app.developer.app.isEditable()){this.$el.find(\"a\").removeAttr(\"href\").removeAttr(\"data-nav\").addClass(\"disabled\");this.undelegateEvents();this.$el.find(\"div.warning\").hide()}return this}});z.ui.DashboardSearch=z.ui.Base.extend({events:{\"keyup input\":\"search\",\"click .clear\":\"clear\"},initialize:function(options){this.options=options;_.bindAll(this);this.setMode(\"no\",\"text\");this.model=this.options.model;this.initSearch();return this.search=_.debounce(this._search,300)},initSearch:function(){var mode,val;val=z.store.get(\"dashboard-search\");if(val!=null){this.model.set({search:val})}mode=(val!=null?val.length:void 0)>0?\"has\":\"no\";return this.setMode(mode,\"text\")},context:function(){var context;context={readCount:z.app.reads.length,search:this.model.get(\"search\")};return context},render:function(){this.$el.html(JST.dashboard_search(this.context()));z.useful.placeholders(this.$el);return this},_search:function(){var mode,val;val=this.$(\"input\").val();z.store.set(\"dashboard-search\",val,{expires:0});this.model.set({search:val});mode=(val!=null?val.length:void 0)>0?\"has\":\"no\";return this.setMode(mode,\"text\")},clear:function(e){var val;val=\"\";this.$(\"input\").val(val);z.store.set(\"dashboard-search\",val,{expires:0});this.model.set({search:null});return this.setMode(\"no\",\"text\")}});z.ui.SubscribeBlock=z.ui.Base.extend({className:\"widget subscribe\",events:{\"click .button\":\"subscribe\"},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.dashboard_subscribe(this.context()));return this},subscribe:function(){var _this=this;z.app.account.save({is_subscribed_to_blog:true});return this.$(\".subscribe-info\").fadeOut(\"slow\",function(){return _this.$(\".subscribe-message\").fadeIn(\"fast\")})}});z.ui.LimitsBlock=z.ui.Base.extend({className:\"widget limits\",initialize:function(){z.app.reads.on(\"change:paused add remove destroy\",this.refresh,this);z.app.accountLimits.on(\"change\",this.rerender,this);return this.debounceRender=_.debounce(this.render,1e3)},context:function(){var context;context={};context.limits=z.app.accountLimits.toJSON();return context},render:function(){this.$el.html(JST.dashboard_limits(this.context()));return this},rerender:function(){var limits,_this=this;limits=z.app.accountLimits.toJSON().allotment;return _.each(limits,function(limit){var name;name=_.slugify(limit.name);_this.$(\"#\"+name+\" .bar\").css(\"width\",limit.percent+\"%\");return _this.debounceRender()})},refresh:function(){var _this=this;return _.defer(function(){return z.app.accountLimits.fetch({cache:false})})}});z.ui.LogsBlock=z.ui.Base.extend({className:\"widget activities\",initialize:function(){_.bindAll(this);return z.app.stream.on(\"add remove reset\",this.render,this)},context:function(){var context,logs,_this=this;context={};logs=z.app.stream.filter(function(item){var _ref;return((_ref=item.get(\"data\"))!=null?_ref.status:void 0)!==\"halted\"});context.logs=logs.map(function(item){var l;l=item.toJSON();l.title=item.getTitle();return l});return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_logs(context));return this}});z.ui.PartnerText=z.ui.Base.extend({events:{\"click a\":\"next\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,readService,writeService,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;readService=z.app.services.get((_ref=z.app.recipes)!=null?_ref.at(0).get(\"read_data\")[\"selected_api\"]:void 0);writeService=z.app.services.get((_ref2=z.app.recipes)!=null?_ref2.at(0).get(\"write_data\")[\"selected_api\"]:void 0);context={recipes:(_ref3=z.app.recipes)!=null?_ref3.toJSON():void 0,service:z.app.services.get((_ref4=z.app.partner.get(\"zap\"))!=null?_ref4.selected_api:void 0).getName(),readService:(_ref5=z.app.recipes)!=null?_ref5.at(0).get(\"read_service_selected_api\"):void 0,writeService:(_ref6=z.app.recipes)!=null?_ref6.at(0).get(\"write_service_selected_api\"):void 0,readAction:readService.getActionName((_ref7=z.app.recipes)!=null?_ref7.at(0).get(\"read_data\")[\"action\"]:void 0,\"read\"),writeAction:writeService.getActionName((_ref8=z.app.recipes)!=null?_ref8.at(0).get(\"write_data\")[\"action\"]:void 0,\"write\")};return context},render:function(){this.$el.html(JST.dashboard_partner_text(this.context()));return this},next:function(e){var next,step;if(e!=null)e.preventDefault();step=this.$(e.currentTarget).closest(\"div.step\");next=step.next(\"div.step\");step.removeClass(\"hide\").addClass(\"hide\");return next.removeClass(\"hide\")}});z.ui.Zaps=z.ui.Base.extend({initialize:function(options){this.options=options;_.bindAll(this);_.defaults(this,this.options);z.app.reads.on(\"remove\",this[\"delete\"],this);z.app.reads.on(\"add\",this.add,this);z.app.writes.on(\"add\",this.add,this);z.app.reads.on(\"change:paused\",this.move,this);this.views=[];return this.options.search.on(\"change:search\",this.renderSearch,this)},live:function(read){return read.isLive()},paused:function(read){return!read.isLive()&&read.isComplete()},unfinished:function(read){return!read.isComplete()},setEmptyModes:function(){this.setMode(!z.app.reads.any(this.live),\"live-empty\");this.setMode(!z.app.reads.any(this.paused),\"paused-empty\");return this.setMode(!z.app.reads.any(this.unfinished),\"unfinished-empty\")},context:function(){var context;context={isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var renderSearch,_this=this;this.$el.html(JST.dashboard_zaps(this.context()));this.setEmptyModes();this.$live=this.$(\".live-block\");this.$paused=this.$(\".paused-block\");this.$unfinished=this.$(\".unfinished-block\");renderSearch=_.after(z.app.reads.length,this.renderSearch);z.app.reads.each(function(read){return _.defer(function(){_this.add(read);return renderSearch()})});return this},add:function(model){var $el,read,view,write;if(!((model!=null?model.isLive:void 0)!=null)){read=z.app.reads.get(model.get(\"read_id\"));write=model}else{read=model;write=z.app.writes.get(model.get(\"write_ids\")[0])}if(!(read!=null)||!(write!=null))return;view=_.find(this.views,function(view){return view.id===read.id});if(this.live(read))$el=this.$live;if(this.paused(read))$el=this.$paused;if(this.unfinished(read))$el=this.$unfinished;if(view!=null){view.$el.appendTo($el);view.delegateEvents()}else{view=new z.ui.Zap({read:read,write:write,zaps:this});view.id=read.id;$el.append(view.render().el);this.views.push(view)}return this.setEmptyModes()},\"delete\":function(model){var view;view=_.find(this.views,function(view){return view.id===model.id});if(view!=null)view.remove();this.views=_.without(this.views,view);return this.setEmptyModes()},move:function(model){var $el,view;view=_.find(this.views,function(view){return view.id===model.id});if(!(view!=null))return;if(this.live(model))$el=this.$live;if(this.paused(model))$el=this.$paused;if(this.unfinished(model))$el=this.$unfinished;view.undelegateEvents();view.$el.appendTo($el);view.delegateEvents();return this.setEmptyModes()},renderSearch:function(){var _this=this;return this.$(\".zap-mini\").each(function(i,el){var $el,read,write;$el=$(el);read=z.app.reads.get($el.attr(\"data-read-id\"));write=z.app.writes.get($el.attr(\"data-write-id\"));$el.removeClass(\"hide\");if(!_this.searchMatch(read,write))return $el.addClass(\"hide\")})},regex:{selected_api:/selected_api:(\"[^\"]+\"|[\\w]+)/g,params:/params:(\"[^\"]+\"|[\\w]+)/g,action:/action:(\"[^\"]+\"|[\\w]+)/g,status:/status:(\"[^\"]+\"|[\\w]+)/g},searchMatch:function(read,write){var any,each,haystack,m,needle,needles,q,_i,_len,_ref,_ref2,_this=this;q=this.search.get(\"search\")||\"\";needles=q.split(\"OR\");any=[];for(_i=0,_len=needles.length;_i<_len;_i++){needle=needles[_i];each=[];if(m=needle.match(this.regex.selected_api)){each.push(_.all(m,function(match){match=match.replace(\"selected_api:\",\"\");needle=needle.replace(\"selected_api:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return read.get(\"selected_api\")===match||write.get(\"selected_api\")===match}))}if(m=needle.match(this.regex.action)){each.push(_.all(m,function(match){match=match.replace(\"action:\",\"\");needle=needle.replace(\"action:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return read.get(\"action\")===match||write.get(\"action\")===match}))}if(m=needle.match(this.regex.params)){each.push(_.all(m,function(match){match=match.replace(\"params:\",\"\");needle=needle.replace(\"params:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;return _.str.include(JSON.stringify(read.get(\"params\")),match)||_.str.include(JSON.stringify(write.get(\"params\")),match)}))}if(m=needle.match(this.regex.status)){each.push(_.all(m,function(match){var status;match=match.replace(\"status:\",\"\");needle=needle.replace(\"status:\"+match,\"\");match=_.trim(match,'\"');if(!(match!=null))return true;status=!read.isComplete()?\"unfinished\":null;if(!(status!=null))status=read.isLive()?\"live\":\"paused\";return _.str.include(status,match)}))}needle=_.trim(needle.toLowerCase());haystack=\"\";haystack+=(read!=null?read.get(\"title\"):void 0)+\" \";haystack+=(read!=null?read.get(\"action\"):void 0)+\" \";haystack+=((_ref=z.app.services.get(read!=null?read.get(\"selected_api\"):void 0))!=null?_ref.getName():void 0)+\" \";haystack+=(write!=null?write.get(\"title\"):void 0)+\" \";haystack+=(write!=null?write.get(\"action\"):void 0)+\" \";haystack+=((_ref2=z.app.services.get(write!=null?write.get(\"selected_api\"):void 0))!=null?_ref2.getName():void 0)+\" \";haystack=haystack.toLowerCase();if((needle!=null?needle.length:void 0)>0){each.push(_.str.include(haystack,needle))}if(_.any(each,function(e){return!e})){any.push(false)}else{any.push(true)}}return _.any(any,function(a){return a})}});z.ui.CreateBlock=z.ui.Base.extend({className:\"widget create\",context:function(){var context;context={isPartner:z.app.partner.isPartnerSession()};return context},render:function(){this.$el.html(JST.dashboard_create(this.context()));return this}});z.ui.PartnerZaps=z.ui.Base.extend({events:{\"click button[data-template-id]\":\"useRecipe\"},initialize:function(options){this.options=options;_.bindAll(this);this.setMode(\"no\",\"text\");return this.model=this.options.model},context:function(){var context,_ref,_ref2;context={recipes:(_ref=z.app.recipes)!=null?_ref.toJSON():void 0,service:z.app.services.get((_ref2=z.app.partner.get(\"zap\"))!=null?_ref2.selected_api:void 0).getName(),button:this.options.button};return context},render:function(){this.$el.html(JST.dashboard_partner_zaps(this.context()));return this},useRecipe:function(e){var recipe;if(e!=null)e.preventDefault();$(e.currentTarget).attr(\"disabled\",true);recipe=z.app.recipes.get($(e.currentTarget).attr(\"data-template-id\"));return recipe.startUsing({success:function(read,write){$(e.currentTarget).attr(\"disabled\",false);return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}});z.ui.BonusBlock=z.ui.Base.extend({className:\"widget bonuses\",initialize:function(){z.app.accountBonuses.on(\"change\",this.debounceRender,this);return this.debounceRender=_.debounce(this.render,1e3)},context:function(){var context;context={};context.bonuses=z.app.accountBonuses.toJSON();_.each(context.bonuses,function(bonus){bonus.earned=false;bonus.partial_earned=false;if(bonus.limit===1&&bonus.times_earned>0)bonus.earned=true;if(bonus.limit!==1&&bonus.times_earned===bonus.limit){bonus.earned=true}if(bonus.limit!==1&&bonus.times_earned>0){return bonus.partial_earned=true}});return context},render:function(){if(!z.app.account.isFree())return this;this.$el.html(JST.dashboard_bonus(this.context()));this.refresh();return this},refresh:function(){return z.app.accountBonuses.fetch({expiry:2e3})}});z.ui.Zap=z.ui.Base.extend({tagName:\"div\",className:\"zap-mini dashboard\",attributes:function(){var _ref,_ref2;return{\"data-read-id\":(_ref=this.options.read)!=null?_ref.id:void 0,\"data-write-id\":(_ref2=this.options.write)!=null?_ref2.id:void 0}},events:{\"click .open-menu\":\"menu\",\"click .toggle .hit-target\":\"toggle\",\"click .count\":\"tag\",click:\"edit\"},initialize:function(options){var render;this.options=options;if(!(this.options.read!=null))throw\"read required\";if(!(this.options.write!=null))throw\"write required\";_.bindAll(this);_.defaults(this,this.options);render=_.debounce(this.render,40);this.setMode(this.state.get(\"open\")||\"not\",\"open\");this.setMode(this.state.get(\"paused\")||this.read.get(\"paused\"),\"paused\");this.setMode(this.state.get(\"delete\")||this.read.get(\"delete\"),\"delete\");this.read.on(\"change:title\",render,this);this.read.on(\"change:selected_api\",render,this);this.read.on(\"change:has_shared\",render,this);this.write.on(\"change:selected_api\",render,this);return z.app.stream.on(\"add remove reset\",render,this)},context:function(){var context,readService,t;readService=z.app.services.get(this.read.get(\"selected_api\"));context={};context.read=this.read.toJSON();context.write=this.write.toJSON();context.title=this.read.getTitle();context.cssReadClass=this.read.serviceImageClass();context.cssWriteClass=this.write.serviceImageClass();context.canRun=!(readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0);context.isStaff=z.app.account.isStaff();context.isComplete=this.read.isComplete();context.unseen=z.app.stream.unseen(this.write.get(\"id\"));context.canShare=this.read.canShare()&&this.write.canShare();t=z.useful.render(\"{{s}}\",{s:this.read.get(\"collect_errors\").join(\"<br />\")});context.errorString=new Handlebars.SafeString(t);return context},render:function(){var context;context=this.context();this.$el.html(JST.dashboard_zap(context));return this},edit:function(e){var $elX,menuX,toggleX,x,_ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();$elX=this.$el.offset().left;x=e.pageX-$elX;if(this.$(\".toggle\").length>0){toggleX=this.$(\".toggle\").offset().left-$elX;menuX=this.$(\".open-menu\").offset().left-$elX;if(x<toggleX){return Backbone.history.navigate(\"app/editor/\"+this.read.id,{trigger:true})}else if(x<menuX){return this.toggle(e)}else{return this.menu(e)}}else{menuX=this.$(\".open-menu\").offset().left-$elX;if(x<menuX){return Backbone.history.navigate(\"app/editor/\"+this.read.id,{trigger:true})}else{return this.menu(e)}}},menu:function(e){var _ref;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.ZapMenu({read:this.read,write:this.write}),target:this.$(\".open-menu\"),x:-215,y:48,noX:true})},toggle:function(e){if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();if(this.read.get(\"paused\")){return this.unpause(e)}else{return this.pause(e)}},pause:function(e){var _this=this;return this.$el.animate({opacity:.25},350,function(){return _this.read.pause({wait:true,success:function(){_this.$el.animate({opacity:1},350,function(){return _this.render()});return _this.setMode(\"is\",\"paused\")}})})},unpause:function(e){var _this=this;return this.$el.animate({opacity:.25},350,function(){return _this.read.unpause({wait:true,error:function(model,xhr){var error,modal;_this.$el.animate({opacity:1},350,function(){});_this.setMode(\"is\",\"paused\");if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})},success:function(){_this.$el.animate({opacity:1},350,function(){return _this.render()});return _this.setMode(\"not\",\"paused\")}})})},tag:function(e){return e!=null?e.stopPropagation():void 0}});z.ui.ZapMenu=z.ui.Base.extend({className:\"zap-menu-modal menu with-hover\",events:{\"click .edit\":\"edit\",\"click .logs\":\"logs\",\"click .copy\":\"copy\",\"click .rename\":\"rename\",\"click .share\":\"share\",\"click .delete\":\"delete\",\"click .recipe\":\"recipe\",\"click .instant\":\"instant\",\"click .run\":\"run\"},initialize:function(options){this.options=options;_.bindAll(this);this.read=this.options.read;return this.write=this.options.write},context:function(){var context,readService;readService=z.app.services.get(this.read.get(\"selected_api\"));context={};context.read=this.read.toJSON();context.write=this.write.toJSON();context.title=this.read.getTitle();context.cssReadClass=this.read.serviceImageClass();context.cssWriteClass=this.write.serviceImageClass();context.canRun=!(readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0);context.isStaff=z.app.account.isStaff();context.isComplete=this.read.isComplete();context.unseen=z.app.stream.unseen(this.write.get(\"id\"));context.canShare=this.read.canShare()&&this.write.canShare();\nreturn context},render:function(){this.$el.html(JST.dashboard_zap_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})},run:function(e){var modal;if(e!=null)e.preventDefault();return modal=new z.ui.Modal({view:new z.ui.RunZap({read:this.read})})},edit:function(e){if(e!=null)e.preventDefault();return this.close()},logs:function(e){if(e!=null)e.preventDefault();return this.close()},\"delete\":function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"delete\")!==\"confirm\"){this.setMode(\"confirm\",\"delete\");_.delay(function(){return _this.setMode(\"default\",\"delete\")},3e3);return}return this.$el.animate({opacity:0},350,function(){return _this.read.destroy({success:function(){return _this.close()}})})},rename:function(e){var modal,save,_this=this;if(e!=null)e.preventDefault();save=function(value){return _this.read.save({title:value})};modal=new z.ui.Modal({view:new z.ui.RenameModal({value:this.read.getTitle(),save:save})});return this.close()},share:function(e){if(e!=null)e.preventDefault();this.shareZapModal=new z.ui.Modal({view:new z.ui.ShareZapModal({read:this.read,write:this.write})});return this.close()},copy:function(e){var _this=this;if(e!=null)e.preventDefault();if(this.state.get(\"copy\")===\"working\")return;this.setMode(\"working\",\"copy\");return this.read.copy({success:function(){return _.delay(function(){_this.setMode(\"default\",\"copy\");return _this.close()},1e3)}})},getRecipeURL:function(){var base,qs;base=\"/admin/snapbook/recipe/add/\";qs=$.param({title:\"\"+_.superHumanize(this.read.get(\"action\"))+\" to \"+_.superHumanize(this.write.get(\"action\")),read:this.read.get(\"selected_api\"),write:this.write.get(\"selected_api\"),read_action:this.read.get(\"action\"),write_action:this.write.get(\"action\"),read_params:JSON.stringify(this.read.get(\"params\")),write_params:JSON.stringify(this.write.get(\"params\"))});return\"\"+base+\"?\"+qs},recipe:function(e){var options,target,url,win;if(e!=null)e.preventDefault();url=this.getRecipeURL();target=null;options=\"height=600,width=980,resizable=yes,scrollbars=yes\";win=z.useful.open(url,target,options).focus();return this.close()},instant:function(e){if(e!=null)e.preventDefault()}});z.ui.Support=z.ui.Base.extend({events:{click:\"open\"},initialize:function(options){var _this=this;_.bindAll(this);return Backbone.history.on(\"route\",function(){_this.render();if(_.str.include(Backbone.history.fragment,\"help/\")){return $(\".support-button\").addClass(\"on-help\")}else{return $(\".support-button\").removeClass(\"on-help\")}})},open:function(e){if(e!=null)e.preventDefault();if(_.str.include(Backbone.history.fragment,\"help/\")){return this.contactSupport()}else{return z.useful.goto(\"/help\")}},contactSupport:function(){var modal;return modal=new z.ui.Modal({view:new z.ui.ContactModal})},context:function(){var context;context={};if(_.str.include(Backbone.history.fragment,\"help/\")){context[\"label\"]=\"Contact us\"}else{context[\"label\"]=\"Get help\"}return context},render:function(){this.$el.html(JST.support_base(this.context()));return this}});z.ui.ContactModal=z.ui.Base.extend({className:\"support-question\",events:{\"click button.submit\":\"submit\"},initialize:function(options){var _ref,_ref2,_ref3,_this=this;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}this.IDENTIFIER=[{key:\"full_name\",label:\"Your full name.\",type:\"unicode\",required:true},{key:\"email\",label:\"Your email address.\",type:\"unicode\",required:true}];this.CHOICES=[\"I have a question before signing up.\",\"I can't access my account.\",\"I can't get my zap to work.\",\"I got an error on my zap.\",\"I have a billing/pricing question.\",\"Some other issue.\"];if((_ref2=z.app.account)!=null?_ref2.id:void 0){this.IDENTIFIER=[];this.CHOICES=[\"I can't get my zap to work.\",\"I got an error on my zap.\",\"I have a billing/pricing question.\",\"I have a request for a new feature or supported service.\",\"Some other issue.\"]}this.fields=[{key:\"question_type\",label:\"What do you need help with?\",choices:this.CHOICES,type:\"prettypills\",required:true}];this.form=new z.model.FormSet(this.fields);this.form.on(\"change\",this.formChange,this);this.form.on(\"add reset\",this.render,this);this.setMode(\"cannot\",\"save\");if(((_ref3=z.app.account)!=null?_ref3.id:void 0)&&(!(z.app.reads!=null)||!(z.app.services!=null))){return async.parallel({services:async.fetch(new z.model.ServiceSet),reads:async.fetch(new z.model.ReadSet)},function(err,models){_.extend(z.app,models);return _this.render()})}},context:function(){var context,_ref;context={button:(_ref=this.options)!=null?_ref.button:void 0,mediaUrl:window.mediaUrl};return context},render:function(){var view;this.$el.html(JST.support_contact_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.form,prettypills:true});this.$paramform.html(view.render().el);return this},formChange:function(e){var ZAP_FORM,choice_fields,extended_fields,fields,_ref,_ref2,_ref3;fields=this.form.toJSON().slice(0,1);ZAP_FORM=[{key:\"zap\",label:\"Which zap is having the issue?\",help_text:\"Please do not delete/modify the zap! We will need to use it to debug.\",type:\"unicode\",choices:(_ref=z.app.reads)!=null?_ref.map(function(read){return\"\"+(read.getTitle()||\"Unnamed Zap\")+\" (https://zapier.com/app/edit/\"+read.id+\")\"}):void 0,required:true},{key:\"message\",label:\"Describe the problem you are having. What did you want to happen?\",help_text:\"The more details you provide the faster/better we can respond! For example, let us know what you tried already, or what you expected to happen, etc...\",type:\"text\",required:true},{key:\"media_urls\",label:\"Videos/Screenshots URL\",help_text_html:'<p>Videos/Screenshots are the best way to show us <em>exactly</em> what is going on. Use a service like <strong><a target=\"_new\" href=\"http://imgur.com/\">Imgur</a></strong> to upload images, or a service like <strong><a target=\"_new\" href=\"http://www.techsmith.com/jing.html\">Jing</a></strong> to share videos.</p>',type:\"unicode\",required:false}];if(!((_ref2=z.app.account)!=null?_ref2.id:void 0)){ZAP_FORM=[{key:\"login\",help_text_html:'<br /><p class=\"red\"><em>You need to <a href=\"/app/login?next='+window.location.pathname+'\">login first</a> if you want to ask a zap specific question!</em></p>',type:\"copy\",required:true}]}if(fields[0][\"value\"]&&this.currentType!==fields[0][\"value\"]){this.currentType=fields[0][\"value\"];choice_fields={\"I have a question before signing up.\":this.IDENTIFIER.concat([{key:\"message\",label:\"What is your question?\",help_text:\"The more details you provide, the faster we can respond!\",type:\"text\",required:true}]),\"I can't access my account.\":this.IDENTIFIER.concat([{key:\"message\",label:\"More information.\",help_text:\"Please provide any identifying information you might have about the inaccessible account (company name, alternate emails, usernames, etc...).\",type:\"text\",required:false}]),\"I can't get my zap to work.\":this.IDENTIFIER.concat(ZAP_FORM),\"I got an error on my zap.\":this.IDENTIFIER.concat(ZAP_FORM),\"I have a request for a new feature or supported service.\":this.IDENTIFIER.concat([{key:\"service\",label:\"Which service does this pertain to?\",type:\"unicode\",choices:[\"Suggest New Service\"].concat((_ref3=z.app.services)!=null?_ref3.filter(function(service){var _ref4;return!((_ref4=service.get(\"meta\"))!=null?_ref4.hide:void 0)}).map(function(service){return\"\"+service.getName()}):void 0),required:true},{key:\"message\",label:\"Provide more details.\",type:\"text\",required:true}]),\"I have a billing/pricing question.\":this.IDENTIFIER.concat([{key:\"message\",label:\"Ask away! The more details you provide, the faster we can respond!\",type:\"text\",required:true}]),\"Some other issue.\":this.IDENTIFIER.concat([{key:\"message\",label:\"Describe the issue you are having.\",help_text:\"The more details you provide, the faster we can respond!\",type:\"text\",required:true},{key:\"media_urls\",label:\"Videos/Screenshots URL\",help_text_html:'<p>Videos/Screenshots are the best way to show us <em>exactly</em> what is going on. Use a service like <strong><a target=\"_new\" href=\"http://imgur.com/\">Imgur</a></strong> to upload images, or a service like <strong><a target=\"_new\" href=\"http://www.techsmith.com/jing.html\">Jing</a></strong> to share videos.</p>',type:\"unicode\",required:false}])};extended_fields=choice_fields[this.currentType];this.form.reset(fields.concat(extended_fields));this.modal.reposition()}if(this.form.isValid()){return this.setMode(\"can\",\"save\")}else{return this.setMode(\"cannot\",\"save\")}},submit:function(e){var values;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"cannot\",\"save\"))return;this.setMode(\"cannot\",\"save\");this.$(\".feedback\").text(\"\").removeClass(\"error\");this.$(\"button\").text(\"Sending...\");values=this.form.getValues();values.current_url=String(window.location.href);return this.save(values)},saveSuccess:function(model){var _this=this;this.$(\".submitter\").html('<em class=\"lighter\">Got it! We will respond via email as soon as possible!</em> <a class=\"close\">Close this.</a>');return setTimeout(function(){return _this.modal.close()},1e4)},saveError:function(model,xhr){var errors;this.setMode(\"can\",\"save\");errors=z.useful.errors(xhr);this.$(\".feedback\").text(errors).addClass(\"error\");return this.$(\"button\").text(\"Send Support Request\")},save:function(values){return $.ajax({url:z.cfg.api+\"/support/contact\",type:\"POST\",data:JSON.stringify(values),dataType:\"json\",contentType:\"application/json\",success:this.saveSuccess,error:this.saveError})}});z.ui.SupportNote=z.ui.Base.extend({events:{\"click [data-support-vote]\":\"vote\"},initialize:function(options){this.options=options;return _.bindAll(this)},vote:function(e){var helpful,success,_this=this;helpful=$(e.currentTarget).attr(\"data-support-vote\");success=function(){return _this.$el.find(\".vote\").text(\"Thanks! This helps us provide better support.\")};return this.options.note.vote({success:success},helpful)},context:function(){var context,_ref;context=this.options.note.toJSON();context=_.extend(context,{first:this.options.first,more:this.options.more,isStaff:(_ref=z.app.account)!=null?_ref.get(\"is_staff\"):void 0});return context},render:function(){var context;context=this.context();this.$el.html(JST.support_note(context));return this}});z.ui.Plans=z.ui.Base.extend({events:{\"click .toggle-interval .switch\":\"switch\",\"click .toggle-interval .toggle-container\":\"toggle\",\"click [data-explain-highlight]\":\"highlight\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);return this.variant=\"month\"},context:function(){var context;context={services:z.app.services,monthly:this.variant===\"month\",plans:z.app.plans.getIntervalPlans(this.variant)};return context},toggle:function(e){var t;t=$(e.currentTarget);if(t.hasClass(\"on\")){this.variant=\"month\"}else{this.variant=\"year\"}t.toggleClass(\"on\");this.render();return this.normalizePlanHeight()},\"switch\":function(e){var t;if(e!=null)e.preventDefault();t=$(e.currentTarget);t.parent().toggleClass(\"on\");this.variant=t.attr(\"data-pricing-interval\");this.render();return this.normalizePlanHeight()},highlight:function(e){var highlightThis,target;highlightThis=$(e.currentTarget).attr(\"data-explain-highlight\");this.$el.find(\"[data-explain]\").removeClass(\"highlighted\");target=this.$el.find('[data-explain=\"'+highlightThis+'\"]');return $(\"html, body\").animate({scrollTop:target.offset().top-100},100,function(){return target.addClass(\"highlighted\")})},render:function(){var context;context=this.context();this.$el.html(JST.pricing_plans(context));return this},normalizePlanHeight:function(cb){var height,plan_boxes;plan_boxes=this.$el.find(\".plan .features\");height=_.max(_.map(plan_boxes,function(el){return $(el).height()}));if(height){plan_boxes.css({height:height+\"px\"})}return typeof cb===\"function\"?cb():void 0}});z.ui.DeveloperAppRequests=z.ui.Base.extend({events:{\"click #request-log-controls button\":\"loadRequestLogs\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_requests(this.context()));this.loadRequestLogs();return this},displayRequest:function(html){var backLink,origScroll,requestLog,requestLogControls,requestLogList,requsetDetails;requestLog=this.$el.find(\"#request-log\");requestLogControls=this.$el.find(\"#request-log-controls\");requestLogList=requestLog.find(\"table\");origScroll=$(\"body\").scrollTop();requsetDetails=$(\"<div>\").append(html);backLink=$('<a href=\"#\">Back to List</a>').on(\"click\",function(e){e.preventDefault();requsetDetails.remove();requestLogControls.show();requestLogList.show();return $(\"body\").scrollTop(origScroll)});requsetDetails.prepend(backLink);requestLogControls.hide();requestLogList.hide();requestLog.append(requsetDetails);return $(\"body\").scrollTop(0)},loadRequestLogs:function(){var ajaxifyRequestLinks,refreshIcon,requestLog,_this=this;requestLog=this.$el.find(\"#request-log\");ajaxifyRequestLinks=function(){return $(\"#request-log table a\").on(\"click\",function(e){var url;e.preventDefault();url=$(e.target).attr(\"href\")+\"?wrap=false\";return $.ajax(url,{success:_this.displayRequest})})};refreshIcon=$(\"#request-log-controls button\");refreshIcon.html(\"Loading...\");return $.ajax(\"/developer/app/\"+z.app.developer.app.id+\"/requests?wrap=false\",{success:function(html){requestLog.find(\"table\").remove();requestLog.append(html);ajaxifyRequestLinks();refreshIcon.html(\"Done\");return setTimeout(function(){return refreshIcon.html(\"Refresh\")},1500)}})}});z.ui.DeveloperAppAuthFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_auth_field_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppAuthFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"auth field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),app:z.app.developer.app.toJSON(),isWizard:this.options.isWizard}},render:function(){this.$el.html(JST.developer_app_edit_auth_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref,_ref2;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.authFields.add(model)}if((_ref2=this.options)!=null?_ref2.isWizard:void 0){next=\"/auth/edit/fields\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+next,{trigger:true})}});z.ui.DeveloperAppTriggerFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_trigger_field_table_row(this.context()));return this}});z.ui.DeveloperAppTriggerFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"trigger field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_edit_trigger_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var _ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){this.options.trigger.fields.add(model)}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/triggers/\"+this.options.trigger.get(\"id\")+\"/fields\",{trigger:true})}});z.ui.DeveloperAppAuth=z.ui.DeveloperAppCommonSection.extend({events:{\"click .save-sortable\":\"saveSortable\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},context:function(){var allWarnings,warnings;allWarnings=z.app.developer.app.get(\"warnings\");warnings=[];if(allWarnings!=null?allWarnings.auth_mapping:void 0){warnings=warnings.concat(allWarnings.auth_mapping)}if(allWarnings!=null?allWarnings.oauth_data:void 0){warnings=warnings.concat(allWarnings.oauth_data)}return{app:z.app.developer.app.toJSON(),warnings:warnings}},renderRows:function(){return z.ui.DeveloperAppCommonSection.prototype.renderRows.apply(this,[z.app.developer.app.authFields,z.ui.DeveloperAppAuthFieldSummary])},render:function(){this.$el.html(JST.developer_app_auth(this.context()));return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.authFields,z.ui.DeveloperAppAuthFieldSummary,JST.developer_app_auth_empty_section])},gotSorted:false,saveSortable:function(){var _this=this;this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save-sortable\").text(\"Saving...\");this.$el.find(\".save-sortable\").attr(\"disabled\",\"disabled\");return z.app.developer.app.authFields.saveSort({success:function(){_this.$el.find(\".save-sortable\").text(\"Success!\");return _.delay(function(){return _this.$el.find(\".save-sortable\").hide()},1e3)},error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));_this.$el.find(\".save-sortable\").text(\"Save Sorting\");return _this.$el.find(\".save-sortable\").removeAttr(\"disabled\",\"disabled\")}})},sortFields:function(id,pad){this.$el.find(\".save-sortable\").show();this.gotSorted=true;z.app.developer.app.authFields.models=z.app.developer.app.authFields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});z.app.developer.app.authFields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)}});z.ui.DeveloperAppAuthSettings=z.ui.DeveloperAppCommonForm.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_auth_settings(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppTriggerFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON()}},renderRows:function(){var fieldContainer;this.$el.find(\".trigger-fields tbody\").html(\"\");fieldContainer=this.$el.find(\".trigger-fields tbody\");return this.options.trigger.fields.each(function(field){var view;view=new z.ui.DeveloperAppTriggerFieldSummary({trigger:this.options.trigger,model:field});return fieldContainer.append(view.render().el)},this)},render:function(){this.$el.html(JST.developer_app_trigger_fields(this.context()));this.renderRows();return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;this.options.trigger.fields.models=this.options.trigger.fields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});this.options.trigger.fields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(){var goNextUrl,_this=this;goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/triggers/\"+_this.options.trigger.get(\"id\")+\"/edit/backend\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return this.options.trigger.fields.saveSort({success:goNextUrl,error:function(){this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppTriggers=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_triggers(this.context()));z.app.developer.app.triggers.sort();return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.triggers,z.ui.DeveloperAppTriggerSummary,JST.developer_app_triggers_empty_section])}});z.ui.DeveloperAppActionEditor=z.ui.Base.extend({className:\"action-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_action(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppActionEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_action_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.actions.add(model)}if(this.section===\"appearance\"){next=\"actions/\"+model.get(\"id\")+\"/edit/fields\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/\"+next,{trigger:true})}});z.ui.DeveloperAppActionFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},renderRows:function(){var fieldContainer;this.$el.find(\".action-fields tbody\").html(\"\");fieldContainer=this.$el.find(\".action-fields\");return this.options.action.fields.each(function(field){var view;view=new z.ui.DeveloperAppActionFieldSummary({action:this.options.action,model:field});return fieldContainer.append(view.render().el)},this)},render:function(){var fieldContainer;this.$el.html(JST.developer_app_action_fields(this.context()));fieldContainer=this.$el.find(\".action-fields\");this.options.action.fields.each(function(field){var view;view=new z.ui.DeveloperAppActionFieldSummary({action:this.options.action,model:field});return fieldContainer.append(view.render().el)},this);return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;this.options.action.fields.models=this.options.action.fields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});this.options.action.fields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(e){var goNextUrl,_this=this;if(e!=null)e.preventDefault();goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/actions/\"+_this.options.action.get(\"id\")+\"/edit/backend\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return this.options.action.fields.saveSort({success:goNextUrl,error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return _this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppTriggerEditor=z.ui.Base.extend({className:\"trigger-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_trigger(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppTriggerEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_edit_trigger_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var next,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app.triggers.add(model)}if(this.section===\"appearance\"){next=\"triggers/\"+model.get(\"id\")+\"/edit/fields\"}else if(this.section===\"backend\"){next=\"triggers/\"+model.get(\"id\")+\"/edit/sample\"}else{next=\"\"}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/\"+next,{trigger:true})}});z.ui.DeveloperAppInvite=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_invite(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var modal;this.form.clearErrors();modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_invite_success_modal({numSent:response!=null?response.count:void 0})})}});z.ui.DeveloperAppScripting=z.ui.Base.extend({className:\"scripting-new\",events:{\"click .save\":\"save\",\"click .links\":\"links\",\"click .go-back\":\"back\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);return this.on(\"remove\",function(){var _ref;if((_ref=_this.menuModal)!=null)_ref.close();return window.onbeforeunload=null})},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){var _this=this;this.$el.html(JST.developer_app_scripting(this.context()));this.editor=CodeMirror.fromTextArea(this.$(\"textarea\")[0],{lineNumbers:true,lineWrapping:true,indentUnit:4,matchBrackets:true,mode:\"javascript\"});this.editor.on(\"change\",_.debounce(this.stale,500));_.defer(function(){return _this.editor.refresh()});return this},save:function(e){var _this=this;if(e!=null)e.preventDefault();z.app.developer.app.save({js:this.editor.getValue()},{success:function(){_this.$(\".save\").text(\"Saved!\");return window.onbeforeunload=null},error:function(){return _this.$(\".save\").text(\"Error!\")}});return this.$(\".save\").text(\"Saving...\")},links:function(e){var _ref;if(e!=null)e.preventDefault();if((_ref=this.menuModal)!=null)_ref.close();return this.menuModal=new z.ui.Modal({view:new z.ui.ScriptingLinksMenu({}),target:this.$(\".buttons\"),x:-100,y:40,noX:true})},stale:function(){var current,saved,_this=this;saved=_.str.clean(z.app.developer.app.get(\"js\"));current=_.str.clean(this.editor.getValue());if(saved!==current){window.onbeforeunload=function(){return\"You have unsaved changes! Are you sure you want to leave?\"};return this.$(\".save\").text(\"Save\")}else{return window.onbeforeunload=null}},back:function(e){var go,id,_this=this;if(e!=null)e.preventDefault();id=z.app.developer.app.id;go=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+id,{trigger:true})};if(window.onbeforeunload!=null){if(confirm(window.onbeforeunload()))return go()}else{return go()}}});z.ui.ScriptingLinksMenu=z.ui.Base.extend({className:\"developer-app-scripting-menu-modal menu with-hover\",events:{\"click a\":\"close\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={app:z.app.developer.app.toJSON()};return context},render:function(){this.$el.html(JST.developer_app_scripting_menu(this.context()));return this},close:function(){var _this=this;return _.defer(function(){var _ref;return(_ref=_this.modal)!=null?_ref.close():void 0})}});z.ui.DeveloperAppTriggerSampleResult=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);return z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments)},context:function(){return{trigger:this.options.trigger.toJSON(),app:z.app.developer.app.toJSON(),isNew:z.app.developer.form.wrappedModel.isNew()}},render:function(){var _this=this;this.$el.html(JST.developer_app_trigger_sample_result(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();z.app.developer.form.get(\"sample\").on(\"change\",this.updateSaveButtonCopy);this.overrideForms={};_.each(this.options.triggerSample.get(\"overrides\"),function(override){var overrideEl,overrideModel,overrideView;overrideModel=new z.model.DeveloperAppFormSet([_this.buildOverrideLabelFormRow(override),_this.buildOverrideImportantFormRow(override)]);_this.overrideForms[override.key]=overrideModel;overrideEl=$(\"<div></div>\").html(JST.developer_app_trigger_sample_override_form({key:override.key}));overrideView=new z.ui.DeveloperAppParamForm({form:overrideModel,el:overrideEl.find(\"form\")});overrideView.render();return _this.$el.find(\"#override-container\").append(overrideEl)});return this},save:function(e){var overrides,_this=this;if(e!=null)e.preventDefault();overrides=this.options.triggerSample.get(\"overrides\");_.each(overrides,function(override){var values;values=_this.overrideForms[override.key].getValues();return override=_.extend(override,values)});z.app.developer.form.save()},saveSuccess:function(model,response,options){var _ref;if((_ref=z.app.developer.form.wrappedModel.changed)!=null?_ref.sample:void 0){this.render()}else{Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}},buildOverrideLabelFormRow:function(override){return new z.model.FormRow({key:\"label\",value:override!=null?override.label:void 0,required:false,label:\"Label\",type:\"unicode\",help_text:\"\"})},buildOverrideImportantFormRow:function(override){return new z.model.FormRow({key:\"important\",value:override!=null?override.important:void 0,required:false,label:\"Important\",type:\"checkbox\"})},updateSaveButtonCopy:function(e){this.$el.find(\"button.save\").text(\"Parse Sample\");this.$el.find(\"#override-container\").slideUp()}});z.ui.DeveloperAppActivation=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:z.app.developer.app.toJSON(),hasErrors:this.options.audit.hasErrors()}\n},render:function(){var auditView;this.$el.html(JST.developer_app_global_activation(this.context()));auditView=new z.ui.DeveloperAppAudit({audit:this.options.audit});this.$el.find(\".developer-app-audit\").html(auditView.render().el);if(!this.options.audit.hasErrors()){this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render()}return this},saveSuccess:function(model,response,options){var modal;modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_global_activation_success_modal()});modal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})})}});z.ui.DeveloperAppMeta=z.ui.DeveloperAppCommonForm.extend({className:\"developer-app\",context:function(){return{app:this.options.app.toJSON()}},render:function(){var fileInput,_this=this;this.$el.html(JST.developer_app_meta(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();if(this.options.app.get(\"id\")!=null){fileInput=this.$el.find('input[type=\"file\"]');fileInput.attr(\"data-url\",\"\"+z.cfg.devapi+\"/apps/\"+this.options.app.get(\"id\")+\"/image\");fileInput.fileupload({dataType:\"json\",add:function(e,data){return z.app.developer.form.setFileUpload(data)}})}else{this.$el.find(\"div.field-image\").hide()}return this},saveSuccess:function(model,response,options){var _ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){z.app.developer.app=model;if(z.app.developer.apps!=null)z.app.developer.apps.add(model)}Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppMigrate=z.ui.Base.extend({className:\"developer-app\",initialize:function(options){this.options=options;return _.bindAll(this)},events:{\"click .save\":\"next\"},context:function(){return{app:z.app.developer.app.toJSON(),hasErrors:this.options.audit.hasErrors()}},render:function(){var auditView;this.$el.html(JST.developer_app_migrate(this.context()));auditView=new z.ui.DeveloperAppAudit({audit:this.options.audit});this.$el.find(\".developer-app-audit\").html(auditView.render().el);return this},next:function(){return $.ajax({type:\"POST\",url:z.cfg.devapi+\"/apps/migrations\",data:JSON.stringify({old_app:this.options.oldAppId,new_app:z.app.developer.app.get(\"id\")}),dataType:\"json\",contentType:\"application/json\",success:function(data,xhr){var modal;modal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_migrate_success_modal()});return modal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}});z.ui.DeveloperAppChooseMigrationTarget=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},events:{\"click .save\":\"next\"},context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_migrate_choose_target(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},next:function(){var old_app_id;if(typeof e!==\"undefined\"&&e!==null)e.preventDefault();if(z.app.developer.form.isValid()){old_app_id=z.app.developer.form.getValues()[\"old_app\"];Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/migrate/\"+old_app_id,{trigger:true})}}});z.ui.DeveloperAppAuthEditor=z.ui.Base.extend({className:\"auth-editor\",section:null,initialize:function(options){this.options=options;_.bindAll(this);return this.section=this.options.section},context:function(){return{app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_auth_editor(this.context()));this.$el.find(\"#editor-section\").html(this.options.sectionView.render().el);return this}});z.ui.DeveloperAppAuthEditorScheme=z.ui.Base.extend({events:{\"click #use-basic-auth\":\"enableBasicAuth\",\"click #use-api-key\":\"showApiKeySubMenu\",\"click #use-oauthv2\":\"showOauthV2SubMenu\",\"click #use-digest-auth\":\"enableDigestAuth\",\"click #api-key-sub-type button\":\"enableApiKey\",\"click #oauthv2-sub-type button\":\"enableOauthV2\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON(),devpath:z.cfg.devpath}},render:function(){this.$el.html(JST.developer_app_auth_choose_scheme(this.context()));return this},saveAuthFieldsAndNext:function(){var saves,_this=this;saves=[];z.app.developer.app.authFields.each(function(field){return saves.push(function(cb){return field.save({required:true},{success:function(){return cb()}})})});async.parallel(saves,function(err,models){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/auth/edit/fields\",{trigger:true})})},enableBasicAuth:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",1);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Username\",key:\"username\",type_of:\"unicode\"},{app:z.app.developer.app});z.app.developer.app.authFields.add({label:\"Password\",key:\"password\",type_of:\"password\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}},showApiKeySubMenu:function(e){e.preventDefault();this.$el.find(\"#api-key-sub-type\").show();return this.$el.find(\"#oauthv2-sub-type\").hide()},enableApiKey:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",this.$(e.target).val());if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"API Key\",key:\"api_key\",type_of:\"unicode\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}},showOauthV2SubMenu:function(e){e.preventDefault();this.$el.find(\"#api-key-sub-type\").hide();return this.$el.find(\"#oauthv2-sub-type\").show()},enableOauthV2:function(e){var authType;authType=parseInt(this.$(e.target).val());z.app.developer.app.set(\"auth_type\",authType);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Access Token\",key:\"access_token\",type_of:\"unicode\"},{app:z.app.developer.app});if(authType===6){z.app.developer.app.authFields.add({label:\"Refresh Token\",key:\"refresh_token\",type_of:\"unicode\"},{app:z.app.developer.app})}this.saveAuthFieldsAndNext()}},enableDigestAuth:function(e){e.preventDefault();z.app.developer.app.set(\"auth_type\",7);if(z.app.developer.app.authFields.size()===0){z.app.developer.app.authFields.add({label:\"Username\",key:\"username\",type_of:\"unicode\"},{app:z.app.developer.app});z.app.developer.app.authFields.add({label:\"Password\",key:\"password\",type_of:\"password\"},{app:z.app.developer.app});this.saveAuthFieldsAndNext()}}});z.ui.DeveloperAppAuthEditorFields=z.ui.Base.extend({events:{\"click .save\":\"save\",\"click .move-up\":\"upRow\",\"click .move-down\":\"downRow\"},context:function(){return{app:z.app.developer.app.toJSON(),devpath:z.cfg.devpath}},renderRows:function(){var container;container=this.$el.find(\".table tbody\");container.html(\"\");return z.app.developer.app.authFields.each(function(model){var view;view=new z.ui.DeveloperAppAuthFieldSummary({model:model});return container.append(view.render().el)},this)},render:function(){if(z.app.developer.app.authFields.size()>0){this.$el.html(JST.developer_app_auth_editor_fields(this.context()));this.renderRows()}else{this.$el.html(JST.developer_app_auth_empty_fields(this.context()))}if(z.app.developer.app.authFields.size()>0){this.$el.find(\".table tbody\").find(\"a[data-nav]\").each(function(index,elem){elem=$(elem);elem.attr(\"data-nav\",elem.attr(\"data-nav\").replace(\"auth/\",\"auth/edit/\").slice(0,-5));elem.attr(\"href\",elem.attr(\"href\").replace(\"auth/\",\"auth/edit/\").slice(0,-5))})}return this},gotSorted:false,sortFields:function(id,pad){this.$el.find(\".save\").text(\"Save & Next\");this.gotSorted=true;z.app.developer.app.authFields.models=z.app.developer.app.authFields.sortBy(function(field,index){if(field.id===id)return index+pad;return index});z.app.developer.app.authFields.each(function(field,index){return field.set({sort:index},{trigger:false})});return this.renderRows()},upRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,-1.1)},downRow:function(e){var currentId;if(e!=null)e.preventDefault();currentId=Number($(e.currentTarget).closest(\"tr\").attr(\"data-id\"));return this.sortFields(currentId,1.1)},save:function(e){var goNextUrl,_this=this;if(e!=null)e.preventDefault();goNextUrl=function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/auth/edit/mapping\",{trigger:true})};if(!this.gotSorted)return goNextUrl();this.$el.find(\".sort-errors\").text(\"\");this.$el.find(\".save\").attr(\"disabled\",\"disabled\");return z.app.developer.app.authFields.saveSort({success:goNextUrl,error:function(model,xhr){_this.$el.find(\".sort-errors\").text(z.useful.errors(xhr));return _this.$el.find(\".save\").removeAttr(\"disabled\",\"disabled\")}})}});z.ui.DeveloperAppAuthEditorForm=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.section=this.options.section},context:function(){return{app:z.app.developer.app.toJSON(),section:this.section}},render:function(){this.$el.html(JST.developer_app_auth_editor_form(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();this.form.$el.find(\"div.field-auth-type\").hide();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperApp=z.ui.Base.extend({className:\"developer-app\",events:{\"click #make-global\":\"showMakeGlobalModal\",\"click #enable-invite\":\"showEnableInviteModal\",\"click #clone-app\":\"cloneApp\",\"click #revert-app\":\"revertApp\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{app:z.app.developer.app.toJSON(),isEditable:z.app.developer.app.isEditable(),isActive:z.app.developer.app.get(\"status\")>0}},render:function(){var wrapper;this.$el.html(JST.developer_app(this.context()));wrapper=this.$el.find(\"div.all-wrapper\");if(!_.isEmpty(z.app.developer.app.get(\"stats\"))){wrapper.append(this.options.subViews.stats.render().el)}wrapper.append(this.options.subViews.auth.render().el);wrapper.append(this.options.subViews.triggers.render().el);wrapper.append(this.options.subViews.actions.render().el);return this},showMakeGlobalModal:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_global_modal,yes:function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\")+\"/activate\",{trigger:true})}})})},showEnableInviteModal:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_invite_modal,yes:function(){var id;id=z.app.developer.app.get(\"id\");return $.ajax({url:z.cfg.devapi+(\"/apps/\"+id+\"/invite_activation\"),type:\"POST\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(){var successModal;modal.close();successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_invite_activation_success_modal()});return successModal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.loadUrl()})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}})})},cloneApp:function(e){e.preventDefault();$.ajax({url:z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/clones\"),type:\"POST\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(data){var successModal;z.app.developer.isAppSetCacheStale=true;successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_clone_success_modal()});return successModal.on(\"remove\",function(){return Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+data.id,{trigger:true})})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})},revertApp:function(e){var modal;e.preventDefault();modal=new z.ui.Modal({autoFocus:false,view:new z.ui.ConfirmModal({jst:JST.developer_app_confirm_revert_modal,yes:function(){return $.ajax({url:z.cfg.devapi+(\"/apps/\"+z.app.developer.app.get(\"id\")+\"/activation\"),type:\"DELETE\",headers:{Accept:\"application/json; charset=utf-8\"},success:function(data){var successModal;modal.close();successModal=new z.ui.Modal({autoFocus:false,view:JST.developer_app_revert_success_modal()});return successModal.on(\"remove\",function(){z.app.developer.isAppCacheStale=true;z.app.developer.isAppSetCacheStale=true;return Backbone.history.loadUrl()})},error:function(xhr){var errors,_ref;if(!(500<=(_ref=xhr.status)&&_ref<600)){errors=z.useful.errors(xhr);new z.ui.Modal({view:\"<div>\"+errors+\"</div>\",error:errors})}}})}})})}});z.ui.DeveloperAppSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){var statusMap;statusMap={0:\"Private\",1:\"Pending\",2:\"Invite-Only\",3:\"Global\"};return{app:this.model.toJSON(),prettyStatus:statusMap[this.model.get(\"status\")]}},render:function(){this.$el.html(JST.developer_app_table_row(this.context()));return this}});z.ui.DeveloperAppTriggerSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){var sourceMap;sourceMap={polling:\"Polling\",\"static-webhooks\":\"Static Webhooks\",\"payload-subscriptions\":\"REST Hooks\",\"notification-subscriptions\":\"Notification REST Hooks\"};return{trigger:this.model.toJSON(),app:z.app.developer.app.toJSON(),prettySource:sourceMap[this.model.get(\"source\")]}},render:function(){this.$el.html(JST.developer_app_trigger_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppTriggerSettings=z.ui.DeveloperAppCommonForm.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){var formChoices;formChoices=z.app.developer.form.get(\"test_trigger\").get(\"choices\");if(_.keys(formChoices).length+1!==z.app.developer.app.triggers.size()){formChoices={\"null\":\"None\"};z.app.developer.app.triggers.each(function(trigger){return formChoices[trigger.id]=trigger.get(\"label\")});z.app.developer.form.get(\"test_trigger\").set(\"choices\",formChoices)}this.$el.html(JST.developer_app_trigger_settings(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+z.app.developer.app.get(\"id\"),{trigger:true})}});z.ui.DeveloperAppAudit=z.ui.Base.extend({context:function(){var errors,warnings;errors=[];_.each(this.options.audit.get(\"errors\"),function(errorsForObject,objectName,array){return errors.push({name:objectName,errors:errorsForObject})});warnings=[];_.each(this.options.audit.get(\"warnings\"),function(warningsForObject,objectName,array){return warnings.push({name:objectName,warnings:warningsForObject})});return{errors:errors,warnings:warnings}},render:function(){this.$el.html(JST.developer_app_audit(this.context()));return this}});z.ui.DeveloperDashboard=z.ui.Base.extend({className:\"dashboard\",initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){return{activeCount:z.app.developer.apps.where({status:3}).length,inviteCount:z.app.developer.apps.where({status:2}).length,pendingCount:z.app.developer.apps.where({status:1}).length,privateCount:z.app.developer.apps.where({status:0}).length}},render:function(){var activeContainer,inviteContainer,pendingContainer,privateContainer;this.$el.html(JST.developer_dashboard(this.context()));privateContainer=this.$el.find(\".private-developer-apps tbody\");pendingContainer=this.$el.find(\".pending-developer-apps tbody\");inviteContainer=this.$el.find(\".invite-developer-apps tbody\");activeContainer=this.$el.find(\".active-developer-apps tbody\");_.each(z.app.developer.apps.sortBy(\"title\"),function(app){var view;view=new z.ui.DeveloperAppSummary({model:app});if(app.get(\"status\")===0){return privateContainer.append(view.render().el)}else if(app.get(\"status\")===1){return pendingContainer.append(view.render().el)}else if(app.get(\"status\")===2){return inviteContainer.append(view.render().el)}else{return activeContainer.append(view.render().el)}},this);return this}});z.ui.DeveloperAppActions=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_actions(this.context()));z.app.developer.app.actions.sort();return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.actions,z.ui.DeveloperAppActionSummary,JST.developer_app_actions_empty_section])}});z.ui.DeveloperAppStats=z.ui.DeveloperAppCommonSection.extend({context:function(){return{app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_stats(this.context()));return z.ui.DeveloperAppCommonSection.prototype.render.apply(this,[z.app.developer.app.stats(),z.ui.DeveloperAppStatsSummary])}});z.ui.DeveloperAppStatsSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{stat:this.model.toJSON()}},render:function(){this.$el.html(JST.developer_app_stats_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.DeveloperAppActionFieldSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{field:this.model.toJSON(),action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_action_field_table_row(this.context()));return this}});z.ui.DeveloperAppActionFieldEditor=z.ui.DeveloperAppCommonForm.extend({initialize:function(options){this.options=options;_.bindAll(this);if(!(this.options.field!=null))throw\"action field required\";z.ui.DeveloperAppCommonForm.prototype.initialize.apply(this,arguments);return this.field=this.options.field},context:function(){return{field:this.field.toJSON(),action:this.options.action.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_edit_action_field(this.context()));this.form=new z.ui.DeveloperAppParamForm({form:z.app.developer.form,el:this.$(\".paramform\")});this.form.render();return this},saveSuccess:function(model,response,options){var actionId,appId,_ref;if(((_ref=options.xhr)!=null?_ref.status:void 0)===201){this.options.action.fields.add(model)}appId=z.app.developer.app.get(\"id\");actionId=this.options.action.get(\"id\");Backbone.history.navigate(\"/\"+z.cfg.devpath+\"/app/\"+appId+\"/actions/\"+actionId+\"/fields\",{trigger:true})}});z.ui.DeveloperAppActionSummary=z.ui.DeveloperAppCommonSummary.extend({context:function(){return{action:this.model.toJSON(),app:z.app.developer.app.toJSON()}},render:function(){this.$el.html(JST.developer_app_action_table_row(this.context()));return z.ui.DeveloperAppCommonSummary.prototype.render.apply(this,arguments)}});z.ui.SelectfillModal=z.ui.Base.extend({className:\"selectfill-wrapper select\",STILL_LOADING:[[\"Loading choices ...\",\"Still loading choices ...\",\"Still still loading choices (hang tight, can take a minute) ...\"],[\"Knocking on {{#plural}}{{service}}{{/plural}} door ...\",\"Waiting for {{service}} to answer ...\",\"Still waiting on {{service}} (stick with us; can take a few minutes) ...\"],[\"Releasing the carrier pigeons ...\",\"Waiting for the pigeons to return ...\",\"Still waiting on the pigeons (stick with us; can take a few minutes) ...\"],[\"Commence thumb twiddling ...\",\"{{service}} is sure taking their time ...\",\"Still twiddling thumbs (stick with us; can take a few minutes) ...\"]],events:{\"mousedown li\":\"clickField\",\"mousemove li\":\"mousemove\",\"mousedown li.custom-value\":\"customValue\",\"mousedown li.placeholder-value\":\"placeholderValue\"},initialize:function(options){var i,_ref,_ref2,_ref3,_ref4,_this=this;this.options=options;_.bindAll(this);this.hideRawValue=(_ref=this.options)!=null?_ref.hideRawValue:void 0;this.target=(_ref2=this.options)!=null?_ref2.target:void 0;this.choices=this.getChoices((_ref3=this.options)!=null?_ref3.choices:void 0);this.current=(_ref4=this.options)!=null?_ref4.current:void 0;$(document).on(\"keydown\",this.keydown);i=_.random(0,this.STILL_LOADING.length-1);this.loadingMsg=this.STILL_LOADING[i];return this.on(\"remove\",function(){$(document).off(\"keydown\",_this.keydown);return z.useful.noBGScrollOff(_this.$el)})},getChoices:function(choices){var k,newChoices,v,_i,_len;newChoices=[];if(!_.isArray(choices)){for(k in choices){v=choices[k];newChoices.push({key:k,display:v,val:k})}}else if(_.isArray(choices)&&_.any(choices,function(i){return _.isString(i)})){for(_i=0,_len=choices.length;_i<_len;_i++){v=choices[_i];newChoices.push({key:v,display:v,val:null})}}else{newChoices=choices}this.setMode(\"show\",\"empty-value\");return _.filter(newChoices,function(choice){return Boolean(choice.key)})},parseGives:function(gives){var choices,_this=this;choices=gives!=null?gives.map(function(give){return{key:give.getKey(),display:give.getLabel(),val:give.getSample(),type:give.get(\"type\")}}):void 0;choices=choices!=null?choices.filter(function(choice){return!_.str.include(choice.key,\"zap_meta\")}):void 0;return _.filter(choices,function(choice){return Boolean(choice.key)})},context:function(){var context,_ref,_ref2,_ref3;context={choices:this.choices,fancychoices:(_ref=this.options.options)!=null?_ref.fancychoices:void 0,hideRawValue:this.hideRawValue};if(this.node!=null||((_ref2=this.options)!=null?_ref2.useGives:void 0)){context.loadingMsg=this.loadingMsg;context.service=(_ref3=z.app.services.get(this.node.get(\"selected_api\")))!=null?_ref3.getName():void 0}return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_selectfill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"min-width\",this.modal.targetWidth());return this},highlightDefault:function(){var $el,_this=this;this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").filter(function(i,el){return $(el).attr(\"data-key\")===_this.current});if(this.current!=null&&($el!=null?$el.length:void 0)>0){$el.addClass(\"hover\")}else{this.$(\"li:not(.hide)\").first().addClass(\"hover\")}if(this.current!=null&&($el!=null?$el.length:void 0)>0){return _.defer(function(){return _this.$el.scrollTo($el)})}},clickField:function(e){var $el,display,id,key,val,_ref;if(e!=null)e.preventDefault();$el=this.$(\"li.hover\").first();key=$el.attr(\"data-key\");display=$el.attr(\"data-display\");val=$el.attr(\"data-val\");id=$el.attr(\"data-id\");if(id===\"load-more\"||id===\"custom-value\"||id===\"placeholder-value\"){return}if((_ref=this.options)!=null){if(typeof _ref.pick===\"function\"){_ref.pick({key:key,display:display,val:val})}}return this.modal.close()},mousemove:function(e){this.$(\"li\").removeClass(\"hover\");return this.$(e.currentTarget).addClass(\"hover\")},keydown:function(e){if(e.keyCode===13)this.clickField(e);if(e.keyCode===38)this.moveUp(e);if(e.keyCode===40)this.moveDown(e);if(e.keyCode===9)return this.modal.close()},moveUp:function(e){var $el,h,idx;if(e!=null)e.preventDefault();idx=this.$(\"li.hover\").index();this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").eq(idx).prevAll(\"li:not(.hide)\").eq(0).addClass(\"hover\");if(this.$(\"li.hover\").length===0){$el=this.$(\"li:not(.hide)\").first().addClass(\"hover\")}h=$el.outerHeight();if(($el!=null?$el.length:void 0)>0&&this.highlightOutOfView()){return this.$el.scrollTo({left:\"=0px\",top:\"-=\"+h})}},moveDown:function(e){var $el,h,idx;if(e!=null)e.preventDefault();idx=this.$(\"li.hover\").index();this.$(\"li\").removeClass(\"hover\");$el=this.$(\"li\").eq(idx).nextAll(\"li:not(.hide)\").first().addClass(\"hover\");if(this.$(\"li.hover\").length===0){$el=this.$(\"li:not(.hide)\").last().addClass(\"hover\")}h=$el.outerHeight();if(($el!=null?$el.length:void 0)>0&&this.highlightOutOfView()){return this.$el.scrollTo({left:\"+=0px\",top:\"+=\"+h})}},highlightOutOfView:function(){var $el,frameHeight,frameScrollTop,outBottom,outTop,targetHeight,targetScrollTop;$el=this.$(\"li.hover\");if($el.length===0)return;frameScrollTop=this.$el.scrollTop();frameHeight=this.$el.innerHeight();targetScrollTop=$el.position().top;targetHeight=$el.innerHeight();outBottom=targetScrollTop+targetHeight>frameHeight;outTop=targetScrollTop<0;return outBottom||outTop},customValue:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();if((_ref=this.options)!=null){if((_ref2=_ref.options)!=null){if(typeof _ref2.custom===\"function\")_ref2.custom()}}return this.modal.close()},placeholderValue:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();if((_ref=this.options)!=null){if((_ref2=_ref.options)!=null){if(typeof _ref2.placeholder===\"function\")_ref2.placeholder()}}return this.modal.close()}});z.ui.PrefillModal=z.ui.SelectfillModal.extend({className:\"prefill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"keyup input.searcher\":\"search\",\"mousedown li.load-more\":\"loadMore\"})},initialize:function(options){var _ref;this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=this.options.node;this.formRow=this.options.formRow;this.prefill=this.options.prefill;this.samples=options.samples;this.fixedChoices=z.ui.SelectfillModal.prototype.getChoices.apply(this,[(_ref=this.options)!=null?_ref.fixedChoices:void 0]);this.lastSamplesLength=0;if(this.samples.allLoaded)this.setMode(\"hide\",\"load-more\");return this.state.on(\"change:choices\",this.render,this)},getChoices:function(choices){var k,newChoices,v;newChoices=[];for(k in choices){v=choices[k];newChoices.push({key:k,display:v,val:k})}return _.filter(newChoices,function(choice){return Boolean(choice.key)})},context:function(){var choices,context,_ref;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);choices=((_ref=this.fixedChoices)!=null?_ref.length:void 0)>0?this.fixedChoices.concat(this.choices):this.choices;context=_.extend(context,{choices:choices,search:this.searchString,trigger:this.node.isRead()});return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_prefill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"width\",this.modal.targetWidth());return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_ref,_ref2,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);options={success:function(map){var _ref,_ref2;_this.choices=_this.getChoices(map);clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");if(_this.samples.length<=_this.lastSamplesLength){_this.setMode(\"hide\",\"load-more\");_this.samples.allLoaded=true}_this.lastSamplesLength=_this.samples.length;return(_ref=_this.options.options)!=null?(_ref2=_ref.success)!=null?_ref2.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2;_this.error=z.useful.errors(xhr);clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");_this.setMode(\"hide\",\"load-more\");return(_ref=_this.options.options)!=null?(_ref2=_ref.error)!=null?_ref2.apply(_this,arguments):void 0:void 0}};if(!(((_ref=this.formRow)!=null?_ref.collection:void 0)!=null)){return(_ref2=this.modal)!=null?_ref2.close():void 0}return this.samples.prefillMap(this.prefill,this.formRow.collection.getValues(),options)},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)},loadMore:function(e){if(e!=null)e.preventDefault();this.samples.setPage(this.samples.getPage()+1);return this.loadChoices()}});z.ui.UserfillModal=z.ui.SelectfillModal.extend({className:\"userfill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"click button.missing\":\"clickMissing\",\"keyup input.searcher\":\"search\"})},initialize:function(options){this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=this.options.node;this.missing=false;return this.state.on(\"change:choices\",this.render,this)},context:function(){var context;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);context=_.extend(context,{choices:this.choices,missing:this.missing,search:this.searchString});return context},render:function(){var context,_ref;context=this.context();this.$el.html(JST.editor_userfill_modal(context));z.useful.noBGScroll(this.$el);if((_ref=this.options.options)!=null?_ref.flexWidth:void 0){this.$el.css(\"width\",this.modal.targetWidth())}return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);this.gives=new z.model.FieldSet([],{node:this.node});options={data:{zap_meta_limit:3,zap_meta_hydrate:true},success:function(model,json,resp){var _ref,_ref2,_ref3,_ref4,_ref5;_this.setMode(\"hide\",\"empty-value\");_this.choices=_this.parseGives(model);if(_this.choices.length===0){_this.modal.close();return(_ref=_this.options.options)!=null?(_ref2=_ref.missing)!=null?_ref2.apply(_this,arguments):void 0:void 0}_this.missing=(resp!=null?(_ref3=resp.xhr)!=null?_ref3.status:void 0:void 0)===206;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");return(_ref4=_this.options.options)!=null?(_ref5=_ref4.success)!=null?_ref5.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");_this.modal.close();return(_ref=_this.options.options)!=null?(_ref2=_ref.error)!=null?_ref2.apply(_this,arguments):void 0:void 0}};return this.gives.fetch(options)},clickMissing:function(e){var _ref,_ref2;if(e!=null)e.preventDefault();this.modal.close();return(_ref=this.options.options)!=null?(_ref2=_ref.missing)!=null?_ref2.apply(this,arguments):void 0:void 0},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)\n}});z.ui.GivefillModal=z.ui.SelectfillModal.extend({className:\"givefill-wrapper select\",events:function(){return _.extend({},z.ui.SelectfillModal.prototype.events,{\"keyup input.searcher\":\"search\"})},initialize:function(options){var _ref;this.options=options;z.ui.SelectfillModal.prototype.initialize.apply(this,arguments);this.node=(_ref=this.options)!=null?_ref.node:void 0;return this.state.on(\"change:choices\",this.render,this)},context:function(){var context;context=z.ui.SelectfillModal.prototype.context.apply(this,arguments);context=_.extend(context,{search:this.searchString});return context},render:function(){var context,_ref;context=this.context();this.$el.html(JST.editor_givefill_modal(context));z.useful.noBGScroll(this.$el);this.highlightDefault();this.$el.css(\"width\",(_ref=$(this.options.target))!=null?_ref.outerWidth():void 0);return this},loadChoices:function(){var options,stillStillTimer,stillTimer,_this=this;this.setMode(\"loading\",\"choices\");stillTimer=_.delay(function(){return _this.setMode(\"still-loading\",\"choices\")},3e3);stillStillTimer=_.delay(function(){return _this.setMode(\"still-still-loading\",\"choices\")},1e4);this.gives=new z.model.FieldSet([],{node:this.node});options={data:{zap_meta_limit:3,zap_meta_hydrate:true},success:function(model,json,resp){var _ref,_ref2,_ref3,_ref4,_ref5;_this.choices=_this.parseGives(model);if(_this.choices.length===0){if((_ref=_this.modal)!=null)_ref.close();return(_ref2=_this.options.options)!=null?(_ref3=_ref2.missing)!=null?_ref3.apply(_this,arguments):void 0:void 0}clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"loaded\",\"choices\");return(_ref4=_this.options.options)!=null?(_ref5=_ref4.success)!=null?_ref5.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref,_ref2,_ref3;clearInterval(stillTimer);clearInterval(stillStillTimer);_this.setMode(\"error\",\"choices\");if((_ref=_this.modal)!=null)_ref.close();return(_ref2=_this.options.options)!=null?(_ref3=_ref2.error)!=null?_ref3.apply(_this,arguments):void 0:void 0}};return this.gives.fetch(options)},filter:function(search){this.setMode(\"not\",\"nomatch\");this.$(\"li\").removeClass(\"hide\");if(!(search!=null)||search===\"\")return;search=_.str.trim(_.str.clean(search.toLowerCase()));this.$(\"li\").each(function(){var data,display,haystack,key;key=$(this).attr(\"data-key\");display=$(this).attr(\"data-display\");data=$(this).attr(\"data-data\");haystack=_.str.trim(_.str.clean(String(key+display+data).toLowerCase()));if(!_.str.include(haystack,search))return $(this).addClass(\"hide\")});if(this.$(\"li:not(.hide)\").length===0&&this.hasMode(\"loaded\",\"choices\")){return this.setMode(\"is\",\"nomatch\")}},search:function(e){if(e!=null)e.preventDefault();this.searchString=$(e.currentTarget).val();return this.filter(this.searchString)}});z.ui.MissingDataModal=z.ui.Base.extend({className:\"missing-data\",events:{\"click .active>button\":\"buttonClick\",\"click .webhook-url\":\"highlight\"},initialize:function(options){var action,read,readService,service,_this=this;this.options=options;_.bindAll(this);this.samples=new z.model.SampleSet([],{node:z.app.read});service=z.app.services.get(z.app.read.get(\"selected_api\"));action=z.app.read.get(\"action\");this.isHook=service!=null?service.isHook(action,\"read\"):void 0;this.notSubHook=!(service!=null?service.isSubHook(action,\"read\"):void 0);this.step=this.isHook?1:2;read=z.app.read.toJSON();readService=z.app.services.get(z.app.read.get(\"selected_api\"));if(readService.isSubHook(read.action,\"read\")){this.initHook();return this.on(\"remove\",function(){return z.app.read.tearDownHook()})}},initHook:function(){var success,_this=this;this.initConnection=true;success=function(){_this.initConnection=false;return _this.render()};return z.app.read.subscribeHook({success:function(model,resp){return success()},error:function(model,xhr){var context,html;if((xhr!=null?xhr.status:void 0)===409)return success();_this.initConnection=false;_this.close();context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_hook_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},context:function(){var action,context,read,service;read=z.app.read.toJSON();service=z.app.services.get(z.app.read.get(\"selected_api\"));action=z.app.read.get(\"action\");context={read:read,readModel:z.app.read,service:service,step:this.step,initConnection:this.initConnection,filters:this.getFilterTable(),action:action,isHook:this.isHook,notSubHook:this.notSubHook};return context},renderClipboard:function(){var $el,clip,_this=this;$el=this.$(\".copy-button\");if($el){clip=new z.useful.clipboard($el);clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)});return this.modal.on(\"reposition\",function(){return clip.reposition()})}},render:function(){this.$el.html(JST.editor_missing_data_modal(this.context()));this.renderClipboard();return this},getFilterTable:function(){var _this=this;return _.compact(z.app.readNeeds.map(function(i){var f,k,v;if(i.isListParent())return false;k=i.getLabel();v=i.getDisplay();f=i.get(\"input_format\");if(f!=null){if((f!=null?f[0]:void 0)!=null)v=f[0]+v;if((f!=null?f[2]:void 0)!=null)v=v+f[2];v=_.template(v)({cid:z.app.account.id,ccode:z.app.account.get(\"code\")})}if(v!=null){return{k:k,v:v}}return false}))},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},buttonClick:function(e){var step;if(e!=null)e.preventDefault();step=this.$(e.currentTarget).attr(\"data-step\");if(step===\"1\")this.nextStep(e);if(this.isHook){if(step===\"2\"){this.nextStep(e);this.waitForData(e)}if(step===\"4\")return this.done(e)}else{if(step===\"2\")this.nextStep(e);if(step===\"3\")this.loadData(e);if(step===\"4\")return this.done(e)}},nextStep:function(e){this.step+=1;return this.render()},waitForData:function(e){var _this=this;this.sampleInterval=setInterval(function(){return _this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},z.app.read.getParams()),success:function(model,json,resp){if(model.length>0){_this.setMode(\"hide\",\"loading-samples\");_this.setMode(\"show\",\"found-samples\");clearInterval(_this.sampleInterval);return _this.nextStep()}},error:function(model,xhr){var context,html;clearInterval(_this.sampleInterval);context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},5e3);return this.on(\"remove\",function(){return clearInterval(_this.sampleInterval)})},loadData:function(e){var _this=this;if(this.$(e.currentTarget).hasClass(\"disabled\"))return;this.$(e.currentTarget).text(\"Loading...\").addClass(\"disabled\");this.setMode(\"hide\",\"no-samples\");return this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},z.app.read.getParams()),success:function(model,json,resp){if(model.length>0){return _this.nextStep()}else{_this.setMode(\"show\",\"no-samples\");return _this.render()}},error:function(model,xhr){var context,html;context={key:z.app.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return _this.modal=new z.ui.Modal({view:html})}})},done:function(e){var _ref;if((_ref=this.options)!=null){if(typeof _ref.success===\"function\")_ref.success()}return this.close()},close:function(){return this.modal.close()}});z.ui.CustomFilterRow=z.ui.Base.extend({className:\"advanced-filter\",events:{\"click .remove\":\"destroy\",\"change .field-value input\":\"updateModel\"},initialize:function(options){var fields,_this=this;_.bindAll(this);_.defaults(this,options);this.model=options.rule;this.model.on(\"destroy\",function(){return _this.remove()},this);this.model.on(\"change\",this.render,this);this.matchChoices={iexact:\"(Text) Exactly matches\",\"not-iexact\":\"(Text) Does not exactly match\",icontains:\"(Text) Contains\",\"not-icontains\":\"(Text) Does not contain\",istartswith:\"(Text) Starts with\",\"not-istartswith\":\"(Text) Does not start with\",iendswith:\"(Text) Ends with\",\"not-iendswith\":\"(Text) Does not end with\",igreater:\"(Number) Greater than\",iless:\"(Number) Less than\",idategreater:\"(Date/time) Greater than\",idateless:\"(Date/time) Less than\",idateequal:\"(Date/time) Equals\",iexist:\"Exists\",\"not-iexist\":\"Does not exist\"};fields=[{key:\"key\",type:\"select\",hideLabel:true,givefill:{node:z.app.read},value:this.model.get(\"key\")!=null?this.model.get(\"key\"):void 0,placeholder:\"Key\"},{key:\"match\",hideLabel:true,type:\"select\",hideRawValue:true,choices:this.matchChoices,placeholder:\"Matches\"},{key:\"value\",type:\"unicode\",hideLabel:true,required:false,value:this.model.get(\"value\")!=null?this.model.get(\"value\"):void 0,placeholder:\"Value\"}];this.form=new z.model.FormSet(fields);this.paramform=new z.ui.ParamForm({form:this.form});return _.each(this.form.models,function(row){if(row.options.type===\"select\"){return row.on(\"change\",_this.updateModel,_this)}})},context:function(){var context;context={group:this.model.get(\"group\"),index:this.index};return context},render:function(){var match;this.$el.html(JST.editor_custom_filter_row(this.context()));this.$(\"paramform\").replaceWith(this.paramform.render().el);match=this.model.get(\"match\");if(match===\"iexist\"){this.setMode(\"hide\",\"field-value\")}else{this.setMode(\"show\",\"field-value\")}if(this.model.get(\"action\")===\"stop\")match=\"not-\"+match;this.$(\".field-match input\").val(this.matchChoices[match]);return this},destroy:function(){return this.model.destroy()},updateModel:function(){var action,check,data,fields,key,match,value;key=this.$(\".field-key input\").val();match=_.invert(this.matchChoices)[this.$(\".field-match input\").val()];value=this.$(\".field-value input\").val();action=\"continue\";if(_.str.startsWith(match,\"not-\")){match=match.replace(\"not-\",\"\");action=\"stop\"}data={key:key,match:match,value:value,action:action};this.model.set(data);fields=[key,match,action];check=_.all(fields,function(field){if(field!=null&&field!==\"\")return true});if(check)this.model.save();if(match===\"iexist\"){return this.setMode(\"hide\",\"field-value\")}else{return this.setMode(\"show\",\"field-value\")}}});z.ui.TestStep=z.ui.Base.extend({className:\"test-zap\",events:{\"click .skip a\":\"skip\",\"click .load\":\"load\",\"click .webhook-url\":\"highlightWebhook\",\"click [data-sample-read-id]\":\"openReadData\",\"click [data-sample-write-id]\":\"openWriteData\",\"click .continue\":\"continue\",\"click [data-send-sample-id]\":\"send\",\"click .custom-filters\":\"scrollToFilters\"},initialize:function(options){var render,stale;this.options=options;_.bindAll(this);this.read=this.options.read;this.write=this.options.write;this.writeNeeds=this.options.writeNeeds;this.readNeeds=this.options.readNeeds;this.rules=this.options.rules;render=_.debounce(this.render,40);stale=_.debounce(this.stale,40);this.read.on(\"change:selected_api change:authentication_id change:action\",render,this);this.read.on(\"change:selected_api change:authentication_id change:action\",stale,this);this.rules.on(\"change add remove\",stale,this);this.readNeeds.on(\"change\",render,this);this.writeNeeds.on(\"change\",render,this);this.samples=new z.model.SampleSet([],{node:z.app.read});this.samples.on(\"reset\",render,this);return this.setMode(\"no\",\"samples\")},context:function(){var authValid,context,readService,show,writeService,_ref,_this=this;readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));authValid=this.read.get(\"authentication_id\")!=null||!(readService!=null?readService.needsAuth():void 0);show=this.readNeeds.isValid()&&authValid&&this.writeNeeds.isValid();if((_ref=this.samples)!=null){_ref.each(function(sample,i){var action,noun;noun=_this.read.getActionNoun();sample.num=i+1;sample.readSummary=sample.summary(sample.toJSON(),{\"default\":\"Sample \"+noun});action=_this.write.getActionLabel();return sample.writeSummary=sample.summary(sample.buildWrite(_this.write.get(\"params\")),{\"default\":action})})}context={flow:this.options.flow,show:show,readService:readService,writeService:writeService,readNoun:this.read.getActionNoun(),samples:this.samples,filters:_.compact(this.readNeeds.map(function(i){var k,v;if(i.isListParent())return false;k=i.getLabel();v=i.getDisplay();if(v!=null){return{k:k,v:v}}return false}))};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_test(context));return this},skip:function(e){if(e!=null)e.preventDefault();this.setMode(\"hide\",\"skip\");return z.app.editor.next(this)},stale:function(){this.samples.reset();return this.setMode(\"no\",\"samples\")},load:function(e,cache){var loadFields,loadSamples,_this=this;if(cache==null)cache=false;if(e!=null)e.preventDefault();if(this.hasMode(\"loading\",\"samples\"))return;this.$(\".load\").text(\"Loading...\");this.loadingTimer=_.delay(function(){return _this.$(\".load\").text(\"Still Loading...\")},3e3);this.setMode(\"loading\",\"samples\");loadSamples=function(cb){return _this.samples.fetch({cache:cache,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:3},_this.read.getParams()),success:function(model,json,resp){if(model.length>0){return typeof cb===\"function\"?cb():void 0}else{clearInterval(_this.loadingTimer);_this.setMode(\"no\",\"samples\");return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal({success:function(){return _this.load.apply(_this,[e,false])}})})}},error:function(model,xhr){var context,html,modal;_this.setMode(\"no\",\"samples\");clearInterval(_this.loadingTimer);context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})};loadFields=function(cb){_this.fields=new z.model.FieldSet([],{node:z.app.read});return _this.fields.fetch({cache:cache,data:{zap_meta_combine:false},success:function(model,json,resp){return cb()},error:function(model,xhr){var context,html,modal;_this.setMode(\"no\",\"samples\");clearInterval(_this.loadingTimer);context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})};return async.series([loadSamples,loadFields],function(err,results){clearInterval(_this.loadingTimer);_this.setMode(\"loaded\",\"samples\");return _this.render()})},highlightWebhook:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},openReadData:function(e){var customs,data,modal,pos;if(e!=null)e.preventDefault();pos=this.$(e.currentTarget).attr(\"data-sample-read-id\");customs=this.fields.toJSON();data={};_.each(this.samples.at(pos).buildRead(),function(v,k){return data[customs[k]||_.superHumanize(k)]=v});if(data.zap_meta_filter!=null)delete data.zap_meta_filter;return modal=new z.ui.Modal({view:new z.ui.DataTableModal({data:data})})},openWriteData:function(e){var customs,data,modal,pos,rendered;if(e!=null)e.preventDefault();pos=this.$(e.currentTarget).attr(\"data-sample-write-id\");data={};customs=this.fields.toJSON();rendered=this.samples.at(pos).buildWrite(this.write.get(\"params\"));_.each(rendered,function(v,k){return data[customs[k]||_.superHumanize(k)]=v});return modal=new z.ui.Modal({view:new z.ui.DataTableModal({data:data})})},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},send:function(e){var $el,data,options,pos,raw,replaced,sample,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.hasClass(\"working\"))return;pos=$el.attr(\"data-send-sample-id\");sample=this.samples.at(pos);replaced=this.samples.at(pos).buildWrite(this.write.get(\"params\"),{sanitize:false});raw=sample.toJSON();data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");$el.addClass(\"working\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");return $el.removeClass(\"working\")},error:function(model,xhr){var context,html,modal,service,_ref;clearInterval(_this.loadingTimer);service=(_ref=z.app.services.get(_this.write.get(\"selected_api\")))!=null?_ref.getName():void 0;$el.text(\"Send!\");$el.removeClass(\"working\");context={key:_this.write.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};return this.write.write(this.write.get(\"action\"),data,options)},scrollToFilters:function(e){var options;if(e!=null)e.preventDefault();options={offset:{left:0,top:-25}};return $.scrollTo('a[id=\"custom-filters\"]',200,options)}});z.ui.AuthStep=z.ui.Base.extend({className:\"auths\",events:{\"click li.auth\":\"select\",\"click .test\":\"test\",\"click .add\":\"add\",\"click .continue\":\"continue\",\"click .webhook-url\":\"highlight\"},initialize:function(options){var render,renderTest,_this=this;this.options=options;_.bindAll(this);this.model=this.options.isTrigger?this.options.read:this.options.write;render=_.debounce(this.render,40);renderTest=_.debounce(this.renderTest,40);this.setMode(\"disable\",\"continue\");this.model.on(\"change:selected_api\",render,this);this.model.on(\"change:action\",render,this);this.state.on(\"change\",renderTest,this);this.model.on(\"change:authentication_id\",function(){render();return renderTest()},this);z.app.auths.on(\"remove\",function(model){if(model.id===_this.model.get(\"authentication_id\")){return _this.model.save({authentication_id:null},{wait:true})}},this);z.app.auths.on(\"add remove\",render,this);z.app.auths.on(\"change:title\",render,this);return this.on(\"remove\",function(){return _this.$(\"select.auths\").off(\"change\",_this.selectChange)})},get:function(){return this.model.get(\"authentication_id\")},set:function(id){return this.model.save({authentication_id:Number(id)},{wait:true})},unset:function(){return this.model.save({authentication_id:null},{wait:true})},show:function(){return this.checkAutoSelect()},checkAutoSelect:function(){var auths,_ref;auths=z.app.auths.getByKey(this.model.get(\"selected_api\"));if(((_ref=this.options)!=null?_ref.flow:void 0)&&(auths!=null?auths.length:void 0)===1){return this.set(auths[0].id)}},context:function(){var accountSatisfied,action,auths,context,isHook,key,service,which;key=this.model.get(\"selected_api\");service=z.app.services.get(key);action=this.model.get(\"action\");which=this.options.isTrigger?\"read\":\"write\";isHook=(service!=null?service.isHook(action,which):void 0)&&!(service!=null?service.isSubHook(action,which):void 0);accountSatisfied=(service!=null?service.needsAuth():void 0)&&this.get()!=null||!(service!=null?service.needsAuth():void 0);auths=z.app.auths.where({selected_api:this.model.get(\"selected_api\")});context={flow:this.options.flow,key:key,selected:this.get(),testStatus:this.state.get(this.get()),needsAuth:service!=null?service.needsAuth():void 0,isHook:isHook,showContinue:this.options.flow,auths:auths,hasAtLeastOneAuth:z.app.auths.hasAtLeastOneAuth(key),show:this.model.get(\"action\")!=null,service:service,action:action,which:which,model:this.model};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_auth(context));this.renderContinue();this.renderTest();this.initSelect(context);this.renderClipboard();return this},renderClipboard:function(){var $el,action,clip,isHook,key,service,which;key=this.model.get(\"selected_api\");service=z.app.services.get(key);action=this.model.get(\"action\");which=this.options.isTrigger?\"read\":\"write\";isHook=(service!=null?service.isHook(action,which):void 0)&&!(service!=null?service.isSubHook(action,which):void 0);if(isHook){$el=this.$(\".copy-button\");clip=new z.useful.clipboard($el);return clip.on(\"complete\",function(client,args){var _this=this;$(this).text(\"Copied!\");return _.delay(function(){return $(_this).text(\"Copy to clipboard\")},1500)})}},initSelect:function(context){this.$(\"select.auths\").select2({containerCssClass:\"select2-editor-auth larger\",dropdownCssClass:\"select2-editor-auth\",formatResult:_.bind(this.formatResult,this,context.service),formatSelection:_.bind(this.formatSelection,this,context.service),escapeMarkup:function(s){return s},matcher:this.matcher});this.$(\"select.auths\").off(\"change\",this.selectChange);return this.$(\"select.auths\").on(\"change\",this.selectChange)},selectChange:function(e){if(e.val===\"new\"){this.$(\"select.auths\").select2(\"val\",this.get());return this.add(e)}else{return this.set(e.val)}},formatResult:function(service,row){return this.formatSelection.apply(this,arguments)},formatSelection:function(service,row){var html,icon,img,text;if(!row.id)return row.text;icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;if(row.id===\"new\"){img=\"fa fa-plus\"}else{img=\"img32 \"+icon}text=_.escape(row.text);html='<i class=\"'+img+'\"></i> <t>'+text+\"</t>\";return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},select:function(e){var id;if(e!=null)e.preventDefault();id=this.$(e.currentTarget).attr(\"id\");if(String(this.get())!==String(id)){return this.set(id)}else{return this.unset()}},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()},test:function(e){var auth,error,id,success,_this=this;if(e!=null)e.preventDefault();id=this.get();auth=z.app.auths.get(id);if(this.state.get(id)===\"testing\"||this.state.get(id)===\"slow\")return;this.state.set(id,\"testing\");success=function(){return _this.state.set(id,\"success\")};error=function(model,xhr){var context,errors,modal;errors=z.useful.errors(xhr);_this.state.set(id,\"error\");context={auth:auth,message:errors,type:\"manual\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context)})};z.app.auths.get(id).test({success:success,error:error});return _.delay(function(){if(_this.state.get(id)===\"testing\")return _this.state.set(id,\"slow\")},3e3)},add:function(e){var context,key,modal,service,success,_this=this;if(e!=null)e.preventDefault();key=this.model.get(\"selected_api\");service=z.app.services.get(key);z.app.auths.on(\"add\",function(model){return _this.set(model.id)},this);success=function(auth){_this.state.set(auth.id,\"success\");return z.app.auths.off(\"add\",null,_this)};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},renderContinue:function(){var mode,needsAuth,service;service=z.app.services.get(this.model.get(\"selected_api\"));needsAuth=service!=null?service.needsAuth():true;mode=this.get()!=null||!needsAuth?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},renderTest:function(){var $el,status;status=this.state.get(this.get());$el=this.$(\"button.test\");if(status===\"success\"){$el.removeClass(\"success error\").addClass(\"success\");return $el.replaceWith('<span class=\"success\"><i class=\"fa fa-ok\"></i> Account is working.</span>')}else if(status===\"error\"){$el.removeClass(\"success error\").addClass(\"error\");return $el.text(\"Account not working\")}else if(status===\"testing\"){$el.removeClass(\"success error\");return $el.text(\"Testing...\")}else if(status===\"slow\"){$el.removeClass(\"success error\");return $el.text(\"Still testing...\")}else{$el.text(\"Test this Account\");return $el.removeClass(\"success error\")}}});z.ui.FilterStep=z.ui.Base.extend({className:\"filters\",events:{\"click button.continue\":\"continue\",\"click button.retry-fields\":\"loadNeeds\",\"click button.or\":\"or\",\"click .custom .add\":\"add\",\"click .show-custom .add\":\"add\"},initialize:function(options){var render,renderContinue,updateModel,updateNeeds,_this=this;this.options=options;_.bindAll(this);this.model=this.options.read;this.readNeeds=this.options.readNeeds;this.rules=this.options.rules;this.setMode(\"disable\",\"continue\");render=_.debounce(this.render,40);renderContinue=_.debounce(this.renderContinue,40);updateModel=_.debounce(this.updateModel,40);updateNeeds=_.debounce(this.updateNeeds,40);this.state.on(\"change:fields\",render,this);this.model.on(\"change:selected_api change:action change:authentication_id\",render,this);this.views=[];this.rules.on(\"add remove reset\",render,this);this.rules.on(\"change\",this.stripAnd,this);this.rules.on(\"change remove\",this.updateRules,this);this.on(\"remove\",function(){_.each(_this.views,function(view){return view.remove()});return _this.views=[]});this.renderGroups();this.paramform=new z.ui.ParamForm({form:this.readNeeds,prettypills:true,fancychoices:true});this.model.on(\"change:action change:authentication_id\",updateNeeds,this);this.readNeeds.on(\"change:value\",renderContinue,this);return this.loadNeedsAndRender()},updateNeeds:function(){var _this=this;return this.loadNeeds({success:function(){return _this.readNeeds.initData({success:function(){return _.defer(function(){return _this.renderForm()})}})}})},loadNeedsAndRender:function(){var _this=this;return this.loadNeeds({success:function(){return _.defer(function(){return _this.renderForm()})}})},loadNeeds:function(options){var _this=this;this.setMode(\"loading\",\"fields\");return this.readNeeds.fetch({cache:false,success:function(model,json,resp){var _ref;_this.setMode(\"loaded\",\"fields\");if((json!=null?json.length:void 0)===0){_this.setMode(\"zero\",\"fields\")}return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0},error:function(model,xhr){var _ref;_this.setMode(\"error\",\"fields\");return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}})},context:function(){var authValid,context,service,show;service=z.app.services.get(this.model.get(\"selected_api\"));authValid=this.model.get(\"authentication_id\")!=null||!(service!=null?service.needsAuth():void 0);show=service!=null&&this.model.get(\"action\")!=null&&authValid;context={state:this.state.toJSON(),flow:this.options.flow,show:show,form:this.readNeeds,read:this.model.toJSON(),service:service};context=_.extend(context,{rules:this.rules});return context},render:function(){var context,groupIds,index,_this=this;context=this.context();this.detachForm();this.$el.html(JST.editor_filter(context));this.attachForm();this.renderContinue();this.$groups=this.$(\".groups\");groupIds=this.rules.getGroups();index=1;_.each(groupIds,function(id,i){var $el,$or,rules;$el=$('<div class=\"group\"></div>').attr(\"data-group\",id);$el.appendTo(_this.$groups);if(i>0){$or=$('<div class=\"or\"></div>').text(\"OR\");$or.insertBefore($el)}rules=_this.rules.where({group:id});return _.each(rules,function(rule){var view;view=new z.ui.CustomFilterRow({rule:rule,samples:_this.samples,index:index});view.render().$el.appendTo($el);_this.views.push(view);return index+=1})});this.stripAnd();this.renderGroups();return this},show:function(){var _ref;return(_ref=this.paramform)!=null?_ref.refreshPrettypills():void 0},detachForm:function(){return this.paramform.$el.detach()},attachForm:function(){return this.$(\"paramform\").replaceWith(this.paramform.$el)},renderForm:function(){return this.paramform.render()},renderContinue:function(){var mode;mode=this.readNeeds.isValid()?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},renderGroups:function(){if(this.rules.length>0){this.setMode(\"show\",\"custom\");return this.setMode(\"hide\",\"custom-toggle\")}else{this.setMode(\"hide\",\"custom\");return this.setMode(\"show\",\"custom-toggle\")}},destroyRules:function(){var _this=this;return this.rules.each(function(rule){return rule.destroy()})},stripAnd:function(){return this.$(\".group\").each(function(){return $(this).find(\".and\").last().text(\"\")})},updateRules:function(){var ids;ids=_.compact(this.rules.pluck(\"id\"));return this.options.read.set({rule_ids:ids},{silent:true})},add:function(e){var id,rule;if(e!=null)e.preventDefault();id=this.$(e.currentTarget).attr(\"data-group\");if(!(id!=null))id=this.rules.getMaxGroup();rule=new z.model.Rule({group:Number(id)});rule.setRead(this.options.read);return this.rules.add(rule)},or:function(e){var id,rule;if(e!=null)e.preventDefault();id=this.rules.getMaxGroup()+1;rule=new z.model.Rule({group:Number(id)});rule.setRead(this.options.read);return this.rules.add(rule)}});z.ui.MapStep=z.ui.Base.extend({className:\"map\",events:{\"click button\":\"continue\",\"click button.retry-fields\":\"loadNeeds\",\"click .enable-live-preview\":\"enableLivePreview\"},initialize:function(options){var insertPreviewContainer,loadNeedsAndRender,render,renderContinue,renderPreview,updateModel,updateNeeds,_this=this;this.options=options;_.bindAll(this);this.model=this.options.write;this.read=this.options.read;this.readNeeds=this.options.readNeeds;this.writeNeeds=this.options.writeNeeds;this.setMode(\"disable\",\"continue\");render=_.debounce(this.render,40);renderContinue=_.debounce(this.renderContinue,40);updateModel=_.debounce(this.updateModel,40);loadNeedsAndRender=_.debounce(this.loadNeedsAndRender,40);updateNeeds=_.debounce(this.updateNeeds,40);renderPreview=_.debounce(this.renderPreview,40);insertPreviewContainer=_.debounce(this.insertPreviewContainer,40);this.read.on(\"change:selected_api change:action change:authentication_id\",render,this);this.model.on(\"change:selected_api change:action change:authentication_id\",render,this);this.samples=new z.model.SampleSet([],{node:z.app.read});this.writeNeeds.on(\"change:value\",function(){return renderPreview()},this);this.writeNeeds.on(\"add\",function(){insertPreviewContainer();return renderPreview()},this);this.samples.on(\"reset\",renderPreview,this);this.read.on(\"change:selected_api change:action change:authentication_id\",function(){return _this.samples.reset()},this);this.read.on(\"change:selected_api\",function(){return _this.renderForm()},this);this.paramform=new z.ui.ParamForm({form:this.writeNeeds,prettypills:true,fancychoices:true,userfill:{\"class\":this.userfillClass,node:this.read}});this.model.on(\"change:action change:authentication_id\",updateNeeds,this);this.readNeeds.on(\"change:value\",render,this);this.writeNeeds.on(\"change:value\",renderContinue,this);this.writeNeeds.on(\"prefill\",updateNeeds,this);this.writeNeeds.on(\"change:value\",renderContinue,this);loadNeedsAndRender();return this.on(\"remove\",function(){var _ref;return(_ref=_this.paramform)!=null?_ref.remove():void 0},this)},updateNeeds:function(){var _this=this;return this.loadNeeds({success:function(){return _this.writeNeeds.initData({success:function(){return _.defer(function(){return _this.renderForm()})}})}})},loadNeedsAndRender:function(){var _this=this;return this.loadNeeds({success:function(){return _.defer(function(){return _this.renderForm()})}})},loadNeeds:function(options){var _this=this;this.setMode(\"loading\",\"fields\");return this.writeNeeds.fetch({cache:false,success:function(model,json,resp){var _ref,_ref2;_this.setMode(\"loaded\",\"fields\");if((resp!=null?(_ref=resp.xhr)!=null?_ref.status:void 0:void 0)===206){_this.setMode(\"error\",\"fields\")}if((json!=null?json.length:void 0)===0){_this.setMode(\"zero\",\"fields\")}return options!=null?(_ref2=options.success)!=null?_ref2.apply(_this,arguments):void 0:void 0},error:function(){var _ref;_this.setMode(\"error\",\"fields\");return options!=null?(_ref=options.error)!=null?_ref.apply(_this,arguments):void 0:void 0}})},context:function(){var authValid,context,readAction,readNeedsValid,readService,show,writeAction,writeService;readService=z.app.services.get(this.read.get(\"selected_api\"));readAction=readService!=null?readService.getActionName(this.read.get(\"action\"),\"read\",\"true\"):void 0;writeService=z.app.services.get(this.model.get(\"selected_api\"));writeAction=writeService!=null?writeService.getActionName(this.model.get(\"action\"),\"write\",\"true\"):void 0;readNeedsValid=this.readNeeds.isValid();authValid=this.model.get(\"authentication_id\")!=null||!(writeService!=null?writeService.needsAuth():void 0);\nshow=readService!=null&&readAction!=null&&writeService!=null&&writeAction!=null&&readNeedsValid&&authValid;context={state:this.state.toJSON(),flow:this.options.flow,show:show,form:this.writeNeeds,service:writeService,write:this.model.toJSON(),readService:readService,readAction:readAction,writeService:writeService,writeAction:writeAction};return context},render:function(){var context;context=this.context();this.detachForm();this.$el.html(JST.editor_map(context));this.attachForm();this.renderContinue();return this},show:function(){var _ref;return(_ref=this.paramform)!=null?_ref.refreshPrettypills():void 0},detachForm:function(){return this.paramform.$el.detach()},attachForm:function(){return this.$(\"paramform\").replaceWith(this.paramform.$el)},renderForm:function(){this.paramform.render();this.insertPreviewContainer();return this.renderPreview()},userfillClass:function(){var readService;readService=z.app.services.get(this.read.get(\"selected_api\"));return readService.getImageClass(\"16x16\")},renderContinue:function(){var mode;mode=this.writeNeeds.isValid()&&this.hasMode(\"loaded\",\"fields\")?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")},insertPreviewContainer:function(){var _this=this;return this.paramform.$el.find(\".input\").each(function(i,el){var _ref;if(((_ref=$(el).parent().find(\".live-preview\"))!=null?_ref.length:void 0)===0){return $(el).parent().append($('<div class=\"live-preview hide\"></div>'))}})},renderPreview:function(){var sample,_this=this;sample=false;if(this.samples.length>0)sample=this.samples.at(0);return this.writeNeeds.each(function(field){var $el,key,map,value;key=field.get(\"key\");$el=_this.paramform.$el.find(\".field-\"+_.slugify(key)+\" .live-preview\");if(field.get(\"prefill\")!=null){}else if(field.get(\"input_format\")!=null){return $el.remove()}else if(!sample&&!(field.get(\"prefill\")!=null)){$el.html('<a class=\"enable-live-preview\">Preview this field with sample data.</a>');return $el.removeClass(\"hide\")}else if(field.getValue()!=null&&field.getValue()!==\"\"){map=sample.buildWrite({sample:field.getValue()},{sanitize:true});value=map.sample;$el.html($(\"<div/>\").text(value).html().split(\" \").join(\"&nbsp;\").split(\"\\n\").join(\"<br>\"));return $el.removeClass(\"hide\")}else{$el.html(\"<em>Add text and/or placeholders to the field above to preview.</em>\");return $el.removeClass(\"hide\")}})},enableLivePreview:function(e){var showMissing,_ref,_this=this;e.preventDefault();if(this.$(e.currentTarget).hasClass(\"disabled\"))return;if((_ref=this.samples)!=null?_ref.length:void 0){return this.renderContinue()}showMissing=function(){var _ref2;_this.$(e.currentTarget).text(\"Preview this field with sample data.\").removeClass(\"disabled\");if(!((_ref2=_this.samples)!=null?_ref2.length:void 0)){return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal({success:function(){return _this.renderContinue()}})})}};this.$(e.currentTarget).text(\"loading sample data to preview...\").addClass(\"disabled\");return this.samples.fetch({cache:false,data:_.extend({zap_meta_hydrate:true,zap_meta_limit:1},this.read.getParams()),success:function(model,json,resp){if(model.length>0){}else{return _this.missingDataModal=new z.ui.Modal({view:new z.ui.MissingDataModal})}},error:function(model,xhr){var context,html,modal;context={key:_this.read.get(\"selected_api\"),message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}})}});z.ui.ServiceActionStep=z.ui.Base.extend({className:\"step services-actions\",events:{\"change #trigger-service\":\"changeService\",\"change #action-service\":\"changeService\",\"change #trigger\":\"changeAction\",\"change #action\":\"changeAction\",\"click button\":\"continue\"},initialize:function(options){var _this=this;this.options=options;_.bindAll(this);this.setMode(\"disable\",\"continue\");this.setMode(\"hide\",\"triggers\");this.setMode(\"hide\",\"actions\");z.app.read.on(\"change:selected_api change:action\",this.render,this);z.app.write.on(\"change:selected_api change:action\",this.render,this);this.buildServiceMatchIndex();this.state.on(\"change:saving\",this.renderLocks,this);this.state.set({showTriggerAll:false,showActionAll:false});$(document).on(\"mouseenter\",\".right li.select2-result-selectable\",this.showActionCard);$(document).on(\"mouseenter\",\".left li.select2-result-selectable\",this.showTriggerCard);$(document).on(\"mouseleave\",\"li.select2-result-selectable\",this.hideCards);$(document).on(\"keypress\",\".select2-editor-service input.select2-input\",this.hideCards);return this.on(\"remove\",function(){$(document).off(\"mouseenter\",\".right li.select2-result-selectable\",_this.showActionCard);$(document).off(\"mouseenter\",\".left li.select2-result-selectable\",_this.showTriggerCard);$(document).off(\"mouseleave\",\"li.select2-result-selectable\",_this.hideCards);return $(document).off(\"keypress\",\".select2-editor-service input.select2-input\",_this.hideCards)})},context:function(){var context,readAction,readActions,showActionExpand,showTriggerExpand,writeAction,writeActions,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;this.readServices=z.app.services.filter(function(service){var _ref;if(z.app.read.get(\"selected_api\")===service.get(\"key\"))return true;if(!service.hasReads())return false;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.writeServices=z.app.services.filter(function(service){var _ref;if(z.app.write.get(\"selected_api\")===service.get(\"key\"))return true;if(!service.hasWrites())return false;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.readService=z.app.services.get(this.options.read.get(\"selected_api\"));this.writeService=z.app.services.get(this.options.write.get(\"selected_api\"));readAction=this.options.read.get(\"action\");this.readActions=(_ref=this.readService)!=null?typeof _ref.getActions===\"function\"?_ref.getActions(\"read\",readAction):void 0:void 0;if(readAction!=null&&this.readService!=null&&!this.readService.isActionImportant(\"read\",readAction)){this.state.set({showTriggerAll:true})}writeAction=this.options.write.get(\"action\");this.writeActions=(_ref2=this.writeService)!=null?typeof _ref2.getActions===\"function\"?_ref2.getActions(\"write\",writeAction):void 0:void 0;if(writeAction!=null&&this.writeService!=null&&!this.writeService.isActionImportant(\"write\",writeAction)){this.state.set({showActionAll:true})}if(!this.state.get(\"showTriggerAll\")){readActions=_.filter(this.readActions,function(action){return action.important});if(((_ref3=this.readActions)!=null?_ref3.length:void 0)!==(readActions!=null?readActions.length:void 0)){showTriggerExpand=true}this.readActions=readActions}if(!this.state.get(\"showActionAll\")){writeActions=_.filter(this.writeActions,function(action){return action.important});if(((_ref4=this.writeActions)!=null?_ref4.length:void 0)!==(writeActions!=null?writeActions.length:void 0)){showActionExpand=true}this.writeActions=writeActions}context={readServices:this.readServices,readActions:this.readActions,writeServices:this.writeServices,writeActions:this.writeActions,showTriggerExpand:showTriggerExpand,showActionExpand:showActionExpand,flow:this.options.flow,partnerService:(_ref5=z.app.services.get((_ref6=z.app.partner.get(\"zap\"))!=null?_ref6.selected_api:void 0))!=null?_ref5.getName():void 0,isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_service_action(context));this.$(\"#trigger-service\").val(this.options.read.get(\"selected_api\"));this.$(\"#action-service\").val(this.options.write.get(\"selected_api\"));this.$(\"#trigger-service\").select2({containerCssClass:\"select2-editor-service larger\",dropdownCssClass:\"select2-editor-service wide left\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcherService});this.$(\"#action-service\").select2({containerCssClass:\"select2-editor-service larger\",dropdownCssClass:\"select2-editor-service wide right\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcherService});this.$(\"#trigger\").val(this.options.read.get(\"action\"));this.$(\"#action\").val(this.options.write.get(\"action\"));this.$(\"#trigger\").select2({containerCssClass:\"select2-editor-action\",dropdownCssClass:\"select2-editor-action wide left\",formatResult:_.bind(this.actionFormatResult,this,this.readService),formatSelection:_.bind(this.actionFormatSelection,this,this.readService),escapeMarkup:function(s){return s},matcher:this.matcher});this.$(\"#action\").select2({containerCssClass:\"select2-editor-action\",dropdownCssClass:\"select2-editor-action wide right\",formatResult:_.bind(this.actionFormatResult,this,this.writeService),formatSelection:_.bind(this.actionFormatSelection,this,this.writeService),escapeMarkup:function(s){return s},matcher:this.matcher});if(this.readService!=null)this.setMode(\"show\",\"triggers\");if(this.writeService!=null)this.setMode(\"show\",\"actions\");this.renderContinue();this.renderLocks();return this},renderLocks:function(){if(this.hasMode(\"is\",\"saving\")){this.$(\".picker.services .trigger select\").select2(\"disable\");this.$(\".picker.services .action select\").select2(\"disable\");this.$(\"select#trigger\").select2(\"disable\");return this.$(\"select#action\").select2(\"disable\")}else{this.$(\".picker.services .trigger select\").select2(\"enable\");this.$(\".picker.services .action select\").select2(\"enable\");this.$(\"select#trigger\").select2(\"enable\");return this.$(\"select#action\").select2(\"enable\")}},showActionCard:function(e){var _this=this;clearTimeout(this.actionCardTimeout);return this.actionCardTimeout=_.delay(function(){var actions,key,view;key=$(e.currentTarget).find(\"t[data-id]\").attr(\"data-id\");if(!(key!=null))return;actions=z.app.services.get(key).getActions(\"write\");view=JST.editor_action_card({action:actions,which:\"Action\"});return _this.actionCard=new z.ui.Modal({\"class\":\"action-card\",view:view,target:$(e.currentTarget),x:-260,y:0,noX:true,noLayer:true})},750)},showTriggerCard:function(e){var _this=this;clearTimeout(this.triggerCardTimeout);return this.triggerCardTimeout=_.delay(function(){var key,triggers,view;key=$(e.currentTarget).find(\"t[data-id]\").attr(\"data-id\");if(!(key!=null))return;triggers=z.app.services.get(key).getActions(\"read\");view=JST.editor_action_card({action:triggers,which:\"Trigger\"});return _this.actionCard=new z.ui.Modal({\"class\":\"action-card\",view:view,target:$(e.currentTarget),x:90,y:0,noX:true,noLayer:true})},750)},hideCards:function(){var _ref,_ref2;clearTimeout(this.actionCardTimeout);clearTimeout(this.triggerCardTimeout);if((_ref=this.triggerCard)!=null)_ref.close();return(_ref2=this.actionCard)!=null?_ref2.close():void 0},buildServiceMatchIndex:function(){var _this=this;this.serviceIndex={};return z.app.services.each(function(service){var actions,categories,index,triggers;index=\"\";triggers=service.getActions(\"read\");actions=service.getActions(\"write\");categories=service.getCategories();_.each(triggers,function(trigger){return index+=service.getActionName(trigger.key,\"read\",\"true\")+\" \"});_.each(actions,function(action){return index+=service.getActionName(action.key,\"write\",\"true\")+\" \"});_.each(categories,function(category){return index+=category+\" \"});index+=service.getName().replace(\" \",\"\")+\" \";index=_.str.clean(index.toLowerCase());return _this.serviceIndex[service.getName()]=index})},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,key,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);key=service.get(\"key\");icon=service.getImageClass(\"32x32\");name=service.getName();key=_.escape(key);name=_.escape(name);icon=_.escape(icon);html='<i class=\"img32 '+icon+'\"></i> <t data-id=\"'+key+'\">'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},actionFormatSelection:function(service,row){var help,html,icon;if(!row.id)return row.text;help=$(row.element).attr(\"data-help\");icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;row.text=_.escape(row.text);html=\"<t>\"+row.text+\"</t>\";return html},actionFormatResult:function(service,row){var help,html,icon;if(!row.id)return row.text;if(row.id===\"showAll\"){return'<span class=\"showAll\">'+row.text+\"</span>\"}help=$(row.element).attr(\"data-help\");icon=service!=null?typeof service.getImageClass===\"function\"?service.getImageClass(\"32x32\"):void 0:void 0;row.text=_.escape(row.text);html=\"<t>\"+row.text+\"</t> <span>\"+help+\"</span>\";return html},matcherService:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=this.serviceIndex[haystack].toLowerCase();return _.str.include(haystack,needle)},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},changeService:function(e){var $el,data,model,val,which,_this=this;$el=this.$(e.currentTarget);this.hideCards();val=$el.val();which=_.str.include($el.attr(\"id\"),\"trigger\")?\"showTriggerAll\":\"showActionAll\";data={};data[which]=false;this.state.set(data);model=_.str.include($el.attr(\"id\"),\"trigger\")?this.options.read:this.options.write;which=_.str.include($el.attr(\"id\"),\"trigger\")?\"trigger\":\"action\";this.setMode(\"is\",\"saving\");return model.save({selected_api:val,action:null},{wait:true,complete:function(){return _this.setMode(\"not\",\"saving\")}})},changeAction:function(e){var $el,data,model,val,which,_this=this;$el=this.$(e.currentTarget);val=$el.val();if(val===\"showAll\"){which=_.str.include($el.attr(\"id\"),\"trigger\")?\"showTriggerAll\":\"showActionAll\";data={};data[which]=true;this.state.set(data);this.render();which=_.str.include($el.attr(\"id\"),\"trigger\")?\"trigger\":\"action\";return this.$(\"select#\"+which).select2(\"open\")}else{model=_.str.include($el.attr(\"id\"),\"trigger\")?this.options.read:this.options.write;this.setMode(\"is\",\"saving\");return model.save({action:val},{wait:true,complete:function(){return _this.setMode(\"not\",\"saving\")}})}},renderContinue:function(){var mode;mode=this.complete()?\"enable\":\"disable\";if(!this.hasMode(\"hide\",\"continue\"))return this.setMode(mode,\"continue\")},complete:function(){var action,bothSelected,parterService,partner,trigger,_ref;trigger=this.options.read.get(\"selected_api\")!=null&&this.options.read.get(\"action\")!=null;action=this.options.write.get(\"selected_api\")!=null&&this.options.write.get(\"action\")!=null;parterService=(_ref=z.app.partner.get(\"zap\"))!=null?_ref.selected_api:void 0;partner=parterService===this.options.read.get(\"selected_api\")||parterService===this.options.write.get(\"selected_api\");bothSelected=this.options.read.get(\"selected_api\")!=null&&this.options.write.get(\"selected_api\")!=null;if(parterService!=null&&!partner&&bothSelected){this.$(\".partner-feedback\").removeClass(\"hide\")}else{this.$(\".partner-feedback\").removeClass(\"hide\").addClass(\"hide\")}return trigger&&action&&(partner||!(parterService!=null))},\"continue\":function(e){if(e!=null)e.preventDefault();if(this.hasMode(\"disable\",\"continue\"))return;z.app.editor.next(this);return this.setMode(\"hide\",\"continue\")}});z.ui.EnableStep=z.ui.Base.extend({className:\"enable\",events:{\"click .enable\":\"enable\",\"click input.title\":\"highlight\",\"change .title\":\"updateModel\"},initialize:function(options){var render;this.options=options;_.bindAll(this);this.read=this.options.read;this.write=this.options.write;this.readNeeds=this.options.readNeeds;this.writeNeeds=this.options.writeNeeds;render=_.debounce(this.render,40);this.read.on(\"change:selected_api change:action change:params change:paused change:errors\",render,this);this.write.on(\"change:selected_api change:action change:params change:errors\",render,this);this.readNeeds.on(\"change\",render,this);return this.writeNeeds.on(\"change\",render,this)},context:function(){var context,plan,polling,readService,writeService;readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));if(z.app.account.get(\"plan_id\")!=null){plan=z.app.plans.get(z.app.account.get(\"plan_id\"))}else{plan=z.app.plans.getTrialPlan()}polling=z.app.accountLimits.get(\"polling_interval\");context={flow:this.options.flow,errors:this.read.get(\"errors\").concat(this.write.get(\"errors\")),plan:plan,polling:polling,read:this.read.toJSON(),write:this.write.toJSON(),isHook:readService!=null?readService.isHook(this.read.get(\"action\"),\"read\",false):void 0,title:this.read.getTitle(true),readService:readService,writeService:writeService,ov:z.cfg.userfillOTag,cv:z.cfg.userfillETag};return context},render:function(){var context;context=this.context();this.$el.html(JST.editor_enable(context));z.useful.placeholders(this.$el);return this},updateModel:function(e){var title;if(e!=null)e.preventDefault();title=this.$(e.currentTarget).val();return this.read.save({title:title})},enable:function(e){var t,_this=this;if(e!=null)e.preventDefault();if(this.hasMode(\"is\",\"disabled\"))return;this.setMode(\"is\",\"disabled\");this.$button=this.$(e.currentTarget);this.$button.text(\"Working...\");this.i=0;t=500;this.read.fetch({cache:false});return _.delay(function(){return _this.checkTimer=setInterval(function(){return _this.unpauseAjaxCheck()},500)},20)},unpauseAjaxCheck:function(){this.i+=1;if($.active===0)this.unpauseErrorCheck();if(this.i>20)return clearInterval(this.checkTimer)},unpauseErrorCheck:function(){var _this=this;return _.defer(function(){clearInterval(_this.checkTimer);if(!_this.read.hasErrors()){window.onbeforeunload=null;return _this.stripNonvisibleParams()}else{_this.setMode(\"not\",\"disabled\");return _this.$button.text(\"Make Zap Live\")}})},stripNonvisibleParams:function(){var stripped,_this=this;stripped={};z.app.writeNeeds.each(function(need){var key,_ref;key=need.get(\"key\");return stripped[key]=(_ref=z.app.write.get(\"params\"))!=null?_ref[key]:void 0});return z.app.write.save({params:stripped},{success:this.unpause,error:this.unpause})},unpause:function(){var error,success,_this=this;success=function(){var _ref;if(!((_ref=z.app.partner)!=null?_ref.isPartnerSession():void 0)){_this.shareZap()}Backbone.history.navigate(\"/app/dashboard\",{trigger:true});return _this.$button.text(\"Make Zap Live\")};error=function(model,xhr){var modal;_this.setMode(\"not\",\"disabled\");_this.$button.text(\"Make Zap Live\");if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})};return this.read.unpause({success:success,error:error})},shareZap:function(){var hasCookie,olderZap;hasCookie=z.store.get(this.read.id+\"-shared\")===\"yes\";olderZap=this.read.date&&(new Date).getTime()-this.read.date.getTime()>3*24*60*60*1e3;if(z.app.account.isFree()&&this.read.canShare()&&this.write.canShare()&&!hasCookie&&olderZap){this.shareZapModal=new z.ui.Modal({view:new z.ui.ShareZapModal({read:this.read,write:this.write})});return window.t=this.shareZapModal}},highlight:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).focus().select()}});z.ui.ActionStep=z.ui.Base.extend({className:\"actions\",events:{\"click .showall\":\"showall\",\"click li.action\":\"select\"},test:function(e){return e!=null?e.preventDefault():void 0},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.model=this.isTrigger?this.read:this.write;this.state.set(\"showall\",false);if(this.model.get(\"selected_api\")!=null)this.setActions();if(this.model.get(\"selected_api\")!=null&&this.model.get(\"action\")!=null){this.setShowall()}this.model.on(\"change:selected_api\",function(){return _this.state.set(\"showall\",false)},this);this.model.on(\"change:selected_api\",this.render,this);this.model.on(\"change:action\",this.render,this);this.state.on(\"change:showall\",this.render,this);return this.model.on(\"change:action\",function(){if(_this.get()!=null)return z.app.editor.next(_this)},this)},get:function(){return this.model.get(\"action\")},set:function(action){return this.model.set(\"action\",action)},unset:function(){return this.model.set(\"action\",null)},context:function(){var context;context={anyAdvanced:this.anyAdvanced(),showall:this.state.get(\"showall\"),actions:this.actions,show:this.model.get(\"selected_api\")!=null};return context},render:function(){this.setActions();this.$el.html(JST.editor_action(this.context()));this.renderActions();return this},renderActions:function(){var _this=this;this.$(\"ul\").empty();return _.each(this.actions,function(action){var context;context=action;context.selected=context.key===_this.get();if(action.important||!_this.anyAdvanced()||_this.state.get(\"showall\")){return _this.$(\"ul\").append(JST.editor_action_row(context))}})},anyAdvanced:function(){var _this=this;return _.any(this.actions,function(action){return action.important===false})},setActions:function(){var service;service=z.app.services.get(this.model.get(\"selected_api\"));return this.actions=this.isTrigger?service!=null?service.getActions(\"read\"):void 0:service!=null?service.getActions(\"write\"):void 0},setShowall:function(){var selected,_this=this;selected=_.find(this.actions,function(action){return action.key===_this.get()});if((selected!=null?selected.important:void 0)===false){return this.state.set(\"showall\",true)}},showall:function(e){if(e!=null)e.preventDefault();return this.state.set(\"showall\",true)},select:function(e){var action;if(e!=null)e.preventDefault();action=this.$(e.currentTarget).attr(\"id\");if(this.get()!==action){return this.set(action)}else{return this.unset()}}});z.ui.Steps=z.ui.Base.extend({className:\"steps\",events:{\"click .unpause\":\"unpause\"},initialize:function(options){var _this=this;_.bindAll(this);_.defaults(this,options);this.cap=0;_.each(this.steps(),function(step,name){return _this.state.set(name,\"none_visible\")});this.read.on(\"change:selected_api change:action change:paused\",this.render,this);return this.write.on(\"change:selected_api change:action\",this.render,this)},steps:function(){return{\"services-actions\":{step:1,view:z.app.editor.views.servicesActions},\"trigger-auth\":{step:2,view:z.app.editor.views.triggerAuth},\"action-auth\":{step:3,view:z.app.editor.views.actionAuth},filters:{step:4,view:z.app.editor.views.filters},map:{step:5,view:z.app.editor.views.map},test:{step:6,view:z.app.editor.views.test},enable:{step:7,view:z.app.editor.views.enable}}},context:function(){var context,readService,writeService;context={read:this.read.toJSON(),write:this.write.toJSON(),flow:this.flow};readService=z.app.services.get(this.read.get(\"selected_api\"));writeService=z.app.services.get(this.write.get(\"selected_api\"));context.readAction=readService!=null?readService.getActionName(this.read.get(\"action\"),\"read\",\"true\"):void 0;context.writeAction=writeService!=null?writeService.getActionName(this.write.get(\"action\"),\"write\",\"true\"):void 0;context.hasErrors=this.read.hasErrors();_.extend(context,this.state.toJSON());return context},renderSteps:function(){var steps;steps=this.steps();steps[\"services-actions\"].view.render();steps[\"trigger-auth\"].view.render();steps[\"action-auth\"].view.render();steps[\"filters\"].view.render();steps[\"map\"].view.render();steps[\"test\"].view.render();return steps[\"enable\"].view.render()},render:function(){var steps,_this=this;_.each(this.steps(),function(step,name){return _this.$(\"[data-id=\"+name+\"] content\").detach()});this.$el.html(JST.editor_steps(this.context()));steps=this.steps();this.$(\"[data-id=services-actions] content\").html(steps[\"services-actions\"].view.$el);this.$(\"[data-id=trigger-auth] content\").html(steps[\"trigger-auth\"].view.$el);this.$(\"[data-id=action-auth] content\").html(steps[\"action-auth\"].view.$el);this.$(\"[data-id=filters] content\").html(steps[\"filters\"].view.$el);this.$(\"[data-id=map] content\").html(steps[\"map\"].view.$el);this.$(\"[data-id=test] content\").html(steps[\"test\"].view.$el);this.$(\"[data-id=enable] content\").html(steps[\"enable\"].view.$el);this.$(\".dial\").knob({max:this.$(\".dial\").length,readOnly:true,height:40,width:40,inputColor:\"#4d4d4d\",fgColor:\"#888888\",bgColor:\"#cccccc\"});return this},getPosition:function(step){var pos,_this=this;pos=0;_.each(this.steps(),function(eachStep,name){if(step===name)return pos=eachStep.step});return pos},showAllSteps:function(){var _this=this;return _.each(this.steps(),function(step,name){return _this.showAll(name)})},showNext:function(){var _this=this;return this.$(\"step.none_visible\").first().each(function(i,el){var options,step,view;step=$(el).attr(\"data-id\");view=_this.steps()[step].view;z.app.track[\"new\"](\"Editor Step: \"+step,{step:step,snap:z.app.read.id});_this.state.set(step,\"all_visible\");_this.setMode(\"all\",\"visible\",$(el));options={offset:{left:0,top:-25}};if(_this.getPosition(step)>0){_.defer(function(){if(z.app.partner.isPartnerSession()&&z.app.partner.hasIframeJs){return _.delay(function(){var event,target,_ref;target=(_ref=$(el).find(\".row\").eq(0).offset())!=null?_ref.top:void 0;event={event:\"scroll\",height:target};return typeof window!==\"undefined\"&&window!==null?window.top.postMessage(JSON.stringify(event),\"*\"):void 0},150)}else{return $.scrollTo($(el).find(\".row\").eq(0),200,options)}})}return view!=null?typeof view.show===\"function\"?view.show():void 0:void 0})},toggleStep:function(e){var step;if(e!=null)e.preventDefault();step=$(e.currentTarget).closest(\"step\").attr(\"data-id\");if(this.state.get(step)===\"all_visible\"){return this.showTitle(step)}else if(this.state.get(step)===\"title_visible\"){return this.showAll(step)}},showTitle:function(step){var $el;this.state.set(step,\"title_visible\");$el=this.$(\"[data-id=\"+step+\"]\");return this.setMode(\"title\",\"visible\",$el)},showAll:function(step){var $el;this.state.set(step,\"all_visible\");$el=this.$(\"[data-id=\"+step+\"]\");return this.setMode(\"all\",\"visible\",$el)},unpause:function(e){var error,success,_this=this;if(e!=null)e.preventDefault();success=function(){};error=function(model,xhr){var modal;if(xhr.status===426)return;error=z.useful.errors(xhr);return modal=new z.ui.Modal({view:new z.ui.UnpauseErrorModal({message:error})})};return this.read.unpause({success:success,error:error})}});z.ui.SharedZaps=z.ui.Base.extend({embeddedZaps:[],events:{\"click input.add-to-embed\":\"toggleOnEmbed\",\"click .page-nav .previous\":\"previous\",\"click .page-nav .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.on(\"add remove reset change\",this.render,this);this.recipes.on(\"fetch\",this.startFetching,this);this.recipes.on(\"add remove reset change\",this.doneFetching,this);return this.embed=options.embed},previous:function(e){if(e!=null)e.preventDefault();return this.recipes.serverPrev()},next:function(e){if(e!=null)e.preventDefault();return this.recipes.serverNext()},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());return this.recipes.serverPage(page)},routingKey:function(checkbox){if(checkbox.prop(\"checked\"))return\"embed.template.add\";return\"embed.template.remove\"},toggleOnEmbed:function(e){var $checkbox;$checkbox=$(e.currentTarget);return z.cfg.pubSub.trigger(this.routingKey($checkbox),{zap_id:$checkbox.val()})},context:function(){var context;context={recipes:this.recipes,pagination:this.recipes.pagination.toJSON()};return context},render:function(){this.$el.html(JST.explore_results(this.context()));this.$zaps=this.$(\".zaps\");this.renderSharedRecipes();return this},renderSharedRecipes:function(){var html,_this=this;html=\"\";this.recipes.each(function(recipe){return html+=JST.share_recipe(recipe.toJSON())});if(html===\"\"){html='<div class=\"empty\">No Zaps shared! Try sharing a few services.</div>'}return this.$zaps.html(html)}});z.ui.EmbededZaps=z.ui.Base.extend({SHARABLE_SCRIPT:'<script type=\"text/javascript\" src=\"{{base_url}}/zapbook/embed/widget.js?zaps={{zaps}}\"></script>',embeddedZaps:[],events:{},initialize:function(options){var render,_ref;_.bindAll(this);_.defaults(this,options);render=_.debounce(this.render,40);_ref=[false,false],this.animating=_ref[0],this.fetching=_ref[1];this.embed=options.embed;this.embed.on(\"changed fetch sync\",render,this);this.embed.on(\"fetch\",this.startFetching,this);this.embed.on(\"add remove reset change\",this.doneFetching,this);this.embeddedZaps=[];z.cfg.pubSub.on(\"embed.template.add\",this.addZap,this);return z.cfg.pubSub.on(\"embed.template.remove\",this.removeZap,this)},addZap:function(params){this.embeddedZaps.push(params.zap_id);return this.fetchView()},removeZap:function(params){this.embeddedZaps=_.reject(this.embeddedZaps,function(id){return id===params.zap_id});return this.fetchView()},toTop:function(){var _this=this;this.animating=true;return $(\"html, body\").animate({scrollTop:0},200,function(){return setTimeout(function(){_this.animating=false;return _this.doneAnimating()},200)})},doneAnimating:function(){if(!this.animating&&!this.fetching)return this.$el.removeClass(\"loading\")},startFetching:function(){this.fetching=true;return this.$el.addClass(\"loading\")},doneFetching:function(){this.fetching=false;return this.doneAnimating()},fetchView:function(){this.embed.fetch({data:{zaps:this.embeddedZaps.join(\",\")}},{processData:true});return this.toTop()},render:function(){var context;this.$el.html(JST.share_embed({}));this.$sharer=this.$(\".sharer\");this.$sharer.append($(this.embed.get(\"html\")));context={base_url:window.location.origin,zaps:this.embeddedZaps.join(\",\")};this.$el.find(\".share-this\").val(_.template(this.SHARABLE_SCRIPT,context));this.$el.find(\".share-this\").on(\"click\",function(){return this.select()});return this}});z.ui.HistoryNav=z.ui.Base.extend({initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={id:this.options.id};return context},render:function(){var context;context=this.context();this.$el.html(JST.history_nav(context));return this}});z.ui.HistoryDetails=z.ui.Base.extend({events:{\"click .replay\":\"replay\",\"click .target:not(.container)\":\"toggle\",\"click .toggle-details\":\"toggle\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var changed,context,json,ra,read,rs,rsn,title,wa,write,ws,wsn,_this=this;json=this.options.streamItem.toJSON();json.children=this.options.streamItem.buildChildren();if(json.children!=null){json.children=_.map(json.children,function(child){child.dataDetails=_this.getDataDetails(child.type);return child})}context=json;if(json.type===\"write\"){write=z.app.writes.get(json.object_id);read=z.app.reads.filter(function(read){return read.get(\"write_ids\")[0]===(write!=null?write.id:void 0)});read=read[0]}else{read=z.app.reads.get(json.object_id);write=z.app.writes.get(read.get(\"write_ids\")[0])}changed=false;if(read!=null&&read.get(\"selected_api\")!==json.data.read_selected_api){changed=true;read=null}if(write!=null&&write.get(\"selected_api\")!==json.data.write_selected_api){changed=true;write=null}if(!(read!=null)){read=new z.model.Read({selected_api:json.data.read_selected_api,action:json.data.read_action,params:json.data.read_params})}if(!(write!=null)){write=new z.model.Write({selected_api:json.data.write_selected_api,action:json.data.write_action,params:json.data.write_params})}context.read=read.toJSON();context.write=write.toJSON();title=read.getTitle();rs=z.app.services.get(read.get(\"selected_api\"));ws=z.app.services.get(write.get(\"selected_api\"));rsn=(rs!=null?rs.getName():void 0)||read.get(\"selected_api\");ra=(rs!=null?rs.getActionName(read.get(\"action\"),\"read\",\"true\"):void 0)||read.get(\"action\");wsn=(ws!=null?ws.getName():void 0)||write.get(\"selected_api\");wa=(ws!=null?ws.getActionName(write.get(\"action\"),\"write\",\"true\"):void 0)||write.get(\"action\");if(!(title!=null)){title=\"\"+rsn+\" \"+ra+\" to \"+wsn+\" \"+wa;if(changed){title+=\" (Zap services changed)\"}else{title+=\" (Zap deleted)\"}}context.title=title;context.state=this.state.toJSON();\nreturn context},render:function(){var context;context=this.context();this.$el.html(JST.history_details(context));return this},toggle:function(e){var detail,el,target;if(e!=null)e.preventDefault();detail=this.$(e.currentTarget).parent();if(this.$(e.currentTarget).hasClass(\"toggle-details\")){target=this.$(e.currentTarget).next(\".target\")}else{target=this.$(e.currentTarget)}if(detail.find('[class*=\"fa-caret-\"]').hasClass(\"fa-caret-right\")){el=target.find(\".fa-caret-right\");el.removeClass(\"fa-caret-right\").addClass(\"fa-caret-down\");el=target.siblings(\".details\");el.removeClass(\"hide\");return detail.find(\".toggle-details\").text(\"Hide detail\")}else{el=target.find(\".fa-caret-down\");el.removeClass(\"fa-caret-down\").addClass(\"fa-caret-right\");el=target.siblings(\".details\");el.addClass(\"hide\");return detail.find(\".toggle-details\").text(\"Show detail\")}},getDataDetails:function(type){var action,data,event,fields,i,name,read,service,status,stream,title,unreplaced,write,zapHtml,_ref,_ref2;stream=(_ref=z.app.streamItem)!=null?_ref.toJSON():void 0;if(!(stream!=null))return{};if(stream.type===\"write\"){write=z.app.writes.get(stream.legacy_object_id||stream.object_id);read=z.app.reads.filter(function(read){return read.get(\"write_ids\")[0]===(write!=null?write.id:void 0)});read=read[0]}else{read=z.app.reads.get(stream.legacy_object_id||stream.object_id);write=z.app.writes.get(read.get(\"write_ids\")[0])}if(!(read!=null)){read=new z.model.Read({selected_api:stream.data.read_selected_api,action:stream.data.read_action,params:stream.data.read_params})}if(!(write!=null)){write=new z.model.Write({selected_api:stream.data.write_selected_api,action:stream.data.write_action,params:stream.data.write_params})}title=read.getTitle();if(title!=null){zapHtml='<a target=\"_new\" href=\"/app/editor/'+read.id+'\">'+title+'</a> <i class=\"fa fa-external-link\"></i>'}else{zapHtml=\"(Zap no longer exists, it was deleted)\"}zapHtml=new Handlebars.SafeString(zapHtml);if(type===\"manual\"){data={Event:\"This Zap was manually ran from the Zapier dashboard.\",Date:z.useful.prettyISO(stream.date)}}if(type===\"trigger_summary\"){status=((_ref2=_.keys(stream.data.write_raw_data))!=null?_ref2.length:void 0)>0?\"success\":\"error\";service=z.app.services.get(stream.data.read_selected_api);name=(service!=null?service.getName():void 0)||stream.data.read_selected_api;action=(service!=null?service.getActionName(stream.data.read_action,\"read\",\"true\"):void 0)||stream.data.read_action;if(status===\"success\")event=\"Found 1 new \"+action+\" from \"+name;if(status===\"error\")event=\"Error getting \"+action+\" from \"+name;data={Zap:zapHtml,Event:event,Date:z.useful.prettyISO(stream.date),Status:_.superHumanize(stream.data.status)};if(stream.data.message!=null&&status===\"error\"){data[\"Details\"]=stream.data.message}i=0;_.each(stream.data.write_raw_data,function(v,k){i+=1;if(!(v!=null)||v===\"\")v=\"<empty>\";return data[k]=v});if(i===0){data[\"Warning\"]=\"No data was sent to Zapier for this Trigger.\"}}if(type===\"action_summary\"){service=z.app.services.get(stream.data.write_selected_api);name=(service!=null?service.getName():void 0)||stream.data.write_selected_api;action=(service!=null?service.getActionName(stream.data.write_action,\"write\",\"true\"):void 0)||stream.data.write_action;if(stream.data.status===\"success\"){event=\"Sent 1 \"+action+\" to \"+name}if(stream.data.status===\"halted\"){event=\"Advanced Filters halted 1 \"+action}if(stream.data.status===\"error\"){event=\"Tried to send 1 \"+action+\" to \"+name}data={Zap:zapHtml,Event:event,Date:z.useful.prettyISO(stream.date),Status:_.superHumanize(stream.data.status)};if(stream.data.message!=null&&stream.data.status===\"error\"){data[\"Details\"]=stream.data.message}i=0;_.each(stream.data.write_replaced_data,function(v,k){i+=1;if(!(v!=null)||v===\"\")v=\"<empty>\";return data[k]=v});if(i===0){data[\"Warning\"]=\"There was no data (after replacing template variables) to send for this Action.\"}unreplaced=[];_.each(stream.data.write_params,function(v,k){if(!(stream.data.write_replaced_data[k]!=null)){return unreplaced.push(k)}});if(unreplaced.length>0){fields=unreplaced.join(\", \");data[\"Warning\"]=\"Some expected template variables did not exist in the Trigger data. The following fields were sent to \"+name+\" empty: \"+fields+\".\"}}return data},replay:function(e){var $el,account,data,id,modal,options,paid,raw,replaced,sample,view,write,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_this=this;if(e!=null)e.preventDefault();account=z.app.account.toJSON();paid=(account!=null?(_ref=account.billing)!=null?(_ref2=_ref.subscription)!=null?(_ref3=_ref2.plan)!=null?_ref3.amount:void 0:void 0:void 0:void 0)>0;z.app.track[\"new\"](\"Replay Action\",{paid:paid});if(!(account.is_trialing||account.is_staff||paid||account.provider)){view=new z.ui.UpgradeModal({errors:[\"Replaying old tasks requires a paid plan.\"]});modal=new z.ui.Modal({view:view});return false}$el=this.$(e.currentTarget);id=$el.closest(\".container\").attr(\"data-id\");sample=z.app.streamItem;replaced=(_ref4=sample.toJSON())!=null?(_ref5=_ref4.data)!=null?_ref5.write_replaced_data:void 0:void 0;raw=(_ref6=sample.toJSON())!=null?(_ref7=_ref6.data)!=null?_ref7.write_raw_data:void 0:void 0;data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={step:sample.id,success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");$el.removeClass(\"working\");data=sample.get(\"data\");data[\"status\"]=\"success\";return sample.save({data:data},{wait:true})},error:function(model,xhr){var context,html,service,_ref10,_ref8,_ref9;clearInterval(_this.loadingTimer);service=(_ref8=z.app.services.get((_ref9=sample.get(\"data\"))!=null?_ref9.write_selected_api:void 0))!=null?_ref8.getName():void 0;$el.html(\"Error!\");$el.removeClass(\"working\");context={key:(_ref10=sample.get(\"data\"))!=null?_ref10.write_selected_api:void 0,message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};write=new z.model.Write({id:sample.get(\"object_id\")});write.write((_ref8=sample.get(\"data\"))!=null?_ref8.write_action:void 0,data,options);return false}});z.ui.SendCSVModal=z.ui.Base.extend({className:\"send-csv-modal\",events:{\"click .send\":\"send\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,_ref,_ref2,_ref3,_ref4;context={};context.filters=z.app.stream.filters.toJSON();if((_ref=context.filters)!=null?_ref.write_id:void 0){context.zap=(_ref2=z.app.reads)!=null?_ref2.find(function(read){return _.indexOf(read.get(\"write_ids\"),parseInt(context.filters.write_id))!==-1}):void 0;context.zapName=(_ref3=context.zap)!=null?_ref3.getTitle():void 0}context.status=(_ref4=context.filters)!=null?_ref4.status:void 0;return context},render:function(){this.$el.html(JST.history_send_csv(this.context()));return this},send:function(options){var _this=this;if(options==null)options={};return $.ajax({url:z.cfg.api+\"/stream/send\",type:\"POST\",data:JSON.stringify(z.app.stream.filters.toJSON()),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.$el.find(\"button.submit\").hide();_this.$el.find(\".feedback\").html(\"<em>Success! Check your email in a few moments!</em>\");setTimeout(function(){return _this.modal.close()},5e3);return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0}})}});z.ui.History=z.ui.Base.extend({events:{\"click .replay\":\"replay\",\"click .page-nav .previous\":\"previous\",\"click .page-nav .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){this.options=options;_.bindAll(this);return z.app.stream.on(\"add remove reset\",this.render,this)},context:function(){var context;context={pagination:z.app.stream.pagination.toJSON(),isPartner:z.app.partner.isPartnerSession()};return context},render:function(){var empty,_this=this;this.$el.html(JST.history_table(this.context()));this.$table=this.$(\"table\");empty=_.once(function(){return _this.$table.empty()});z.app.stream.each(function(item){var context,_ref;empty();context=item.toJSON();if(((_ref=context.timesince)!=null?_ref.length:void 0)<4&&_.str.endsWith(context.timesince,\"m\")){context.date=context.timesince+\" ago\"}else{context.date=z.useful.prettyISO(context.date)}if(context)return _this.$table.append(JST.history_row(context))});this.$el.append(JST.history_pagination(this.context()));return this},previous:function(e){if(e!=null)e.preventDefault();z.app.stream.serverPrev();return $.scrollTo($(\"#app\"),200)},next:function(e){if(e!=null)e.preventDefault();z.app.stream.serverNext();return $.scrollTo($(\"#app\"),200)},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());return z.app.stream.serverPage(page)},replay:function(e){var $el,account,data,id,modal,options,paid,raw,replaced,sample,view,write,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;if(e!=null)e.preventDefault();if(e!=null)e.stopPropagation();account=z.app.account.toJSON();paid=(account!=null?(_ref=account.billing)!=null?(_ref2=_ref.subscription)!=null?(_ref3=_ref2.plan)!=null?_ref3.amount:void 0:void 0:void 0:void 0)>0;z.app.track[\"new\"](\"Replay Action\",{paid:paid});if(!(account.is_trialing||account.is_staff||paid||z.app.partner.isPartnerSession())){view=new z.ui.UpgradeModal({errors:[\"Replaying old tasks requires any paid plan.\"]});modal=new z.ui.Modal({view:view});return false}$el=this.$(e.currentTarget);id=$el.closest(\".history\").attr(\"data-id\");sample=z.app.stream.get(id);replaced=sample!=null?(_ref4=sample.toJSON().data)!=null?_ref4.write_replaced_data:void 0:void 0;raw=sample!=null?(_ref5=sample.toJSON().data)!=null?_ref5.write_raw_data:void 0:void 0;data={replaced:replaced,raw:raw};if(data.raw.zap_meta_filter!=null)delete data.raw.zap_meta_filter;$el.text(\"Sending...\");this.loadingTimer=_.delay(function(){return $el.text(\"Still Sending...\")},3e3);options={step:sample.id,success:function(xhr){clearInterval(_this.loadingTimer);$el.html(\"&#10003; Success!\");$el.removeClass(\"working\");data=sample.get(\"data\");data[\"status\"]=\"success\";return sample.save({data:data},{wait:true})},error:function(model,xhr){var context,html,service,_ref6,_ref7,_ref8;clearInterval(_this.loadingTimer);service=(_ref6=z.app.services.get((_ref7=sample.get(\"data\"))!=null?_ref7.write_selected_api:void 0))!=null?_ref6.getName():void 0;$el.html(\"Error!\");$el.removeClass(\"working\");context={key:(_ref8=sample.get(\"data\"))!=null?_ref8.write_selected_api:void 0,message:z.useful.errors(xhr)};html=JST.editor_api_error_modal(context);return modal=new z.ui.Modal({view:html})}};write=new z.model.Write({id:sample.get(\"object_id\")});write.write((_ref6=sample.get(\"data\"))!=null?_ref6.write_action:void 0,data,options);return false}});z.ui.SendCSVModal=z.ui.Base.extend({events:{\"click .send\":\"send\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context,_ref,_ref2,_ref3,_ref4;context={};context.filters=z.app.stream.filters.toJSON();if((_ref=context.filters)!=null?_ref.write_id:void 0){context.zap=(_ref2=z.app.reads)!=null?_ref2.find(function(read){return _.indexOf(read.get(\"write_ids\"),parseInt(context.filters.write_id))!==-1}):void 0;context.zapName=(_ref3=context.zap)!=null?_ref3.getTitle():void 0}context.status=(_ref4=context.filters)!=null?_ref4.status:void 0;return context},render:function(){this.$el.html(JST.history_send_csv(this.context()));return this},send:function(options){var _this=this;if(options==null)options={};return $.ajax({url:z.cfg.api+\"/stream/send\",type:\"POST\",data:JSON.stringify(z.app.stream.filters.toJSON()),dataType:\"json\",contentType:\"application/json\",success:function(){var _ref;_this.$el.find(\".bottom\").html(\"<em>Success! Check your email in a few moments!</em>\");setTimeout(function(){return _this.modal.close()},5e3);return options!=null?(_ref=options.success)!=null?_ref.apply(_this,arguments):void 0:void 0}})}});z.ui.HistoryFilters=z.ui.Base.extend({events:{\"click .send-csv\":\"sendCSV\",\"click .refresh\":\"refresh\"},initialize:function(options){var fields,_this=this;this.options=options;_.bindAll(this);this.refresh=_.throttle(this._refresh,1e3);z.app.stream.filters.on(\"change\",this.updateCookie,this);z.app.stream.on(\"add remove reset\",this.updateCookie,this);fields=[{key:\"write_id\",type:\"select\",hideLabel:true,hideRawValue:true,choices:this.generateChoices(),value:z.app.stream.filters.toJSON().write_id||\"0\"},{key:\"status\",type:\"select\",hideLabel:true,hideRawValue:true,choices:{0:\"All Statuses\",success:\"Successful Only\",error:\"Errors Only\",halted:\"Filtered Only\"},value:z.app.stream.filters.toJSON().status||\"0\"}];this.form=new z.model.FormSet(fields);this.paramform=new z.ui.ParamForm({form:this.form});_.each(this.form.models,function(row){if(row.options.type===\"select\"){return row.on(\"change\",_this.filter,row)}});return this.updateCookie()},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.history_filters(this.context()));this.$(\"paramform\").replaceWith(this.paramform.render().el);return this},generateChoices:function(){var choices;choices={0:\"All zaps\"};_.each(this.getZaps(),function(zap,index,list){return choices[zap.write.id]=zap.title+\" (#\"+zap.read.id+\")\"});return choices},toggle:function(e){if(e!=null)e.preventDefault();return this.$(e.currentTarget).toggleClass(\"selected\")},filter:function(row){var key,url,value,_this=this;key=row.options.key;value=row.get(\"value\");url=\"/app/history\";_.each(this.form.models,function(formRow){var thisKey,thisValue;thisKey=formRow.options.key;thisValue=formRow.get(\"value\");if(thisKey===\"write_id\"){return url+=\"?\"+thisKey+\"=\"+thisValue}else{return url+=\"&\"+thisKey+\"=\"+thisValue}});Backbone.history.navigate(url);if(value===\"0\")value=\"\";return z.app.stream.filters.set(key,value)},getZaps:function(){var zaps,_this=this;zaps=[];z.app.reads.each(function(read){var title,write;write=z.app.writes.get(read.get(\"write_ids\")[0]);title=read.getTitle();if(title!=null&&read!=null&&write!=null){return zaps.push({read:read.toJSON(),write:write.toJSON(),title:title})}});return zaps},_refresh:function(e){var done,oldHTML,_this=this;if(e!=null)e.preventDefault();oldHTML=this.$(e.currentTarget).html();this.$(e.currentTarget).text(\"Refreshing...\");done=function(){return _.delay(function(){return _this.$(e.currentTarget).html(oldHTML)},500)};return z.app.stream.fetch({cache:false,success:done,error:done})},sendCSV:function(e){return this.sendCSVModal=new z.ui.Modal({view:new z.ui.SendCSVModal({yes:null})})},updateCookie:function(){var cookie,date,write_id,_this=this;cookie=z.store.get(\"logs-seen\");cookie=cookie!=null?cookie:{};date=(new Date).toISOString();write_id=z.app.stream.filters.get(\"write_id\");if(write_id!=null)cookie[write_id]=date;z.app.stream.each(function(item){return cookie[item.get(\"legacy_object_id\")||item.get(\"object_id\")]=date});return z.store.set(\"logs-seen\",cookie)}});z.ui.ExploreSearch=z.ui.Base.extend({events:{\"click select#involve-service\":\"addServiceFilter\",\"click [data-remove-involve-service]\":\"removeServiceFilter\",\"change select[data-filter]\":\"filterUpdate\",\"click [data-clear-filter]\":\"clearFilter\",\"click .do-clear\":\"clearAllFilters\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.filters.on(\"change reset\",this.render,this);return this.buildServiceMatchIndex()},context:function(){var context,_this=this;this.services=z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;return true});this.involvedServices=_.map(this.recipes.getServicesFilter(),function(value){if(_.str.include(value,\"API\")){return z.app.services.where({key:value})[0]}else{return z.app.services.where({slug:value})[0]}});context={services:this.services,involvedServices:this.involvedServices,filters:this.recipes.filters.toJSON(),anyFilters:_.any(_.values(this.recipes.filters.toJSON())),directLink:\"/app/explore?services=\"+this.recipes.filters.get(\"services\")};return context},addServiceFilter:function(e){var current,filterList,key;if(e!=null)e.preventDefault();key=z.app.services.get($(e.currentTarget).val()).get(\"slug\");current=this.recipes.getServicesFilter();if(!_.contains(current,key)){filterList=current.concat([key]);return this.recipes.applyServicesFilter(filterList)}},removeServiceFilter:function(e){var filterList,key;if(e!=null)e.preventDefault();filterList=this.recipes.getServicesFilter();key=$(e.currentTarget).attr(\"data-remove-involve-service\");return this.recipes.applyServicesFilter(_.without(filterList,key))},filterUpdate:function(e){var key,value;if(e!=null)e.preventDefault();key=$(e.currentTarget).attr(\"data-filter\");value=$(e.currentTarget).val();return this.recipes.filters.set(key,value)},clearFilter:function(e){var key,keys;if(e!=null)e.preventDefault();keys=$(e.currentTarget).attr(\"data-clear-filter\");return this.recipes.filters.set(_.object(function(){var _i,_len,_ref,_results;_ref=keys.split(\" \");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){key=_ref[_i];_results.push([key,null])}return _results}()))},clearAllFilters:function(e){if(e!=null)e.preventDefault();return this.recipes.clearFilters()},render:function(){var context;context=this.context();this.$el.html(JST.explore_search(context));this.$(\"#single-service\").val(this.recipes.filters.get(\"services\"));this.$(\"#trigger-service\").val(this.recipes.filters.get(\"read_service\"));this.$(\"#action-service\").val(this.recipes.filters.get(\"write_service\"));this.$(\".services select\").select2({containerCssClass:\"select2-explore-service larger\",dropdownCssClass:\"select2-explore-service wide left\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcher});return this},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,key,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);key=service.get(\"key\");icon=service.getImageClass(\"32x32\");name=service.getName();icon=_.escape(icon);key=_.escape(key);name=_.escape(name);html='<i class=\"img32 '+icon+'\"></i> <t data-id=\"'+key+'\">'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=this.serviceIndex[haystack].toLowerCase();return _.str.include(haystack,needle)},buildServiceMatchIndex:function(){var _this=this;this.serviceIndex={};return z.app.services.each(function(service){var actions,categories,index,triggers;index=\"\";triggers=service.getActions(\"read\");actions=service.getActions(\"write\");categories=service.getCategories();_.each(triggers,function(trigger){return index+=service.getActionName(trigger.key,\"read\",\"true\")+\" \"});_.each(actions,function(action){return index+=service.getActionName(action.key,\"write\",\"true\")+\" \"});_.each(categories,function(category){return index+=category+\" \"});index+=service.getName()+\" \";index=_.str.clean(index.toLowerCase());return _this.serviceIndex[service.getName()]=index})}});z.ui.ExploreResults=z.ui.Base.extend({events:{\"click .use-this\":\"useRecipe\",\"click .previous\":\"previous\",\"click .next\":\"next\",\"change select.page\":\"setPage\"},initialize:function(options){var _ref;_.bindAll(this);_.defaults(this,options);this.recipes=options.recipes;this.recipes.on(\"add remove reset change\",this.render,this);_ref=[false,false],this.animating=_ref[0],this.fetching=_ref[1];this.recipes.on(\"fetch\",this.startFetching,this);return this.recipes.on(\"add remove reset change\",this.doneFetching,this)},toTop:function(){var _this=this;this.animating=true;return $(\"html, body\").animate({scrollTop:0},200,function(){return setTimeout(function(){_this.animating=false;return _this.doneAnimating()},200)})},doneAnimating:function(){if(!this.animating&&!this.fetching)return this.$el.removeClass(\"loading\")},startFetching:function(){this.fetching=true;return this.$el.addClass(\"loading\")},doneFetching:function(){this.fetching=false;return this.doneAnimating()},previous:function(e){if(e!=null)e.preventDefault();this.recipes.serverPrev();return this.toTop()},next:function(e){if(e!=null)e.preventDefault();this.recipes.serverNext();return this.toTop()},setPage:function(e){var page;if(e!=null)e.preventDefault();page=Number($(e.currentTarget).val());this.recipes.serverPage(page);return this.toTop()},useRecipe:function(e){var qs,recipe,_ref,_ref2,_ref3,_ref4;if(e!=null)e.preventDefault();$(e.currentTarget).attr(\"disabled\",true);$(e.currentTarget).addClass(\"disabled\");$(e.currentTarget).html('<div class=\"spinning-star\"></div>');recipe=this.recipes.get($(e.currentTarget).attr(\"data-id\"));if(z.app.account.isLoggedIn()){return recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{qs={};if(recipe.get(\"generated\")){qs={read_service:(_ref=recipe.get(\"read_data\"))!=null?_ref.selected_api:void 0,read_action:(_ref2=recipe.get(\"read_data\"))!=null?_ref2.action:void 0,write_service:(_ref3=recipe.get(\"write_data\"))!=null?_ref3.selected_api:void 0,write_action:(_ref4=recipe.get(\"write_data\"))!=null?_ref4.action:void 0}}else{qs={recipe_id:recipe.id}}return z.useful.goto(\"/app/signup?\"+$.param(_.compactObject(qs)))}},context:function(){var context;context={recipes:this.recipes,pagination:this.recipes.pagination.toJSON()};return context},render:function(){var html,_this=this;this.$el.html(JST.explore_results(this.context()));this.$container=this.$(\".zaps\");html=\"\";this.recipes.each(function(recipe){return html+=JST.explore_recipe(recipe.toJSON())});if(html===\"\"){html='<div class=\"empty\">No Zaps to show! Try choosing different services.</div>'}this.$container.html(html);return this}});z.ui.SignUpWhy=z.ui.Base.extend({events:{\"click .render\":\"render\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);this.querystring=options!=null?options.querystring:void 0;return this.recipe=options!=null?options.recipe:void 0},selectedPlan:function(){if(this.querystring.plan)return z.app.plans.get(this.querystring.plan);return null},readService:function(){if(this.recipe)return this.recipe.readService();return null},readAction:function(){var read_action,_ref,_ref2;read_action=(_ref=this.recipe)!=null?_ref.get(\"read_data\").action:void 0;if(read_action){return(_ref2=this.readService())!=null?_ref2.getActionMeta(read_action):void 0}return null},writeService:function(){if(this.recipe)return this.recipe.writeService();return null},writeAction:function(){var write_action,_ref,_ref2;write_action=(_ref=this.recipe)!=null?_ref.get(\"write_data\").action:void 0;if(write_action){return(_ref2=this.writeService())!=null?_ref2.getActionMeta(write_action,\"write\"):void 0}},context:function(){var context;context={selectedPlan:this.selectedPlan(),readService:this.readService(),readAction:this.readAction(),writeService:this.writeService(),writeAction:this.writeAction(),services:_.shuffle(z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0){return false}return true}))};return context},render:function(){var context;context=this.context();this.$el.html(JST.signup_why(context));return this}});z.ui.SignUpForm=z.ui.Base.extend({tagName:\"div\",className:\"form\",events:{\"click button.submit\":\"submitForm\"},initialize:function(options){_.bindAll(this);_.defaults(this,options);return this.recipe=options!=null?options.recipe:void 0},setFormError:function(error){this.$(\".errors span\").text(error);this.$(\".errors\").removeClass(\"hide\");return this.$(\"button\").attr(\"disabled\",false)},resetFormError:function(){this.$(\".errors\").addClass(\"hide\");return this.$(\"button\").attr(\"disabled\",true)},createAccount:function(cb){var _this=this;z.app.account.set(this.form.getValues(),{trigger:false});z.app.account.set({timezone:z.useful.getUserTimezone()},{trigger:false});return z.app.account.save({},{success:function(model,response,options){z.app.account.accountCreated();return typeof cb===\"function\"?cb():void 0},error:function(model,xhr,options){var response,_ref;response=JSON.parse(xhr.responseText);_this.setFormError((_ref=response.errors)!=null?_ref.join(\", \"):void 0);return typeof cb===\"function\"?cb():void 0}})},doRedirect:function(cb){var _ref,_this=this;if(z.app.account.isLoggedIn()){if(((_ref=this.querystring)!=null?_ref.next:void 0)!=null){return z.useful.goto(this.querystring.next)}else if(this.recipe){return this.recipe.startUsing({success:function(read,write){return Backbone.history.navigate(\"/app/editor/\"+read.id,{trigger:true})}})}else{return Backbone.history.navigate(\"/app/dashboard\",{trigger:true})}}},refreshChrome:function(cb){z.useful.refreshChrome();return typeof cb===\"function\"?cb():void 0},submitForm:function(){var _this=this;this.resetFormError();if(this.form.isValid()){return async.series([this.createAccount,this.refreshChrome,this.doRedirect],function(err,results){})}else{return this.setFormError(\"Please double-check the form is complete and valid.\")}},signUpFields:function(){return[{key:\"email\",label:\"Email\",placeholder:\"You'll use this to login...\",type:\"unicode\",required:true,validator:function(model,collection){var data,email;data=collection.getValues();email=data.email||\"\";return/\\S+@\\S+\\.\\S+/.test(email)}},{key:\"first_name\",label:\"First Name\",placeholder:\"What your mother calls you...\",type:\"unicode\",required:true},{key:\"last_name\",label:\"Last Name\",placeholder:\"What your army buddies call you...\",type:\"unicode\",required:true},{key:\"password1\",label:\"Password\",placeholder:\"Be sure to keep this private...\",type:\"password\",required:true},{key:\"terms\",label:\"Terms of Service\",type:\"checkbox\",required:true,help_text_html:'I agree to Zapier\\'s <a href=\"/terms\" target=\"_new\">Terms of Service</a>'},{key:\"updates\",label:\"Get Zapier Updates\",type:\"checkbox\",required:false,\"default\":true,help_text:\"Receive 1 weekly email about new services, triggers and actions available on Zapier.\"}]},render:function(){this.$el.html(JST.signup_form({}));this.form=new z.model.FormSet(this.signUpFields());this.signupform=new z.ui.ParamForm({form:this.form});this.$(\"signupform\").replaceWith(this.signupform.render().el);return this}});z.ui.PersonaFormModal=z.ui.Base.extend({className:\"persona-modal\",events:{submit:\"submitPersona\"},initialize:function(options){this.options=options;return _.bindAll(this)},context:function(){var context;context={};context.personas=z.useful.equalChunks(PERSONAS||[],2);context.first_personas=context.personas[0];context.second_personas=context.personas[1];return context},render:function(){this.$el.html(JST.signup_persona_modal(this.context()));return this},submitPersona:function(ev){var personas;if(ev!=null)ev.preventDefault();z.store.set(\"showPersonaModal\",null);personas=_.map($(\".persona-modal :checked\").get(),function(persona){return persona.value}).join(\",\");z.app.account.save({personas:personas});return this.modal.close()}});z.ui.ExtraSettings=z.ui.Base.extend({events:{\"click .advanced\":\"advanced\",\"click .close\":\"close\"},initialize:function(){return _.bindAll(this)},context:function(){var context;context={};return context},render:function(){this.$el.html(JST.settings_extra(this.context()));return this},advanced:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"disable_ssl_check\",label:\"Disable SSL Certificate Checks?\",help_text_html:'Only disable this if you\\'re experiencing problems and understand the risks in doing so. <a href=\"https://zapier.com/blog/2013/04/09/ssl-certificates-and-zapier/\" target=\"_new\">Learn more here</a>.',type:\"unicode\",choices:[\"no\",\"yes\"],required:false,value:z.app.account.get(\"disable_ssl_check\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},close:function(e){var fields,form,modal,save;if(e!=null)e.preventDefault();fields=[{key:\"word\",label:\"Confirm Delete\",help_text:'Confirm you really want to permanently delete your account by typing \"DELETE\" in all caps below.',type:\"unicode\",required:true,validator:function(model,collection){var data;data=collection.getValues();return data.word===\"DELETE\"}},{key:\"password\",label:\"Verify Current Password\",help_text:\"Verify your current password to delete your account.\",type:\"password\",required:true}];form=new z.model.FormSet(fields);save=function(values){var _this=this;if(values.word!==\"DELETE\"){this.saveError.call(this,this,{responseText:\"Confirmation word did not match.\"});return}return z.app.account.destroy({wait:true,data:JSON.stringify({password:values.password}),success:function(){return z.useful.goto(\"/\")},error:this.saveError})};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,button:\"Delete Account\",title:\"Permanently Delete Account and Data\"})})}});z.ui.Auths=z.ui.Base.extend({events:{\"click button.test\":\"test\",\"click button.reconnect\":\"replace\",\"click button.rename\":\"rename\",\"click button.disconnect\":\"delete\"},initialize:function(options){var render,_this=this;this.options=options;_.bindAll(this);render=_.debounce(this.render,40);z.app.auths.on(\"change add remove reset\",render,this);z.app.services.on(\"change add remove reset\",render,this);this.on(\"remove\",function(){return _this.$(\"select\").off(\"change\",_this.selectChange)});if(this.options.addService!=null){if(parseInt(this.options.addService)){return this.replaceAuth(this.options.addService)}else{return this.addAuth(this.options.addService)}}},context:function(){var auths,context,services,_this=this;this.applyCounts();auths=z.app.auths.toJSON();auths=z.app.auths.map(function(each){var auth,d;auth=each.toJSON();auth[\"name\"]=each.getName();d=new Date(auth[\"date\"]);auth[\"prettyDate\"]=[d.getMonth()+1,d.getDate(),d.getFullYear()].join(\"/\");return auth});services=z.app.services.filter(function(service){var _ref;if((_ref=service.get(\"meta\"))!=null?_ref.hide:void 0)return false;if(!service.needsAuth())return false;return true});context={auths:auths,services:services};return context},render:function(){this.$el.html(JST.settings_auths(this.context()));this.$(\"select\").select2({containerCssClass:\"select2-auths-service\",dropdownCssClass:\"select2-auths-service wide right\",formatResult:this.serviceFormatResult,formatSelection:this.serviceFormatSelection,escapeMarkup:function(s){return s},matcher:this.matcher,allowClear:true});this.$(\"select\").off(\"change\",this.selectChange);this.$(\"select\").on(\"change\",this.selectChange);return this},selectChange:function(e){var key,which;key=this.$(e.currentTarget).val();which=this.$(e.currentTarget).attr(\"data-which\");this.$(e.currentTarget).select2(\"val\",\"\");if(which===\"add\")this.addAuth(key);if(which===\"request\")return this.requestAuth(key)},serviceFormatSelection:function(){return this.serviceFormatResult.apply(this,arguments)},serviceFormatResult:function(row){var html,icon,name,service;if(!row.id)return row.text;service=z.app.services.get(row.id);icon=service.getImageClass(\"32x32\");name=service.getName();icon=_.escape(icon);name=_.escape(name);html='<i class=\"img32 '+icon+'\"></i> <t>'+name+\"</t>\";if(service.isPremium())html='<span class=\"premo\"></span>'+html;return html},matcher:function(needle,haystack){needle=needle.toLowerCase().replace(\" \",\"\");haystack=haystack.toLowerCase().replace(\" \",\"\");return _.str.include(haystack,needle)},applyCounts:function(){var _this=this;return z.app.auths.each(function(auth){var count;count=0;z.app.reads.each(function(read){var write,_ref;write=z.app.writes.get((_ref=read.get(\"write_ids\"))!=null?_ref[0]:void 0);if(read.get(\"authentication_id\")===auth.get(\"id\")||(write!=null?write.get(\"authentication_id\"):void 0)===auth.get(\"id\")){return count+=1}});return auth.set({used:count})})},addAuth:function(key){var context,modal,service,success,_this=this;service=z.app.services.get(key);success=function(auth){return _this.render()\n};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},requestAuth:function(key){var context,modal,service,success,_this=this;service=z.app.services.get(key);success=function(auth){return _this.render()};context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthRequestModal(context)})},replaceAuth:function(oldAuthId){var context,modal,oldAuth,service,success,_this=this;oldAuth=z.app.auths.get(oldAuthId);if(!oldAuth)return;success=function(newAuth){return oldAuth.swap(newAuth.id,{success:function(model,resp){return async.parallel({reads:function(cb){return z.app.reads.fetch({cache:false,reset:true,success:cb})},writes:function(cb){return z.app.writes.fetch({cache:false,reset:true,success:cb})}},function(err,results){return _this.render()})}})};service=z.app.services.get(oldAuth.get(\"selected_api\"));context={service:service,success:success};return modal=new z.ui.Modal({view:new z.ui.AuthCreateModal(context)})},replace:function(e){var $el,id;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);id=$el.attr(\"data-id\");return this.replaceAuth(id)},rename:function(e){var $el,auth,id,modal,save,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);id=$el.attr(\"data-id\");auth=z.app.auths.get(id);save=function(value){return auth.save({title:value})};return modal=new z.ui.Modal({view:new z.ui.RenameModal({value:auth.get(\"title\"),save:save})})},\"delete\":function(e){var $el,auth,id,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.text()===\"Really?\"){id=$el.attr(\"data-id\");auth=z.app.auths.get(id);this.$(\"tr[data-id=\"+id+\"]\").addClass(\"destroying\");return this.$(\"tr[data-id=\"+id+\"]\").fadeOut(400,function(){return auth.destroy()})}else{this.$(e.currentTarget).text(\"Really?\").addClass(\"orange\");return _.delay(function(){var _ref;return(_ref=_this.$(e.currentTarget))!=null?_ref.text(\"Disconnect\").removeClass(\"orange\"):void 0},3e3)}},test:function(e){var $el,auth,id,_this=this;if(e!=null)e.preventDefault();$el=this.$(e.currentTarget);if($el.text()===\"Testing...\")return;id=$el.attr(\"data-id\");auth=z.app.auths.get(id);$el.text(\"Testing...\").removeClass(\"success error\");return auth.test({success:function(model,resp){return $el.text(\"Connected!\").addClass(\"success\").attr(\"disabled\",true)},error:function(model,xhr){var context,errors,modal;$el.text(\"error!\").addClass(\"error\");errors=z.useful.errors(xhr);context={auth:auth,message:errors,type:\"manual\"};return modal=new z.ui.Modal({view:new z.ui.AuthErrorModal(context)})}})}});z.ui.PlanSelect=z.ui.Base.extend({events:{\"click .toggle-interval .switch\":\"switch\",\"click .toggle-interval .toggle-container\":\"toggle\",\"click button.change-plan\":\"changePlan\",\"click .coupon-form button\":\"useCoupon\",\"click .add-card\":\"addCard\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);return this.variant=((_ref=z.app.account.getCurrentPlan())!=null?_ref.get(\"interval\"):void 0)||\"month\"},context:function(){var context,_ref,_ref2,_ref3,_this=this;context={account:z.app.account,services:z.app.services,monthly:this.variant===\"month\",billing:z.app.account.get(\"billing\"),provider:z.app.account.get(\"provider\"),showCoupon:(_ref=this.options)!=null?_ref.showCoupon:void 0,coupon:this.couponDescription((_ref2=z.app.account.get(\"billing\"))!=null?(_ref3=_ref2.discount)!=null?_ref3.coupon:void 0:void 0),cached_coupon:z.app.account.get(\"cached_coupon\"),plans:z.app.plans.getIntervalPlans(this.variant).map(function(plan){plan.current=plan.get(\"current_plan\");plan.buttonText=\"Switch to this plan\";return plan})};return context},toggle:function(e){var t;t=this.$(e.currentTarget);if(t.hasClass(\"on\")){this.variant=\"month\"}else{this.variant=\"year\"}t.toggleClass(\"on\");return this.render()},\"switch\":function(e){var t;if(e!=null)e.preventDefault();t=this.$(e.currentTarget);t.parent().toggleClass(\"on\");this.variant=t.attr(\"data-pricing-interval\");return this.render()},changePlan:function(e){var changePlanWhy,done,el,error,isFree,lessCostly,oldText,plan,planId,sameInterval,_ref,_ref2,_this=this;if(e!=null)e.preventDefault();el=this.$(e.currentTarget);oldText=el.text();planId=el.attr(\"data-change-plan\");plan=z.app.plans.get(planId);lessCostly=plan.dollarsMo()<((_ref=z.app.account.getCurrentPlan())!=null?_ref.dollarsMo():void 0);sameInterval=plan.get(\"interval\")===((_ref2=z.app.account.getCurrentPlan())!=null?_ref2.get(\"interval\"):void 0);isFree=plan.isFree();if(el.hasClass(\"confirm\")){done=function(){_.defer(_this.render);if(_this.downgradeModal)return _this.downgradeModal.close()};error=function(model,xhr){var errors;errors=z.useful.errors(xhr);if(_this.downgradeModal)_this.downgradeModal.close();return _this.errorModal=new z.ui.Modal({view:errors+' You can update your credit card <a href=\"/app/settings/card\" data-nav=\"app/settings/card\">here</a>.'})};changePlanWhy=function(why){if(why==null)why=null;return z.app.account.switchPlan(planId,null,why,{success:done,error:error})};clearInterval(this.changeTimeout);el.attr(\"disabled\",true);el.text(oldText);if(lessCostly&&(sameInterval||isFree)){return this.downgradeModal=new z.ui.Modal({close:function(){return _this.render()},view:new z.ui.DowngradeModal({save:function(values){var why;why=\"\";_.each(values,function(value,key){if(value&&_.isBoolean(value)){return why+=\"Checked: \"+key+\"\\n\"}});if(values.comments)why+=\"Comments: \"+values.comments;return changePlanWhy(why)}})})}else{return changePlanWhy(null)}}else{this.changeTimeout=setTimeout(function(){el.text(oldText);return el.removeClass(\"confirm\")},3e3);el.text(\"Are you sure?\");return el.addClass(\"confirm\")}},useCoupon:function(e){var coupon,el,error,planId,success,_this=this;if(e!=null)e.preventDefault();el=this.$(e.currentTarget);el.addClass(\"disabled\");el.text(\"Working...\");planId=z.app.account.get(\"plan_id\");coupon=this.$(\"input.coupon-code\").val()||null;success=function(resp){var s;s=function(){_this.render();_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"success\");_this.$(\".coupon-form .feedback\").text(\"Coupon added: \"+resp.description);_this.$(\".coupon-form input\").val(\"\");el.text(\"Use Coupon\");return el.removeClass(\"disabled\")};e=function(){_this.render();_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"error\");_this.$(\".coupon-form .feedback\").text(\"Coupon is valid but could not apply.\");el.text(\"Use Coupon\");return el.removeClass(\"disabled\")};return z.app.account.switchPlan(planId,coupon,null,{success:s,error:e})};error=function(xhr){_this.$(\".coupon-form .feedback\").removeClass(\"error success\").addClass(\"error\");_this.$(\".coupon-form .feedback\").text(\"Coupon does not exist.\");el.removeClass(\"disabled\");return el.text(\"Use Coupon\")};return z.app.account.checkCoupon(coupon,{success:success,error:error})},sizeTable:function(){return this.$(\".overflow-container\").css({maxWidth:$(\"body\").width()})},render:function(){var context;context=this.context();this.$el.html(JST.settings_plans(context));this.sizeTable();return this},couponDescription:function(coupon){var desc;if(coupon!=null?coupon.amount_off:void 0){desc=\"$\"+coupon.amount_off/100+\" off\"}else if(coupon!=null?coupon.percent_off:void 0){desc=coupon.percent_off+\"% off\"}if((coupon!=null?coupon.duration:void 0)===\"repeating\"){desc=desc+\" for \"+(coupon!=null?coupon.duration_in_months:void 0)+\" months\"}else if((coupon!=null?coupon.duration:void 0)===\"once\"){desc=desc+\" for 1 month\"}else if((coupon!=null?coupon.duration:void 0)===\"forever\"){desc=desc+\" forever\"}return desc},addCard:function(e){var $el,card,cleanMonth,context,fields,form,html,joinPlan,mochoices,modal,now,planId,save,validateCard,validateCvc,validateExp,year,yearchoices,_ref,_ref2,_this=this;if(e!=null)e.preventDefault();card=(_ref=z.app.account.get(\"billing\"))!=null?_ref.active_card:void 0;context={};if(card!=null){context={type:card.type,last4:card.last4,expM:card.exp_month,expY:card.exp_year}}html=JST.settings_card(context);mochoices=[\"Jan (01)\",\"Feb (02)\",\"Mar (03)\",\"Apr (04)\",\"May (05)\",\"June (06)\",\"July (07)\",\"Aug (08)\",\"Sept (09)\",\"Oct (10)\",\"Nov (11)\",\"Dec (12)\"];yearchoices=[];now=(new Date).getFullYear();for(year=now,_ref2=now+13;now<=_ref2?year<=_ref2:year>=_ref2;now<=_ref2?year++:year--){yearchoices.push(String(year))}cleanMonth=function(month){var _ref3;return month!=null?(_ref3=month.match(/\\(([^\\)]+)\\)/))!=null?_ref3[1]:void 0:void 0};validateExp=function(model,collection){var month,_ref3,_ref4,_ref5,_ref6;month=cleanMonth((_ref3=collection.where({key:\"expmo\"}))!=null?(_ref4=_ref3[0])!=null?typeof _ref4.get===\"function\"?_ref4.get(\"value\"):void 0:void 0:void 0);year=(_ref5=collection.where({key:\"expyear\"}))!=null?(_ref6=_ref5[0])!=null?typeof _ref6.get===\"function\"?_ref6.get(\"value\"):void 0:void 0:void 0;return z.stripe.validateExpiry(month||\"0\",year||\"3000\")};validateCard=function(model,collection){return z.stripe.validateCardNumber(model.get(\"value\"))};validateCvc=function(model,collection){return z.stripe.validateCVC(model.get(\"value\"))};fields=[{key:\"name\",label:\"Cardholder Name\",help_text:\"Full name on the card.\",type:\"unicode\",required:true},{key:\"cardnumber\",label:\"Card Number\",type:\"unicode\",required:true,validator:validateCard},{key:\"expmo\",label:\"Month\",required:true,type:\"select\",choices:mochoices,validator:validateExp},{key:\"expyear\",label:\"Year\",required:true,type:\"select\",choices:yearchoices,validator:validateExp},{key:\"cvc\",label:\"CVC\",type:\"unicode\",required:true,validator:validateCvc}];form=new z.model.FormSet(fields);$el=this.$(e.currentTarget);planId=$el.attr(\"data-change-plan\");joinPlan=function(){var done;done=function(){return _.defer(_this.render)};$el.html(\"Upgrading...\");return z.app.account.switchPlan(planId,null,null,{success:done,error:done})};save=function(values){var error,stripeHandler,success,_this=this;success=this.saveSuccess;error=this.saveError;stripeHandler=function(status,response){var token;if(response.error){return error.call(_this,_this,{responseText:response.error.message})}else{token=response.id;return z.app.account.saveCard(token,{success:function(){joinPlan(e);return success.apply(this,arguments)},error:error})}};return z.stripe.createToken({name:values.name,number:values.cardnumber,cvc:values.cvc,exp_month:cleanMonth(values.expmo),exp_year:values.expyear},stripeHandler)};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({button:\"Save card and upgrade\",form:form,save:save})})}});z.ui.DowngradeModal=z.ui.Base.extend({className:\"settings-changer downgrade\",events:{\"click button.submit\":\"submit\",keyup:\"submit\"},initialize:function(options){var fields,requireOne,_ref;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}this.setMode(\"not\",\"saving\");requireOne=function(field,form){var val,_this=this;val=form.any(function(field){return field.get(\"value\")});return val};fields=[{label:\"Let us know why you are downgrading.\",help_text:\"Don't have the budget.\",key:\"Don't have the budget.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Only needed it for a short time.\",key:\"Only needed it for a short time.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Doesn't do what I need.\",key:\"Doesn't do what I need.\",type:\"checkbox\",required:false,validator:requireOne},{help_text:\"Stopped using the trigger/action service.\",key:\"Stopped using the trigger/action service.\",type:\"checkbox\",required:false,validator:requireOne},{key:\"comments\",label:\"Comments?\",help_text:\"We are a small team and details help us improve the product, so every little bit helps!\",type:\"text\",required:false,validator:requireOne}];return this.form=new z.model.FormSet(fields)},context:function(){var context;context={button:\"Downgrade my account\"};return context},render:function(){var view;this.$el.html(JST.settings_settings_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.form});this.$paramform.html(view.render().el);return this},submit:function(e){var _ref;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"is\",\"saving\"))return;if(!((_ref=this.form)!=null?_ref.isValid():void 0)){return this.$(\".feedback\").html(\"We're a small team here at Zapier and would really appreciate your feedback, double check you filled out the required field above. Thank you!\").addClass(\"error\")}else{this.$(\".feedback\").html(\"\").removeClass(\"error\")}this.setMode(\"is\",\"saving\");this.$(\"button\").attr(\"disabled\",\"true\").text(\"Downgrading...\");return this.save(this.form.getValues())},save:function(values){return log(\"to be overwritten\")}});z.ui.Invoices=z.ui.Base.extend({events:{\"click .details\":\"toggleDetails\"},initialize:function(){_.bindAll(this);z.app.account.on(\"change\",this.render,this);return z.app.invoices.on(\"change reset\",this.render,this)},context:function(){var context,d,date,m,periodEnd,y,_ref,_ref2,_ref3,_ref4,_ref5,_ref6;context={};if(((_ref=z.app.account.get(\"billing\"))!=null?(_ref2=_ref.subscription)!=null?_ref2.current_period_end:void 0:void 0)!=null&&!((_ref3=z.app.account.get(\"billing\"))!=null?(_ref4=_ref3.subscription)!=null?_ref4.cancel_at_period_end:void 0:void 0)){periodEnd=(_ref5=z.app.account.get(\"billing\"))!=null?(_ref6=_ref5.subscription)!=null?_ref6.current_period_end:void 0:void 0;date=new Date(periodEnd*1e3);d=date.getDate();m=date.getMonth()+1;y=date.getFullYear();context.billing_period_start_date=\"\"+m+\"-\"+d+\"-\"+y}return context},render:function(){var $invoices,html,_this=this;this.$el.html(JST.settings_invoices(this.context()));$invoices=this.$(\"#invoices\");html=\"\";z.app.invoices.each(function(invoice){var json;json=invoice.toFancyJSON();json.cid=invoice.cid;return html+=JST.settings_invoice(json)});if(html!==\"\")$invoices.html(html);return this},toggleDetails:function(e){var id;if(e!=null)e.preventDefault();id=$(e.currentTarget).attr(\"id\");this.$(\".invoice-details\").hide();return this.$el.find(\"#\"+id+\".invoice-details\").toggle()}});z.ui.SettingsOverview=z.ui.Base.extend({initialize:function(){var render;_.bindAll(this);render=_.debounce(this.render,40);z.app.account.on(\"change\",render,this);return z.app.plans.on(\"change\",render,this)},context:function(){var context,_ref;context=z.app.account.toJSON();context.plan=(_ref=z.app.account.getCurrentPlan())!=null?_ref.toJSON():void 0;context.status=this.getStatus();return context},render:function(){this.$el.html(JST.settings_overview(this.context()));return this},getStatus:function(){if(z.app.account.get(\"is_unlimited\"))return\"Unlimited\";if(z.app.account.get(\"is_trialing\"))return\"Trialing\";if(z.app.account.get(\"plan_active\"))return\"Active\";return\"Inactive\"}});z.ui.MyAccountSettings=z.ui.Base.extend({events:{\"click .account\":\"account\",\"click .email\":\"email\",\"click .user\":\"user\",\"click .advanced\":\"advanced\",\"click .close\":\"close\",\"click .bonus\":\"bonus\",\"click .auth\":\"auth\"},CONFIRM_PASSWORD_FIELD:{key:\"password\",label:\"Verify Current Password\",help_text:\"Please enter your password to make changes to these settings.\",type:\"password\",required:true},initialize:function(){return _.bindAll(this)},context:function(){var context;context={account:z.app.account.attributes};return context},render:function(){this.$el.html(JST.settings_my_account(this.context()));return this},bonus:function(e){if(e!=null)e.preventDefault();return z.useful.goto(\"/rewards\")},auth:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/authorizations\",{trigger:true})},account:function(e){var emailConfirmField,fields,form,modal;if(e!=null)e.preventDefault();if(z.app.account.get(\"email_confirmed\")){emailConfirmField={label:\"Confirm Email Address\",help_text_html:'<i class=\"icon-check\"></i> Your email address is confirmed.',type:\"copy\",required:false}}else{emailConfirmField={label:\"Confirm Email Address\",help_text_html:'<button class=\"confirm-email light smaller\">Send confirmation email</button>',type:\"copy\",required:false}}fields=[{key:\"email\",label:\"Email Address\",help_text:\"Make sure you can receive email at this address.\",type:\"unicode\",required:false,value:z.app.account.get(\"email\")},emailConfirmField,{key:\"password1\",label:\"New Password\",help_text:\"Leave this blank if you don't want to change your password.\",type:\"password\",required:false},{key:\"password2\",label:\"Confirm New Password\",help_text:\"Leave this blank if you don't want to change your password.\",type:\"password\",required:false},this.CONFIRM_PASSWORD_FIELD];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},email:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"manage_email_settings\",label:\"Manage Email Settings\",help_text_html:'<a target=\"_new\" href=\"/subscription/opt-out/manage/\">Manage all email subscription settings</a>.',required:false,type:\"copy\"},{key:\"summary_schedule\",label:\"Summary Schedule\",help_text:\"Daily or weekly summary of the tasks Zapier has performed.\",type:\"unicode\",choices:\"weekly,daily,never\",required:false,\"default\":z.app.account.get(\"summary_schedule\")},{key:\"alert_triggers\",label:\"Send Alerts on Failed Trigger\",help_text:'The recommended setting is \"never\". \"Repeated\" means we will only alert you once after 5 errors in a 24 hour cycle.',type:\"unicode\",choices:\"never,repeated,always\",required:false,\"default\":z.app.account.get(\"alert_triggers\")},{key:\"alert_actions\",label:\"Send Alerts on Failed Action\",help_text:'The recommended setting is \"always\". \"Repeated\" means we will only alert you once after 5 errors in a 24 hour cycle.',type:\"unicode\",choices:\"never,repeated,always\",required:false,\"default\":z.app.account.get(\"alert_actions\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},user:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"first_name\",label:\"First Name\",type:\"unicode\",required:false,value:z.app.account.get(\"first_name\")},{key:\"last_name\",label:\"Last Name\",type:\"unicode\",required:false,value:z.app.account.get(\"last_name\")},{key:\"company_name\",label:\"Company Name/Billing Info\",help_text:\"Mostly used in invoices, but can help us identify accounts.\",type:\"text\",required:false,value:z.app.account.get(\"company_name\")},{label:\"Change Your Profile Picture\",help_text_html:'We use Gravatar, a service that associates an avatar image with your email address.<br /><a target=\"_new\" href=\"https://en.gravatar.com/site/login/\">Change your Gravatar here.</a>',type:\"copy\",required:false},{key:\"timezone\",label:\"Set Your Timezone\",help_text:\"In the event that a service does not pass datetimes with timezone information (when a Zap runs), we can use this setting.\",type:\"unicode\",choices:z.app.account.get(\"timezone_choices\"),required:false,\"default\":z.app.account.get(\"timezone\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},advanced:function(e){var fields,form,modal;if(e!=null)e.preventDefault();fields=[{key:\"disable_ssl_check\",label:\"Disable SSL Certificate Checks?\",help_text_html:'Only disable this if you\\'re experiencing problems and understand the risks in doing so. <a href=\"https://zapier.com/blog/2013/04/09/ssl-certificates-and-zapier/\" target=\"_new\">Learn more here</a>.',type:\"unicode\",choices:[\"no\",\"yes\"],required:false,value:z.app.account.get(\"disable_ssl_check\")}];form=new z.model.FormSet(fields);return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,title:this.$(e.currentTarget).text()})})},close:function(e){var fields,form,modal,save;if(e!=null)e.preventDefault();fields=[{key:\"word\",label:\"Confirm Delete\",help_text:'Confirm you really want to permanently delete your account by typing \"DELETE\" in all caps below.',type:\"unicode\",required:true,validator:function(model,collection){var data;data=collection.getValues();return data.word===\"DELETE\"}},{key:\"password\",label:\"Verify Current Password\",help_text:\"Verify your current password to delete your account.\",type:\"password\",required:true}];form=new z.model.FormSet(fields);save=function(values){var _this=this;if(values.word!==\"DELETE\"){this.saveError.call(this,this,{responseText:\"Confirmation word did not match.\"});return}return z.app.account.destroy({wait:true,data:JSON.stringify({password:values.password}),success:function(){return z.useful.goto(\"/\")},error:this.saveError})};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,button:\"Delete Account\",title:\"Permanently Delete Account and Data\"})})}});z.ui.BillingSettings=z.ui.Base.extend({events:{\"click .plans\":\"plans\",\"click .card\":\"card\",\"click .invoice\":\"invoice\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);if((_ref=this.options)!=null?_ref.card:void 0)return this.card()},context:function(){var context,plan_name,plan_rate,_ref,_ref2,_ref3,_ref4,_this=this;plan_name=\"Here\";plan_rate=\"\";z.app.plans.getIntervalPlans(this.variant).map(function(plan){if(plan.get(\"current_plan\")){plan_name=plan.get(\"name\");return plan_rate=\"$\"+plan.dollarsMo()+\"/month\"}});context={plan_name:plan_name,plan_rate:plan_rate};context[\"last4\"]=(_ref=z.app.account.toJSON().billing)!=null?(_ref2=_ref.cards)!=null?(_ref3=_ref2.data)!=null?(_ref4=_ref3[0])!=null?_ref4.last4:void 0:void 0:void 0:void 0;return context},render:function(){this.$el.html(JST.settings_billing(this.context()));return this},plans:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/plans\",{trigger:true})},invoice:function(e){if(e!=null)e.preventDefault();return Backbone.history.navigate(\"app/settings/invoices\",{trigger:true})},card:function(e){var card,context,fields,form,html,modal,save,validateCard,validateCvc,validateExp,_ref,_ref2;if(e!=null)if(typeof e.preventDefault===\"function\")e.preventDefault();card=(_ref=z.app.account.get(\"billing\"))!=null?_ref.active_card:void 0;context={};if(card!=null){context={type:card.type,last4:card.last4,expM:card.exp_month,expY:card.exp_year}}html=JST.settings_card(context);validateExp=function(model,collection){var month,year,_ref2,_ref3,_ref4,_ref5;month=(_ref2=collection.where({key:\"expmo\"}))!=null?(_ref3=_ref2[0])!=null?typeof _ref3.get===\"function\"?_ref3.get(\"value\"):void 0:void 0:void 0;year=(_ref4=collection.where({key:\"expyear\"}))!=null?(_ref5=_ref4[0])!=null?typeof _ref5.get===\"function\"?_ref5.get(\"value\"):void 0:void 0:void 0;return z.stripe.validateExpiry(month||\"0\",year||\"3000\")};validateCard=function(model,collection){return z.stripe.validateCardNumber(model.get(\"value\"))};validateCvc=function(model,collection){return z.stripe.validateCVC(model.get(\"value\"))};fields=[{label:\"Card on File\",help_text_html:html,type:\"copy\",required:false},{key:\"name\",label:\"Cardholder Name\",help_text:\"Fill out the rest of the form if you'd like to update the credit card you have on file.\",type:\"unicode\",required:true},{key:\"cardnumber\",label:\"Card Number\",type:\"unicode\",required:true,validator:validateCard},{key:\"expmo\",label:\"Month\",required:true,type:\"select\",placeholder:\"MM\",validator:validateExp},{key:\"expyear\",label:\"Year\",required:true,type:\"select\",placeholder:\"YYYY\",validator:validateExp},{key:\"cvc\",label:\"CVC\",type:\"unicode\",required:true,validator:validateCvc}];form=new z.model.FormSet(fields);save=function(values){var stripeHandler,_this=this;stripeHandler=function(status,response){var token;if(response.error){return _this.saveError.call(_this,_this,{responseText:response.error.message})}else{token=response.id;return z.app.account.saveCard(token,{success:_this.saveSuccess,error:_this.saveError})}};return z.stripe.createToken({name:values.name,number:values.cardnumber,cvc:values.cvc,exp_month:values.expmo,exp_year:values.expyear},stripeHandler)};return modal=new z.ui.Modal({autoFocus:false,view:new z.ui.AccountSettingsModal({form:form,save:save,title:(_ref2=this.$(e!=null?e.currentTarget:void 0))!=null?_ref2.text():void 0})})}});z.ui.AccountSettingsModal=z.ui.Base.extend({className:\"settings-changer\",events:{\"click .confirm-email\":\"sendEmailConfirmation\",\"click button.submit\":\"submit\",keyup:\"submit\"},initialize:function(options){var _ref;this.options=options;_.bindAll(this);if(((_ref=this.options)!=null?_ref.save:void 0)!=null){this.save=this.options.save}return this.setMode(\"not\",\"saving\")},context:function(){var context;context={button:this.options.button,title:this.options.title};return context},render:function(){var view;this.$el.html(JST.settings_settings_modal(this.context()));this.$paramform=this.$(\"paramform\");view=new z.ui.ParamForm({form:this.options.form});this.$paramform.html(view.render().el);return this},submit:function(e){var values;if(e!=null)e.preventDefault();if((e!=null?e.keyCode:void 0)!=null&&e.keyCode!==13)return;if(this.hasMode(\"is\",\"saving\"))return;this.setMode(\"is\",\"saving\");this.$(\".feedback\").html(\"\").removeClass(\"error\");this.$(\"button\").text(\"Working...\");values=this.options.form.getValues();return this.save(values)},saveSuccess:function(model){var text;this.unsetHelpers();this.setMode(\"not\",\"saving\");text=this.options.button!=null?this.options.button:\"Save changes\";this.$(\"button\").text(text);return this.modal.close()},saveError:function(model,xhr){var errors,text;this.unsetHelpers();this.setMode(\"not\",\"saving\");errors=z.useful.errors(xhr);this.$(\".feedback\").html(errors).addClass(\"error\");text=this.options.button!=null?this.options.button:\"Save changes\";return this.$(\"button\").text(text)},save:function(values){return z.app.account.save(values,{success:this.saveSuccess,error:this.saveError,wait:true,patch:true})},sendEmailConfirmation:function(e){var error,success,_this=this;if(e!=null)e.preventDefault();if(this.$(e.currentTarget).hasClass(\"success\"))return;success=function(model,resp){return _this.$(\".confirm-email\").addClass(\"success\").text(\"Sent! Check your email\")};error=function(model,xhr){return _this.$(\".confirm-email\").addClass(\"error\").text(\"Error sending confirmation email\")};return z.app.account.sendEmailConfirmation({success:success,error:error})},unsetHelpers:function(){z.app.account.unset(\"password\",{silent:true});z.app.account.unset(\"password1\",{silent:true});z.app.account.unset(\"password2\",{silent:true});return z.app.account.unset(\"coupon\",{silent:true})}});\n/*\n//@ sourceMappingURL=https://zapier.cachefly.net/static/CUEw7C/build/app.js.map\n*/"
      },
      "/inline_3488cd576bee48a8a2caa4f59511d964": {
         "body": "\n    var path = '/zapbook/salesforce/';\n    var mediaUrl = 'https://zapier.cachefly.net/static/CUEboR/';\n    var preload = {};\n  \n    preload.account = {};\n  \n    var DEBUG = false;\n    var STRIPE_PUB_API_KEY = 'pk_phnG9Y3BlUIYXVpH1gkMOJ25RGbsI';\n    var TITLE_APPEND = ' - Zapier';\n    var PARTNER_ENVIRONMENT = null;\n    var PERSONAS = [\"Contractor\", \"Customer Support\", \"Designer\", \"Developer\", \"Freelancer\", \"Government\", \"Human Resource\", \"Information Technology\", \"Lawyer\", \"Marketer\", \"Non-Profit\", \"Real Estate\", \"Sales\", \"Small Business Owner\", \"Other\"];\n    \n  ",
         "pageUrl": "https://zapier.com/zapbook/salesforce/",
         "scriptUrl": "/inline_3488cd576bee48a8a2caa4f59511d964"
      },
      "https://zapier.cachefly.net/static/CUEw7C/build/external.js": {
         "pageUrl": "https://zapier.com/zapbook/dropbox/",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEw7C/build/external.js",
         "body": "(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!==\"undefined\"){if(typeof module!==\"undefined\"&&module.exports){exports=module.exports=_}exports._=_}else{root[\"_\"]=_}_.VERSION=\"1.4.2\";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return}}else{for(var key in obj){if(_.has(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError(\"Reduce of empty array with no initial value\");return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return arguments.length>2?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial)throw new TypeError(\"Reduce of empty array with no initial value\");return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){var results=[];if(obj==null)return results;each(obj,function(value,index,list){if(!iterator.call(context,value,index,list))results[results.length]=value});return results};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return!!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker});return!!result};_.contains=_.include=function(obj,target){var found=false;if(obj==null)return found;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;found=any(obj,function(value){return value===target});return found};_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs){if(_.isEmpty(attrs))return[];return _.filter(obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false}return true})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index<right.index?-1:1}),\"value\")};var group=function(obj,value,context,behavior){var result={};var iterator=lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)})};_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){if(!_.has(result,key))result[key]=0;result[key]++})};_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(obj.length===+obj.length)return slice.call(obj);return _.values(obj)};_.size=function(obj){return obj.length===+obj.length?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){if(n!=null&&!guard){return slice.call(array,Math.max(array.length-n,0))}else{return array[array.length-1]}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,function(value){return!!value})};var flatten=function(input,shallow,output){each(input,function(value){if(_.isArray(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?!index||seen[seen.length-1]!==value:!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(concat.apply(ArrayProto,arguments))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,\"length\"));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(args,\"\"+i)}return results};_.object=function(list,values){var result={};for(var i=0,l=list.length;i<l;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,l=array.length;if(isSorted){if(typeof isSorted==\"number\"){i=isSorted<0?Math.max(0,l+isSorted):isSorted}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<l;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=hasIndex?from:array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};var ctor=function(){};_.bind=function bind(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait){var context,args,timeout,throttling,more,result;var whenDone=_.debounce(function(){more=throttling=false},wait);return function(){context=this;args=arguments;var later=function(){timeout=null;if(more){result=func.apply(context,args)}whenDone()};if(!timeout)timeout=setTimeout(later,wait);if(throttling){more=true}else{throttling=true;result=func.apply(context,args)}whenDone();return result}};_.debounce=function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){if(times<=0)return func();return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError(\"Invalid object\");var keys=[];for(var key in obj)if(_.has(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){var values=[];for(var key in obj)if(_.has(obj,key))values.push(obj[key]);return values};_.pairs=function(obj){var pairs=[];for(var key in obj)if(_.has(obj,key))pairs.push([key,obj[key]]);return pairs};_.invert=function(obj){var result={};for(var key in obj)if(_.has(obj,key))result[obj[key]]=key;return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){obj[prop]=source[prop]}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key]});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key]}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(obj[prop]==null)obj[prop]=source[prop]}});return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case\"[object String]\":return a==String(b);case\"[object Number]\":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case\"[object Date]\":case\"[object Boolean]\":return+a==+b;case\"[object RegExp]\":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!=\"object\"||typeof b!=\"object\")return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b}aStack.push(a);bStack.push(b);var size=0,result=true;if(className==\"[object Array]\"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break}}}else{var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)){return false}for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}if(result){for(key in b){if(_.has(b,key)&&!size--)break}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==\"[object Array]\"};_.isObject=function(obj){return obj===Object(obj)};each([\"Arguments\",\"Function\",\"String\",\"Number\",\"Date\",\"RegExp\"],function(name){_[\"is\"+name]=function(obj){return toString.call(obj)==\"[object \"+name+\"]\"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,\"callee\"))}}if(typeof/./!==\"function\"){_.isFunction=function(obj){return typeof obj===\"function\"}}_.isFinite=function(obj){return _.isNumber(obj)&&isFinite(obj)};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==\"[object Boolean]\"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)};_.random=function(min,max){if(max==null){max=min;min=0}return min+(0|Math.random()*(max-min+1))};var entityMap={escape:{\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"/\":\"&#x2F;\"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp(\"[\"+_.keys(entityMap.escape).join(\"\")+\"]\",\"g\"),unescape:new RegExp(\"(\"+_.keys(entityMap.unescape).join(\"|\")+\")\",\"g\")};_.each([\"escape\",\"unescape\"],function(method){_[method]=function(string){if(string==null)return\"\";return(\"\"+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null)return null;var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};var noMatch=/(.)^/;var escapes={\"'\":\"'\",\"\\\\\":\"\\\\\",\"\\r\":\"r\",\"\\n\":\"n\",\"\t\":\"t\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"};var escaper=/\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;_.template=function(text,data,settings){settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join(\"|\")+\"|$\",\"g\");var index=0;var source=\"__p+='\";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return\"\\\\\"+escapes[match]});source+=escape?\"'+\\n((__t=(\"+escape+\"))==null?'':_.escape(__t))+\\n'\":interpolate?\"'+\\n((__t=(\"+interpolate+\"))==null?'':__t)+\\n'\":evaluate?\"';\\n\"+evaluate+\"\\n__p+='\":\"\";index=offset+match.length});source+=\"';\\n\";if(!settings.variable)source=\"with(obj||{}){\\n\"+source+\"}\\n\";source=\"var __t,__p='',__j=Array.prototype.join,\"+\"print=function(){__p+=__j.call(arguments,'');};\\n\"+source+\"return __p;\\n\";try{var render=new Function(settings.variable||\"obj\",\"_\",source)}catch(e){e.source=source;throw e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};template.source=\"function(\"+(settings.variable||\"obj\")+\"){\\n\"+source+\"}\";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==\"shift\"||name==\"splice\")&&obj.length===0)delete obj[0];return result.call(this,obj)}});each([\"concat\",\"join\",\"slice\"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p=\"1.9.1\",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,w=/\\S+/g,T=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,N=/^(?:(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,C=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,k=/^[\\],:{}\\s]*$/,E=/(?:^|:|,)(?:\\s*\\[)+/g,S=/\\\\(?:[\"\\\\\\/bfnrt]|u[\\da-fA-F]{4})/g,A=/\"[^\"\\\\\\r\\n]*\"|true|false|null|-?(?:\\d+\\.|)\\d+(?:[eE][+-]?\\d+|)/g,j=/^-ms-/,D=/-([\\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||\"load\"===e.type||\"complete\"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener(\"DOMContentLoaded\",H,!1),e.removeEventListener(\"load\",H,!1)):(o.detachEvent(\"onreadystatechange\",H),e.detachEvent(\"onload\",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e)return this;if(\"string\"==typeof e){if(i=\"<\"===e.charAt(0)&&\">\"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return r.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:\"\",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for(\"boolean\"==typeof s&&(c=s,s=arguments[1]||{},u=2),\"object\"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(o=arguments[u]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r));return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger(\"ready\").off(\"ready\"))}},isFunction:function(e){return\"function\"===b.type(e)},isArray:Array.isArray||function(e){return\"array\"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+\"\":\"object\"==typeof e||\"function\"==typeof e?l[m.call(e)]||\"object\":typeof e},isPlainObject:function(e){if(!e||\"object\"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,\"constructor\")&&!y.call(e.constructor.prototype,\"isPrototypeOf\"))return!1}catch(n){return!1}var r;for(r in e);return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||\"string\"!=typeof e)return null;\"boolean\"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:\"string\"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,\"@\").replace(A,\"]\").replace(E,\"\")))?Function(\"return \"+n)():(b.error(\"Invalid JSON: \"+n),t)},parseXML:function(n){var r,i;if(!n||\"string\"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,\"text/xml\")):(r=new ActiveXObject(\"Microsoft.XMLDOM\"),r.async=\"false\",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName(\"parsererror\").length||b.error(\"Invalid XML: \"+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,\"ms-\").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:v&&!v.call(\"\")?function(e){return null==e?\"\":v.call(e)}:function(e){return null==e?\"\":(e+\"\").replace(T,\"\")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,\"string\"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g)return g.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if(\"number\"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return\"string\"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if(\"object\"===b.type(r)){o=!0;for(u in r)b.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),\"complete\"===o.readyState)setTimeout(b.ready);else if(o.addEventListener)o.addEventListener(\"DOMContentLoaded\",H,!1),e.addEventListener(\"load\",H,!1);else{o.attachEvent(\"onreadystatechange\",H),e.attachEvent(\"onload\",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll(\"left\")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}return n.promise(t)},b.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),function(e,t){l[\"[object \"+t+\"]\"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:\"array\"===n||\"function\"!==n&&(0===t||\"number\"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e=\"string\"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);\"function\"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&\"string\"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1)u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return!u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},b.extend({Deferred:function(e){var t=[[\"resolve\",\"done\",b.Callbacks(\"once memory\"),\"resolved\"],[\"reject\",\"fail\",b.Callbacks(\"once memory\"),\"rejected\"],[\"notify\",\"progress\",b.Callbacks(\"memory\")]],n=\"pending\",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+\"With\"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+\"With\"](this===i?r:this,arguments),this},i[o[0]+\"With\"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1)for(s=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i;return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement(\"div\");if(d.setAttribute(\"className\",\"t\"),d.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",n=d.getElementsByTagName(\"*\"),r=d.getElementsByTagName(\"a\")[0],!n||!r||!n.length)return{};s=o.createElement(\"select\"),l=s.appendChild(o.createElement(\"option\")),a=d.getElementsByTagName(\"input\")[0],r.style.cssText=\"top:1px;float:left;opacity:.5\",t={getSetAttribute:\"t\"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName(\"tbody\").length,htmlSerialize:!!d.getElementsByTagName(\"link\").length,style:/top/.test(r.getAttribute(\"style\")),hrefNormalized:\"/a\"===r.getAttribute(\"href\"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement(\"form\").enctype,html5Clone:\"<:nav></:nav>\"!==o.createElement(\"nav\").cloneNode(!0).outerHTML,boxModel:\"CSS1Compat\"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement(\"input\"),a.setAttribute(\"value\",\"\"),t.input=\"\"===a.getAttribute(\"value\"),a.value=\"t\",a.setAttribute(\"type\",\"radio\"),t.radioValue=\"t\"===a.value,a.setAttribute(\"checked\",\"t\"),a.setAttribute(\"name\",\"t\"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent(\"onclick\",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c=\"on\"+f,\"t\"),t[f+\"Bubbles\"]=c in e||d.attributes[c].expando===!1;return d.style.backgroundClip=\"content-box\",d.cloneNode(!0).style.backgroundClip=\"\",t.clearCloneStyle=\"content-box\"===d.style.backgroundClip,b(function(){var n,r,a,s=\"padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;\",u=o.getElementsByTagName(\"body\")[0];u&&(n=o.createElement(\"div\"),n.style.cssText=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px\",u.appendChild(n).appendChild(d),d.innerHTML=\"<table><tr><td></td><td>t</td></tr></table>\",a=d.getElementsByTagName(\"td\"),a[0].style.cssText=\"padding:0;margin:0;border:0;display:none\",p=0===a[0].offsetHeight,a[0].style.display=\"\",a[1].style.display=\"none\",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML=\"\",d.style.cssText=\"box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;\",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition=\"1%\"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable=\"4px\"===(e.getComputedStyle(d,null)||{width:\"4px\"}).width,r=d.appendChild(o.createElement(\"div\")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width=\"0\",d.style.width=\"1px\",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML=\"\",d.style.cssText=s+\"width:1px;padding:1px;display:inline;zoom:1\",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display=\"block\",d.innerHTML=\"<div></div>\",d.firstChild.style.width=\"5px\",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)\n}),n=s=u=l=r=a=null,t}();var O=/(?:\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u=\"string\"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t)return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),(\"object\"==typeof n||\"function\"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(\" \"));for(r=0,i=t.length;i>r;r++)delete o[t[r]];if(!(n?$:b.isEmptyObject)(o))return}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:\"jQuery\"+(p+Math.random()).replace(/\\D/g,\"\"),noData:{embed:!0,object:\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute(\"classid\")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,\"parsedAttrs\"))){for(r=o.attributes;r.length>a;a++)i=r[a].name,i.indexOf(\"data-\")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]));b._data(o,\"parsedAttrs\",!0)}return s}return\"object\"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i=\"data-\"+n.replace(B,\"-$1\").toLowerCase();if(r=e.getAttribute(i),\"string\"==typeof r){try{r=\"true\"===r?!0:\"false\"===r?!1:\"null\"===r?null:+r+\"\"===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else r=t}return r}function $(e){var t;for(t in e)if((\"data\"!==t||!b.isEmptyObject(e[t]))&&\"toJSON\"!==t)return!1;return!0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||\"fx\")+\"queue\",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||\"fx\";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};\"inprogress\"===i&&(i=n.shift(),r--),o.cur=i,i&&(\"fx\"===t&&n.unshift(\"inprogress\"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+\"queueHooks\";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks(\"once memory\").add(function(){b._removeData(e,t+\"queue\"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return\"string\"!=typeof e&&(n=e,e=\"fx\",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),\"fx\"===e&&\"inprogress\"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||\"fx\",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||\"fx\",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};\"string\"!=typeof e&&(n=e,e=t),e=e||\"fx\";while(s--)r=b._data(a[s],e+\"queueHooks\"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var I,z,X=/[\\t\\r\\n]/g,U=/\\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=\"string\"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||\"\").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(\" \"+n.className+\" \").replace(X,\" \"):\" \")){o=0;while(i=t[o++])0>r.indexOf(\" \"+i+\" \")&&(r+=i+\" \");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||\"string\"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||\"\").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(\" \"+n.className+\" \").replace(X,\" \"):\"\")){o=0;while(i=t[o++])while(r.indexOf(\" \"+i+\" \")>=0)r=r.replace(\" \"+i+\" \",\" \");n.className=e?b.trim(r):\"\"}return this},toggleClass:function(e,t){var n=typeof e,r=\"boolean\"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(\"string\"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++])u=r?u:!s.hasClass(o),s[u?\"addClass\":\"removeClass\"](o)}else(n===i||\"boolean\"===n)&&(this.className&&b._data(this,\"__className__\",this.className),this.className=this.className||e===!1?\"\":b._data(this,\"__className__\")||\"\")})},hasClass:function(e){var t=\" \"+e+\" \",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(\" \"+this[n].className+\" \").replace(X,\" \").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o=\"\":\"number\"==typeof o?o+=\"\":b.isArray(o)&&(o=b.map(o,function(e){return null==e?\"\":e+\"\"})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&\"set\"in r&&r.set(this,o,\"value\")!==t||(this.value=o))});if(o)return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&\"get\"in r&&(n=r.get(o,\"value\"))!==t?n:(n=o.value,\"string\"==typeof n?n.replace(U,\"\"):null==n?\"\":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o=\"select-one\"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute(\"disabled\"))||n.parentNode.disabled&&b.nodeName(n.parentNode,\"optgroup\"))){if(t=b(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find(\"option\").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&\"get\"in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&\"set\"in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+\"\"),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase(\"default-\"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,\"\"),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&\"radio\"===t&&b.nodeName(e,\"input\")){var n=e.value;return e.setAttribute(\"type\",t),n&&(e.value=n),t}}}},propFix:{tabindex:\"tabIndex\",readonly:\"readOnly\",\"for\":\"htmlFor\",\"class\":\"className\",maxlength:\"maxLength\",cellspacing:\"cellSpacing\",cellpadding:\"cellPadding\",rowspan:\"rowSpan\",colspan:\"colSpan\",usemap:\"useMap\",frameborder:\"frameBorder\",contenteditable:\"contentEditable\"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&\"set\"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&\"get\"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode(\"tabindex\");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i=\"boolean\"==typeof r&&e.getAttribute(n),o=\"boolean\"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase(\"default-\"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase(\"default-\"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,\"input\")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,\"input\")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&(\"id\"===n||\"name\"===n||\"coords\"===n?\"\"!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+=\"\",\"value\"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,\"\"===t?!1:t,n)}},b.each([\"width\",\"height\"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return\"\"===r?(e.setAttribute(n,\"auto\"),r):t}})})),b.support.hrefNormalized||(b.each([\"href\",\"src\",\"width\",\"height\"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each([\"href\",\"src\"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+\"\"}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype=\"encoding\"),b.support.checkOn||b.each([\"radio\",\"checkbox\"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute(\"value\")?\"on\":e.value}}}),b.each([\"radio\",\"checkbox\"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\\.(.+)|)$/;function it(){return!0}function ot(){return!1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||\"\").match(w)||[\"\"],l=n.length;while(l--)s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||\"\").split(\".\").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(\".\")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent(\"on\"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0;e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||\"\").match(w)||[\"\"],l=t.length;while(l--)if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||\"\").split(\".\").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp(\"(^|\\\\.)\"+h.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),u=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&(\"**\"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,\"events\"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,\"type\")?n.type:n,m=y.call(n,\"namespace\")?n.namespace.split(\".\"):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(\".\")>=0&&(m=g.split(\".\"),g=m.shift(),m.sort()),u=0>g.indexOf(\":\")&&\"on\"+g,n=n[b.expando]?n:new b.Event(g,\"object\"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join(\".\"),n.namespace_re=n.namespace?RegExp(\"(^|\\\\.)\"+m.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode)h.push(l),f=l;f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(b._data(l,\"events\")||{})[n.type]&&b._data(l,\"handle\"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault();if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||\"click\"===g&&b.nodeName(i,\"a\")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,\"events\")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||\"click\"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||\"click\"!==e.type)){for(o=[],a=0;u>a;a++)i=n[a],r=i.selector+\" \",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--)n=r[t],e[n]=a[n];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:\"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),fixHooks:{},keyHooks:{props:\"char charCode key keyCode\".split(\" \"),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:\"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,\"input\")&&\"checkbox\"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:\"focusin\"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:\"focusout\"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r=\"on\"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,\"form\")?!1:(b.event.add(this,\"click._submit keypress._submit\",function(e){var n=e.target,r=b.nodeName(n,\"input\")||b.nodeName(n,\"button\")?n.form:t;r&&!b._data(r,\"submitBubbles\")&&(b.event.add(r,\"submit._submit\",function(e){e._submit_bubble=!0}),b._data(r,\"submitBubbles\",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate(\"submit\",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,\"form\")?!1:(b.event.remove(this,\"._submit\"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?((\"checkbox\"===this.type||\"radio\"===this.type)&&(b.event.add(this,\"propertychange._change\",function(e){\"checked\"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,\"click._change\",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate(\"change\",this,e,!0)})),!1):(b.event.add(this,\"beforeactivate._change\",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,\"changeBubbles\")&&(b.event.add(t,\"change._change\",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate(\"change\",this.parentNode,e,!0)}),b._data(t,\"changeBubbles\",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||\"radio\"!==n.type&&\"checkbox\"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,\"._change\"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:\"focusin\",blur:\"focusout\"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if(\"object\"==typeof e){\"string\"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&(\"string\"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+\".\"+i.namespace:i.origType,i.selector,i.handler),this;if(\"object\"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||\"function\"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,\"**\"):this.off(t,e||\"**\",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x=\"sizzle\"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},_=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",F=\"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",O=F.replace(\"w\",\"w#\"),B=\"([*^$|!~]?=)\",P=\"\\\\[\"+_+\"*(\"+F+\")\"+_+\"*(?:\"+B+_+\"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\"+O+\")|)|)\"+_+\"*\\\\]\",R=\":(\"+F+\")(?:\\\\(((['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\"+P.replace(3,8)+\")*)|.*)\\\\)|)\",W=RegExp(\"^\"+_+\"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\"+_+\"+$\",\"g\"),$=RegExp(\"^\"+_+\"*,\"+_+\"*\"),I=RegExp(\"^\"+_+\"*([\\\\x20\\\\t\\\\r\\\\n\\\\f>+~])\"+_+\"*\"),z=RegExp(R),X=RegExp(\"^\"+O+\"$\"),U={ID:RegExp(\"^#(\"+F+\")\"),CLASS:RegExp(\"^\\\\.(\"+F+\")\"),NAME:RegExp(\"^\\\\[name=['\\\"]?(\"+F+\")['\\\"]?\\\\]\"),TAG:RegExp(\"^(\"+F.replace(\"w\",\"w*\")+\")\"),ATTR:RegExp(\"^\"+P),PSEUDO:RegExp(\"^\"+R),CHILD:RegExp(\"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+_+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+_+\"*(?:([+-]|)\"+_+\"*(\\\\d+)|))\"+_+\"*\\\\)|)\",\"i\"),needsContext:RegExp(\"^\"+_+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+_+\"*((?:-\\\\d)?\\\\d*)\"+_+\"*\\\\)|)(?=[^-]|$)\",\"i\")},V=/[\\x20\\t\\r\\n\\f]*[+~]/,Y=/^[^{]+\\{\\s*\\[native code/,J=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\\d$/i,K=/'|\\\\/g,Z=/\\=[\\x20\\t\\r\\n\\f]*([^'\"\\]]*)[\\x20\\t\\r\\n\\f]*\\]/g,et=/\\\\([\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|.)/g,tt=function(e,t){var n=\"0x\"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}function rt(e){return Y.test(e+\"\")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=\" \")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement(\"div\");try{return e(t)}catch(n){return!1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||\"string\"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(!d&&!r){if(i=J.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return H.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((a=i[3])&&T.getByClassName&&t.getElementsByClassName)return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&\"object\"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute(\"id\"))?g=f.replace(K,\"\\\\$&\"):t.setAttribute(\"id\",g),g=\"[id='\"+g+\"'] \",u=l.length;while(u--)l[u]=g+dt(l[u]);m=V.test(e)&&t.parentNode||t,v=l.join(\",\")}if(v)try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute(\"id\")}}}return wt(e.replace(W,\"$1\"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?\"HTML\"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment(\"\")),!e.getElementsByTagName(\"*\").length}),T.attributes=at(function(e){e.innerHTML=\"<select></select>\";var t=typeof e.lastChild.getAttribute(\"multiple\");return\"boolean\"!==t&&\"string\"!==t}),T.getByClassName=at(function(e){return e.innerHTML=\"<div class='hidden e'></div><div class='hidden'></div>\",e.getElementsByClassName&&e.getElementsByClassName(\"e\").length?(e.lastChild.className=\"e\",2===e.getElementsByClassName(\"e\").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML=\"<a name='\"+x+\"'></a><div name='\"+x+\"'></div>\",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML=\"<a href='#'></a>\",e.firstChild&&typeof e.firstChild.getAttribute!==A&&\"#\"===e.firstChild.getAttribute(\"href\")})?{}:{href:function(e){return e.getAttribute(\"href\",2)},type:function(e){return e.getAttribute(\"type\")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute(\"id\")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode(\"id\").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode(\"id\");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if(\"*\"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[\":focus\"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML=\"<select><option selected=''></option></select>\",e.querySelectorAll(\"[selected]\").length||h.push(\"\\\\[\"+_+\"*(?:checked|disabled|ismap|multiple|readonly|selected|value)\"),e.querySelectorAll(\":checked\").length||h.push(\":checked\")}),at(function(e){e.innerHTML=\"<input type='hidden' i=''/>\",e.querySelectorAll(\"[i^='']\").length&&h.push(\"[*^$]=\"+_+\"*(?:\\\"\\\"|'')\"),e.querySelectorAll(\":enabled\").length||h.push(\":enabled\",\":disabled\"),e.querySelectorAll(\"*,:x\"),h.push(\",.*:\")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,\"div\"),m.call(e,\"[s!='']:x\"),g.push(\"!=\",R)}),h=RegExp(h.join(\"|\")),g=RegExp(g.join(\"|\")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return u=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return ut(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,\"='$1']\"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t)))try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error(\"Syntax error, unrecognized expression: \"+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return\"input\"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return(\"input\"===n||\"button\"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}o=st.getText=function(e){var t,n=\"\",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if(\"string\"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||\"\").replace(et,tt),\"~=\"===e[2]&&(e[3]=\" \"+e[3]+\" \"),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),\"nth\"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(\"even\"===e[3]||\"odd\"===e[3])),e[5]=+(e[7]+e[8]||\"odd\"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(\")\",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return\"*\"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+\" \"];return t||(t=RegExp(\"(^|\"+_+\")\"+e+\"(\"+_+\"|$)\"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute(\"class\")||\"\")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?\"!=\"===t:t?(i+=\"\",\"=\"===t?i===n:\"!=\"===t?i!==n:\"^=\"===t?n&&0===i.indexOf(n):\"*=\"===t?n&&i.indexOf(n)>-1:\"$=\"===t?n&&i.slice(-n.length)===n:\"~=\"===t?(\" \"+i+\" \").indexOf(n)>-1:\"|=\"===t?i===n||i.slice(0,n.length+1)===n+\"-\":!1):!0}},CHILD:function(e,t,n,r,i){var o=\"nth\"!==e.slice(0,3),a=\"last\"!==e.slice(-4),s=\"of-type\"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?\"nextSibling\":\"previousSibling\",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;\nh=g=\"only\"===e&&!h&&\"nextSibling\"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}else if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N)f=l[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error(\"unsupported pseudo: \"+e);return r[x]?r(t):r.length>1?(n=[e,e,\"\",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,\"$1\"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||\"\")||st.error(\"unsupported lang: \"+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=d?t.getAttribute(\"xml:lang\")||t.getAttribute(\"lang\"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+\"-\");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&!!e.checked||\"option\"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>\"@\"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&\"button\"===e.type||\"button\"===t},text:function(e){var t;return\"input\"===e.nodeName.toLowerCase()&&\"text\"===e.type&&(null==(t=e.getAttribute(\"type\"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=lt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=ct(n);function ft(e,t){var n,r,o,a,s,u,l,c=E[e+\" \"];if(c)return t?0:c.slice(0);s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W,\" \")}),s=s.slice(n.length));for(a in i.filter)!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r=\"\";for(;n>t;t++)r+=e[t].value;return r}function ht(e,t,n){var i=t.dir,o=n&&\"parentNode\"===i,a=C++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,s){var u,l,c,p=N+\" \"+a;if(s){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0)return!0}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||\"*\",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--)(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}else y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[\" \"],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++)if(n=i.relative[e[u].type])f=[ht(gt(f),n)];else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++)if(i.relative[e[r].type])break;return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,\"$1\"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b=\"0\",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG(\"*\",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,u,c)){f.push(h);break}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++])m(x,y,u,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=L.call(f));y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+\" \"];if(!o){t||(t=ft(e)),n=t.length;while(n--)o=vt(t[n]),o[x]?r.push(o):i.push(o);o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&\"ID\"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type])break;if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e)return H.apply(n,q.call(r,0)),n;break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[\":\"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\\[\\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if(\"string\"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+\" \":\"\")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return!!e&&(\"string\"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||\"string\"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?\"string\"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=\"string\"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,\"parentNode\")},parentsUntil:function(e,t,n){return b.dir(e,\"parentNode\",n)},next:function(e){return pt(e,\"nextSibling\")},prev:function(e){return pt(e,\"previousSibling\")},nextAll:function(e){return b.dir(e,\"nextSibling\")},prevAll:function(e){return b.dir(e,\"previousSibling\")},nextUntil:function(e,t,n){return b.dir(e,\"nextSibling\",n)},prevUntil:function(e,t,n){return b.dir(e,\"previousSibling\",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,\"iframe\")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&\"string\"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=\":not(\"+e+\")\"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if(\"string\"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split(\"|\"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht=\"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",gt=/ jQuery\\d+=\"(?:null|\\d+)\"/g,mt=RegExp(\"<(?:\"+ht+\")[\\\\s/>]\",\"i\"),yt=/^\\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,bt=/<([\\w:]+)/,xt=/<tbody/i,wt=/<|&#?\\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\\s*(?:[^=]|=\\s*.checked.)/i,kt=/^$|\\/(?:java|ecma)script/i,Et=/^true\\/(.*)/,St=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,At={option:[1,\"<select multiple='multiple'>\",\"</select>\"],legend:[1,\"<fieldset>\",\"</fieldset>\"],area:[1,\"<map>\",\"</map>\"],param:[1,\"<object>\",\"</object>\"],thead:[1,\"<table>\",\"</table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],col:[2,\"<table><tbody></tbody><colgroup>\",\"</colgroup></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],_default:b.support.htmlSerialize?[0,\"\",\"\"]:[1,\"X<div>\",\"</div>\"]},jt=dt(o),Dt=jt.appendChild(o.createElement(\"div\"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,\"body\")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,\"script\")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,\"select\")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,\"\"):t;if(!(\"string\"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||[\"\",\"\"])[1].toLowerCase()])){e=e.replace(vt,\"<$1></$2>\");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||\"string\"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||\"string\"!=typeof g||b.support.checkClone)&&Ct.test(g))return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)});if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,\"tr\"),s=b.map(Ot(l,\"script\"),Ht),a=s.length;p>c;c++)o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,\"script\"))),r.call(n&&b.nodeName(this[c],\"table\")?Lt(this[c],\"tbody\"):this[c],o,c);if(a)for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++)o=s[c],kt.test(o.type||\"\")&&!b._data(o,\"globalEval\")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:\"GET\",dataType:\"script\",async:!1,global:!1,\"throws\":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||\"\").replace(St,\"\")));l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode(\"type\");return e.type=(t&&t.specified)+\"/\"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute(\"type\"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,\"globalEval\",!t||b._data(t[r],\"globalEval\"))}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)b.event.add(t,n,s[n][r])}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}\"script\"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):\"object\"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):\"input\"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):\"option\"===n?t.defaultSelected=t.selected=e.defaultSelected:(\"input\"===n||\"textarea\"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||\"*\"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||\"*\"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test(\"<\"+e.nodeName+\">\")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a)r[a]&&Ft(i,r[a]);if(t)if(n)for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++)_t(i,r[a]);else _t(e,o);return r=Ot(o,\"script\"),r.length>0&&Mt(r,!u&&Ot(e,\"script\")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if(\"object\"===b.type(o))b.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement(\"div\")),u=(bt.exec(o)||[\"\",\"\"])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,\"<$1></$2>\")+c[2],i=c[0];while(i--)s=s.lastChild;if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o=\"table\"!==u||xt.test(o)?\"<table>\"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)b.nodeName(l=o.childNodes[i],\"tbody\")&&!l.childNodes.length&&o.removeChild(l)}b.merge(d,s.childNodes),s.textContent=\"\";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,\"input\"),Bt),h=0;while(o=d[h++])if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),\"script\"),a&&Mt(s),n)){i=0;while(o=s[i++])kt.test(o.type||\"\")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++)if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events)for(r in a.events)f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle);l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}});var Pt,Rt,Wt,$t=/alpha\\([^)]*\\)/i,It=/opacity\\s*=\\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp(\"^(\"+x+\")(.*)$\",\"i\"),Yt=RegExp(\"^(\"+x+\")(?!px)[a-z%]+$\",\"i\"),Jt=RegExp(\"^([+-])=(\"+x+\")\",\"i\"),Gt={BODY:\"block\"},Qt={position:\"absolute\",visibility:\"hidden\",display:\"block\"},Kt={letterSpacing:0,fontWeight:400},Zt=[\"Top\",\"Right\",\"Bottom\",\"Left\"],en=[\"Webkit\",\"O\",\"Moz\",\"ms\"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,\"none\"===b.css(e,\"display\")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=b._data(r,\"olddisplay\"),n=r.style.display,t?(o[a]||\"none\"!==n||(r.style.display=\"\"),\"\"===r.style.display&&nn(r)&&(o[a]=b._data(r,\"olddisplay\",un(r.nodeName)))):o[a]||(i=nn(r),(n&&\"none\"!==n||!i)&&b._data(r,\"olddisplay\",i?n:b.css(r,\"display\"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&\"none\"!==r.style.display&&\"\"!==r.style.display||(r.style.display=t?o[a]||\"\":\"none\"));return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=b.css(e,n[s],!1,o);return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t=\"boolean\"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,\"opacity\");return\"\"===n?\"1\":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":b.support.cssFloat?\"cssFloat\":\"styleFloat\"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t)return s&&\"get\"in s&&(o=s.get(e,!1,i))!==t?o:l[n];if(a=typeof r,\"string\"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a=\"number\"),!(null==r||\"number\"===a&&isNaN(r)||(\"number\"!==a||b.cssNumber[u]||(r+=\"px\"),b.support.clearCloneStyle||\"\"!==r||0!==n.indexOf(\"background\")||(l[n]=\"inherit\"),s&&\"set\"in s&&(r=s.set(e,r,i))===t)))try{l[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&\"get\"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),\"normal\"===a&&n in Kt&&(a=Kt[n]),\"\"===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(\"\"!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left=\"fontSize\"===n?\"1em\":u,u=l.pixelLeft+\"px\",l.left=i,a&&(o.left=a)),\"\"===u?\"auto\":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||\"px\"):t}function an(e,t,n,r,i){var o=n===(r?\"border\":\"content\")?4:\"width\"===t?1:0,a=0;for(;4>o;o+=2)\"margin\"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?(\"content\"===n&&(a-=b.css(e,\"padding\"+Zt[o],!0,i)),\"margin\"!==n&&(a-=b.css(e,\"border\"+Zt[o]+\"Width\",!0,i))):(a+=b.css(e,\"padding\"+Zt[o],!0,i),\"padding\"!==n&&(a+=b.css(e,\"border\"+Zt[o]+\"Width\",!0,i)));return a}function sn(e,t,n){var r=!0,i=\"width\"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&\"border-box\"===b.css(e,\"boxSizing\",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?\"border\":\"content\"),r,o)+\"px\"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),\"none\"!==n&&n||(Pt=(Pt||b(\"<iframe frameborder='0' width='0' height='0'/>\").css(\"cssText\",\"display:block !important\")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write(\"<!doctype html><html><body>\"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],\"display\");return n.remove(),r}b.each([\"height\",\"width\"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,\"display\"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&\"border-box\"===b.css(e,\"boxSizing\",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||\"\")?.01*parseFloat(RegExp.$1)+\"\":t?\"1\":\"\"},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?\"alpha(opacity=\"+100*t+\")\":\"\",o=r&&r.filter||n.filter||\"\";n.zoom=1,(t>=1||\"\"===t)&&\"\"===b.trim(o.replace($t,\"\"))&&n.removeAttribute&&(n.removeAttribute(\"filter\"),\"\"===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+\" \"+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:\"inline-block\"},Wt,[e,\"marginRight\"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each([\"top\",\"left\"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+\"px\":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&\"none\"===(e.style&&e.style.display||b.css(e,\"display\"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:\"\",padding:\"\",border:\"Width\"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o=\"string\"==typeof n?n.split(\" \"):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\\[\\]$/,fn=/\\r?\\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,\"elements\");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(\":disabled\")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,\"\\r\\n\")}}):{name:t.name,value:n.replace(fn,\"\\r\\n\")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?\"\":t,i[i.length]=encodeURIComponent(e)+\"=\"+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join(\"&\").replace(cn,\"+\")};function gn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+\"[\"+(\"object\"==typeof i?t:\"\")+\"]\",i,n,r)});else if(n||\"object\"!==b.type(t))r(e,t);else for(i in t)gn(e+\"[\"+i+\"]\",t[i],n,r)}b.each(\"blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu\".split(\" \"),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\\/\\//,En=/^([\\w.+-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn=\"*/\".concat(\"*\");try{yn=a.href}catch(Ln){yn=o.createElement(\"a\"),yn.href=\"\",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){\"string\"!=typeof t&&(n=t,t=\"*\");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n))while(r=o[i++])\"+\"===r[0]?(r=r.slice(1)||\"*\",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return\"string\"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o[\"*\"]&&s(\"*\")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if(\"string\"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(\" \");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&\"object\"==typeof n&&(a=\"POST\"),s.length>0&&b.ajax({url:e,type:a,dataType:\"html\",data:n}).done(function(e){o=arguments,s.html(i?b(\"<div>\").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each([\"get\",\"post\"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:\"GET\",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":Dn,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:\"responseXML\",text:\"responseText\"},converters:{\"* text\":e.String,\"text html\":!0,\"text json\":b.parseJSON,\"text xml\":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){\"object\"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks(\"once memory\"),m=p.statusCode||{},y={},v={},x=0,T=\"canceled\",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else N.always(e[N.status]);return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+\"\").replace(xn,\"\").replace(kn,mn[1]+\"//\"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||\"*\").toLowerCase().match(w)||[\"\"],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||(\"http:\"===r[1]?80:443))==(mn[3]||(\"http:\"===mn[1]?80:443)))),p.data&&p.processData&&\"string\"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x)return N;u=p.global,u&&0===b.active++&&b.event.trigger(\"ajaxStart\"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?\"&\":\"?\")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,\"$1_=\"+vn++):o+(bn.test(o)?\"&\":\"?\")+\"_=\"+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader(\"If-Modified-Since\",b.lastModified[o]),b.etag[o]&&N.setRequestHeader(\"If-None-Match\",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader(\"Content-Type\",p.contentType),N.setRequestHeader(\"Accept\",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+(\"*\"!==p.dataTypes[0]?\", \"+Dn+\"; q=0.01\":\"\"):p.accepts[\"*\"]);for(i in p.headers)N.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x))return N.abort();T=\"abort\";for(i in{success:1,error:1,complete:1})N[i](p[i]);if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger(\"ajaxSend\",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort(\"timeout\")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x))throw C;k(-1,C)}}else k(-1,\"No Transport\");function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||\"\",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader(\"Last-Modified\"),T&&(b.lastModified[o]=T),T=N.getResponseHeader(\"etag\"),T&&(b.etag[o]=T)),204===e?(c=!0,C=\"nocontent\"):304===e?(c=!0,C=\"notmodified\"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C=\"error\",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+\"\",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?\"ajaxSuccess\":\"ajaxError\",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger(\"ajaxComplete\",[N,p]),--b.active||b.event.trigger(\"ajaxStop\")))\n}return N},getScript:function(e,n){return b.get(e,t,n,\"script\")},getJSON:function(e,t,n){return b.get(e,t,n,\"json\")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c)s in r&&(n[c[s]]=r[s]);while(\"*\"===l[0])l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader(\"Content-Type\"));if(o)for(s in u)if(u[s]&&u[s].test(o)){l.unshift(s);break}if(l[0]in r)a=l[0];else{for(s in r){if(!l[0]||e.converters[s+\" \"+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1])for(i in e.converters)a[i.toLowerCase()]=e.converters[i];for(;r=u[++s];)if(\"*\"!==r){if(\"*\"!==l&&l!==r){if(i=a[l+\" \"+r]||a[\"* \"+r],!i)for(n in a)if(o=n.split(\" \"),o[1]===r&&(i=a[l+\" \"+o[0]]||a[\"* \"+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}if(i!==!0)if(i&&e[\"throws\"])t=i(t);else try{t=i(t)}catch(c){return{state:\"parsererror\",error:i?c:\"No conversion from \"+l+\" to \"+r}}}l=r}return{state:\"success\",data:t}}b.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/(?:java|ecma)script/},converters:{\"text script\":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter(\"script\",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type=\"GET\",e.global=!1)}),b.ajaxTransport(\"script\",function(e){if(e.crossDomain){var n,r=o.head||b(\"head\")[0]||o.documentElement;return{send:function(t,i){n=o.createElement(\"script\"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,\"success\"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\\?(?=&|$)|\\?\\?/;b.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var e=On.pop()||b.expando+\"_\"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter(\"json jsonp\",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?\"url\":\"string\"==typeof n.data&&!(n.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&Bn.test(n.data)&&\"data\");return u||\"jsonp\"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,\"$1\"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?\"&\":\"?\")+n.jsonp+\"=\"+o),n.converters[\"script json\"]=function(){return s||b.error(o+\" was not called\"),s[0]},n.dataTypes[0]=\"json\",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),\"script\"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject(\"Microsoft.XMLHTTP\")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&\"withCredentials\"in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)u[s]=n.xhrFields[s];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i[\"X-Requested-With\"]||(i[\"X-Requested-With\"]=\"XMLHttpRequest\");try{for(s in i)u.setRequestHeader(s,i[s])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState))if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i)4!==u.readyState&&u.abort();else{p={},s=u.status,l=u.getAllResponseHeaders(),\"string\"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=\"\"}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp(\"^(?:([+-])=|)(\"+x+\")([a-z%]*)$\",\"i\"),Jn=/queueHooks$/,Gn=[nr],Qn={\"*\":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?\"\":\"px\"),\"px\"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do u=u||\".5\",s/=u,b.style(i.elem,e,s+r);while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn[\"*\"]),i=0,o=r.length;for(;o>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++)if(r=Gn[o].call(l,e,c,l.opts))return r;return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e)if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&\"expand\"in a){n=a.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=o)}else t[r]=o}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=[\"*\"]):e=e.split(\" \");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,\"fx\"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,\"fx\").length||c.empty.fire()})})),1===e.nodeType&&(\"height\"in t||\"width\"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],\"inline\"===b.css(e,\"display\")&&\"none\"===b.css(e,\"float\")&&(b.support.inlineBlockNeedsLayout&&\"inline\"!==un(e.nodeName)?d.zoom=1:d.display=\"inline-block\")),n.overflow&&(d.overflow=\"hidden\",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||\"toggle\"===a,a===(m?\"hide\":\"show\"))continue;g.push(i)}if(o=g.length){s=b._data(e,\"fxshow\")||b._data(e,\"fxshow\",{}),\"hidden\"in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,\"fxshow\");for(t in h)b.style(e,t,h[t])});for(i=0;o>i;i++)r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start=\"width\"===r||\"height\"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||\"swing\",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?\"\":\"px\")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,\"\"),t&&\"auto\"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each([\"toggle\",\"show\",\"hide\"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||\"boolean\"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css(\"opacity\",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,\"finish\"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return\"string\"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||\"fx\",[]),this.each(function(){var t=!0,n=null!=e&&e+\"queueHooks\",o=b.timers,a=b._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||\"fx\"),this.each(function(){var t,n=b._data(this),r=n[e+\"queue\"],i=n[e+\"queueHooks\"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r[\"margin\"+n]=r[\"padding\"+n]=e;return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir(\"show\"),slideUp:ir(\"hide\"),slideToggle:ir(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&\"object\"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:\"number\"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue=\"fx\"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},b.offset={setOffset:function(e,t,n){var r=b.css(e,\"position\");\"static\"===r&&(e.style.position=\"relative\");var i=b(e),o=i.offset(),a=b.css(e,\"top\"),s=b.css(e,\"left\"),u=(\"absolute\"===r||\"fixed\"===r)&&b.inArray(\"auto\",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),\"using\"in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return\"fixed\"===b.css(r,\"position\")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],\"html\")||(n=e.offset()),n.top+=b.css(e[0],\"borderTopWidth\",!0),n.left+=b.css(e[0],\"borderLeftWidth\",!0)),{top:t.top-n.top-b.css(r,\"marginTop\",!0),left:t.left-n.left-b.css(r,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,\"html\")&&\"static\"===b.css(e,\"position\"))e=e.offsetParent;return e||o.documentElement})}}),b.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:\"height\",Width:\"width\"},function(e,n){b.each({padding:\"inner\"+e,content:n,\"\":\"outer\"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||\"boolean\"!=typeof i),s=r||(i===!0||o===!0?\"margin\":\"border\");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement[\"client\"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body[\"scroll\"+e],o[\"scroll\"+e],n.body[\"offset\"+e],o[\"offset\"+e],o[\"client\"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,\"function\"==typeof define&&define.amd&&define.amd.jQuery&&define(\"jquery\",[],function(){return b})})(window);(function(factory){if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(jQuery)}})(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler(\"remove\")}catch(e){}}_cleanData(elems)};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(\".\")[0];name=name.split(\".\")[1];fullName=namespace+\"-\"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[\":\"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+\".\"+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor)};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options===\"string\",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error(\"cannot call methods on \"+name+\" prior to initialization; \"+\"attempted to call method '\"+options+\"'\")}if(!$.isFunction(instance[options])||options.charAt(0)===\"_\"){return $.error(\"no such method '\"+options+\"' for \"+name+\" widget instance\")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init()}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:\"widget\",widgetEventPrefix:\"\",defaultElement:\"<div>\",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace=\".\"+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger(\"create\",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr(\"aria-disabled\").removeClass(this.widgetFullName+\"-disabled \"+\"ui-state-disabled\");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass(\"ui-state-hover\");this.focusable.removeClass(\"ui-state-focus\")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key===\"string\"){options={};parts=key.split(\".\");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key===\"disabled\"){this.widget().toggleClass(this.widgetFullName+\"-disabled ui-state-disabled\",!!value).attr(\"aria-disabled\",value);this.hoverable.removeClass(\"ui-state-hover\");this.focusable.removeClass(\"ui-state-focus\")}return this},enable:function(){return this._setOption(\"disabled\",false)},disable:function(){return this._setOption(\"disabled\",true)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!==\"boolean\"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass(\"ui-state-disabled\"))){return}return(typeof handler===\"string\"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!==\"string\"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^(\\w+)\\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||\"\").split(\" \").join(this.eventNamespace+\" \")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler===\"string\"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass(\"ui-state-hover\")},mouseleave:function(event){$(event.currentTarget).removeClass(\"ui-state-hover\")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass(\"ui-state-focus\")},focusout:function(event){$(event.currentTarget).removeClass(\"ui-state-focus\")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:\"fadeIn\",hide:\"fadeOut\"},function(method,defaultEffect){$.Widget.prototype[\"_\"+method]=function(element,options,callback){if(typeof options===\"string\"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options===\"number\"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options===\"number\"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}})});window.CodeMirror=function(){\"use strict\";var gecko=/gecko\\/\\d/i.test(navigator.userAgent);var ie=/MSIE \\d/.test(navigator.userAgent);var ie_lt8=ie&&(document.documentMode==null||document.documentMode<8);var ie_lt9=ie&&(document.documentMode==null||document.documentMode<9);var webkit=/WebKit\\//.test(navigator.userAgent);var qtwebkit=webkit&&/Qt\\/\\d+\\.\\d+/.test(navigator.userAgent);var chrome=/Chrome\\//.test(navigator.userAgent);var opera=/Opera\\//.test(navigator.userAgent);var safari=/Apple Computer/.test(navigator.vendor);var khtml=/KHTML\\//.test(navigator.userAgent);var mac_geLion=/Mac OS X 1\\d\\D([7-9]|\\d\\d)\\D/.test(navigator.userAgent);var mac_geMountainLion=/Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(navigator.userAgent);var phantom=/PhantomJS/.test(navigator.userAgent);var ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\\/\\w+/.test(navigator.userAgent);var mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var mac=ios||/Mac/.test(navigator.platform);var windows=/windows/i.test(navigator.platform);var opera_version=opera&&navigator.userAgent.match(/Version\\/(\\d*\\.\\d*)/);if(opera_version)opera_version=Number(opera_version[1]);var flipCtrlCmd=mac&&(qtwebkit||opera&&(opera_version==null||opera_version<12.11));var captureMiddleClick=gecko||ie&&!ie_lt9;var sawReadOnlySpans=false,sawCollapsedSpans=false;function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options||{};for(var opt in defaults)if(!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt))options[opt]=defaults[opt];setGuttersForLineNumbers(options);var docStart=typeof options.value==\"string\"?0:options.value.first;var display=this.display=makeDisplay(place,docStart);display.wrapper.CodeMirror=this;updateGutters(this);if(options.autofocus&&!mobile)focusInput(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,draggingText:false,highlight:new Delayed};themeChanged(this);if(options.lineWrapping)this.display.wrapper.className+=\" CodeMirror-wrap\";var doc=options.value;if(typeof doc==\"string\")doc=new Doc(options.value,options.mode);operation(this,attachDoc)(this,doc);if(ie)setTimeout(bind(resetInput,this,true),20);registerEventHandlers(this);var hasFocus;try{hasFocus=document.activeElement==display.input}catch(e){}if(hasFocus||options.autofocus&&!mobile)setTimeout(bind(onFocus,this),20);else onBlur(this);operation(this,function(){for(var opt in optionHandlers)if(optionHandlers.propertyIsEnumerable(opt))optionHandlers[opt](this,options[opt],Init);for(var i=0;i<initHooks.length;++i)initHooks[i](this)})()}function makeDisplay(place,docStart){var d={};var input=d.input=elt(\"textarea\",null,null,\"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;\");if(webkit)input.style.width=\"1000px\";else input.setAttribute(\"wrap\",\"off\");if(ios)input.style.border=\"1px solid black\";input.setAttribute(\"autocorrect\",\"off\");input.setAttribute(\"autocapitalize\",\"off\");input.setAttribute(\"spellcheck\",\"false\");d.inputDiv=elt(\"div\",[input],null,\"overflow: hidden; position: relative; width: 3px; height: 0px;\");d.scrollbarH=elt(\"div\",[elt(\"div\",null,null,\"height: 1px\")],\"CodeMirror-hscrollbar\");d.scrollbarV=elt(\"div\",[elt(\"div\",null,null,\"width: 1px\")],\"CodeMirror-vscrollbar\");d.scrollbarFiller=elt(\"div\",null,\"CodeMirror-scrollbar-filler\");d.gutterFiller=elt(\"div\",null,\"CodeMirror-gutter-filler\");d.lineDiv=elt(\"div\",null,\"CodeMirror-code\");d.selectionDiv=elt(\"div\",null,null,\"position: relative; z-index: 1\");d.cursor=elt(\"div\",\"\",\"CodeMirror-cursor\");d.otherCursor=elt(\"div\",\"\",\"CodeMirror-cursor CodeMirror-secondarycursor\");d.measure=elt(\"div\",null,\"CodeMirror-measure\");d.lineSpace=elt(\"div\",[d.measure,d.selectionDiv,d.lineDiv,d.cursor,d.otherCursor],null,\"position: relative; outline: none\");d.mover=elt(\"div\",[elt(\"div\",[d.lineSpace],\"CodeMirror-lines\")],null,\"position: relative\");d.sizer=elt(\"div\",[d.mover],\"CodeMirror-sizer\");d.heightForcer=elt(\"div\",null,null,\"position: absolute; height: \"+scrollerCutOff+\"px; width: 1px;\");d.gutters=elt(\"div\",null,\"CodeMirror-gutters\");d.lineGutter=null;d.scroller=elt(\"div\",[d.sizer,d.heightForcer,d.gutters],\"CodeMirror-scroll\");d.scroller.setAttribute(\"tabIndex\",\"-1\");d.wrapper=elt(\"div\",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.gutterFiller,d.scroller],\"CodeMirror\");if(ie_lt8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0}if(place.appendChild)place.appendChild(d.wrapper);else place(d.wrapper);if(ios)input.style.width=\"0px\";if(!webkit)d.scroller.draggable=true;if(khtml){d.inputDiv.style.height=\"1px\";d.inputDiv.style.position=\"absolute\"}else if(ie_lt8)d.scrollbarH.style.minWidth=d.scrollbarV.style.minWidth=\"18px\";d.viewOffset=d.lastSizeC=0;d.showingFrom=d.showingTo=docStart;d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;d.prevInput=\"\";d.alignWidgets=false;d.pollingFast=false;d.poll=new Delayed;d.cachedCharWidth=d.cachedTextHeight=null;d.measureLineCache=[];d.measureLineCachePos=0;d.inaccurateSelection=false;d.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;return d}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption);cm.doc.iter(function(line){if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null});cm.doc.frontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp)regChange(cm)}function wrappingChanged(cm){if(cm.options.lineWrapping){cm.display.wrapper.className+=\" CodeMirror-wrap\";cm.display.sizer.style.minWidth=\"\"}else{cm.display.wrapper.className=cm.display.wrapper.className.replace(\" CodeMirror-wrap\",\"\");computeMaxLength(cm)}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout(function(){updateScrollbars(cm)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;else if(wrapping)return(Math.ceil(line.text.length/perLine)||1)*th;else return th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);if(estHeight!=line.height)updateLineHeight(line,estHeight)})}function keyMapChanged(cm){var map=keyMap[cm.options.keyMap],style=map.style;cm.display.wrapper.className=cm.display.wrapper.className.replace(/\\s*cm-keymap-\\S+/g,\"\")+(style?\" cm-keymap-\"+style:\"\");if(map.disableInput)cm.doc.cantEdit|=cantEdit_keymap;else cm.doc.cantEdit&=~cantEdit_keymap}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g,\"\")+cm.options.theme.replace(/(^|\\s)\\s*/g,\" cm-s-\");clearCaches(cm)}function guttersChanged(cm){updateGutters(cm);regChange(cm);setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i];var gElt=gutters.appendChild(elt(\"div\",null,\"CodeMirror-gutter \"+gutterClass));if(gutterClass==\"CodeMirror-linenumbers\"){cm.display.lineGutter=gElt;gElt.style.width=(cm.display.lineNumWidth||1)+\"px\"}}gutters.style.display=i?\"\":\"none\"}function lineLength(doc,line){if(line.height==0)return 0;var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find();cur=getLine(doc,found.from.line);len+=found.from.ch-found.to.ch}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();len-=cur.text.length-found.from.ch;cur=getLine(doc,found.to.line);len+=cur.text.length-found.to.ch}return len}function computeMaxLength(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(doc,d.maxLine);d.maxLineChanged=true;doc.iter(function(line){var len=lineLength(doc,line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line}})}function setGuttersForLineNumbers(options){var found=false;for(var i=0;i<options.gutters.length;++i){if(options.gutters[i]==\"CodeMirror-linenumbers\"){if(options.lineNumbers)found=true;else options.gutters.splice(i--,1)}}if(!found&&options.lineNumbers)options.gutters.push(\"CodeMirror-linenumbers\")}function updateScrollbars(cm){var d=cm.display,docHeight=cm.doc.height;\nvar totalHeight=docHeight+paddingVert(d);d.sizer.style.minHeight=d.heightForcer.style.top=totalHeight+\"px\";d.gutters.style.height=Math.max(totalHeight,d.scroller.clientHeight-scrollerCutOff)+\"px\";var scrollHeight=Math.max(totalHeight,d.scroller.scrollHeight);var needsH=d.scroller.scrollWidth>d.scroller.clientWidth+1;var needsV=scrollHeight>d.scroller.clientHeight+1;if(needsV){d.scrollbarV.style.display=\"block\";d.scrollbarV.style.bottom=needsH?scrollbarWidth(d.measure)+\"px\":\"0\";d.scrollbarV.firstChild.style.height=scrollHeight-d.scroller.clientHeight+d.scrollbarV.clientHeight+\"px\"}else d.scrollbarV.style.display=\"\";if(needsH){d.scrollbarH.style.display=\"block\";d.scrollbarH.style.right=needsV?scrollbarWidth(d.measure)+\"px\":\"0\";d.scrollbarH.firstChild.style.width=d.scroller.scrollWidth-d.scroller.clientWidth+d.scrollbarH.clientWidth+\"px\"}else d.scrollbarH.style.display=\"\";if(needsH&&needsV){d.scrollbarFiller.style.display=\"block\";d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=scrollbarWidth(d.measure)+\"px\"}else d.scrollbarFiller.style.display=\"\";if(needsH&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter){d.gutterFiller.style.display=\"block\";d.gutterFiller.style.height=scrollbarWidth(d.measure)+\"px\";d.gutterFiller.style.width=d.gutters.offsetWidth+\"px\"}else d.gutterFiller.style.display=\"\";if(mac_geLion&&scrollbarWidth(d.measure)===0)d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=mac_geMountainLion?\"18px\":\"12px\"}function visibleLines(display,doc,viewPort){var top=display.scroller.scrollTop,height=display.wrapper.clientHeight;if(typeof viewPort==\"number\")top=viewPort;else if(viewPort){top=viewPort.top;height=viewPort.bottom-viewPort.top}top=Math.floor(top-paddingTop(display));var bottom=Math.ceil(top+height);return{from:lineAtHeight(doc,top),to:lineAtHeight(doc,bottom)}}function alignHorizontally(cm){var display=cm.display;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter))return;var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,l=comp+\"px\";for(var n=display.lineDiv.firstChild;n;n=n.nextSibling)if(n.alignable){for(var i=0,a=n.alignable;i<a.length;++i)a[i].style.left=l}if(cm.options.fixedGutter)display.gutters.style.left=comp+gutterW+\"px\"}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return false;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt(\"div\",[elt(\"div\",last)],\"CodeMirror-linenumber CodeMirror-gutter-elt\"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width=\"\";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding);display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+\"px\";return true}return false}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return getRect(display.scroller).left-getRect(display.sizer).left}function updateDisplay(cm,changes,viewPort){var oldFrom=cm.display.showingFrom,oldTo=cm.display.showingTo,updated;var visible=visibleLines(cm.display,cm.doc,viewPort);for(;;){if(!updateDisplayInner(cm,changes,visible))break;updated=true;updateSelection(cm);updateScrollbars(cm);if(viewPort)viewPort=Math.min(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,typeof viewPort==\"number\"?viewPort:viewPort.top);visible=visibleLines(cm.display,cm.doc,viewPort);if(visible.from>=cm.display.showingFrom&&visible.to<=cm.display.showingTo)break;changes=[]}if(updated){signalLater(cm,\"update\",cm);if(cm.display.showingFrom!=oldFrom||cm.display.showingTo!=oldTo)signalLater(cm,\"viewportChange\",cm,cm.display.showingFrom,cm.display.showingTo)}return updated}function updateDisplayInner(cm,changes,visible){var display=cm.display,doc=cm.doc;if(!display.wrapper.clientWidth){display.showingFrom=display.showingTo=doc.first;display.viewOffset=0;return}if(changes.length==0&&visible.from>display.showingFrom&&visible.to<display.showingTo)return;if(maybeUpdateLineNumberWidth(cm))changes=[{from:doc.first,to:doc.first+doc.size}];var gutterW=display.sizer.style.marginLeft=display.gutters.offsetWidth+\"px\";display.scrollbarH.style.left=cm.options.fixedGutter?gutterW:\"0\";var positionsChangedFrom=Infinity;if(cm.options.lineNumbers)for(var i=0;i<changes.length;++i)if(changes[i].diff){positionsChangedFrom=changes[i].from;break}var end=doc.first+doc.size;var from=Math.max(visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,visible.to+cm.options.viewportMargin);if(display.showingFrom<from&&from-display.showingFrom<20)from=Math.max(doc.first,display.showingFrom);if(display.showingTo>to&&display.showingTo-to<20)to=Math.min(end,display.showingTo);if(sawCollapsedSpans){from=lineNo(visualLine(doc,getLine(doc,from)));while(to<end&&lineIsHidden(doc,getLine(doc,to)))++to}var intact=[{from:Math.max(display.showingFrom,doc.first),to:Math.min(display.showingTo,end)}];if(intact[0].from>=intact[0].to)intact=[];else intact=computeIntact(intact,changes);if(sawCollapsedSpans)for(var i=0;i<intact.length;++i){var range=intact[i],merged;while(merged=collapsedSpanAtEnd(getLine(doc,range.to-1))){var newTo=merged.find().from.line;if(newTo>range.from)range.to=newTo;else{intact.splice(i--,1);break}}}var intactLines=0;for(var i=0;i<intact.length;++i){var range=intact[i];if(range.from<from)range.from=from;if(range.to>to)range.to=to;if(range.from>=range.to)intact.splice(i--,1);else intactLines+=range.to-range.from}if(intactLines==to-from&&from==display.showingFrom&&to==display.showingTo){updateViewOffset(cm);return}intact.sort(function(a,b){return a.from-b.from});try{var focused=document.activeElement}catch(e){}if(intactLines<(to-from)*.7)display.lineDiv.style.display=\"none\";patchDisplay(cm,from,to,intact,positionsChangedFrom);display.lineDiv.style.display=\"\";if(focused&&document.activeElement!=focused&&focused.offsetHeight)focused.focus();var different=from!=display.showingFrom||to!=display.showingTo||display.lastSizeC!=display.wrapper.clientHeight;if(different)display.lastSizeC=display.wrapper.clientHeight;display.showingFrom=from;display.showingTo=to;startWorker(cm,100);var prevBottom=display.lineDiv.offsetTop;for(var node=display.lineDiv.firstChild,height;node;node=node.nextSibling)if(node.lineObj){if(ie_lt8){var bot=node.offsetTop+node.offsetHeight;height=bot-prevBottom;prevBottom=bot}else{var box=getRect(node);height=box.bottom-box.top}var diff=node.lineObj.height-height;if(height<2)height=textHeight(display);if(diff>.001||diff<-.001){updateLineHeight(node.lineObj,height);var widgets=node.lineObj.widgets;if(widgets)for(var i=0;i<widgets.length;++i)widgets[i].height=widgets[i].node.offsetHeight}}updateViewOffset(cm);return true}function updateViewOffset(cm){var off=cm.display.viewOffset=heightAtLine(cm,getLine(cm.doc,cm.display.showingFrom));cm.display.mover.style.top=off+\"px\"}function computeIntact(intact,changes){for(var i=0,l=changes.length||0;i<l;++i){var change=changes[i],intact2=[],diff=change.diff||0;for(var j=0,l2=intact.length;j<l2;++j){var range=intact[j];if(change.to<=range.from&&change.diff){intact2.push({from:range.from+diff,to:range.to+diff})}else if(change.to<=range.from||change.from>=range.to){intact2.push(range)}else{if(change.from>range.from)intact2.push({from:range.from,to:change.from});if(change.to<range.to)intact2.push({from:change.to+diff,to:range.to+diff})}}intact=intact2}return intact}function getDimensions(cm){var d=cm.display,left={},width={};for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){left[cm.options.gutters[i]]=n.offsetLeft;width[cm.options.gutters[i]]=n.offsetWidth}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,from,to,intact,updateNumbersFrom){var dims=getDimensions(cm);var display=cm.display,lineNumbers=cm.options.lineNumbers;if(!intact.length&&(!webkit||!cm.display.currentWheelTarget))removeChildren(display.lineDiv);var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;if(webkit&&mac&&cm.display.currentWheelTarget==node){node.style.display=\"none\";node.lineObj=null}else{node.parentNode.removeChild(node)}return next}var nextIntact=intact.shift(),lineN=from;cm.doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==lineN)nextIntact=intact.shift();if(lineIsHidden(cm.doc,line)){if(line.height!=0)updateLineHeight(line,0);if(line.widgets&&cur.previousSibling)for(var i=0;i<line.widgets.length;++i){var w=line.widgets[i];if(w.showIfHidden){var prev=cur.previousSibling;if(/pre/i.test(prev.nodeName)){var wrap=elt(\"div\",null,null,\"position: relative\");prev.parentNode.replaceChild(wrap,prev);wrap.appendChild(prev);prev=wrap}var wnode=prev.appendChild(elt(\"div\",[w.node],\"CodeMirror-linewidget\"));if(!w.handleMouseEvents)wnode.ignoreEvents=true;positionLineWidget(w,wnode,prev,dims)}}}else if(nextIntact&&nextIntact.from<=lineN&&nextIntact.to>lineN){while(cur.lineObj!=line)cur=rm(cur);if(lineNumbers&&updateNumbersFrom<=lineN&&cur.lineNumber)setTextContent(cur.lineNumber,lineNumberFor(cm.options,lineN));cur=cur.nextSibling}else{if(line.widgets)for(var j=0,search=cur,reuse;search&&j<20;++j,search=search.nextSibling)if(search.lineObj==line&&/div/i.test(search.nodeName)){reuse=search;break}var lineNode=buildLineElement(cm,line,lineN,dims,reuse);if(lineNode!=reuse){container.insertBefore(lineNode,cur)}else{while(cur!=reuse)cur=rm(cur);cur=cur.nextSibling}lineNode.lineObj=line}++lineN});while(cur)cur=rm(cur)}function buildLineElement(cm,line,lineNo,dims,reuse){var lineElement=lineContent(cm,line);var markers=line.gutterMarkers,display=cm.display,wrap;if(!cm.options.lineNumbers&&!markers&&!line.bgClass&&!line.wrapClass&&!line.widgets)return lineElement;if(reuse){reuse.alignable=null;var isOk=true,widgetsSeen=0,insertBefore=null;for(var n=reuse.firstChild,next;n;n=next){next=n.nextSibling;if(!/\\bCodeMirror-linewidget\\b/.test(n.className)){reuse.removeChild(n)}else{for(var i=0,first=true;i<line.widgets.length;++i){var widget=line.widgets[i];if(!widget.above){insertBefore=n;first=false}if(widget.node==n.firstChild){positionLineWidget(widget,n,reuse,dims);++widgetsSeen;break}}if(i==line.widgets.length){isOk=false;break}}}reuse.insertBefore(lineElement,insertBefore);if(isOk&&widgetsSeen==line.widgets.length){wrap=reuse;reuse.className=line.wrapClass||\"\"}}if(!wrap){wrap=elt(\"div\",null,line.wrapClass,\"position: relative\");wrap.appendChild(lineElement)}if(line.bgClass)wrap.insertBefore(elt(\"div\",null,line.bgClass+\" CodeMirror-linebackground\"),wrap.firstChild);if(cm.options.lineNumbers||markers){var gutterWrap=wrap.insertBefore(elt(\"div\",null,null,\"position: absolute; left: \"+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+\"px\"),wrap.firstChild);if(cm.options.fixedGutter)(wrap.alignable||(wrap.alignable=[])).push(gutterWrap);if(cm.options.lineNumbers&&(!markers||!markers[\"CodeMirror-linenumbers\"]))wrap.lineNumber=gutterWrap.appendChild(elt(\"div\",lineNumberFor(cm.options,lineNo),\"CodeMirror-linenumber CodeMirror-gutter-elt\",\"left: \"+dims.gutterLeft[\"CodeMirror-linenumbers\"]+\"px; width: \"+display.lineNumInnerWidth+\"px\"));if(markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];if(found)gutterWrap.appendChild(elt(\"div\",[found],\"CodeMirror-gutter-elt\",\"left: \"+dims.gutterLeft[id]+\"px; width: \"+dims.gutterWidth[id]+\"px\"))}}if(ie_lt8)wrap.style.zIndex=2;if(line.widgets&&wrap!=reuse)for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt(\"div\",[widget.node],\"CodeMirror-linewidget\");if(!widget.handleMouseEvents)node.ignoreEvents=true;positionLineWidget(widget,node,wrap,dims);if(widget.above)wrap.insertBefore(node,cm.options.lineNumbers&&line.height!=0?gutterWrap:lineElement);else wrap.appendChild(node);signalLater(widget,\"redraw\")}return wrap}function positionLineWidget(widget,node,wrap,dims){if(widget.noHScroll){(wrap.alignable||(wrap.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+\"px\";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+\"px\"}node.style.width=width+\"px\"}if(widget.coverGutter){node.style.zIndex=5;node.style.position=\"relative\";if(!widget.noHScroll)node.style.marginLeft=-dims.gutterTotalWidth+\"px\"}}function updateSelection(cm){var display=cm.display;var collapsed=posEq(cm.doc.sel.from,cm.doc.sel.to);if(collapsed||cm.options.showCursorWhenSelecting)updateSelectionCursor(cm);else display.cursor.style.display=display.otherCursor.style.display=\"none\";if(!collapsed)updateSelectionRange(cm);else display.selectionDiv.style.display=\"none\";if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,cm.doc.sel.head,\"div\");var wrapOff=getRect(display.wrapper),lineOff=getRect(display.lineDiv);display.inputDiv.style.top=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top))+\"px\";display.inputDiv.style.left=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))+\"px\"}}function updateSelectionCursor(cm){var display=cm.display,pos=cursorCoords(cm,cm.doc.sel.head,\"div\");display.cursor.style.left=pos.left+\"px\";display.cursor.style.top=pos.top+\"px\";display.cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+\"px\";display.cursor.style.display=\"\";if(pos.other){display.otherCursor.style.display=\"\";display.otherCursor.style.left=pos.other.left+\"px\";display.otherCursor.style.top=pos.other.top+\"px\";display.otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+\"px\"}else{display.otherCursor.style.display=\"none\"}}function updateSelectionRange(cm){var display=cm.display,doc=cm.doc,sel=cm.doc.sel;var fragment=document.createDocumentFragment();var clientWidth=display.lineSpace.offsetWidth,pl=paddingLeft(cm.display);function add(left,top,width,bottom){if(top<0)top=0;fragment.appendChild(elt(\"div\",null,\"CodeMirror-selected\",\"position: absolute; left: \"+left+\"px; top: \"+top+\"px; width: \"+(width==null?clientWidth-left:width)+\"px; height: \"+(bottom-top)+\"px\"))}function drawForLine(line,fromArg,toArg,retTop){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length,rVal=retTop?Infinity:-Infinity;function coords(ch){return charCoords(cm,Pos(line,ch),\"div\",lineObj)}iterateBidiSections(getOrder(lineObj),fromArg||0,toArg==null?lineLen:toArg,function(from,to,dir){var leftPos=coords(from),rightPos,left,right;if(from==to){rightPos=leftPos;left=right=leftPos.left}else{rightPos=coords(to-1);if(dir==\"rtl\"){var tmp=leftPos;leftPos=rightPos;rightPos=tmp}left=leftPos.left;right=rightPos.right}if(rightPos.top-leftPos.top>3){add(left,leftPos.top,null,leftPos.bottom);left=pl;if(leftPos.bottom<rightPos.top)add(left,leftPos.bottom,null,rightPos.top)}if(toArg==null&&to==lineLen)right=clientWidth;if(fromArg==null&&from==0)left=pl;rVal=retTop?Math.min(rightPos.top,rVal):Math.max(rightPos.bottom,rVal);if(left<pl+1)left=pl;add(left,rightPos.top,right-left,rightPos.bottom)});return rVal}if(sel.from.line==sel.to.line){drawForLine(sel.from.line,sel.from.ch,sel.to.ch)}else{var fromObj=getLine(doc,sel.from.line);var cur=fromObj,merged,path=[sel.from.line,sel.from.ch],singleLine;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();path.push(found.from.ch,found.to.line,found.to.ch);if(found.to.line==sel.to.line){path.push(sel.to.ch);singleLine=true;break}cur=getLine(doc,found.to.line)}if(singleLine){for(var i=0;i<path.length;i+=3)drawForLine(path[i],path[i+1],path[i+2])}else{var middleTop,middleBot,toObj=getLine(doc,sel.to.line);if(sel.from.ch)middleTop=drawForLine(sel.from.line,sel.from.ch,null,false);else middleTop=heightAtLine(cm,fromObj)-display.viewOffset;if(!sel.to.ch)middleBot=heightAtLine(cm,toObj)-display.viewOffset;else middleBot=drawForLine(sel.to.line,collapsedSpanAtStart(toObj)?null:0,sel.to.ch,true);if(middleTop<middleBot)add(pl,middleTop,null,middleBot)}}removeChildrenAndAdd(display.selectionDiv,fragment);display.selectionDiv.style.display=\"\"}function restartBlink(cm){if(!cm.state.focused)return;var display=cm.display;clearInterval(display.blinker);var on=true;display.cursor.style.visibility=display.otherCursor.style.visibility=\"\";display.blinker=setInterval(function(){display.cursor.style.visibility=display.otherCursor.style.visibility=(on=!on)?\"\":\"hidden\"},cm.options.cursorBlinkRate)}function startWorker(cm,time){if(cm.doc.mode.startState&&cm.doc.frontier<cm.display.showingTo)cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first)doc.frontier=doc.first;if(doc.frontier>=cm.display.showingTo)return;var end=+new Date+cm.options.workTime;var state=copyState(doc.mode,getStateBefore(cm,doc.frontier));var changed=[],prevChange;doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.showingTo+500),function(line){if(doc.frontier>=cm.display.showingFrom){var oldStyles=line.styles;line.styles=highlightLine(cm,line,state);var ischange=!oldStyles||oldStyles.length!=line.styles.length;for(var i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];if(ischange){if(prevChange&&prevChange.end==doc.frontier)prevChange.end++;else changed.push(prevChange={start:doc.frontier,end:doc.frontier+1})}line.stateAfter=copyState(doc.mode,state)}else{processLine(cm,line,state);line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null}++doc.frontier;if(+new Date>end){startWorker(cm,cm.options.workDelay);return true}});if(changed.length)operation(cm,function(){for(var i=0;i<changed.length;++i)regChange(this,changed[i].start,changed[i].end)})()}function findStartLine(cm,n){var minindent,minline,doc=cm.doc;for(var search=n,lim=n-100;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter)return search;var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented}}return minline}function getStateBefore(cm,n){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return true;var pos=findStartLine(cm,n),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;if(!state)state=startState(doc.mode);else state=copyState(doc.mode,state);doc.iter(pos,n,function(line){processLine(cm,line,state);var save=pos==n-1||pos%5==0||pos>=display.showingFrom&&pos<display.showingTo;line.stateAfter=save?copyState(doc.mode,state):null;++pos});return state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingLeft(display){var e=removeChildrenAndAdd(display.measure,elt(\"pre\",null,null,\"text-align: left\")).appendChild(elt(\"span\",\"x\"));return e.offsetLeft}function measureChar(cm,line,ch,data){var dir=-1;data=data||measureLine(cm,line);for(var pos=ch;;pos+=dir){var r=data[pos];if(r)break;if(dir<0&&pos==0)dir=1}return{left:pos<ch?r.right:r.left,right:pos>ch?r.left:r.right,top:r.top,bottom:r.bottom}}function findCachedMeasurement(cm,line){var cache=cm.display.measureLineCache;for(var i=0;i<cache.length;++i){var memo=cache[i];if(memo.text==line.text&&memo.markedSpans==line.markedSpans&&cm.display.scroller.clientWidth==memo.width&&memo.classes==line.textClass+\"|\"+line.bgClass+\"|\"+line.wrapClass)return memo}}function clearCachedMeasurement(cm,line){var exists=findCachedMeasurement(cm,line);if(exists)exists.text=exists.measure=exists.markedSpans=null}function measureLine(cm,line){var cached=findCachedMeasurement(cm,line);if(cached)return cached.measure;var measure=measureLineInner(cm,line);var cache=cm.display.measureLineCache;var memo={text:line.text,width:cm.display.scroller.clientWidth,markedSpans:line.markedSpans,measure:measure,classes:line.textClass+\"|\"+line.bgClass+\"|\"+line.wrapClass};if(cache.length==16)cache[++cm.display.measureLineCachePos%16]=memo;else cache.push(memo);return measure}function measureLineInner(cm,line){var display=cm.display,measure=emptyArray(line.text.length);var pre=lineContent(cm,line,measure);if(ie&&!ie_lt8&&!cm.options.lineWrapping&&pre.childNodes.length>100){var fragment=document.createDocumentFragment();var chunk=10,n=pre.childNodes.length;for(var i=0,chunks=Math.ceil(n/chunk);i<chunks;++i){var wrap=elt(\"div\",null,null,\"display: inline-block\");for(var j=0;j<chunk&&n;++j){wrap.appendChild(pre.firstChild);--n}fragment.appendChild(wrap)}pre.appendChild(fragment)}removeChildrenAndAdd(display.measure,pre);var outer=getRect(display.lineDiv);var vranges=[],data=emptyArray(line.text.length),maxBot=pre.offsetHeight;if(ie_lt9&&display.measure.first!=pre)removeChildrenAndAdd(display.measure,pre);for(var i=0,cur;i<measure.length;++i)if(cur=measure[i]){var size=getRect(cur);var top=Math.max(0,size.top-outer.top),bot=Math.min(size.bottom-outer.top,maxBot);for(var j=0;j<vranges.length;j+=2){var rtop=vranges[j],rbot=vranges[j+1];if(rtop>bot||rbot<top)continue;if(rtop<=top&&rbot>=bot||top<=rtop&&bot>=rbot||Math.min(bot,rbot)-Math.max(top,rtop)>=bot-top>>1){vranges[j]=Math.min(top,rtop);vranges[j+1]=Math.max(bot,rbot);break}}if(j==vranges.length)vranges.push(top,bot);var right=size.right;if(cur.measureRight)right=getRect(cur.measureRight).left;data[i]={left:size.left-outer.left,right:right-outer.left,top:j}}for(var i=0,cur;i<data.length;++i)if(cur=data[i]){var vr=cur.top;cur.top=vranges[vr];cur.bottom=vranges[vr+1]}return data}function measureLineWidth(cm,line){var hasBadSpan=false;if(line.markedSpans)for(var i=0;i<line.markedSpans;++i){var sp=line.markedSpans[i];if(sp.collapsed&&(sp.to==null||sp.to==line.text.length))hasBadSpan=true}var cached=!hasBadSpan&&findCachedMeasurement(cm,line);if(cached)return measureChar(cm,line,line.text.length,cached.measure).right;var pre=lineContent(cm,line);var end=pre.appendChild(zeroWidthElement(cm.display.measure));removeChildrenAndAdd(cm.display.measure,pre);return getRect(end).right-getRect(cm.display.lineDiv).left}function clearCaches(cm){cm.display.measureLineCache.length=cm.display.measureLineCachePos=0;cm.display.cachedCharWidth=cm.display.cachedTextHeight=null;if(!cm.options.lineWrapping)cm.display.maxLineChanged=true;cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size;rect.bottom+=size}if(context==\"line\")return rect;if(!context)context=\"local\";var yOff=heightAtLine(cm,lineObj);if(context==\"local\")yOff+=paddingTop(cm.display);else yOff-=cm.display.viewOffset;if(context==\"page\"||context==\"window\"){var lOff=getRect(cm.display.lineSpace);yOff+=lOff.top+(context==\"window\"?0:pageScrollY());var xOff=lOff.left+(context==\"window\"?0:pageScrollX());rect.left+=xOff;rect.right+=xOff}rect.top+=yOff;rect.bottom+=yOff;return rect}function fromCoordSystem(cm,coords,context){if(context==\"div\")return coords;var left=coords.left,top=coords.top;if(context==\"page\"){left-=pageScrollX();top-=pageScrollY()}else if(context==\"local\"||!context){var localBox=getRect(cm.display.sizer);left+=localBox.left;top+=localBox.top}var lineSpaceBox=getRect(cm.display.lineSpace);return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj){if(!lineObj)lineObj=getLine(cm.doc,pos.line);return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch),context)}function cursorCoords(cm,pos,context,lineObj,measurement){lineObj=lineObj||getLine(cm.doc,pos.line);if(!measurement)measurement=measureLine(cm,lineObj);function get(ch,right){var m=measureChar(cm,lineObj,ch,measurement);if(right)m.left=m.right;else m.right=m.left;return intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;if(ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level){part=order[--partPos];ch=bidiRight(part)-(part.level%2?0:1);right=true}else if(ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level){part=order[++partPos];ch=bidiLeft(part)-part.level%2;right=false}if(right&&ch==part.to&&ch>part.from)return get(ch-1);return get(ch,right)}var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch);var val=getBidi(ch,partPos);if(bidiOther!=null)val.other=getBidi(ch,bidiOther);return val}function PosMaybeOutside(line,ch,outside){var pos=new Pos(line,ch);if(outside)pos.outside=true;return pos}function coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0)return PosMaybeOutside(doc.first,0,true);var lineNo=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineNo>last)return PosMaybeOutside(doc.first+doc.size-1,getLine(doc,last).text.length,true);if(x<0)x=0;for(;;){var lineObj=getLine(doc,lineNo);var found=coordsCharInner(cm,lineObj,lineNo,x,y);var merged=collapsedSpanAtEnd(lineObj);var mergedPos=merged&&merged.find();if(merged&&found.ch>=mergedPos.from.ch)lineNo=mergedPos.to.line;else return found}}function coordsCharInner(cm,lineObj,lineNo,x,y){var innerOff=y-heightAtLine(cm,lineObj);var wrongLine=false,adjust=2*cm.display.wrapper.clientWidth;var measurement=measureLine(cm,lineObj);function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),\"line\",lineObj,measurement);wrongLine=true;if(innerOff>sp.bottom)return sp.left-adjust;else if(innerOff<sp.top)return sp.left+adjust;else wrongLine=false;return sp.left}var bidi=getOrder(lineObj),dist=lineObj.text.length;var from=lineLeft(lineObj),to=lineRight(lineObj);var fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosMaybeOutside(lineNo,to,toOutside);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):to-from<=1){var after=x-fromX<toX-x,ch=after?from:to;while(isExtendingChar.test(lineObj.text.charAt(ch)))++ch;var pos=PosMaybeOutside(lineNo,ch,after?fromOutside:toOutside);pos.after=after;return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;if(toOutside=wrongLine)toX+=1e3;dist=step}else{from=middle;fromX=middleX;fromOutside=wrongLine;dist-=step}}}var measureText;function textHeight(display){if(display.cachedTextHeight!=null)return display.cachedTextHeight;if(measureText==null){measureText=elt(\"pre\");for(var i=0;i<49;++i){measureText.appendChild(document.createTextNode(\"x\"));measureText.appendChild(elt(\"br\"))}measureText.appendChild(document.createTextNode(\"x\"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3)display.cachedTextHeight=height;removeChildren(display.measure);return height||1}function charWidth(display){if(display.cachedCharWidth!=null)return display.cachedCharWidth;var anchor=elt(\"span\",\"x\");var pre=elt(\"pre\",[anchor]);removeChildrenAndAdd(display.measure,pre);var width=anchor.offsetWidth;if(width>2)display.cachedCharWidth=width;return width||10}var nextOpId=0;function startOperation(cm){cm.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:false,cursorActivity:false,updateMaxLine:false,updateScrollPos:false,id:++nextOpId};if(!delayedCallbackDepth++)delayedCallbacks=[]}function endOperation(cm){var op=cm.curOp,doc=cm.doc,display=cm.display;cm.curOp=null;if(op.updateMaxLine)computeMaxLength(cm);if(display.maxLineChanged&&!cm.options.lineWrapping&&display.maxLine){var width=measureLineWidth(cm,display.maxLine);display.sizer.style.minWidth=Math.max(0,width+3+scrollerCutOff)+\"px\";display.maxLineChanged=false;var maxScrollLeft=Math.max(0,display.sizer.offsetLeft+display.sizer.offsetWidth-display.scroller.clientWidth);if(maxScrollLeft<doc.scrollLeft&&!op.updateScrollPos)setScrollLeft(cm,Math.min(display.scroller.scrollLeft,maxScrollLeft),true)}var newScrollPos,updated;if(op.updateScrollPos){newScrollPos=op.updateScrollPos}else if(op.selectionChanged&&display.scroller.clientHeight){var coords=cursorCoords(cm,doc.sel.head);newScrollPos=calculateScrollPos(cm,coords.left,coords.top,coords.left,coords.bottom)}if(op.changes.length||newScrollPos&&newScrollPos.scrollTop!=null){updated=updateDisplay(cm,op.changes,newScrollPos&&newScrollPos.scrollTop);if(cm.display.scroller.offsetHeight)cm.doc.scrollTop=cm.display.scroller.scrollTop}if(!updated&&op.selectionChanged)updateSelection(cm);if(op.updateScrollPos){display.scroller.scrollTop=display.scrollbarV.scrollTop=doc.scrollTop=newScrollPos.scrollTop;display.scroller.scrollLeft=display.scrollbarH.scrollLeft=doc.scrollLeft=newScrollPos.scrollLeft;alignHorizontally(cm);if(op.scrollToPos)scrollPosIntoView(cm,clipPos(cm.doc,op.scrollToPos),op.scrollToPosMargin)}else if(newScrollPos){scrollCursorIntoView(cm)}if(op.selectionChanged)restartBlink(cm);if(cm.state.focused&&op.updateInput)resetInput(cm,op.userSelChange);var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)if(!hidden[i].lines.length)signal(hidden[i],\"hide\");if(unhidden)for(var i=0;i<unhidden.length;++i)if(unhidden[i].lines.length)signal(unhidden[i],\"unhide\");var delayed;if(!--delayedCallbackDepth){delayed=delayedCallbacks;delayedCallbacks=null}if(op.textChanged)signal(cm,\"change\",cm,op.textChanged);if(op.cursorActivity)signal(cm,\"cursorActivity\",cm);if(delayed)for(var i=0;i<delayed.length;++i)delayed[i]()}function operation(cm1,f){return function(){var cm=cm1||this,withOp=!cm.curOp;if(withOp)startOperation(cm);try{var result=f.apply(cm,arguments)}finally{if(withOp)endOperation(cm)}return result}}function docOperation(f){return function(){var withOp=this.cm&&!this.cm.curOp,result;if(withOp)startOperation(this.cm);try{result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}function runInOp(cm,f){var withOp=!cm.curOp,result;if(withOp)startOperation(cm);try{result=f()}finally{if(withOp)endOperation(cm)}return result}function regChange(cm,from,to,lendiff){if(from==null)from=cm.doc.first;if(to==null)to=cm.doc.first+cm.doc.size;cm.curOp.changes.push({from:from,to:to,diff:lendiff})}function slowPoll(cm){if(cm.display.pollingFast)return;cm.display.poll.set(cm.options.pollInterval,function(){readInput(cm);if(cm.state.focused)slowPoll(cm)})}function fastPoll(cm){var missed=false;cm.display.pollingFast=true;function p(){var changed=readInput(cm);if(!changed&&!missed){missed=true;cm.display.poll.set(60,p)}else{cm.display.pollingFast=false;slowPoll(cm)}}cm.display.poll.set(20,p)}function readInput(cm){var input=cm.display.input,prevInput=cm.display.prevInput,doc=cm.doc,sel=doc.sel;if(!cm.state.focused||hasSelection(input)||isReadOnly(cm))return false;var text=input.value;if(text==prevInput&&posEq(sel.from,sel.to))return false;if(ie&&!ie_lt9&&cm.display.inputHasSelection===text){resetInput(cm,true);return false}var withOp=!cm.curOp;if(withOp)startOperation(cm);sel.shift=false;var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same))++same;var from=sel.from,to=sel.to;if(same<prevInput.length)from=Pos(from.line,from.ch-(prevInput.length-same));else if(cm.state.overwrite&&posEq(from,to)&&!cm.state.pasteIncoming)to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+(text.length-same)));var updateInput=cm.curOp.updateInput;makeChange(cm.doc,{from:from,to:to,text:splitLines(text.slice(same)),origin:cm.state.pasteIncoming?\"paste\":\"+input\"},\"end\");cm.curOp.updateInput=updateInput;if(text.length>1e3||text.indexOf(\"\\n\")>-1)input.value=cm.display.prevInput=\"\";else cm.display.prevInput=text;\nif(withOp)endOperation(cm);cm.state.pasteIncoming=false;return true}function resetInput(cm,user){var minimal,selected,doc=cm.doc;if(!posEq(doc.sel.from,doc.sel.to)){cm.display.prevInput=\"\";minimal=hasCopyEvent&&(doc.sel.to.line-doc.sel.from.line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?\"-\":selected||cm.getSelection();cm.display.input.value=content;if(cm.state.focused)selectInput(cm.display.input);if(ie&&!ie_lt9)cm.display.inputHasSelection=content}else if(user){cm.display.prevInput=cm.display.input.value=\"\";if(ie&&!ie_lt9)cm.display.inputHasSelection=null}cm.display.inaccurateSelection=minimal}function focusInput(cm){if(cm.options.readOnly!=\"nocursor\"&&(!mobile||document.activeElement!=cm.display.input))cm.display.input.focus()}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function registerEventHandlers(cm){var d=cm.display;on(d.scroller,\"mousedown\",operation(cm,onMouseDown));if(ie)on(d.scroller,\"dblclick\",operation(cm,function(e){var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);var word=findWordAt(getLine(cm.doc,pos.line).text,pos);extendSelection(cm.doc,word.from,word.to)}));else on(d.scroller,\"dblclick\",e_preventDefault);on(d.lineSpace,\"selectstart\",function(e){if(!eventInWidget(d,e))e_preventDefault(e)});if(!captureMiddleClick)on(d.scroller,\"contextmenu\",function(e){onContextMenu(cm,e)});on(d.scroller,\"scroll\",function(){if(d.scroller.clientHeight){setScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,\"scroll\",cm)}});on(d.scrollbarV,\"scroll\",function(){if(d.scroller.clientHeight)setScrollTop(cm,d.scrollbarV.scrollTop)});on(d.scrollbarH,\"scroll\",function(){if(d.scroller.clientHeight)setScrollLeft(cm,d.scrollbarH.scrollLeft)});on(d.scroller,\"mousewheel\",function(e){onScrollWheel(cm,e)});on(d.scroller,\"DOMMouseScroll\",function(e){onScrollWheel(cm,e)});function reFocus(){if(cm.state.focused)setTimeout(bind(focusInput,cm),0)}on(d.scrollbarH,\"mousedown\",reFocus);on(d.scrollbarV,\"mousedown\",reFocus);on(d.wrapper,\"scroll\",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0});var resizeTimer;function onResize(){if(resizeTimer==null)resizeTimer=setTimeout(function(){resizeTimer=null;d.cachedCharWidth=d.cachedTextHeight=knownScrollbarWidth=null;clearCaches(cm);runInOp(cm,bind(regChange,cm))},100)}on(window,\"resize\",onResize);function unregister(){for(var p=d.wrapper.parentNode;p&&p!=document.body;p=p.parentNode){}if(p)setTimeout(unregister,5e3);else off(window,\"resize\",onResize)}setTimeout(unregister,5e3);on(d.input,\"keyup\",operation(cm,function(e){if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;if(e.keyCode==16)cm.doc.sel.shift=false}));on(d.input,\"input\",bind(fastPoll,cm));on(d.input,\"keydown\",operation(cm,onKeyDown));on(d.input,\"keypress\",operation(cm,onKeyPress));on(d.input,\"focus\",bind(onFocus,cm));on(d.input,\"blur\",bind(onBlur,cm));function drag_(e){if(cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_stop(e)}if(cm.options.dragDrop){on(d.scroller,\"dragstart\",function(e){onDragStart(cm,e)});on(d.scroller,\"dragenter\",drag_);on(d.scroller,\"dragover\",drag_);on(d.scroller,\"drop\",operation(cm,onDrop))}on(d.scroller,\"paste\",function(e){if(eventInWidget(d,e))return;focusInput(cm);fastPoll(cm)});on(d.input,\"paste\",function(){cm.state.pasteIncoming=true;fastPoll(cm)});function prepareCopy(){if(d.inaccurateSelection){d.prevInput=\"\";d.inaccurateSelection=false;d.input.value=cm.getSelection();selectInput(d.input)}}on(d.input,\"cut\",prepareCopy);on(d.input,\"copy\",prepareCopy);if(khtml)on(d.sizer,\"mouseup\",function(){if(document.activeElement==d.input)d.input.blur();focusInput(cm)})}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n||n.ignoreEvents||n.parentNode==display.sizer&&n!=display.mover)return true}}function posFromMouse(cm,e,liberal){var display=cm.display;if(!liberal){var target=e_target(e);if(target==display.scrollbarH||target==display.scrollbarH.firstChild||target==display.scrollbarV||target==display.scrollbarV.firstChild||target==display.scrollbarFiller||target==display.gutterFiller)return null}var x,y,space=getRect(display.lineSpace);try{x=e.clientX;y=e.clientY}catch(e){return null}return coordsChar(cm,x-space.left,y-space.top)}var lastClick,lastDoubleClick;function onMouseDown(e){var cm=this,display=cm.display,doc=cm.doc,sel=doc.sel;sel.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){display.scroller.draggable=false;setTimeout(function(){display.scroller.draggable=true},100)}return}if(clickInGutter(cm,e))return;var start=posFromMouse(cm,e);switch(e_button(e)){case 3:if(captureMiddleClick)onContextMenu.call(cm,cm,e);return;case 2:if(start)extendSelection(cm.doc,start);setTimeout(bind(focusInput,cm),20);e_preventDefault(e);return}if(!start){if(e_target(e)==display.scroller)e_preventDefault(e);return}if(!cm.state.focused)onFocus(cm);var now=+new Date,type=\"single\";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start)){type=\"triple\";e_preventDefault(e);setTimeout(bind(focusInput,cm),20);selectLine(cm,start.line)}else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type=\"double\";lastDoubleClick={time:now,pos:start};e_preventDefault(e);var word=findWordAt(getLine(doc,start.line).text,start);extendSelection(cm.doc,word.from,word.to)}else{lastClick={time:now,pos:start}}var last=start;if(cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&type==\"single\"){var dragEnd=operation(cm,function(e2){if(webkit)display.scroller.draggable=false;cm.state.draggingText=false;off(document,\"mouseup\",dragEnd);off(display.scroller,\"drop\",dragEnd);if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);extendSelection(cm.doc,start);focusInput(cm)}});if(webkit)display.scroller.draggable=true;cm.state.draggingText=dragEnd;if(display.scroller.dragDrop)display.scroller.dragDrop();on(document,\"mouseup\",dragEnd);on(display.scroller,\"drop\",dragEnd);return}e_preventDefault(e);if(type==\"single\")extendSelection(cm.doc,clipPos(doc,start));var startstart=sel.from,startend=sel.to,lastPos=start;function doSelect(cur){if(posEq(lastPos,cur))return;lastPos=cur;if(type==\"single\"){extendSelection(cm.doc,clipPos(doc,start),cur);return}startstart=clipPos(doc,startstart);startend=clipPos(doc,startend);if(type==\"double\"){var word=findWordAt(getLine(doc,cur.line).text,cur);if(posLess(cur,startstart))extendSelection(cm.doc,word.from,startend);else extendSelection(cm.doc,startstart,word.to)}else if(type==\"triple\"){if(posLess(cur,startstart))extendSelection(cm.doc,startend,clipPos(doc,Pos(cur.line,0)));else extendSelection(cm.doc,startstart,clipPos(doc,Pos(cur.line+1,0)))}}var editorSize=getRect(display.wrapper);var counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true);if(!cur)return;if(!posEq(cur,last)){if(!cm.state.focused)onFocus(cm);last=cur;doSelect(cur);var visible=visibleLines(display,doc);if(cur.line>=visible.to||cur.line<visible.from)setTimeout(operation(cm,function(){if(counter==curCount)extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside)setTimeout(operation(cm,function(){if(counter!=curCount)return;display.scroller.scrollTop+=outside;extend(e)}),50)}}function done(e){counter=Infinity;e_preventDefault(e);focusInput(cm);off(document,\"mousemove\",move);off(document,\"mouseup\",up)}var move=operation(cm,function(e){if(!ie&&!e_button(e))done(e);else extend(e)});var up=operation(cm,done);on(document,\"mousemove\",move);on(document,\"mouseup\",up)}function clickInGutter(cm,e){var display=cm.display;try{var mX=e.clientX,mY=e.clientY}catch(e){return false}if(mX>=Math.floor(getRect(display.gutters).right))return false;e_preventDefault(e);if(!hasHandler(cm,\"gutterClick\"))return true;var lineBox=getRect(display.lineDiv);if(mY>lineBox.bottom)return true;mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&getRect(g).right>=mX){var line=lineAtHeight(cm.doc,mY);var gutter=cm.options.gutters[i];signalLater(cm,\"gutterClick\",cm,line,gutter,e);break}}return true}var lastDrop=0;function onDrop(e){var cm=this;if(eventInWidget(cm.display,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_preventDefault(e);if(ie)lastDrop=+new Date;var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||isReadOnly(cm))return;if(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var loadFile=function(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result;if(++read==n){pos=clipPos(cm.doc,pos);makeChange(cm.doc,{from:pos,to:pos,text:splitLines(text.join(\"\\n\")),origin:\"paste\"},\"around\")}};reader.readAsText(file)};for(var i=0;i<n;++i)loadFile(files[i],i)}else{if(cm.state.draggingText&&!(posLess(pos,cm.doc.sel.from)||posLess(cm.doc.sel.to,pos))){cm.state.draggingText(e);setTimeout(bind(focusInput,cm),20);return}try{var text=e.dataTransfer.getData(\"Text\");if(text){var curFrom=cm.doc.sel.from,curTo=cm.doc.sel.to;setSelection(cm.doc,pos,pos);if(cm.state.draggingText)replaceRange(cm.doc,\"\",curFrom,curTo,\"paste\");cm.replaceSelection(text,null,\"paste\");focusInput(cm);onFocus(cm)}}catch(e){}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100)){e_stop(e);return}if(eventInWidget(cm.display,e))return;var txt=cm.getSelection();e.dataTransfer.setData(\"Text\",txt);if(e.dataTransfer.setDragImage&&!safari){var img=elt(\"img\",null,null,\"position: fixed; left: 0; top: 0;\");if(opera){img.width=img.height=1;cm.display.wrapper.appendChild(img);img._top=img.offsetTop}e.dataTransfer.setDragImage(img,0,0);if(opera)img.parentNode.removeChild(img)}}function setScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2)return;cm.doc.scrollTop=val;if(!gecko)updateDisplay(cm,[],val);if(cm.display.scroller.scrollTop!=val)cm.display.scroller.scrollTop=val;if(cm.display.scrollbarV.scrollTop!=val)cm.display.scrollbarV.scrollTop=val;if(gecko)updateDisplay(cm,[])}function setScrollLeft(cm,val,isScroller){if(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)return;val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth);cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val)cm.display.scroller.scrollLeft=val;if(cm.display.scrollbarH.scrollLeft!=val)cm.display.scrollbarH.scrollLeft=val}var wheelSamples=0,wheelPixelsPerUnit=null;if(ie)wheelPixelsPerUnit=-.53;else if(gecko)wheelPixelsPerUnit=15;else if(chrome)wheelPixelsPerUnit=-.7;else if(safari)wheelPixelsPerUnit=-1/3;function onScrollWheel(cm,e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS)dx=e.detail;if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS)dy=e.detail;else if(dy==null)dy=e.wheelDelta;var display=cm.display,scroll=display.scroller;if(!(dx&&scroll.scrollWidth>scroll.clientWidth||dy&&scroll.scrollHeight>scroll.clientHeight))return;if(dy&&mac&&webkit){for(var cur=e.target;cur!=scroll;cur=cur.parentNode){if(cur.lineObj){cm.display.currentWheelTarget=cur;break}}}if(dx&&!gecko&&!opera&&wheelPixelsPerUnit!=null){if(dy)setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight)));setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth)));e_preventDefault(e);display.wheelStartX=null;return}if(dy&&wheelPixelsPerUnit!=null){var pixels=dy*wheelPixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0)top=Math.max(0,top+pixels-50);else bot=Math.min(cm.doc.height,bot+pixels+50);updateDisplay(cm,[],{top:top,bottom:bot})}if(wheelSamples<20){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout(function(){if(display.wheelStartX==null)return;var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample)return;wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples},200)}else{display.wheelDX+=dx;display.wheelDY+=dy}}}function doHandleBinding(cm,bound,dropShift){if(typeof bound==\"string\"){bound=commands[bound];if(!bound)return false}if(cm.display.pollingFast&&readInput(cm))cm.display.pollingFast=false;var doc=cm.doc,prevShift=doc.sel.shift,done=false;try{if(isReadOnly(cm))cm.state.suppressEdits=true;if(dropShift)doc.sel.shift=false;done=bound(cm)!=Pass}finally{doc.sel.shift=prevShift;cm.state.suppressEdits=false}return done}function allKeyMaps(cm){var maps=cm.state.keyMaps.slice(0);if(cm.options.extraKeys)maps.push(cm.options.extraKeys);maps.push(cm.options.keyMap);return maps}var maybeTransition;function handleKeyBinding(cm,e){var startMap=getKeyMap(cm.options.keyMap),next=startMap.auto;clearTimeout(maybeTransition);if(next&&!isModifierKey(e))maybeTransition=setTimeout(function(){if(getKeyMap(cm.options.keyMap)==startMap)cm.options.keyMap=next.call?next.call(null,cm):next},50);var name=keyName(e,true),handled=false;if(!name)return false;var keymaps=allKeyMaps(cm);if(e.shiftKey){handled=lookupKey(\"Shift-\"+name,keymaps,function(b){return doHandleBinding(cm,b,true)})||lookupKey(name,keymaps,function(b){if(typeof b==\"string\"&&/^go[A-Z]/.test(b))return doHandleBinding(cm,b)})}else{handled=lookupKey(name,keymaps,function(b){return doHandleBinding(cm,b)})}if(handled){e_preventDefault(e);restartBlink(cm);if(ie_lt9){e.oldKeyCode=e.keyCode;e.keyCode=0}}return handled}function handleCharBinding(cm,e,ch){var handled=lookupKey(\"'\"+ch+\"'\",allKeyMaps(cm),function(b){return doHandleBinding(cm,b,true)});if(handled){e_preventDefault(e);restartBlink(cm)}return handled}var lastStoppedKey=null;function onKeyDown(e){var cm=this;if(!cm.state.focused)onFocus(cm);if(ie&&e.keyCode==27){e.returnValue=false}if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var code=e.keyCode;cm.doc.sel.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(opera){lastStoppedKey=handled?code:null;if(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey))cm.replaceSelection(\"\")}}function onKeyPress(e){var cm=this;if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var keyCode=e.keyCode,charCode=e.charCode;if(opera&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return}if((opera&&(!e.which||e.which<10)||khtml)&&handleKeyBinding(cm,e))return;var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!isReadOnly(this)&&this.doc.mode.electricChars.indexOf(ch)>-1)setTimeout(operation(cm,function(){indentLine(cm,cm.doc.sel.to.line,\"smart\")}),75);if(handleCharBinding(cm,e,ch))return;if(ie&&!ie_lt9)cm.display.inputHasSelection=null;fastPoll(cm)}function onFocus(cm){if(cm.options.readOnly==\"nocursor\")return;if(!cm.state.focused){signal(cm,\"focus\",cm);cm.state.focused=true;if(cm.display.wrapper.className.search(/\\bCodeMirror-focused\\b/)==-1)cm.display.wrapper.className+=\" CodeMirror-focused\";resetInput(cm,true)}slowPoll(cm);restartBlink(cm)}function onBlur(cm){if(cm.state.focused){signal(cm,\"blur\",cm);cm.state.focused=false;cm.display.wrapper.className=cm.display.wrapper.className.replace(\" CodeMirror-focused\",\"\")}clearInterval(cm.display.blinker);setTimeout(function(){if(!cm.state.focused)cm.doc.sel.shift=false},150)}var detectingSelectAll;function onContextMenu(cm,e){var display=cm.display,sel=cm.doc.sel;if(eventInWidget(display,e))return;var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||opera)return;if(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))operation(cm,setSelection)(cm.doc,pos,pos);var oldCSS=display.input.style.cssText;display.inputDiv.style.position=\"absolute\";display.input.style.cssText=\"position: fixed; width: 30px; height: 30px; top: \"+(e.clientY-5)+\"px; left: \"+(e.clientX-5)+\"px; z-index: 1000; background: white; outline: none;\"+\"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);\";focusInput(cm);resetInput(cm,true);if(posEq(sel.from,sel.to))display.input.value=display.prevInput=\" \";function prepareSelectAllHack(){if(display.input.selectionStart!=null){var extval=display.input.value=\" \"+(posEq(sel.from,sel.to)?\"\":display.input.value);display.prevInput=\" \";display.input.selectionStart=1;display.input.selectionEnd=extval.length}}function rehide(){display.inputDiv.style.position=\"relative\";display.input.style.cssText=oldCSS;if(ie_lt9)display.scrollbarV.scrollTop=display.scroller.scrollTop=scrollPos;slowPoll(cm);if(display.input.selectionStart!=null){if(!ie||ie_lt9)prepareSelectAllHack();clearTimeout(detectingSelectAll);var i=0,poll=function(){if(display.prevInput==\" \"&&display.input.selectionStart==0)operation(cm,commands.selectAll)(cm);else if(i++<10)detectingSelectAll=setTimeout(poll,500);else resetInput(cm)};detectingSelectAll=setTimeout(poll,200)}}if(ie&&!ie_lt9)prepareSelectAllHack();if(captureMiddleClick){e_stop(e);var mouseup=function(){off(window,\"mouseup\",mouseup);setTimeout(rehide,20)};on(window,\"mouseup\",mouseup)}else{setTimeout(rehide,50)}}function changeEnd(change){if(!change.text)return change.to;return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0))}function clipPostChange(doc,change,pos){if(!posLess(change.from,pos))return clipPos(doc,pos);var diff=change.text.length-1-(change.to.line-change.from.line);if(pos.line>change.to.line+diff){var preLine=pos.line-diff,lastLine=doc.first+doc.size-1;if(preLine>lastLine)return Pos(lastLine,getLine(doc,lastLine).text.length);return clipToLen(pos,getLine(doc,preLine).text.length)}if(pos.line==change.to.line+diff)return clipToLen(pos,lst(change.text).length+(change.text.length==1?change.from.ch:0)+getLine(doc,change.to.line).text.length-change.to.ch);var inside=pos.line-change.from.line;return clipToLen(pos,change.text[inside].length+(inside?0:change.from.ch))}function computeSelAfterChange(doc,change,hint){if(hint&&typeof hint==\"object\")return{anchor:clipPostChange(doc,change,hint.anchor),head:clipPostChange(doc,change,hint.head)};if(hint==\"start\")return{anchor:change.from,head:change.from};var end=changeEnd(change);if(hint==\"around\")return{anchor:change.from,head:end};if(hint==\"end\")return{anchor:end,head:end};var adjustPos=function(pos){if(posLess(pos,change.from))return pos;if(!posLess(change.to,pos))return end;var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line)ch+=end.ch-change.to.ch;return Pos(line,ch)};return{anchor:adjustPos(doc.sel.anchor),head:adjustPos(doc.sel.head)}}function filterChange(doc,change,update){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=true}};if(update)obj.update=function(from,to,text,origin){if(from)this.from=clipPos(doc,from);if(to)this.to=clipPos(doc,to);if(text)this.text=text;if(origin!==undefined)this.origin=origin};signal(doc,\"beforeChange\",doc,obj);if(doc.cm)signal(doc.cm,\"beforeChange\",doc.cm,obj);if(obj.canceled)return null;return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,selUpdate,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,selUpdate,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(hasHandler(doc,\"beforeChange\")||doc.cm&&hasHandler(doc.cm,\"beforeChange\")){change=filterChange(doc,change,true);if(!change)return}var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=1;--i)makeChangeNoReadonly(doc,{from:split[i].from,to:split[i].to,text:[\"\"]});if(split.length)makeChangeNoReadonly(doc,{from:split[0].from,to:split[0].to,text:change.text},selUpdate)}else{makeChangeNoReadonly(doc,change,selUpdate)}}function makeChangeNoReadonly(doc,change,selUpdate){var selAfter=computeSelAfterChange(doc,change,selUpdate);addToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}function makeChangeFromHistory(doc,type){if(doc.cm&&doc.cm.state.suppressEdits)return;var hist=doc.history;var event=(type==\"undo\"?hist.done:hist.undone).pop();if(!event)return;hist.dirtyCounter+=type==\"undo\"?-1:1;var anti={changes:[],anchorBefore:event.anchorAfter,headBefore:event.headAfter,anchorAfter:event.anchorBefore,headAfter:event.headBefore};(type==\"undo\"?hist.undone:hist.done).push(anti);var filter=hasHandler(doc,\"beforeChange\")||doc.cm&&hasHandler(doc.cm,\"beforeChange\");for(var i=event.changes.length-1;i>=0;--i){var change=event.changes[i];change.origin=type;if(filter&&!filterChange(doc,change,false)){(type==\"undo\"?hist.done:hist.undone).length=0;return}anti.changes.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change,null):{anchor:event.anchorBefore,head:event.headBefore};makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}function shiftDoc(doc,distance){function shiftPos(pos){return Pos(pos.line+distance,pos.ch)}doc.first+=distance;if(doc.cm)regChange(doc.cm,doc.first,doc.first,distance);doc.sel.head=shiftPos(doc.sel.head);doc.sel.anchor=shiftPos(doc.sel.anchor);doc.sel.from=shiftPos(doc.sel.from);doc.sel.to=shiftPos(doc.sel.to)}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return}if(change.from.line>doc.lastLine())return;if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}}change.removed=getBetween(doc,change.from,change.to);if(!selAfter)selAfter=computeSelAfterChange(doc,change,null);if(doc.cm)makeChangeSingleDocInEditor(doc.cm,change,spans,selAfter);else updateDoc(doc,change,spans,selAfter)}function makeChangeSingleDocInEditor(cm,change,spans,selAfter){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(doc,getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine){recomputeMaxLength=true;return true}})}if(!posLess(doc.sel.head,change.from)&&!posLess(change.to,doc.sel.head))cm.curOp.cursorActivity=true;updateDoc(doc,change,spans,selAfter,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(doc,line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false}});if(recomputeMaxLength)cm.curOp.updateMaxLine=true}doc.frontier=Math.min(doc.frontier,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;regChange(cm,from.line,to.line+1,lendiff);if(hasHandler(cm,\"change\")){var changeObj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(cm.curOp.textChanged){for(var cur=cm.curOp.textChanged;cur.next;cur=cur.next){}cur.next=changeObj}else cm.curOp.textChanged=changeObj}}function replaceRange(doc,code,from,to,origin){if(!to)to=from;if(posLess(to,from)){var tmp=to;to=from;from=tmp}if(typeof code==\"string\")code=splitLines(code);makeChange(doc,{from:from,to:to,text:code,origin:origin},null)}function Pos(line,ch){if(!(this instanceof Pos))return new Pos(line,ch);this.line=line;this.ch=ch}CodeMirror.Pos=Pos;function posEq(a,b){return a.line==b.line&&a.ch==b.ch}function posLess(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function copyPos(x){return Pos(x.line,x.ch)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;if(pos.line>last)return Pos(last,getLine(doc,last).text.length);return clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen)return Pos(pos.line,linelen);else if(ch<0)return Pos(pos.line,0);else return pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function extendSelection(doc,pos,other,bias){if(doc.sel.shift||doc.sel.extend){var anchor=doc.sel.anchor;if(other){var posBefore=posLess(pos,anchor);if(posBefore!=posLess(other,anchor)){anchor=pos;pos=other}else if(posBefore!=posLess(pos,other)){pos=other}}setSelection(doc,anchor,pos,bias)}else{setSelection(doc,pos,other||pos,bias)}if(doc.cm)doc.cm.curOp.userSelChange=true}function filterSelectionChange(doc,anchor,head){var obj={anchor:anchor,head:head};signal(doc,\"beforeSelectionChange\",doc,obj);if(doc.cm)signal(doc.cm,\"beforeSelectionChange\",doc.cm,obj);obj.anchor=clipPos(doc,obj.anchor);obj.head=clipPos(doc,obj.head);return obj}function setSelection(doc,anchor,head,bias,checkAtomic){if(!checkAtomic&&hasHandler(doc,\"beforeSelectionChange\")||doc.cm&&hasHandler(doc.cm,\"beforeSelectionChange\")){var filtered=filterSelectionChange(doc,anchor,head);head=filtered.head;anchor=filtered.anchor}var sel=doc.sel;sel.goalColumn=null;if(checkAtomic||!posEq(anchor,sel.anchor))anchor=skipAtomic(doc,anchor,bias,checkAtomic!=\"push\");if(checkAtomic||!posEq(head,sel.head))head=skipAtomic(doc,head,bias,checkAtomic!=\"push\");if(posEq(sel.anchor,anchor)&&posEq(sel.head,head))return;sel.anchor=anchor;sel.head=head;var inv=posLess(head,anchor);sel.from=inv?head:anchor;sel.to=inv?anchor:head;if(doc.cm)doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=doc.cm.curOp.cursorActivity=true;signalLater(doc,\"cursorActivity\",doc)}function reCheckSelection(cm){setSelection(cm.doc,cm.doc.sel.from,cm.doc.sel.to,null,\"push\")}function skipAtomic(doc,pos,bias,mayClear){var flipped=false,curPos=pos;var dir=bias||1;doc.cantEdit&=~cantEdit_inatomic;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((sp.from==null||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(sp.to==null||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear){signal(m,\"beforeCursorEnter\");if(m.explicitlyCleared){if(!line.markedSpans)break;else{--i;continue}}}if(!m.atomic)continue;var newPos=m.find()[dir<0?\"from\":\"to\"];if(posEq(newPos,curPos)){newPos.ch+=dir;if(newPos.ch<0){if(newPos.line>doc.first)newPos=clipPos(doc,Pos(newPos.line-1));else newPos=null}else if(newPos.ch>line.text.length){if(newPos.line<doc.first+doc.size-1)newPos=Pos(newPos.line+1,0);else newPos=null}if(!newPos){if(flipped){if(!mayClear)return skipAtomic(doc,pos,bias,true);doc.cantEdit|=cantEdit_inatomic;return Pos(doc.first,0)}flipped=true;newPos=pos;dir=-dir}}curPos=newPos;continue search}}}return curPos}}function scrollCursorIntoView(cm){var coords=scrollPosIntoView(cm,cm.doc.sel.head,cm.options.cursorScrollMargin);if(!cm.state.focused)return;var display=cm.display,box=getRect(display.sizer),doScroll=null;if(coords.top+box.top<0)doScroll=true;else if(coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight))doScroll=false;if(doScroll!=null&&!phantom){var hidden=display.cursor.style.display==\"none\";if(hidden){display.cursor.style.display=\"\";display.cursor.style.left=coords.left+\"px\";display.cursor.style.top=coords.top-display.viewOffset+\"px\"}display.cursor.scrollIntoView(doScroll);if(hidden)display.cursor.style.display=\"none\"}}function scrollPosIntoView(cm,pos,margin){if(margin==null)margin=0;for(;;){var changed=false,coords=cursorCoords(cm,pos);var scrollPos=calculateScrollPos(cm,coords.left,coords.top-margin,coords.left,coords.bottom+margin);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1)changed=true}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1)changed=true}if(!changed)return coords}}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);if(scrollPos.scrollTop!=null)setScrollTop(cm,scrollPos.scrollTop);if(scrollPos.scrollLeft!=null)setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);if(y1<0)y1=0;var screen=display.scroller.clientHeight-scrollerCutOff,screentop=display.scroller.scrollTop,result={};var docBottom=cm.doc.height+paddingVert(display);var atTop=y1<snapMargin,atBottom=y2>docBottom-snapMargin;if(y1<screentop){result.scrollTop=atTop?0:y1}else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);if(newTop!=screentop)result.scrollTop=newTop}var screenw=display.scroller.clientWidth-scrollerCutOff,screenleft=display.scroller.scrollLeft;x1+=display.gutters.offsetWidth;x2+=display.gutters.offsetWidth;var gutterw=display.gutters.offsetWidth;var atLeft=x1<gutterw+10;if(x1<screenleft+gutterw||atLeft){if(atLeft)x1=0;result.scrollLeft=Math.max(0,x1-10-gutterw)}else if(x2>screenw+screenleft-3){result.scrollLeft=x2+10-screenw}return result}function updateScrollPos(cm,left,top){cm.curOp.updateScrollPos={scrollLeft:left==null?cm.doc.scrollLeft:left,scrollTop:top==null?cm.doc.scrollTop:top}}function addToScrollPos(cm,left,top){var pos=cm.curOp.updateScrollPos||(cm.curOp.updateScrollPos={scrollLeft:cm.doc.scrollLeft,scrollTop:cm.doc.scrollTop});var scroll=cm.display.scroller;pos.scrollTop=Math.max(0,Math.min(scroll.scrollHeight-scroll.clientHeight,pos.scrollTop+top));pos.scrollLeft=Math.max(0,Math.min(scroll.scrollWidth-scroll.clientWidth,pos.scrollLeft+left))}function indentLine(cm,n,how,aggressive){var doc=cm.doc;if(!how)how=\"add\";if(how==\"smart\"){if(!cm.doc.mode.indent)how=\"prev\";else var state=getStateBefore(cm,n)}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);var curSpaceString=line.text.match(/^\\s*/)[0],indentation;if(how==\"smart\"){indentation=cm.doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass){if(!aggressive)return;how=\"prev\"}}if(how==\"prev\"){if(n>doc.first)indentation=countColumn(getLine(doc,n-1).text,null,tabSize);else indentation=0}else if(how==\"add\"){indentation=curSpace+cm.options.indentUnit}else if(how==\"subtract\"){indentation=curSpace-cm.options.indentUnit}indentation=Math.max(0,indentation);var indentString=\"\",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+=\"\t\"}if(pos<indentation)indentString+=spaceStr(indentation-pos);if(indentString!=curSpaceString)replaceRange(cm.doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),\"+input\");line.stateAfter=null}function changeLine(cm,handle,op){var no=handle,line=handle,doc=cm.doc;\nif(typeof handle==\"number\")line=getLine(doc,clipLine(doc,handle));else no=lineNo(handle);if(no==null)return null;if(op(line,no))regChange(cm,no,no+1);else return null;return line}function findPosH(doc,pos,dir,unit,visually){var line=pos.line,ch=pos.ch,origDir=dir;var lineObj=getLine(doc,line);var possible=true;function findNextLine(){var l=line+dir;if(l<doc.first||l>=doc.first+doc.size)return possible=false;line=l;return lineObj=getLine(doc,l)}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,true);if(next==null){if(!boundToLine&&findNextLine()){if(visually)ch=(dir<0?lineRight:lineLeft)(lineObj);else ch=dir<0?lineObj.text.length:0}else return possible=false}else ch=next;return true}if(unit==\"char\")moveOnce();else if(unit==\"column\")moveOnce(true);else if(unit==\"word\"||unit==\"group\"){var sawType=null,group=unit==\"group\";for(var first=true;;first=false){if(dir<0&&!moveOnce(!first))break;var cur=lineObj.text.charAt(ch)||\"\\n\";var type=isWordChar(cur)?\"w\":!group?null:/\\s/.test(cur)?null:\"p\";if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce()}break}if(type)sawType=type;if(dir>0&&!moveOnce(!first))break}}var result=skipAtomic(doc,Pos(line,ch),origDir,true);if(!possible)result.hitSide=true;return result}function findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit==\"page\"){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(dir<0?1.5:.5)*textHeight(cm.display))}else if(unit==\"line\"){y=dir>0?pos.bottom+3:pos.top-3}for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break}y+=dir*5}return target}function findWordAt(line,pos){var start=pos.ch,end=pos.ch;if(line){if(pos.after===false||end==line.length)--start;else++end;var startChar=line.charAt(start);var check=isWordChar(startChar)?isWordChar:/\\s/.test(startChar)?function(ch){return/\\s/.test(ch)}:function(ch){return!/\\s/.test(ch)&&!isWordChar(ch)};while(start>0&&check(line.charAt(start-1)))--start;while(end<line.length&&check(line.charAt(end)))++end}return{from:Pos(pos.line,start),to:Pos(pos.line,end)}}function selectLine(cm,line){extendSelection(cm.doc,Pos(line,0),clipPos(cm.doc,Pos(line+1,0)))}CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus();focusInput(this);onFocus(this);fastPoll(this)},setOption:function(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!=\"mode\")return;options[option]=value;if(optionHandlers.hasOwnProperty(option))operation(this,optionHandlers[option])(this,value,old)},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?\"push\":\"unshift\"](map)},removeKeyMap:function(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i)if((typeof map==\"string\"?maps[i].name:maps[i])==map){maps.splice(i,1);return true}},addOverlay:operation(null,function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error(\"Overlays may not be stateful.\");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque});this.state.modeGen++;regChange(this)}),removeOverlay:operation(null,function(spec){var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||typeof spec==\"string\"&&cur.name==spec){overlays.splice(i,1);this.state.modeGen++;regChange(this);return}}}),indentLine:operation(null,function(n,dir,aggressive){if(typeof dir!=\"string\"){if(dir==null)dir=this.options.smartIndent?\"smart\":\"prev\";else dir=dir?\"add\":\"subtract\"}if(isLine(this.doc,n))indentLine(this,n,dir,aggressive)}),indentSelection:operation(null,function(how){var sel=this.doc.sel;if(posEq(sel.from,sel.to))return indentLine(this,sel.from.line,how);var e=sel.to.line-(sel.to.ch?0:1);for(var i=sel.from.line;i<=e;++i)indentLine(this,i,how)}),getTokenAt:function(pos){var doc=this.doc;pos=clipPos(doc,pos);var state=getStateBefore(this,pos.line),mode=this.doc.mode;var line=getLine(doc,pos.line);var stream=new StringStream(line.text,this.options.tabSize);while(stream.pos<pos.ch&&!stream.eol()){stream.start=stream.pos;var style=mode.token(stream,state)}return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,type:style||null,state:state}},getStateAfter:function(line){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getStateBefore(this,line+1)},cursorCoords:function(start,mode){var pos,sel=this.doc.sel;if(start==null)pos=sel.head;else if(typeof start==\"object\")pos=clipPos(this.doc,start);else pos=start?sel.from:sel.to;return cursorCoords(this,pos,mode||\"page\")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||\"page\")},coordsChar:function(coords,mode){coords=fromCoordSystem(this,coords,mode||\"page\");return coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){height=fromCoordSystem(this,{top:height,left:0},mode||\"page\").top;return lineAtHeight(this.doc,height+this.display.viewOffset)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:operation(null,function(line,gutterID,value){return changeLine(this,line,function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers))line.gutterMarkers=null;return true})}),clearGutter:operation(null,function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){line.gutterMarkers[gutterID]=null;regChange(cm,i,i+1);if(isEmpty(line.gutterMarkers))line.gutterMarkers=null}++i})}),addLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where==\"text\"?\"textClass\":where==\"background\"?\"bgClass\":\"wrapClass\";if(!line[prop])line[prop]=cls;else if(new RegExp(\"\\\\b\"+cls+\"\\\\b\").test(line[prop]))return false;else line[prop]+=\" \"+cls;return true})}),removeLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where==\"text\"?\"textClass\":where==\"background\"?\"bgClass\":\"wrapClass\";var cur=line[prop];if(!cur)return false;else if(cls==null)line[prop]=null;else{var upd=cur.replace(new RegExp(\"^\"+cls+\"\\\\b\\\\s*|\\\\s*\\\\b\"+cls+\"\\\\b\"),\"\");if(upd==cur)return false;line[prop]=upd||null}return true})}),addLineWidget:operation(null,function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},lineInfo:function(line){if(typeof line==\"number\"){if(!isLine(this.doc,line))return null;var n=line;line=getLine(this.doc,line);if(!line)return null}else{var n=lineNo(line);if(n==null)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position=\"absolute\";display.sizer.appendChild(node);if(vert==\"over\"){top=pos.top}else if(vert==\"above\"||vert==\"near\"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);if((vert==\"above\"||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight)top=pos.top-node.offsetHeight;else if(pos.bottom+node.offsetHeight<=vspace)top=pos.bottom;if(left+node.offsetWidth>hspace)left=hspace-node.offsetWidth}node.style.top=top+\"px\";node.style.left=node.style.right=\"\";if(horiz==\"right\"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right=\"0px\"}else{if(horiz==\"left\")left=0;else if(horiz==\"middle\")left=(display.sizer.clientWidth-node.offsetWidth)/2;node.style.left=left+\"px\"}if(scroll)scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:operation(null,onKeyDown),execCommand:function(cmd){return commands[cmd](this)},findPosH:function(from,amount,unit,visually){var dir=1;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){cur=findPosH(this.doc,cur,dir,unit,visually);if(cur.hitSide)break}return cur},moveH:operation(null,function(dir,unit){var sel=this.doc.sel,pos;if(sel.shift||sel.extend||posEq(sel.from,sel.to))pos=findPosH(this.doc,sel.head,dir,unit,this.options.rtlMoveVisually);else pos=dir<0?sel.from:sel.to;extendSelection(this.doc,pos,pos,dir)}),deleteH:operation(null,function(dir,unit){var sel=this.doc.sel;if(!posEq(sel.from,sel.to))replaceRange(this.doc,\"\",sel.from,sel.to,\"+delete\");else replaceRange(this.doc,\"\",sel.from,findPosH(this.doc,sel.head,dir,unit,false),\"+delete\");this.curOp.userSelChange=true}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){var coords=cursorCoords(this,cur,\"div\");if(x==null)x=coords.left;else coords.left=x;cur=findPosV(this,coords,dir,unit);if(cur.hitSide)break}return cur},moveV:operation(null,function(dir,unit){var sel=this.doc.sel;var pos=cursorCoords(this,sel.head,\"div\");if(sel.goalColumn!=null)pos.left=sel.goalColumn;var target=findPosV(this,pos,dir,unit);if(unit==\"page\")addToScrollPos(this,0,charCoords(this,target,\"div\").top-pos.top);extendSelection(this.doc,target,target,dir);sel.goalColumn=pos.left}),toggleOverwrite:function(value){if(value!=null&&value==this.state.overwrite)return;if(this.state.overwrite=!this.state.overwrite)this.display.cursor.className+=\" CodeMirror-overwrite\";else this.display.cursor.className=this.display.cursor.className.replace(\" CodeMirror-overwrite\",\"\")},hasFocus:function(){return this.state.focused},scrollTo:operation(null,function(x,y){updateScrollPos(this,x,y)}),getScrollInfo:function(){var scroller=this.display.scroller,co=scrollerCutOff;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-co,width:scroller.scrollWidth-co,clientHeight:scroller.clientHeight-co,clientWidth:scroller.clientWidth-co}},scrollIntoView:operation(null,function(pos,margin){if(typeof pos==\"number\")pos=Pos(pos,0);if(!margin)margin=0;var coords=pos;if(!pos||pos.line!=null){this.curOp.scrollToPos=pos?clipPos(this.doc,pos):this.doc.sel.head;this.curOp.scrollToPosMargin=margin;coords=cursorCoords(this,this.curOp.scrollToPos)}var sPos=calculateScrollPos(this,coords.left,coords.top-margin,coords.right,coords.bottom+margin);updateScrollPos(this,sPos.scrollLeft,sPos.scrollTop)}),setSize:function(width,height){function interpret(val){return typeof val==\"number\"||/^\\d+$/.test(String(val))?val+\"px\":val}if(width!=null)this.display.wrapper.style.width=interpret(width);if(height!=null)this.display.wrapper.style.height=interpret(height);this.refresh()},on:function(type,f){on(this,type,f)},off:function(type,f){off(this,type,f)},operation:function(f){return runInOp(this,f)},refresh:operation(null,function(){clearCaches(this);updateScrollPos(this,this.doc.scrollLeft,this.doc.scrollTop);regChange(this)}),swapDoc:operation(null,function(doc){var old=this.doc;old.cm=null;attachDoc(this,doc);clearCaches(this);resetInput(this,true);updateScrollPos(this,doc.scrollLeft,doc.scrollTop);return old}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var optionHandlers=CodeMirror.optionHandlers={};var defaults=CodeMirror.defaults={};function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle)optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init)handle(cm,val,old)}:handle}var Init=CodeMirror.Init={toString:function(){return\"CodeMirror.Init\"}};option(\"value\",\"\",function(cm,val){cm.setValue(val)},true);option(\"mode\",null,function(cm,val){cm.doc.modeOption=val;loadMode(cm)},true);option(\"indentUnit\",2,loadMode,true);option(\"indentWithTabs\",false);option(\"smartIndent\",true);option(\"tabSize\",4,function(cm){loadMode(cm);clearCaches(cm);regChange(cm)},true);option(\"electricChars\",true);option(\"rtlMoveVisually\",!windows);option(\"theme\",\"default\",function(cm){themeChanged(cm);guttersChanged(cm)},true);option(\"keyMap\",\"default\",keyMapChanged);option(\"extraKeys\",null);option(\"onKeyEvent\",null);option(\"onDragEvent\",null);option(\"lineWrapping\",false,wrappingChanged,true);option(\"gutters\",[],function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option(\"fixedGutter\",true,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+\"px\":\"0\";cm.refresh()},true);option(\"coverGutterNextToScrollbar\",false,updateScrollbars,true);option(\"lineNumbers\",false,function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option(\"firstLineNumber\",1,guttersChanged,true);option(\"lineNumberFormatter\",function(integer){return integer},guttersChanged,true);option(\"showCursorWhenSelecting\",false,updateSelection,true);option(\"readOnly\",false,function(cm,val){if(val==\"nocursor\"){onBlur(cm);cm.display.input.blur()}else if(!val)resetInput(cm,true)});option(\"dragDrop\",true);option(\"cursorBlinkRate\",530);option(\"cursorScrollMargin\",0);option(\"cursorHeight\",1);option(\"workTime\",100);option(\"workDelay\",100);option(\"flattenSpans\",true);option(\"pollInterval\",100);option(\"undoDepth\",40,function(cm,val){cm.doc.history.undoDepth=val});option(\"historyEventDelay\",500);option(\"viewportMargin\",10,function(cm){cm.refresh()},true);option(\"maxHighlightLength\",1e4,function(cm){loadMode(cm);cm.refresh()},true);option(\"moveInputWithCursor\",true,function(cm,val){if(!val)cm.display.inputDiv.style.top=cm.display.inputDiv.style.left=0});option(\"tabindex\",null,function(cm,val){cm.display.input.tabIndex=val||\"\"});option(\"autofocus\",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(!CodeMirror.defaults.mode&&name!=\"null\")CodeMirror.defaults.mode=name;if(arguments.length>2){mode.dependencies=[];for(var i=2;i<arguments.length;++i)mode.dependencies.push(arguments[i])}modes[name]=mode};CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec};CodeMirror.resolveMode=function(spec){if(typeof spec==\"string\"&&mimeModes.hasOwnProperty(spec)){spec=mimeModes[spec]}else if(spec&&typeof spec.name==\"string\"&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];spec=createObj(found,spec);spec.name=found.name}else if(typeof spec==\"string\"&&/^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)){return CodeMirror.resolveMode(\"application/xml\")}if(typeof spec==\"string\")return{name:spec};else return spec||{name:\"null\"}};CodeMirror.getMode=function(options,spec){spec=CodeMirror.resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,\"text/plain\");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop))continue;if(modeObj.hasOwnProperty(prop))modeObj[\"_\"+prop]=modeObj[prop];modeObj[prop]=exts[prop]}}modeObj.name=spec.name;return modeObj};CodeMirror.defineMode(\"null\",function(){return{token:function(stream){stream.skipToEnd()}}});CodeMirror.defineMIME(\"text/plain\",\"null\");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)};CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func};CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};function copyState(mode,state){if(state===true)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];if(val instanceof Array)val=val.concat([]);nstate[n]=val}return nstate}CodeMirror.copyState=copyState;function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true}CodeMirror.startState=startState;CodeMirror.innerMode=function(mode,state){while(mode.innerMode){var info=mode.innerMode(state);state=info.state;mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()))},killLine:function(cm){var from=cm.getCursor(true),to=cm.getCursor(false),sel=!posEq(from,to);if(!sel&&cm.getLine(from.line).length==from.ch)cm.replaceRange(\"\",from,Pos(from.line+1,0),\"+delete\");else cm.replaceRange(\"\",from,sel?to:Pos(from.line),\"+delete\")},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange(\"\",Pos(l,0),Pos(l),\"+delete\")},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelection(lineStart(cm,cm.getCursor().line))},goLineStartSmart:function(cm){var cur=cm.getCursor(),start=lineStart(cm,cur.line);var line=cm.getLineHandle(start.line);var order=getOrder(line);if(!order||order[0].level==0){var firstNonWS=Math.max(0,line.text.search(/\\S/));var inWS=cur.line==start.line&&cur.ch<=firstNonWS&&cur.ch;cm.extendSelection(Pos(start.line,inWS?0:firstNonWS))}else cm.extendSelection(start)},goLineEnd:function(cm){cm.extendSelection(lineEnd(cm,cm.getCursor().line))},goLineRight:function(cm){var top=cm.charCoords(cm.getCursor(),\"div\").top+5;cm.extendSelection(cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},\"div\"))},goLineLeft:function(cm){var top=cm.charCoords(cm.getCursor(),\"div\").top+5;cm.extendSelection(cm.coordsChar({left:0,top:top},\"div\"))},goLineUp:function(cm){cm.moveV(-1,\"line\")},goLineDown:function(cm){cm.moveV(1,\"line\")},goPageUp:function(cm){cm.moveV(-1,\"page\")},goPageDown:function(cm){cm.moveV(1,\"page\")},goCharLeft:function(cm){cm.moveH(-1,\"char\")},goCharRight:function(cm){cm.moveH(1,\"char\")},goColumnLeft:function(cm){cm.moveH(-1,\"column\")},goColumnRight:function(cm){cm.moveH(1,\"column\")},goWordLeft:function(cm){cm.moveH(-1,\"word\")},goGroupRight:function(cm){cm.moveH(1,\"group\")},goGroupLeft:function(cm){cm.moveH(-1,\"group\")},goWordRight:function(cm){cm.moveH(1,\"word\")},delCharBefore:function(cm){cm.deleteH(-1,\"char\")},delCharAfter:function(cm){cm.deleteH(1,\"char\")},delWordBefore:function(cm){cm.deleteH(-1,\"word\")},delWordAfter:function(cm){cm.deleteH(1,\"word\")},delGroupBefore:function(cm){cm.deleteH(-1,\"group\")},delGroupAfter:function(cm){cm.deleteH(1,\"group\")},indentAuto:function(cm){cm.indentSelection(\"smart\")},indentMore:function(cm){cm.indentSelection(\"add\")},indentLess:function(cm){cm.indentSelection(\"subtract\")},insertTab:function(cm){cm.replaceSelection(\"\t\",\"end\",\"+input\")},defaultTab:function(cm){if(cm.somethingSelected())cm.indentSelection(\"add\");else cm.replaceSelection(\"\t\",\"end\",\"+input\")},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);if(cur.ch>0&&cur.ch<line.length-1)cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1))},newlineAndIndent:function(cm){operation(cm,function(){cm.replaceSelection(\"\\n\",\"end\",\"+input\");cm.indentLine(cm.getCursor().line,null,true)})()},toggleOverwrite:function(cm){cm.toggleOverwrite()}};var keyMap=CodeMirror.keyMap={};keyMap.basic={Left:\"goCharLeft\",Right:\"goCharRight\",Up:\"goLineUp\",Down:\"goLineDown\",End:\"goLineEnd\",Home:\"goLineStartSmart\",PageUp:\"goPageUp\",PageDown:\"goPageDown\",Delete:\"delCharAfter\",Backspace:\"delCharBefore\",Tab:\"defaultTab\",\"Shift-Tab\":\"indentAuto\",Enter:\"newlineAndIndent\",Insert:\"toggleOverwrite\"};keyMap.pcDefault={\"Ctrl-A\":\"selectAll\",\"Ctrl-D\":\"deleteLine\",\"Ctrl-Z\":\"undo\",\"Shift-Ctrl-Z\":\"redo\",\"Ctrl-Y\":\"redo\",\"Ctrl-Home\":\"goDocStart\",\"Alt-Up\":\"goDocStart\",\"Ctrl-End\":\"goDocEnd\",\"Ctrl-Down\":\"goDocEnd\",\"Ctrl-Left\":\"goGroupLeft\",\"Ctrl-Right\":\"goGroupRight\",\"Alt-Left\":\"goLineStart\",\"Alt-Right\":\"goLineEnd\",\"Ctrl-Backspace\":\"delGroupBefore\",\"Ctrl-Delete\":\"delGroupAfter\",\"Ctrl-S\":\"save\",\"Ctrl-F\":\"find\",\"Ctrl-G\":\"findNext\",\"Shift-Ctrl-G\":\"findPrev\",\"Shift-Ctrl-F\":\"replace\",\"Shift-Ctrl-R\":\"replaceAll\",\"Ctrl-[\":\"indentLess\",\"Ctrl-]\":\"indentMore\",fallthrough:\"basic\"};keyMap.macDefault={\"Cmd-A\":\"selectAll\",\"Cmd-D\":\"deleteLine\",\"Cmd-Z\":\"undo\",\"Shift-Cmd-Z\":\"redo\",\"Cmd-Y\":\"redo\",\"Cmd-Up\":\"goDocStart\",\"Cmd-End\":\"goDocEnd\",\"Cmd-Down\":\"goDocEnd\",\"Alt-Left\":\"goGroupLeft\",\"Alt-Right\":\"goGroupRight\",\"Cmd-Left\":\"goLineStart\",\"Cmd-Right\":\"goLineEnd\",\"Alt-Backspace\":\"delGroupBefore\",\"Ctrl-Alt-Backspace\":\"delGroupAfter\",\"Alt-Delete\":\"delGroupAfter\",\"Cmd-S\":\"save\",\"Cmd-F\":\"find\",\"Cmd-G\":\"findNext\",\"Shift-Cmd-G\":\"findPrev\",\"Cmd-Alt-F\":\"replace\",\"Shift-Cmd-Alt-F\":\"replaceAll\",\"Cmd-[\":\"indentLess\",\"Cmd-]\":\"indentMore\",fallthrough:[\"basic\",\"emacsy\"]};keyMap[\"default\"]=mac?keyMap.macDefault:keyMap.pcDefault;keyMap.emacsy={\"Ctrl-F\":\"goCharRight\",\"Ctrl-B\":\"goCharLeft\",\"Ctrl-P\":\"goLineUp\",\"Ctrl-N\":\"goLineDown\",\"Alt-F\":\"goWordRight\",\"Alt-B\":\"goWordLeft\",\"Ctrl-A\":\"goLineStart\",\"Ctrl-E\":\"goLineEnd\",\"Ctrl-V\":\"goPageDown\",\"Shift-Ctrl-V\":\"goPageUp\",\"Ctrl-D\":\"delCharAfter\",\"Ctrl-H\":\"delCharBefore\",\"Alt-D\":\"delWordAfter\",\"Alt-Backspace\":\"delWordBefore\",\"Ctrl-K\":\"killLine\",\"Ctrl-T\":\"transposeChars\"};function getKeyMap(val){if(typeof val==\"string\")return keyMap[val];else return val}function lookupKey(name,maps,handle){function lookup(map){map=getKeyMap(map);var found=map[name];if(found===false)return\"stop\";if(found!=null&&handle(found))return true;if(map.nofallthrough)return\"stop\";var fallthrough=map.fallthrough;if(fallthrough==null)return false;if(Object.prototype.toString.call(fallthrough)!=\"[object Array]\")return lookup(fallthrough);for(var i=0,e=fallthrough.length;i<e;++i){var done=lookup(fallthrough[i]);if(done)return done}return false}for(var i=0;i<maps.length;++i){var done=lookup(maps[i]);if(done)return done!=\"stop\"}}function isModifierKey(event){var name=keyNames[event.keyCode];return name==\"Ctrl\"||name==\"Alt\"||name==\"Shift\"||name==\"Mod\"}function keyName(event,noShift){if(opera&&event.keyCode==34&&event[\"char\"])return false;var name=keyNames[event.keyCode];if(name==null||event.altGraphKey)return false;if(event.altKey)name=\"Alt-\"+name;if(flipCtrlCmd?event.metaKey:event.ctrlKey)name=\"Ctrl-\"+name;if(flipCtrlCmd?event.ctrlKey:event.metaKey)name=\"Cmd-\"+name;if(!noShift&&event.shiftKey)name=\"Shift-\"+name;return name}CodeMirror.lookupKey=lookupKey;CodeMirror.isModifierKey=isModifierKey;CodeMirror.keyName=keyName;CodeMirror.fromTextArea=function(textarea,options){if(!options)options={};options.value=textarea.value;if(!options.tabindex&&textarea.tabindex)options.tabindex=textarea.tabindex;if(!options.placeholder&&textarea.placeholder)options.placeholder=textarea.placeholder;if(options.autofocus==null){var hasFocus=document.body;try{hasFocus=document.activeElement}catch(e){}options.autofocus=hasFocus==textarea||textarea.getAttribute(\"autofocus\")!=null&&hasFocus==document.body}function save(){textarea.value=cm.getValue()}if(textarea.form){on(textarea.form,\"submit\",save);if(!options.leaveSubmitMethodAlone){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save();form.submit=realSubmit;form.submit();form.submit=wrappedSubmit}}catch(e){}}}textarea.style.display=\"none\";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);cm.save=save;cm.getTextArea=function(){return textarea};cm.toTextArea=function(){save();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display=\"\";if(textarea.form){off(textarea.form,\"submit\",save);if(typeof textarea.form.submit==\"function\")textarea.form.submit=realSubmit}};return cm};function StringStream(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0}StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(match){var ch=this.string.charAt(this.pos);if(typeof match==\"string\")var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));if(ok){++this.pos;return ch}},eatWhile:function(match){var start=this.pos;while(this.eat(match)){}return this.pos>start},eatSpace:function(){var start=this.pos;while(/[\\s\\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true}},backUp:function(n){this.pos-=n},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue},indentation:function(){return countColumn(this.string,null,this.tabSize)},match:function(pattern,consume,caseInsensitive){if(typeof pattern==\"string\"){var cased=function(str){return caseInsensitive?str.toLowerCase():str};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false)this.pos+=pattern.length;return true}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0)return null;if(match&&consume!==false)this.pos+=match[0].length;return match}},current:function(){return this.string.slice(this.start,this.pos)}};CodeMirror.StringStream=StringStream;function TextMarker(doc,type){this.lines=[];this.type=type;this.doc=doc}CodeMirror.TextMarker=TextMarker;TextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp)startOperation(cm);var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.to!=null)max=lineNo(line);line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from!=null)min=lineNo(line);else if(this.collapsed&&!lineIsHidden(this.doc,line)&&cm)updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(cm.doc,this.lines[i]),len=lineLength(cm.doc,visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true}}if(min!=null&&cm)regChange(cm,min,max+1);this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit&cantEdit_inatomic){this.doc.cantEdit&=~cantEdit_inatomic;if(cm)reCheckSelection(cm)}if(withOp)endOperation(cm);signalLater(this,\"clear\")};TextMarker.prototype.find=function(){var from,to;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.from!=null||span.to!=null){var found=lineNo(line);if(span.from!=null)from=Pos(found,span.from);if(span.to!=null)to=Pos(found,span.to)}}if(this.type==\"bookmark\")return from;return from&&{from:from,to:to}};TextMarker.prototype.changed=function(){var pos=this.find(),cm=this.doc.cm;if(!pos||!cm)return;var line=getLine(this.doc,pos.from.line);clearCachedMeasurement(cm,line);if(pos.from.line>=cm.display.showingFrom&&pos.from.line<cm.display.showingTo){for(var node=cm.display.lineDiv.firstChild;node;node=node.nextSibling)if(node.lineObj==line){if(node.offsetHeight!=line.height)updateLineHeight(line,node.offsetHeight);break}runInOp(cm,function(){cm.curOp.selectionChanged=true})}};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1)(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type);if(type==\"range\"&&!posLess(from,to))return marker;if(options)copyObj(options,marker);if(marker.replacedWith){marker.collapsed=true;marker.replacedWith=elt(\"span\",[marker.replacedWith],\"CodeMirror-widget\");if(!options.handleMouseEvents)marker.replacedWith.ignoreEvents=true}if(marker.collapsed)sawCollapsedSpans=true;if(marker.addToHistory)addToHistory(doc,{from:from,to:to,origin:\"markText\"},{head:doc.sel.head,anchor:doc.sel.anchor},NaN);var curLine=from.line,size=0,collapsedAtStart,collapsedAtEnd,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(doc,line)==cm.display.maxLine)updateMaxLine=true;var span={from:null,to:null,marker:marker};size+=line.text.length;if(curLine==from.line){span.from=from.ch;size-=from.ch}if(curLine==to.line){span.to=to.ch;size-=line.text.length-to.ch}if(marker.collapsed){if(curLine==to.line)collapsedAtEnd=collapsedSpanAt(line,to.ch);if(curLine==from.line)collapsedAtStart=collapsedSpanAt(line,from.ch);else updateLineHeight(line,0)}addMarkedSpan(line,span);++curLine});if(marker.collapsed)doc.iter(from.line,to.line+1,function(line){if(lineIsHidden(doc,line))updateLineHeight(line,0)});if(marker.clearOnEnter)on(marker,\"beforeCursorEnter\",function(){marker.clear()});if(marker.readOnly){sawReadOnlySpans=true;if(doc.history.done.length||doc.history.undone.length)doc.clearHistory()}if(marker.collapsed){if(collapsedAtStart!=collapsedAtEnd)throw new Error(\"Inserting collapsed marker overlapping an existing one\");marker.size=size;marker.atomic=true}if(cm){if(updateMaxLine)cm.curOp.updateMaxLine=true;if(marker.className||marker.startStyle||marker.endStyle||marker.collapsed)regChange(cm,from.line,to.line+1);if(marker.atomic)reCheckSelection(cm)}return marker}function SharedTextMarker(markers,primary){this.markers=markers;this.primary=primary;for(var i=0,me=this;i<markers.length;++i){markers[i].parent=this;on(markers[i],\"clear\",function(){me.clear()})}}CodeMirror.SharedTextMarker=SharedTextMarker;SharedTextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,\"clear\")};SharedTextMarker.prototype.find=function(){return this.primary.find()};function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[markText(doc,from,to,options,type)],primary=markers[0];var widget=options.replacedWith;linkedDocs(doc,function(doc){if(widget)options.replacedWith=widget.cloneNode(true);markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)});return new SharedTextMarker(markers,primary)}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)if(spans[i]!=span)(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||marker.type==\"bookmark\"&&span.from==startCh&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);\n(nw||(nw=[])).push({from:span.from,to:endsAfter?null:span.to,marker:marker})}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||marker.type==\"bookmark\"&&span.from==endCh&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push({from:startsBefore?null:span.from-endCh,to:span.to==null?null:span.to-endCh,marker:marker})}}return nw}function stretchSpansOverChange(doc,change){var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=posEq(change.from,change.to);var first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);var sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){for(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found)span.to=startCh;else if(sameLine)span.to=found.to==null?null:found.to+offset}}}if(last){for(var i=0;i<last.length;++i){var span=last[i];if(span.to!=null)span.to+=offset;if(span.from==null){var found=getMarkedSpanFor(first,span.marker);if(!found){span.from=offset;if(sameLine)(first||(first=[])).push(span)}}else{span.from+=offset;if(sameLine)(first||(first=[])).push(span)}}}var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(gap>0&&first)for(var i=0;i<first.length;++i)if(first[i].to==null)(gapMarkers||(gapMarkers=[])).push({from:null,to:null,marker:first[i].marker});for(var i=0;i<gap;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}}else if(stretchCur){old[i]=stretchCur}}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1))(markers||(markers=[])).push(mark)}});if(!markers)return null;var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find();for(var j=0;j<parts.length;++j){var p=parts[j];if(posLess(p.to,m.from)||posLess(m.to,p.from))continue;var newParts=[j,1];if(posLess(p.from,m.from)||!mk.inclusiveLeft&&posEq(p.from,m.from))newParts.push({from:p.from,to:m.from});if(posLess(m.to,p.to)||!mk.inclusiveRight&&posEq(p.to,m.to))newParts.push({from:m.to,to:p.to});parts.splice.apply(parts,newParts);j+=newParts.length-1}}return parts}function collapsedSpanAt(line,ch){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if((sp.from==null||sp.from<ch)&&(sp.to==null||sp.to>ch)&&(!found||found.width<sp.marker.width))found=sp.marker}return found}function collapsedSpanAtStart(line){return collapsedSpanAt(line,-1)}function collapsedSpanAtEnd(line){return collapsedSpanAt(line,line.text.length+1)}function visualLine(doc,line){var merged;while(merged=collapsedSpanAtStart(line))line=getLine(doc,merged.find().from.line);return line}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if(sp.from==null)return true;if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return true}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find().to,endLine=getLine(doc,end.line);return lineIsHiddenInner(doc,endLine,getMarkedSpanFor(endLine.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return true;for(var sp,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&sp.from==span.to&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return true}}function detachMarkedSpans(line){var spans=line.markedSpans;if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}function attachMarkedSpans(line,spans){if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}var LineWidget=CodeMirror.LineWidget=function(cm,node,options){for(var opt in options)if(options.hasOwnProperty(opt))this[opt]=options[opt];this.cm=cm;this.node=node};function widgetOperation(f){return function(){var withOp=!this.cm.curOp;if(withOp)startOperation(this.cm);try{var result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}LineWidget.prototype.clear=widgetOperation(function(){var ws=this.line.widgets,no=lineNo(this.line);if(no==null||!ws)return;for(var i=0;i<ws.length;++i)if(ws[i]==this)ws.splice(i--,1);if(!ws.length)this.line.widgets=null;updateLineHeight(this.line,Math.max(0,this.line.height-widgetHeight(this)));regChange(this.cm,no,no+1)});LineWidget.prototype.changed=widgetOperation(function(){var oldH=this.height;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff)return;updateLineHeight(this.line,this.line.height+diff);var no=lineNo(this.line);regChange(this.cm,no,no+1)});function widgetHeight(widget){if(widget.height!=null)return widget.height;if(!widget.node.parentNode||widget.node.parentNode.nodeType!=1)removeChildrenAndAdd(widget.cm.display.measure,elt(\"div\",[widget.node],null,\"position: relative\"));return widget.height=widget.node.offsetHeight}function addLineWidget(cm,handle,node,options){var widget=new LineWidget(cm,node,options);if(widget.noHScroll)cm.display.alignWidgets=true;changeLine(cm,handle,function(line){(line.widgets||(line.widgets=[])).push(widget);widget.line=line;if(!lineIsHidden(cm.doc,line)||widget.showIfHidden){var aboveVisible=heightAtLine(cm,line)<cm.display.scroller.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible)addToScrollPos(cm,0,widget.height)}return true});return widget}function makeLine(text,markedSpans,estimateHeight){var line={text:text};attachMarkedSpans(line,markedSpans);line.height=estimateHeight?estimateHeight(line):1;return line}function updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null;if(line.order!=null)line.order=null;detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height)updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null;detachMarkedSpans(line)}function runMode(cm,text,mode,state,f){var flattenSpans=mode.flattenSpans;if(flattenSpans==null)flattenSpans=cm.options.flattenSpans;var curText=\"\",curStyle=null;var stream=new StringStream(text,cm.options.tabSize),style;if(text==\"\"&&mode.blankLine)mode.blankLine(state);while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;stream.pos=Math.min(text.length,stream.start+5e4);style=null}else{style=mode.token(stream,state)}var substr=stream.current();stream.start=stream.pos;if(!flattenSpans||curStyle!=style){if(curText)f(curText,curStyle);curText=substr;curStyle=style}else curText=curText+substr}if(curText)f(curText,curStyle)}function highlightLine(cm,line,state){var st=[cm.state.modeGen];runMode(cm,line.text,cm.doc.mode,state,function(txt,style){st.push(txt,style)});for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1;runMode(cm,line.text,overlay.mode,true,function(txt,style){var start=i,len=txt.length;while(len){var cur=st[i],len_=cur.length;if(len_<=len){len-=len_}else{st.splice(i,1,cur.slice(0,len),st[i+1],cur.slice(len));len=0}i+=2}if(!style)return;if(overlay.opaque){st.splice(start,i-start,txt,style);i=start+2}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=cur?cur+\" \"+style:style}}})}return st}function getLineStyles(cm,line){if(!line.styles||line.styles[0]!=cm.state.modeGen)line.styles=highlightLine(cm,line,line.stateAfter=getStateBefore(cm,lineNo(line)));return line.styles}function processLine(cm,line,state){var mode=cm.doc.mode;var stream=new StringStream(line.text,cm.options.tabSize);if(line.text==\"\"&&mode.blankLine)mode.blankLine(state);while(!stream.eol()&&stream.pos<=cm.options.maxHighlightLength){mode.token(stream,state);stream.start=stream.pos}}var styleToClassCache={};function styleToClass(style){if(!style)return null;return styleToClassCache[style]||(styleToClassCache[style]=\"cm-\"+style.replace(/ +/g,\" cm-\"))}function lineContent(cm,realLine,measure){var merged,line=realLine,lineBefore,sawBefore,empty=true;while(merged=collapsedSpanAtStart(line)){line=getLine(cm.doc,merged.find().from.line);if(!lineBefore)lineBefore=line}var builder={pre:elt(\"pre\"),col:0,pos:0,display:!measure,measure:null,addedOne:false,cm:cm};if(line.textClass)builder.pre.className=line.textClass;do{if(line.text)empty=false;builder.measure=line==realLine&&measure;builder.pos=0;builder.addToken=builder.measure?buildTokenMeasure:buildToken;if((ie||webkit)&&cm.getOption(\"lineWrapping\"))builder.addToken=buildTokenSplitSpaces(builder.addToken);if(measure&&sawBefore&&line!=realLine&&!builder.addedOne){measure[0]=builder.pre.appendChild(zeroWidthElement(cm.display.measure));builder.addedOne=true}var next=insertLineContent(line,builder,getLineStyles(cm,line));sawBefore=line==lineBefore;if(next)line=getLine(cm.doc,next.to.line)}while(next);if(measure&&!builder.addedOne)measure[0]=builder.pre.appendChild(empty?elt(\"span\",\"\"):zeroWidthElement(cm.display.measure));if(!builder.pre.firstChild&&!lineIsHidden(cm.doc,realLine))builder.pre.appendChild(document.createTextNode(\"\"));var order;if(measure&&ie&&(order=getOrder(line))){var l=order.length-1;if(order[l].from==order[l].to)--l;var last=order[l],prev=order[l-1];if(last.from+1==last.to&&prev&&last.level<prev.level){var span=measure[builder.pos-1];if(span)span.parentNode.insertBefore(span.measureRight=zeroWidthElement(cm.display.measure),span.nextSibling)}}signal(cm,\"renderLine\",cm,realLine,builder.pre);return builder.pre}var tokenSpecialChars=/[\\t\\u0000-\\u0019\\u00ad\\u200b\\u2028\\u2029\\uFEFF]/g;function buildToken(builder,text,style,startStyle,endStyle){if(!text)return;if(!tokenSpecialChars.test(text)){builder.col+=text.length;var content=document.createTextNode(text)}else{var content=document.createDocumentFragment(),pos=0;while(true){tokenSpecialChars.lastIndex=pos;var m=tokenSpecialChars.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){content.appendChild(document.createTextNode(text.slice(pos,pos+skipped)));builder.col+=skipped}if(!m)break;pos+=skipped+1;if(m[0]==\"\t\"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;content.appendChild(elt(\"span\",spaceStr(tabWidth),\"cm-tab\"));builder.col+=tabWidth}else{var token=elt(\"span\",\"\",\"cm-invalidchar\");token.title=\"\\\\u\"+m[0].charCodeAt(0).toString(16);content.appendChild(token);builder.col+=1}}}if(style||startStyle||endStyle||builder.measure){var fullStyle=style||\"\";if(startStyle)fullStyle+=startStyle;if(endStyle)fullStyle+=endStyle;return builder.pre.appendChild(elt(\"span\",[content],fullStyle))}builder.pre.appendChild(content)}function buildTokenMeasure(builder,text,style,startStyle,endStyle){var wrapping=builder.cm.options.lineWrapping;for(var i=0;i<text.length;++i){var ch=text.charAt(i),start=i==0;if(ch>=\"\"&&ch<\"\"&&i<text.length-1){ch=text.slice(i,i+2);++i}else if(i&&wrapping&&spanAffectsWrapping(text,i)){builder.pre.appendChild(elt(\"wbr\"))}var span=builder.measure[builder.pos]=buildToken(builder,ch,style,start&&startStyle,i==text.length-1&&endStyle);if(ie&&wrapping&&ch==\" \"&&i&&!/\\s/.test(text.charAt(i-1))&&i<text.length-1&&!/\\s/.test(text.charAt(i+1)))span.style.whiteSpace=\"normal\";builder.pos+=ch.length}if(text.length)builder.addedOne=true}function buildTokenSplitSpaces(inner){function split(old){var out=\" \";for(var i=0;i<old.length-2;++i)out+=i%2?\" \":\"\";out+=\" \";return out}return function(builder,text,style,startStyle,endStyle){return inner(builder,text.replace(/ {3,}/,split),style,startStyle,endStyle)}}function buildCollapsedSpan(builder,size,widget){if(widget){if(!builder.display)widget=widget.cloneNode(true);builder.pre.appendChild(widget);if(builder.measure&&size){builder.measure[builder.pos]=widget;builder.addedOne=true}}builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans;if(!spans){for(var i=1;i<styles.length;i+=2)builder.addToken(builder,styles[i],styleToClass(styles[i+1]));return}var allText=line.text,len=allText.length;var pos=0,i=1,text=\"\",style;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,collapsed;for(;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=\"\";collapsed=null;nextChange=Infinity;var foundBookmark=null;for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(sp.from<=pos&&(sp.to==null||sp.to>pos)){if(sp.to!=null&&nextChange>sp.to){nextChange=sp.to;spanEndStyle=\"\"}if(m.className)spanStyle+=\" \"+m.className;if(m.startStyle&&sp.from==pos)spanStartStyle+=\" \"+m.startStyle;if(m.endStyle&&sp.to==nextChange)spanEndStyle+=\" \"+m.endStyle;if(m.collapsed&&(!collapsed||collapsed.marker.width<m.width))collapsed=sp}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from}if(m.type==\"bookmark\"&&sp.from==pos&&m.replacedWith)foundBookmark=m.replacedWith}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len:collapsed.to)-pos,collapsed.from!=null&&collapsed.marker.replacedWith);if(collapsed.to==null)return collapsed.marker.find()}if(foundBookmark&&!collapsed)buildCollapsedSpan(builder,0,foundBookmark)}if(pos>=len)break;var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:\"\")}if(end>=upto){text=text.slice(upto-pos);pos=upto;break}pos=end;spanStartStyle=\"\"}text=styles[i++];style=styleToClass(styles[i++])}}}function updateDoc(doc,change,markedSpans,selAfter,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,\"change\",line,change)}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(from.ch==0&&to.ch==0&&lastText==\"\"){for(var i=0,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));update(lastLine,lastLine.text,lastSpans);if(nlines)doc.remove(from.line,nlines);if(added.length)doc.insert(from.line,added)}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans)}else{for(var added=[],i=1,e=text.length-1;i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));added.push(makeLine(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added)}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines)}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);for(var i=1,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));if(nlines>1)doc.remove(from.line+1,nlines-1);doc.insert(from.line+1,added)}signalLater(doc,\"change\",doc,change);setSelection(doc,selAfter.anchor,selAfter.head,null,true)}function LeafChunk(lines){this.lines=lines;this.parent=null;for(var i=0,e=lines.length,height=0;i<e;++i){lines[i].parent=this;height+=lines[i].height}this.height=height}LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;cleanUpLine(line);signalLater(line,\"delete\")}this.lines.splice(at,n)},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines))},insertInner:function(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;i<e;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;at<e;++at)if(op(this.lines[at]))return true}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0,e=children.length;i<e;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this}this.size=size;this.height=height;this.parent=null}BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null}if((n-=rm)==0)break;at=0}else at-=sz}if(this.size-n<25){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this}},collapse:function(lines){for(var i=0,e=this.children.length;i<e;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){while(child.lines.length>50){var spilled=child.lines.splice(child.lines.length-25,25);var newleaf=new LeafChunk(spilled);child.height-=newleaf.height;this.children.splice(i+1,0,newleaf);newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(this.children.length<=10)return;var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()},iterN:function(at,n,op){for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return true;if((n-=used)==0)break;at=0}else at-=sz}}};var cantEdit_inatomic=1,cantEdit_keymap=2;var nextDocId=0;var Doc=CodeMirror.Doc=function(text,mode,firstLine){if(!(this instanceof Doc))return new Doc(text,mode,firstLine);if(firstLine==null)firstLine=0;BranchChunk.call(this,[new LeafChunk([makeLine(\"\",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=0;this.history=makeHistory();this.frontier=firstLine;var start=Pos(firstLine,0);this.sel={from:start,to:start,head:start,anchor:start,shift:false,extend:false,goalColumn:null};this.id=++nextDocId;this.modeOption=mode;if(typeof text==\"string\")text=splitLines(text);updateDoc(this,{from:start,to:start,text:text},null,{head:start,anchor:start})};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){if(op)this.iterN(from-this.first,to-from,op);else this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){var height=0;for(var i=0,e=lines.length;i<e;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false)return lines;return lines.join(lineSep||\"\\n\")},setValue:function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:splitLines(code),origin:\"setValue\"},{head:top,anchor:top},true)},replaceRange:function(code,from,to,origin){from=clipPos(this,from);to=to?clipPos(this,to):from;replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));if(lineSep===false)return lines;return lines.join(lineSep||\"\\n\")},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},setLine:function(line,text){if(isLine(this,line))replaceRange(this,text,Pos(line,0),clipPos(this,Pos(line)))},removeLine:function(line){if(line)replaceRange(this,\"\",clipPos(this,Pos(line-1)),clipPos(this,Pos(line)));else replaceRange(this,\"\",Pos(0,0),clipPos(this,Pos(1,0)))},getLineHandle:function(line){if(isLine(this,line))return getLine(this,line)},getLineNumber:function(line){return lineNo(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var sel=this.sel,pos;if(start==null||start==\"head\")pos=sel.head;else if(start==\"anchor\")pos=sel.anchor;else if(start==\"end\"||start===false)pos=sel.to;else pos=sel.from;return copyPos(pos)},somethingSelected:function(){return!posEq(this.sel.head,this.sel.anchor)},setCursor:docOperation(function(line,ch,extend){var pos=clipPos(this,typeof line==\"number\"?Pos(line,ch||0):line);if(extend)extendSelection(this,pos);else setSelection(this,pos,pos)}),setSelection:docOperation(function(anchor,head){setSelection(this,clipPos(this,anchor),clipPos(this,head||anchor))}),extendSelection:docOperation(function(from,to){extendSelection(this,clipPos(this,from),to&&clipPos(this,to))}),getSelection:function(lineSep){return this.getRange(this.sel.from,this.sel.to,lineSep)},replaceSelection:function(code,collapse,origin){makeChange(this,{from:this.sel.from,to:this.sel.to,text:splitLines(code),origin:origin},collapse||\"around\")},undo:docOperation(function(){makeChangeFromHistory(this,\"undo\")}),redo:docOperation(function(){makeChangeFromHistory(this,\"redo\")}),setExtending:function(val){this.sel.extend=val},historySize:function(){var hist=this.history;return{undo:hist.done.length,redo:hist.undone.length}},clearHistory:function(){this.history=makeHistory()},markClean:function(){this.history.dirtyCounter=0;this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return this.history.dirtyCounter==0},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=makeHistory();hist.done=histData.done.slice(0);hist.undone=histData.undone.slice(0)},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,\"range\")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft};pos=clipPos(this,pos);return markText(this,pos,pos,realOpts,\"bookmark\")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch))markers.push(span.marker.parent||span.marker)}return markers},getAllMarks:function(){var markers=[];this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)if(sps[i].from!=null)markers.push(sps[i].marker)});return markers},posFromIndex:function(off){var ch,lineNo=this.first;this.iter(function(line){var sz=line.text.length+1;if(sz>off){ch=off;return true}off-=sz;++lineNo});return clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0)return 0;this.iter(this.first,coords.line,function(line){index+=line.text.length+1});return index},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:false,goalColumn:this.sel.goalColumn};if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory())}return doc},linkedDoc:function(options){if(!options)options={};var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from)from=options.from;if(options.to!=null&&options.to<to)to=options.to;var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from);if(options.sharedHist)copy.history=this.history;(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];return copy},unlinkDoc:function(other){if(other instanceof CodeMirror)other=other.doc;if(this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc!=other)continue;this.linked.splice(i,1);other.unlinkDoc(this);break}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},true);other.history=makeHistory();other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate=\"iter insert remove copy getEditor\".split(\" \");for(var prop in Doc.prototype)if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0)CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]);function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip)continue;var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared)continue;f(rel.doc,shared);propagate(rel.doc,doc,shared)}}propagate(doc,null,true)}function attachDoc(cm,doc){if(doc.cm)throw new Error(\"This document is already in use.\");cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);if(!cm.options.lineWrapping)computeMaxLength(cm);cm.options.mode=doc.modeOption;if(keyMap[cm.options.keyMap].disableInput)doc.cantEdit|=cantEdit_keymap;else doc.cantEdit&=~cantEdit_keymap;regChange(cm)}function getLine(chunk,n){n-=chunk.first;while(!chunk.lines){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,function(line){var text=line.text;if(n==end.line)text=text.slice(0,end.ch);if(n==start.line)text=text.slice(start.ch);out.push(text);++n});return out}function getLines(doc,from,to){var out=[];doc.iter(from,to,function(line){out.push(line.text)});return out}function updateLineHeight(line,height){var diff=height-line.height;for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(line.parent==null)return null;var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize()}}return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0,e=chunk.children.length;i<e;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch;n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0,e=chunk.lines.length;i<e;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh}return n+i}function heightAtLine(cm,lineObj){lineObj=visualLine(cm.doc,lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;else h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;else h+=cur.height}}return h}function getOrder(line){var order=line.order;if(order==null)order=line.order=bidiOrdering(line.text);return order}function makeHistory(){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function attachLocalSpans(doc,change,from,to){var existing=change[\"spans_\"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){if(line.markedSpans)(existing||(existing=change[\"spans_\"+doc.id]={}))[n]=line.markedSpans;++n})}function historyChangeFromChange(doc,change){var histChange={from:change.from,to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},true);return histChange}function addToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur=lst(hist.done);if(cur&&(hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)==\"+\"&&doc.cm&&hist.lastTime>time-doc.cm.options.historyEventDelay||change.origin.charAt(0)==\"*\"))){var last=lst(cur.changes);if(posEq(change.from,change.to)&&posEq(change.from,last.to)){last.to=changeEnd(change)}else{cur.changes.push(historyChangeFromChange(doc,change))}cur.anchorAfter=selAfter.anchor;cur.headAfter=selAfter.head}else{cur={changes:[historyChangeFromChange(doc,change)],anchorBefore:doc.sel.anchor,headBefore:doc.sel.head,anchorAfter:selAfter.anchor,headAfter:selAfter.head};hist.done.push(cur);while(hist.done.length>hist.undoDepth)hist.done.shift();if(hist.dirtyCounter<0)hist.dirtyCounter=NaN;else hist.dirtyCounter++}hist.lastTime=time;hist.lastOp=opId;hist.lastOrigin=change.origin}function removeClearedSpans(spans){if(!spans)return null;for(var i=0,out;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out)out=spans.slice(0,i)}else if(out)out.push(spans[i])}return!out?spans:out.length?out:null}function getOldSpans(doc,change){var found=change[\"spans_\"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup){for(var i=0,copy=[];i<events.length;++i){var event=events[i],changes=event.changes,newChanges=[];copy.push({changes:newChanges,anchorBefore:event.anchorBefore,headBefore:event.headBefore,anchorAfter:event.anchorAfter,headAfter:event.headAfter});for(var j=0;j<changes.length;++j){var change=changes[j],m;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup)for(var prop in change)if(m=prop.match(/^spans_(\\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop]}}}}return copy}function rebaseHistSel(pos,from,to,diff){if(to<pos.line){pos.line+=diff}else if(from<pos.line){pos.line=from;pos.ch=0}}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(!sub.copied){cur.from=copyPos(cur.from);cur.to=copyPos(cur.to)}if(to<cur.from.line){cur.from.line+=diff;cur.to.line+=diff}else if(from<=cur.to.line){ok=false;break}}if(!sub.copied){sub.anchorBefore=copyPos(sub.anchorBefore);sub.headBefore=copyPos(sub.headBefore);sub.anchorAfter=copyPos(sub.anchorAfter);\nsub.readAfter=copyPos(sub.headAfter);sub.copied=true}if(!ok){array.splice(0,i+1);i=0}else{rebaseHistSel(sub.anchorBefore);rebaseHistSel(sub.headBefore);rebaseHistSel(sub.anchorAfter);rebaseHistSel(sub.headAfter)}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff)}function stopMethod(){e_stop(this)}function addStop(event){if(!event.stop)event.stop=stopMethod;return event}function e_preventDefault(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false}function e_stopPropagation(e){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true}function e_stop(e){e_preventDefault(e);e_stopPropagation(e)}CodeMirror.e_stop=e_stop;CodeMirror.e_preventDefault=e_preventDefault;CodeMirror.e_stopPropagation=e_stopPropagation;function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;if(b==null){if(e.button&1)b=1;else if(e.button&2)b=3;else if(e.button&4)b=2}if(mac&&e.ctrlKey&&b==1)b=3;return b}function on(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,false);else if(emitter.attachEvent)emitter.attachEvent(\"on\"+type,f);else{var map=emitter._handlers||(emitter._handlers={});var arr=map[type]||(map[type]=[]);arr.push(f)}}function off(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,false);else if(emitter.detachEvent)emitter.detachEvent(\"on\"+type,f);else{var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;for(var i=0;i<arr.length;++i)if(arr[i]==f){arr.splice(i,1);break}}}function signal(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<arr.length;++i)arr[i].apply(null,args)}var delayedCallbacks,delayedCallbackDepth=0;function signalLater(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);if(!delayedCallbacks){++delayedCallbackDepth;delayedCallbacks=[];setTimeout(fireDelayed,0)}function bnd(f){return function(){f.apply(null,args)}}for(var i=0;i<arr.length;++i)delayedCallbacks.push(bnd(arr[i]))}function fireDelayed(){--delayedCallbackDepth;var delayed=delayedCallbacks;delayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function hasHandler(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];return arr&&arr.length>0}CodeMirror.on=on;CodeMirror.off=off;CodeMirror.signal=signal;var scrollerCutOff=30;var Pass=CodeMirror.Pass={toString:function(){return\"CodeMirror.Pass\"}};function Delayed(){this.id=null}Delayed.prototype={set:function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms)}};function countColumn(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\\s\\u00a0]/);if(end==-1)end=string.length}for(var i=startIndex||0,n=startValue||0;i<end;++i){if(string.charAt(i)==\"\t\")n+=tabSize-n%tabSize;else++n}return n}CodeMirror.countColumn=countColumn;var spaceStrs=[\"\"];function spaceStr(n){while(spaceStrs.length<=n)spaceStrs.push(lst(spaceStrs)+\" \");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function selectInput(node){if(ios){node.selectionStart=0;node.selectionEnd=node.value.length}else node.select()}function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;i<e;++i)if(collection[i]==elt)return i;return-1}function createObj(base,props){function Obj(){}Obj.prototype=base;var inst=new Obj;if(props)copyObj(props,inst);return inst}function copyObj(obj,target){if(!target)target={};for(var prop in obj)if(obj.hasOwnProperty(prop))target[prop]=obj[prop];return target}function emptyArray(size){for(var a=[],i=0;i<size;++i)a.push(undefined);return a}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}var nonASCIISingleCaseWordChar=/[\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;function isWordChar(ch){return/\\w/.test(ch)||ch>\"\"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return false;return true}var isExtendingChar=/[\\u0300-\\u036F\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1-\\u05C2\\u05C4-\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7-\\u06E8\\u06EA-\\u06ED\\uA66F\\uA670-\\uA672\\uA674-\\uA67D\\uA69F\\udc00-\\udfff]/;function elt(tag,content,className,style){var e=document.createElement(tag);if(className)e.className=className;if(style)e.style.cssText=style;if(typeof content==\"string\")setTextContent(e,content);else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function setTextContent(e,str){if(ie_lt9){e.innerHTML=\"\";e.appendChild(document.createTextNode(str))}else e.textContent=str}function getRect(node){return node.getBoundingClientRect()}CodeMirror.replaceGetRect=function(f){getRect=f};var dragAndDrop=function(){if(ie_lt9)return false;var div=elt(\"div\");return\"draggable\"in div||\"dragDrop\"in div}();function spanAffectsWrapping(){return false}if(gecko)spanAffectsWrapping=function(str,i){return str.charCodeAt(i-1)==36&&str.charCodeAt(i)==39};else if(safari&&!/Version\\/([6-9]|\\d\\d)\\b/.test(navigator.userAgent))spanAffectsWrapping=function(str,i){return/\\-[^ \\-?]|\\?[^ !\\'\\\"\\),.\\-\\/:;\\?\\]\\}]/.test(str.slice(i-1,i+1))};else if(webkit)spanAffectsWrapping=function(str,i){if(i>1&&str.charCodeAt(i-1)==45&&/\\w/.test(str.charAt(i-2))&&/[^\\-?\\.]/.test(str.charAt(i)))return true;return/[~!#%&*)=+}\\]|\\\"\\.>,:;][({[<]|-[^\\-?\\.\\u2010-\\u201f\\u2026]|\\?[\\w~`@#$%\\^&*(_=+{[|><]|[\\w~`@#$%\\^&*(_=+{[><]/.test(str.slice(i-1,i+1))};var knownScrollbarWidth;function scrollbarWidth(measure){if(knownScrollbarWidth!=null)return knownScrollbarWidth;var test=elt(\"div\",null,null,\"width: 50px; height: 50px; overflow-x: scroll\");removeChildrenAndAdd(measure,test);if(test.offsetWidth)knownScrollbarWidth=test.offsetHeight-test.clientHeight;return knownScrollbarWidth||0}var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt(\"span\",\"\");removeChildrenAndAdd(measure,elt(\"span\",[test,document.createTextNode(\"x\")]));if(measure.firstChild.offsetHeight!=0)zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!ie_lt8}if(zwspSupported)return elt(\"span\",\"\");else return elt(\"span\",\"\",null,\"display: inline-block; width: 1px; margin-right: -1px\")}var splitLines=\"\\n\\nb\".split(/\\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf(\"\\n\",pos);if(nl==-1)nl=string.length;var line=string.slice(pos,string.charAt(nl-1)==\"\\r\"?nl-1:nl);var rt=line.indexOf(\"\\r\");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1}else{result.push(line);pos=nl+1}}return result}:function(string){return string.split(/\\r\\n?|\\n/)};CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return false}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}if(!range||range.parentElement()!=te)return false;return range.compareEndPoints(\"StartToEnd\",range)!=0};var hasCopyEvent=function(){var e=elt(\"div\");if(\"oncopy\"in e)return true;e.setAttribute(\"oncopy\",\"return;\");return typeof e.oncopy==\"function\"}();var keyNames={3:\"Enter\",8:\"Backspace\",9:\"Tab\",13:\"Enter\",16:\"Shift\",17:\"Ctrl\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Esc\",32:\"Space\",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"Left\",38:\"Up\",39:\"Right\",40:\"Down\",44:\"PrintScrn\",45:\"Insert\",46:\"Delete\",59:\";\",91:\"Mod\",92:\"Mod\",93:\"Mod\",109:\"-\",107:\"=\",127:\"Delete\",186:\";\",187:\"=\",188:\",\",189:\"-\",190:\".\",191:\"/\",192:\"`\",219:\"[\",220:\"\\\\\",221:\"]\",222:\"'\",63276:\"PageUp\",63277:\"PageDown\",63275:\"End\",63273:\"Home\",63234:\"Left\",63232:\"Up\",63235:\"Right\",63233:\"Down\",63302:\"Insert\",63272:\"Delete\"};CodeMirror.keyNames=keyNames;(function(){for(var i=0;i<10;i++)keyNames[i+48]=String(i);for(var i=65;i<=90;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;i<=12;i++)keyNames[i+111]=keyNames[i+63235]=\"F\"+i})();function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,\"ltr\");for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from)f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?\"rtl\":\"ltr\")}}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);if(!order)return line.text.length;return bidiRight(lst(order))}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(cm.doc,line);if(visual!=line)lineN=lineNo(visual);var order=getOrder(visual);var ch=!order?0:order[0].level%2?lineRight(visual):lineLeft(visual);return Pos(lineN,ch)}function lineEnd(cm,lineN){var merged,line;while(merged=collapsedSpanAtEnd(line=getLine(cm.doc,lineN)))lineN=merged.find().to.line;var order=getOrder(line);var ch=!order?line.text.length:order[0].level%2?lineLeft(line):lineRight(line);return Pos(lineN,ch)}function compareBidiLevel(order,a,b){var linedir=order[0].level;if(a==linedir)return true;if(b==linedir)return false;return a<b}var bidiOther;function getBidiPartAt(order,pos){for(var i=0,found;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos){bidiOther=null;return i}if(cur.from==pos||cur.to==pos){if(found==null){found=i}else if(compareBidiLevel(order,cur.level,order[found].level)){bidiOther=found;return i}else{bidiOther=i;return found}}}bidiOther=null;return found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(pos>0&&isExtendingChar.test(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);var pos=getBidiPartAt(bidi,start),part=bidi[pos];var target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);for(;;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to){if(getBidiPartAt(bidi,target)==pos)return target;part=bidi[pos+=dir];return dir>0==part.level%2?part.to:part.from}else{part=bidi[pos+=dir];if(!part)return null;if(dir>0==part.level%2)target=moveInLine(line,part.to,-1,byUnit);else target=moveInLine(line,part.from,1,byUnit)}}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)while(target>0&&isExtendingChar.test(line.text.charAt(target)))target+=dir;return target<0||target>line.text.length?null:target}var bidiOrdering=function(){var lowTypes=\"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL\";var arabicTypes=\"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr\";function charType(code){if(code<=255)return lowTypes.charAt(code);else if(1424<=code&&code<=1524)return\"R\";else if(1536<=code&&code<=1791)return arabicTypes.charAt(code-1536);else if(1792<=code&&code<=2220)return\"r\";else return\"L\"}var bidiRE=/[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;var outerType=\"L\";return function(str){if(!bidiRE.test(str))return false;var len=str.length,types=[];for(var i=0,type;i<len;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;i<len;++i){var type=types[i];if(type==\"m\")types[i]=prev;else prev=type}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(type==\"1\"&&cur==\"r\")types[i]=\"n\";else if(isStrong.test(type)){cur=type;if(type==\"r\")types[i]=\"R\"}}for(var i=1,prev=types[0];i<len-1;++i){var type=types[i];if(type==\"+\"&&prev==\"1\"&&types[i+1]==\"1\")types[i]=\"1\";else if(type==\",\"&&prev==types[i+1]&&(prev==\"1\"||prev==\"n\"))types[i]=prev;prev=type}for(var i=0;i<len;++i){var type=types[i];if(type==\",\")types[i]=\"N\";else if(type==\"%\"){for(var end=i+1;end<len&&types[end]==\"%\";++end){}var replace=i&&types[i-1]==\"!\"||end<len-1&&types[end]==\"1\"?\"1\":\"N\";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(cur==\"L\"&&type==\"1\")types[i]=\"L\";else if(isStrong.test(type))cur=type}for(var i=0;i<len;++i){if(isNeutral.test(types[i])){for(var end=i+1;end<len&&isNeutral.test(types[end]);++end){}var before=(i?types[i-1]:outerType)==\"L\";var after=(end<len-1?types[end]:outerType)==\"L\";var replace=before||after?\"L\":\"R\";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}var order=[],m;for(var i=0;i<len;){if(countsAsLeft.test(types[i])){var start=i;for(++i;i<len&&countsAsLeft.test(types[i]);++i){}order.push({from:start,to:i,level:0})}else{var pos=i,at=order.length;for(++i;i<len&&types[i]!=\"L\";++i){}for(var j=pos;j<i;){if(countsAsNum.test(types[j])){if(pos<j)order.splice(at,0,{from:pos,to:j,level:1});var nstart=j;for(++j;j<i&&countsAsNum.test(types[j]);++j){}order.splice(at,0,{from:nstart,to:j,level:2});pos=j}else++j}if(pos<i)order.splice(at,0,{from:pos,to:i,level:1})}}if(order[0].level==1&&(m=str.match(/^\\s+/))){order[0].from=m[0].length;order.unshift({from:0,to:m[0].length,level:0})}if(lst(order).level==1&&(m=str.match(/\\s+$/))){lst(order).to-=m[0].length;order.push({from:len-m[0].length,to:len,level:0})}if(order[0].level!=lst(order).level)order.push({from:len,to:len,level:order[0].level});return order}}();CodeMirror.version=\"3.13 +\";return CodeMirror}();var Lawnchair=function(options,callback){if(!(this instanceof Lawnchair))return new Lawnchair(options,callback);if(!JSON)throw\"JSON unavailable! Include http://www.json.org/json2.js to fix.\";if(arguments.length<=2){callback=typeof arguments[0]===\"function\"?arguments[0]:arguments[1];options=typeof arguments[0]===\"function\"?{}:arguments[0]||{}}else{throw\"Incorrect # of ctor args!\"}this.record=options.record||\"record\";this.name=options.name||\"records\";var adapter;if(options.adapter){if(typeof options.adapter===\"string\"){options.adapter=[options.adapter]}for(var j=0,k=options.adapter.length;j<k;j++){for(var i=Lawnchair.adapters.length-1;i>=0;i--){if(Lawnchair.adapters[i].adapter===options.adapter[j]){adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:undefined;if(adapter)break}}if(adapter)break}}else{for(var i=0,l=Lawnchair.adapters.length;i<l;i++){adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:undefined;if(adapter)break}}if(!adapter)throw\"No valid adapter.\";for(var j in adapter)this[j]=adapter[j];for(var i=0,l=Lawnchair.plugins.length;i<l;i++)Lawnchair.plugins[i].call(this);this.init(options,callback)};Lawnchair.adapters=[];Lawnchair.adapter=function(id,obj){obj[\"adapter\"]=id;var implementing=\"adapter valid init keys save batch get exists all remove nuke\".split(\" \"),indexOf=this.prototype.indexOf;for(var i in obj){if(indexOf(implementing,i)===-1)throw\"Invalid adapter! Nonstandard method: \"+i}Lawnchair.adapters.splice(0,0,obj)};Lawnchair.plugins=[];Lawnchair.plugin=function(obj){for(var i in obj)i===\"init\"?Lawnchair.plugins.push(obj[i]):this.prototype[i]=obj[i]};Lawnchair.prototype={isArray:Array.isArray||function(o){return Object.prototype.toString.call(o)===\"[object Array]\"},indexOf:function(ary,item,i,l){if(ary.indexOf)return ary.indexOf(item);for(i=0,l=ary.length;i<l;i++)if(ary[i]===item)return i;return-1},lambda:function(callback){return this.fn(this.record,callback)},fn:function(name,callback){return typeof callback==\"string\"?new Function(name,callback):callback},uuid:function(){var S4=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4()},each:function(callback){var cb=this.lambda(callback);if(this.__results){for(var i=0,l=this.__results.length;i<l;i++)cb.call(this,this.__results[i],i)}else{this.all(function(r){for(var i=0,l=r.length;i<l;i++)cb.call(this,r[i],i)})}return this}};Lawnchair.adapter(\"window-name\",function(){if(typeof window===\"undefined\"){window={top:{}}}var data={};try{data=JSON.parse(window.top.name)}catch(e){}return{valid:function(){return typeof window.top.name!=\"undefined\"},init:function(options,callback){data[this.name]=data[this.name]||{index:[],store:{}};this.index=data[this.name].index;this.store=data[this.name].store;this.fn(this.name,callback).call(this,this);return this},keys:function(callback){this.fn(\"keys\",callback).call(this,this.index);return this},save:function(obj,cb){var key=obj.key||this.uuid();this.exists(key,function(exists){if(!exists){if(obj.key)delete obj.key;this.index.push(key)}this.store[key]=obj;try{window.top.name=JSON.stringify(data)}catch(e){if(!exists){this.index.pop();delete this.store[key]}throw e}if(cb){obj.key=key;this.lambda(cb).call(this,obj)}});return this},batch:function(objs,cb){var r=[];for(var i=0,l=objs.length;i<l;i++){this.save(objs[i],function(record){r.push(record)})}if(cb)this.lambda(cb).call(this,r);return this},get:function(keyOrArray,cb){var r;if(this.isArray(keyOrArray)){r=[];for(var i=0,l=keyOrArray.length;i<l;i++){r.push(this.store[keyOrArray[i]])}}else{r=this.store[keyOrArray];if(r)r.key=keyOrArray}if(cb)this.lambda(cb).call(this,r);return this},exists:function(key,cb){this.lambda(cb).call(this,!!this.store[key]);return this},all:function(cb){var r=[];for(var i=0,l=this.index.length;i<l;i++){var obj=this.store[this.index[i]];obj.key=this.index[i];r.push(obj)}this.fn(this.name,cb).call(this,r);return this},remove:function(keyOrArray,cb){var del=this.isArray(keyOrArray)?keyOrArray:[keyOrArray];for(var i=0,l=del.length;i<l;i++){var key=del[i].key?del[i].key:del[i];var where=this.indexOf(this.index,key);if(where<0)continue;delete this.store[key];this.index.splice(where,1)}window.top.name=JSON.stringify(data);if(cb)this.lambda(cb).call(this);return this},nuke:function(cb){this.store=data[this.name].store={};this.index=data[this.name].index=[];window.top.name=JSON.stringify(data);if(cb)this.lambda(cb).call(this);return this}}}());Lawnchair.adapter(\"dom\",function(){var storage=window.localStorage;var indexer=function(name){return{key:name+\"._index_\",all:function(){var a=storage.getItem(JSON.stringify(this.key));if(a){a=JSON.parse(a)}if(a===null)storage.setItem(JSON.stringify(this.key),JSON.stringify([]));return JSON.parse(storage.getItem(JSON.stringify(this.key)))},add:function(key){var a=this.all();a.push(key);storage.setItem(JSON.stringify(this.key),JSON.stringify(a))},del:function(key){var a=this.all(),r=[];for(var i=0,l=a.length;i<l;i++){if(a[i]!=key)r.push(a[i])}storage.setItem(JSON.stringify(this.key),JSON.stringify(r))},find:function(key){var a=this.all();for(var i=0,l=a.length;i<l;i++){if(key===a[i])return i}return false}}};return{valid:function(){return!!storage&&function(){var success=true;var value=Math.random();try{storage.setItem(value,value)}catch(e){success=false}storage.removeItem(value);return success}()},init:function(options,callback){this.indexer=indexer(this.name);if(callback)this.fn(this.name,callback).call(this,this)},save:function(obj,callback){var key=obj.key?this.name+\".\"+obj.key:this.name+\".\"+this.uuid();delete obj.key;storage.setItem(key,JSON.stringify(obj));if(this.indexer.find(key)===false)this.indexer.add(key);obj.key=key.slice(this.name.length+1);if(callback){this.lambda(callback).call(this,obj)}return this},batch:function(ary,callback){var saved=[];for(var i=0,l=ary.length;i<l;i++){this.save(ary[i],function(r){saved.push(r)})}if(callback)this.lambda(callback).call(this,saved);return this},keys:function(callback){if(callback){var name=this.name;var indices=this.indexer.all();var keys=[];if(Array.prototype.map){keys=indices.map(function(r){return r.replace(name+\".\",\"\")})}else{for(var key in indices){keys.push(key.replace(name+\".\",\"\"))}}this.fn(\"keys\",callback).call(this,keys)}return this},get:function(key,callback){if(this.isArray(key)){var r=[];for(var i=0,l=key.length;i<l;i++){var k=this.name+\".\"+key[i];var obj=storage.getItem(k);if(obj){obj=JSON.parse(obj);obj.key=key[i]}r.push(obj)}if(callback)this.lambda(callback).call(this,r)}else{var k=this.name+\".\"+key;var obj=storage.getItem(k);if(obj){obj=JSON.parse(obj);obj.key=key}if(callback)this.lambda(callback).call(this,obj)}return this},exists:function(key,cb){var exists=this.indexer.find(this.name+\".\"+key)===false?false:true;this.lambda(cb).call(this,exists);return this},all:function(callback){var idx=this.indexer.all(),r=[],o,k;for(var i=0,l=idx.length;i<l;i++){k=idx[i];o=JSON.parse(storage.getItem(k));o.key=k.replace(this.name+\".\",\"\");r.push(o)}if(callback)this.fn(this.name,callback).call(this,r);return this},remove:function(keyOrArray,callback){var self=this;if(this.isArray(keyOrArray)){var i,done=keyOrArray.length;var removeOne=function(i){self.remove(keyOrArray[i],function(){if(--done>0){return}if(callback){self.lambda(callback).call(self)}})};for(i=0;i<keyOrArray.length;i++)removeOne(i);return this}var key=this.name+\".\"+(keyOrArray.key?keyOrArray.key:keyOrArray);this.indexer.del(key);storage.removeItem(key);if(callback)this.lambda(callback).call(this);return this},nuke:function(callback){this.all(function(r){for(var i=0,l=r.length;i<l;i++){this.remove(r[i])}if(callback)this.lambda(callback).call(this)});return this}}}());(function(){var ie_lt8=/MSIE \\d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var Pos=CodeMirror.Pos;var matching={\"(\":\")>\",\")\":\"(<\",\"[\":\"]>\",\"]\":\"[<\",\"{\":\"}>\",\"}\":\"{<\"};function findMatchingBracket(cm){var maxScanLen=cm.state._matchBrackets.maxScanLineLength||1e4;var cur=cm.getCursor(),line=cm.getLineHandle(cur.line),pos=cur.ch-1;var match=pos>=0&&matching[line.text.charAt(pos)]||matching[line.text.charAt(++pos)];if(!match)return null;var forward=match.charAt(1)==\">\",d=forward?1:-1;var style=cm.getTokenAt(Pos(cur.line,pos+1)).type;var stack=[line.text.charAt(pos)],re=/[(){}[\\]]/;function scan(line,lineNo,start){if(!line.text)return;var pos=forward?0:line.text.length-1,end=forward?line.text.length:-1;if(line.text.length>maxScanLen)return null;var checkTokenStyles=line.text.length<1e3;if(start!=null)pos=start+d;for(;pos!=end;pos+=d){var ch=line.text.charAt(pos);if(re.test(ch)&&(!checkTokenStyles||cm.getTokenAt(Pos(lineNo,pos+1)).type==style)){var match=matching[ch];if(match.charAt(1)==\">\"==forward)stack.push(ch);else if(stack.pop()!=match.charAt(0))return{pos:pos,match:false};else if(!stack.length)return{pos:pos,match:true}}}}for(var i=cur.line,found,e=forward?Math.min(i+100,cm.lineCount()):Math.max(-1,i-100);i!=e;i+=d){if(i==cur.line)found=scan(line,i,pos);else found=scan(cm.getLineHandle(i),i);if(found)break}return{from:Pos(cur.line,pos),to:found&&Pos(i,found.pos),match:found&&found.match}}function matchBrackets(cm,autoclear){var maxHighlightLen=cm.state._matchBrackets.maxHighlightLineLength||1e3;var found=findMatchingBracket(cm);if(!found||cm.getLine(found.from.line).length>maxHighlightLen||found.to&&cm.getLine(found.to.line).length>maxHighlightLen)return;var style=found.match?\"CodeMirror-matchingbracket\":\"CodeMirror-nonmatchingbracket\";var one=cm.markText(found.from,Pos(found.from.line,found.from.ch+1),{className:style});var two=found.to&&cm.markText(found.to,Pos(found.to.line,found.to.ch+1),{className:style});if(ie_lt8&&cm.state.focused)cm.display.input.focus();var clear=function(){cm.operation(function(){one.clear();two&&two.clear()})};if(autoclear)setTimeout(clear,800);else return clear}var currentlyHighlighted=null;function doMatchBrackets(cm){cm.operation(function(){if(currentlyHighlighted){currentlyHighlighted();currentlyHighlighted=null}if(!cm.somethingSelected())currentlyHighlighted=matchBrackets(cm,false)})}CodeMirror.defineOption(\"matchBrackets\",false,function(cm,val,old){if(old&&old!=CodeMirror.Init)cm.off(\"cursorActivity\",doMatchBrackets);if(val){cm.state._matchBrackets=typeof val==\"object\"?val:{};cm.on(\"cursorActivity\",doMatchBrackets)}});CodeMirror.defineExtension(\"matchBrackets\",function(){matchBrackets(this,true)});CodeMirror.defineExtension(\"findMatchingBracket\",function(){return findMatchingBracket(this)})})();(function($){if(typeof $.fn.each2==\"undefined\"){$.fn.extend({each2:function(c){var j=$([0]),i=-1,l=this.length;while(++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==false);return this}})}})(jQuery);(function($,undefined){\"use strict\";if(window.Select2!==undefined){return}var KEY,AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer;KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){k=k.which?k.which:k;switch(k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return true}return false},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return true}if(e.metaKey)return true;return false},isFunctionKey:function(k){k=k.which?k.which:k;return k>=112&&k<=123}};nextUid=function(){var counter=1;return function(){return counter++}}();function indexOf(value,array){var i=0,l=array.length,v;if(typeof value===\"undefined\"){return-1}if(value.constructor===String){for(;i<l;i=i+1)if(value.localeCompare(array[i])===0)return i}else{for(;i<l;i=i+1){v=array[i];if(v.constructor===String){if(v.localeCompare(value)===0)return i}else{if(v===value)return i}}}return-1}function equal(a,b){if(a===b)return true;if(a===undefined||b===undefined)return false;if(a===null||b===null)return false;if(a.constructor===String)return a.localeCompare(b)===0;if(b.constructor===String)return b.localeCompare(a)===0;return false}function splitVal(string,separator){var val,i,l;if(string===null||string.length<1)return[];val=string.split(separator);for(i=0,l=val.length;i<l;i=i+1)val[i]=$.trim(val[i]);return val}function getSideBorderPadding(element){return element.outerWidth()-element.width()}function installKeyUpChangeEvent(element){var key=\"keyup-change-value\";element.bind(\"keydown\",function(){if($.data(element,key)===undefined){$.data(element,key,element.val())}});element.bind(\"keyup\",function(){var val=$.data(element,key);if(val!==undefined&&element.val()!==val){$.removeData(element,key);element.trigger(\"keyup-change\")}})}$(document).delegate(\"body\",\"mousemove\",function(e){$.data(document,\"select2-lastpos\",{x:e.pageX,y:e.pageY})});function installFilteredMouseMove(element){element.bind(\"mousemove\",function(e){var lastpos=$.data(document,\"select2-lastpos\");if(lastpos===undefined||lastpos.x!==e.pageX||lastpos.y!==e.pageY){$(e.target).trigger(\"mousemove-filtered\",e)}})}function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(ctx,args)},quietMillis)}}function thunk(formula){var evaluated=false,value;return function(){if(evaluated===false){value=formula();evaluated=true}return value}}function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger(\"scroll-debounced\",e)});element.bind(\"scroll\",function(e){if(indexOf(e.target,element.get())>=0)notify(e)})}function killEvent(event){event.preventDefault();event.stopPropagation()}function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$(\"<div></div>\").css({position:\"absolute\",left:\"-10000px\",top:\"-10000px\",display:\"none\",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:\"nowrap\"});$(\"body\").append(sizer)}sizer.text(e.val());return sizer.width()}function markMatch(text,term,markup){var match=text.toUpperCase().indexOf(term.toUpperCase()),tl=term.length;if(match<0){markup.push(text);return}markup.push(text.substring(0,match));markup.push(\"<span class='select2-match'>\");markup.push(text.substring(match,match+tl));markup.push(\"</span>\");markup.push(text.substring(match+tl,text.length))}function ajax(options){var timeout,requestSequence=0,handler=null,quietMillis=options.quietMillis||100;return function(query){window.clearTimeout(timeout);timeout=window.setTimeout(function(){requestSequence+=1;var requestNumber=requestSequence,data=options.data,transport=options.transport||$.ajax,traditional=options.traditional||false,type=options.type||\"GET\";data=data.call(this,query.term,query.page,query.context);if(null!==handler){handler.abort()}handler=transport.call(null,{url:options.url,dataType:options.dataType,data:data,type:type,traditional:traditional,success:function(data){if(requestNumber<requestSequence){return}var results=options.results(data,query.page);query.callback(results)}})},quietMillis)}}function local(options){var data=options,dataText,text=function(item){return\"\"+item.text};if(!$.isArray(data)){text=data.text;if(!$.isFunction(text)){dataText=data.text;text=function(item){return item[dataText]}}data=data.results}return function(query){var t=query.term,filtered={results:[]},process;if(t===\"\"){query.callback({results:data});return}process=function(datum,collection){var group,attr;datum=datum[0];if(datum.children){group={};for(attr in datum){if(datum.hasOwnProperty(attr))group[attr]=datum[attr]}group.children=[];$(datum.children).each2(function(i,childDatum){process(childDatum,group.children)});if(group.children.length){collection.push(group)}}else{if(query.matcher(t,text(datum))){collection.push(datum)}}};$(data).each2(function(i,datum){process(datum,filtered.results)});query.callback(filtered)}}function tags(data){if($.isFunction(data)){return data}return function(query){var t=query.term,filtered={results:[]};$(data).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;if(t===\"\"||query.matcher(t,text)){filtered.results.push(isObject?this:{id:this,text:this})}});query.callback(filtered)}}function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return true;if(!formatter)return false;throw new Error(\"formatterName must be a function or a falsy value\")}function evaluate(val){return $.isFunction(val)?val():val}function countResults(results){var count=0;$.each(results,function(i,item){if(item.children){count+=countResults(item.children)}else{count++}});return count}function defaultTokenizer(input,selection,selectCallback,opts){var original=input,dupe=false,token,index,i,l,separator;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;while(true){index=-1;for(i=0,l=opts.tokenSeparators.length;i<l;i++){separator=opts.tokenSeparators[i];index=input.indexOf(separator);if(index>=0)break}if(index<0)break;token=input.substring(0,index);input=input.substring(index+separator.length);if(token.length>0){token=opts.createSearchChoice(token,selection);if(token!==undefined&&token!==null&&opts.id(token)!==undefined&&opts.id(token)!==null){dupe=false;for(i=0,l=selection.length;i<l;i++){if(equal(opts.id(token),opts.id(selection[i]))){dupe=true;break}}if(!dupe)selectCallback(token)}}}if(original.localeCompare(input)!=0)return input}$(document).ready(function(){$(document).delegate(\"body\",\"mousedown touchend\",function(e){var target=$(e.target).closest(\"div.select2-container\").get(0),attr;if(target){$(document).find(\"div.select2-container-active\").each(function(){if(this!==target)$(this).data(\"select2\").blur()})}else{target=$(e.target).closest(\"div.select2-drop\").get(0);$(document).find(\"div.select2-drop-active\").each(function(){if(this!==target)$(this).data(\"select2\").blur()})}target=$(e.target);attr=target.attr(\"for\");if(\"LABEL\"===e.target.tagName&&attr&&attr.length>0){target=$(\"#\"+attr);\ntarget=target.data(\"select2\");if(target!==undefined){target.focus();e.preventDefault()}}})});function clazz(SuperClass,methods){var constructor=function(){};constructor.prototype=new SuperClass;constructor.prototype.constructor=constructor;constructor.prototype.parent=SuperClass.prototype;constructor.prototype=$.extend(constructor.prototype,methods);return constructor}AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments)}},init:function(opts){var results,search,resultsSelector=\".select2-results\";this.opts=opts=this.prepareOpts(opts);this.id=opts.id;if(opts.element.data(\"select2\")!==undefined&&opts.element.data(\"select2\")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId=\"s2id_\"+(opts.element.attr(\"id\")||\"autogen\"+nextUid());this.containerSelector=\"#\"+this.containerId.replace(/([;&,\\.\\+\\*\\~':\"\\!\\^#$%@\\[\\]\\(\\)=>\\|])/g,\"\\\\$1\");this.container.attr(\"id\",this.containerId);this.body=thunk(function(){return opts.element.closest(\"body\")});if(opts.element.attr(\"class\")!==undefined){this.container.addClass(opts.element.attr(\"class\").replace(/validate\\[[\\S ]+] ?/,\"\"))}this.container.css(evaluate(opts.containerCss));this.container.addClass(evaluate(opts.containerCssClass));this.opts.element.data(\"select2\",this).hide().before(this.container);this.container.data(\"select2\",this);this.dropdown=this.container.find(\".select2-drop\");this.dropdown.addClass(evaluate(opts.dropdownCssClass));this.dropdown.data(\"select2\",this);this.results=results=this.container.find(resultsSelector);this.search=search=this.container.find(\"input.select2-input\");search.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();installFilteredMouseMove(this.results);this.dropdown.delegate(resultsSelector,\"mousemove-filtered\",this.bind(this.highlightUnderEvent));installDebouncedScroll(80,this.results);this.dropdown.delegate(resultsSelector,\"scroll-debounced\",this.bind(this.loadMoreIfNeeded));if($.fn.mousewheel){results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop(),height;if(deltaY>0&&top-deltaY<=0){results.scrollTop(0);killEvent(e)}else if(deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()){results.scrollTop(results.get(0).scrollHeight-results.height());killEvent(e)}})}installKeyUpChangeEvent(search);search.bind(\"keyup-change\",this.bind(this.updateResults));search.bind(\"focus\",function(){search.addClass(\"select2-focused\");if(search.val()===\" \")search.val(\"\")});search.bind(\"blur\",function(){search.removeClass(\"select2-focused\")});this.dropdown.delegate(resultsSelector,\"mouseup\",this.bind(function(e){if($(e.target).closest(\".select2-result-selectable:not(.select2-disabled)\").length>0){this.highlightUnderEvent(e);this.selectHighlighted(e)}else{this.focusSearch()}killEvent(e)}));this.dropdown.bind(\"click mouseup mousedown\",function(e){e.stopPropagation()});if($.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(opts.element.is(\":disabled\")||opts.element.is(\"[readonly='readonly']\"))this.disable()},destroy:function(){var select2=this.opts.element.data(\"select2\");if(select2!==undefined){select2.container.remove();select2.dropdown.remove();select2.opts.element.removeData(\"select2\").unbind(\".select2\").show()}},prepareOpts:function(opts){var element,select,idKey,ajaxUrl;element=opts.element;if(element.get(0).tagName.toLowerCase()===\"select\"){this.select=select=opts.element}if(select){$.each([\"id\",\"multiple\",\"ajax\",\"query\",\"createSearchChoice\",\"initSelection\",\"data\",\"tags\"],function(){if(this in opts){throw new Error(\"Option '\"+this+\"' is not allowed for Select2 when attached to a <select> element.\")}})}opts=$.extend({},{populateResults:function(container,results,query){var populate,data,result,children,id=this.opts.id,self=this;populate=function(results,container,depth){var i,l,result,selectable,compound,node,label,innerContainer,formatted;for(i=0,l=results.length;i<l;i=i+1){result=results[i];selectable=id(result)!==undefined;compound=result.children&&result.children.length>0;node=$(\"<li></li>\");node.addClass(\"select2-results-dept-\"+depth);node.addClass(\"select2-result\");node.addClass(selectable?\"select2-result-selectable\":\"select2-result-unselectable\");if(compound){node.addClass(\"select2-result-with-children\")}node.addClass(self.opts.formatResultCssClass(result));label=$(\"<div></div>\");label.addClass(\"select2-result-label\");formatted=opts.formatResult(result,label,query);if(formatted!==undefined){label.html(self.opts.escapeMarkup(formatted))}node.append(label);if(compound){innerContainer=$(\"<ul></ul>\");innerContainer.addClass(\"select2-result-sub\");populate(result.children,innerContainer,depth+1);node.append(innerContainer)}node.data(\"select2-data\",result);container.append(node)}};populate(results,container,0)}},$.fn.select2.defaults,opts);if(typeof opts.id!==\"function\"){idKey=opts.id;opts.id=function(e){return e[idKey]}}if(select){opts.query=this.bind(function(query){var data={results:[],more:false},term=query.term,children,firstChild,process;process=function(element,collection){var group;if(element.is(\"option\")){if(query.matcher(term,element.text(),element)){collection.push({id:element.attr(\"value\"),text:element.text(),element:element.get(),css:element.attr(\"class\")})}}else if(element.is(\"optgroup\")){group={text:element.attr(\"label\"),children:[],element:element.get(),css:element.attr(\"class\")};element.children().each2(function(i,elm){process(elm,group.children)});if(group.children.length>0){collection.push(group)}}};children=element.children();if(this.getPlaceholder()!==undefined&&children.length>0){firstChild=children[0];if($(firstChild).text()===\"\"){children=children.not(firstChild)}}children.each2(function(i,elm){process(elm,data.results)});query.callback(data)});opts.id=function(e){return e.id};opts.formatResultCssClass=function(data){return data.css}}else{if(!(\"query\"in opts)){if(\"ajax\"in opts){ajaxUrl=opts.element.data(\"ajax-url\");if(ajaxUrl&&ajaxUrl.length>0){opts.ajax.url=ajaxUrl}opts.query=ajax(opts.ajax)}else if(\"data\"in opts){opts.query=local(opts.data)}else if(\"tags\"in opts){opts.query=tags(opts.tags);opts.createSearchChoice=function(term){return{id:term,text:term}};opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator)).each(function(){var id=this,text=this,tags=opts.tags;if($.isFunction(tags))tags=tags();$(tags).each(function(){if(equal(this.id,id)){text=this.text;return false}});data.push({id:id,text:text})});callback(data)}}}}if(typeof opts.query!==\"function\"){throw\"query function not defined for Select2 \"+opts.element.attr(\"id\")}return opts},monitorSource:function(){this.opts.element.bind(\"change.select2\",this.bind(function(e){if(this.opts.element.data(\"select2-change-triggered\")!==true){this.initSelection()}}))},triggerChange:function(details){details=details||{};details=$.extend({},details,{type:\"change\",val:this.val()});this.opts.element.data(\"select2-change-triggered\",true);this.opts.element.trigger(details);this.opts.element.data(\"select2-change-triggered\",false);this.opts.element.click();if(this.opts.blurOnChange)this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass(\"select2-container-disabled\")},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass(\"select2-container-disabled\")},opened:function(){return this.container.hasClass(\"select2-dropdown-open\")},positionDropdown:function(){var offset=this.container.offset(),height=this.container.outerHeight(),width=this.container.outerWidth(),dropHeight=this.dropdown.outerHeight(),viewportBottom=$(window).scrollTop()+document.documentElement.clientHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=offset.top-dropHeight>=this.body().scrollTop(),aboveNow=this.dropdown.hasClass(\"select2-drop-above\"),bodyOffset,above,css;if(this.body().css(\"position\")!==\"static\"){bodyOffset=this.body().offset();dropTop-=bodyOffset.top;dropLeft-=bodyOffset.left}if(aboveNow){above=true;if(!enoughRoomAbove&&enoughRoomBelow)above=false}else{above=false;if(!enoughRoomBelow&&enoughRoomAbove)above=true}if(above){dropTop=offset.top-dropHeight;this.container.addClass(\"select2-drop-above\");this.dropdown.addClass(\"select2-drop-above\")}else{this.container.removeClass(\"select2-drop-above\");this.dropdown.removeClass(\"select2-drop-above\")}css=$.extend({top:dropTop,left:dropLeft,width:width},evaluate(this.opts.dropdownCss));this.dropdown.css(css)},shouldOpen:function(){var event;if(this.opened())return false;event=$.Event(\"open\");this.opts.element.trigger(event);return!event.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass(\"select2-drop-above\");this.dropdown.removeClass(\"select2-drop-above\")},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var cid=this.containerId,selector=this.containerSelector,scroll=\"scroll.\"+cid,resize=\"resize.\"+cid;this.container.parents().each(function(){$(this).bind(scroll,function(){var s2=$(selector);if(s2.length==0){$(this).unbind(scroll)}s2.select2(\"close\")})});$(window).bind(resize,function(){var s2=$(selector);if(s2.length==0){$(window).unbind(resize)}s2.select2(\"close\")});this.clearDropdownAlignmentPreference();if(this.search.val()===\" \"){this.search.val(\"\")}this.container.addClass(\"select2-dropdown-open\").addClass(\"select2-container-active\");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.dropdown.show();this.positionDropdown();this.dropdown.addClass(\"select2-drop-active\");this.ensureHighlightVisible();this.focusSearch()},close:function(){if(!this.opened())return;var self=this;this.container.parents().each(function(){$(this).unbind(\"scroll.\"+self.containerId)});$(window).unbind(\"resize.\"+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass(\"select2-dropdown-open\").removeClass(\"select2-container-active\");this.results.empty();this.clearSearch();this.opts.element.trigger($.Event(\"close\"))},clearSearch:function(){},ensureHighlightVisible:function(){var results=this.results,children,index,child,hb,rb,y,more;index=this.highlight();if(index<0)return;if(index==0){results.scrollTop(0);return}children=results.find(\".select2-result-selectable\");child=$(children[index]);hb=child.offset().top+child.outerHeight();if(index===children.length-1){more=results.find(\"li.select2-more-results\");if(more.length>0){hb=more.offset().top+more.outerHeight()}}rb=results.offset().top+results.outerHeight();if(hb>rb){results.scrollTop(results.scrollTop()+(hb-rb))}y=child.offset().top-results.offset().top;if(y<0){results.scrollTop(results.scrollTop()+y)}},moveHighlight:function(delta){var choices=this.results.find(\".select2-result-selectable\"),index=this.highlight();while(index>-1&&index<choices.length){index+=delta;var choice=$(choices[index]);if(choice.hasClass(\"select2-result-selectable\")&&!choice.hasClass(\"select2-disabled\")){this.highlight(index);break}}},highlight:function(index){var choices=this.results.find(\".select2-result-selectable\").not(\".select2-disabled\");if(arguments.length===0){return indexOf(choices.filter(\".select2-highlighted\")[0],choices.get())}if(index>=choices.length)index=choices.length-1;if(index<0)index=0;choices.removeClass(\"select2-highlighted\");$(choices[index]).addClass(\"select2-highlighted\");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(\".select2-result-selectable\").not(\".select2-disabled\").length},highlightUnderEvent:function(event){var el=$(event.target).closest(\".select2-result-selectable\");if(el.length>0&&!el.is(\".select2-highlighted\")){var choices=this.results.find(\".select2-result-selectable\");this.highlight(choices.index(el))}else if(el.length==0){this.results.find(\".select2-highlighted\").removeClass(\"select2-highlighted\")}},loadMoreIfNeeded:function(){var results=this.results,more=results.find(\"li.select2-more-results\"),below,offset=-1,page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;if(more.length===0)return;below=more.offset().top-results.offset().top-results.height();if(below<=0){more.addClass(\"select2-active\");this.opts.query({term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){if(!self.opened())return;self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context});if(data.more===true){more.detach().appendTo(results).text(self.opts.formatLoadMore(page+1));window.setTimeout(function(){self.loadMoreIfNeeded()},10)}else{more.remove()}self.positionDropdown();self.resultsPage=page})})}},tokenize:function(){},updateResults:function(initial){var search=this.search,results=this.results,opts=this.opts,data,self=this,input;if(initial!==true&&(this.showSearchInput===false||!this.opened())){return}search.addClass(\"select2-active\");function postRender(){results.scrollTop(0);search.removeClass(\"select2-active\");self.positionDropdown()}function render(html){results.html(self.opts.escapeMarkup(html));postRender()}if(opts.maximumSelectionSize>=1){data=this.data();if($.isArray(data)&&data.length>=opts.maximumSelectionSize&&checkFormatter(opts.formatSelectionTooBig,\"formatSelectionTooBig\")){render(\"<li class='select2-selection-limit'>\"+opts.formatSelectionTooBig(opts.maximumSelectionSize)+\"</li>\");return}}if(search.val().length<opts.minimumInputLength&&checkFormatter(opts.formatInputTooShort,\"formatInputTooShort\")){render(\"<li class='select2-no-results'>\"+opts.formatInputTooShort(search.val(),opts.minimumInputLength)+\"</li>\");return}else{render(\"<li class='select2-searching'>\"+opts.formatSearching()+\"</li>\")}input=this.tokenize();if(input!=undefined&&input!=null){search.val(input)}this.resultsPage=1;opts.query({term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;if(!this.opened())return;this.context=data.context===undefined?null:data.context;if(this.opts.createSearchChoice&&search.val()!==\"\"){def=this.opts.createSearchChoice.call(null,search.val(),data.results);if(def!==undefined&&def!==null&&self.id(def)!==undefined&&self.id(def)!==null){if($(data.results).filter(function(){return equal(self.id(this),self.id(def))}).length===0){data.results.unshift(def)}}}if(data.results.length===0&&checkFormatter(opts.formatNoMatches,\"formatNoMatches\")){render(\"<li class='select2-no-results'>\"+opts.formatNoMatches(search.val())+\"</li>\");return}results.empty();self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null});if(data.more===true&&checkFormatter(opts.formatLoadMore,\"formatLoadMore\")){results.append(\"<li class='select2-more-results'>\"+self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage))+\"</li>\");window.setTimeout(function(){self.loadMoreIfNeeded()},10)}this.postprocessResults(data,initial);postRender()})})},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass(\"select2-container-active\");this.dropdown.removeClass(\"select2-drop-active\");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\")},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var index=this.highlight(),highlighted=this.results.find(\".select2-highlighted\").not(\".select2-disabled\"),data=highlighted.closest(\".select2-result-selectable\").data(\"select2-data\");if(data){highlighted.addClass(\"select2-disabled\");this.highlight(index);this.onSelect(data)}},getPlaceholder:function(){return this.opts.element.attr(\"placeholder\")||this.opts.element.attr(\"data-placeholder\")||this.opts.element.data(\"placeholder\")||this.opts.placeholder},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l;if(this.opts.width===\"off\"){return null}else if(this.opts.width===\"element\"){return this.opts.element.outerWidth()===0?\"auto\":this.opts.element.outerWidth()+\"px\"}else if(this.opts.width===\"copy\"||this.opts.width===\"resolve\"){style=this.opts.element.attr(\"style\");if(style!==undefined){attrs=style.split(\";\");for(i=0,l=attrs.length;i<l;i=i+1){matches=attrs[i].replace(/\\s/g,\"\").match(/width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(matches!==null&&matches.length>=1)return matches[1]}}if(this.opts.width===\"resolve\"){style=this.opts.element.css(\"width\");if(style.indexOf(\"%\")>0)return style;return this.opts.element.outerWidth()===0?\"auto\":this.opts.element.outerWidth()+\"px\"}return null}else if($.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}var width=resolveContainerWidth.call(this);if(width!==null){this.container.attr(\"style\",\"width: \"+width)}}});SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(\"<div></div>\",{\"class\":\"select2-container\"}).html([\"    <a href='#' onclick='return false;' class='select2-choice'>\",\"   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>\",\"   <div><b></b></div>\",\"</a>\",\"    <div class='select2-drop select2-offscreen'>\",\"   <div class='select2-search'>\",\"       <input type='text' autocomplete='off' class='select2-input' placeholder='search...'/>\",\"   </div>\",\"   <ul class='select2-results'>\",\"   </ul>\",\"</div>\"].join(\"\"));return container},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass(\"select2-offscreen\")},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.dropdown.removeAttr(\"style\").addClass(\"select2-offscreen\").insertAfter(this.selection).show()},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var selection,container=this.container,dropdown=this.dropdown,clickingInside=false;this.selection=selection=container.find(\".select2-choice\");this.search.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return}if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:case KEY.RIGHT:case KEY.LEFT:this.moveHighlight(e.which===KEY.UP||e.which===KEY.LEFT?-1:1);killEvent(e);return;case KEY.TAB:case KEY.ENTER:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return}}else{if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}this.open();if(e.which===KEY.ENTER){return}}}));this.search.bind(\"focus\",this.bind(function(){this.selection.attr(\"tabIndex\",\"-1\")}));this.search.bind(\"blur\",this.bind(function(){if(!this.opened())this.container.removeClass(\"select2-container-active\");window.setTimeout(this.bind(function(){this.selection.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"))}),10)}));selection.bind(\"mousedown\",this.bind(function(e){clickingInside=true;if(this.opened()){this.close();this.selection.focus()}else if(this.enabled){this.open()}clickingInside=false}));dropdown.bind(\"mousedown\",this.bind(function(){this.search.focus()}));selection.bind(\"focus\",this.bind(function(){this.container.addClass(\"select2-container-active\");this.search.attr(\"tabIndex\",\"-1\")}));selection.bind(\"blur\",this.bind(function(){if(!this.opened()){this.container.removeClass(\"select2-container-active\")}window.setTimeout(this.bind(function(){this.search.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"))}),10)}));selection.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return}if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}if(e.which==KEY.DELETE){if(this.opts.allowClear){this.clear()}return}this.open();if(e.which===KEY.ENTER){killEvent(e);return}if(e.which<48){killEvent(e);return}var keyWritten=String.fromCharCode(e.which).toLowerCase();if(e.shiftKey){keyWritten=keyWritten.toUpperCase()}this.search.focus();this.search.val(keyWritten);killEvent(e)}));selection.delegate(\"abbr\",\"mousedown\",this.bind(function(e){if(!this.enabled)return;this.clear();killEvent(e);this.close();this.triggerChange();this.selection.focus()}));this.setPlaceholder();this.search.bind(\"focus\",this.bind(function(){this.container.addClass(\"select2-container-active\")}))},clear:function(){this.opts.element.val(\"\");this.selection.find(\"span\").empty();this.selection.removeData(\"select2-data\");this.setPlaceholder()},initSelection:function(){var selected;if(this.opts.element.val()===\"\"){this.close();this.setPlaceholder()}else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){if(selected!==undefined&&selected!==null){self.updateSelection(selected);self.close();self.setPlaceholder()}})}},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){opts.initSelection=function(element,callback){var selected=element.find(\":selected\");if($.isFunction(callback))callback({id:selected.attr(\"value\"),text:selected.text()})}}return opts},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.opts.element.val()===\"\"&&placeholder!==undefined){if(this.select&&this.select.find(\"option:first\").text()!==\"\")return;this.selection.find(\"span\").html(this.opts.escapeMarkup(placeholder));this.selection.addClass(\"select2-default\");this.selection.find(\"abbr\").hide()}},postprocessResults:function(data,initial){var selected=0,self=this,showSearchInput=true;this.results.find(\".select2-result-selectable\").each2(function(i,elm){if(equal(self.id(elm.data(\"select2-data\")),self.opts.element.val())){selected=i;return false}});this.highlight(selected);if(initial===true){showSearchInput=this.showSearchInput=countResults(data.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(\".select2-search\")[showSearchInput?\"removeClass\":\"addClass\"](\"select2-search-hidden\");$(this.dropdown,this.container)[showSearchInput?\"addClass\":\"removeClass\"](\"select2-with-searchbox\")}},onSelect:function(data){var old=this.opts.element.val();this.opts.element.val(this.id(data));this.updateSelection(data);this.close();this.selection.focus();if(!equal(old,this.id(data))){this.triggerChange()}},updateSelection:function(data){var container=this.selection.find(\"span\"),formatted;this.selection.data(\"select2-data\",data);container.empty();formatted=this.opts.formatSelection(data,container);if(formatted!==undefined){container.append(this.opts.escapeMarkup(formatted))}this.selection.removeClass(\"select2-default\");if(this.opts.allowClear&&this.getPlaceholder()!==undefined){this.selection.find(\"abbr\").show()}},val:function(){var val,data=null,self=this;if(arguments.length===0){return this.opts.element.val()}val=arguments[0];if(this.select){this.select.val(val).find(\":selected\").each2(function(i,elm){data={id:elm.attr(\"value\"),text:elm.text()};return false});this.updateSelection(data);this.setPlaceholder()}else{if(this.opts.initSelection===undefined){throw new Error(\"cannot call val() if initSelection() is not defined\")}if(!val){this.clear();return}this.opts.element.val(val);this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(!data?\"\":self.id(data));self.updateSelection(data);self.setPlaceholder()})}},clearSearch:function(){this.search.val(\"\")},data:function(value){var data;if(arguments.length===0){data=this.selection.data(\"select2-data\");if(data==undefined)data=null;return data}else{if(!value||value===\"\"){this.clear()}else{this.opts.element.val(!value?\"\":this.id(value));this.updateSelection(value)}}}});MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(\"<div></div>\",{\"class\":\"select2-container select2-container-multi\"}).html([\"    <ul class='select2-choices'>\",\"  <li class='select2-search-field'>\",\"    <input type='text' autocomplete='off' class='select2-input'>\",\"  </li>\",\"</ul>\",\"<div class='select2-drop select2-drop-multi' style='display:none;'>\",\"   <ul class='select2-results'>\",\"   </ul>\",\"</div>\"].join(\"\"));return container},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){opts.initSelection=function(element,callback){var data=[];element.find(\":selected\").each2(function(i,elm){data.push({id:elm.attr(\"value\"),text:elm.text()})});if($.isFunction(callback))callback(data)}}return opts},initContainer:function(){var selector=\".select2-choices\",selection;this.searchContainer=this.container.find(\".select2-search-field\");this.selection=selection=this.container.find(selector);this.search.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.BACKSPACE&&this.search.val()===\"\"){this.close();var choices,selected=selection.find(\".select2-search-choice-focus\");if(selected.length>0){this.unselect(selected.first());this.search.width(10);killEvent(e);return}choices=selection.find(\".select2-search-choice\");if(choices.length>0){choices.last().addClass(\"select2-search-choice-focus\")}}else{selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\")}if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight(e.which===KEY.UP?-1:1);killEvent(e);return;case KEY.ENTER:case KEY.TAB:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return}}if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.BACKSPACE||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}this.open();if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e)}}));this.search.bind(\"keyup\",this.bind(this.resizeSearch));this.search.bind(\"blur\",this.bind(function(e){this.container.removeClass(\"select2-container-active\");this.search.removeClass(\"select2-focused\");this.clearSearch();e.stopImmediatePropagation()}));this.container.delegate(selector,\"mousedown\",this.bind(function(e){if(!this.enabled)return;if($(e.target).closest(\".select2-search-choice\").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();e.preventDefault()}));this.container.delegate(selector,\"focus\",this.bind(function(){if(!this.enabled)return;this.container.addClass(\"select2-container-active\");this.dropdown.addClass(\"select2-drop-active\");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr(\"disabled\")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr(\"disabled\",true)},initSelection:function(){var data;if(this.opts.element.val()===\"\"){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==\"\"){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){if(data!==undefined&&data!==null){self.updateSelection(data);self.close();self.clearSearch()}})}},clearSearch:function(){var placeholder=this.getPlaceholder();if(placeholder!==undefined&&this.getVal().length===0&&this.search.hasClass(\"select2-focused\")===false){this.search.val(placeholder).addClass(\"select2-default\");this.resizeSearch()}else{this.search.val(\" \").width(10)}},clearPlaceholder:function(){if(this.search.hasClass(\"select2-default\")){this.search.val(\"\").removeClass(\"select2-default\")}else{if(this.search.val()===\" \")this.search.val(\"\")}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass(\"select2-focused\")},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each(function(){if(indexOf(self.id(this),ids)<0){ids.push(self.id(this));filtered.push(this)}});data=filtered;this.selection.find(\".select2-search-choice\").remove();$(data).each(function(){self.addSelectedChoice(this)});self.postprocessResults()},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer(input,this.data(),this.bind(this.onSelect),this.opts);if(input!=null&&input!=undefined){this.search.val(input);if(input.length>0){this.open()}}},onSelect:function(data){this.addSelectedChoice(data);if(this.select){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown()}else{this.close()}}this.triggerChange({added:data});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(data){var choice=$(\"<li class='select2-search-choice'>\"+\"    <div></div>\"+\"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>\"+\"</li>\"),id=this.id(data),val=this.getVal(),formatted;formatted=this.opts.formatSelection(data,choice);choice.find(\"div\").replaceWith(\"<div>\"+this.opts.escapeMarkup(formatted)+\"</div>\");choice.find(\".select2-search-choice-close\").bind(\"mousedown\",killEvent).bind(\"click dblclick\",this.bind(function(e){if(!this.enabled)return;$(e.target).closest(\".select2-search-choice\").fadeOut(\"fast\",this.bind(function(){this.unselect($(e.target));this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\");this.close();this.focusSearch()})).dequeue();killEvent(e)})).bind(\"focus\",this.bind(function(){if(!this.enabled)return;this.container.addClass(\"select2-container-active\");this.dropdown.addClass(\"select2-drop-active\")}));choice.data(\"select2-data\",data);choice.insertBefore(this.searchContainer);val.push(id);this.setVal(val)},unselect:function(selected){var val=this.getVal(),data,index;selected=selected.closest(\".select2-search-choice\");if(selected.length===0){throw\"Invalid argument: \"+selected+\". Must be .select2-search-choice\"}data=selected.data(\"select2-data\");index=indexOf(this.id(data),val);if(index>=0){val.splice(index,1);this.setVal(val);if(this.select)this.postprocessResults()}selected.remove();this.triggerChange({removed:data})},postprocessResults:function(){var val=this.getVal(),choices=this.results.find(\".select2-result-selectable\"),compound=this.results.find(\".select2-result-with-children\"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data(\"select2-data\"));if(indexOf(id,val)>=0){choice.addClass(\"select2-disabled\").removeClass(\"select2-result-selectable\")}else{choice.removeClass(\"select2-disabled\").addClass(\"select2-result-selectable\")}});compound.each2(function(i,e){if(e.find(\".select2-result-selectable\").length==0){e.addClass(\"select2-disabled\")}else{e.removeClass(\"select2-disabled\")}});choices.each2(function(i,choice){if(!choice.hasClass(\"select2-disabled\")&&choice.hasClass(\"select2-result-selectable\")){self.highlight(0);return false}})},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10;left=this.search.offset().left;maxWidth=this.selection.width();containerLeft=this.selection.offset().left;searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding;if(searchWidth<minimumWidth){searchWidth=maxWidth-sideBorderPadding}if(searchWidth<40){searchWidth=maxWidth-sideBorderPadding}this.search.width(searchWidth)},getVal:function(){var val;\nif(this.select){val=this.select.val();return val===null?[]:val}else{val=this.opts.element.val();return splitVal(val,this.opts.separator)}},setVal:function(val){var unique;if(this.select){this.select.val(val)}else{unique=[];$(val).each(function(){if(indexOf(this,unique)<0)unique.push(this)});this.opts.element.val(unique.length===0?\"\":unique.join(this.opts.separator))}},val:function(){var val,data=[],self=this;if(arguments.length===0){return this.getVal()}val=arguments[0];if(!val){this.opts.element.val(\"\");this.updateSelection([]);this.clearSearch();return}this.setVal(val);if(this.select){this.select.find(\":selected\").each(function(){data.push({id:$(this).attr(\"value\"),text:$(this).text()})});this.updateSelection(data)}else{if(this.opts.initSelection===undefined){throw new Error(\"val() cannot be called if initSelection() is not defined\")}this.opts.initSelection(this.opts.element,function(data){var ids=$(data).map(self.id);self.setVal(ids);self.updateSelection(data);self.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error(\"Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.\")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var val=[],self=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(\".select2-search-choice\").each(function(){val.push(self.opts.id($(this).data(\"select2-data\")))});this.setVal(val);this.triggerChange()},data:function(values){var self=this,ids;if(arguments.length===0){return this.selection.find(\".select2-search-choice\").map(function(){return $(this).data(\"select2-data\")}).get()}else{if(!values){values=[]}ids=$.map(values,function(e){return self.opts.id(e)});this.setVal(ids);this.updateSelection(values);this.clearSearch()}}});$.fn.select2=function(){var args=Array.prototype.slice.call(arguments,0),opts,select2,value,multiple,allowedMethods=[\"val\",\"destroy\",\"opened\",\"open\",\"close\",\"focus\",\"isFocused\",\"container\",\"onSortStart\",\"onSortEnd\",\"enable\",\"disable\",\"positionDropdown\",\"data\"];this.each(function(){if(args.length===0||typeof args[0]===\"object\"){opts=args.length===0?{}:$.extend({},args[0]);opts.element=$(this);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){multiple=opts.element.attr(\"multiple\")}else{multiple=opts.multiple||false;if(\"tags\"in opts){opts.multiple=multiple=true}}select2=multiple?new MultiSelect2:new SingleSelect2;select2.init(opts)}else if(typeof args[0]===\"string\"){if(indexOf(args[0],allowedMethods)<0){throw\"Unknown method: \"+args[0]}value=undefined;select2=$(this).data(\"select2\");if(select2===undefined)return;if(args[0]===\"container\"){value=select2.container}else{value=select2[args[0]].apply(select2,args.slice(1))}if(value!==undefined){return false}}else{throw\"Invalid arguments to select2 plugin: \"+args}});return value===undefined?this:value};$.fn.select2.defaults={width:\"copy\",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:\"\",dropdownCssClass:\"\",formatResult:function(result,container,query){var markup=[];markMatch(result.text,query.term,markup);return markup.join(\"\")},formatSelection:function(data,container){return data?data.text:undefined},formatResultCssClass:function(data){return undefined},formatNoMatches:function(){return\"No matches found\"},formatInputTooShort:function(input,min){return\"Please enter \"+(min-input.length)+\" more characters\"},formatSelectionTooBig:function(limit){return\"You can only select \"+limit+\" item\"+(limit==1?\"\":\"s\")},formatLoadMore:function(pageNumber){return\"Loading more results...\"},formatSearching:function(){return\"Searching...\"},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(term,text){return text.toUpperCase().indexOf(term.toUpperCase())>=0},separator:\",\",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:function(markup){if(markup&&typeof markup===\"string\"){return markup.replace(/&/g,\"&amp;\")}return markup},blurOnChange:false};window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch},\"class\":{\"abstract\":AbstractSelect2,single:SingleSelect2,multi:MultiSelect2}}})(jQuery);(function(){var window=this;if(!window.localStorage){if(window.globalStorage){try{window.localStorage=window.globalStorage}catch(e){}return}var div=document.createElement(\"div\"),attrKey=\"localStorage\";div.style.display=\"none\";document.getElementsByTagName(\"head\")[0].appendChild(div);if(div.addBehavior){div.addBehavior(\"#default#userdata\");var localStorage=window[\"localStorage\"]={length:0,setItem:function(key,value){div.load(attrKey);key=cleanKey(key);if(!div.getAttribute(key)){this.length++}div.setAttribute(key,value);div.save(attrKey)},getItem:function(key){div.load(attrKey);key=cleanKey(key);return div.getAttribute(key)},removeItem:function(key){div.load(attrKey);key=cleanKey(key);div.removeAttribute(key);div.save(attrKey);this.length--;if(this.length<0){this.length=0}},clear:function(){div.load(attrKey);var i=0;while(attr=div.XMLDocument.documentElement.attributes[i++]){div.removeAttribute(attr.name)}div.save(attrKey);this.length=0},key:function(key){div.load(attrKey);return div.XMLDocument.documentElement.attributes[key]}},cleanKey=function(key){return key.replace(/[^-._0-9A-Za-z\\xb7\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u037d\\u37f-\\u1fff\\u200c-\\u200d\\u203f\\u2040\\u2070-\\u218f]/g,\"-\")};div.load(attrKey);localStorage[\"length\"]=div.XMLDocument.documentElement.attributes.length}}})();!function(root,String){\"use strict\";var nativeTrim=String.prototype.trim;var nativeTrimRight=String.prototype.trimRight;var nativeTrimLeft=String.prototype.trimLeft;var parseNumber=function(source){return source*1||0};var strRepeat=function(str,qty){if(qty<1)return\"\";var result=\"\";while(qty>0){if(qty&1)result+=str;qty>>=1,str+=str}return result};var slice=[].slice;var defaultToWhiteSpace=function(characters){if(characters==null)return\"\\\\s\";else if(characters.source)return characters.source;else return\"[\"+_s.escapeRegExp(characters)+\"]\"};var escapeChars={lt:\"<\",gt:\">\",quot:'\"',apos:\"'\",amp:\"&\"};var reversedEscapeChars={};for(var key in escapeChars){reversedEscapeChars[escapeChars[key]]=key}var sprintf=function(){function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}var str_repeat=strRepeat;var str_format=function(){if(!str_format.cache.hasOwnProperty(arguments[0])){str_format.cache[arguments[0]]=str_format.parse(arguments[0])}return str_format.format.call(null,str_format.cache[arguments[0]],arguments)};str_format.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type=\"\",arg,output=[],i,k,match,pad,pad_character,pad_length;for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i]);if(node_type===\"string\"){output.push(parse_tree[i])}else if(node_type===\"array\"){match=parse_tree[i];if(match[2]){arg=argv[cursor];for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k])){throw new Error(sprintf('[_.sprintf] property \"%s\" does not exist',match[2][k]))}arg=arg[match[2][k]]}}else if(match[1]){arg=argv[match[1]]}else{arg=argv[cursor++]}if(/[^s]/.test(match[8])&&get_type(arg)!=\"number\"){throw new Error(sprintf(\"[_.sprintf] expecting number but found %s\",get_type(arg)))}switch(match[8]){case\"b\":arg=arg.toString(2);break;case\"c\":arg=String.fromCharCode(arg);break;case\"d\":arg=parseInt(arg,10);break;case\"e\":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case\"f\":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case\"o\":arg=arg.toString(8);break;case\"s\":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case\"u\":arg=Math.abs(arg);break;case\"x\":arg=arg.toString(16);break;case\"X\":arg=arg.toString(16).toUpperCase();break}arg=/[def]/.test(match[8])&&match[3]&&arg>=0?\"+\"+arg:arg;pad_character=match[4]?match[4]==\"0\"?\"0\":match[4].charAt(1):\" \";pad_length=match[6]-String(arg).length;pad=match[6]?str_repeat(pad_character,pad_length):\"\";output.push(match[5]?arg+pad:pad+arg)}}return output.join(\"\")};str_format.cache={};str_format.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=[],arg_names=0;while(_fmt){if((match=/^[^\\x25]+/.exec(_fmt))!==null){parse_tree.push(match[0])}else if((match=/^\\x25{2}/.exec(_fmt))!==null){parse_tree.push(\"%\")}else if((match=/^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt))!==null){if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if((field_match=/^([a-z_][a-z_\\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1]);while((replacement_field=replacement_field.substring(field_match[0].length))!==\"\"){if((field_match=/^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1])}else if((field_match=/^\\[(\\d+)\\]/.exec(replacement_field))!==null){field_list.push(field_match[1])}else{throw new Error(\"[_.sprintf] huh?\")}}}else{throw new Error(\"[_.sprintf] huh?\")}match[2]=field_list}else{arg_names|=2}if(arg_names===3){throw new Error(\"[_.sprintf] mixing positional and named placeholders is not (yet) supported\")}parse_tree.push(match)}else{throw new Error(\"[_.sprintf] huh?\")}_fmt=_fmt.substring(match[0].length)}return parse_tree};return str_format}();var _s={VERSION:\"2.3.0\",isBlank:function(str){if(str==null)str=\"\";return/^\\s*$/.test(str)},stripTags:function(str){if(str==null)return\"\";return String(str).replace(/<\\/?[^>]+>/g,\"\")},capitalize:function(str){str=str==null?\"\":String(str);return str.charAt(0).toUpperCase()+str.slice(1)},chop:function(str,step){if(str==null)return[];str=String(str);step=~~step;return step>0?str.match(new RegExp(\".{1,\"+step+\"}\",\"g\")):[str]},clean:function(str){return _s.strip(str).replace(/\\s+/g,\" \")},count:function(str,substr){if(str==null||substr==null)return 0;return String(str).split(substr).length-1},chars:function(str){if(str==null)return[];return String(str).split(\"\")},swapCase:function(str){if(str==null)return\"\";return String(str).replace(/\\S/g,function(c){return c===c.toUpperCase()?c.toLowerCase():c.toUpperCase()})},escapeHTML:function(str){if(str==null)return\"\";return String(str).replace(/[&<>\"']/g,function(m){return\"&\"+reversedEscapeChars[m]+\";\"})},unescapeHTML:function(str){if(str==null)return\"\";return String(str).replace(/\\&([^;]+);/g,function(entity,entityCode){var match;if(entityCode in escapeChars){return escapeChars[entityCode]}else if(match=entityCode.match(/^#x([\\da-fA-F]+)$/)){return String.fromCharCode(parseInt(match[1],16))}else if(match=entityCode.match(/^#(\\d+)$/)){return String.fromCharCode(~~match[1])}else{return entity}})},escapeRegExp:function(str){if(str==null)return\"\";return String(str).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g,\"\\\\$1\")},splice:function(str,i,howmany,substr){var arr=_s.chars(str);arr.splice(~~i,~~howmany,substr);return arr.join(\"\")},insert:function(str,i,substr){return _s.splice(str,i,0,substr)},include:function(str,needle){if(needle===\"\")return true;if(str==null)return false;return String(str).indexOf(needle)!==-1},join:function(){var args=slice.call(arguments),separator=args.shift();if(separator==null)separator=\"\";return args.join(separator)},lines:function(str){if(str==null)return[];return String(str).split(\"\\n\")},reverse:function(str){return _s.chars(str).reverse().join(\"\")},startsWith:function(str,starts){if(starts===\"\")return true;if(str==null||starts==null)return false;str=String(str);starts=String(starts);return str.length>=starts.length&&str.slice(0,starts.length)===starts},endsWith:function(str,ends){if(ends===\"\")return true;if(str==null||ends==null)return false;str=String(str);ends=String(ends);return str.length>=ends.length&&str.slice(str.length-ends.length)===ends},succ:function(str){if(str==null)return\"\";str=String(str);return str.slice(0,-1)+String.fromCharCode(str.charCodeAt(str.length-1)+1)},titleize:function(str){if(str==null)return\"\";return String(str).replace(/(?:^|\\s)\\S/g,function(c){return c.toUpperCase()})},camelize:function(str){return _s.trim(str).replace(/[-_\\s]+(.)?/g,function(match,c){return c.toUpperCase()})},underscored:function(str){return _s.trim(str).replace(/([a-z\\d])([A-Z]+)/g,\"$1_$2\").replace(/[-\\s]+/g,\"_\").toLowerCase()},dasherize:function(str){return _s.trim(str).replace(/([A-Z])/g,\"-$1\").replace(/[-_\\s]+/g,\"-\").toLowerCase()},classify:function(str){return _s.titleize(String(str).replace(/_/g,\" \")).replace(/\\s/g,\"\")},humanize:function(str){return _s.capitalize(_s.underscored(str).replace(/_id$/,\"\").replace(/_/g,\" \"))},trim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrim)return nativeTrim.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(\"^\"+characters+\"+|\"+characters+\"+$\",\"g\"),\"\")},ltrim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrimLeft)return nativeTrimLeft.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(\"^\"+characters+\"+\"),\"\")},rtrim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrimRight)return nativeTrimRight.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(characters+\"+$\"),\"\")},truncate:function(str,length,truncateStr){if(str==null)return\"\";str=String(str);truncateStr=truncateStr||\"...\";length=~~length;return str.length>length?str.slice(0,length)+truncateStr:str},prune:function(str,length,pruneStr){if(str==null)return\"\";str=String(str);length=~~length;pruneStr=pruneStr!=null?String(pruneStr):\"...\";if(str.length<=length)return str;var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?\"A\":\" \"},template=str.slice(0,length+1).replace(/.(?=\\W*\\w*$)/g,tmpl);if(template.slice(template.length-2).match(/\\w\\w/))template=template.replace(/\\s*\\S+$/,\"\");else template=_s.rtrim(template.slice(0,template.length-1));return(template+pruneStr).length>str.length?str:str.slice(0,template.length)+pruneStr},words:function(str,delimiter){if(_s.isBlank(str))return[];return _s.trim(str,delimiter).split(delimiter||/\\s+/)},pad:function(str,length,padStr,type){str=str==null?\"\":String(str);length=~~length;var padlen=0;if(!padStr)padStr=\" \";else if(padStr.length>1)padStr=padStr.charAt(0);switch(type){case\"right\":padlen=length-str.length;return str+strRepeat(padStr,padlen);case\"both\":padlen=length-str.length;return strRepeat(padStr,Math.ceil(padlen/2))+str+strRepeat(padStr,Math.floor(padlen/2));default:padlen=length-str.length;return strRepeat(padStr,padlen)+str}},lpad:function(str,length,padStr){return _s.pad(str,length,padStr)},rpad:function(str,length,padStr){return _s.pad(str,length,padStr,\"right\")},lrpad:function(str,length,padStr){return _s.pad(str,length,padStr,\"both\")},sprintf:sprintf,vsprintf:function(fmt,argv){argv.unshift(fmt);return sprintf.apply(null,argv)},toNumber:function(str,decimals){if(str==null||str==\"\")return 0;str=String(str);var num=parseNumber(parseNumber(str).toFixed(~~decimals));return num===0&&!str.match(/^0+$/)?Number.NaN:num},numberFormat:function(number,dec,dsep,tsep){if(isNaN(number)||number==null)return\"\";number=number.toFixed(~~dec);tsep=tsep||\",\";var parts=number.split(\".\"),fnums=parts[0],decimals=parts[1]?(dsep||\".\")+parts[1]:\"\";return fnums.replace(/(\\d)(?=(?:\\d{3})+$)/g,\"$1\"+tsep)+decimals},strRight:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str},strRightBack:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.lastIndexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str},strLeft:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(0,pos):str},strLeftBack:function(str,sep){if(str==null)return\"\";str+=\"\";sep=sep!=null?\"\"+sep:sep;var pos=str.lastIndexOf(sep);return~pos?str.slice(0,pos):str},toSentence:function(array,separator,lastSeparator,serial){separator=separator||\", \";lastSeparator=lastSeparator||\" and \";var a=array.slice(),lastMember=a.pop();if(array.length>2&&serial)lastSeparator=_s.rtrim(separator)+lastSeparator;return a.length?a.join(separator)+lastSeparator+lastMember:lastMember},toSentenceSerial:function(){var args=slice.call(arguments);args[3]=true;return _s.toSentence.apply(_s,args)},slugify:function(str){if(str==null)return\"\";var from=\" \",to=\"aaaaaaaaceeeeeiiiilnoooooouuuunczz\",regex=new RegExp(defaultToWhiteSpace(from),\"g\");str=String(str).toLowerCase().replace(regex,function(c){var index=from.indexOf(c);return to.charAt(index)||\"-\"});return _s.dasherize(str.replace(/[^\\w\\s-]/g,\"\"))},surround:function(str,wrapper){return[wrapper,str,wrapper].join(\"\")},quote:function(str){return _s.surround(str,'\"')},exports:function(){var result={};for(var prop in this){if(!this.hasOwnProperty(prop)||prop.match(/^(?:include|contains|reverse)$/))continue;result[prop]=this[prop]}return result},repeat:function(str,qty,separator){if(str==null)return\"\";qty=~~qty;if(separator==null)return strRepeat(String(str),qty);for(var repeat=[];qty>0;repeat[--qty]=str){}return repeat.join(separator)},levenshtein:function(str1,str2){if(str1==null&&str2==null)return 0;if(str1==null)return String(str2).length;if(str2==null)return String(str1).length;str1=String(str1);str2=String(str2);var current=[],prev,value;for(var i=0;i<=str2.length;i++)for(var j=0;j<=str1.length;j++){if(i&&j)if(str1.charAt(j-1)===str2.charAt(i-1))value=prev;else value=Math.min(current[j],current[j-1],prev)+1;else value=i+j;prev=current[j];current[j]=value}return current.pop()}};_s.strip=_s.trim;_s.lstrip=_s.ltrim;_s.rstrip=_s.rtrim;_s.center=_s.lrpad;_s.rjust=_s.lpad;_s.ljust=_s.rpad;_s.contains=_s.include;_s.q=_s.quote;if(typeof exports!==\"undefined\"){if(typeof module!==\"undefined\"&&module.exports){module.exports=_s}exports._s=_s}else if(typeof define===\"function\"&&define.amd){define(\"underscore.string\",[],function(){return _s})}else{root._=root._||{};root._.string=root._.str=_s}}(this,String);(function(){\"use strict\";var _camelizeCssPropName=function(){var matcherRegex=/\\-([a-z])/g,replacerFn=function(match,group){return group.toUpperCase()};return function(prop){return prop.replace(matcherRegex,replacerFn)}}();var _getStyle=function(el,prop){var value,camelProp,tagName,possiblePointers,i,len;if(window.getComputedStyle){value=window.getComputedStyle(el,null).getPropertyValue(prop)}else{camelProp=_camelizeCssPropName(prop);if(el.currentStyle){value=el.currentStyle[camelProp]}else{value=el.style[camelProp]}}if(prop===\"cursor\"){if(!value||value===\"auto\"){tagName=el.tagName.toLowerCase();possiblePointers=[\"a\"];for(i=0,len=possiblePointers.length;i<len;i++){if(tagName===possiblePointers[i]){return\"pointer\"}}}}return value};var _elementMouseOver=function(event){if(!ZeroClipboard.prototype._singleton)return;if(!event){event=window.event}var target;if(this!==window){target=this}else if(event.target){target=event.target}else if(event.srcElement){target=event.srcElement}ZeroClipboard.prototype._singleton.setCurrent(target)};var _addEventHandler=function(element,method,func){if(element.addEventListener){element.addEventListener(method,func,false)}else if(element.attachEvent){element.attachEvent(\"on\"+method,func)}};var _removeEventHandler=function(element,method,func){if(element.removeEventListener){element.removeEventListener(method,func,false)}else if(element.detachEvent){element.detachEvent(\"on\"+method,func)}};var _addClass=function(element,value){if(element.addClass){element.addClass(value);return element}if(value&&typeof value===\"string\"){var classNames=(value||\"\").split(/\\s+/);if(element.nodeType===1){if(!element.className){element.className=value}else{var className=\" \"+element.className+\" \",setClass=element.className;for(var c=0,cl=classNames.length;c<cl;c++){if(className.indexOf(\" \"+classNames[c]+\" \")<0){setClass+=\" \"+classNames[c]}}element.className=setClass.replace(/^\\s+|\\s+$/g,\"\")}}}return element};var _removeClass=function(element,value){if(element.removeClass){element.removeClass(value);return element}if(value&&typeof value===\"string\"||value===undefined){var classNames=(value||\"\").split(/\\s+/);if(element.nodeType===1&&element.className){if(value){var className=(\" \"+element.className+\" \").replace(/[\\n\\t]/g,\" \");for(var c=0,cl=classNames.length;c<cl;c++){className=className.replace(\" \"+classNames[c]+\" \",\" \")}element.className=className.replace(/^\\s+|\\s+$/g,\"\")}else{element.className=\"\"}}}return element};var _getZoomFactor=function(){var rect,physicalWidth,logicalWidth,zoomFactor=1;if(typeof document.body.getBoundingClientRect===\"function\"){rect=document.body.getBoundingClientRect();physicalWidth=rect.right-rect.left;logicalWidth=document.body.offsetWidth;zoomFactor=Math.round(physicalWidth/logicalWidth*100)/100}return zoomFactor};var _getDOMObjectPosition=function(obj){var info={left:0,top:0,width:0,height:0,zIndex:999999999};var zi=_getStyle(obj,\"z-index\");if(zi&&zi!==\"auto\"){info.zIndex=parseInt(zi,10)}if(obj.getBoundingClientRect){var rect=obj.getBoundingClientRect();var pageXOffset,pageYOffset,zoomFactor;if(\"pageXOffset\"in window&&\"pageYOffset\"in window){pageXOffset=window.pageXOffset;pageYOffset=window.pageYOffset}else{zoomFactor=_getZoomFactor();pageXOffset=Math.round(document.documentElement.scrollLeft/zoomFactor);pageYOffset=Math.round(document.documentElement.scrollTop/zoomFactor)}var leftBorderWidth=document.documentElement.clientLeft||0;var topBorderWidth=document.documentElement.clientTop||0;info.left=rect.left+pageXOffset-leftBorderWidth;info.top=rect.top+pageYOffset-topBorderWidth;info.width=\"width\"in rect?rect.width:rect.right-rect.left;info.height=\"height\"in rect?rect.height:rect.bottom-rect.top}return info};var _noCache=function(path,options){var useNoCache=!(options&&options.useNoCache===false);if(useNoCache){return(path.indexOf(\"?\")===-1?\"?\":\"&\")+\"nocache=\"+(new Date).getTime()}else{return\"\"}};var _vars=function(options){var str=[];var origins=[];if(options.trustedOrigins){if(typeof options.trustedOrigins===\"string\"){origins.push(options.trustedOrigins)}else if(typeof options.trustedOrigins===\"object\"&&\"length\"in options.trustedOrigins){origins=origins.concat(options.trustedOrigins)}}if(options.trustedDomains){if(typeof options.trustedDomains===\"string\"){origins.push(options.trustedDomains)}else if(typeof options.trustedDomains===\"object\"&&\"length\"in options.trustedDomains){origins=origins.concat(options.trustedDomains)}}if(origins.length){str.push(\"trustedOrigins=\"+encodeURIComponent(origins.join(\",\")))}if(typeof options.amdModuleId===\"string\"&&options.amdModuleId){str.push(\"amdModuleId=\"+encodeURIComponent(options.amdModuleId))}if(typeof options.cjsModuleId===\"string\"&&options.cjsModuleId){str.push(\"cjsModuleId=\"+encodeURIComponent(options.cjsModuleId))}return str.join(\"&\")};var _inArray=function(elem,array){if(array.indexOf){return array.indexOf(elem)}for(var i=0,length=array.length;i<length;i++){if(array[i]===elem){return i}}return-1};var _prepGlue=function(elements){if(typeof elements===\"string\")throw new TypeError(\"ZeroClipboard doesn't accept query strings.\");if(!elements.length)return[elements];return elements};var _dispatchCallback=function(func,element,instance,args,async){if(async){window.setTimeout(function(){func.call(element,instance,args)},0)}else{func.call(element,instance,args)}};var ZeroClipboard=function(elements,options){if(elements)(ZeroClipboard.prototype._singleton||this).glue(elements);if(ZeroClipboard.prototype._singleton)return ZeroClipboard.prototype._singleton;ZeroClipboard.prototype._singleton=this;this.options={};for(var kd in _defaults)this.options[kd]=_defaults[kd];for(var ko in options)this.options[ko]=options[ko];this.handlers={};if(ZeroClipboard.detectFlashSupport())_bridge()};var currentElement,gluedElements=[];ZeroClipboard.prototype.setCurrent=function(element){currentElement=element;this.reposition();var titleAttr=element.getAttribute(\"title\");if(titleAttr){this.setTitle(titleAttr)}var useHandCursor=this.options.forceHandCursor===true||_getStyle(element,\"cursor\")===\"pointer\";_setHandCursor.call(this,useHandCursor);return this};ZeroClipboard.prototype.setText=function(newText){if(newText&&newText!==\"\"){this.options.text=newText;if(this.ready())this.flashBridge.setText(newText)}return this};ZeroClipboard.prototype.setTitle=function(newTitle){if(newTitle&&newTitle!==\"\")this.htmlBridge.setAttribute(\"title\",newTitle);return this};ZeroClipboard.prototype.setSize=function(width,height){if(this.ready())this.flashBridge.setSize(width,height);return this};ZeroClipboard.prototype.setHandCursor=function(enabled){enabled=typeof enabled===\"boolean\"?enabled:!!enabled;_setHandCursor.call(this,enabled);this.options.forceHandCursor=enabled;return this};var _setHandCursor=function(enabled){if(this.ready())this.flashBridge.setHandCursor(enabled)};ZeroClipboard.version=\"1.2.3\";var _defaults={moviePath:\"ZeroClipboard.swf\",trustedOrigins:null,text:null,hoverClass:\"zeroclipboard-is-hover\",activeClass:\"zeroclipboard-is-active\",allowScriptAccess:\"sameDomain\",useNoCache:true,forceHandCursor:false};ZeroClipboard.setDefaults=function(options){for(var ko in options)_defaults[ko]=options[ko]};ZeroClipboard.destroy=function(){ZeroClipboard.prototype._singleton.unglue(gluedElements);var bridge=ZeroClipboard.prototype._singleton.htmlBridge;bridge.parentNode.removeChild(bridge);delete ZeroClipboard.prototype._singleton};ZeroClipboard.detectFlashSupport=function(){var hasFlash=false;if(typeof ActiveXObject===\"function\"){try{if(new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")){hasFlash=true}}catch(error){}}if(!hasFlash&&navigator.mimeTypes[\"application/x-shockwave-flash\"]){hasFlash=true}return hasFlash};var _amdModuleId=null;var _cjsModuleId=null;var _bridge=function(){var flashBridge,len;var client=ZeroClipboard.prototype._singleton;var container=document.getElementById(\"global-zeroclipboard-html-bridge\");if(!container){var opts={};for(var ko in client.options)opts[ko]=client.options[ko];opts.amdModuleId=_amdModuleId;opts.cjsModuleId=_cjsModuleId;var flashvars=_vars(opts);var html='      <object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" id=\"global-zeroclipboard-flash-bridge\" width=\"100%\" height=\"100%\">         <param name=\"movie\" value=\"'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'\"/>         <param name=\"allowScriptAccess\" value=\"'+client.options.allowScriptAccess+'\"/>         <param name=\"scale\" value=\"exactfit\"/>         <param name=\"loop\" value=\"false\"/>         <param name=\"menu\" value=\"false\"/>         <param name=\"quality\" value=\"best\" />         <param name=\"bgcolor\" value=\"#ffffff\"/>         <param name=\"wmode\" value=\"transparent\"/>         <param name=\"flashvars\" value=\"'+flashvars+'\"/>         <embed src=\"'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'\"           loop=\"false\" menu=\"false\"           quality=\"best\" bgcolor=\"#ffffff\"           width=\"100%\" height=\"100%\"           name=\"global-zeroclipboard-flash-bridge\"           allowScriptAccess=\"always\"           allowFullScreen=\"false\"           type=\"application/x-shockwave-flash\"           wmode=\"transparent\"           pluginspage=\"http://www.macromedia.com/go/getflashplayer\"           flashvars=\"'+flashvars+'\"           scale=\"exactfit\">         </embed>       </object>';container=document.createElement(\"div\");container.id=\"global-zeroclipboard-html-bridge\";container.setAttribute(\"class\",\"global-zeroclipboard-container\");container.setAttribute(\"data-clipboard-ready\",false);container.style.position=\"absolute\";container.style.left=\"-9999px\";container.style.top=\"-9999px\";container.style.width=\"15px\";container.style.height=\"15px\";container.style.zIndex=\"9999\";container.innerHTML=html;document.body.appendChild(container)}client.htmlBridge=container;flashBridge=document[\"global-zeroclipboard-flash-bridge\"];if(flashBridge&&(len=flashBridge.length)){flashBridge=flashBridge[len-1]}client.flashBridge=flashBridge||container.children[0].lastElementChild};ZeroClipboard.prototype.resetBridge=function(){this.htmlBridge.style.left=\"-9999px\";this.htmlBridge.style.top=\"-9999px\";this.htmlBridge.removeAttribute(\"title\");this.htmlBridge.removeAttribute(\"data-clipboard-text\");_removeClass(currentElement,this.options.activeClass);currentElement=null;this.options.text=null;return this};ZeroClipboard.prototype.ready=function(){var ready=this.htmlBridge.getAttribute(\"data-clipboard-ready\");return ready===\"true\"||ready===true};ZeroClipboard.prototype.reposition=function(){if(!currentElement)return false;var pos=_getDOMObjectPosition(currentElement);this.htmlBridge.style.top=pos.top+\"px\";this.htmlBridge.style.left=pos.left+\"px\";this.htmlBridge.style.width=pos.width+\"px\";this.htmlBridge.style.height=pos.height+\"px\";this.htmlBridge.style.zIndex=pos.zIndex+1;this.setSize(pos.width,pos.height);return this};ZeroClipboard.dispatch=function(eventName,args){ZeroClipboard.prototype._singleton.receiveEvent(eventName,args)};ZeroClipboard.prototype.on=function(eventName,func){var events=eventName.toString().split(/\\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,\"\");if(!this.handlers[eventName])this.handlers[eventName]=func}if(this.handlers.noflash&&!ZeroClipboard.detectFlashSupport()){this.receiveEvent(\"onNoFlash\",null)}return this};ZeroClipboard.prototype.addEventListener=ZeroClipboard.prototype.on;ZeroClipboard.prototype.off=function(eventName,func){var events=eventName.toString().split(/\\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,\"\");for(var event in this.handlers){if(event===eventName&&this.handlers[event]===func){delete this.handlers[event]}}}return this};ZeroClipboard.prototype.removeEventListener=ZeroClipboard.prototype.off;ZeroClipboard.prototype.receiveEvent=function(eventName,args){eventName=eventName.toString().toLowerCase().replace(/^on/,\"\");var element=currentElement;var performCallbackAsync=true;switch(eventName){case\"load\":if(args&&parseFloat(args.flashVersion.replace(\",\",\".\").replace(/[^0-9\\.]/gi,\"\"))<10){this.receiveEvent(\"onWrongFlash\",{flashVersion:args.flashVersion});return}this.htmlBridge.setAttribute(\"data-clipboard-ready\",true);break;case\"mouseover\":_addClass(element,this.options.hoverClass);break;case\"mouseout\":_removeClass(element,this.options.hoverClass);this.resetBridge();break;case\"mousedown\":_addClass(element,this.options.activeClass);break;case\"mouseup\":_removeClass(element,this.options.activeClass);break;case\"datarequested\":var targetId=element.getAttribute(\"data-clipboard-target\"),targetEl=!targetId?null:document.getElementById(targetId);if(targetEl){var textContent=targetEl.value||targetEl.textContent||targetEl.innerText;if(textContent)this.setText(textContent)}else{var defaultText=element.getAttribute(\"data-clipboard-text\");if(defaultText)this.setText(defaultText)}performCallbackAsync=false;break;case\"complete\":this.options.text=null;break}if(this.handlers[eventName]){var func=this.handlers[eventName];if(typeof func===\"string\"&&typeof window[func]===\"function\"){func=window[func]}if(typeof func===\"function\"){_dispatchCallback(func,element,this,args,performCallbackAsync)}}};ZeroClipboard.prototype.glue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){if(_inArray(elements[i],gluedElements)==-1){gluedElements.push(elements[i]);_addEventHandler(elements[i],\"mouseover\",_elementMouseOver)}}return this};ZeroClipboard.prototype.unglue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){_removeEventHandler(elements[i],\"mouseover\",_elementMouseOver);var arrayIndex=_inArray(elements[i],gluedElements);if(arrayIndex!=-1)gluedElements.splice(arrayIndex,1)}return this};if(typeof define===\"function\"&&define.amd){define([\"require\",\"exports\",\"module\"],function(require,exports,module){_amdModuleId=module&&module.id||null;\nreturn ZeroClipboard})}else if(typeof module===\"object\"&&module&&typeof module.exports===\"object\"&&module.exports){_cjsModuleId=module.id||null;module.exports=ZeroClipboard}else{window.ZeroClipboard=ZeroClipboard}})();var Handlebars={};(function(Handlebars,undefined){Handlebars.VERSION=\"1.0.0\";Handlebars.COMPILER_REVISION=4;Handlebars.REVISION_CHANGES={1:\"<= 1.0.rc.2\",2:\"== 1.0.0-rc.3\",3:\"== 1.0.0-rc.4\",4:\">= 1.0.0\"};Handlebars.helpers={};Handlebars.partials={};var toString=Object.prototype.toString,functionType=\"[object Function]\",objectType=\"[object Object]\";Handlebars.registerHelper=function(name,fn,inverse){if(toString.call(name)===objectType){if(inverse||fn){throw new Handlebars.Exception(\"Arg not supported with multiple helpers\")}Handlebars.Utils.extend(this.helpers,name)}else{if(inverse){fn.not=inverse}this.helpers[name]=fn}};Handlebars.registerPartial=function(name,str){if(toString.call(name)===objectType){Handlebars.Utils.extend(this.partials,name)}else{this.partials[name]=str}};Handlebars.registerHelper(\"helperMissing\",function(arg){if(arguments.length===2){return undefined}else{throw new Error(\"Missing helper: '\"+arg+\"'\")}});Handlebars.registerHelper(\"blockHelperMissing\",function(context,options){var inverse=options.inverse||function(){},fn=options.fn;var type=toString.call(context);if(type===functionType){context=context.call(this)}if(context===true){return fn(this)}else if(context===false||context==null){return inverse(this)}else if(type===\"[object Array]\"){if(context.length>0){return Handlebars.helpers.each(context,options)}else{return inverse(this)}}else{return fn(context)}});Handlebars.K=function(){};Handlebars.createFrame=Object.create||function(object){Handlebars.K.prototype=object;var obj=new Handlebars.K;Handlebars.K.prototype=null;return obj};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:\"debug\",1:\"info\",2:\"warn\",3:\"error\"},log:function(level,obj){if(Handlebars.logger.level<=level){var method=Handlebars.logger.methodMap[level];if(typeof console!==\"undefined\"&&console[method]){console[method].call(console,obj)}}}};Handlebars.log=function(level,obj){Handlebars.logger.log(level,obj)};Handlebars.registerHelper(\"each\",function(context,options){var fn=options.fn,inverse=options.inverse;var i=0,ret=\"\",data;var type=toString.call(context);if(type===functionType){context=context.call(this)}if(options.data){data=Handlebars.createFrame(options.data)}if(context&&typeof context===\"object\"){if(context instanceof Array){for(var j=context.length;i<j;i++){if(data){data.index=i}ret=ret+fn(context[i],{data:data})}}else{for(var key in context){if(context.hasOwnProperty(key)){if(data){data.key=key}ret=ret+fn(context[key],{data:data});i++}}}}if(i===0){ret=inverse(this)}return ret});Handlebars.registerHelper(\"if\",function(conditional,options){var type=toString.call(conditional);if(type===functionType){conditional=conditional.call(this)}if(!conditional||Handlebars.Utils.isEmpty(conditional)){return options.inverse(this)}else{return options.fn(this)}});Handlebars.registerHelper(\"unless\",function(conditional,options){return Handlebars.helpers[\"if\"].call(this,conditional,{fn:options.inverse,inverse:options.fn})});Handlebars.registerHelper(\"with\",function(context,options){var type=toString.call(context);if(type===functionType){context=context.call(this)}if(!Handlebars.Utils.isEmpty(context))return options.fn(context)});Handlebars.registerHelper(\"log\",function(context,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;Handlebars.log(level,context)});var handlebars=function(){var parser={trace:function trace(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:\"error\",5:\"EOF\",14:\"CONTENT\",15:\"COMMENT\",16:\"OPEN_BLOCK\",18:\"CLOSE\",19:\"OPEN_INVERSE\",20:\"OPEN_ENDBLOCK\",22:\"OPEN\",23:\"OPEN_UNESCAPED\",24:\"CLOSE_UNESCAPED\",25:\"OPEN_PARTIAL\",31:\"STRING\",32:\"INTEGER\",33:\"BOOLEAN\",36:\"ID\",37:\"EQUALS\",38:\"DATA\",40:\"SEP\"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];break;case 2:this.$=new yy.ProgramNode([],$$[$0]);break;case 3:this.$=new yy.ProgramNode($$[$0-2],$$[$0]);break;case 4:this.$=new yy.ProgramNode($$[$0-1],[]);break;case 5:this.$=new yy.ProgramNode($$[$0]);break;case 6:this.$=new yy.ProgramNode([],[]);break;case 7:this.$=new yy.ProgramNode([]);break;case 8:this.$=[$$[$0]];break;case 9:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 10:this.$=new yy.BlockNode($$[$0-2],$$[$0-1].inverse,$$[$0-1],$$[$0]);break;case 11:this.$=new yy.BlockNode($$[$0-2],$$[$0-1],$$[$0-1].inverse,$$[$0]);break;case 12:this.$=$$[$0];break;case 13:this.$=$$[$0];break;case 14:this.$=new yy.ContentNode($$[$0]);break;case 15:this.$=new yy.CommentNode($$[$0]);break;case 16:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1]);break;case 17:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1]);break;case 18:this.$=$$[$0-1];break;case 19:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],$$[$0-2][2]===\"&\");break;case 20:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],true);break;case 21:this.$=new yy.PartialNode($$[$0-1]);break;case 22:this.$=new yy.PartialNode($$[$0-2],$$[$0-1]);break;case 23:break;case 24:this.$=[[$$[$0-2]].concat($$[$0-1]),$$[$0]];break;case 25:this.$=[[$$[$0-1]].concat($$[$0]),null];break;case 26:this.$=[[$$[$0-1]],$$[$0]];break;case 27:this.$=[[$$[$0]],null];break;case 28:this.$=[[$$[$0]],null];break;case 29:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 30:this.$=[$$[$0]];break;case 31:this.$=$$[$0];break;case 32:this.$=new yy.StringNode($$[$0]);break;case 33:this.$=new yy.IntegerNode($$[$0]);break;case 34:this.$=new yy.BooleanNode($$[$0]);break;case 35:this.$=$$[$0];break;case 36:this.$=new yy.HashNode($$[$0]);break;case 37:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 38:this.$=[$$[$0]];break;case 39:this.$=[$$[$0-2],$$[$0]];break;case 40:this.$=[$$[$0-2],new yy.StringNode($$[$0])];break;case 41:this.$=[$$[$0-2],new yy.IntegerNode($$[$0])];break;case 42:this.$=[$$[$0-2],new yy.BooleanNode($$[$0])];break;case 43:this.$=[$$[$0-2],$$[$0]];break;case 44:this.$=new yy.PartialNameNode($$[$0]);break;case 45:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0]));break;case 46:this.$=new yy.PartialNameNode(new yy.IntegerNode($$[$0]));break;case 47:this.$=new yy.DataNode($$[$0]);break;case 48:this.$=new yy.IdNode($$[$0]);break;case 49:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]});this.$=$$[$0-2];break;case 50:this.$=[{part:$$[$0]}];break}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function parseError(str,hash){throw new Error(str)},parse:function parse(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext=\"\",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc==\"undefined\")this.lexer.yylloc={};var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError===\"function\")this.parseError=this.yy.parseError;function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n}function lex(){var token;token=self.lexer.lex()||1;if(typeof token!==\"number\"){token=self.symbols_[token]||token}return token}var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state]}else{if(symbol===null||typeof symbol==\"undefined\"){symbol=lex()}action=table[state]&&table[state][symbol]}if(typeof action===\"undefined\"||!action.length||!action[0]){var errStr=\"\";if(!recovering){expected=[];for(p in table[state])if(this.terminals_[p]&&p>2){expected.push(\"'\"+this.terminals_[p]+\"'\")}if(this.lexer.showPosition){errStr=\"Parse error on line \"+(yylineno+1)+\":\\n\"+this.lexer.showPosition()+\"\\nExpecting \"+expected.join(\", \")+\", got '\"+(this.terminals_[symbol]||symbol)+\"'\"}else{errStr=\"Parse error on line \"+(yylineno+1)+\": Unexpected \"+(symbol==1?\"end of input\":\"'\"+(this.terminals_[symbol]||symbol)+\"'\")}this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1){throw new Error(\"Parse Error: multiple actions possible at state: \"+state+\", token: \"+symbol)}switch(action[0]){case 1:stack.push(symbol);vstack.push(this.lexer.yytext);lstack.push(this.lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=this.lexer.yyleng;yytext=this.lexer.yytext;yylineno=this.lexer.yylineno;yyloc=this.lexer.yylloc;if(recovering>0)recovering--}else{symbol=preErrorSymbol;preErrorSymbol=null}break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]}r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!==\"undefined\"){return r}if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len)}stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true}}return true}};var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash)}else{throw new Error(str)}},setInput:function(input){this._input=input;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match=\"\";this.conditionStack=[\"INITIAL\"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\\r\\n?|\\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return ch},unput:function(ch){var len=ch.length;var lines=ch.split(/(?:\\r\\n?|\\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len-1);this.offset-=len;var oldLines=this.match.split(/(?:\\r\\n?|\\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1)this.yylineno-=lines.length-1;var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len]}return this},more:function(){this._more=true;return this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?\"...\":\"\")+past.substr(-20).replace(/\\n/g,\"\")},upcomingInput:function(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length)}return(next.substr(0,20)+(next.length>20?\"...\":\"\")).replace(/\\n/g,\"\")},showPosition:function(){var pre=this.pastInput();var c=new Array(pre.length+1).join(\"-\");return pre+this.upcomingInput()+\"\\n\"+c+\"^\"},next:function(){if(this.done){return this.EOF}if(!this._input)this.done=true;var token,match,tempMatch,index,col,lines;if(!this._more){this.yytext=\"\";this.match=\"\"}var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(!this.options.flex)break}}if(match){lines=match[0].match(/(?:\\r\\n?|\\n).*/g);if(lines)this.yylineno+=lines.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\\r?\\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(token)return token;else return}if(this._input===\"\"){return this.EOF}else{return this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". Unrecognized text.\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})}},lex:function lex(){var r=this.next();if(typeof r!==\"undefined\"){return r}else{return this.lex()}},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){return this.conditionStack.pop()},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function begin(condition){this.begin(condition)}};lexer.options={};lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:yy_.yytext=\"\\\\\";return 14;break;case 1:if(yy_.yytext.slice(-1)!==\"\\\\\")this.begin(\"mu\");if(yy_.yytext.slice(-1)===\"\\\\\")yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-1),this.begin(\"emu\");if(yy_.yytext)return 14;break;case 2:return 14;break;case 3:if(yy_.yytext.slice(-1)!==\"\\\\\")this.popState();if(yy_.yytext.slice(-1)===\"\\\\\")yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-1);return 14;break;case 4:yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-4);this.popState();return 15;break;case 5:return 25;break;case 6:return 16;break;case 7:return 20;break;case 8:return 19;break;case 9:return 19;break;case 10:return 23;break;case 11:return 22;break;case 12:this.popState();this.begin(\"com\");break;case 13:yy_.yytext=yy_.yytext.substr(3,yy_.yyleng-5);this.popState();return 15;break;case 14:return 22;break;case 15:return 37;break;case 16:return 36;break;case 17:return 36;break;case 18:return 40;break;case 19:break;case 20:this.popState();return 24;break;case 21:this.popState();return 18;break;case 22:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2).replace(/\\\\\"/g,'\"');return 31;break;case 23:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2).replace(/\\\\'/g,\"'\");return 31;break;case 24:return 38;break;case 25:return 33;break;case 26:return 33;break;case 27:return 32;break;case 28:return 36;break;case 29:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2);return 36;break;case 30:return\"INVALID\";break;case 31:return 5;break}};lexer.rules=[/^(?:\\\\\\\\(?=(\\{\\{)))/,/^(?:[^\\x00]*?(?=(\\{\\{)))/,/^(?:[^\\x00]+)/,/^(?:[^\\x00]{2,}?(?=(\\{\\{|$)))/,/^(?:[\\s\\S]*?--\\}\\})/,/^(?:\\{\\{>)/,/^(?:\\{\\{#)/,/^(?:\\{\\{\\/)/,/^(?:\\{\\{\\^)/,/^(?:\\{\\{\\s*else\\b)/,/^(?:\\{\\{\\{)/,/^(?:\\{\\{&)/,/^(?:\\{\\{!--)/,/^(?:\\{\\{![\\s\\S]*?\\}\\})/,/^(?:\\{\\{)/,/^(?:=)/,/^(?:\\.(?=[}\\/ ]))/,/^(?:\\.\\.)/,/^(?:[\\/.])/,/^(?:\\s+)/,/^(?:\\}\\}\\})/,/^(?:\\}\\})/,/^(?:\"(\\\\[\"]|[^\"])*\")/,/^(?:'(\\\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\\s]))/,/^(?:false(?=[}\\s]))/,/^(?:-?[0-9]+(?=[}\\s]))/,/^(?:[^\\s!\"#%-,\\.\\/;->@\\[-\\^`\\{-~]+(?=[=}\\s\\/.]))/,/^(?:\\[[^\\]]*\\])/,/^(?:.)/,/^(?:$)/];lexer.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:false},emu:{rules:[3],inclusive:false},com:{rules:[4],inclusive:false},INITIAL:{rules:[0,1,2,31],inclusive:true}};return lexer}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();Handlebars.Parser=handlebars;Handlebars.parse=function(input){if(input.constructor===Handlebars.AST.ProgramNode){return input}Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(input)};Handlebars.AST={};Handlebars.AST.ProgramNode=function(statements,inverse){this.type=\"program\";this.statements=statements;if(inverse){this.inverse=new Handlebars.AST.ProgramNode(inverse)}};Handlebars.AST.MustacheNode=function(rawParams,hash,unescaped){this.type=\"mustache\";this.escaped=!unescaped;this.hash=hash;var id=this.id=rawParams[0];var params=this.params=rawParams.slice(1);var eligibleHelper=this.eligibleHelper=id.isSimple;this.isHelper=eligibleHelper&&(params.length||hash)};Handlebars.AST.PartialNode=function(partialName,context){this.type=\"partial\";this.partialName=partialName;this.context=context};Handlebars.AST.BlockNode=function(mustache,program,inverse,close){var verifyMatch=function(open,close){if(open.original!==close.original){throw new Handlebars.Exception(open.original+\" doesn't match \"+close.original)}};verifyMatch(mustache.id,close);this.type=\"block\";this.mustache=mustache;this.program=program;this.inverse=inverse;if(this.inverse&&!this.program){this.isInverse=true}};Handlebars.AST.ContentNode=function(string){this.type=\"content\";this.string=string};Handlebars.AST.HashNode=function(pairs){this.type=\"hash\";this.pairs=pairs};Handlebars.AST.IdNode=function(parts){this.type=\"ID\";var original=\"\",dig=[],depth=0;for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part;original+=(parts[i].separator||\"\")+part;if(part===\"..\"||part===\".\"||part===\"this\"){if(dig.length>0){throw new Handlebars.Exception(\"Invalid path: \"+original)}else if(part===\"..\"){depth++}else{this.isScoped=true}}else{dig.push(part)}}this.original=original;this.parts=dig;this.string=dig.join(\".\");this.depth=depth;this.isSimple=parts.length===1&&!this.isScoped&&depth===0;this.stringModeValue=this.string};Handlebars.AST.PartialNameNode=function(name){this.type=\"PARTIAL_NAME\";this.name=name.original};Handlebars.AST.DataNode=function(id){this.type=\"DATA\";this.id=id};Handlebars.AST.StringNode=function(string){this.type=\"STRING\";this.original=this.string=this.stringModeValue=string};Handlebars.AST.IntegerNode=function(integer){this.type=\"INTEGER\";this.original=this.integer=integer;this.stringModeValue=Number(integer)};Handlebars.AST.BooleanNode=function(bool){this.type=\"BOOLEAN\";this.bool=bool;this.stringModeValue=bool===\"true\"};Handlebars.AST.CommentNode=function(comment){this.type=\"comment\";this.comment=comment};var errorProps=[\"description\",\"fileName\",\"lineNumber\",\"message\",\"name\",\"number\",\"stack\"];Handlebars.Exception=function(message){var tmp=Error.prototype.constructor.apply(this,arguments);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]]}};Handlebars.Exception.prototype=new Error;Handlebars.SafeString=function(string){this.string=string};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};var escape={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"};var badChars=/[&<>\"'`]/g;var possible=/[&<>\"'`]/;var escapeChar=function(chr){return escape[chr]||\"&amp;\"};Handlebars.Utils={extend:function(obj,value){for(var key in value){if(value.hasOwnProperty(key)){obj[key]=value[key]}}},escapeExpression:function(string){if(string instanceof Handlebars.SafeString){return string.toString()}else if(string==null||string===false){return\"\"}string=string.toString();if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)},isEmpty:function(value){if(!value&&value!==0){return true}else if(toString.call(value)===\"[object Array]\"&&value.length===0){return true}else{return false}}};var Compiler=Handlebars.Compiler=function(){};var JavaScriptCompiler=Handlebars.JavaScriptCompiler=function(){};Compiler.prototype={compiler:Compiler,disassemble:function(){var opcodes=this.opcodes,opcode,out=[],params,param;for(var i=0,l=opcodes.length;i<l;i++){opcode=opcodes[i];if(opcode.opcode===\"DECLARE\"){out.push(\"DECLARE \"+opcode.name+\"=\"+opcode.value)}else{params=[];for(var j=0;j<opcode.args.length;j++){param=opcode.args[j];if(typeof param===\"string\"){param='\"'+param.replace(\"\\n\",\"\\\\n\")+'\"'}params.push(param)}out.push(opcode.opcode+\" \"+params.join(\" \"))}}return out.join(\"\\n\")},equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len){return false}for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||opcode.args.length!==otherOpcode.args.length){return false}for(var j=0;j<opcode.args.length;j++){if(opcode.args[j]!==otherOpcode.args[j]){return false}}}len=this.children.length;if(other.children.length!==len){return false}for(i=0;i<len;i++){if(!this.children[i].equals(other.children[i])){return false}}return true},guid:0,compile:function(program,options){this.children=[];this.depths={list:[]};this.options=options;var knownHelpers=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,\"if\":true,unless:true,\"with\":true,log:true};if(knownHelpers){for(var name in knownHelpers){this.options.knownHelpers[name]=knownHelpers[name]}}return this.program(program)},accept:function(node){return this[node.type](node)},program:function(program){var statements=program.statements,statement;this.opcodes=[];for(var i=0,l=statements.length;i<l;i++){statement=statements[i];this[statement.type](statement)}this.isSimple=l===1;this.depths.list=this.depths.list.sort(function(a,b){return a-b});return this},compileProgram:function(program){var result=(new this.compiler).compile(program,this.options);var guid=this.guid++,depth;this.usePartial=this.usePartial||result.usePartial;this.children[guid]=result;for(var i=0,l=result.depths.list.length;i<l;i++){depth=result.depths.list[i];if(depth<2){continue}else{this.addDepth(depth-1)}}return guid},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;if(program){program=this.compileProgram(program)}if(inverse){inverse=this.compileProgram(inverse)}var type=this.classifyMustache(mustache);if(type===\"helper\"){this.helperMustache(mustache,program,inverse)}else if(type===\"simple\"){this.simpleMustache(mustache);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"emptyHash\");this.opcode(\"blockValue\")}else{this.ambiguousMustache(mustache,program,inverse);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"emptyHash\");this.opcode(\"ambiguousBlockValue\")}this.opcode(\"append\")},hash:function(hash){var pairs=hash.pairs,pair,val;this.opcode(\"pushHash\");for(var i=0,l=pairs.length;i<l;i++){pair=pairs[i];val=pair[1];if(this.options.stringParams){if(val.depth){this.addDepth(val.depth)}this.opcode(\"getContext\",val.depth||0);this.opcode(\"pushStringParam\",val.stringModeValue,val.type)}else{this.accept(val)}this.opcode(\"assignToHash\",pair[0])}this.opcode(\"popHash\")},partial:function(partial){var partialName=partial.partialName;this.usePartial=true;if(partial.context){this.ID(partial.context)}else{this.opcode(\"push\",\"depth0\")}this.opcode(\"invokePartial\",partialName.name);this.opcode(\"append\")},content:function(content){this.opcode(\"appendContent\",content.string)},mustache:function(mustache){var options=this.options;var type=this.classifyMustache(mustache);if(type===\"simple\"){this.simpleMustache(mustache)}else if(type===\"helper\"){this.helperMustache(mustache)}else{this.ambiguousMustache(mustache)}if(mustache.escaped&&!options.noEscape){this.opcode(\"appendEscaped\")}else{this.opcode(\"append\")}},ambiguousMustache:function(mustache,program,inverse){var id=mustache.id,name=id.parts[0],isBlock=program!=null||inverse!=null;this.opcode(\"getContext\",id.depth);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"invokeAmbiguous\",name,isBlock)},simpleMustache:function(mustache){var id=mustache.id;if(id.type===\"DATA\"){this.DATA(id)}else if(id.parts.length){this.ID(id)}else{this.addDepth(id.depth);this.opcode(\"getContext\",id.depth);this.opcode(\"pushContext\")}this.opcode(\"resolvePossibleLambda\")},helperMustache:function(mustache,program,inverse){var params=this.setupFullMustacheParams(mustache,program,inverse),name=mustache.id.parts[0];if(this.options.knownHelpers[name]){this.opcode(\"invokeKnownHelper\",params.length,name)}else if(this.options.knownHelpersOnly){throw new Error(\"You specified knownHelpersOnly, but used the unknown helper \"+name)}else{this.opcode(\"invokeHelper\",params.length,name)}},ID:function(id){this.addDepth(id.depth);this.opcode(\"getContext\",id.depth);var name=id.parts[0];if(!name){this.opcode(\"pushContext\")}else{this.opcode(\"lookupOnContext\",id.parts[0])}for(var i=1,l=id.parts.length;i<l;i++){this.opcode(\"lookup\",id.parts[i])}},DATA:function(data){this.options.data=true;if(data.id.isScoped||data.id.depth){throw new Handlebars.Exception(\"Scoped data references are not supported: \"+data.original)}this.opcode(\"lookupData\");var parts=data.id.parts;for(var i=0,l=parts.length;i<l;i++){this.opcode(\"lookup\",parts[i])}},STRING:function(string){this.opcode(\"pushString\",string.string)},INTEGER:function(integer){this.opcode(\"pushLiteral\",integer.integer)},BOOLEAN:function(bool){this.opcode(\"pushLiteral\",bool.bool)},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:[].slice.call(arguments,1)})},declare:function(name,value){this.opcodes.push({opcode:\"DECLARE\",name:name,value:value})},addDepth:function(depth){if(isNaN(depth)){throw new Error(\"EWOT\")}if(depth===0){return}if(!this.depths[depth]){this.depths[depth]=true;this.depths.list.push(depth)}},classifyMustache:function(mustache){var isHelper=mustache.isHelper;var isEligible=mustache.eligibleHelper;var options=this.options;if(isEligible&&!isHelper){var name=mustache.id.parts[0];if(options.knownHelpers[name]){isHelper=true}else if(options.knownHelpersOnly){isEligible=false}}if(isHelper){return\"helper\"}else if(isEligible){return\"ambiguous\"}else{return\"simple\"}},pushParams:function(params){var i=params.length,param;while(i--){param=params[i];if(this.options.stringParams){if(param.depth){this.addDepth(param.depth)}this.opcode(\"getContext\",param.depth||0);this.opcode(\"pushStringParam\",param.stringModeValue,param.type)}else{this[param.type](param)}}},setupMustacheParams:function(mustache){var params=mustache.params;this.pushParams(params);if(mustache.hash){this.hash(mustache.hash)}else{this.opcode(\"emptyHash\")}return params},setupFullMustacheParams:function(mustache,program,inverse){var params=mustache.params;this.pushParams(params);this.opcode(\"pushProgram\",program);\nthis.opcode(\"pushProgram\",inverse);if(mustache.hash){this.hash(mustache.hash)}else{this.opcode(\"emptyHash\")}return params}};var Literal=function(value){this.value=value};JavaScriptCompiler.prototype={nameLookup:function(parent,name){if(/^[0-9]+$/.test(name)){return parent+\"[\"+name+\"]\"}else if(JavaScriptCompiler.isValidJavaScriptVariableName(name)){return parent+\".\"+name}else{return parent+\"['\"+name+\"']\"}},appendToBuffer:function(string){if(this.environment.isSimple){return\"return \"+string+\";\"}else{return{appendToBuffer:true,content:string,toString:function(){return\"buffer += \"+string+\";\"}}}},initializeBuffer:function(){return this.quotedString(\"\")},namespace:\"Handlebars\",compile:function(environment,options,context,asObject){this.environment=environment;this.options=options||{};Handlebars.log(Handlebars.logger.DEBUG,this.environment.disassemble()+\"\\n\\n\");this.name=this.environment.name;this.isChild=!!context;this.context=context||{programs:[],environments:[],aliases:{}};this.preamble();this.stackSlot=0;this.stackVars=[];this.registers={list:[]};this.compileStack=[];this.inlineStack=[];this.compileChildren(environment,options);var opcodes=environment.opcodes,opcode;this.i=0;for(l=opcodes.length;this.i<l;this.i++){opcode=opcodes[this.i];if(opcode.opcode===\"DECLARE\"){this[opcode.name]=opcode.value}else{this[opcode.opcode].apply(this,opcode.args)}}return this.createFunctionContext(asObject)},nextOpcode:function(){var opcodes=this.environment.opcodes;return opcodes[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var out=[];if(!this.isChild){var namespace=this.namespace;var copies=\"helpers = this.merge(helpers, \"+namespace+\".helpers);\";if(this.environment.usePartial){copies=copies+\" partials = this.merge(partials, \"+namespace+\".partials);\"}if(this.options.data){copies=copies+\" data = data || {};\"}out.push(copies)}else{out.push(\"\")}if(!this.environment.isSimple){out.push(\", buffer = \"+this.initializeBuffer())}else{out.push(\"\")}this.lastContext=0;this.source=out},createFunctionContext:function(asObject){var locals=this.stackVars.concat(this.registers.list);if(locals.length>0){this.source[1]=this.source[1]+\", \"+locals.join(\", \")}if(!this.isChild){for(var alias in this.context.aliases){if(this.context.aliases.hasOwnProperty(alias)){this.source[1]=this.source[1]+\", \"+alias+\"=\"+this.context.aliases[alias]}}}if(this.source[1]){this.source[1]=\"var \"+this.source[1].substring(2)+\";\"}if(!this.isChild){this.source[1]+=\"\\n\"+this.context.programs.join(\"\\n\")+\"\\n\"}if(!this.environment.isSimple){this.source.push(\"return buffer;\")}var params=this.isChild?[\"depth0\",\"data\"]:[\"Handlebars\",\"depth0\",\"helpers\",\"partials\",\"data\"];for(var i=0,l=this.environment.depths.list.length;i<l;i++){params.push(\"depth\"+this.environment.depths.list[i])}var source=this.mergeSource();if(!this.isChild){var revision=Handlebars.COMPILER_REVISION,versions=Handlebars.REVISION_CHANGES[revision];source=\"this.compilerInfo = [\"+revision+\",'\"+versions+\"'];\\n\"+source}if(asObject){params.push(source);return Function.apply(this,params)}else{var functionSource=\"function \"+(this.name||\"\")+\"(\"+params.join(\",\")+\") {\\n  \"+source+\"}\";Handlebars.log(Handlebars.logger.DEBUG,functionSource+\"\\n\\n\");return functionSource}},mergeSource:function(){var source=\"\",buffer;for(var i=0,len=this.source.length;i<len;i++){var line=this.source[i];if(line.appendToBuffer){if(buffer){buffer=buffer+\"\\n    + \"+line.content}else{buffer=line.content}}else{if(buffer){source+=\"buffer += \"+buffer+\";\\n  \";buffer=undefined}source+=line+\"\\n  \"}}return source},blockValue:function(){this.context.aliases.blockHelperMissing=\"helpers.blockHelperMissing\";var params=[\"depth0\"];this.setupParams(0,params);this.replaceStack(function(current){params.splice(1,0,current);return\"blockHelperMissing.call(\"+params.join(\", \")+\")\"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing=\"helpers.blockHelperMissing\";var params=[\"depth0\"];this.setupParams(0,params);var current=this.topStack();params.splice(1,0,current);params[params.length-1]=\"options\";this.source.push(\"if (!\"+this.lastHelper+\") { \"+current+\" = blockHelperMissing.call(\"+params.join(\", \")+\"); }\")},appendContent:function(content){this.source.push(this.appendToBuffer(this.quotedString(content)))},append:function(){this.flushInline();var local=this.popStack();this.source.push(\"if(\"+local+\" || \"+local+\" === 0) { \"+this.appendToBuffer(local)+\" }\");if(this.environment.isSimple){this.source.push(\"else { \"+this.appendToBuffer(\"''\")+\" }\")}},appendEscaped:function(){this.context.aliases.escapeExpression=\"this.escapeExpression\";this.source.push(this.appendToBuffer(\"escapeExpression(\"+this.popStack()+\")\"))},getContext:function(depth){if(this.lastContext!==depth){this.lastContext=depth}},lookupOnContext:function(name){this.push(this.nameLookup(\"depth\"+this.lastContext,name,\"context\"))},pushContext:function(){this.pushStackLiteral(\"depth\"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='\"function\"';this.replaceStack(function(current){return\"typeof \"+current+\" === functionType ? \"+current+\".apply(depth0) : \"+current})},lookup:function(name){this.replaceStack(function(current){return current+\" == null || \"+current+\" === false ? \"+current+\" : \"+this.nameLookup(current,name,\"context\")})},lookupData:function(id){this.push(\"data\")},pushStringParam:function(string,type){this.pushStackLiteral(\"depth\"+this.lastContext);this.pushString(type);if(typeof string===\"string\"){this.pushString(string)}else{this.pushStackLiteral(string)}},emptyHash:function(){this.pushStackLiteral(\"{}\");if(this.options.stringParams){this.register(\"hashTypes\",\"{}\");this.register(\"hashContexts\",\"{}\")}},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var hash=this.hash;this.hash=undefined;if(this.options.stringParams){this.register(\"hashContexts\",\"{\"+hash.contexts.join(\",\")+\"}\");this.register(\"hashTypes\",\"{\"+hash.types.join(\",\")+\"}\")}this.push(\"{\\n    \"+hash.values.join(\",\\n    \")+\"\\n  }\")},pushString:function(string){this.pushStackLiteral(this.quotedString(string))},push:function(expr){this.inlineStack.push(expr);return expr},pushLiteral:function(value){this.pushStackLiteral(value)},pushProgram:function(guid){if(guid!=null){this.pushStackLiteral(this.programExpression(guid))}else{this.pushStackLiteral(null)}},invokeHelper:function(paramSize,name){this.context.aliases.helperMissing=\"helpers.helperMissing\";var helper=this.lastHelper=this.setupHelper(paramSize,name,true);var nonHelper=this.nameLookup(\"depth\"+this.lastContext,name,\"context\");this.push(helper.name+\" || \"+nonHelper);this.replaceStack(function(name){return name+\" ? \"+name+\".call(\"+helper.callParams+\") \"+\": helperMissing.call(\"+helper.helperMissingParams+\")\"})},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+\".call(\"+helper.callParams+\")\")},invokeAmbiguous:function(name,helperCall){this.context.aliases.functionType='\"function\"';this.pushStackLiteral(\"{}\");var helper=this.setupHelper(0,name,helperCall);var helperName=this.lastHelper=this.nameLookup(\"helpers\",name,\"helper\");var nonHelper=this.nameLookup(\"depth\"+this.lastContext,name,\"context\");var nextStack=this.nextStack();this.source.push(\"if (\"+nextStack+\" = \"+helperName+\") { \"+nextStack+\" = \"+nextStack+\".call(\"+helper.callParams+\"); }\");this.source.push(\"else { \"+nextStack+\" = \"+nonHelper+\"; \"+nextStack+\" = typeof \"+nextStack+\" === functionType ? \"+nextStack+\".apply(depth0) : \"+nextStack+\"; }\")},invokePartial:function(name){var params=[this.nameLookup(\"partials\",name,\"partial\"),\"'\"+name+\"'\",this.popStack(),\"helpers\",\"partials\"];if(this.options.data){params.push(\"data\")}this.context.aliases.self=\"this\";this.push(\"self.invokePartial(\"+params.join(\", \")+\")\")},assignToHash:function(key){var value=this.popStack(),context,type;if(this.options.stringParams){type=this.popStack();context=this.popStack()}var hash=this.hash;if(context){hash.contexts.push(\"'\"+key+\"': \"+context)}if(type){hash.types.push(\"'\"+key+\"': \"+type)}hash.values.push(\"'\"+key+\"': (\"+value+\")\")},compiler:JavaScriptCompiler,compileChildren:function(environment,options){var children=environment.children,child,compiler;for(var i=0,l=children.length;i<l;i++){child=children[i];compiler=new this.compiler;var index=this.matchExistingProgram(child);if(index==null){this.context.programs.push(\"\");index=this.context.programs.length;child.index=index;child.name=\"program\"+index;this.context.programs[index]=compiler.compile(child,options,this.context);this.context.environments[index]=child}else{child.index=index;child.name=\"program\"+index}}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child)){return i}}},programExpression:function(guid){this.context.aliases.self=\"this\";if(guid==null){return\"self.noop\"}var child=this.environment.children[guid],depths=child.depths.list,depth;var programParams=[child.index,child.name,\"data\"];for(var i=0,l=depths.length;i<l;i++){depth=depths[i];if(depth===1){programParams.push(\"depth0\")}else{programParams.push(\"depth\"+(depth-1))}}return(depths.length===0?\"self.program(\":\"self.programWithDepth(\")+programParams.join(\", \")+\")\"},register:function(name,val){this.useRegister(name);this.source.push(name+\" = \"+val+\";\")},useRegister:function(name){if(!this.registers[name]){this.registers[name]=true;this.registers.list.push(name)}},pushStackLiteral:function(item){return this.push(new Literal(item))},pushStack:function(item){this.flushInline();var stack=this.incrStack();if(item){this.source.push(stack+\" = \"+item+\";\")}this.compileStack.push(stack);return stack},replaceStack:function(callback){var prefix=\"\",inline=this.isInline(),stack;if(inline){var top=this.popStack(true);if(top instanceof Literal){stack=top.value}else{var name=this.stackSlot?this.topStackName():this.incrStack();prefix=\"(\"+this.push(name)+\" = \"+top+\"),\";stack=this.topStack()}}else{stack=this.topStack()}var item=callback.call(this,stack);if(inline){if(this.inlineStack.length||this.compileStack.length){this.popStack()}this.push(\"(\"+prefix+item+\")\")}else{if(!/^stack/.test(stack)){stack=this.nextStack()}this.source.push(stack+\" = (\"+prefix+item+\");\")}return stack},nextStack:function(){return this.pushStack()},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push(\"stack\"+this.stackSlot)}return this.topStackName()},topStackName:function(){return\"stack\"+this.stackSlot},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];if(entry instanceof Literal){this.compileStack.push(entry)}else{this.pushStack(entry)}}}},isInline:function(){return this.inlineStack.length},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal){return item.value}else{if(!inline){this.stackSlot--}return item}},topStack:function(wrapped){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];if(!wrapped&&item instanceof Literal){return item.value}else{return item}},quotedString:function(str){return'\"'+str.replace(/\\\\/g,\"\\\\\\\\\").replace(/\"/g,'\\\\\"').replace(/\\n/g,\"\\\\n\").replace(/\\r/g,\"\\\\r\").replace(/\\u2028/g,\"\\\\u2028\").replace(/\\u2029/g,\"\\\\u2029\")+'\"'},setupHelper:function(paramSize,name,missingParams){var params=[];this.setupParams(paramSize,params,missingParams);var foundHelper=this.nameLookup(\"helpers\",name,\"helper\");return{params:params,name:foundHelper,callParams:[\"depth0\"].concat(params).join(\", \"),helperMissingParams:missingParams&&[\"depth0\",this.quotedString(name)].concat(params).join(\", \")}},setupParams:function(paramSize,params,useRegister){var options=[],contexts=[],types=[],param,inverse,program;options.push(\"hash:\"+this.popStack());inverse=this.popStack();program=this.popStack();if(program||inverse){if(!program){this.context.aliases.self=\"this\";program=\"self.noop\"}if(!inverse){this.context.aliases.self=\"this\";inverse=\"self.noop\"}options.push(\"inverse:\"+inverse);options.push(\"fn:\"+program)}for(var i=0;i<paramSize;i++){param=this.popStack();params.push(param);if(this.options.stringParams){types.push(this.popStack());contexts.push(this.popStack())}}if(this.options.stringParams){options.push(\"contexts:[\"+contexts.join(\",\")+\"]\");options.push(\"types:[\"+types.join(\",\")+\"]\");options.push(\"hashContexts:hashContexts\");options.push(\"hashTypes:hashTypes\")}if(this.options.data){options.push(\"data:data\")}options=\"{\"+options.join(\",\")+\"}\";if(useRegister){this.register(\"options\",options);params.push(\"options\")}else{params.push(options)}return params.join(\", \")}};var reservedWords=(\"break else new var\"+\" case finally return void\"+\" catch for switch while\"+\" continue function this with\"+\" default if throw\"+\" delete in try\"+\" do instanceof typeof\"+\" abstract enum int short\"+\" boolean export interface static\"+\" byte extends long super\"+\" char final native synchronized\"+\" class float package throws\"+\" const goto private transient\"+\" debugger implements protected volatile\"+\" double import public let yield\").split(\" \");var compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++){compilerWords[reservedWords[i]]=true}JavaScriptCompiler.isValidJavaScriptVariableName=function(name){if(!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(name)){return true}return false};Handlebars.precompile=function(input,options){if(input==null||typeof input!==\"string\"&&input.constructor!==Handlebars.AST.ProgramNode){throw new Handlebars.Exception(\"You must pass a string or Handlebars AST to Handlebars.precompile. You passed \"+input)}options=options||{};if(!(\"data\"in options)){options.data=true}var ast=Handlebars.parse(input);var environment=(new Compiler).compile(ast,options);return(new JavaScriptCompiler).compile(environment,options)};Handlebars.compile=function(input,options){if(input==null||typeof input!==\"string\"&&input.constructor!==Handlebars.AST.ProgramNode){throw new Handlebars.Exception(\"You must pass a string or Handlebars AST to Handlebars.compile. You passed \"+input)}options=options||{};if(!(\"data\"in options)){options.data=true}var compiled;function compile(){var ast=Handlebars.parse(input);var environment=(new Compiler).compile(ast,options);var templateSpec=(new JavaScriptCompiler).compile(environment,options,undefined,true);return Handlebars.template(templateSpec)}return function(context,options){if(!compiled){compiled=compile()}return compiled.call(this,context,options)}};Handlebars.VM={template:function(templateSpec){var container={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(i,fn,data){var programWrapper=this.programs[i];if(data){programWrapper=Handlebars.VM.program(i,fn,data)}else if(!programWrapper){programWrapper=this.programs[i]=Handlebars.VM.program(i,fn)}return programWrapper},merge:function(param,common){var ret=param||common;if(param&&common){ret={};Handlebars.Utils.extend(ret,common);Handlebars.Utils.extend(ret,param)}return ret},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop,compilerInfo:null};return function(context,options){options=options||{};var result=templateSpec.call(container,Handlebars,context,options.helpers,options.partials,options.data);var compilerInfo=container.compilerInfo||[],compilerRevision=compilerInfo[0]||1,currentRevision=Handlebars.COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=Handlebars.REVISION_CHANGES[currentRevision],compilerVersions=Handlebars.REVISION_CHANGES[compilerRevision];throw\"Template was precompiled with an older version of Handlebars than the current runtime. \"+\"Please update your precompiler to a newer version (\"+runtimeVersions+\") or downgrade your runtime to an older version (\"+compilerVersions+\").\"}else{throw\"Template was precompiled with a newer version of Handlebars than the current runtime. \"+\"Please update your runtime to a newer version (\"+compilerInfo[1]+\").\"}}return result}},programWithDepth:function(i,fn,data){var args=Array.prototype.slice.call(arguments,3);var program=function(context,options){options=options||{};return fn.apply(this,[context,options.data||data].concat(args))};program.program=i;program.depth=args.length;return program},program:function(i,fn,data){var program=function(context,options){options=options||{};return fn(context,options.data||data)};program.program=i;program.depth=0;return program},noop:function(){return\"\"},invokePartial:function(partial,name,context,helpers,partials,data){var options={helpers:helpers,partials:partials,data:data};if(partial===undefined){throw new Handlebars.Exception(\"The partial \"+name+\" could not be found\")}else if(partial instanceof Function){return partial(context,options)}else if(!Handlebars.compile){throw new Handlebars.Exception(\"The partial \"+name+\" could not be compiled when running in runtime-only mode\")}else{partials[name]=Handlebars.compile(partial,{data:data!==undefined});return partials[name](context,options)}}};Handlebars.template=Handlebars.VM.template})(Handlebars);function printStackTrace(options){options=options||{guess:true};var ex=options.e||null,guess=!!options.guess;var p=new printStackTrace.implementation,result=p.run(ex);return guess?p.guessAnonymousFunctions(result):result}if(typeof module!==\"undefined\"&&module.exports){module.exports=printStackTrace}printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(ex,mode){ex=ex||this.createException();mode=mode||this.mode(ex);if(mode===\"other\"){return this.other(arguments.callee)}else{return this[mode](ex)}},createException:function(){try{this.undef()}catch(e){return e}},mode:function(e){if(e[\"arguments\"]&&e.stack){return\"chrome\"}else if(e.stack&&e.sourceURL){return\"safari\"}else if(e.stack&&e.number){return\"ie\"}else if(typeof e.message===\"string\"&&typeof window!==\"undefined\"&&window.opera){if(!e.stacktrace){return\"opera9\"}if(e.message.indexOf(\"\\n\")>-1&&e.message.split(\"\\n\").length>e.stacktrace.split(\"\\n\").length){return\"opera9\"}if(!e.stack){return\"opera10a\"}if(e.stacktrace.indexOf(\"called from line\")<0){return\"opera10b\"}return\"opera11\"}else if(e.stack&&!e.fileName){return\"chrome\"}else if(e.stack){return\"firefox\"}return\"other\"},instrumentFunction:function(context,functionName,callback){context=context||window;var original=context[functionName];context[functionName]=function instrumented(){callback.call(this,printStackTrace().slice(4));return context[functionName]._instrumented.apply(this,arguments)};context[functionName]._instrumented=original},deinstrumentFunction:function(context,functionName){if(context[functionName].constructor===Function&&context[functionName]._instrumented&&context[functionName]._instrumented.constructor===Function){context[functionName]=context[functionName]._instrumented}},chrome:function(e){var stack=(e.stack+\"\\n\").replace(/^\\S[^\\(]+?[\\n$]/gm,\"\").replace(/^\\s+(at eval )?at\\s+/gm,\"\").replace(/^([^\\(]+?)([\\n$])/gm,\"{anonymous}()@$1$2\").replace(/^Object.<anonymous>\\s*\\(([^\\)]+)\\)/gm,\"{anonymous}()@$1\").split(\"\\n\");stack.pop();return stack},safari:function(e){return e.stack.replace(/\\[native code\\]\\n/m,\"\").replace(/^(?=\\w+Error\\:).*$\\n/m,\"\").replace(/^@/gm,\"{anonymous}()@\").split(\"\\n\")},ie:function(e){var lineRE=/^.*at (\\w+) \\(([^\\)]+)\\)$/gm;return e.stack.replace(/at Anonymous function /gm,\"{anonymous}()@\").replace(/^(?=\\w+Error\\:).*$\\n/m,\"\").replace(lineRE,\"$1@$2\").split(\"\\n\")},firefox:function(e){return e.stack.replace(/(?:\\n@:0)?\\s+$/m,\"\").replace(/^[\\(@]/gm,\"{anonymous}()@\").split(\"\\n\")},opera11:function(e){var ANON=\"{anonymous}\",lineRE=/^.*line (\\d+), column (\\d+)(?: in (.+))? in (\\S+):$/;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var location=match[4]+\":\"+match[1]+\":\"+match[2];var fnName=match[3]||\"global code\";fnName=fnName.replace(/<anonymous function: (\\S+)>/,\"$1\").replace(/<anonymous function>/,ANON);result.push(fnName+\"@\"+location+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},opera10b:function(e){var lineRE=/^(.*)@(.+):(\\d+)$/;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i++){var match=lineRE.exec(lines[i]);if(match){var fnName=match[1]?match[1]+\"()\":\"global code\";result.push(fnName+\"@\"+match[2]+\":\"+match[3])}}return result},opera10a:function(e){var ANON=\"{anonymous}\",lineRE=/Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var fnName=match[3]||ANON;result.push(fnName+\"()@\"+match[2]+\":\"+match[1]+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},opera9:function(e){var ANON=\"{anonymous}\",lineRE=/Line (\\d+).*script (?:in )?(\\S+)/i;var lines=e.message.split(\"\\n\"),result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(ANON+\"()@\"+match[2]+\":\"+match[1]+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},other:function(curr){var ANON=\"{anonymous}\",fnRE=/function\\s*([\\w\\-$]+)?\\s*\\(/i,stack=[],fn,args,maxStackSize=10;while(curr&&curr[\"arguments\"]&&stack.length<maxStackSize){fn=fnRE.test(curr.toString())?RegExp.$1||ANON:ANON;args=Array.prototype.slice.call(curr[\"arguments\"]||[]);stack[stack.length]=fn+\"(\"+this.stringifyArguments(args)+\")\";curr=curr.caller}return stack},stringifyArguments:function(args){var result=[];var slice=Array.prototype.slice;for(var i=0;i<args.length;++i){var arg=args[i];if(arg===undefined){result[i]=\"undefined\"}else if(arg===null){result[i]=\"null\"}else if(arg.constructor){if(arg.constructor===Array){if(arg.length<3){result[i]=\"[\"+this.stringifyArguments(arg)+\"]\"}else{result[i]=\"[\"+this.stringifyArguments(slice.call(arg,0,1))+\"...\"+this.stringifyArguments(slice.call(arg,-1))+\"]\"}}else if(arg.constructor===Object){result[i]=\"#object\"}else if(arg.constructor===Function){result[i]=\"#function\"}else if(arg.constructor===String){result[i]='\"'+arg+'\"'}else if(arg.constructor===Number){result[i]=arg}}}return result.join(\",\")},sourceCache:{},ajax:function(url){var req=this.createXMLHTTPObject();if(req){try{req.open(\"GET\",url,false);req.send(null);return req.responseText}catch(e){}}return\"\"},createXMLHTTPObject:function(){var xmlhttp,XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject(\"Msxml2.XMLHTTP\")},function(){return new ActiveXObject(\"Msxml3.XMLHTTP\")},function(){return new ActiveXObject(\"Microsoft.XMLHTTP\")}];for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]();this.createXMLHTTPObject=XMLHttpFactories[i];return xmlhttp}catch(e){}}},isSameDomain:function(url){return typeof location!==\"undefined\"&&url.indexOf(location.hostname)!==-1},getSource:function(url){if(!(url in this.sourceCache)){this.sourceCache[url]=this.ajax(url).split(\"\\n\")}return this.sourceCache[url]},guessAnonymousFunctions:function(stack){for(var i=0;i<stack.length;++i){var reStack=/\\{anonymous\\}\\(.*\\)@(.*)/,reRef=/^(.*?)(?::(\\d+))(?::(\\d+))?(?: -- .+)?$/,frame=stack[i],ref=reStack.exec(frame);if(ref){var m=reRef.exec(ref[1]);if(m){var file=m[1],lineno=m[2],charno=m[3]||0;if(file&&this.isSameDomain(file)&&lineno){var functionName=this.guessAnonymousFunction(file,lineno,charno);stack[i]=frame.replace(\"{anonymous}\",functionName)}}}}return stack},guessAnonymousFunction:function(url,lineNo,charNo){var ret;try{ret=this.findFunctionName(this.getSource(url),lineNo)}catch(e){ret=\"getSource failed with url: \"+url+\", exception: \"+e.toString()}return ret},findFunctionName:function(source,lineNo){var reFunctionDeclaration=/function\\s+([^(]*?)\\s*\\(([^)]*)\\)/;var reFunctionExpression=/['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*function\\b/;var reFunctionEvaluation=/['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*(?:eval|new Function)\\b/;var code=\"\",line,maxLines=Math.min(lineNo,20),m,commentPos;for(var i=0;i<maxLines;++i){line=source[lineNo-i-1];commentPos=line.indexOf(\"//\");if(commentPos>=0){line=line.substr(0,commentPos)}if(line){code=line+code;m=reFunctionExpression.exec(code);if(m&&m[1]){return m[1]}m=reFunctionDeclaration.exec(code);if(m&&m[1]){return m[1]}m=reFunctionEvaluation.exec(code);if(m&&m[1]){return m[1]}}}return\"(?)\"}};if(!window.maxkir)maxkir={};maxkir.SelectionRange=function(element){this.element=element};maxkir.SelectionRange.prototype.get_selection_range=function(){var get_sel_range=function(element){if(typeof element.selectionStart==\"undefined\"&&document.selection){var range=document.selection.createRange();var stored_range=range.duplicate();if(element.type==\"text\"){stored_range.moveStart(\"character\",-element.value.length);stored_range.moveEnd(\"character\",element.value.length)}else{stored_range.moveToElementText(element)}stored_range.setEndPoint(\"EndToEnd\",range);var selectionStart=stored_range.text.length-range.text.length;var selectionEnd=selectionStart+range.text.length;return[selectionStart,selectionEnd]}return[element.selectionStart,element.selectionEnd]};try{return get_sel_range(this.element)}catch(e){return[0,0]}};maxkir.SelectionRange.prototype.get_selection_text=function(){var r=this.get_selection_range();return this.element.value.substring(r[0],r[1])};if(!window.maxkir)maxkir={};maxkir.StringSplitter=function(width_provider_function){this.get_width=width_provider_function};maxkir.StringSplitter.prototype.splitString=function(s,max_width){if(s.length==0)return[\"\"];var prev_space_pos=-1;var width_exceeded=false;var that=this;var cut_off=function(idx){var remaining=s.substr(idx+1);if(remaining.length>0){return[s.substr(0,idx+1)].concat(that.splitString(remaining,max_width))}return[s.substr(0,idx+1)]};for(var i=0;i<s.length;i++){if(s.charAt(i)==\" \"){width_exceeded=this.get_width(s.substr(0,i))>max_width;if(width_exceeded&&prev_space_pos>0){return cut_off(prev_space_pos)}if(width_exceeded){return cut_off(i)}prev_space_pos=i}if(s.charAt(i)==\"\\n\"){return cut_off(i)}}if(prev_space_pos>0&&this.get_width(s)>max_width){return cut_off(prev_space_pos)}return[s]};if(!window.maxkir)maxkir={};maxkir.FF=/Firefox/i.test(navigator.userAgent);if(typeof document.defaultView==\"undefined\"){document.defaultView={};document.defaultView.getComputedStyle=function(element){return element.currentStyle}}maxkir.CursorPosition=function(element,padding){this.element=element;this.padding=padding;this.selection_range=new maxkir.SelectionRange(element);var that=this;this.get_string_metrics=function(s){return maxkir.CursorPosition.getTextMetrics(element,s,padding)};var splitter=new maxkir.StringSplitter(function(s){var metrics=that.get_string_metrics(s);return metrics[0]});this.split_to_lines=function(){var innerAreaWidth=element.scrollWidth;if(maxkir.FF){innerAreaWidth-=4}var pos=that.selection_range.get_selection_range()[0];return splitter.splitString(element.value.substr(0,pos),innerAreaWidth)}};maxkir.CursorPosition.prototype.getCursorCoordinates=function(){var lines=this.split_to_lines();return[lines[lines.length-1].length,lines.length]};maxkir.CursorPosition.prototype.getPixelCoordinates=function(){var lines=this.split_to_lines();var m=this.get_string_metrics(lines[lines.length-1]);var w=m[0];var h=m[1]*lines.length-this.element.scrollTop+this.padding;return[w,h]};maxkir.CursorPosition.getTextMetrics=function(styledElement,s,padding){var element=styledElement;var clone_css_style=function(target,styleName){var val=element.style[styleName];if(!val){var css=document.defaultView.getComputedStyle(element,null);val=css?css[styleName]:null}if(val){target.style[styleName]=val}};var widthElementId=\"__widther\";var div=document.getElementById(widthElementId);if(!div){div=document.createElement(\"div\");document.body.appendChild(div);div.id=widthElementId;div.style.position=\"absolute\";div.style.left=\"-10000px\"}clone_css_style(div,\"fontSize\");clone_css_style(div,\"fontFamily\");clone_css_style(div,\"fontWeight\");clone_css_style(div,\"fontVariant\");clone_css_style(div,\"fontStyle\");clone_css_style(div,\"textTransform\");clone_css_style(div,\"lineHeight\");div.style.width=\"0\";div.style.paddingLeft=padding+\"px\";div.innerHTML=s.replace(\" \",\"&nbsp;\");div.style.width=\"auto\";return[div.offsetWidth,div.offsetHeight]};(function($){$.fn.caretpixelpos=function(){if(typeof this.positioner==\"undefined\"){this.positioner=new maxkir.CursorPosition(this[0],7)}var child_pos=this.positioner.getPixelCoordinates();var t_pos=this.offset();return{left:t_pos.left+child_pos[0],top:t_pos.top+child_pos[1],childPos:{left:child_pos[0],top:child_pos[1]}}}}).call(this,jQuery);(function($){\"use strict\";var k={},max=Math.max,min=Math.min;k.c={};k.c.d=$(document);k.c.t=function(e){return e.originalEvent.touches.length-1};k.o=function(){var s=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.run=function(){var cf=function(e,conf){var k;for(k in conf){s.o[k]=conf[k]}s.init();s._configure()._draw()};if(this.$.data(\"kontroled\"))return;this.$.data(\"kontroled\",true);this.extend();this.o=$.extend({min:this.$.data(\"min\")||0,max:this.$.data(\"max\")||100,stopper:true,readOnly:this.$.data(\"readonly\"),cursor:this.$.data(\"cursor\")===true&&30||this.$.data(\"cursor\")||0,thickness:this.$.data(\"thickness\")||.35,lineCap:this.$.data(\"linecap\")||\"butt\",width:this.$.data(\"width\")||200,height:this.$.data(\"height\")||200,displayInput:this.$.data(\"displayinput\")==null||this.$.data(\"displayinput\"),displayPrevious:this.$.data(\"displayprevious\"),fgColor:this.$.data(\"fgcolor\")||\"#87CEEB\",inputColor:this.$.data(\"inputcolor\")||this.$.data(\"fgcolor\")||\"#87CEEB\",inline:false,step:this.$.data(\"step\")||1,draw:null,change:null,cancel:null,release:null},this.o);if(this.$.is(\"fieldset\")){this.v={};this.i=this.$.find(\"input\");this.i.each(function(k){var $this=$(this);s.i[k]=$this;s.v[k]=$this.val();$this.bind(\"change\",function(){var val={};val[k]=$this.val();s.val(val)})});this.$.find(\"legend\").remove()}else{this.i=this.$;this.v=this.$.val();this.v==\"\"&&(this.v=this.o.min);this.$.bind(\"change\",function(){s.val(s._validate(s.$.val()))})}!this.o.displayInput&&this.$.hide();this.$c=$('<canvas width=\"'+this.o.width+'px\" height=\"'+this.o.height+'px\"></canvas>');this.c=this.$c[0].getContext(\"2d\");this.$.wrap($('<div style=\"'+(this.o.inline?\"display:inline;\":\"\")+\"width:\"+this.o.width+\"px;height:\"+this.o.height+'px;\"></div>')).before(this.$c);if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else{this.cv=this.v}this.$.bind(\"configure\",cf).parent().bind(\"configure\",cf);this._listen()._configure()._xy().init();this.isInit=true;this._draw();return this};this._draw=function(){var d=true,c=document.createElement(\"canvas\");c.width=s.o.width;c.height=s.o.height;s.g=c.getContext(\"2d\");s.clear();s.dH&&(d=s.dH());d!==false&&s.draw();s.c.drawImage(c,0,0);c=null};this._touch=function(e){var touchMove=function(e){var v=s.xy2val(e.originalEvent.touches[s.t].pageX,e.originalEvent.touches[s.t].pageY);if(v==s.cv)return;if(s.cH&&s.cH(v)===false)return;s.change(s._validate(v));s._draw()};this.t=k.c.t(e);touchMove(e);k.c.d.bind(\"touchmove.k\",touchMove).bind(\"touchend.k\",function(){k.c.d.unbind(\"touchmove.k touchend.k\");if(s.rH&&s.rH(s.cv)===false)return;s.val(s.cv)});return this};this._mouse=function(e){var mouseMove=function(e){var v=s.xy2val(e.pageX,e.pageY);if(v==s.cv)return;if(s.cH&&s.cH(v)===false)return;s.change(s._validate(v));s._draw()};mouseMove(e);k.c.d.bind(\"mousemove.k\",mouseMove).bind(\"keyup.k\",function(e){if(e.keyCode===27){k.c.d.unbind(\"mouseup.k mousemove.k keyup.k\");if(s.eH&&s.eH()===false)return;s.cancel()}}).bind(\"mouseup.k\",function(e){k.c.d.unbind(\"mousemove.k mouseup.k keyup.k\");if(s.rH&&s.rH(s.cv)===false)return;\ns.val(s.cv)});return this};this._xy=function(){var o=this.$c.offset();this.x=o.left;this.y=o.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind(\"mousedown\",function(e){e.preventDefault();s._xy()._mouse(e)}).bind(\"touchstart\",function(e){e.preventDefault();s._xy()._touch(e)});this.listen()}else{this.$.attr(\"readonly\",\"readonly\")}return this};this._configure=function(){if(this.o.draw)this.dH=this.o.draw;if(this.o.change)this.cH=this.o.change;if(this.o.cancel)this.eH=this.o.cancel;if(this.o.release)this.rH=this.o.release;if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,\"0.4\");this.fgColor=this.h2rgba(this.o.fgColor,\"0.6\")}else{this.fgColor=this.o.fgColor}return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(v){return~~((v<0?-.5:.5)+v/this.o.step)*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(v){};this.val=function(v){};this.xy2val=function(x,y){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(h,a){var rgb;h=h.substring(1,7);rgb=[parseInt(h.substring(0,2),16),parseInt(h.substring(2,4),16),parseInt(h.substring(4,6),16)];return\"rgba(\"+rgb[0]+\",\"+rgb[1]+\",\"+rgb[2]+\",\"+a+\")\"};this.copy=function(f,t){for(var i in f){t[i]=f[i]}}};k.Dial=function(){k.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=$.extend({bgColor:this.$.data(\"bgcolor\")||\"#EEEEEE\",angleOffset:this.$.data(\"angleoffset\")||0,angleArc:this.$.data(\"anglearc\")||360,inline:true},this.o)};this.val=function(v){if(null!=v){this.cv=this.o.stopper?max(min(v,this.o.max),this.o.min):v;this.v=this.cv;this.$.val(this.v);this._draw()}else{return this.v}};this.xy2val=function(x,y){var a,ret;a=Math.atan2(x-(this.x+this.w2),-(y-this.y-this.w2))-this.angleOffset;if(this.angleArc!=this.PI2&&a<0&&a>-.5){a=0}else if(a<0){a+=this.PI2}ret=~~(.5+a*(this.o.max-this.o.min)/this.angleArc)+this.o.min;this.o.stopper&&(ret=max(min(ret,this.o.max),this.o.min));return ret};this.listen=function(){var s=this,mw=function(e){e.preventDefault();var ori=e.originalEvent,deltaX=ori.detail||ori.wheelDeltaX,deltaY=ori.detail||ori.wheelDeltaY,v=parseInt(s.$.val())+(deltaX>0||deltaY>0?s.o.step:deltaX<0||deltaY<0?-s.o.step:0);if(s.cH&&s.cH(v)===false)return;s.val(v)},kval,to,m=1,kv={37:-s.o.step,38:s.o.step,39:s.o.step,40:-s.o.step};this.$.bind(\"keydown\",function(e){var kc=e.keyCode;if(kc>=96&&kc<=105){kc=e.keyCode=kc-48}kval=parseInt(String.fromCharCode(kc));if(isNaN(kval)){kc!==13&&kc!==8&&kc!==9&&kc!==189&&e.preventDefault();if($.inArray(kc,[37,38,39,40])>-1){e.preventDefault();var v=parseInt(s.$.val())+kv[kc]*m;s.o.stopper&&(v=max(min(v,s.o.max),s.o.min));s.change(v);s._draw();to=window.setTimeout(function(){m*=2},30)}}}).bind(\"keyup\",function(e){if(isNaN(kval)){if(to){window.clearTimeout(to);to=null;m=1;s.val(s.$.val())}}else{s.$.val()>s.o.max&&s.$.val(s.o.max)||s.$.val()<s.o.min&&s.$.val(s.o.min)}});this.$c.bind(\"mousewheel DOMMouseScroll\",mw);this.$.bind(\"mousewheel DOMMouseScroll\",mw)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.o.width/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var s=max(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.o.width/2+4>>0)+\"px\",height:(this.o.width/3>>0)+\"px\",position:\"absolute\",\"vertical-align\":\"middle\",\"margin-top\":(this.o.width/3>>0)+\"px\",\"margin-left\":\"-\"+(this.o.width*3/4+2>>0)+\"px\",border:0,background:\"none\",font:\"bold \"+(this.o.width/s>>0)+\"px Arial\",\"text-align\":\"center\",color:this.o.inputColor||this.o.fgColor,padding:\"0px\",\"-webkit-appearance\":\"none\"})||this.i.css({width:\"0px\",visibility:\"hidden\"})};this.change=function(v){this.cv=v;this.$.val(v)};this.angle=function(v){return(v-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.draw=function(){var c=this.g,a=this.angle(this.cv),sat=this.startAngle,eat=sat+a,sa,ea,r=1;c.lineWidth=this.lineWidth;c.lineCap=this.lineCap;this.o.cursor&&(sat=eat-this.cursorExt)&&(eat=eat+this.cursorExt);c.beginPath();c.strokeStyle=this.o.bgColor;c.arc(this.xy,this.xy,this.radius,this.endAngle,this.startAngle,true);c.stroke();if(this.o.displayPrevious){ea=this.startAngle+this.angle(this.v);sa=this.startAngle;this.o.cursor&&(sa=ea-this.cursorExt)&&(ea=ea+this.cursorExt);c.beginPath();c.strokeStyle=this.pColor;c.arc(this.xy,this.xy,this.radius,sa,ea,false);c.stroke();r=this.cv==this.v}c.beginPath();c.strokeStyle=r?this.o.fgColor:this.fgColor;c.arc(this.xy,this.xy,this.radius,sat,eat,false);c.stroke()};this.cancel=function(){this.val(this.v)}};$.fn.dial=$.fn.knob=function(o){return this.each(function(){var d=new k.Dial;d.o=o;d.$=$(this);d.run()}).parent()}})(jQuery);(function(factory){\"use strict\";if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(window.jQuery)}})(function($){\"use strict\";var counter=0;$.ajaxTransport(\"iframe\",function(options){if(options.async){var form,iframe,addParamChar;return{send:function(_,completeCallback){form=$('<form style=\"display:none;\"></form>');form.attr(\"accept-charset\",options.formAcceptCharset);addParamChar=/\\?/.test(options.url)?\"&\":\"?\";if(options.type===\"DELETE\"){options.url=options.url+addParamChar+\"_method=DELETE\";options.type=\"POST\"}else if(options.type===\"PUT\"){options.url=options.url+addParamChar+\"_method=PUT\";options.type=\"POST\"}else if(options.type===\"PATCH\"){options.url=options.url+addParamChar+\"_method=PATCH\";options.type=\"POST\"}counter+=1;iframe=$('<iframe src=\"javascript:false;\" name=\"iframe-transport-'+counter+'\"></iframe>').bind(\"load\",function(){var fileInputClones,paramNames=$.isArray(options.paramName)?options.paramName:[options.paramName];iframe.unbind(\"load\").bind(\"load\",function(){var response;try{response=iframe.contents();if(!response.length||!response[0].firstChild){throw new Error}}catch(e){response=undefined}completeCallback(200,\"success\",{iframe:response});$('<iframe src=\"javascript:false;\"></iframe>').appendTo(form);window.setTimeout(function(){form.remove()},0)});form.prop(\"target\",iframe.prop(\"name\")).prop(\"action\",options.url).prop(\"method\",options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type=\"hidden\"/>').prop(\"name\",field.name).val(field.value).appendTo(form)})}if(options.fileInput&&options.fileInput.length&&options.type===\"POST\"){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index]});if(options.paramName){options.fileInput.each(function(index){$(this).prop(\"name\",paramNames[index]||options.paramName)})}form.append(options.fileInput).prop(\"enctype\",\"multipart/form-data\").prop(\"encoding\",\"multipart/form-data\")}form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop(\"name\",clone.prop(\"name\"));clone.replaceWith(input)})}});form.append(iframe).appendTo(document.body)},abort:function(){if(iframe){iframe.unbind(\"load\").prop(\"src\",\"javascript\".concat(\":false;\"))}if(form){form.remove()}}}}});$.ajaxSetup({converters:{\"iframe text\":function(iframe){return iframe&&$(iframe[0].body).text()},\"iframe json\":function(iframe){return iframe&&$.parseJSON($(iframe[0].body).text())},\"iframe html\":function(iframe){return iframe&&$(iframe[0].body).html()},\"iframe xml\":function(iframe){var xmlDoc=iframe&&iframe[0];return xmlDoc&&$.isXMLDoc(xmlDoc)?xmlDoc:$.parseXML(xmlDoc.XMLDocument&&xmlDoc.XMLDocument.xml||$(xmlDoc.body).html())},\"iframe script\":function(iframe){return iframe&&$.globalEval($(iframe[0].body).text())}}})});(function(factory){if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(jQuery)}})(function($){var pluses=/\\+/g;function raw(s){return s}function decoded(s){return decodeURIComponent(s.replace(pluses,\" \"))}function converted(s){if(s.indexOf('\"')===0){s=s.slice(1,-1).replace(/\\\\\"/g,'\"').replace(/\\\\\\\\/g,\"\\\\\")}try{return config.json?JSON.parse(s):s}catch(er){}}var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(typeof options.expires===\"number\"){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}value=config.json?JSON.stringify(value):String(value);return document.cookie=[config.raw?key:encodeURIComponent(key),\"=\",config.raw?value:encodeURIComponent(value),options.expires?\"; expires=\"+options.expires.toUTCString():\"\",options.path?\"; path=\"+options.path:\"\",options.domain?\"; domain=\"+options.domain:\"\",options.secure?\"; secure\":\"\"].join(\"\")}var decode=config.raw?raw:decoded;var cookies=document.cookie.split(\"; \");var result=key?undefined:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split(\"=\");var name=decode(parts.shift());var cookie=decode(parts.join(\"=\"));if(key&&key===name){result=converted(cookie);break}if(!key){result[name]=converted(cookie)}}return result};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==undefined){$.cookie(key,\"\",$.extend({},options,{expires:-1}));return true}return false}});(function($){var $scrollTo=$.scrollTo=function(target,duration,settings){$(window).scrollTo(target,duration,settings)};$scrollTo.defaults={axis:\"xy\",duration:parseFloat($.fn.jquery)>=1.3?0:1,limit:true};$scrollTo.window=function(scope){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var elem=this,isWin=!elem.nodeName||$.inArray(elem.nodeName.toLowerCase(),[\"iframe\",\"#document\",\"html\",\"body\"])!=-1;if(!isWin)return elem;var doc=(elem.contentWindow||elem).document||elem.ownerDocument||elem;return/webkit/.test(navigator.userAgent.toLowerCase())||doc.compatMode==\"BackCompat\"?doc.body:doc.documentElement})};$.fn.scrollTo=function(target,duration,settings){if(typeof duration==\"object\"){settings=duration;duration=0}if(typeof settings==\"function\")settings={onAfter:settings};if(target==\"max\")target=9e9;settings=$.extend({},$scrollTo.defaults,settings);duration=duration||settings.duration;settings.queue=settings.queue&&settings.axis.length>1;if(settings.queue)duration/=2;settings.offset=both(settings.offset);settings.over=both(settings.over);return this._scrollable().each(function(){var elem=this,$elem=$(elem),targ=target,toff,attr={},win=$elem.is(\"html,body\");switch(typeof targ){case\"number\":case\"string\":if(/^([+-]=)?\\d+(\\.\\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}targ=$(targ,this);if(!targ.length)return;case\"object\":if(targ.is||targ.style)toff=(targ=$(targ)).offset()}$.each(settings.axis.split(\"\"),function(i,axis){var Pos=axis==\"x\"?\"Left\":\"Top\",pos=Pos.toLowerCase(),key=\"scroll\"+Pos,old=elem[key],max=$scrollTo.max(elem,axis);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(settings.margin){attr[key]-=parseInt(targ.css(\"margin\"+Pos))||0;attr[key]-=parseInt(targ.css(\"border\"+Pos+\"Width\"))||0}attr[key]+=settings.offset[pos]||0;if(settings.over[pos])attr[key]+=targ[axis==\"x\"?\"width\":\"height\"]()*settings.over[pos]}else{var val=targ[pos];attr[key]=val.slice&&val.slice(-1)==\"%\"?parseFloat(val)/100*max:val}if(settings.limit&&/^\\d+$/.test(attr[key]))attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&settings.queue){if(old!=attr[key])animate(settings.onAfterFirst);delete attr[key]}});animate(settings.onAfter);function animate(callback){$elem.animate(attr,duration,settings.easing,callback&&function(){callback.call(this,target,settings)})}}).end()};$scrollTo.max=function(elem,axis){var Dim=axis==\"x\"?\"Width\":\"Height\",scroll=\"scroll\"+Dim;if(!$(elem).is(\"html,body\"))return elem[scroll]-$(elem)[Dim.toLowerCase()]();var size=\"client\"+Dim,html=elem.ownerDocument.documentElement,body=elem.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[size],body[size])};function both(val){return typeof val==\"object\"?val:{top:val,left:val}}})(jQuery);(function(factory){\"use strict\";if(typeof define===\"function\"&&define.amd){define([\"jquery\",\"jquery.ui.widget\"],factory)}else{factory(window.jQuery)}})(function($){\"use strict\";$.support.fileInput=!(new RegExp(\"(Android (1\\\\.[0156]|2\\\\.[01]))\"+\"|(Windows Phone (OS 7|8\\\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)\"+\"|(w(eb)?OSBrowser)|(webOS)\"+\"|(Kindle/(1\\\\.0|2\\\\.[05]|3\\\\.0))\").test(window.navigator.userAgent)||$('<input type=\"file\">').prop(\"disabled\"));$.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);$.widget(\"blueimp.fileupload\",{options:{dropZone:$(document),pasteZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:\"Uploaded bytes exceed file size\"},i18n:function(message,context){message=this.messages[message]||message.toString();if(context){$.each(context,function(key,value){message=message.replace(\"{\"+key+\"}\",value)})}return message},formData:function(form){return form.serializeArray()},add:function(e,data){if(data.autoUpload||data.autoUpload!==false&&$(this).fileupload(\"option\",\"autoUpload\")){data.process().done(function(){data.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:[\"fileInput\",\"dropZone\",\"pasteZone\",\"multipart\",\"forceIframeTransport\"],_blobSlice:$.support.blobSlice&&function(){var slice=this.slice||this.webkitSlice||this.mozSlice;return slice.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1e3/timeDiff)*8;this.loaded=loaded;this.timestamp=now}return this.bitrate}},_isXHRUpload:function(options){return!options.forceIframeTransport&&(!options.multipart&&$.support.xhrFileUpload||$.support.xhrFormDataFileUpload)},_getFormData:function(options){var formData;if(typeof options.formData===\"function\"){return options.formData(options.form)}if($.isArray(options.formData)){return options.formData}if($.type(options.formData)===\"object\"){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value})});return formData}return[]},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1});return total},_initProgressObject:function(obj){var progress={loaded:0,total:0,bitrate:0};if(obj._progress){$.extend(obj._progress,progress)}else{obj._progress=progress}},_initResponseObject:function(obj){var prop;if(obj._response){for(prop in obj._response){if(obj._response.hasOwnProperty(prop)){delete obj._response[prop]}}}else{obj._response={}}},_onProgress:function(e,data){if(e.lengthComputable){var now=Date.now?Date.now():(new Date).getTime(),loaded;if(data._time&&data.progressInterval&&now-data._time<data.progressInterval&&e.loaded!==e.total){return}data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=loaded-data._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger(\"progress\",e,data);this._trigger(\"progressall\",e,this._progress)}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind(\"progress\",function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options)});options.xhr=function(){return xhr}}},_isInstanceOf:function(type,obj){return Object.prototype.toString.call(obj)===\"[object \"+type+\"]\"},_initXHRData:function(options){var that=this,formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=options.paramName[0];options.headers=$.extend({},options.headers);if(options.contentRange){options.headers[\"Content-Range\"]=options.contentRange}if(!multipart||options.blob||!this._isInstanceOf(\"File\",file)){options.headers[\"Content-Disposition\"]='attachment; filename=\"'+encodeURI(file.name)+'\"'}if(!multipart){options.contentType=file.type;options.data=options.blob||file}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob})}else{$.each(options.files,function(index,file){formData.push({name:options.paramName[index]||paramName,value:file})})}}else{if(that._isInstanceOf(\"FormData\",options.formData)){formData=options.formData}else{formData=new FormData;$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value)})}if(options.blob){formData.append(paramName,options.blob,file.name)}else{$.each(options.files,function(index,file){if(that._isInstanceOf(\"File\",file)||that._isInstanceOf(\"Blob\",file)){formData.append(options.paramName[index]||paramName,file,file.name)}})}}options.data=formData}options.blob=null},_initIframeSettings:function(options){var targetHost=$(\"<a></a>\").prop(\"href\",options.url).prop(\"host\");options.dataType=\"iframe \"+(options.dataType||\"\");options.formData=this._getFormData(options);if(options.redirect&&targetHost&&targetHost!==location.host){options.formData.push({name:options.redirectParamName||\"redirect\",value:options.redirect})}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options)}this._initProgressListener(options)}if(options.postMessage){options.dataType=\"postmessage \"+(options.dataType||\"\")}}else{this._initIframeSettings(options)}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop(\"name\")||\"files[]\",i=(input.prop(\"files\")||[1]).length;while(i){paramName.push(name);i-=1}});if(!paramName.length){paramName=[fileInput.prop(\"name\")||\"files[]\"]}}else if(!$.isArray(paramName)){paramName=[paramName]}return paramName},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop(\"form\"));if(!options.form.length){options.form=$(this.options.fileInput.prop(\"form\"))}}options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop(\"action\")||location.href}options.type=(options.type||$.type(options.form.prop(\"method\"))===\"string\"&&options.form.prop(\"method\")||\"\").toUpperCase();if(options.type!==\"POST\"&&options.type!==\"PUT\"&&options.type!==\"PATCH\"){options.type=\"POST\"}if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr(\"accept-charset\")}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options},_getDeferredState:function(deferred){if(deferred.state){return deferred.state()}if(deferred.isResolved()){return\"resolved\"}if(deferred.isRejected()){return\"rejected\"}return\"pending\"},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args)}else if(resolveOrReject===false){dfd.rejectWith(context,args)}promise.abort=dfd.promise;return this._enhancePromise(promise)},_addConvenienceMethods:function(e,data){var that=this,getPromise=function(data){return $.Deferred().resolveWith(that,[data]).promise()};data.process=function(resolveFunc,rejectFunc){if(resolveFunc||rejectFunc){data._processQueue=this._processQueue=(this._processQueue||getPromise(this)).pipe(resolveFunc,rejectFunc)}return this._processQueue||getPromise(this)};data.submit=function(){if(this.state()!==\"pending\"){data.jqXHR=this.jqXHR=that._trigger(\"submit\",e,this)!==false&&that._onSend(e,this)}return this.jqXHR||that._getXHRPromise()};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}return that._getXHRPromise()};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR)}if(this._processQueue){return that._getDeferredState(this._processQueue)}};data.progress=function(){return this._progress};data.response=function(){return this._response}},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader(\"Range\"),parts=range&&range.split(\"-\"),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1},_chunkedUpload:function(options,testOnly){options.uploadedBytes=options.uploadedBytes||0;var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes,mcs=options.maxChunkSize||fs,slice=this._blobSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false}if(testOnly){return true}if(ub>=fs){file.error=options.i18n(\"uploadedBytes\");return this._getXHRPromise(false,options.context,[null,\"error\",file.error])}upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange=\"bytes \"+ub+\"-\"+(ub+o.chunkSize-1)+\"/\"+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=(that._trigger(\"chunksend\",null,o)!==false&&$.ajax(o)||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||ub+o.chunkSize;if(currentLoaded+o.chunkSize-o._progress.loaded){that._onProgress($.Event(\"progress\",{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o)}options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger(\"chunkdone\",null,o);that._trigger(\"chunkalways\",null,o);if(ub<fs){upload()}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR])}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger(\"chunkfail\",null,o);that._trigger(\"chunkalways\",null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown])})};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort()};upload();return promise},_beforeSend:function(e,data){if(this._active===0){this._trigger(\"start\");this._bitrateTimer=new this._BitrateTimer;this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(data);this._initProgressObject(data);data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total,response=options._response;if(options._progress.loaded<total){this._onProgress($.Event(\"progress\",{lengthComputable:true,loaded:total,total:total}),options)}response.result=options.result=result;response.textStatus=options.textStatus=textStatus;response.jqXHR=options.jqXHR=jqXHR;this._trigger(\"done\",null,options)},_onFail:function(jqXHR,textStatus,errorThrown,options){var response=options._response;if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total}response.jqXHR=options.jqXHR=jqXHR;response.textStatus=options.textStatus=textStatus;response.errorThrown=options.errorThrown=errorThrown;this._trigger(\"fail\",null,options)},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._trigger(\"always\",null,options)},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data)}var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer;jqXHR=jqXHR||((aborted||that._trigger(\"send\",e,options)===false)&&that._getXHRPromise(false,options.context,aborted)||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options)}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options)}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);that._sending-=1;that._active-=1;if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)===\"pending\"){nextSlot.resolve();break}nextSlot=that._slots.shift()}}if(that._active===0){that._trigger(\"stop\")}});return jqXHR};this._beforeSend(e,options);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send)}else{this._sequence=this._sequence.pipe(send,send);pipe=this._sequence}pipe.abort=function(){aborted=[undefined,\"abort\",\"abort\"];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted)}return send()}return jqXHR.abort()};return this._enhancePromise(pipe)}return send()},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),limit=options.limitMultiFileUploads,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i;if(!(options.singleFileUploads||limit)||!this._isXHRUpload(options)){fileSet=[data.files];paramNameSet=[paramName]}else if(!options.singleFileUploads&&limit){fileSet=[];paramNameSet=[];for(i=0;i<data.files.length;i+=limit){fileSet.push(data.files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName}paramNameSet.push(paramNameSlice)}}else{paramNameSet=paramName}data.originalFiles=data.files;$.each(fileSet||data.files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initResponseObject(newData);that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger(\"add\",e,newData);return result});return result},_replaceFileInput:function(input){var inputClone=input.clone(true);$(\"<form></form>\").append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind(\"remove\"));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0]}return el});if(input[0]===this.element[0]){this.element=inputClone}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry}dfd.resolve([e])},dirReader;path=path||\"\";if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file)}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file)},errorHandler)}}else if(entry.isDirectory){dirReader=entry.createReader();dirReader.readEntries(function(entries){that._handleFileTreeEntries(entries,path+entry.name+\"/\").done(function(files){dfd.resolve(files)}).fail(errorHandler)},errorHandler)}else{dfd.resolve([])}return dfd.promise()},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile()}return entry}return item.getAsEntry()}))}return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise()},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop(\"webkitEntries\")||fileInput.prop(\"entries\"),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries)}files=$.makeArray(fileInput.prop(\"files\"));if(!files.length){value=fileInput.prop(\"value\");if(!value){return $.Deferred().resolve([]).promise()}files=[{name:value.replace(/^.*\\\\/,\"\")}]}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize})}return $.Deferred().resolve(files).promise()},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput)}return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput)}if(that._trigger(\"change\",e,data)!==false){that._onAdd(e,data)}})},_onPaste:function(e){var items=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,data={files:[]};if(items&&items.length){$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file)}});if(this._trigger(\"paste\",e,data)!==false){this._onAdd(e,data)}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var that=this,dataTransfer=e.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger(\"drop\",e,data)!==false){that._onAdd(e,data)}})}},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var dataTransfer=e.dataTransfer,data={dropEffect:\"copy\",preventDefault:true};if(dataTransfer&&$.inArray(\"Files\",dataTransfer.types)!==-1&&this._trigger(\"dragover\",e,data)!==false){dataTransfer.dropEffect=data.dropEffect;if(data.preventDefault){e.preventDefault()}}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,\"dragover drop\");this._off(this.options.pasteZone,\"paste\");this._off(this.options.fileInput,\"change\")},_setOption:function(key,value){var reinit=$.inArray(key,this._specialOptions)!==-1;if(reinit){this._destroyEventHandlers()}this._super(key,value);if(reinit){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type=\"file\"]')?this.element:this.element.find('input[type=\"file\"]')\n}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput)}if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone)}if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone)}},_getRegExp:function(str){var parts=str.split(\"/\"),modifiers=parts.pop();parts.shift();return new RegExp(parts.join(\"/\"),modifiers)},_isRegExpOption:function(key,value){return key!==\"url\"&&$.type(value)===\"string\"&&/^\\/.*\\/[igm]{0,3}$/.test(value)},_initDataAttributes:function(){var that=this,options=this.options;$.each($(this.element[0].cloneNode(false)).data(),function(key,value){if(that._isRegExpOption(key,value)){value=that._getRegExp(value)}options[key]=value})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(data){var that=this;if(!data||this.options.disabled){return}if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data)})}else{data.files=$.makeArray(data.files);this._onAdd(null,data)}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort()}dfd.reject(null,\"abort\",\"abort\");return promise};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return}if(!files.length){dfd.reject();return}data.files=files;jqXHR=that._onSend(null,data).then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR)},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown)})});return this._enhancePromise(promise)}data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data)}}return this._getXHRPromise(false,data&&data.context)}})});jQuery.extend(jQuery,{escapeSel:function(){return function(selector){return typeof selector!==\"undefined\"&&selector!==null?selector.replace(/([ #;?&,.+*~\\':\"!^$[\\]()=>|\\/@])/g,\"\\\\$1\"):void 0}}()});(function(f,h,$){var a=\"placeholder\"in h.createElement(\"input\"),d=\"placeholder\"in h.createElement(\"textarea\"),i=$.fn,c=$.valHooks,k,j;if(a&&d){j=i.placeholder=function(){return this};j.input=j.textarea=true}else{j=i.placeholder=function(){var l=this;l.filter((a?\"textarea\":\":input\")+\"[placeholder]\").not(\".placeholder\").bind({\"focus.placeholder\":b,\"blur.placeholder\":e}).data(\"placeholder-enabled\",true).trigger(\"blur.placeholder\");return l};j.input=a;j.textarea=d;k={get:function(m){var l=$(m);return l.data(\"placeholder-enabled\")&&l.hasClass(\"placeholder\")?\"\":m.value},set:function(m,n){var l=$(m);if(!l.data(\"placeholder-enabled\")){return m.value=n}if(n==\"\"){m.value=n;if(m!=h.activeElement){e.call(m)}}else{if(l.hasClass(\"placeholder\")){b.call(m,true,n)||(m.value=n)}else{m.value=n}}return l}};a||(c.input=k);d||(c.textarea=k);$(function(){$(h).delegate(\"form\",\"submit.placeholder\",function(){var l=$(\".placeholder\",this).each(b);setTimeout(function(){l.each(e)},10)})});$(f).bind(\"beforeunload.placeholder\",function(){$(\".placeholder\").each(function(){this.value=\"\"})})}function g(m){var l={},n=/^jQuery\\d+$/;$.each(m.attributes,function(p,o){if(o.specified&&!n.test(o.name)){l[o.name]=o.value}});return l}function b(m,n){var l=this,o=$(l);if(l.value==o.attr(\"placeholder\")&&o.hasClass(\"placeholder\")){if(o.data(\"placeholder-password\")){o=o.hide().next().show().attr(\"id\",o.removeAttr(\"id\").data(\"placeholder-id\"));if(m===true){return o[0].value=n}o.focus()}else{l.value=\"\";o.removeClass(\"placeholder\");l==h.activeElement&&l.select()}}}function e(){var q,l=this,p=$(l),m=p,o=this.id;if(l.value==\"\"){if(l.type==\"password\"){if(!p.data(\"placeholder-textinput\")){try{q=p.clone().attr({type:\"text\"})}catch(n){q=$(\"<input>\").attr($.extend(g(this),{type:\"text\"}))}q.removeAttr(\"name\").data({\"placeholder-password\":true,\"placeholder-id\":o}).bind(\"focus.placeholder\",b);p.data({\"placeholder-textinput\":q,\"placeholder-id\":o}).before(q)}p=p.removeAttr(\"id\").hide().prev().attr(\"id\",o).show()}p.addClass(\"placeholder\");p[0].value=p.attr(\"placeholder\")}else{p.removeClass(\"placeholder\")}}})(this,document,jQuery);jQuery.fn.outerHTML=function(){return $(\"<div>\").append(this.eq(0).clone()).html()};window.mobilecheck=function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){return true}else{return false}};window.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||\"an unknown browser\";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||\"an unknown version\";this.OS=this.searchString(this.dataOS)||\"an unknown OS\"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)return data[i].identity}else if(dataProp)return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:\"Chrome\",identity:\"Chrome\"},{string:navigator.userAgent,subString:\"OmniWeb\",versionSearch:\"OmniWeb/\",identity:\"OmniWeb\"},{string:navigator.vendor,subString:\"Apple\",identity:\"Safari\",versionSearch:\"Version\"},{prop:window.opera,identity:\"Opera\",versionSearch:\"Version\"},{string:navigator.vendor,subString:\"iCab\",identity:\"iCab\"},{string:navigator.vendor,subString:\"KDE\",identity:\"Konqueror\"},{string:navigator.userAgent,subString:\"Firefox\",identity:\"Firefox\"},{string:navigator.vendor,subString:\"Camino\",identity:\"Camino\"},{string:navigator.userAgent,subString:\"Netscape\",identity:\"Netscape\"},{string:navigator.userAgent,subString:\"MSIE\",identity:\"Explorer\",versionSearch:\"MSIE\"},{string:navigator.userAgent,subString:\"Gecko\",identity:\"Mozilla\",versionSearch:\"rv\"},{string:navigator.userAgent,subString:\"Mozilla\",identity:\"Netscape\",versionSearch:\"Mozilla\"}],dataOS:[{string:navigator.platform,subString:\"Win\",identity:\"Windows\"},{string:navigator.platform,subString:\"Mac\",identity:\"Mac\"},{string:navigator.userAgent,subString:\"iPhone\",identity:\"iPhone/iPod\"},{string:navigator.platform,subString:\"Linux\",identity:\"Linux\"}]};window.BrowserDetect.init();window.log=function(){if((typeof global!==\"undefined\"&&global!==null?global.debug:void 0)!=null&&!global.debug||window.debug!=null&&!window.debug){return}if(this.console){arguments.callee=arguments.callee.caller;var newarr=[].slice.call(arguments);typeof console.log===\"object\"?log.apply.call(console.log,console,newarr):console.log.apply(console,newarr)}};(function(b){function c(){}for(var d=\"assert,clear,count,debug,dir,dirxml,error,exception,firebug,group,groupCollapsed,groupEnd,info,log,memoryProfile,memoryProfileEnd,profile,profileEnd,table,time,timeEnd,timeStamp,trace,warn\".split(\",\"),a;a=d.pop();){b[a]=b[a]||c}})(function(){try{console.log();return window.console}catch(err){return window.console={}}}());Lawnchair.adapter(\"indexed-db\",function(){function fail(e,i){console.error(\"error in indexed-db adapter!\",e,i)}var STORE_VERSION=3;var getIDB=function(){return window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB};var getIDBTransaction=function(){return window.IDBTransaction||window.webkitIDBTransaction||window.mozIDBTransaction||window.oIDBTransaction||window.msIDBTransaction};var getIDBKeyRange=function(){return window.IDBKeyRange||window.webkitIDBKeyRange||window.mozIDBKeyRange||window.oIDBKeyRange||window.msIDBKeyRange};var getIDBDatabaseException=function(){return window.IDBDatabaseException||window.webkitIDBDatabaseException||window.mozIDBDatabaseException||window.oIDBDatabaseException||window.msIDBDatabaseException||window.DOMException};var useAutoIncrement=function(){return!!window.indexedDB};var READ_WRITE=getIDBTransaction()&&\"READ_WRITE\"in getIDBTransaction()?getIDBTransaction().READ_WRITE:\"readwrite\";return{valid:function(){return!!getIDB()},init:function(options,callback){this.idb=getIDB();this.waiting=[];this.useAutoIncrement=useAutoIncrement();var request=this.idb.open(this.name,STORE_VERSION);var self=this;var cb=self.fn(self.name,callback);if(cb&&typeof cb!=\"function\")throw\"callback not valid\";var win=function(){request.onupgradeneeded=request.onsuccess=request.error=null;if(cb)return cb.call(self,self)};var upgrade=function(from,to){try{self.db.deleteObjectStore(\"teststore\")}catch(e1){}try{self.db.deleteObjectStore(self.record)}catch(e2){}var params={};if(self.useAutoIncrement){params.autoIncrement=true}self.db.createObjectStore(self.record,params);self.store=true};request.onupgradeneeded=function(event){self.db=request.result;self.transaction=request.transaction;upgrade(event.oldVersion,event.newVersion)};request.onsuccess=function(event){self.db=event.target.result;if(self.db.version!=\"\"+STORE_VERSION){var oldVersion=self.db.version;var setVrequest=self.db.setVersion(\"\"+STORE_VERSION);setVrequest.onsuccess=function(event){var transaction=setVrequest.result;setVrequest.onsuccess=setVrequest.onerror=null;upgrade(oldVersion,STORE_VERSION);transaction.oncomplete=function(){for(var i=0;i<self.waiting.length;i++){self.waiting[i].call(self)}self.waiting=[];win()}};setVrequest.onerror=function(e){setVrequest.onsuccess=setVrequest.onerror=null;console.error(\"Failed to create objectstore \"+e);fail(e)}}else{self.store=true;for(var i=0;i<self.waiting.length;i++){self.waiting[i].call(self)}self.waiting=[];win()}};request.onerror=function(ev){if(request.errorCode===getIDBDatabaseException().VERSION_ERR){self.idb.deleteDatabase(self.name);if(!options.recursing){options.recursing=true;return self.init(options,callback)}}console.error(\"Failed to open database\")}},save:function(obj,callback){var self=this;if(!this.store){this.waiting.push(function(){this.save(obj,callback)});return}var objs=(this.isArray(obj)?obj:[obj]).map(function(o){if(!o.key){o.key=self.uuid()}return o});var win=function(e){if(callback){self.lambda(callback).call(self,self.isArray(obj)?objs:objs[0])}};var trans=this.db.transaction(this.record,READ_WRITE);var store=trans.objectStore(this.record);for(var i=0;i<objs.length;i++){var o=objs[i];store.put(o,o.key)}store.transaction.oncomplete=win;store.transaction.onabort=fail;return this},batch:function(objs,callback){return this.save(objs,callback)},get:function(key,callback){if(!this.store){this.waiting.push(function(){this.get(key,callback)});return}var self=this;var win=function(e){var r=e.target.result;if(callback){if(r){r.key=key}self.lambda(callback).call(self,r)}};if(!this.isArray(key)){var req=this.db.transaction(this.record).objectStore(this.record).get(key);req.onsuccess=function(event){req.onsuccess=req.onerror=null;win(event)};req.onerror=function(event){req.onsuccess=req.onerror=null;fail(event)}}else{var results=[],done=key.length,keys=key;var getOne=function(i){self.get(keys[i],function(obj){results[i]=obj;if(--done>0){return}if(callback){self.lambda(callback).call(self,results)}})};for(var i=0,l=keys.length;i<l;i++)getOne(i)}return this},exists:function(key,callback){if(!this.store){this.waiting.push(function(){this.exists(key,callback)});return}var self=this;var req=this.db.transaction(self.record).objectStore(this.record).openCursor(getIDBKeyRange().only(key));req.onsuccess=function(event){req.onsuccess=req.onerror=null;var undef;self.lambda(callback).call(self,event.target.result!==null&&event.target.result!==undef)};req.onerror=function(event){req.onsuccess=req.onerror=null;fail(event)};return this},all:function(callback){if(!this.store){this.waiting.push(function(){this.all(callback)});return}var cb=this.fn(this.name,callback)||undefined;var self=this;var objectStore=this.db.transaction(this.record).objectStore(this.record);var toReturn=[];objectStore.openCursor().onsuccess=function(event){var cursor=event.target.result;if(cursor){toReturn.push(cursor.value);cursor[\"continue\"]()}else{if(cb)cb.call(self,toReturn)}};return this},keys:function(callback){if(!this.store){this.waiting.push(function(){this.keys(callback)});return}var cb=this.fn(this.name,callback)||undefined;var self=this;var objectStore=this.db.transaction(this.record).objectStore(this.record);var toReturn=[];objectStore.openCursor().onsuccess=function(event){var cursor=event.target.result;if(cursor){toReturn.push(cursor.key);cursor[\"continue\"]()}else{if(cb)cb.call(self,toReturn)}};return this},remove:function(keyOrArray,callback){if(!this.store){this.waiting.push(function(){this.remove(keyOrArray,callback)});return}var self=this;var toDelete=keyOrArray;if(!this.isArray(keyOrArray)){toDelete=[keyOrArray]}var win=function(){if(callback)self.lambda(callback).call(self)};var os=this.db.transaction(this.record,READ_WRITE).objectStore(this.record);var key=keyOrArray.key?keyOrArray.key:keyOrArray;for(var i=0;i<toDelete.length;i++){var key=toDelete[i].key?toDelete[i].key:toDelete[i];os[\"delete\"](key)}os.transaction.oncomplete=win;os.transaction.onabort=fail;return this},nuke:function(callback){if(!this.store){this.waiting.push(function(){this.nuke(callback)});return}var self=this,win=callback?function(){self.lambda(callback).call(self)}:function(){};try{var os=this.db.transaction(this.record,READ_WRITE).objectStore(this.record);os.clear();os.transaction.oncomplete=win;os.transaction.onabort=fail}catch(e){if(e.name==\"NotFoundError\")win();else fail(e)}return this}}}());window.PrettyPills=function(){var CodeMirror=window.CodeMirror;function PrettyPills(textarea,options){if(!(this instanceof PrettyPills))return new PrettyPills(place,options);this.editor=CodeMirror.fromTextArea(textarea[0]||textarea,options);var editor=this.editor;var wrapper=$(editor.getWrapperElement());var emitter=this.emitter=$(\"<div />\");wrapper.wrap(\"<div class='PrettyPills' />\");this.container=wrapper.parent();this.textarea=$(this.editor.getTextArea());this.options=options=options||{};for(var opt in defaults){if(!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt)){options[opt]=defaults[opt]}}editor.setOption(\"lineNumbers\",false);editor.setOption(\"lineWrapping\",true);wrapper.on(\"click\",\".pill\",bind(function(e){this.setActivePill(e.target)},this));var debounceCursorActivity=debounce(bind(function(){var cursorHead=editor.getCursor(\"head\");var cursorAnchor=editor.getCursor(\"anchor\");var isCollapsed=cursorHead.line===cursorAnchor.line&&cursorHead.ch===cursorAnchor.ch;if(!this._active||isCollapsed||this._active.ch!=cursorHead.ch||this._active.line!=cursorHead.line){this.clearActivePills()}},this),200,true);var debounceChange=debounce(bind(function(){editor.getTextArea().value=editor.getValue();this.parseReplacements()},this),200);editor.on(\"cursorActivity\",debounceCursorActivity);editor.on(\"change\",debounceChange);this.refresh();var inValue=null;editor.on(\"change\",function(){emitter.trigger(\"input\",{value:editor.getValue()})});editor.on(\"focus\",function(){inValue=editor.getValue()});wrapper.on(\"mousedown\",function(){emitter.trigger(\"mousedown\",{value:editor.getValue()})});wrapper.on(\"mouseup\",function(){emitter.trigger(\"mouseup\",{value:editor.getValue()})});editor.on(\"blur\",function(){if(inValue!==editor.getValue()){emitter.trigger(\"change\",{value:editor.getValue()})}inValue=null});this.enable()}PrettyPills.prototype={enabled:false,disable:function(){if(this.enabled){this.container.remove();this.textarea.show();this.enabled=false}},enable:function(){if(!this.enabled){this.setValue(this.textarea.val());this.container.insertAfter(this.textarea);this.textarea.hide();this.enabled=true}},refresh:function(){this.editor.refresh()},setActivePill:function(pill){var editor=this.editor;var emitter=this.emitter;this.clearActivePills();var replacedWith=pill.parentNode;var active=null;var pos=null;var text=null;var ch=null;var line=null;var marker=null;editor.getAllMarks().forEach(function(m){if(m.replacedWith===replacedWith){marker=m;active=m.replacedWith;pos=m.find()}});this.refresh();if(pos){text=editor.getRange(pos.from,pos.to);if(pos.from){line=pos.from.line;ch=pos.from.ch}}editor.focus();editor.setSelection(pos.from,pos.to);$(pill).addClass(\"active\");emitter.trigger(\"pillenter\",{coords:editor.cursorCoords(true),text:text,line:line,ch:ch});this._active=editor.getCursor()},clearActivePills:function(){var editor=this.editor;var emitter=this.emitter;this.container.find(\".pill.active\").removeClass(\"active\");if(this._active){emitter.trigger(\"pillleave\");delete this._active}},setOption:function(name,val){this.options[name]=val;this.parseReplacements()},getOption:function(name){return this.options[name]},setValue:function(val){this.editor.setValue(val);this.parseReplacements()},getValue:function(val){return this.editor.getValue()},getCursorCoords:function(name){return this.editor.cursorCoords(true)},on:function(type,f){this.emitter.on(type,f)},off:function(type,f){this.emitter.off(type,f)},getPill:function(text,className){var pill=document.createElement(\"span\");pill.textContent=text;pill.className=trim(\"pill \"+(className||\"\"));return pill},insertText:function(key,start){var editor=this.editor;start=start||editor.getCursor(\"start\");editor.focus();editor.replaceRange(key,start);this.parseReplacements()},replaceText:function(key,start,length){var editor=this.editor;start=start||editor.getCursor(\"start\");var to={line:start.line,ch:start.ch+length};editor.focus();editor.replaceRange(key,start,to);this.parseReplacements()},parseReplacements:function(){var editor=this.editor;var value=editor.getValue().split(\"\\n\");var replacements=this.options.replacements||{};var sel=editor.getCursor();var clearPillsOnEnter=this.options.clearPillsOnEnter;forEach(editor.getAllMarks(),function(m){m.clear()});if(!this.options.showPills){return}for(var i=0;i<value.length;i++){for(var j in replacements){var options=typeof replacements[j]===\"object\"?replacements[j]:{replaceWith:replacements[j]};var matchRegex=options.allowRegex?j:escapeRegExp(j);var matches=allMatches(value[i],matchRegex);for(var k=0;k<matches.length;k++){var match=matches[k][0];var replace=matches[k][1];var replaceWith=typeof options.replaceWith===\"function\"?options.replaceWith(replace):options.replaceWith;var p=getPillDOM(replaceWith,options.className);var insideSelection=sel.line===i&&sel.ch>=match&&sel.ch<match+replace.length;if(clearPillsOnEnter&&insideSelection){continue}var m=editor.markText({line:i,ch:match},{line:i,ch:match+replace.length},{replacedWith:p,clearOnEnter:clearPillsOnEnter,handleMouseEvents:true})}}}}};var defaults=PrettyPills.defaults={};defaults.showPills=true;defaults.clearPillsOnEnter=false;PrettyPills.fromTextArea=function(textarea,options,cmOptions){return new PrettyPills(textarea,options)};PrettyPills.MUSTACHE_MATCH=\"{{(?:(?!{{).)+}}\";function allMatches(str,regex){var reg=new RegExp(\"\"+regex+\"\",\"g\");var match;var params=[];while(match=reg.exec(str)){params.push([match.index,match[0]])}return params}function getPillDOM(text,className){var pill=document.createElement(\"span\");pill.textContent=text;pill.className=trim(\"pill \"+(className||\"\"));return pill}function debounce(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}}function escapeRegExp(str){return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,\"\\\\$&\")}function forEach(arr,fn){for(var i=0;i<arr.length;i++){fn.apply(arr[i],[arr[i],i])}}function trim(str){return $.trim(str)}function bind(fn,ctx){return $.proxy(fn,ctx)}function log(){if(window.console){if(Function.prototype.bind)log=Function.prototype.bind.call(console.log,console);else log=function(){Function.prototype.apply.call(console.log,console,arguments)};log.apply(this,arguments)}}PrettyPills.version=\"0.0.1+\";return PrettyPills}();(function(){var e=this;this.Stripe=function(){function e(){}return e.version=2,e.endpoint=\"https://api.stripe.com/v1\",e.validateCardNumber=function(t){return t=(t+\"\").replace(/\\s+|-/g,\"\"),t.length>=10&&t.length<=16&&e.luhnCheck(t)},e.validateCVC=function(t){return t=e.trim(t),/^\\d+$/.test(t)&&t.length>=3&&t.length<=4},e.validateExpiry=function(t,n){var r,i;return t=e.trim(t),n=e.trim(n),/^\\d+$/.test(t)?/^\\d+$/.test(n)?parseInt(t,10)<=12?(i=new Date(n,t),r=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>r):!1:!1:!1},e.cardType=function(t){return e.cardTypes[t.slice(0,2)]||\"Unknown\"},e.setPublishableKey=function(t){e.key=t},e.createToken=function(t,n,r){var i,s,o;n==null&&(n={});if(!t)throw\"card required\";if(typeof t!=\"object\")throw\"card invalid\";typeof n==\"function\"?(r=n,n={}):typeof n!=\"object\"&&(i=parseInt(n,10),n={},i>0&&(n.amount=i));for(s in t)o=t[s],delete t[s],t[e.underscore(s)]=o;return n.card=t,n.key||(n.key=e.key||e.publishableKey),e.validateKey(n.key),e.ajaxJSONP({url:\"\"+e.endpoint+\"/tokens\",data:n,method:\"POST\",success:function(e,t){return typeof r==\"function\"?r(t,e):void 0},complete:e.complete(r),timeout:4e4})},e.getToken=function(t,n){if(!t)throw\"token required\";return e.validateKey(e.key),e.ajaxJSONP({url:\"\"+e.endpoint+\"/tokens/\"+t,data:{key:e.key},success:function(e,t){return typeof n==\"function\"?n(t,e):void 0},complete:e.complete(n),timeout:4e4})},e.complete=function(e){return function(t,n,r){if(t!==\"success\")return typeof e==\"function\"?e(500,{error:{code:t,type:t,message:\"An unexpected error has occured.\\nWe have been notified of the problem.\"}}):void 0}},e.validateKey=function(e){if(!e||typeof e!=\"string\")throw new Error(\"You did not set a valid publishable key.\\nCall Stripe.setPublishableKey() with your publishable key.\\nFor more info, see https://stripe.com/docs/stripe.js\");if(/^sk_/.test(e))throw new Error(\"You are using a secret key with Stripe.js, instead of the publishable one.\\nFor more info, see https://stripe.com/docs/stripe.js\")},e}.call(this),typeof module!=\"undefined\"&&module!==null&&(module.exports=this.Stripe),typeof define==\"function\"&&define(\"stripe\",[],function(){return e.Stripe})}).call(this),function(){var e,t,n,r=[].slice;e=encodeURIComponent,t=(new Date).getTime(),n=function(t,r,i){var s,o;r==null&&(r=[]);for(s in t)o=t[s],i&&(s=\"\"+i+\"[\"+s+\"]\"),typeof o==\"object\"?n(o,r,s):r.push(\"\"+s+\"=\"+e(o));return r.join(\"&\").replace(/%20/g,\"+\")},this.Stripe.ajaxJSONP=function(e){var i,s,o,u,a,f;return e==null&&(e={}),o=\"sjsonp\"+ ++t,a=document.createElement(\"script\"),s=null,i=function(){var t;return(t=a.parentNode)!=null&&t.removeChild(a),o in window&&(window[o]=function(){}),typeof e.complete==\"function\"?e.complete(\"abort\",f,e):void 0},f={abort:i},a.onerror=function(){return f.abort(),typeof e.error==\"function\"?e.error(f,e):void 0},window[o]=function(){var t;t=1<=arguments.length?r.call(arguments,0):[],clearTimeout(s),a.parentNode.removeChild(a);try{delete window[o]}catch(n){window[o]=void 0}return typeof e.success==\"function\"&&e.success.apply(e,t),typeof e.complete==\"function\"?e.complete(\"success\",f,e):void 0},e.data||(e.data={}),e.data.callback=o,e.method&&(e.data._method=e.method),a.src=e.url+\"?\"+n(e.data),u=document.getElementsByTagName(\"head\")[0],u.appendChild(a),e.timeout>0&&(s=setTimeout(function(){return f.abort(),typeof e.complete==\"function\"?e.complete(\"timeout\",f,e):void 0},e.timeout)),f}}.call(this),function(){this.Stripe.trim=function(e){return(e+\"\").replace(/^\\s+|\\s+$/g,\"\")},this.Stripe.underscore=function(e){return(e+\"\").replace(/([A-Z])/g,function(e){return\"_\"+e.toLowerCase()})},this.Stripe.luhnCheck=function(e){var t,n,r,i,s,o;r=!0,i=0,n=(e+\"\").split(\"\").reverse();for(s=0,o=n.length;s<o;s++){t=n[s],t=parseInt(t,10);if(r=!r)t*=2;t>9&&(t-=9),i+=t}return i%10===0},this.Stripe.cardTypes=function(){var e,t,n,r;t={};for(e=n=40;n<=49;e=++n)t[e]=\"Visa\";for(e=r=50;r<=59;e=++r)t[e]=\"MasterCard\";return t[34]=t[37]=\"American Express\",t[60]=t[62]=t[64]=t[65]=\"Discover\",t[35]=\"JCB\",t[30]=t[36]=t[38]=t[39]=\"Diners Club\",t}()}.call(this);(function(root,factory){if(typeof exports===\"object\"&&exports){module.exports=factory}else if(typeof define===\"function\"&&define.amd){define(factory)}else{root.Mustache=factory}})(this,function(){var exports={};exports.name=\"mustache.js\";exports.version=\"0.7.2\";exports.tags=[\"{{\",\"}}\"];exports.Scanner=Scanner;exports.Context=Context;exports.Writer=Writer;var whiteRe=/\\s*/;var spaceRe=/\\s+/;var nonSpaceRe=/\\S/;var eqRe=/\\s*=/;var curlyRe=/\\s*\\}/;var tagRe=/#|\\^|\\/|>|\\{|&|=|!/;var _test=RegExp.prototype.test;var _toString=Object.prototype.toString;function testRe(re,string){return _test.call(re,string)}function isWhitespace(string){return!testRe(nonSpaceRe,string)}var isArray=Array.isArray||function(obj){return _toString.call(obj)===\"[object Array]\"};function escapeRe(string){return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\")}var entityMap={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"/\":\"&#x2F;\"};function escapeHtml(string){return String(string).replace(/[&<>\"'\\/]/g,function(s){return entityMap[s]})}exports.escape=escapeHtml;function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function(){return this.tail===\"\"};Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(match&&match.index===0){this.tail=this.tail.substring(match[0].length);this.pos+=match[0].length;return match[0]}return\"\"};Scanner.prototype.scanUntil=function(re){var match,pos=this.tail.search(re);switch(pos){case-1:match=this.tail;this.pos+=this.tail.length;this.tail=\"\";break;case 0:match=\"\";break;default:match=this.tail.substring(0,pos);this.tail=this.tail.substring(pos);this.pos+=pos}return match};function Context(view,parent){this.view=view;this.parent=parent;this._cache={}}Context.make=function(view){return view instanceof Context?view:new Context(view)};Context.prototype.push=function(view){return new Context(view,this)};Context.prototype.lookup=function(name){var value=this._cache[name];if(!value){if(name==\".\"){value=this.view}else{var context=this;while(context){if(name.indexOf(\".\")>0){value=context.view;var names=name.split(\".\"),i=0;while(value&&i<names.length){value=value[names[i++]]}}else{value=context.view[name]}if(value!=null)break;context=context.parent}}this._cache[name]=value}if(typeof value===\"function\")value=value.call(this.view);return value};function Writer(){this.clearCache()}Writer.prototype.clearCache=function(){this._cache={};this._partialCache={}};Writer.prototype.compile=function(template,tags){var fn=this._cache[template];if(!fn){var tokens=exports.parse(template,tags);fn=this._cache[template]=this.compileTokens(tokens,template)}return fn};Writer.prototype.compilePartial=function(name,template,tags){var fn=this.compile(template,tags);this._partialCache[name]=fn;return fn};Writer.prototype.getPartial=function(name){if(!(name in this._partialCache)&&this._loadPartial){this.compilePartial(name,this._loadPartial(name))}return this._partialCache[name]};Writer.prototype.compileTokens=function(tokens,template){var self=this;return function(view,partials){if(partials){if(typeof partials===\"function\"){self._loadPartial=partials}else{for(var name in partials){self.compilePartial(name,partials[name])}}}return renderTokens(tokens,self,Context.make(view),template)}};Writer.prototype.render=function(template,view,partials){return this.compile(template)(view,partials)};function renderTokens(tokens,writer,context,template){var buffer=\"\";var token,tokenValue,value;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];tokenValue=token[1];switch(token[0]){case\"#\":value=context.lookup(tokenValue);if(typeof value===\"object\"){if(isArray(value)){for(var j=0,jlen=value.length;j<jlen;++j){buffer+=renderTokens(token[4],writer,context.push(value[j]),template)}}else if(value){buffer+=renderTokens(token[4],writer,context.push(value),template)}}else if(typeof value===\"function\"){var text=template==null?null:template.slice(token[3],token[5]);value=value.call(context.view,text,function(template){return writer.render(template,context)});if(value!=null)buffer+=value}else if(value){buffer+=renderTokens(token[4],writer,context,template)}break;case\"^\":value=context.lookup(tokenValue);if(!value||isArray(value)&&value.length===0){buffer+=renderTokens(token[4],writer,context,template)}break;case\">\":value=writer.getPartial(tokenValue);if(typeof value===\"function\")buffer+=value(context);break;case\"&\":value=context.lookup(tokenValue);if(value!=null)buffer+=value;break;case\"name\":value=context.lookup(tokenValue);if(value!=null)buffer+=exports.escape(value);break;case\"text\":buffer+=tokenValue;break}}return buffer}function nestTokens(tokens){var tree=[];var collector=tree;var sections=[];var token;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];switch(token[0]){case\"#\":case\"^\":sections.push(token);collector.push(token);collector=token[4]=[];break;case\"/\":var section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:tree;break;default:collector.push(token)}}return tree}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];if(token){if(token[0]===\"text\"&&lastToken&&lastToken[0]===\"text\"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{lastToken=token;squashedTokens.push(token)}}}return squashedTokens}function escapeTags(tags){return[new RegExp(escapeRe(tags[0])+\"\\\\s*\"),new RegExp(\"\\\\s*\"+escapeRe(tags[1]))]}exports.parse=function(template,tags){template=template||\"\";tags=tags||exports.tags;if(typeof tags===\"string\")tags=tags.split(spaceRe);if(tags.length!==2)throw new Error(\"Invalid tags: \"+tags.join(\", \"));var tagRes=escapeTags(tags);var scanner=new Scanner(template);var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length){delete tokens[spaces.pop()]}}else{spaces=[]}hasTag=false;nonSpace=false}var start,type,value,chr,token;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(tagRes[0]);if(value){for(var i=0,len=value.length;i<len;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push([\"text\",chr,start,start+1]);start+=1;if(chr==\"\\n\")stripSpace()}}if(!scanner.scan(tagRes[0]))break;hasTag=true;type=scanner.scan(tagRe)||\"name\";scanner.scan(whiteRe);if(type===\"=\"){value=scanner.scanUntil(eqRe);scanner.scan(eqRe);scanner.scanUntil(tagRes[1])}else if(type===\"{\"){value=scanner.scanUntil(new RegExp(\"\\\\s*\"+escapeRe(\"}\"+tags[1])));scanner.scan(curlyRe);scanner.scanUntil(tagRes[1]);type=\"&\"}else{value=scanner.scanUntil(tagRes[1])}if(!scanner.scan(tagRes[1]))throw new Error(\"Unclosed tag at \"+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type===\"#\"||type===\"^\"){sections.push(token)}else if(type===\"/\"){if(sections.length===0)throw new Error('Unopened section \"'+value+'\" at '+start);var openSection=sections.pop();if(openSection[1]!==value)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+start)}else if(type===\"name\"||type===\"{\"||type===\"&\"){nonSpace=true}else if(type===\"=\"){tags=value.split(spaceRe);if(tags.length!==2)throw new Error(\"Invalid tags at \"+start+\": \"+tags.join(\", \"));tagRes=escapeTags(tags)}}var openSection=sections.pop();if(openSection)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+scanner.pos);tokens=squashTokens(tokens);return nestTokens(tokens)};var _writer=new Writer;exports.clearCache=function(){return _writer.clearCache()};exports.compile=function(template,tags){return _writer.compile(template,tags)};exports.compilePartial=function(name,template,tags){return _writer.compilePartial(name,template,tags)};exports.compileTokens=function(tokens,template){return _writer.compileTokens(tokens,template)\n};exports.render=function(template,view,partials){return _writer.render(template,view,partials)};exports.to_html=function(template,view,partials,send){var result=exports.render(template,view,partials);if(typeof send===\"function\"){send(result)}else{return result}};return exports}());if(typeof owl===\"undefined\")owl={};owl.pluralize=function(){var userDefined={};function capitalizeSame(word,sampleWord){if(sampleWord.match(/^[A-Z]/)){return word.charAt(0).toUpperCase()+word.slice(1)}else{return word}}function toKeys(keys){keys=keys.split(\",\");var keysLength=keys.length;var table={};for(var i=0;i<keysLength;i++){table[keys[i]]=1}return table}var uninflected=toKeys(\"aircraft,advice,blues,corn,molasses,equipment,gold,information,cotton,jewelry,kin,legislation,luck,luggage,moose,music,offspring,rice,silver,trousers,wheat,bison,bream,breeches,britches,carp,chassis,clippers,cod,contretemps,corps,debris,diabetes,djinn,eland,elk,flounder,gallows,graffiti,headquarters,herpes,high,homework,innings,jackanapes,mackerel,measles,mews,mumps,news,pincers,pliers,proceedings,rabies,salmon,scissors,sea,series,shears,species,swine,trout,tuna,whiting,wildebeest,pike,oats,tongs,dregs,snuffers,victuals,tweezers,vespers,pinchers,bellows,cattle\");var irregular={I:\"we\",you:\"you\",he:\"they\",it:\"they\",me:\"us\",you:\"you\",him:\"them\",them:\"them\",myself:\"ourselves\",yourself:\"yourselves\",himself:\"themselves\",herself:\"themselves\",itself:\"themselves\",themself:\"themselves\",oneself:\"oneselves\",child:\"children\",dwarf:\"dwarfs\",mongoose:\"mongooses\",mythos:\"mythoi\",ox:\"oxen\",soliloquy:\"soliloquies\",trilby:\"trilbys\",person:\"people\",forum:\"forums\",syllabus:\"syllabi\",alumnus:\"alumni\",genus:\"genera\",viscus:\"viscera\",stigma:\"stigmata\"};var suffixRules=[[/man$/i,\"men\"],[/([lm])ouse$/i,\"$1ice\"],[/tooth$/i,\"teeth\"],[/goose$/i,\"geese\"],[/foot$/i,\"feet\"],[/zoon$/i,\"zoa\"],[/([tcsx])is$/i,\"$1es\"],[/ix$/i,\"ices\"],[/^(cod|mur|sil|vert)ex$/i,\"$1ices\"],[/^(agend|addend|memorand|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi)um$/i,\"$1a\"],[/^(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|\\w+hedr)on$/i,\"$1a\"],[/^(alumn|alg|vertebr)a$/i,\"$1ae\"],[/([cs]h|ss|x)$/i,\"$1es\"],[/([aeo]l|[^d]ea|ar)f$/i,\"$1ves\"],[/([nlw]i)fe$/i,\"$1ves\"],[/([aeiou])y$/i,\"$1ys\"],[/(^[A-Z][a-z]*)y$/,\"$1ys\"],[/y$/i,\"ies\"],[/([aeiou])o$/i,\"$1os\"],[/^(pian|portic|albin|generalissim|manifest|archipelag|ghett|medic|armadill|guan|octav|command|infern|phot|ditt|jumb|pr|dynam|ling|quart|embry|lumbag|rhin|fiasc|magnet|styl|alt|contralt|sopran|bass|crescend|temp|cant|sol|kimon)o$/i,\"$1os\"],[/o$/i,\"oes\"],[/s$/i,\"ses\"]];function pluralize(word,count,plural){if(word===\"\")return\"\";if(count===1)return word;if(typeof plural===\"string\")return plural;var lowerWord=word.toLowerCase();if(lowerWord in userDefined){return capitalizeSame(userDefined[lowerWord],word)}if(word.match(/^[A-Z]$/))return word+\"'s\";if(word.match(/fish$|ois$|sheep$|deer$|pox$|itis$/i))return word;if(word.match(/^[A-Z][a-z]*ese$/))return word;if(lowerWord in uninflected)return word;if(lowerWord in irregular){return capitalizeSame(irregular[lowerWord],word)}var suffixRulesLength=suffixRules.length;for(var i=0;i<suffixRulesLength;i++){var rule=suffixRules[i];if(word.match(rule[0])){return word.replace(rule[0],rule[1])}}return word+\"s\"}pluralize.define=function(word,plural){userDefined[word.toLowerCase()]=plural};return pluralize}();owl.pluralize.define(\"emacs\",\"emacsen\");(function(){var async={};var root,previous_async;root=this;if(root!=null){previous_async=root.async}async.noConflict=function(){root.async=previous_async;return async};function only_once(fn){var called=false;return function(){if(called)throw new Error(\"Callback was already called.\");called=true;fn.apply(root,arguments)}}var _each=function(arr,iterator){if(arr.forEach){return arr.forEach(iterator)}for(var i=0;i<arr.length;i+=1){iterator(arr[i],i,arr)}};var _map=function(arr,iterator){if(arr.map){return arr.map(iterator)}var results=[];_each(arr,function(x,i,a){results.push(iterator(x,i,a))});return results};var _reduce=function(arr,iterator,memo){if(arr.reduce){return arr.reduce(iterator,memo)}_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)});return memo};var _keys=function(obj){if(Object.keys){return Object.keys(obj)}var keys=[];for(var k in obj){if(obj.hasOwnProperty(k)){keys.push(k)}}return keys};if(typeof process===\"undefined\"||!process.nextTick){if(typeof setImmediate===\"function\"){async.setImmediate=setImmediate;async.nextTick=setImmediate}else{async.setImmediate=async.nextTick;async.nextTick=function(fn){setTimeout(fn,0)}}}else{async.nextTick=process.nextTick;async.setImmediate=setImmediate}async.each=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;_each(arr,function(x){iterator(x,only_once(function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}}}))})};async.forEach=async.each;async.eachSeries=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;var iterate=function(){iterator(arr[completed],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}else{iterate()}}})};iterate()};async.forEachSeries=async.eachSeries;async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])};async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){callback=callback||function(){};if(!arr.length||limit<=0){return callback()}var completed=0;var started=0;var running=0;(function replenish(){if(completed>=arr.length){return callback()}while(running<limit&&started<arr.length){started+=1;running+=1;iterator(arr[started-1],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;running-=1;if(completed>=arr.length){callback()}else{replenish()}}})}})()}};var doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}};var doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}};var doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}};var _asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v;callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap);async.mapSeries=doSeries(_asyncMap);async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v;callback(err)})},function(err){callback(err,memo)})};async.inject=async.reduce;async.foldl=async.reduce;async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)};async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter);async.filterSeries=doSeries(_filter);async.select=async.filter;async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(!v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject);async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){if(result){main_callback(x);main_callback=function(){}}else{callback()}})},function(err){main_callback()})};async.detect=doParallel(_detect);async.detectSeries=doSeries(_detect);async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(v){main_callback(true);main_callback=function(){}}callback()})},function(err){main_callback(false)})};async.any=async.some;async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(!v){main_callback(false);main_callback=function(){}}callback()})},function(err){main_callback(true)})};async.all=async.every;async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){if(err){callback(err)}else{callback(null,{value:x,criteria:criteria})}})},function(err,results){if(err){return callback(err)}else{var fn=function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))}})};async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length){return callback(null)}var results={};var listeners=[];var addListener=function(fn){listeners.unshift(fn)};var removeListener=function(fn){for(var i=0;i<listeners.length;i+=1){if(listeners[i]===fn){listeners.splice(i,1);return}}};var taskComplete=function(){_each(listeners.slice(0),function(fn){fn()})};addListener(function(){if(_keys(results).length===keys.length){callback(null,results);callback=function(){}}});_each(keys,function(k){var task=tasks[k]instanceof Function?[tasks[k]]:tasks[k];var taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}if(err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]});safeResults[k]=args;callback(err,safeResults);callback=function(){}}else{results[k]=args;async.setImmediate(taskComplete)}};var requires=task.slice(0,Math.abs(task.length-1))||[];var ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},true)&&!results.hasOwnProperty(k)};if(ready()){task[task.length-1](taskCallback,results)}else{var listener=function(){if(ready()){removeListener(listener);task[task.length-1](taskCallback,results)}};addListener(listener)}})};async.waterfall=function(tasks,callback){callback=callback||function(){};if(tasks.constructor!==Array){var err=new Error(\"First argument to waterfall must be an array of functions\");return callback(err)}if(!tasks.length){return callback()}var wrapIterator=function(iterator){return function(err){if(err){callback.apply(null,arguments);callback=function(){}}else{var args=Array.prototype.slice.call(arguments,1);var next=iterator.next();if(next){args.push(wrapIterator(next))}else{args.push(callback)}async.setImmediate(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){eachfn.map(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)};async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)};async.series=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){async.mapSeries(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){if(tasks.length){tasks[index].apply(null,arguments)}return fn.next()};fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null};return fn};return makeCallback(0)};async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]);cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat);async.concatSeries=doSeries(_concat);async.whilst=function(test,iterator,callback){if(test()){iterator(function(err){if(err){return callback(err)}async.whilst(test,iterator,callback)})}else{callback()}};async.doWhilst=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(test()){async.doWhilst(iterator,test,callback)}else{callback()}})};async.until=function(test,iterator,callback){if(!test()){iterator(function(err){if(err){return callback(err)}async.until(test,iterator,callback)})}else{callback()}};async.doUntil=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(!test()){async.doUntil(iterator,test,callback)}else{callback()}})};async.queue=function(worker,concurrency){if(concurrency===undefined){concurrency=1}function _insert(q,data,pos,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){var item={data:task,callback:typeof callback===\"function\"?callback:null};if(pos){q.tasks.unshift(item)}else{q.tasks.push(item)}if(q.saturated&&q.tasks.length===concurrency){q.saturated()}async.setImmediate(q.process)})}var workers=0;var q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,push:function(data,callback){_insert(q,data,false,callback)},unshift:function(data,callback){_insert(q,data,true,callback)},process:function(){if(workers<q.concurrency&&q.tasks.length){var task=q.tasks.shift();if(q.empty&&q.tasks.length===0){q.empty()}workers+=1;var next=function(){workers-=1;if(task.callback){task.callback.apply(task,arguments)}if(q.drain&&q.tasks.length+workers===0){q.drain()}q.process()};var cb=only_once(next);worker(task.data,cb)}},length:function(){return q.tasks.length},running:function(){return workers}};return q};async.cargo=function(worker,payload){var working=false,tasks=[];var cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,push:function(data,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){tasks.push({data:task,callback:typeof callback===\"function\"?callback:null});if(cargo.saturated&&tasks.length===payload){cargo.saturated()}});async.setImmediate(cargo.process)},process:function process(){if(working)return;if(tasks.length===0){if(cargo.drain)cargo.drain();return}var ts=typeof payload===\"number\"?tasks.splice(0,payload):tasks.splice(0);var ds=_map(ts,function(task){return task.data});if(cargo.empty)cargo.empty();working=true;worker(ds,function(){working=false;var args=arguments;_each(ts,function(data){if(data.callback){data.callback.apply(null,args)}});process()})},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);if(typeof console!==\"undefined\"){if(err){if(console.error){console.error(err)}}else if(console[name]){_each(args,function(x){console[name](x)})}}}]))}};async.log=_console_fn(\"log\");async.dir=_console_fn(\"dir\");async.memoize=function(fn,hasher){var memo={};var queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments);var callback=args.pop();var key=hasher.apply(null,args);if(key in memo){callback.apply(null,memo[key])}else if(key in queues){queues[key].push(callback)}else{queues[key]=[callback];fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;i<l;i++){q[i].apply(null,arguments)}}]))}};memoized.memo=memo;memoized.unmemoized=fn;return memoized};async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}};async.times=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.map(counter,iterator,callback)};async.timesSeries=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.mapSeries(counter,iterator,callback)};async.compose=function(){var fns=Array.prototype.reverse.call(arguments);return function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0];var nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}};var _applyEach=function(eachfn,fns){var go=function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();return eachfn(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return go.apply(this,args)}else{return go}};async.applyEach=doParallel(_applyEach);async.applyEachSeries=doSeries(_applyEach);async.forever=function(fn,callback){function next(err){if(err){if(callback){return callback(err)}throw err}fn(next)}next()};if(typeof define!==\"undefined\"&&define.amd){define([],function(){return async})}else if(typeof module!==\"undefined\"&&module.exports){module.exports=async}else{root.async=async}})();(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!==\"undefined\"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION=\"0.9.10\";var _=root._;if(!_&&typeof require!==\"undefined\")_=require(\"underscore\");Backbone.$=root.jQuery||root.Zepto||root.ender;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var eventSplitter=/\\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name===\"object\"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}}else if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}}else{return true}};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args)}};var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,\"on\",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,\"once\",name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,\"off\",name,[callback,context]))return this;if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context){retain.push(ev)}}}if(!retain.length)delete this._events[name]}}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,\"trigger\",name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners)return this;if(obj){obj.off(name,typeof name===\"object\"?this:callback,this);if(!name&&!callback)delete listeners[obj._listenerId]}else{if(typeof name===\"object\")callback=this;for(var id in listeners){listeners[id].off(name,callback,this)}this._listeners={}}return this}};var listenMethods={listenTo:\"on\",listenToOnce:\"once\"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={});var id=obj._listenerId||(obj._listenerId=_.uniqueId(\"l\"));listeners[id]=obj;obj[implementation](name,typeof name===\"object\"?this:callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults;var attrs=attributes||{};this.cid=_.uniqueId(\"c\");this.attributes={};if(options&&options.collection)this.collection=options.collection;if(options&&options.parse)attrs=this.parse(attrs,options)||{};if(defaults=_.result(this,\"defaults\")){attrs=_.defaults({},attrs,defaults)}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:\"id\",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key===\"object\"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length)this._pending=true;for(var i=0,l=changes.length;i<l;i++){this.trigger(\"change:\"+changes[i],this,current[changes[i]],options)}}if(changing)return this;if(!silent){while(this._pending){this._pending=false;this.trigger(\"change\",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],val=diff[attr]))continue;(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;options.success=function(model,resp,options){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options)};return this.sync(\"read\",this,options)},save:function(key,val,options){var attrs,success,method,xhr,attributes=this.attributes;if(key==null||typeof key===\"object\"){attrs=key;options=val}else{(attrs={})[key]=val}if(attrs&&(!options||!options.wait)&&!this.set(attrs,options))return false;options=_.extend({validate:true},options);if(!this._validate(attrs,options))return false;if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0)options.parse=true;success=options.success;options.success=function(model,resp,options){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success)success(model,resp,options)};method=this.isNew()?\"create\":options.patch?\"patch\":\"update\";if(method===\"patch\")options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger(\"destroy\",model,model.collection,options)};options.success=function(model,resp,options){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options)};if(this.isNew()){options.success(this,null,options);return false}var xhr=this.sync(\"delete\",this,options);if(!options.wait)destroy();return xhr},url:function(){var base=_.result(this,\"urlRoot\")||_.result(this.collection,\"url\")||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)===\"/\"?\"\":\"/\")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger(\"invalid\",this,error,options||{});return false}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.url)this.url=options.url;if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options))};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,model,attrs,existing,doSort,add,at,sort,sortAttr;add=[];at=options.at;sort=this.comparator&&at==null&&options.sort!==false;sortAttr=_.isString(this.comparator)?this.comparator:null;for(i=0,l=models.length;i<l;i++){if(!(model=this._prepareModel(attrs=models[i],options))){this.trigger(\"invalid\",this,attrs,options);continue}if(existing=this.get(model)){if(options.merge){existing.set(attrs===model?model.attributes:attrs,options);if(sort&&!doSort&&existing.hasChanged(sortAttr))doSort=true}continue}add.push(model);model.on(\"all\",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model}if(add.length){if(sort)doSort=true;this.length+=add.length;if(at!=null){splice.apply(this.models,[at,0].concat(add))}else{push.apply(this.models,add)}}if(doSort)this.sort({silent:true});if(options.silent)return this;for(i=0,l=add.length;i<l;i++){(model=add[i]).trigger(\"add\",model,this,options)}if(doSort)this.trigger(\"sort\",this,options);return this},remove:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger(\"remove\",model,this,options)}this._removeReference(model)}return this},push:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:this.length},options));return model},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:0},options));return model},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){if(obj==null)return void 0;this._idAttr||(this._idAttr=this.model.prototype.idAttribute);return this._byId[obj.id||obj.cid||obj[this._idAttr]||obj]},at:function(index){return this.models[index]},where:function(attrs){if(_.isEmpty(attrs))return[];return this.filter(function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false}return true})},sort:function(options){if(!this.comparator){throw new Error(\"Cannot sort a set without a comparator\")}options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent)this.trigger(\"sort\",this,options);return this},pluck:function(attr){return _.invoke(this.models,\"get\",attr)},update:function(models,options){options=_.extend({add:true,merge:true,remove:true},options);if(options.parse)models=this.parse(models,options);var model,i,l,existing;var add=[],remove=[],modelMap={};if(!_.isArray(models))models=models?[models]:[];if(options.add&&!options.remove)return this.add(models,options);for(i=0,l=models.length;i<l;i++){model=models[i];existing=this.get(model);if(options.remove&&existing)modelMap[existing.cid]=true;if(options.add&&!existing||options.merge&&existing){add.push(model)}}if(options.remove){for(i=0,l=this.models.length;i<l;i++){model=this.models[i];if(!modelMap[model.cid])remove.push(model)}}if(remove.length)this.remove(remove,options);if(add.length)this.add(add,options);return this},reset:function(models,options){options||(options={});if(options.parse)models=this.parse(models,options);for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();if(models)this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger(\"reset\",this,options);return this},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;options.success=function(collection,resp,options){var method=options.update?\"update\":\"reset\";collection[method](resp,options);if(success)success(collection,resp,options)};return this.sync(\"read\",this,options)},create:function(model,options){options=options?_.clone(options):{};\nif(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(model,resp,options){if(options.wait)collection.add(model,options);if(success)success(model,resp,options)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection)attrs.collection=this;return attrs}options||(options={});options.collection=this;var model=new this.model(attrs,options);if(!model._validate(attrs,options))return false;return model},_removeReference:function(model){if(this===model.collection)delete model.collection;model.off(\"all\",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event===\"add\"||event===\"remove\")&&collection!==this)return;if(event===\"destroy\")this.remove(model,options);if(model&&event===\"change:\"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model}this.trigger.apply(this,arguments)},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)}});var methods=[\"forEach\",\"each\",\"map\",\"collect\",\"reduce\",\"foldl\",\"inject\",\"reduceRight\",\"foldr\",\"find\",\"detect\",\"filter\",\"select\",\"reject\",\"every\",\"all\",\"some\",\"any\",\"include\",\"contains\",\"invoke\",\"max\",\"min\",\"toArray\",\"size\",\"first\",\"head\",\"take\",\"initial\",\"rest\",\"tail\",\"drop\",\"last\",\"without\",\"indexOf\",\"shuffle\",\"lastIndexOf\",\"isEmpty\",\"chain\"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=[\"groupBy\",\"countBy\",\"sortBy\"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\\((.*?)\\)/g;var namedParam=/(\\(\\?)?:\\w+/g;var splatParam=/\\*\\w+/g;var escapeRegExp=/[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(!callback)callback=this[name];Backbone.history.route(route,_.bind(function(fragment){var args=this._extractParameters(route,fragment);callback&&callback.apply(this,args);this.trigger.apply(this,[\"route:\"+name].concat(args));this.trigger(\"route\",name,args);Backbone.history.trigger(\"route\",this,name,args)},this));return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes)return;var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,\"\\\\$&\").replace(optionalParam,\"(?:$1)?\").replace(namedParam,function(match,optional){return optional?match:\"([^/]+)\"}).replace(splatParam,\"(.*?)\");return new RegExp(\"^\"+route+\"$\")},_extractParameters:function(route,fragment){return route.exec(fragment).slice(1)}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,\"checkUrl\");if(typeof window!==\"undefined\"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\\/]|\\s+$/g;var rootStripper=/^\\/+|\\/+$/g;var isExplorer=/msie [\\w.]+/;var trailingSlash=/\\/$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:\"\"},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,\"\");if(!fragment.indexOf(root))fragment=fragment.substr(root.length)}else{fragment=this.getHash()}}return fragment.replace(routeStripper,\"\")},start:function(options){if(History.started)throw new Error(\"Backbone.history has already been started\");History.started=true;this.options=_.extend({},{root:\"/\"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);this.root=(\"/\"+this.root+\"/\").replace(rootStripper,\"/\");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src=\"javascript:0\" tabindex=\"-1\" />').hide().appendTo(\"body\")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on(\"popstate\",this.checkUrl)}else if(this._wantsHashChange&&\"onhashchange\"in window&&!oldIE){Backbone.$(window).on(\"hashchange\",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\\/]$/,\"$&/\")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+\"#\"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,\"\");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){Backbone.$(window).off(\"popstate\",this.checkUrl).off(\"hashchange\",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:options};fragment=this.getFragment(fragment||\"\");if(this.fragment===fragment)return;this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState){this.history[options.replace?\"replaceState\":\"pushState\"]({},document.title,url)}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}if(options.trigger)this.loadUrl(fragment)},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,\"\");location.replace(href+\"#\"+fragment)}else{location.hash=\"#\"+fragment}}});Backbone.history=new History;var View=Backbone.View=function(options){this.cid=_.uniqueId(\"view\");this._configure(options||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\\S+)\\s*(.*)$/;var viewOptions=[\"model\",\"collection\",\"el\",\"id\",\"attributes\",\"className\",\"tagName\",\"events\"];_.extend(View.prototype,Events,{tagName:\"div\",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this},delegateEvents:function(events){if(!(events||(events=_.result(this,\"events\"))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)throw new Error('Method \"'+events[key]+'\" does not exist');var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=\".delegateEvents\"+this.cid;if(selector===\"\"){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(\".delegateEvents\"+this.cid);return this},_configure:function(options){if(this.options)options=_.extend({},_.result(this,\"options\"),options);_.extend(this,_.pick(options,viewOptions));this.options=options},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,\"attributes\"));if(this.id)attrs.id=_.result(this,\"id\");if(this.className)attrs[\"class\"]=_.result(this,\"className\");var $el=Backbone.$(\"<\"+_.result(this,\"tagName\")+\">\").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,\"el\"),false)}}});var methodMap={create:\"POST\",update:\"PUT\",patch:\"PATCH\",\"delete\":\"DELETE\",read:\"GET\"};Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:\"json\"};if(!options.url){params.url=_.result(model,\"url\")||urlError()}if(options.data==null&&model&&(method===\"create\"||method===\"update\"||method===\"patch\")){params.contentType=\"application/json\";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType=\"application/x-www-form-urlencoded\";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type===\"PUT\"||type===\"DELETE\"||type===\"PATCH\")){params.type=\"POST\";if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader(\"X-HTTP-Method-Override\",type);if(beforeSend)return beforeSend.apply(this,arguments)}}if(params.type!==\"GET\"&&!options.emulateJSON){params.processData=false}var success=options.success;options.success=function(resp){if(success)success(model,resp,options);model.trigger(\"sync\",model,resp,options)};var error=options.error;options.error=function(xhr){if(error)error(model,xhr,options);model.trigger(\"error\",model,xhr,options)};var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger(\"request\",model,xhr,options);return xhr};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,\"constructor\")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A \"url\" property or function must be specified')}}).call(this);var Showdown={};Showdown.converter=function(){var g_urls;var g_titles;var g_html_blocks;var g_list_level=0;this.makeHtml=function(text){g_urls=new Array;g_titles=new Array;g_html_blocks=new Array;text=text.replace(/~/g,\"~T\");text=text.replace(/\\$/g,\"~D\");text=text.replace(/\\r\\n/g,\"\\n\");text=text.replace(/\\r/g,\"\\n\");text=\"\\n\\n\"+text+\"\\n\\n\";text=_Detab(text);text=text.replace(/^[ \\t]+$/gm,\"\");text=_HashHTMLBlocks(text);text=_StripLinkDefinitions(text);text=_RunBlockGamut(text);text=_UnescapeSpecialChars(text);text=text.replace(/~D/g,\"$$\");text=text.replace(/~T/g,\"~\");return text};var _StripLinkDefinitions=function(text){var text=text.replace(/^[ ]{0,3}\\[(.+)\\]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"(](.+?)[\")][ \\t]*)?(?:\\n+|\\Z)/gm,function(wholeMatch,m1,m2,m3,m4){m1=m1.toLowerCase();g_urls[m1]=_EncodeAmpsAndAngles(m2);if(m3){return m3+m4}else if(m4){g_titles[m1]=m4.replace(/\"/g,\"&quot;\")}return\"\"});return text};var _HashHTMLBlocks=function(text){text=text.replace(/\\n/g,\"\\n\\n\");var block_tags_a=\"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del\";var block_tags_b=\"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math\";text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\\b[^\\r]*?\\n<\\/\\2>[ \\t]*(?=\\n+))/gm,hashElement);text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\\b[^\\r]*?.*<\\/\\2>[ \\t]*(?=\\n+)\\n)/gm,hashElement);text=text.replace(/(\\n[ ]{0,3}(<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/(\\n\\n[ ]{0,3}<!(--[^\\r]*?--\\s*)+>[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/(?:\\n\\n)([ ]{0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/\\n\\n/g,\"\\n\");return text};var hashElement=function(wholeMatch,m1){var blockText=m1;blockText=blockText.replace(/\\n\\n/g,\"\\n\");blockText=blockText.replace(/^\\n/,\"\");blockText=blockText.replace(/\\n+$/g,\"\");blockText=\"\\n\\n~K\"+(g_html_blocks.push(blockText)-1)+\"K\\n\\n\";return blockText};var _RunBlockGamut=function(text){text=_DoHeaders(text);var key=hashBlock(\"<hr />\");text=text.replace(/^[ ]{0,2}([ ]?\\*[ ]?){3,}[ \\t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\\-[ ]?){3,}[ \\t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\\_[ ]?){3,}[ \\t]*$/gm,key);text=_DoLists(text);text=_DoCodeBlocks(text);text=_DoBlockQuotes(text);text=_HashHTMLBlocks(text);text=_FormParagraphs(text);return text};var _RunSpanGamut=function(text){text=_DoCodeSpans(text);text=_EscapeSpecialCharsWithinTagAttributes(text);text=_EncodeBackslashEscapes(text);text=_DoImages(text);text=_DoAnchors(text);text=_DoAutoLinks(text);text=_EncodeAmpsAndAngles(text);text=_DoItalicsAndBold(text);text=text.replace(/  +\\n/g,\" <br />\\n\");return text};var _EscapeSpecialCharsWithinTagAttributes=function(text){var regex=/(<[a-z\\/!$](\"[^\"]*\"|'[^']*'|[^'\">])*>|<!(--.*?--\\s*)+>)/gi;text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\\/?code>(?=.)/g,\"$1`\");tag=escapeCharacters(tag,\"\\\\`*_\");return tag});return text};var _DoAnchors=function(text){text=text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g,writeAnchorTag);text=text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\]\\([ \\t]*()<?(.*?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g,writeAnchorTag);text=text.replace(/(\\[([^\\[\\]]+)\\])()()()()()/g,writeAnchorTag);return text};var writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){if(m7==undefined)m7=\"\";var whole_match=m1;var link_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(url==\"\"){if(link_id==\"\"){link_id=link_text.toLowerCase().replace(/ ?\\n/g,\" \")}url=\"#\"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{if(whole_match.search(/\\(\\s*\\)$/m)>-1){url=\"\"}else{return whole_match}}}url=escapeCharacters(url,\"*_\");var result='<a href=\"'+url+'\"';if(title!=\"\"){title=title.replace(/\"/g,\"&quot;\");title=escapeCharacters(title,\"*_\");result+=' title=\"'+title+'\"'}result+=\">\"+link_text+\"</a>\";return result};var _DoImages=function(text){text=text.replace(/(!\\[(.*?)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g,writeImageTag);text=text.replace(/(!\\[(.*?)\\]\\s?\\([ \\t]*()<?(\\S+?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g,writeImageTag);return text};var writeImageTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1;var alt_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(!title)title=\"\";if(url==\"\"){if(link_id==\"\"){link_id=alt_text.toLowerCase().replace(/ ?\\n/g,\" \")}url=\"#\"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{return whole_match}}alt_text=alt_text.replace(/\"/g,\"&quot;\");url=escapeCharacters(url,\"*_\");var result='<img src=\"'+url+'\" alt=\"'+alt_text+'\"';title=title.replace(/\"/g,\"&quot;\");title=escapeCharacters(title,\"*_\");result+=' title=\"'+title+'\"';result+=\" />\";return result};var _DoHeaders=function(text){text=text.replace(/^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,function(wholeMatch,m1){return hashBlock('<h1 id=\"'+headerId(m1)+'\">'+_RunSpanGamut(m1)+\"</h1>\")});text=text.replace(/^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm,function(matchFound,m1){return hashBlock('<h2 id=\"'+headerId(m1)+'\">'+_RunSpanGamut(m1)+\"</h2>\")});text=text.replace(/^(\\#{1,6})[ \\t]*(.+?)[ \\t]*\\#*\\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return hashBlock(\"<h\"+h_level+' id=\"'+headerId(m2)+'\">'+_RunSpanGamut(m2)+\"</h\"+h_level+\">\")});function headerId(m){return m.replace(/[^\\w]/g,\"\").toLowerCase()}return text};var _ProcessListItems;var _DoLists=function(text){text+=\"~0\";var whole_list=/^(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;if(g_list_level){text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1;var list_type=m2.search(/[*+-]/g)>-1?\"ul\":\"ol\";list=list.replace(/\\n{2,}/g,\"\\n\\n\\n\");var result=_ProcessListItems(list);result=result.replace(/\\s+$/,\"\");result=\"<\"+list_type+\">\"+result+\"</\"+list_type+\">\\n\";return result})}else{whole_list=/(\\n\\n|^\\n?)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/g;text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1;var list=m2;var list_type=m3.search(/[*+-]/g)>-1?\"ul\":\"ol\";var list=list.replace(/\\n{2,}/g,\"\\n\\n\\n\");var result=_ProcessListItems(list);result=runup+\"<\"+list_type+\">\\n\"+result+\"</\"+list_type+\">\\n\";return result})}text=text.replace(/~0/,\"\");return text};_ProcessListItems=function(list_str){g_list_level++;list_str=list_str.replace(/\\n{2,}$/,\"\\n\");list_str+=\"~0\";list_str=list_str.replace(/(\\n)?(^[ \\t]*)([*+-]|\\d+[.])[ \\t]+([^\\r]+?(\\n{1,2}))(?=\\n*(~0|\\2([*+-]|\\d+[.])[ \\t]+))/gm,function(wholeMatch,m1,m2,m3,m4){var item=m4;var leading_line=m1;var leading_space=m2;if(leading_line||item.search(/\\n{2,}/)>-1){item=_RunBlockGamut(_Outdent(item))}else{item=_DoLists(_Outdent(item));item=item.replace(/\\n$/,\"\");item=_RunSpanGamut(item)}return\"<li>\"+item+\"</li>\\n\"});list_str=list_str.replace(/~0/g,\"\");g_list_level--;return list_str};var _DoCodeBlocks=function(text){text+=\"~0\";text=text.replace(/(?:\\n\\n|^)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1;var nextChar=m2;codeblock=_EncodeCode(_Outdent(codeblock));codeblock=_Detab(codeblock);codeblock=codeblock.replace(/^\\n+/g,\"\");codeblock=codeblock.replace(/\\n+$/g,\"\");codeblock=\"<pre><code>\"+codeblock+\"\\n</code></pre>\";return hashBlock(codeblock)+nextChar});text=text.replace(/~0/,\"\");return text};var hashBlock=function(text){text=text.replace(/(^\\n+|\\n+$)/g,\"\");return\"\\n\\n~K\"+(g_html_blocks.push(text)-1)+\"K\\n\\n\"};var _DoCodeSpans=function(text){text=text.replace(/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,function(wholeMatch,m1,m2,m3,m4){var c=m3;c=c.replace(/^([ \\t]*)/g,\"\");c=c.replace(/[ \\t]*$/g,\"\");c=_EncodeCode(c);return m1+\"<code>\"+c+\"</code>\"});return text};var _EncodeCode=function(text){text=text.replace(/&/g,\"&amp;\");text=text.replace(/</g,\"&lt;\");text=text.replace(/>/g,\"&gt;\");text=escapeCharacters(text,\"*_{}[]\\\\\",false);return text};var _DoItalicsAndBold=function(text){text=text.replace(/(\\*\\*|__)(?=\\S)([^\\r]*?\\S[*_]*)\\1/g,\"<strong>$2</strong>\");text=text.replace(/(\\*|_)(?=\\S)([^\\r]*?\\S)\\1/g,\"<em>$2</em>\");return text};var _DoBlockQuotes=function(text){text=text.replace(/((^[ \\t]*>[ \\t]?.+\\n(.+\\n)*\\n*)+)/gm,function(wholeMatch,m1){var bq=m1;bq=bq.replace(/^[ \\t]*>[ \\t]?/gm,\"~0\");bq=bq.replace(/~0/g,\"\");bq=bq.replace(/^[ \\t]+$/gm,\"\");bq=_RunBlockGamut(bq);bq=bq.replace(/(^|\\n)/g,\"$1  \");bq=bq.replace(/(\\s*<pre>[^\\r]+?<\\/pre>)/gm,function(wholeMatch,m1){var pre=m1;pre=pre.replace(/^  /gm,\"~0\");pre=pre.replace(/~0/g,\"\");return pre});return hashBlock(\"<blockquote>\\n\"+bq+\"\\n</blockquote>\")});return text};var _FormParagraphs=function(text){text=text.replace(/^\\n+/g,\"\");text=text.replace(/\\n+$/g,\"\");var grafs=text.split(/\\n{2,}/g);var grafsOut=new Array;var end=grafs.length;for(var i=0;i<end;i++){var str=grafs[i];if(str.search(/~K(\\d+)K/g)>=0){grafsOut.push(str)}else if(str.search(/\\S/)>=0){str=_RunSpanGamut(str);str=str.replace(/^([ \\t]*)/g,\"<p>\");str+=\"</p>\";grafsOut.push(str)}}end=grafsOut.length;for(var i=0;i<end;i++){while(grafsOut[i].search(/~K(\\d+)K/)>=0){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\\$/g,\"$$$$\");grafsOut[i]=grafsOut[i].replace(/~K\\d+K/,blockText)}}return grafsOut.join(\"\\n\\n\")};var _EncodeAmpsAndAngles=function(text){text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g,\"&amp;\");text=text.replace(/<(?![a-z\\/?\\$!])/gi,\"&lt;\");return text};var _EncodeBackslashEscapes=function(text){text=text.replace(/\\\\(\\\\)/g,escapeCharacters_callback);text=text.replace(/\\\\([`*_{}\\[\\]()>#+-.!])/g,escapeCharacters_callback);return text};var _DoAutoLinks=function(text){text=text.replace(/<((https?|ftp|dict):[^'\">\\s]+)>/gi,'<a href=\"$1\">$1</a>');text=text.replace(/<(?:mailto:)?([-.\\w]+\\@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi,function(wholeMatch,m1){return _EncodeEmailAddress(_UnescapeSpecialChars(m1))});return text};var _EncodeEmailAddress=function(addr){function char2hex(ch){var hexDigits=\"0123456789ABCDEF\";var dec=ch.charCodeAt(0);return hexDigits.charAt(dec>>4)+hexDigits.charAt(dec&15)}var encode=[function(ch){return\"&#\"+ch.charCodeAt(0)+\";\"},function(ch){return\"&#x\"+char2hex(ch)+\";\"},function(ch){return ch}];addr=\"mailto:\"+addr;addr=addr.replace(/./g,function(ch){if(ch==\"@\"){ch=encode[Math.floor(Math.random()*2)](ch)}else if(ch!=\":\"){var r=Math.random();ch=r>.9?encode[2](ch):r>.45?encode[1](ch):encode[0](ch)}return ch});addr='<a href=\"'+addr+'\">'+addr+\"</a>\";addr=addr.replace(/\">.+:/g,'\">');return addr};var _UnescapeSpecialChars=function(text){text=text.replace(/~E(\\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace)});return text};var _Outdent=function(text){text=text.replace(/^(\\t|[ ]{1,4})/gm,\"~0\");text=text.replace(/~0/g,\"\");return text};var _Detab=function(text){text=text.replace(/\\t(?=\\t)/g,\"    \");text=text.replace(/\\t/g,\"~A~B\");text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1,m2){var leadingText=m1;var numSpaces=4-leadingText.length%4;for(var i=0;i<numSpaces;i++)leadingText+=\" \";return leadingText});text=text.replace(/~A/g,\"    \");text=text.replace(/~B/g,\"\");return text};var escapeCharacters=function(text,charsToEscape,afterBackslash){var regexString=\"([\"+charsToEscape.replace(/([\\[\\]\\\\])/g,\"\\\\$1\")+\"])\";if(afterBackslash){regexString=\"\\\\\\\\\"+regexString}var regex=new RegExp(regexString,\"g\");text=text.replace(regex,escapeCharacters_callback);return text};var escapeCharacters_callback=function(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return\"~E\"+charCodeToEscape+\"E\"}};if(typeof exports!=\"undefined\")exports.Showdown=Showdown;CodeMirror.defineMode(\"javascript\",function(config,parserConfig){var indentUnit=config.indentUnit;var statementIndent=parserConfig.statementIndent;var jsonMode=parserConfig.json;var isTS=parserConfig.typescript;var keywords=function(){function kw(type){return{type:type,style:\"keyword\"}}var A=kw(\"keyword a\"),B=kw(\"keyword b\"),C=kw(\"keyword c\");var operator=kw(\"operator\"),atom={type:\"atom\",style:\"atom\"};var jsKeywords={\"if\":kw(\"if\"),\"while\":A,\"with\":A,\"else\":B,\"do\":B,\"try\":B,\"finally\":B,\"return\":C,\"break\":C,\"continue\":C,\"new\":C,\"delete\":C,\"throw\":C,\"var\":kw(\"var\"),\"const\":kw(\"var\"),let:kw(\"var\"),\"function\":kw(\"function\"),\"catch\":kw(\"catch\"),\"for\":kw(\"for\"),\"switch\":kw(\"switch\"),\"case\":kw(\"case\"),\"default\":kw(\"default\"),\"in\":operator,\"typeof\":operator,\"instanceof\":operator,\"true\":atom,\"false\":atom,\"null\":atom,undefined:atom,NaN:atom,Infinity:atom,\"this\":kw(\"this\"),module:kw(\"module\"),\"class\":kw(\"class\"),\"super\":kw(\"atom\"),yield:C,\"export\":kw(\"export\"),\"import\":kw(\"import\"),\"extends\":C};if(isTS){var type={type:\"variable\",style:\"variable-3\"};var tsKeywords={\"interface\":kw(\"interface\"),\"extends\":kw(\"extends\"),constructor:kw(\"constructor\"),\"public\":kw(\"public\"),\"private\":kw(\"private\"),\"protected\":kw(\"protected\"),\"static\":kw(\"static\"),string:type,number:type,bool:type,any:type};for(var attr in tsKeywords){jsKeywords[attr]=tsKeywords[attr]}}return jsKeywords}();var isOperatorChar=/[+\\-*&%=<>!?|~^]/;function nextUntilUnescaped(stream,end){var escaped=false,next;while((next=stream.next())!=null){if(next==end&&!escaped)return false;escaped=!escaped&&next==\"\\\\\"}return escaped}var type,content;function ret(tp,style,cont){type=tp;content=cont;return style}function tokenBase(stream,state){var ch=stream.next();if(ch=='\"'||ch==\"'\"){state.tokenize=tokenString(ch);return state.tokenize(stream,state)}else if(ch==\".\"&&stream.match(/^\\d+(?:[eE][+\\-]?\\d+)?/)){return ret(\"number\",\"number\")}else if(ch==\".\"&&stream.match(\"..\")){return ret(\"spread\",\"meta\")}else if(/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)){return ret(ch)}else if(ch==\"=\"&&stream.eat(\">\")){return ret(\"=>\")}else if(ch==\"0\"&&stream.eat(/x/i)){stream.eatWhile(/[\\da-f]/i);return ret(\"number\",\"number\")}else if(/\\d/.test(ch)){stream.match(/^\\d*(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/);return ret(\"number\",\"number\")}else if(ch==\"/\"){if(stream.eat(\"*\")){state.tokenize=tokenComment;return tokenComment(stream,state)}else if(stream.eat(\"/\")){stream.skipToEnd();return ret(\"comment\",\"comment\")}else if(state.lastType==\"operator\"||state.lastType==\"keyword c\"||state.lastType==\"sof\"||/^[\\[{}\\(,;:]$/.test(state.lastType)){nextUntilUnescaped(stream,\"/\");stream.eatWhile(/[gimy]/);return ret(\"regexp\",\"string-2\")}else{stream.eatWhile(isOperatorChar);return ret(\"operator\",null,stream.current())}}else if(ch==\"`\"){state.tokenize=tokenQuasi;return tokenQuasi(stream,state)}else if(ch==\"#\"){stream.skipToEnd();return ret(\"error\",\"error\")}else if(isOperatorChar.test(ch)){stream.eatWhile(isOperatorChar);return ret(\"operator\",null,stream.current())}else{stream.eatWhile(/[\\w\\$_]/);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return known&&state.lastType!=\".\"?ret(known.type,known.style,word):ret(\"variable\",\"variable\",word)}}function tokenString(quote){return function(stream,state){if(!nextUntilUnescaped(stream,quote))state.tokenize=tokenBase;return ret(\"string\",\"string\")}}function tokenComment(stream,state){var maybeEnd=false,ch;while(ch=stream.next()){if(ch==\"/\"&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd=ch==\"*\"}return ret(\"comment\",\"comment\")}function tokenQuasi(stream,state){var escaped=false,next;while((next=stream.next())!=null){if(!escaped&&(next==\"`\"||next==\"$\"&&stream.eat(\"{\"))){state.tokenize=tokenBase;break}escaped=!escaped&&next==\"\\\\\"}return ret(\"quasi\",\"string-2\",stream.current())}var brackets=\"([{}])\";function findFatArrow(stream,state){if(state.fatArrowAt)state.fatArrowAt=null;var arrow=stream.string.indexOf(\"=>\",stream.start);if(arrow<0)return;var depth=0,sawSomething=false;for(var pos=arrow-1;pos>=0;--pos){var ch=stream.string.charAt(pos);var bracket=brackets.indexOf(ch);if(bracket>=0&&bracket<3){if(!depth){++pos;break}if(--depth==0)break}else if(bracket>=3&&bracket<6){++depth}else if(/[$\\w]/.test(ch)){sawSomething=true}else if(sawSomething&&!depth){++pos;break}}if(sawSomething&&!depth)state.fatArrowAt=pos}var atomicTypes={atom:true,number:true,variable:true,string:true,regexp:true,\"this\":true};function JSLexical(indented,column,type,align,prev,info){this.indented=indented;this.column=column;this.type=type;this.prev=prev;this.info=info;if(align!=null)this.align=align}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return true;for(var cx=state.context;cx;cx=cx.prev){for(var v=cx.vars;v;v=v.next)if(v.name==varname)return true}}function parseJS(state,style,type,content,stream){var cc=state.cc;cx.state=state;cx.stream=stream;cx.marked=null,cx.cc=cc;if(!state.lexical.hasOwnProperty(\"align\"))state.lexical.align=true;while(true){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){while(cc.length&&cc[cc.length-1].lex)cc.pop()();if(cx.marked)return cx.marked;if(type==\"variable\"&&inScope(state,content))return\"variable-2\";return style}}}var cx={state:null,column:null,marked:null,cc:null};function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){pass.apply(null,arguments);return true}function register(varname){function inList(list){for(var v=list;v;v=v.next)if(v.name==varname)return true;return false}var state=cx.state;if(state.context){cx.marked=\"def\";if(inList(state.localVars))return;state.localVars={name:varname,next:state.localVars}}else{if(inList(state.globalVars))return;if(parserConfig.globalVars)state.globalVars={name:varname,next:state.globalVars}}}var defaultVars={name:\"this\",next:{name:\"arguments\"}};function pushcontext(){cx.state.context={prev:cx.state.context,vars:cx.state.localVars};cx.state.localVars=defaultVars}function popcontext(){cx.state.localVars=cx.state.context.vars;cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;if(state.lexical.type==\"stat\")indent=state.lexical.indented;state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};result.lex=true;return result}function poplex(){var state=cx.state;if(state.lexical.prev){if(state.lexical.type==\")\")state.indented=state.lexical.indented;state.lexical=state.lexical.prev}}poplex.lex=true;function expect(wanted){return function(type){if(type==wanted)return cont();else if(wanted==\";\")return pass();else return cont(arguments.callee)}}function statement(type,value){if(type==\"var\")return cont(pushlex(\"vardef\",value.length),vardef,expect(\";\"),poplex);if(type==\"keyword a\")return cont(pushlex(\"form\"),expression,statement,poplex);if(type==\"keyword b\")return cont(pushlex(\"form\"),statement,poplex);if(type==\"{\")return cont(pushlex(\"}\"),block,poplex);if(type==\";\")return cont();if(type==\"if\")return cont(pushlex(\"form\"),expression,statement,poplex,maybeelse);if(type==\"function\")return cont(functiondef);if(type==\"for\")return cont(pushlex(\"form\"),forspec,poplex,statement,poplex);if(type==\"variable\")return cont(pushlex(\"stat\"),maybelabel);if(type==\"switch\")return cont(pushlex(\"form\"),expression,pushlex(\"}\",\"switch\"),expect(\"{\"),block,poplex,poplex);if(type==\"case\")return cont(expression,expect(\":\"));if(type==\"default\")return cont(expect(\":\"));if(type==\"catch\")return cont(pushlex(\"form\"),pushcontext,expect(\"(\"),funarg,expect(\")\"),statement,poplex,popcontext);if(type==\"module\")return cont(pushlex(\"form\"),pushcontext,afterModule,popcontext,poplex);if(type==\"class\")return cont(pushlex(\"form\"),className,objlit,poplex);if(type==\"export\")return cont(pushlex(\"form\"),afterExport,poplex);if(type==\"import\")return cont(pushlex(\"form\"),afterImport,poplex);return pass(pushlex(\"stat\"),expression,expect(\";\"),poplex)}function expression(type){return expressionInner(type,false)}function expressionNoComma(type){return expressionInner(type,true)}function expressionInner(type,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if(type==\"(\")return cont(pushcontext,commasep(pattern,\")\"),expect(\"=>\"),body,popcontext);else if(type==\"variable\")return pass(pushcontext,pattern,expect(\"=>\"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;if(atomicTypes.hasOwnProperty(type))return cont(maybeop);if(type==\"function\")return cont(functiondef);\nif(type==\"keyword c\")return cont(noComma?maybeexpressionNoComma:maybeexpression);if(type==\"(\")return cont(pushlex(\")\"),maybeexpression,comprehension,expect(\")\"),poplex,maybeop);if(type==\"operator\"||type==\"spread\")return cont(noComma?expressionNoComma:expression);if(type==\"[\")return cont(pushlex(\"]\"),expressionNoComma,maybeArrayComprehension,poplex,maybeop);if(type==\"{\")return cont(commasep(objprop,\"}\"),maybeop);return cont()}function maybeexpression(type){if(type.match(/[;\\}\\)\\],]/))return pass();return pass(expression)}function maybeexpressionNoComma(type){if(type.match(/[;\\}\\)\\],]/))return pass();return pass(expressionNoComma)}function maybeoperatorComma(type,value){if(type==\",\")return cont(expression);return maybeoperatorNoComma(type,value,false)}function maybeoperatorNoComma(type,value,noComma){var me=noComma==false?maybeoperatorComma:maybeoperatorNoComma;var expr=noComma==false?expression:expressionNoComma;if(value==\"=>\")return cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext);if(type==\"operator\"){if(/\\+\\+|--/.test(value))return cont(me);if(value==\"?\")return cont(expression,expect(\":\"),expr);return cont(expr)}if(type==\"quasi\"){cx.cc.push(me);return quasi(value)}if(type==\";\")return;if(type==\"(\")return cont(commasep(expressionNoComma,\")\",\"call\"),me);if(type==\".\")return cont(property,me);if(type==\"[\")return cont(pushlex(\"]\"),maybeexpression,expect(\"]\"),poplex,me)}function quasi(value){if(!value)debugger;if(value.slice(value.length-2)!=\"${\")return cont();return cont(expression,continueQuasi)}function continueQuasi(type){if(type==\"}\"){cx.marked=\"string-2\";cx.state.tokenize=tokenQuasi;return cont()}}function arrowBody(type){findFatArrow(cx.stream,cx.state);if(type==\"{\")return pass(statement);return pass(expression)}function arrowBodyNoComma(type){findFatArrow(cx.stream,cx.state);if(type==\"{\")return pass(statement);return pass(expressionNoComma)}function maybelabel(type){if(type==\":\")return cont(poplex,statement);return pass(maybeoperatorComma,expect(\";\"),poplex)}function property(type){if(type==\"variable\"){cx.marked=\"property\";return cont()}}function objprop(type,value){if(type==\"variable\"){cx.marked=\"property\";if(value==\"get\"||value==\"set\")return cont(getterSetter)}else if(type==\"number\"||type==\"string\"){cx.marked=type+\" property\"}else if(type==\"[\"){return cont(expression,expect(\"]\"),afterprop)}if(atomicTypes.hasOwnProperty(type))return cont(afterprop)}function getterSetter(type){if(type!=\"variable\")return pass(afterprop);cx.marked=\"property\";return cont(functiondef)}function afterprop(type){if(type==\":\")return cont(expressionNoComma);if(type==\"(\")return pass(functiondef)}function commasep(what,end,info){function proceed(type){if(type==\",\"){var lex=cx.state.lexical;if(lex.info==\"call\")lex.pos=(lex.pos||0)+1;return cont(what,proceed)}if(type==end)return cont();return cont(expect(end))}return function(type){if(type==end)return cont();if(info===false)return pass(what,proceed);return pass(pushlex(end,info),what,proceed,poplex)}}function block(type){if(type==\"}\")return cont();return pass(statement,block)}function maybetype(type){if(isTS&&type==\":\")return cont(typedef)}function typedef(type){if(type==\"variable\"){cx.marked=\"variable-3\";return cont()}}function vardef(){return pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){if(type==\"variable\"){register(value);return cont()}if(type==\"[\")return cont(commasep(pattern,\"]\"));if(type==\"{\")return cont(commasep(proppattern,\"}\"))}function proppattern(type,value){if(type==\"variable\"&&!cx.stream.match(/^\\s*:/,false)){register(value);return cont(maybeAssign)}if(type==\"variable\")cx.marked=\"property\";return cont(expect(\":\"),pattern,maybeAssign)}function maybeAssign(_type,value){if(value==\"=\")return cont(expressionNoComma)}function vardefCont(type){if(type==\",\")return cont(vardef)}function maybeelse(type,value){if(type==\"keyword b\"&&value==\"else\")return cont(pushlex(\"form\"),statement,poplex)}function forspec(type){if(type==\"(\")return cont(pushlex(\")\"),forspec1,expect(\")\"))}function forspec1(type){if(type==\"var\")return cont(vardef,expect(\";\"),forspec2);if(type==\";\")return cont(forspec2);if(type==\"variable\")return cont(formaybeinof);return pass(expression,expect(\";\"),forspec2)}function formaybeinof(_type,value){if(value==\"in\"||value==\"of\"){cx.marked=\"keyword\";return cont(expression)}return cont(maybeoperatorComma,forspec2)}function forspec2(type,value){if(type==\";\")return cont(forspec3);if(value==\"in\"||value==\"of\"){cx.marked=\"keyword\";return cont(expression)}return pass(expression,expect(\";\"),forspec3)}function forspec3(type){if(type!=\")\")cont(expression)}function functiondef(type,value){if(value==\"*\"){cx.marked=\"keyword\";return cont(functiondef)}if(type==\"variable\"){register(value);return cont(functiondef)}if(type==\"(\")return cont(pushcontext,commasep(funarg,\")\"),statement,popcontext)}function funarg(type){if(type==\"spread\")return cont(funarg);return pass(pattern,maybetype)}function className(type,value){if(type==\"variable\"){register(value);return cont(classNameAfter)}}function classNameAfter(_type,value){if(value==\"extends\")return cont(expression)}function objlit(type){if(type==\"{\")return cont(commasep(objprop,\"}\"))}function afterModule(type,value){if(type==\"string\")return cont(statement);if(type==\"variable\"){register(value);return cont(maybeFrom)}}function afterExport(_type,value){if(value==\"*\"){cx.marked=\"keyword\";return cont(maybeFrom,expect(\";\"))}if(value==\"default\"){cx.marked=\"keyword\";return cont(expression,expect(\";\"))}return pass(statement)}function afterImport(type){if(type==\"string\")return cont();return pass(importSpec,maybeFrom)}function importSpec(type,value){if(type==\"{\")return cont(commasep(importSpec,\"}\"));if(type==\"variable\")register(value);return cont()}function maybeFrom(_type,value){if(value==\"from\"){cx.marked=\"keyword\";return cont(expression)}}function maybeArrayComprehension(type){if(type==\"for\")return pass(comprehension);if(type==\",\")return cont(commasep(expressionNoComma,\"]\",false));return pass(commasep(expressionNoComma,\"]\",false))}function comprehension(type){if(type==\"for\")return cont(forspec,comprehension);if(type==\"if\")return cont(expression,comprehension)}return{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:\"sof\",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,\"block\",false),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:0};if(parserConfig.globalVars)state.globalVars=parserConfig.globalVars;return state},token:function(stream,state){if(stream.sol()){if(!state.lexical.hasOwnProperty(\"align\"))state.lexical.align=false;state.indented=stream.indentation();findFatArrow(stream,state)}if(state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);if(type==\"comment\")return style;state.lastType=type==\"operator\"&&(content==\"++\"||content==\"--\")?\"incdec\":type;return parseJS(state,style,type,content,stream)},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical;for(var i=state.cc.length-1;i>=0;--i){var c=state.cc[i];if(c==poplex)lexical=lexical.prev;else if(c!=maybeelse)break}if(lexical.type==\"stat\"&&firstChar==\"}\")lexical=lexical.prev;if(statementIndent&&lexical.type==\")\"&&lexical.prev.type==\"stat\")lexical=lexical.prev;var type=lexical.type,closing=firstChar==type;if(type==\"vardef\")return lexical.indented+(state.lastType==\"operator\"||state.lastType==\",\"?lexical.info+1:0);else if(type==\"form\"&&firstChar==\"{\")return lexical.indented;else if(type==\"form\")return lexical.indented+indentUnit;else if(type==\"stat\")return lexical.indented+(state.lastType==\"operator\"||state.lastType==\",\"?statementIndent||indentUnit:0);else if(lexical.info==\"switch\"&&!closing&&parserConfig.doubleIndentSwitch!=false)return lexical.indented+(/^(?:case|default)\\b/.test(textAfter)?indentUnit:2*indentUnit);else if(lexical.align)return lexical.column+(closing?0:1);else return lexical.indented+(closing?0:indentUnit)},electricChars:\":{}\",blockCommentStart:jsonMode?null:\"/*\",blockCommentEnd:jsonMode?null:\"*/\",lineComment:jsonMode?null:\"//\",fold:\"brace\",helperType:jsonMode?\"json\":\"javascript\",jsonMode:jsonMode}});CodeMirror.defineMIME(\"text/javascript\",\"javascript\");CodeMirror.defineMIME(\"text/ecmascript\",\"javascript\");CodeMirror.defineMIME(\"application/javascript\",\"javascript\");CodeMirror.defineMIME(\"application/ecmascript\",\"javascript\");CodeMirror.defineMIME(\"application/json\",{name:\"javascript\",json:true});CodeMirror.defineMIME(\"application/x-json\",{name:\"javascript\",json:true});CodeMirror.defineMIME(\"text/typescript\",{name:\"javascript\",typescript:true});CodeMirror.defineMIME(\"application/typescript\",{name:\"javascript\",typescript:true});\n/*\n//@ sourceMappingURL=https://zapier.cachefly.net/static/CUEw7C/build/external.js.map\n*/"
      },
      "https://zapier.cachefly.net/static/CUEboR/build/external.js": {
         "pageUrl": "https://zapier.com/zapbook/gmail/",
         "scriptUrl": "https://zapier.cachefly.net/static/CUEboR/build/external.js",
         "body": "(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!==\"undefined\"){if(typeof module!==\"undefined\"&&module.exports){exports=module.exports=_}exports._=_}else{root[\"_\"]=_}_.VERSION=\"1.4.2\";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return}}else{for(var key in obj){if(_.has(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError(\"Reduce of empty array with no initial value\");return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return arguments.length>2?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial)throw new TypeError(\"Reduce of empty array with no initial value\");return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){var results=[];if(obj==null)return results;each(obj,function(value,index,list){if(!iterator.call(context,value,index,list))results[results.length]=value});return results};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return!!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker});return!!result};_.contains=_.include=function(obj,target){var found=false;if(obj==null)return found;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;found=any(obj,function(value){return value===target});return found};_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs){if(_.isEmpty(attrs))return[];return _.filter(obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false}return true})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index<right.index?-1:1}),\"value\")};var group=function(obj,value,context,behavior){var result={};var iterator=lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)})};_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){if(!_.has(result,key))result[key]=0;result[key]++})};_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(obj.length===+obj.length)return slice.call(obj);return _.values(obj)};_.size=function(obj){return obj.length===+obj.length?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){if(n!=null&&!guard){return slice.call(array,Math.max(array.length-n,0))}else{return array[array.length-1]}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,function(value){return!!value})};var flatten=function(input,shallow,output){each(input,function(value){if(_.isArray(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?!index||seen[seen.length-1]!==value:!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(concat.apply(ArrayProto,arguments))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,\"length\"));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(args,\"\"+i)}return results};_.object=function(list,values){var result={};for(var i=0,l=list.length;i<l;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,l=array.length;if(isSorted){if(typeof isSorted==\"number\"){i=isSorted<0?Math.max(0,l+isSorted):isSorted}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<l;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=hasIndex?from:array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};var ctor=function(){};_.bind=function bind(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait){var context,args,timeout,throttling,more,result;var whenDone=_.debounce(function(){more=throttling=false},wait);return function(){context=this;args=arguments;var later=function(){timeout=null;if(more){result=func.apply(context,args)}whenDone()};if(!timeout)timeout=setTimeout(later,wait);if(throttling){more=true}else{throttling=true;result=func.apply(context,args)}whenDone();return result}};_.debounce=function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){if(times<=0)return func();return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError(\"Invalid object\");var keys=[];for(var key in obj)if(_.has(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){var values=[];for(var key in obj)if(_.has(obj,key))values.push(obj[key]);return values};_.pairs=function(obj){var pairs=[];for(var key in obj)if(_.has(obj,key))pairs.push([key,obj[key]]);return pairs};_.invert=function(obj){var result={};for(var key in obj)if(_.has(obj,key))result[obj[key]]=key;return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){obj[prop]=source[prop]}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key]});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key]}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(obj[prop]==null)obj[prop]=source[prop]}});return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case\"[object String]\":return a==String(b);case\"[object Number]\":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case\"[object Date]\":case\"[object Boolean]\":return+a==+b;case\"[object RegExp]\":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!=\"object\"||typeof b!=\"object\")return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b}aStack.push(a);bStack.push(b);var size=0,result=true;if(className==\"[object Array]\"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break}}}else{var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)){return false}for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}if(result){for(key in b){if(_.has(b,key)&&!size--)break}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==\"[object Array]\"};_.isObject=function(obj){return obj===Object(obj)};each([\"Arguments\",\"Function\",\"String\",\"Number\",\"Date\",\"RegExp\"],function(name){_[\"is\"+name]=function(obj){return toString.call(obj)==\"[object \"+name+\"]\"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,\"callee\"))}}if(typeof/./!==\"function\"){_.isFunction=function(obj){return typeof obj===\"function\"}}_.isFinite=function(obj){return _.isNumber(obj)&&isFinite(obj)};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==\"[object Boolean]\"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)};_.random=function(min,max){if(max==null){max=min;min=0}return min+(0|Math.random()*(max-min+1))};var entityMap={escape:{\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"/\":\"&#x2F;\"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp(\"[\"+_.keys(entityMap.escape).join(\"\")+\"]\",\"g\"),unescape:new RegExp(\"(\"+_.keys(entityMap.unescape).join(\"|\")+\")\",\"g\")};_.each([\"escape\",\"unescape\"],function(method){_[method]=function(string){if(string==null)return\"\";return(\"\"+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null)return null;var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};var noMatch=/(.)^/;var escapes={\"'\":\"'\",\"\\\\\":\"\\\\\",\"\\r\":\"r\",\"\\n\":\"n\",\"\t\":\"t\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"};var escaper=/\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;_.template=function(text,data,settings){settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join(\"|\")+\"|$\",\"g\");var index=0;var source=\"__p+='\";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return\"\\\\\"+escapes[match]});source+=escape?\"'+\\n((__t=(\"+escape+\"))==null?'':_.escape(__t))+\\n'\":interpolate?\"'+\\n((__t=(\"+interpolate+\"))==null?'':__t)+\\n'\":evaluate?\"';\\n\"+evaluate+\"\\n__p+='\":\"\";index=offset+match.length});source+=\"';\\n\";if(!settings.variable)source=\"with(obj||{}){\\n\"+source+\"}\\n\";source=\"var __t,__p='',__j=Array.prototype.join,\"+\"print=function(){__p+=__j.call(arguments,'');};\\n\"+source+\"return __p;\\n\";try{var render=new Function(settings.variable||\"obj\",\"_\",source)}catch(e){e.source=source;throw e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};template.source=\"function(\"+(settings.variable||\"obj\")+\"){\\n\"+source+\"}\";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==\"shift\"||name==\"splice\")&&obj.length===0)delete obj[0];return result.call(this,obj)}});each([\"concat\",\"join\",\"slice\"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p=\"1.9.1\",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,w=/\\S+/g,T=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,N=/^(?:(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,C=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,k=/^[\\],:{}\\s]*$/,E=/(?:^|:|,)(?:\\s*\\[)+/g,S=/\\\\(?:[\"\\\\\\/bfnrt]|u[\\da-fA-F]{4})/g,A=/\"[^\"\\\\\\r\\n]*\"|true|false|null|-?(?:\\d+\\.|)\\d+(?:[eE][+-]?\\d+|)/g,j=/^-ms-/,D=/-([\\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||\"load\"===e.type||\"complete\"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener(\"DOMContentLoaded\",H,!1),e.removeEventListener(\"load\",H,!1)):(o.detachEvent(\"onreadystatechange\",H),e.detachEvent(\"onload\",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e)return this;if(\"string\"==typeof e){if(i=\"<\"===e.charAt(0)&&\">\"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return r.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:\"\",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for(\"boolean\"==typeof s&&(c=s,s=arguments[1]||{},u=2),\"object\"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(o=arguments[u]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r));return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger(\"ready\").off(\"ready\"))}},isFunction:function(e){return\"function\"===b.type(e)},isArray:Array.isArray||function(e){return\"array\"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+\"\":\"object\"==typeof e||\"function\"==typeof e?l[m.call(e)]||\"object\":typeof e},isPlainObject:function(e){if(!e||\"object\"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,\"constructor\")&&!y.call(e.constructor.prototype,\"isPrototypeOf\"))return!1}catch(n){return!1}var r;for(r in e);return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||\"string\"!=typeof e)return null;\"boolean\"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:\"string\"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,\"@\").replace(A,\"]\").replace(E,\"\")))?Function(\"return \"+n)():(b.error(\"Invalid JSON: \"+n),t)},parseXML:function(n){var r,i;if(!n||\"string\"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,\"text/xml\")):(r=new ActiveXObject(\"Microsoft.XMLDOM\"),r.async=\"false\",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName(\"parsererror\").length||b.error(\"Invalid XML: \"+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,\"ms-\").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:v&&!v.call(\"\")?function(e){return null==e?\"\":v.call(e)}:function(e){return null==e?\"\":(e+\"\").replace(T,\"\")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,\"string\"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g)return g.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if(\"number\"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return\"string\"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if(\"object\"===b.type(r)){o=!0;for(u in r)b.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),\"complete\"===o.readyState)setTimeout(b.ready);else if(o.addEventListener)o.addEventListener(\"DOMContentLoaded\",H,!1),e.addEventListener(\"load\",H,!1);else{o.attachEvent(\"onreadystatechange\",H),e.attachEvent(\"onload\",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll(\"left\")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}return n.promise(t)},b.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),function(e,t){l[\"[object \"+t+\"]\"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:\"array\"===n||\"function\"!==n&&(0===t||\"number\"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e=\"string\"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);\"function\"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&\"string\"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1)u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return!u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},b.extend({Deferred:function(e){var t=[[\"resolve\",\"done\",b.Callbacks(\"once memory\"),\"resolved\"],[\"reject\",\"fail\",b.Callbacks(\"once memory\"),\"rejected\"],[\"notify\",\"progress\",b.Callbacks(\"memory\")]],n=\"pending\",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+\"With\"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+\"With\"](this===i?r:this,arguments),this},i[o[0]+\"With\"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1)for(s=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i;return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement(\"div\");if(d.setAttribute(\"className\",\"t\"),d.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",n=d.getElementsByTagName(\"*\"),r=d.getElementsByTagName(\"a\")[0],!n||!r||!n.length)return{};s=o.createElement(\"select\"),l=s.appendChild(o.createElement(\"option\")),a=d.getElementsByTagName(\"input\")[0],r.style.cssText=\"top:1px;float:left;opacity:.5\",t={getSetAttribute:\"t\"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName(\"tbody\").length,htmlSerialize:!!d.getElementsByTagName(\"link\").length,style:/top/.test(r.getAttribute(\"style\")),hrefNormalized:\"/a\"===r.getAttribute(\"href\"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement(\"form\").enctype,html5Clone:\"<:nav></:nav>\"!==o.createElement(\"nav\").cloneNode(!0).outerHTML,boxModel:\"CSS1Compat\"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement(\"input\"),a.setAttribute(\"value\",\"\"),t.input=\"\"===a.getAttribute(\"value\"),a.value=\"t\",a.setAttribute(\"type\",\"radio\"),t.radioValue=\"t\"===a.value,a.setAttribute(\"checked\",\"t\"),a.setAttribute(\"name\",\"t\"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent(\"onclick\",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c=\"on\"+f,\"t\"),t[f+\"Bubbles\"]=c in e||d.attributes[c].expando===!1;return d.style.backgroundClip=\"content-box\",d.cloneNode(!0).style.backgroundClip=\"\",t.clearCloneStyle=\"content-box\"===d.style.backgroundClip,b(function(){var n,r,a,s=\"padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;\",u=o.getElementsByTagName(\"body\")[0];u&&(n=o.createElement(\"div\"),n.style.cssText=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px\",u.appendChild(n).appendChild(d),d.innerHTML=\"<table><tr><td></td><td>t</td></tr></table>\",a=d.getElementsByTagName(\"td\"),a[0].style.cssText=\"padding:0;margin:0;border:0;display:none\",p=0===a[0].offsetHeight,a[0].style.display=\"\",a[1].style.display=\"none\",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML=\"\",d.style.cssText=\"box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;\",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition=\"1%\"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable=\"4px\"===(e.getComputedStyle(d,null)||{width:\"4px\"}).width,r=d.appendChild(o.createElement(\"div\")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width=\"0\",d.style.width=\"1px\",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML=\"\",d.style.cssText=s+\"width:1px;padding:1px;display:inline;zoom:1\",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display=\"block\",d.innerHTML=\"<div></div>\",d.firstChild.style.width=\"5px\",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)\n}),n=s=u=l=r=a=null,t}();var O=/(?:\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u=\"string\"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t)return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),(\"object\"==typeof n||\"function\"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(\" \"));for(r=0,i=t.length;i>r;r++)delete o[t[r]];if(!(n?$:b.isEmptyObject)(o))return}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:\"jQuery\"+(p+Math.random()).replace(/\\D/g,\"\"),noData:{embed:!0,object:\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute(\"classid\")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,\"parsedAttrs\"))){for(r=o.attributes;r.length>a;a++)i=r[a].name,i.indexOf(\"data-\")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]));b._data(o,\"parsedAttrs\",!0)}return s}return\"object\"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i=\"data-\"+n.replace(B,\"-$1\").toLowerCase();if(r=e.getAttribute(i),\"string\"==typeof r){try{r=\"true\"===r?!0:\"false\"===r?!1:\"null\"===r?null:+r+\"\"===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else r=t}return r}function $(e){var t;for(t in e)if((\"data\"!==t||!b.isEmptyObject(e[t]))&&\"toJSON\"!==t)return!1;return!0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||\"fx\")+\"queue\",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||\"fx\";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};\"inprogress\"===i&&(i=n.shift(),r--),o.cur=i,i&&(\"fx\"===t&&n.unshift(\"inprogress\"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+\"queueHooks\";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks(\"once memory\").add(function(){b._removeData(e,t+\"queue\"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return\"string\"!=typeof e&&(n=e,e=\"fx\",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),\"fx\"===e&&\"inprogress\"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||\"fx\",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||\"fx\",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};\"string\"!=typeof e&&(n=e,e=t),e=e||\"fx\";while(s--)r=b._data(a[s],e+\"queueHooks\"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var I,z,X=/[\\t\\r\\n]/g,U=/\\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=\"string\"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||\"\").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(\" \"+n.className+\" \").replace(X,\" \"):\" \")){o=0;while(i=t[o++])0>r.indexOf(\" \"+i+\" \")&&(r+=i+\" \");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||\"string\"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||\"\").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(\" \"+n.className+\" \").replace(X,\" \"):\"\")){o=0;while(i=t[o++])while(r.indexOf(\" \"+i+\" \")>=0)r=r.replace(\" \"+i+\" \",\" \");n.className=e?b.trim(r):\"\"}return this},toggleClass:function(e,t){var n=typeof e,r=\"boolean\"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(\"string\"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++])u=r?u:!s.hasClass(o),s[u?\"addClass\":\"removeClass\"](o)}else(n===i||\"boolean\"===n)&&(this.className&&b._data(this,\"__className__\",this.className),this.className=this.className||e===!1?\"\":b._data(this,\"__className__\")||\"\")})},hasClass:function(e){var t=\" \"+e+\" \",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(\" \"+this[n].className+\" \").replace(X,\" \").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o=\"\":\"number\"==typeof o?o+=\"\":b.isArray(o)&&(o=b.map(o,function(e){return null==e?\"\":e+\"\"})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&\"set\"in r&&r.set(this,o,\"value\")!==t||(this.value=o))});if(o)return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&\"get\"in r&&(n=r.get(o,\"value\"))!==t?n:(n=o.value,\"string\"==typeof n?n.replace(U,\"\"):null==n?\"\":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o=\"select-one\"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute(\"disabled\"))||n.parentNode.disabled&&b.nodeName(n.parentNode,\"optgroup\"))){if(t=b(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find(\"option\").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&\"get\"in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&\"set\"in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+\"\"),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase(\"default-\"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,\"\"),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&\"radio\"===t&&b.nodeName(e,\"input\")){var n=e.value;return e.setAttribute(\"type\",t),n&&(e.value=n),t}}}},propFix:{tabindex:\"tabIndex\",readonly:\"readOnly\",\"for\":\"htmlFor\",\"class\":\"className\",maxlength:\"maxLength\",cellspacing:\"cellSpacing\",cellpadding:\"cellPadding\",rowspan:\"rowSpan\",colspan:\"colSpan\",usemap:\"useMap\",frameborder:\"frameBorder\",contenteditable:\"contentEditable\"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&\"set\"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&\"get\"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode(\"tabindex\");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i=\"boolean\"==typeof r&&e.getAttribute(n),o=\"boolean\"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase(\"default-\"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase(\"default-\"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,\"input\")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,\"input\")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&(\"id\"===n||\"name\"===n||\"coords\"===n?\"\"!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+=\"\",\"value\"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,\"\"===t?!1:t,n)}},b.each([\"width\",\"height\"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return\"\"===r?(e.setAttribute(n,\"auto\"),r):t}})})),b.support.hrefNormalized||(b.each([\"href\",\"src\",\"width\",\"height\"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each([\"href\",\"src\"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+\"\"}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype=\"encoding\"),b.support.checkOn||b.each([\"radio\",\"checkbox\"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute(\"value\")?\"on\":e.value}}}),b.each([\"radio\",\"checkbox\"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\\.(.+)|)$/;function it(){return!0}function ot(){return!1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||\"\").match(w)||[\"\"],l=n.length;while(l--)s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||\"\").split(\".\").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(\".\")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent(\"on\"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0;e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||\"\").match(w)||[\"\"],l=t.length;while(l--)if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||\"\").split(\".\").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp(\"(^|\\\\.)\"+h.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),u=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&(\"**\"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,\"events\"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,\"type\")?n.type:n,m=y.call(n,\"namespace\")?n.namespace.split(\".\"):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(\".\")>=0&&(m=g.split(\".\"),g=m.shift(),m.sort()),u=0>g.indexOf(\":\")&&\"on\"+g,n=n[b.expando]?n:new b.Event(g,\"object\"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join(\".\"),n.namespace_re=n.namespace?RegExp(\"(^|\\\\.)\"+m.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode)h.push(l),f=l;f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(b._data(l,\"events\")||{})[n.type]&&b._data(l,\"handle\"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault();if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||\"click\"===g&&b.nodeName(i,\"a\")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,\"events\")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||\"click\"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||\"click\"!==e.type)){for(o=[],a=0;u>a;a++)i=n[a],r=i.selector+\" \",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--)n=r[t],e[n]=a[n];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:\"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),fixHooks:{},keyHooks:{props:\"char charCode key keyCode\".split(\" \"),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:\"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,\"input\")&&\"checkbox\"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:\"focusin\"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:\"focusout\"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r=\"on\"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,\"form\")?!1:(b.event.add(this,\"click._submit keypress._submit\",function(e){var n=e.target,r=b.nodeName(n,\"input\")||b.nodeName(n,\"button\")?n.form:t;r&&!b._data(r,\"submitBubbles\")&&(b.event.add(r,\"submit._submit\",function(e){e._submit_bubble=!0}),b._data(r,\"submitBubbles\",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate(\"submit\",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,\"form\")?!1:(b.event.remove(this,\"._submit\"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?((\"checkbox\"===this.type||\"radio\"===this.type)&&(b.event.add(this,\"propertychange._change\",function(e){\"checked\"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,\"click._change\",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate(\"change\",this,e,!0)})),!1):(b.event.add(this,\"beforeactivate._change\",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,\"changeBubbles\")&&(b.event.add(t,\"change._change\",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate(\"change\",this.parentNode,e,!0)}),b._data(t,\"changeBubbles\",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||\"radio\"!==n.type&&\"checkbox\"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,\"._change\"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:\"focusin\",blur:\"focusout\"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if(\"object\"==typeof e){\"string\"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&(\"string\"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+\".\"+i.namespace:i.origType,i.selector,i.handler),this;if(\"object\"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||\"function\"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,\"**\"):this.off(t,e||\"**\",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x=\"sizzle\"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},_=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",F=\"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",O=F.replace(\"w\",\"w#\"),B=\"([*^$|!~]?=)\",P=\"\\\\[\"+_+\"*(\"+F+\")\"+_+\"*(?:\"+B+_+\"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\"+O+\")|)|)\"+_+\"*\\\\]\",R=\":(\"+F+\")(?:\\\\(((['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\"+P.replace(3,8)+\")*)|.*)\\\\)|)\",W=RegExp(\"^\"+_+\"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\"+_+\"+$\",\"g\"),$=RegExp(\"^\"+_+\"*,\"+_+\"*\"),I=RegExp(\"^\"+_+\"*([\\\\x20\\\\t\\\\r\\\\n\\\\f>+~])\"+_+\"*\"),z=RegExp(R),X=RegExp(\"^\"+O+\"$\"),U={ID:RegExp(\"^#(\"+F+\")\"),CLASS:RegExp(\"^\\\\.(\"+F+\")\"),NAME:RegExp(\"^\\\\[name=['\\\"]?(\"+F+\")['\\\"]?\\\\]\"),TAG:RegExp(\"^(\"+F.replace(\"w\",\"w*\")+\")\"),ATTR:RegExp(\"^\"+P),PSEUDO:RegExp(\"^\"+R),CHILD:RegExp(\"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+_+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+_+\"*(?:([+-]|)\"+_+\"*(\\\\d+)|))\"+_+\"*\\\\)|)\",\"i\"),needsContext:RegExp(\"^\"+_+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+_+\"*((?:-\\\\d)?\\\\d*)\"+_+\"*\\\\)|)(?=[^-]|$)\",\"i\")},V=/[\\x20\\t\\r\\n\\f]*[+~]/,Y=/^[^{]+\\{\\s*\\[native code/,J=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\\d$/i,K=/'|\\\\/g,Z=/\\=[\\x20\\t\\r\\n\\f]*([^'\"\\]]*)[\\x20\\t\\r\\n\\f]*\\]/g,et=/\\\\([\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|.)/g,tt=function(e,t){var n=\"0x\"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}function rt(e){return Y.test(e+\"\")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=\" \")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement(\"div\");try{return e(t)}catch(n){return!1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||\"string\"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(!d&&!r){if(i=J.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return H.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((a=i[3])&&T.getByClassName&&t.getElementsByClassName)return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&\"object\"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute(\"id\"))?g=f.replace(K,\"\\\\$&\"):t.setAttribute(\"id\",g),g=\"[id='\"+g+\"'] \",u=l.length;while(u--)l[u]=g+dt(l[u]);m=V.test(e)&&t.parentNode||t,v=l.join(\",\")}if(v)try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute(\"id\")}}}return wt(e.replace(W,\"$1\"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?\"HTML\"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment(\"\")),!e.getElementsByTagName(\"*\").length}),T.attributes=at(function(e){e.innerHTML=\"<select></select>\";var t=typeof e.lastChild.getAttribute(\"multiple\");return\"boolean\"!==t&&\"string\"!==t}),T.getByClassName=at(function(e){return e.innerHTML=\"<div class='hidden e'></div><div class='hidden'></div>\",e.getElementsByClassName&&e.getElementsByClassName(\"e\").length?(e.lastChild.className=\"e\",2===e.getElementsByClassName(\"e\").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML=\"<a name='\"+x+\"'></a><div name='\"+x+\"'></div>\",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML=\"<a href='#'></a>\",e.firstChild&&typeof e.firstChild.getAttribute!==A&&\"#\"===e.firstChild.getAttribute(\"href\")})?{}:{href:function(e){return e.getAttribute(\"href\",2)},type:function(e){return e.getAttribute(\"type\")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute(\"id\")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode(\"id\").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode(\"id\");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if(\"*\"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[\":focus\"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML=\"<select><option selected=''></option></select>\",e.querySelectorAll(\"[selected]\").length||h.push(\"\\\\[\"+_+\"*(?:checked|disabled|ismap|multiple|readonly|selected|value)\"),e.querySelectorAll(\":checked\").length||h.push(\":checked\")}),at(function(e){e.innerHTML=\"<input type='hidden' i=''/>\",e.querySelectorAll(\"[i^='']\").length&&h.push(\"[*^$]=\"+_+\"*(?:\\\"\\\"|'')\"),e.querySelectorAll(\":enabled\").length||h.push(\":enabled\",\":disabled\"),e.querySelectorAll(\"*,:x\"),h.push(\",.*:\")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,\"div\"),m.call(e,\"[s!='']:x\"),g.push(\"!=\",R)}),h=RegExp(h.join(\"|\")),g=RegExp(g.join(\"|\")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return u=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return ut(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,\"='$1']\"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t)))try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error(\"Syntax error, unrecognized expression: \"+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return\"input\"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return(\"input\"===n||\"button\"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}o=st.getText=function(e){var t,n=\"\",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if(\"string\"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||\"\").replace(et,tt),\"~=\"===e[2]&&(e[3]=\" \"+e[3]+\" \"),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),\"nth\"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(\"even\"===e[3]||\"odd\"===e[3])),e[5]=+(e[7]+e[8]||\"odd\"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(\")\",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return\"*\"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+\" \"];return t||(t=RegExp(\"(^|\"+_+\")\"+e+\"(\"+_+\"|$)\"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute(\"class\")||\"\")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?\"!=\"===t:t?(i+=\"\",\"=\"===t?i===n:\"!=\"===t?i!==n:\"^=\"===t?n&&0===i.indexOf(n):\"*=\"===t?n&&i.indexOf(n)>-1:\"$=\"===t?n&&i.slice(-n.length)===n:\"~=\"===t?(\" \"+i+\" \").indexOf(n)>-1:\"|=\"===t?i===n||i.slice(0,n.length+1)===n+\"-\":!1):!0}},CHILD:function(e,t,n,r,i){var o=\"nth\"!==e.slice(0,3),a=\"last\"!==e.slice(-4),s=\"of-type\"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?\"nextSibling\":\"previousSibling\",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;\nh=g=\"only\"===e&&!h&&\"nextSibling\"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}else if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N)f=l[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error(\"unsupported pseudo: \"+e);return r[x]?r(t):r.length>1?(n=[e,e,\"\",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,\"$1\"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||\"\")||st.error(\"unsupported lang: \"+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=d?t.getAttribute(\"xml:lang\")||t.getAttribute(\"lang\"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+\"-\");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&!!e.checked||\"option\"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>\"@\"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return\"input\"===t&&\"button\"===e.type||\"button\"===t},text:function(e){var t;return\"input\"===e.nodeName.toLowerCase()&&\"text\"===e.type&&(null==(t=e.getAttribute(\"type\"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=lt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=ct(n);function ft(e,t){var n,r,o,a,s,u,l,c=E[e+\" \"];if(c)return t?0:c.slice(0);s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W,\" \")}),s=s.slice(n.length));for(a in i.filter)!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r=\"\";for(;n>t;t++)r+=e[t].value;return r}function ht(e,t,n){var i=t.dir,o=n&&\"parentNode\"===i,a=C++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,s){var u,l,c,p=N+\" \"+a;if(s){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0)return!0}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||\"*\",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--)(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}else y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[\" \"],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++)if(n=i.relative[e[u].type])f=[ht(gt(f),n)];else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++)if(i.relative[e[r].type])break;return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,\"$1\"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b=\"0\",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG(\"*\",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,u,c)){f.push(h);break}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++])m(x,y,u,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=L.call(f));y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+\" \"];if(!o){t||(t=ft(e)),n=t.length;while(n--)o=vt(t[n]),o[x]?r.push(o):i.push(o);o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&\"ID\"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type])break;if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e)return H.apply(n,q.call(r,0)),n;break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[\":\"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\\[\\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if(\"string\"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+\" \":\"\")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return!!e&&(\"string\"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||\"string\"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?\"string\"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=\"string\"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,\"parentNode\")},parentsUntil:function(e,t,n){return b.dir(e,\"parentNode\",n)},next:function(e){return pt(e,\"nextSibling\")},prev:function(e){return pt(e,\"previousSibling\")},nextAll:function(e){return b.dir(e,\"nextSibling\")},prevAll:function(e){return b.dir(e,\"previousSibling\")},nextUntil:function(e,t,n){return b.dir(e,\"nextSibling\",n)},prevUntil:function(e,t,n){return b.dir(e,\"previousSibling\",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,\"iframe\")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&\"string\"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=\":not(\"+e+\")\"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if(\"string\"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split(\"|\"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht=\"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",gt=/ jQuery\\d+=\"(?:null|\\d+)\"/g,mt=RegExp(\"<(?:\"+ht+\")[\\\\s/>]\",\"i\"),yt=/^\\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,bt=/<([\\w:]+)/,xt=/<tbody/i,wt=/<|&#?\\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\\s*(?:[^=]|=\\s*.checked.)/i,kt=/^$|\\/(?:java|ecma)script/i,Et=/^true\\/(.*)/,St=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,At={option:[1,\"<select multiple='multiple'>\",\"</select>\"],legend:[1,\"<fieldset>\",\"</fieldset>\"],area:[1,\"<map>\",\"</map>\"],param:[1,\"<object>\",\"</object>\"],thead:[1,\"<table>\",\"</table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],col:[2,\"<table><tbody></tbody><colgroup>\",\"</colgroup></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],_default:b.support.htmlSerialize?[0,\"\",\"\"]:[1,\"X<div>\",\"</div>\"]},jt=dt(o),Dt=jt.appendChild(o.createElement(\"div\"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,\"body\")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,\"script\")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,\"select\")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,\"\"):t;if(!(\"string\"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||[\"\",\"\"])[1].toLowerCase()])){e=e.replace(vt,\"<$1></$2>\");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||\"string\"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||\"string\"!=typeof g||b.support.checkClone)&&Ct.test(g))return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)});if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,\"tr\"),s=b.map(Ot(l,\"script\"),Ht),a=s.length;p>c;c++)o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,\"script\"))),r.call(n&&b.nodeName(this[c],\"table\")?Lt(this[c],\"tbody\"):this[c],o,c);if(a)for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++)o=s[c],kt.test(o.type||\"\")&&!b._data(o,\"globalEval\")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:\"GET\",dataType:\"script\",async:!1,global:!1,\"throws\":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||\"\").replace(St,\"\")));l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode(\"type\");return e.type=(t&&t.specified)+\"/\"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute(\"type\"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,\"globalEval\",!t||b._data(t[r],\"globalEval\"))}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)b.event.add(t,n,s[n][r])}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}\"script\"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):\"object\"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):\"input\"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):\"option\"===n?t.defaultSelected=t.selected=e.defaultSelected:(\"input\"===n||\"textarea\"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||\"*\"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||\"*\"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test(\"<\"+e.nodeName+\">\")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a)r[a]&&Ft(i,r[a]);if(t)if(n)for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++)_t(i,r[a]);else _t(e,o);return r=Ot(o,\"script\"),r.length>0&&Mt(r,!u&&Ot(e,\"script\")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if(\"object\"===b.type(o))b.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement(\"div\")),u=(bt.exec(o)||[\"\",\"\"])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,\"<$1></$2>\")+c[2],i=c[0];while(i--)s=s.lastChild;if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o=\"table\"!==u||xt.test(o)?\"<table>\"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)b.nodeName(l=o.childNodes[i],\"tbody\")&&!l.childNodes.length&&o.removeChild(l)}b.merge(d,s.childNodes),s.textContent=\"\";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,\"input\"),Bt),h=0;while(o=d[h++])if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),\"script\"),a&&Mt(s),n)){i=0;while(o=s[i++])kt.test(o.type||\"\")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++)if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events)for(r in a.events)f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle);l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}});var Pt,Rt,Wt,$t=/alpha\\([^)]*\\)/i,It=/opacity\\s*=\\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp(\"^(\"+x+\")(.*)$\",\"i\"),Yt=RegExp(\"^(\"+x+\")(?!px)[a-z%]+$\",\"i\"),Jt=RegExp(\"^([+-])=(\"+x+\")\",\"i\"),Gt={BODY:\"block\"},Qt={position:\"absolute\",visibility:\"hidden\",display:\"block\"},Kt={letterSpacing:0,fontWeight:400},Zt=[\"Top\",\"Right\",\"Bottom\",\"Left\"],en=[\"Webkit\",\"O\",\"Moz\",\"ms\"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,\"none\"===b.css(e,\"display\")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=b._data(r,\"olddisplay\"),n=r.style.display,t?(o[a]||\"none\"!==n||(r.style.display=\"\"),\"\"===r.style.display&&nn(r)&&(o[a]=b._data(r,\"olddisplay\",un(r.nodeName)))):o[a]||(i=nn(r),(n&&\"none\"!==n||!i)&&b._data(r,\"olddisplay\",i?n:b.css(r,\"display\"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&\"none\"!==r.style.display&&\"\"!==r.style.display||(r.style.display=t?o[a]||\"\":\"none\"));return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=b.css(e,n[s],!1,o);return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t=\"boolean\"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,\"opacity\");return\"\"===n?\"1\":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":b.support.cssFloat?\"cssFloat\":\"styleFloat\"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t)return s&&\"get\"in s&&(o=s.get(e,!1,i))!==t?o:l[n];if(a=typeof r,\"string\"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a=\"number\"),!(null==r||\"number\"===a&&isNaN(r)||(\"number\"!==a||b.cssNumber[u]||(r+=\"px\"),b.support.clearCloneStyle||\"\"!==r||0!==n.indexOf(\"background\")||(l[n]=\"inherit\"),s&&\"set\"in s&&(r=s.set(e,r,i))===t)))try{l[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&\"get\"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),\"normal\"===a&&n in Kt&&(a=Kt[n]),\"\"===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(\"\"!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left=\"fontSize\"===n?\"1em\":u,u=l.pixelLeft+\"px\",l.left=i,a&&(o.left=a)),\"\"===u?\"auto\":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||\"px\"):t}function an(e,t,n,r,i){var o=n===(r?\"border\":\"content\")?4:\"width\"===t?1:0,a=0;for(;4>o;o+=2)\"margin\"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?(\"content\"===n&&(a-=b.css(e,\"padding\"+Zt[o],!0,i)),\"margin\"!==n&&(a-=b.css(e,\"border\"+Zt[o]+\"Width\",!0,i))):(a+=b.css(e,\"padding\"+Zt[o],!0,i),\"padding\"!==n&&(a+=b.css(e,\"border\"+Zt[o]+\"Width\",!0,i)));return a}function sn(e,t,n){var r=!0,i=\"width\"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&\"border-box\"===b.css(e,\"boxSizing\",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?\"border\":\"content\"),r,o)+\"px\"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),\"none\"!==n&&n||(Pt=(Pt||b(\"<iframe frameborder='0' width='0' height='0'/>\").css(\"cssText\",\"display:block !important\")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write(\"<!doctype html><html><body>\"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],\"display\");return n.remove(),r}b.each([\"height\",\"width\"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,\"display\"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&\"border-box\"===b.css(e,\"boxSizing\",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||\"\")?.01*parseFloat(RegExp.$1)+\"\":t?\"1\":\"\"},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?\"alpha(opacity=\"+100*t+\")\":\"\",o=r&&r.filter||n.filter||\"\";n.zoom=1,(t>=1||\"\"===t)&&\"\"===b.trim(o.replace($t,\"\"))&&n.removeAttribute&&(n.removeAttribute(\"filter\"),\"\"===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+\" \"+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:\"inline-block\"},Wt,[e,\"marginRight\"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each([\"top\",\"left\"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+\"px\":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&\"none\"===(e.style&&e.style.display||b.css(e,\"display\"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:\"\",padding:\"\",border:\"Width\"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o=\"string\"==typeof n?n.split(\" \"):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\\[\\]$/,fn=/\\r?\\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,\"elements\");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(\":disabled\")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,\"\\r\\n\")}}):{name:t.name,value:n.replace(fn,\"\\r\\n\")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?\"\":t,i[i.length]=encodeURIComponent(e)+\"=\"+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join(\"&\").replace(cn,\"+\")};function gn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+\"[\"+(\"object\"==typeof i?t:\"\")+\"]\",i,n,r)});else if(n||\"object\"!==b.type(t))r(e,t);else for(i in t)gn(e+\"[\"+i+\"]\",t[i],n,r)}b.each(\"blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu\".split(\" \"),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\\/\\//,En=/^([\\w.+-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn=\"*/\".concat(\"*\");try{yn=a.href}catch(Ln){yn=o.createElement(\"a\"),yn.href=\"\",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){\"string\"!=typeof t&&(n=t,t=\"*\");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n))while(r=o[i++])\"+\"===r[0]?(r=r.slice(1)||\"*\",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return\"string\"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o[\"*\"]&&s(\"*\")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if(\"string\"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(\" \");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&\"object\"==typeof n&&(a=\"POST\"),s.length>0&&b.ajax({url:e,type:a,dataType:\"html\",data:n}).done(function(e){o=arguments,s.html(i?b(\"<div>\").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each([\"get\",\"post\"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:\"GET\",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":Dn,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:\"responseXML\",text:\"responseText\"},converters:{\"* text\":e.String,\"text html\":!0,\"text json\":b.parseJSON,\"text xml\":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){\"object\"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks(\"once memory\"),m=p.statusCode||{},y={},v={},x=0,T=\"canceled\",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else N.always(e[N.status]);return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+\"\").replace(xn,\"\").replace(kn,mn[1]+\"//\"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||\"*\").toLowerCase().match(w)||[\"\"],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||(\"http:\"===r[1]?80:443))==(mn[3]||(\"http:\"===mn[1]?80:443)))),p.data&&p.processData&&\"string\"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x)return N;u=p.global,u&&0===b.active++&&b.event.trigger(\"ajaxStart\"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?\"&\":\"?\")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,\"$1_=\"+vn++):o+(bn.test(o)?\"&\":\"?\")+\"_=\"+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader(\"If-Modified-Since\",b.lastModified[o]),b.etag[o]&&N.setRequestHeader(\"If-None-Match\",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader(\"Content-Type\",p.contentType),N.setRequestHeader(\"Accept\",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+(\"*\"!==p.dataTypes[0]?\", \"+Dn+\"; q=0.01\":\"\"):p.accepts[\"*\"]);for(i in p.headers)N.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x))return N.abort();T=\"abort\";for(i in{success:1,error:1,complete:1})N[i](p[i]);if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger(\"ajaxSend\",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort(\"timeout\")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x))throw C;k(-1,C)}}else k(-1,\"No Transport\");function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||\"\",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader(\"Last-Modified\"),T&&(b.lastModified[o]=T),T=N.getResponseHeader(\"etag\"),T&&(b.etag[o]=T)),204===e?(c=!0,C=\"nocontent\"):304===e?(c=!0,C=\"notmodified\"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C=\"error\",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+\"\",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?\"ajaxSuccess\":\"ajaxError\",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger(\"ajaxComplete\",[N,p]),--b.active||b.event.trigger(\"ajaxStop\")))\n}return N},getScript:function(e,n){return b.get(e,t,n,\"script\")},getJSON:function(e,t,n){return b.get(e,t,n,\"json\")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c)s in r&&(n[c[s]]=r[s]);while(\"*\"===l[0])l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader(\"Content-Type\"));if(o)for(s in u)if(u[s]&&u[s].test(o)){l.unshift(s);break}if(l[0]in r)a=l[0];else{for(s in r){if(!l[0]||e.converters[s+\" \"+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1])for(i in e.converters)a[i.toLowerCase()]=e.converters[i];for(;r=u[++s];)if(\"*\"!==r){if(\"*\"!==l&&l!==r){if(i=a[l+\" \"+r]||a[\"* \"+r],!i)for(n in a)if(o=n.split(\" \"),o[1]===r&&(i=a[l+\" \"+o[0]]||a[\"* \"+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}if(i!==!0)if(i&&e[\"throws\"])t=i(t);else try{t=i(t)}catch(c){return{state:\"parsererror\",error:i?c:\"No conversion from \"+l+\" to \"+r}}}l=r}return{state:\"success\",data:t}}b.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/(?:java|ecma)script/},converters:{\"text script\":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter(\"script\",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type=\"GET\",e.global=!1)}),b.ajaxTransport(\"script\",function(e){if(e.crossDomain){var n,r=o.head||b(\"head\")[0]||o.documentElement;return{send:function(t,i){n=o.createElement(\"script\"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,\"success\"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\\?(?=&|$)|\\?\\?/;b.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var e=On.pop()||b.expando+\"_\"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter(\"json jsonp\",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?\"url\":\"string\"==typeof n.data&&!(n.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&Bn.test(n.data)&&\"data\");return u||\"jsonp\"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,\"$1\"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?\"&\":\"?\")+n.jsonp+\"=\"+o),n.converters[\"script json\"]=function(){return s||b.error(o+\" was not called\"),s[0]},n.dataTypes[0]=\"json\",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),\"script\"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject(\"Microsoft.XMLHTTP\")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&\"withCredentials\"in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)u[s]=n.xhrFields[s];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i[\"X-Requested-With\"]||(i[\"X-Requested-With\"]=\"XMLHttpRequest\");try{for(s in i)u.setRequestHeader(s,i[s])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState))if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i)4!==u.readyState&&u.abort();else{p={},s=u.status,l=u.getAllResponseHeaders(),\"string\"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=\"\"}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp(\"^(?:([+-])=|)(\"+x+\")([a-z%]*)$\",\"i\"),Jn=/queueHooks$/,Gn=[nr],Qn={\"*\":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?\"\":\"px\"),\"px\"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do u=u||\".5\",s/=u,b.style(i.elem,e,s+r);while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn[\"*\"]),i=0,o=r.length;for(;o>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++)if(r=Gn[o].call(l,e,c,l.opts))return r;return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e)if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&\"expand\"in a){n=a.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=o)}else t[r]=o}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=[\"*\"]):e=e.split(\" \");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,\"fx\"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,\"fx\").length||c.empty.fire()})})),1===e.nodeType&&(\"height\"in t||\"width\"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],\"inline\"===b.css(e,\"display\")&&\"none\"===b.css(e,\"float\")&&(b.support.inlineBlockNeedsLayout&&\"inline\"!==un(e.nodeName)?d.zoom=1:d.display=\"inline-block\")),n.overflow&&(d.overflow=\"hidden\",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||\"toggle\"===a,a===(m?\"hide\":\"show\"))continue;g.push(i)}if(o=g.length){s=b._data(e,\"fxshow\")||b._data(e,\"fxshow\",{}),\"hidden\"in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,\"fxshow\");for(t in h)b.style(e,t,h[t])});for(i=0;o>i;i++)r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start=\"width\"===r||\"height\"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||\"swing\",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?\"\":\"px\")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,\"\"),t&&\"auto\"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each([\"toggle\",\"show\",\"hide\"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||\"boolean\"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css(\"opacity\",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,\"finish\"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return\"string\"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||\"fx\",[]),this.each(function(){var t=!0,n=null!=e&&e+\"queueHooks\",o=b.timers,a=b._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||\"fx\"),this.each(function(){var t,n=b._data(this),r=n[e+\"queue\"],i=n[e+\"queueHooks\"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r[\"margin\"+n]=r[\"padding\"+n]=e;return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir(\"show\"),slideUp:ir(\"hide\"),slideToggle:ir(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&\"object\"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:\"number\"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue=\"fx\"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},b.offset={setOffset:function(e,t,n){var r=b.css(e,\"position\");\"static\"===r&&(e.style.position=\"relative\");var i=b(e),o=i.offset(),a=b.css(e,\"top\"),s=b.css(e,\"left\"),u=(\"absolute\"===r||\"fixed\"===r)&&b.inArray(\"auto\",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),\"using\"in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return\"fixed\"===b.css(r,\"position\")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],\"html\")||(n=e.offset()),n.top+=b.css(e[0],\"borderTopWidth\",!0),n.left+=b.css(e[0],\"borderLeftWidth\",!0)),{top:t.top-n.top-b.css(r,\"marginTop\",!0),left:t.left-n.left-b.css(r,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,\"html\")&&\"static\"===b.css(e,\"position\"))e=e.offsetParent;return e||o.documentElement})}}),b.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:\"height\",Width:\"width\"},function(e,n){b.each({padding:\"inner\"+e,content:n,\"\":\"outer\"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||\"boolean\"!=typeof i),s=r||(i===!0||o===!0?\"margin\":\"border\");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement[\"client\"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body[\"scroll\"+e],o[\"scroll\"+e],n.body[\"offset\"+e],o[\"offset\"+e],o[\"client\"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,\"function\"==typeof define&&define.amd&&define.amd.jQuery&&define(\"jquery\",[],function(){return b})})(window);(function(factory){if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(jQuery)}})(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler(\"remove\")}catch(e){}}_cleanData(elems)};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(\".\")[0];name=name.split(\".\")[1];fullName=namespace+\"-\"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[\":\"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+\".\"+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor)};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options===\"string\",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error(\"cannot call methods on \"+name+\" prior to initialization; \"+\"attempted to call method '\"+options+\"'\")}if(!$.isFunction(instance[options])||options.charAt(0)===\"_\"){return $.error(\"no such method '\"+options+\"' for \"+name+\" widget instance\")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init()}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:\"widget\",widgetEventPrefix:\"\",defaultElement:\"<div>\",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace=\".\"+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger(\"create\",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr(\"aria-disabled\").removeClass(this.widgetFullName+\"-disabled \"+\"ui-state-disabled\");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass(\"ui-state-hover\");this.focusable.removeClass(\"ui-state-focus\")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key===\"string\"){options={};parts=key.split(\".\");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key===\"disabled\"){this.widget().toggleClass(this.widgetFullName+\"-disabled ui-state-disabled\",!!value).attr(\"aria-disabled\",value);this.hoverable.removeClass(\"ui-state-hover\");this.focusable.removeClass(\"ui-state-focus\")}return this},enable:function(){return this._setOption(\"disabled\",false)},disable:function(){return this._setOption(\"disabled\",true)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!==\"boolean\"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass(\"ui-state-disabled\"))){return}return(typeof handler===\"string\"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!==\"string\"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^(\\w+)\\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||\"\").split(\" \").join(this.eventNamespace+\" \")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler===\"string\"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass(\"ui-state-hover\")},mouseleave:function(event){$(event.currentTarget).removeClass(\"ui-state-hover\")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass(\"ui-state-focus\")},focusout:function(event){$(event.currentTarget).removeClass(\"ui-state-focus\")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:\"fadeIn\",hide:\"fadeOut\"},function(method,defaultEffect){$.Widget.prototype[\"_\"+method]=function(element,options,callback){if(typeof options===\"string\"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options===\"number\"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options===\"number\"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}})});window.CodeMirror=function(){\"use strict\";var gecko=/gecko\\/\\d/i.test(navigator.userAgent);var ie=/MSIE \\d/.test(navigator.userAgent);var ie_lt8=ie&&(document.documentMode==null||document.documentMode<8);var ie_lt9=ie&&(document.documentMode==null||document.documentMode<9);var webkit=/WebKit\\//.test(navigator.userAgent);var qtwebkit=webkit&&/Qt\\/\\d+\\.\\d+/.test(navigator.userAgent);var chrome=/Chrome\\//.test(navigator.userAgent);var opera=/Opera\\//.test(navigator.userAgent);var safari=/Apple Computer/.test(navigator.vendor);var khtml=/KHTML\\//.test(navigator.userAgent);var mac_geLion=/Mac OS X 1\\d\\D([7-9]|\\d\\d)\\D/.test(navigator.userAgent);var mac_geMountainLion=/Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(navigator.userAgent);var phantom=/PhantomJS/.test(navigator.userAgent);var ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\\/\\w+/.test(navigator.userAgent);var mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var mac=ios||/Mac/.test(navigator.platform);var windows=/windows/i.test(navigator.platform);var opera_version=opera&&navigator.userAgent.match(/Version\\/(\\d*\\.\\d*)/);if(opera_version)opera_version=Number(opera_version[1]);var flipCtrlCmd=mac&&(qtwebkit||opera&&(opera_version==null||opera_version<12.11));var captureMiddleClick=gecko||ie&&!ie_lt9;var sawReadOnlySpans=false,sawCollapsedSpans=false;function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options||{};for(var opt in defaults)if(!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt))options[opt]=defaults[opt];setGuttersForLineNumbers(options);var docStart=typeof options.value==\"string\"?0:options.value.first;var display=this.display=makeDisplay(place,docStart);display.wrapper.CodeMirror=this;updateGutters(this);if(options.autofocus&&!mobile)focusInput(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,draggingText:false,highlight:new Delayed};themeChanged(this);if(options.lineWrapping)this.display.wrapper.className+=\" CodeMirror-wrap\";var doc=options.value;if(typeof doc==\"string\")doc=new Doc(options.value,options.mode);operation(this,attachDoc)(this,doc);if(ie)setTimeout(bind(resetInput,this,true),20);registerEventHandlers(this);var hasFocus;try{hasFocus=document.activeElement==display.input}catch(e){}if(hasFocus||options.autofocus&&!mobile)setTimeout(bind(onFocus,this),20);else onBlur(this);operation(this,function(){for(var opt in optionHandlers)if(optionHandlers.propertyIsEnumerable(opt))optionHandlers[opt](this,options[opt],Init);for(var i=0;i<initHooks.length;++i)initHooks[i](this)})()}function makeDisplay(place,docStart){var d={};var input=d.input=elt(\"textarea\",null,null,\"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;\");if(webkit)input.style.width=\"1000px\";else input.setAttribute(\"wrap\",\"off\");if(ios)input.style.border=\"1px solid black\";input.setAttribute(\"autocorrect\",\"off\");input.setAttribute(\"autocapitalize\",\"off\");input.setAttribute(\"spellcheck\",\"false\");d.inputDiv=elt(\"div\",[input],null,\"overflow: hidden; position: relative; width: 3px; height: 0px;\");d.scrollbarH=elt(\"div\",[elt(\"div\",null,null,\"height: 1px\")],\"CodeMirror-hscrollbar\");d.scrollbarV=elt(\"div\",[elt(\"div\",null,null,\"width: 1px\")],\"CodeMirror-vscrollbar\");d.scrollbarFiller=elt(\"div\",null,\"CodeMirror-scrollbar-filler\");d.gutterFiller=elt(\"div\",null,\"CodeMirror-gutter-filler\");d.lineDiv=elt(\"div\",null,\"CodeMirror-code\");d.selectionDiv=elt(\"div\",null,null,\"position: relative; z-index: 1\");d.cursor=elt(\"div\",\"\",\"CodeMirror-cursor\");d.otherCursor=elt(\"div\",\"\",\"CodeMirror-cursor CodeMirror-secondarycursor\");d.measure=elt(\"div\",null,\"CodeMirror-measure\");d.lineSpace=elt(\"div\",[d.measure,d.selectionDiv,d.lineDiv,d.cursor,d.otherCursor],null,\"position: relative; outline: none\");d.mover=elt(\"div\",[elt(\"div\",[d.lineSpace],\"CodeMirror-lines\")],null,\"position: relative\");d.sizer=elt(\"div\",[d.mover],\"CodeMirror-sizer\");d.heightForcer=elt(\"div\",null,null,\"position: absolute; height: \"+scrollerCutOff+\"px; width: 1px;\");d.gutters=elt(\"div\",null,\"CodeMirror-gutters\");d.lineGutter=null;d.scroller=elt(\"div\",[d.sizer,d.heightForcer,d.gutters],\"CodeMirror-scroll\");d.scroller.setAttribute(\"tabIndex\",\"-1\");d.wrapper=elt(\"div\",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.gutterFiller,d.scroller],\"CodeMirror\");if(ie_lt8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0}if(place.appendChild)place.appendChild(d.wrapper);else place(d.wrapper);if(ios)input.style.width=\"0px\";if(!webkit)d.scroller.draggable=true;if(khtml){d.inputDiv.style.height=\"1px\";d.inputDiv.style.position=\"absolute\"}else if(ie_lt8)d.scrollbarH.style.minWidth=d.scrollbarV.style.minWidth=\"18px\";d.viewOffset=d.lastSizeC=0;d.showingFrom=d.showingTo=docStart;d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;d.prevInput=\"\";d.alignWidgets=false;d.pollingFast=false;d.poll=new Delayed;d.cachedCharWidth=d.cachedTextHeight=null;d.measureLineCache=[];d.measureLineCachePos=0;d.inaccurateSelection=false;d.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;return d}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption);cm.doc.iter(function(line){if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null});cm.doc.frontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp)regChange(cm)}function wrappingChanged(cm){if(cm.options.lineWrapping){cm.display.wrapper.className+=\" CodeMirror-wrap\";cm.display.sizer.style.minWidth=\"\"}else{cm.display.wrapper.className=cm.display.wrapper.className.replace(\" CodeMirror-wrap\",\"\");computeMaxLength(cm)}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout(function(){updateScrollbars(cm)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;else if(wrapping)return(Math.ceil(line.text.length/perLine)||1)*th;else return th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);if(estHeight!=line.height)updateLineHeight(line,estHeight)})}function keyMapChanged(cm){var map=keyMap[cm.options.keyMap],style=map.style;cm.display.wrapper.className=cm.display.wrapper.className.replace(/\\s*cm-keymap-\\S+/g,\"\")+(style?\" cm-keymap-\"+style:\"\");if(map.disableInput)cm.doc.cantEdit|=cantEdit_keymap;else cm.doc.cantEdit&=~cantEdit_keymap}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g,\"\")+cm.options.theme.replace(/(^|\\s)\\s*/g,\" cm-s-\");clearCaches(cm)}function guttersChanged(cm){updateGutters(cm);regChange(cm);setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i];var gElt=gutters.appendChild(elt(\"div\",null,\"CodeMirror-gutter \"+gutterClass));if(gutterClass==\"CodeMirror-linenumbers\"){cm.display.lineGutter=gElt;gElt.style.width=(cm.display.lineNumWidth||1)+\"px\"}}gutters.style.display=i?\"\":\"none\"}function lineLength(doc,line){if(line.height==0)return 0;var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find();cur=getLine(doc,found.from.line);len+=found.from.ch-found.to.ch}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();len-=cur.text.length-found.from.ch;cur=getLine(doc,found.to.line);len+=cur.text.length-found.to.ch}return len}function computeMaxLength(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(doc,d.maxLine);d.maxLineChanged=true;doc.iter(function(line){var len=lineLength(doc,line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line}})}function setGuttersForLineNumbers(options){var found=false;for(var i=0;i<options.gutters.length;++i){if(options.gutters[i]==\"CodeMirror-linenumbers\"){if(options.lineNumbers)found=true;else options.gutters.splice(i--,1)}}if(!found&&options.lineNumbers)options.gutters.push(\"CodeMirror-linenumbers\")}function updateScrollbars(cm){var d=cm.display,docHeight=cm.doc.height;\nvar totalHeight=docHeight+paddingVert(d);d.sizer.style.minHeight=d.heightForcer.style.top=totalHeight+\"px\";d.gutters.style.height=Math.max(totalHeight,d.scroller.clientHeight-scrollerCutOff)+\"px\";var scrollHeight=Math.max(totalHeight,d.scroller.scrollHeight);var needsH=d.scroller.scrollWidth>d.scroller.clientWidth+1;var needsV=scrollHeight>d.scroller.clientHeight+1;if(needsV){d.scrollbarV.style.display=\"block\";d.scrollbarV.style.bottom=needsH?scrollbarWidth(d.measure)+\"px\":\"0\";d.scrollbarV.firstChild.style.height=scrollHeight-d.scroller.clientHeight+d.scrollbarV.clientHeight+\"px\"}else d.scrollbarV.style.display=\"\";if(needsH){d.scrollbarH.style.display=\"block\";d.scrollbarH.style.right=needsV?scrollbarWidth(d.measure)+\"px\":\"0\";d.scrollbarH.firstChild.style.width=d.scroller.scrollWidth-d.scroller.clientWidth+d.scrollbarH.clientWidth+\"px\"}else d.scrollbarH.style.display=\"\";if(needsH&&needsV){d.scrollbarFiller.style.display=\"block\";d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=scrollbarWidth(d.measure)+\"px\"}else d.scrollbarFiller.style.display=\"\";if(needsH&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter){d.gutterFiller.style.display=\"block\";d.gutterFiller.style.height=scrollbarWidth(d.measure)+\"px\";d.gutterFiller.style.width=d.gutters.offsetWidth+\"px\"}else d.gutterFiller.style.display=\"\";if(mac_geLion&&scrollbarWidth(d.measure)===0)d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=mac_geMountainLion?\"18px\":\"12px\"}function visibleLines(display,doc,viewPort){var top=display.scroller.scrollTop,height=display.wrapper.clientHeight;if(typeof viewPort==\"number\")top=viewPort;else if(viewPort){top=viewPort.top;height=viewPort.bottom-viewPort.top}top=Math.floor(top-paddingTop(display));var bottom=Math.ceil(top+height);return{from:lineAtHeight(doc,top),to:lineAtHeight(doc,bottom)}}function alignHorizontally(cm){var display=cm.display;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter))return;var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,l=comp+\"px\";for(var n=display.lineDiv.firstChild;n;n=n.nextSibling)if(n.alignable){for(var i=0,a=n.alignable;i<a.length;++i)a[i].style.left=l}if(cm.options.fixedGutter)display.gutters.style.left=comp+gutterW+\"px\"}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return false;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt(\"div\",[elt(\"div\",last)],\"CodeMirror-linenumber CodeMirror-gutter-elt\"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width=\"\";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding);display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+\"px\";return true}return false}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return getRect(display.scroller).left-getRect(display.sizer).left}function updateDisplay(cm,changes,viewPort){var oldFrom=cm.display.showingFrom,oldTo=cm.display.showingTo,updated;var visible=visibleLines(cm.display,cm.doc,viewPort);for(;;){if(!updateDisplayInner(cm,changes,visible))break;updated=true;updateSelection(cm);updateScrollbars(cm);if(viewPort)viewPort=Math.min(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,typeof viewPort==\"number\"?viewPort:viewPort.top);visible=visibleLines(cm.display,cm.doc,viewPort);if(visible.from>=cm.display.showingFrom&&visible.to<=cm.display.showingTo)break;changes=[]}if(updated){signalLater(cm,\"update\",cm);if(cm.display.showingFrom!=oldFrom||cm.display.showingTo!=oldTo)signalLater(cm,\"viewportChange\",cm,cm.display.showingFrom,cm.display.showingTo)}return updated}function updateDisplayInner(cm,changes,visible){var display=cm.display,doc=cm.doc;if(!display.wrapper.clientWidth){display.showingFrom=display.showingTo=doc.first;display.viewOffset=0;return}if(changes.length==0&&visible.from>display.showingFrom&&visible.to<display.showingTo)return;if(maybeUpdateLineNumberWidth(cm))changes=[{from:doc.first,to:doc.first+doc.size}];var gutterW=display.sizer.style.marginLeft=display.gutters.offsetWidth+\"px\";display.scrollbarH.style.left=cm.options.fixedGutter?gutterW:\"0\";var positionsChangedFrom=Infinity;if(cm.options.lineNumbers)for(var i=0;i<changes.length;++i)if(changes[i].diff){positionsChangedFrom=changes[i].from;break}var end=doc.first+doc.size;var from=Math.max(visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,visible.to+cm.options.viewportMargin);if(display.showingFrom<from&&from-display.showingFrom<20)from=Math.max(doc.first,display.showingFrom);if(display.showingTo>to&&display.showingTo-to<20)to=Math.min(end,display.showingTo);if(sawCollapsedSpans){from=lineNo(visualLine(doc,getLine(doc,from)));while(to<end&&lineIsHidden(doc,getLine(doc,to)))++to}var intact=[{from:Math.max(display.showingFrom,doc.first),to:Math.min(display.showingTo,end)}];if(intact[0].from>=intact[0].to)intact=[];else intact=computeIntact(intact,changes);if(sawCollapsedSpans)for(var i=0;i<intact.length;++i){var range=intact[i],merged;while(merged=collapsedSpanAtEnd(getLine(doc,range.to-1))){var newTo=merged.find().from.line;if(newTo>range.from)range.to=newTo;else{intact.splice(i--,1);break}}}var intactLines=0;for(var i=0;i<intact.length;++i){var range=intact[i];if(range.from<from)range.from=from;if(range.to>to)range.to=to;if(range.from>=range.to)intact.splice(i--,1);else intactLines+=range.to-range.from}if(intactLines==to-from&&from==display.showingFrom&&to==display.showingTo){updateViewOffset(cm);return}intact.sort(function(a,b){return a.from-b.from});try{var focused=document.activeElement}catch(e){}if(intactLines<(to-from)*.7)display.lineDiv.style.display=\"none\";patchDisplay(cm,from,to,intact,positionsChangedFrom);display.lineDiv.style.display=\"\";if(focused&&document.activeElement!=focused&&focused.offsetHeight)focused.focus();var different=from!=display.showingFrom||to!=display.showingTo||display.lastSizeC!=display.wrapper.clientHeight;if(different)display.lastSizeC=display.wrapper.clientHeight;display.showingFrom=from;display.showingTo=to;startWorker(cm,100);var prevBottom=display.lineDiv.offsetTop;for(var node=display.lineDiv.firstChild,height;node;node=node.nextSibling)if(node.lineObj){if(ie_lt8){var bot=node.offsetTop+node.offsetHeight;height=bot-prevBottom;prevBottom=bot}else{var box=getRect(node);height=box.bottom-box.top}var diff=node.lineObj.height-height;if(height<2)height=textHeight(display);if(diff>.001||diff<-.001){updateLineHeight(node.lineObj,height);var widgets=node.lineObj.widgets;if(widgets)for(var i=0;i<widgets.length;++i)widgets[i].height=widgets[i].node.offsetHeight}}updateViewOffset(cm);return true}function updateViewOffset(cm){var off=cm.display.viewOffset=heightAtLine(cm,getLine(cm.doc,cm.display.showingFrom));cm.display.mover.style.top=off+\"px\"}function computeIntact(intact,changes){for(var i=0,l=changes.length||0;i<l;++i){var change=changes[i],intact2=[],diff=change.diff||0;for(var j=0,l2=intact.length;j<l2;++j){var range=intact[j];if(change.to<=range.from&&change.diff){intact2.push({from:range.from+diff,to:range.to+diff})}else if(change.to<=range.from||change.from>=range.to){intact2.push(range)}else{if(change.from>range.from)intact2.push({from:range.from,to:change.from});if(change.to<range.to)intact2.push({from:change.to+diff,to:range.to+diff})}}intact=intact2}return intact}function getDimensions(cm){var d=cm.display,left={},width={};for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){left[cm.options.gutters[i]]=n.offsetLeft;width[cm.options.gutters[i]]=n.offsetWidth}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,from,to,intact,updateNumbersFrom){var dims=getDimensions(cm);var display=cm.display,lineNumbers=cm.options.lineNumbers;if(!intact.length&&(!webkit||!cm.display.currentWheelTarget))removeChildren(display.lineDiv);var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;if(webkit&&mac&&cm.display.currentWheelTarget==node){node.style.display=\"none\";node.lineObj=null}else{node.parentNode.removeChild(node)}return next}var nextIntact=intact.shift(),lineN=from;cm.doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==lineN)nextIntact=intact.shift();if(lineIsHidden(cm.doc,line)){if(line.height!=0)updateLineHeight(line,0);if(line.widgets&&cur.previousSibling)for(var i=0;i<line.widgets.length;++i){var w=line.widgets[i];if(w.showIfHidden){var prev=cur.previousSibling;if(/pre/i.test(prev.nodeName)){var wrap=elt(\"div\",null,null,\"position: relative\");prev.parentNode.replaceChild(wrap,prev);wrap.appendChild(prev);prev=wrap}var wnode=prev.appendChild(elt(\"div\",[w.node],\"CodeMirror-linewidget\"));if(!w.handleMouseEvents)wnode.ignoreEvents=true;positionLineWidget(w,wnode,prev,dims)}}}else if(nextIntact&&nextIntact.from<=lineN&&nextIntact.to>lineN){while(cur.lineObj!=line)cur=rm(cur);if(lineNumbers&&updateNumbersFrom<=lineN&&cur.lineNumber)setTextContent(cur.lineNumber,lineNumberFor(cm.options,lineN));cur=cur.nextSibling}else{if(line.widgets)for(var j=0,search=cur,reuse;search&&j<20;++j,search=search.nextSibling)if(search.lineObj==line&&/div/i.test(search.nodeName)){reuse=search;break}var lineNode=buildLineElement(cm,line,lineN,dims,reuse);if(lineNode!=reuse){container.insertBefore(lineNode,cur)}else{while(cur!=reuse)cur=rm(cur);cur=cur.nextSibling}lineNode.lineObj=line}++lineN});while(cur)cur=rm(cur)}function buildLineElement(cm,line,lineNo,dims,reuse){var lineElement=lineContent(cm,line);var markers=line.gutterMarkers,display=cm.display,wrap;if(!cm.options.lineNumbers&&!markers&&!line.bgClass&&!line.wrapClass&&!line.widgets)return lineElement;if(reuse){reuse.alignable=null;var isOk=true,widgetsSeen=0,insertBefore=null;for(var n=reuse.firstChild,next;n;n=next){next=n.nextSibling;if(!/\\bCodeMirror-linewidget\\b/.test(n.className)){reuse.removeChild(n)}else{for(var i=0,first=true;i<line.widgets.length;++i){var widget=line.widgets[i];if(!widget.above){insertBefore=n;first=false}if(widget.node==n.firstChild){positionLineWidget(widget,n,reuse,dims);++widgetsSeen;break}}if(i==line.widgets.length){isOk=false;break}}}reuse.insertBefore(lineElement,insertBefore);if(isOk&&widgetsSeen==line.widgets.length){wrap=reuse;reuse.className=line.wrapClass||\"\"}}if(!wrap){wrap=elt(\"div\",null,line.wrapClass,\"position: relative\");wrap.appendChild(lineElement)}if(line.bgClass)wrap.insertBefore(elt(\"div\",null,line.bgClass+\" CodeMirror-linebackground\"),wrap.firstChild);if(cm.options.lineNumbers||markers){var gutterWrap=wrap.insertBefore(elt(\"div\",null,null,\"position: absolute; left: \"+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+\"px\"),wrap.firstChild);if(cm.options.fixedGutter)(wrap.alignable||(wrap.alignable=[])).push(gutterWrap);if(cm.options.lineNumbers&&(!markers||!markers[\"CodeMirror-linenumbers\"]))wrap.lineNumber=gutterWrap.appendChild(elt(\"div\",lineNumberFor(cm.options,lineNo),\"CodeMirror-linenumber CodeMirror-gutter-elt\",\"left: \"+dims.gutterLeft[\"CodeMirror-linenumbers\"]+\"px; width: \"+display.lineNumInnerWidth+\"px\"));if(markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];if(found)gutterWrap.appendChild(elt(\"div\",[found],\"CodeMirror-gutter-elt\",\"left: \"+dims.gutterLeft[id]+\"px; width: \"+dims.gutterWidth[id]+\"px\"))}}if(ie_lt8)wrap.style.zIndex=2;if(line.widgets&&wrap!=reuse)for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt(\"div\",[widget.node],\"CodeMirror-linewidget\");if(!widget.handleMouseEvents)node.ignoreEvents=true;positionLineWidget(widget,node,wrap,dims);if(widget.above)wrap.insertBefore(node,cm.options.lineNumbers&&line.height!=0?gutterWrap:lineElement);else wrap.appendChild(node);signalLater(widget,\"redraw\")}return wrap}function positionLineWidget(widget,node,wrap,dims){if(widget.noHScroll){(wrap.alignable||(wrap.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+\"px\";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+\"px\"}node.style.width=width+\"px\"}if(widget.coverGutter){node.style.zIndex=5;node.style.position=\"relative\";if(!widget.noHScroll)node.style.marginLeft=-dims.gutterTotalWidth+\"px\"}}function updateSelection(cm){var display=cm.display;var collapsed=posEq(cm.doc.sel.from,cm.doc.sel.to);if(collapsed||cm.options.showCursorWhenSelecting)updateSelectionCursor(cm);else display.cursor.style.display=display.otherCursor.style.display=\"none\";if(!collapsed)updateSelectionRange(cm);else display.selectionDiv.style.display=\"none\";if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,cm.doc.sel.head,\"div\");var wrapOff=getRect(display.wrapper),lineOff=getRect(display.lineDiv);display.inputDiv.style.top=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top))+\"px\";display.inputDiv.style.left=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))+\"px\"}}function updateSelectionCursor(cm){var display=cm.display,pos=cursorCoords(cm,cm.doc.sel.head,\"div\");display.cursor.style.left=pos.left+\"px\";display.cursor.style.top=pos.top+\"px\";display.cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+\"px\";display.cursor.style.display=\"\";if(pos.other){display.otherCursor.style.display=\"\";display.otherCursor.style.left=pos.other.left+\"px\";display.otherCursor.style.top=pos.other.top+\"px\";display.otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+\"px\"}else{display.otherCursor.style.display=\"none\"}}function updateSelectionRange(cm){var display=cm.display,doc=cm.doc,sel=cm.doc.sel;var fragment=document.createDocumentFragment();var clientWidth=display.lineSpace.offsetWidth,pl=paddingLeft(cm.display);function add(left,top,width,bottom){if(top<0)top=0;fragment.appendChild(elt(\"div\",null,\"CodeMirror-selected\",\"position: absolute; left: \"+left+\"px; top: \"+top+\"px; width: \"+(width==null?clientWidth-left:width)+\"px; height: \"+(bottom-top)+\"px\"))}function drawForLine(line,fromArg,toArg,retTop){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length,rVal=retTop?Infinity:-Infinity;function coords(ch){return charCoords(cm,Pos(line,ch),\"div\",lineObj)}iterateBidiSections(getOrder(lineObj),fromArg||0,toArg==null?lineLen:toArg,function(from,to,dir){var leftPos=coords(from),rightPos,left,right;if(from==to){rightPos=leftPos;left=right=leftPos.left}else{rightPos=coords(to-1);if(dir==\"rtl\"){var tmp=leftPos;leftPos=rightPos;rightPos=tmp}left=leftPos.left;right=rightPos.right}if(rightPos.top-leftPos.top>3){add(left,leftPos.top,null,leftPos.bottom);left=pl;if(leftPos.bottom<rightPos.top)add(left,leftPos.bottom,null,rightPos.top)}if(toArg==null&&to==lineLen)right=clientWidth;if(fromArg==null&&from==0)left=pl;rVal=retTop?Math.min(rightPos.top,rVal):Math.max(rightPos.bottom,rVal);if(left<pl+1)left=pl;add(left,rightPos.top,right-left,rightPos.bottom)});return rVal}if(sel.from.line==sel.to.line){drawForLine(sel.from.line,sel.from.ch,sel.to.ch)}else{var fromObj=getLine(doc,sel.from.line);var cur=fromObj,merged,path=[sel.from.line,sel.from.ch],singleLine;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();path.push(found.from.ch,found.to.line,found.to.ch);if(found.to.line==sel.to.line){path.push(sel.to.ch);singleLine=true;break}cur=getLine(doc,found.to.line)}if(singleLine){for(var i=0;i<path.length;i+=3)drawForLine(path[i],path[i+1],path[i+2])}else{var middleTop,middleBot,toObj=getLine(doc,sel.to.line);if(sel.from.ch)middleTop=drawForLine(sel.from.line,sel.from.ch,null,false);else middleTop=heightAtLine(cm,fromObj)-display.viewOffset;if(!sel.to.ch)middleBot=heightAtLine(cm,toObj)-display.viewOffset;else middleBot=drawForLine(sel.to.line,collapsedSpanAtStart(toObj)?null:0,sel.to.ch,true);if(middleTop<middleBot)add(pl,middleTop,null,middleBot)}}removeChildrenAndAdd(display.selectionDiv,fragment);display.selectionDiv.style.display=\"\"}function restartBlink(cm){if(!cm.state.focused)return;var display=cm.display;clearInterval(display.blinker);var on=true;display.cursor.style.visibility=display.otherCursor.style.visibility=\"\";display.blinker=setInterval(function(){display.cursor.style.visibility=display.otherCursor.style.visibility=(on=!on)?\"\":\"hidden\"},cm.options.cursorBlinkRate)}function startWorker(cm,time){if(cm.doc.mode.startState&&cm.doc.frontier<cm.display.showingTo)cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first)doc.frontier=doc.first;if(doc.frontier>=cm.display.showingTo)return;var end=+new Date+cm.options.workTime;var state=copyState(doc.mode,getStateBefore(cm,doc.frontier));var changed=[],prevChange;doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.showingTo+500),function(line){if(doc.frontier>=cm.display.showingFrom){var oldStyles=line.styles;line.styles=highlightLine(cm,line,state);var ischange=!oldStyles||oldStyles.length!=line.styles.length;for(var i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];if(ischange){if(prevChange&&prevChange.end==doc.frontier)prevChange.end++;else changed.push(prevChange={start:doc.frontier,end:doc.frontier+1})}line.stateAfter=copyState(doc.mode,state)}else{processLine(cm,line,state);line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null}++doc.frontier;if(+new Date>end){startWorker(cm,cm.options.workDelay);return true}});if(changed.length)operation(cm,function(){for(var i=0;i<changed.length;++i)regChange(this,changed[i].start,changed[i].end)})()}function findStartLine(cm,n){var minindent,minline,doc=cm.doc;for(var search=n,lim=n-100;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter)return search;var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented}}return minline}function getStateBefore(cm,n){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return true;var pos=findStartLine(cm,n),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;if(!state)state=startState(doc.mode);else state=copyState(doc.mode,state);doc.iter(pos,n,function(line){processLine(cm,line,state);var save=pos==n-1||pos%5==0||pos>=display.showingFrom&&pos<display.showingTo;line.stateAfter=save?copyState(doc.mode,state):null;++pos});return state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingLeft(display){var e=removeChildrenAndAdd(display.measure,elt(\"pre\",null,null,\"text-align: left\")).appendChild(elt(\"span\",\"x\"));return e.offsetLeft}function measureChar(cm,line,ch,data){var dir=-1;data=data||measureLine(cm,line);for(var pos=ch;;pos+=dir){var r=data[pos];if(r)break;if(dir<0&&pos==0)dir=1}return{left:pos<ch?r.right:r.left,right:pos>ch?r.left:r.right,top:r.top,bottom:r.bottom}}function findCachedMeasurement(cm,line){var cache=cm.display.measureLineCache;for(var i=0;i<cache.length;++i){var memo=cache[i];if(memo.text==line.text&&memo.markedSpans==line.markedSpans&&cm.display.scroller.clientWidth==memo.width&&memo.classes==line.textClass+\"|\"+line.bgClass+\"|\"+line.wrapClass)return memo}}function clearCachedMeasurement(cm,line){var exists=findCachedMeasurement(cm,line);if(exists)exists.text=exists.measure=exists.markedSpans=null}function measureLine(cm,line){var cached=findCachedMeasurement(cm,line);if(cached)return cached.measure;var measure=measureLineInner(cm,line);var cache=cm.display.measureLineCache;var memo={text:line.text,width:cm.display.scroller.clientWidth,markedSpans:line.markedSpans,measure:measure,classes:line.textClass+\"|\"+line.bgClass+\"|\"+line.wrapClass};if(cache.length==16)cache[++cm.display.measureLineCachePos%16]=memo;else cache.push(memo);return measure}function measureLineInner(cm,line){var display=cm.display,measure=emptyArray(line.text.length);var pre=lineContent(cm,line,measure);if(ie&&!ie_lt8&&!cm.options.lineWrapping&&pre.childNodes.length>100){var fragment=document.createDocumentFragment();var chunk=10,n=pre.childNodes.length;for(var i=0,chunks=Math.ceil(n/chunk);i<chunks;++i){var wrap=elt(\"div\",null,null,\"display: inline-block\");for(var j=0;j<chunk&&n;++j){wrap.appendChild(pre.firstChild);--n}fragment.appendChild(wrap)}pre.appendChild(fragment)}removeChildrenAndAdd(display.measure,pre);var outer=getRect(display.lineDiv);var vranges=[],data=emptyArray(line.text.length),maxBot=pre.offsetHeight;if(ie_lt9&&display.measure.first!=pre)removeChildrenAndAdd(display.measure,pre);for(var i=0,cur;i<measure.length;++i)if(cur=measure[i]){var size=getRect(cur);var top=Math.max(0,size.top-outer.top),bot=Math.min(size.bottom-outer.top,maxBot);for(var j=0;j<vranges.length;j+=2){var rtop=vranges[j],rbot=vranges[j+1];if(rtop>bot||rbot<top)continue;if(rtop<=top&&rbot>=bot||top<=rtop&&bot>=rbot||Math.min(bot,rbot)-Math.max(top,rtop)>=bot-top>>1){vranges[j]=Math.min(top,rtop);vranges[j+1]=Math.max(bot,rbot);break}}if(j==vranges.length)vranges.push(top,bot);var right=size.right;if(cur.measureRight)right=getRect(cur.measureRight).left;data[i]={left:size.left-outer.left,right:right-outer.left,top:j}}for(var i=0,cur;i<data.length;++i)if(cur=data[i]){var vr=cur.top;cur.top=vranges[vr];cur.bottom=vranges[vr+1]}return data}function measureLineWidth(cm,line){var hasBadSpan=false;if(line.markedSpans)for(var i=0;i<line.markedSpans;++i){var sp=line.markedSpans[i];if(sp.collapsed&&(sp.to==null||sp.to==line.text.length))hasBadSpan=true}var cached=!hasBadSpan&&findCachedMeasurement(cm,line);if(cached)return measureChar(cm,line,line.text.length,cached.measure).right;var pre=lineContent(cm,line);var end=pre.appendChild(zeroWidthElement(cm.display.measure));removeChildrenAndAdd(cm.display.measure,pre);return getRect(end).right-getRect(cm.display.lineDiv).left}function clearCaches(cm){cm.display.measureLineCache.length=cm.display.measureLineCachePos=0;cm.display.cachedCharWidth=cm.display.cachedTextHeight=null;if(!cm.options.lineWrapping)cm.display.maxLineChanged=true;cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size;rect.bottom+=size}if(context==\"line\")return rect;if(!context)context=\"local\";var yOff=heightAtLine(cm,lineObj);if(context==\"local\")yOff+=paddingTop(cm.display);else yOff-=cm.display.viewOffset;if(context==\"page\"||context==\"window\"){var lOff=getRect(cm.display.lineSpace);yOff+=lOff.top+(context==\"window\"?0:pageScrollY());var xOff=lOff.left+(context==\"window\"?0:pageScrollX());rect.left+=xOff;rect.right+=xOff}rect.top+=yOff;rect.bottom+=yOff;return rect}function fromCoordSystem(cm,coords,context){if(context==\"div\")return coords;var left=coords.left,top=coords.top;if(context==\"page\"){left-=pageScrollX();top-=pageScrollY()}else if(context==\"local\"||!context){var localBox=getRect(cm.display.sizer);left+=localBox.left;top+=localBox.top}var lineSpaceBox=getRect(cm.display.lineSpace);return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj){if(!lineObj)lineObj=getLine(cm.doc,pos.line);return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch),context)}function cursorCoords(cm,pos,context,lineObj,measurement){lineObj=lineObj||getLine(cm.doc,pos.line);if(!measurement)measurement=measureLine(cm,lineObj);function get(ch,right){var m=measureChar(cm,lineObj,ch,measurement);if(right)m.left=m.right;else m.right=m.left;return intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;if(ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level){part=order[--partPos];ch=bidiRight(part)-(part.level%2?0:1);right=true}else if(ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level){part=order[++partPos];ch=bidiLeft(part)-part.level%2;right=false}if(right&&ch==part.to&&ch>part.from)return get(ch-1);return get(ch,right)}var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch);var val=getBidi(ch,partPos);if(bidiOther!=null)val.other=getBidi(ch,bidiOther);return val}function PosMaybeOutside(line,ch,outside){var pos=new Pos(line,ch);if(outside)pos.outside=true;return pos}function coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0)return PosMaybeOutside(doc.first,0,true);var lineNo=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineNo>last)return PosMaybeOutside(doc.first+doc.size-1,getLine(doc,last).text.length,true);if(x<0)x=0;for(;;){var lineObj=getLine(doc,lineNo);var found=coordsCharInner(cm,lineObj,lineNo,x,y);var merged=collapsedSpanAtEnd(lineObj);var mergedPos=merged&&merged.find();if(merged&&found.ch>=mergedPos.from.ch)lineNo=mergedPos.to.line;else return found}}function coordsCharInner(cm,lineObj,lineNo,x,y){var innerOff=y-heightAtLine(cm,lineObj);var wrongLine=false,adjust=2*cm.display.wrapper.clientWidth;var measurement=measureLine(cm,lineObj);function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),\"line\",lineObj,measurement);wrongLine=true;if(innerOff>sp.bottom)return sp.left-adjust;else if(innerOff<sp.top)return sp.left+adjust;else wrongLine=false;return sp.left}var bidi=getOrder(lineObj),dist=lineObj.text.length;var from=lineLeft(lineObj),to=lineRight(lineObj);var fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosMaybeOutside(lineNo,to,toOutside);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):to-from<=1){var after=x-fromX<toX-x,ch=after?from:to;while(isExtendingChar.test(lineObj.text.charAt(ch)))++ch;var pos=PosMaybeOutside(lineNo,ch,after?fromOutside:toOutside);pos.after=after;return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;if(toOutside=wrongLine)toX+=1e3;dist=step}else{from=middle;fromX=middleX;fromOutside=wrongLine;dist-=step}}}var measureText;function textHeight(display){if(display.cachedTextHeight!=null)return display.cachedTextHeight;if(measureText==null){measureText=elt(\"pre\");for(var i=0;i<49;++i){measureText.appendChild(document.createTextNode(\"x\"));measureText.appendChild(elt(\"br\"))}measureText.appendChild(document.createTextNode(\"x\"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3)display.cachedTextHeight=height;removeChildren(display.measure);return height||1}function charWidth(display){if(display.cachedCharWidth!=null)return display.cachedCharWidth;var anchor=elt(\"span\",\"x\");var pre=elt(\"pre\",[anchor]);removeChildrenAndAdd(display.measure,pre);var width=anchor.offsetWidth;if(width>2)display.cachedCharWidth=width;return width||10}var nextOpId=0;function startOperation(cm){cm.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:false,cursorActivity:false,updateMaxLine:false,updateScrollPos:false,id:++nextOpId};if(!delayedCallbackDepth++)delayedCallbacks=[]}function endOperation(cm){var op=cm.curOp,doc=cm.doc,display=cm.display;cm.curOp=null;if(op.updateMaxLine)computeMaxLength(cm);if(display.maxLineChanged&&!cm.options.lineWrapping&&display.maxLine){var width=measureLineWidth(cm,display.maxLine);display.sizer.style.minWidth=Math.max(0,width+3+scrollerCutOff)+\"px\";display.maxLineChanged=false;var maxScrollLeft=Math.max(0,display.sizer.offsetLeft+display.sizer.offsetWidth-display.scroller.clientWidth);if(maxScrollLeft<doc.scrollLeft&&!op.updateScrollPos)setScrollLeft(cm,Math.min(display.scroller.scrollLeft,maxScrollLeft),true)}var newScrollPos,updated;if(op.updateScrollPos){newScrollPos=op.updateScrollPos}else if(op.selectionChanged&&display.scroller.clientHeight){var coords=cursorCoords(cm,doc.sel.head);newScrollPos=calculateScrollPos(cm,coords.left,coords.top,coords.left,coords.bottom)}if(op.changes.length||newScrollPos&&newScrollPos.scrollTop!=null){updated=updateDisplay(cm,op.changes,newScrollPos&&newScrollPos.scrollTop);if(cm.display.scroller.offsetHeight)cm.doc.scrollTop=cm.display.scroller.scrollTop}if(!updated&&op.selectionChanged)updateSelection(cm);if(op.updateScrollPos){display.scroller.scrollTop=display.scrollbarV.scrollTop=doc.scrollTop=newScrollPos.scrollTop;display.scroller.scrollLeft=display.scrollbarH.scrollLeft=doc.scrollLeft=newScrollPos.scrollLeft;alignHorizontally(cm);if(op.scrollToPos)scrollPosIntoView(cm,clipPos(cm.doc,op.scrollToPos),op.scrollToPosMargin)}else if(newScrollPos){scrollCursorIntoView(cm)}if(op.selectionChanged)restartBlink(cm);if(cm.state.focused&&op.updateInput)resetInput(cm,op.userSelChange);var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)if(!hidden[i].lines.length)signal(hidden[i],\"hide\");if(unhidden)for(var i=0;i<unhidden.length;++i)if(unhidden[i].lines.length)signal(unhidden[i],\"unhide\");var delayed;if(!--delayedCallbackDepth){delayed=delayedCallbacks;delayedCallbacks=null}if(op.textChanged)signal(cm,\"change\",cm,op.textChanged);if(op.cursorActivity)signal(cm,\"cursorActivity\",cm);if(delayed)for(var i=0;i<delayed.length;++i)delayed[i]()}function operation(cm1,f){return function(){var cm=cm1||this,withOp=!cm.curOp;if(withOp)startOperation(cm);try{var result=f.apply(cm,arguments)}finally{if(withOp)endOperation(cm)}return result}}function docOperation(f){return function(){var withOp=this.cm&&!this.cm.curOp,result;if(withOp)startOperation(this.cm);try{result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}function runInOp(cm,f){var withOp=!cm.curOp,result;if(withOp)startOperation(cm);try{result=f()}finally{if(withOp)endOperation(cm)}return result}function regChange(cm,from,to,lendiff){if(from==null)from=cm.doc.first;if(to==null)to=cm.doc.first+cm.doc.size;cm.curOp.changes.push({from:from,to:to,diff:lendiff})}function slowPoll(cm){if(cm.display.pollingFast)return;cm.display.poll.set(cm.options.pollInterval,function(){readInput(cm);if(cm.state.focused)slowPoll(cm)})}function fastPoll(cm){var missed=false;cm.display.pollingFast=true;function p(){var changed=readInput(cm);if(!changed&&!missed){missed=true;cm.display.poll.set(60,p)}else{cm.display.pollingFast=false;slowPoll(cm)}}cm.display.poll.set(20,p)}function readInput(cm){var input=cm.display.input,prevInput=cm.display.prevInput,doc=cm.doc,sel=doc.sel;if(!cm.state.focused||hasSelection(input)||isReadOnly(cm))return false;var text=input.value;if(text==prevInput&&posEq(sel.from,sel.to))return false;if(ie&&!ie_lt9&&cm.display.inputHasSelection===text){resetInput(cm,true);return false}var withOp=!cm.curOp;if(withOp)startOperation(cm);sel.shift=false;var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same))++same;var from=sel.from,to=sel.to;if(same<prevInput.length)from=Pos(from.line,from.ch-(prevInput.length-same));else if(cm.state.overwrite&&posEq(from,to)&&!cm.state.pasteIncoming)to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+(text.length-same)));var updateInput=cm.curOp.updateInput;makeChange(cm.doc,{from:from,to:to,text:splitLines(text.slice(same)),origin:cm.state.pasteIncoming?\"paste\":\"+input\"},\"end\");cm.curOp.updateInput=updateInput;if(text.length>1e3||text.indexOf(\"\\n\")>-1)input.value=cm.display.prevInput=\"\";else cm.display.prevInput=text;\nif(withOp)endOperation(cm);cm.state.pasteIncoming=false;return true}function resetInput(cm,user){var minimal,selected,doc=cm.doc;if(!posEq(doc.sel.from,doc.sel.to)){cm.display.prevInput=\"\";minimal=hasCopyEvent&&(doc.sel.to.line-doc.sel.from.line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?\"-\":selected||cm.getSelection();cm.display.input.value=content;if(cm.state.focused)selectInput(cm.display.input);if(ie&&!ie_lt9)cm.display.inputHasSelection=content}else if(user){cm.display.prevInput=cm.display.input.value=\"\";if(ie&&!ie_lt9)cm.display.inputHasSelection=null}cm.display.inaccurateSelection=minimal}function focusInput(cm){if(cm.options.readOnly!=\"nocursor\"&&(!mobile||document.activeElement!=cm.display.input))cm.display.input.focus()}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function registerEventHandlers(cm){var d=cm.display;on(d.scroller,\"mousedown\",operation(cm,onMouseDown));if(ie)on(d.scroller,\"dblclick\",operation(cm,function(e){var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);var word=findWordAt(getLine(cm.doc,pos.line).text,pos);extendSelection(cm.doc,word.from,word.to)}));else on(d.scroller,\"dblclick\",e_preventDefault);on(d.lineSpace,\"selectstart\",function(e){if(!eventInWidget(d,e))e_preventDefault(e)});if(!captureMiddleClick)on(d.scroller,\"contextmenu\",function(e){onContextMenu(cm,e)});on(d.scroller,\"scroll\",function(){if(d.scroller.clientHeight){setScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,\"scroll\",cm)}});on(d.scrollbarV,\"scroll\",function(){if(d.scroller.clientHeight)setScrollTop(cm,d.scrollbarV.scrollTop)});on(d.scrollbarH,\"scroll\",function(){if(d.scroller.clientHeight)setScrollLeft(cm,d.scrollbarH.scrollLeft)});on(d.scroller,\"mousewheel\",function(e){onScrollWheel(cm,e)});on(d.scroller,\"DOMMouseScroll\",function(e){onScrollWheel(cm,e)});function reFocus(){if(cm.state.focused)setTimeout(bind(focusInput,cm),0)}on(d.scrollbarH,\"mousedown\",reFocus);on(d.scrollbarV,\"mousedown\",reFocus);on(d.wrapper,\"scroll\",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0});var resizeTimer;function onResize(){if(resizeTimer==null)resizeTimer=setTimeout(function(){resizeTimer=null;d.cachedCharWidth=d.cachedTextHeight=knownScrollbarWidth=null;clearCaches(cm);runInOp(cm,bind(regChange,cm))},100)}on(window,\"resize\",onResize);function unregister(){for(var p=d.wrapper.parentNode;p&&p!=document.body;p=p.parentNode){}if(p)setTimeout(unregister,5e3);else off(window,\"resize\",onResize)}setTimeout(unregister,5e3);on(d.input,\"keyup\",operation(cm,function(e){if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;if(e.keyCode==16)cm.doc.sel.shift=false}));on(d.input,\"input\",bind(fastPoll,cm));on(d.input,\"keydown\",operation(cm,onKeyDown));on(d.input,\"keypress\",operation(cm,onKeyPress));on(d.input,\"focus\",bind(onFocus,cm));on(d.input,\"blur\",bind(onBlur,cm));function drag_(e){if(cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_stop(e)}if(cm.options.dragDrop){on(d.scroller,\"dragstart\",function(e){onDragStart(cm,e)});on(d.scroller,\"dragenter\",drag_);on(d.scroller,\"dragover\",drag_);on(d.scroller,\"drop\",operation(cm,onDrop))}on(d.scroller,\"paste\",function(e){if(eventInWidget(d,e))return;focusInput(cm);fastPoll(cm)});on(d.input,\"paste\",function(){cm.state.pasteIncoming=true;fastPoll(cm)});function prepareCopy(){if(d.inaccurateSelection){d.prevInput=\"\";d.inaccurateSelection=false;d.input.value=cm.getSelection();selectInput(d.input)}}on(d.input,\"cut\",prepareCopy);on(d.input,\"copy\",prepareCopy);if(khtml)on(d.sizer,\"mouseup\",function(){if(document.activeElement==d.input)d.input.blur();focusInput(cm)})}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n||n.ignoreEvents||n.parentNode==display.sizer&&n!=display.mover)return true}}function posFromMouse(cm,e,liberal){var display=cm.display;if(!liberal){var target=e_target(e);if(target==display.scrollbarH||target==display.scrollbarH.firstChild||target==display.scrollbarV||target==display.scrollbarV.firstChild||target==display.scrollbarFiller||target==display.gutterFiller)return null}var x,y,space=getRect(display.lineSpace);try{x=e.clientX;y=e.clientY}catch(e){return null}return coordsChar(cm,x-space.left,y-space.top)}var lastClick,lastDoubleClick;function onMouseDown(e){var cm=this,display=cm.display,doc=cm.doc,sel=doc.sel;sel.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){display.scroller.draggable=false;setTimeout(function(){display.scroller.draggable=true},100)}return}if(clickInGutter(cm,e))return;var start=posFromMouse(cm,e);switch(e_button(e)){case 3:if(captureMiddleClick)onContextMenu.call(cm,cm,e);return;case 2:if(start)extendSelection(cm.doc,start);setTimeout(bind(focusInput,cm),20);e_preventDefault(e);return}if(!start){if(e_target(e)==display.scroller)e_preventDefault(e);return}if(!cm.state.focused)onFocus(cm);var now=+new Date,type=\"single\";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start)){type=\"triple\";e_preventDefault(e);setTimeout(bind(focusInput,cm),20);selectLine(cm,start.line)}else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type=\"double\";lastDoubleClick={time:now,pos:start};e_preventDefault(e);var word=findWordAt(getLine(doc,start.line).text,start);extendSelection(cm.doc,word.from,word.to)}else{lastClick={time:now,pos:start}}var last=start;if(cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&type==\"single\"){var dragEnd=operation(cm,function(e2){if(webkit)display.scroller.draggable=false;cm.state.draggingText=false;off(document,\"mouseup\",dragEnd);off(display.scroller,\"drop\",dragEnd);if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);extendSelection(cm.doc,start);focusInput(cm)}});if(webkit)display.scroller.draggable=true;cm.state.draggingText=dragEnd;if(display.scroller.dragDrop)display.scroller.dragDrop();on(document,\"mouseup\",dragEnd);on(display.scroller,\"drop\",dragEnd);return}e_preventDefault(e);if(type==\"single\")extendSelection(cm.doc,clipPos(doc,start));var startstart=sel.from,startend=sel.to,lastPos=start;function doSelect(cur){if(posEq(lastPos,cur))return;lastPos=cur;if(type==\"single\"){extendSelection(cm.doc,clipPos(doc,start),cur);return}startstart=clipPos(doc,startstart);startend=clipPos(doc,startend);if(type==\"double\"){var word=findWordAt(getLine(doc,cur.line).text,cur);if(posLess(cur,startstart))extendSelection(cm.doc,word.from,startend);else extendSelection(cm.doc,startstart,word.to)}else if(type==\"triple\"){if(posLess(cur,startstart))extendSelection(cm.doc,startend,clipPos(doc,Pos(cur.line,0)));else extendSelection(cm.doc,startstart,clipPos(doc,Pos(cur.line+1,0)))}}var editorSize=getRect(display.wrapper);var counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true);if(!cur)return;if(!posEq(cur,last)){if(!cm.state.focused)onFocus(cm);last=cur;doSelect(cur);var visible=visibleLines(display,doc);if(cur.line>=visible.to||cur.line<visible.from)setTimeout(operation(cm,function(){if(counter==curCount)extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside)setTimeout(operation(cm,function(){if(counter!=curCount)return;display.scroller.scrollTop+=outside;extend(e)}),50)}}function done(e){counter=Infinity;e_preventDefault(e);focusInput(cm);off(document,\"mousemove\",move);off(document,\"mouseup\",up)}var move=operation(cm,function(e){if(!ie&&!e_button(e))done(e);else extend(e)});var up=operation(cm,done);on(document,\"mousemove\",move);on(document,\"mouseup\",up)}function clickInGutter(cm,e){var display=cm.display;try{var mX=e.clientX,mY=e.clientY}catch(e){return false}if(mX>=Math.floor(getRect(display.gutters).right))return false;e_preventDefault(e);if(!hasHandler(cm,\"gutterClick\"))return true;var lineBox=getRect(display.lineDiv);if(mY>lineBox.bottom)return true;mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&getRect(g).right>=mX){var line=lineAtHeight(cm.doc,mY);var gutter=cm.options.gutters[i];signalLater(cm,\"gutterClick\",cm,line,gutter,e);break}}return true}var lastDrop=0;function onDrop(e){var cm=this;if(eventInWidget(cm.display,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_preventDefault(e);if(ie)lastDrop=+new Date;var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||isReadOnly(cm))return;if(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var loadFile=function(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result;if(++read==n){pos=clipPos(cm.doc,pos);makeChange(cm.doc,{from:pos,to:pos,text:splitLines(text.join(\"\\n\")),origin:\"paste\"},\"around\")}};reader.readAsText(file)};for(var i=0;i<n;++i)loadFile(files[i],i)}else{if(cm.state.draggingText&&!(posLess(pos,cm.doc.sel.from)||posLess(cm.doc.sel.to,pos))){cm.state.draggingText(e);setTimeout(bind(focusInput,cm),20);return}try{var text=e.dataTransfer.getData(\"Text\");if(text){var curFrom=cm.doc.sel.from,curTo=cm.doc.sel.to;setSelection(cm.doc,pos,pos);if(cm.state.draggingText)replaceRange(cm.doc,\"\",curFrom,curTo,\"paste\");cm.replaceSelection(text,null,\"paste\");focusInput(cm);onFocus(cm)}}catch(e){}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100)){e_stop(e);return}if(eventInWidget(cm.display,e))return;var txt=cm.getSelection();e.dataTransfer.setData(\"Text\",txt);if(e.dataTransfer.setDragImage&&!safari){var img=elt(\"img\",null,null,\"position: fixed; left: 0; top: 0;\");if(opera){img.width=img.height=1;cm.display.wrapper.appendChild(img);img._top=img.offsetTop}e.dataTransfer.setDragImage(img,0,0);if(opera)img.parentNode.removeChild(img)}}function setScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2)return;cm.doc.scrollTop=val;if(!gecko)updateDisplay(cm,[],val);if(cm.display.scroller.scrollTop!=val)cm.display.scroller.scrollTop=val;if(cm.display.scrollbarV.scrollTop!=val)cm.display.scrollbarV.scrollTop=val;if(gecko)updateDisplay(cm,[])}function setScrollLeft(cm,val,isScroller){if(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)return;val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth);cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val)cm.display.scroller.scrollLeft=val;if(cm.display.scrollbarH.scrollLeft!=val)cm.display.scrollbarH.scrollLeft=val}var wheelSamples=0,wheelPixelsPerUnit=null;if(ie)wheelPixelsPerUnit=-.53;else if(gecko)wheelPixelsPerUnit=15;else if(chrome)wheelPixelsPerUnit=-.7;else if(safari)wheelPixelsPerUnit=-1/3;function onScrollWheel(cm,e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS)dx=e.detail;if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS)dy=e.detail;else if(dy==null)dy=e.wheelDelta;var display=cm.display,scroll=display.scroller;if(!(dx&&scroll.scrollWidth>scroll.clientWidth||dy&&scroll.scrollHeight>scroll.clientHeight))return;if(dy&&mac&&webkit){for(var cur=e.target;cur!=scroll;cur=cur.parentNode){if(cur.lineObj){cm.display.currentWheelTarget=cur;break}}}if(dx&&!gecko&&!opera&&wheelPixelsPerUnit!=null){if(dy)setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight)));setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth)));e_preventDefault(e);display.wheelStartX=null;return}if(dy&&wheelPixelsPerUnit!=null){var pixels=dy*wheelPixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0)top=Math.max(0,top+pixels-50);else bot=Math.min(cm.doc.height,bot+pixels+50);updateDisplay(cm,[],{top:top,bottom:bot})}if(wheelSamples<20){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout(function(){if(display.wheelStartX==null)return;var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample)return;wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples},200)}else{display.wheelDX+=dx;display.wheelDY+=dy}}}function doHandleBinding(cm,bound,dropShift){if(typeof bound==\"string\"){bound=commands[bound];if(!bound)return false}if(cm.display.pollingFast&&readInput(cm))cm.display.pollingFast=false;var doc=cm.doc,prevShift=doc.sel.shift,done=false;try{if(isReadOnly(cm))cm.state.suppressEdits=true;if(dropShift)doc.sel.shift=false;done=bound(cm)!=Pass}finally{doc.sel.shift=prevShift;cm.state.suppressEdits=false}return done}function allKeyMaps(cm){var maps=cm.state.keyMaps.slice(0);if(cm.options.extraKeys)maps.push(cm.options.extraKeys);maps.push(cm.options.keyMap);return maps}var maybeTransition;function handleKeyBinding(cm,e){var startMap=getKeyMap(cm.options.keyMap),next=startMap.auto;clearTimeout(maybeTransition);if(next&&!isModifierKey(e))maybeTransition=setTimeout(function(){if(getKeyMap(cm.options.keyMap)==startMap)cm.options.keyMap=next.call?next.call(null,cm):next},50);var name=keyName(e,true),handled=false;if(!name)return false;var keymaps=allKeyMaps(cm);if(e.shiftKey){handled=lookupKey(\"Shift-\"+name,keymaps,function(b){return doHandleBinding(cm,b,true)})||lookupKey(name,keymaps,function(b){if(typeof b==\"string\"&&/^go[A-Z]/.test(b))return doHandleBinding(cm,b)})}else{handled=lookupKey(name,keymaps,function(b){return doHandleBinding(cm,b)})}if(handled){e_preventDefault(e);restartBlink(cm);if(ie_lt9){e.oldKeyCode=e.keyCode;e.keyCode=0}}return handled}function handleCharBinding(cm,e,ch){var handled=lookupKey(\"'\"+ch+\"'\",allKeyMaps(cm),function(b){return doHandleBinding(cm,b,true)});if(handled){e_preventDefault(e);restartBlink(cm)}return handled}var lastStoppedKey=null;function onKeyDown(e){var cm=this;if(!cm.state.focused)onFocus(cm);if(ie&&e.keyCode==27){e.returnValue=false}if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var code=e.keyCode;cm.doc.sel.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(opera){lastStoppedKey=handled?code:null;if(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey))cm.replaceSelection(\"\")}}function onKeyPress(e){var cm=this;if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var keyCode=e.keyCode,charCode=e.charCode;if(opera&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return}if((opera&&(!e.which||e.which<10)||khtml)&&handleKeyBinding(cm,e))return;var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!isReadOnly(this)&&this.doc.mode.electricChars.indexOf(ch)>-1)setTimeout(operation(cm,function(){indentLine(cm,cm.doc.sel.to.line,\"smart\")}),75);if(handleCharBinding(cm,e,ch))return;if(ie&&!ie_lt9)cm.display.inputHasSelection=null;fastPoll(cm)}function onFocus(cm){if(cm.options.readOnly==\"nocursor\")return;if(!cm.state.focused){signal(cm,\"focus\",cm);cm.state.focused=true;if(cm.display.wrapper.className.search(/\\bCodeMirror-focused\\b/)==-1)cm.display.wrapper.className+=\" CodeMirror-focused\";resetInput(cm,true)}slowPoll(cm);restartBlink(cm)}function onBlur(cm){if(cm.state.focused){signal(cm,\"blur\",cm);cm.state.focused=false;cm.display.wrapper.className=cm.display.wrapper.className.replace(\" CodeMirror-focused\",\"\")}clearInterval(cm.display.blinker);setTimeout(function(){if(!cm.state.focused)cm.doc.sel.shift=false},150)}var detectingSelectAll;function onContextMenu(cm,e){var display=cm.display,sel=cm.doc.sel;if(eventInWidget(display,e))return;var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||opera)return;if(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))operation(cm,setSelection)(cm.doc,pos,pos);var oldCSS=display.input.style.cssText;display.inputDiv.style.position=\"absolute\";display.input.style.cssText=\"position: fixed; width: 30px; height: 30px; top: \"+(e.clientY-5)+\"px; left: \"+(e.clientX-5)+\"px; z-index: 1000; background: white; outline: none;\"+\"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);\";focusInput(cm);resetInput(cm,true);if(posEq(sel.from,sel.to))display.input.value=display.prevInput=\" \";function prepareSelectAllHack(){if(display.input.selectionStart!=null){var extval=display.input.value=\" \"+(posEq(sel.from,sel.to)?\"\":display.input.value);display.prevInput=\" \";display.input.selectionStart=1;display.input.selectionEnd=extval.length}}function rehide(){display.inputDiv.style.position=\"relative\";display.input.style.cssText=oldCSS;if(ie_lt9)display.scrollbarV.scrollTop=display.scroller.scrollTop=scrollPos;slowPoll(cm);if(display.input.selectionStart!=null){if(!ie||ie_lt9)prepareSelectAllHack();clearTimeout(detectingSelectAll);var i=0,poll=function(){if(display.prevInput==\" \"&&display.input.selectionStart==0)operation(cm,commands.selectAll)(cm);else if(i++<10)detectingSelectAll=setTimeout(poll,500);else resetInput(cm)};detectingSelectAll=setTimeout(poll,200)}}if(ie&&!ie_lt9)prepareSelectAllHack();if(captureMiddleClick){e_stop(e);var mouseup=function(){off(window,\"mouseup\",mouseup);setTimeout(rehide,20)};on(window,\"mouseup\",mouseup)}else{setTimeout(rehide,50)}}function changeEnd(change){if(!change.text)return change.to;return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0))}function clipPostChange(doc,change,pos){if(!posLess(change.from,pos))return clipPos(doc,pos);var diff=change.text.length-1-(change.to.line-change.from.line);if(pos.line>change.to.line+diff){var preLine=pos.line-diff,lastLine=doc.first+doc.size-1;if(preLine>lastLine)return Pos(lastLine,getLine(doc,lastLine).text.length);return clipToLen(pos,getLine(doc,preLine).text.length)}if(pos.line==change.to.line+diff)return clipToLen(pos,lst(change.text).length+(change.text.length==1?change.from.ch:0)+getLine(doc,change.to.line).text.length-change.to.ch);var inside=pos.line-change.from.line;return clipToLen(pos,change.text[inside].length+(inside?0:change.from.ch))}function computeSelAfterChange(doc,change,hint){if(hint&&typeof hint==\"object\")return{anchor:clipPostChange(doc,change,hint.anchor),head:clipPostChange(doc,change,hint.head)};if(hint==\"start\")return{anchor:change.from,head:change.from};var end=changeEnd(change);if(hint==\"around\")return{anchor:change.from,head:end};if(hint==\"end\")return{anchor:end,head:end};var adjustPos=function(pos){if(posLess(pos,change.from))return pos;if(!posLess(change.to,pos))return end;var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line)ch+=end.ch-change.to.ch;return Pos(line,ch)};return{anchor:adjustPos(doc.sel.anchor),head:adjustPos(doc.sel.head)}}function filterChange(doc,change,update){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=true}};if(update)obj.update=function(from,to,text,origin){if(from)this.from=clipPos(doc,from);if(to)this.to=clipPos(doc,to);if(text)this.text=text;if(origin!==undefined)this.origin=origin};signal(doc,\"beforeChange\",doc,obj);if(doc.cm)signal(doc.cm,\"beforeChange\",doc.cm,obj);if(obj.canceled)return null;return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,selUpdate,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,selUpdate,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(hasHandler(doc,\"beforeChange\")||doc.cm&&hasHandler(doc.cm,\"beforeChange\")){change=filterChange(doc,change,true);if(!change)return}var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=1;--i)makeChangeNoReadonly(doc,{from:split[i].from,to:split[i].to,text:[\"\"]});if(split.length)makeChangeNoReadonly(doc,{from:split[0].from,to:split[0].to,text:change.text},selUpdate)}else{makeChangeNoReadonly(doc,change,selUpdate)}}function makeChangeNoReadonly(doc,change,selUpdate){var selAfter=computeSelAfterChange(doc,change,selUpdate);addToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}function makeChangeFromHistory(doc,type){if(doc.cm&&doc.cm.state.suppressEdits)return;var hist=doc.history;var event=(type==\"undo\"?hist.done:hist.undone).pop();if(!event)return;hist.dirtyCounter+=type==\"undo\"?-1:1;var anti={changes:[],anchorBefore:event.anchorAfter,headBefore:event.headAfter,anchorAfter:event.anchorBefore,headAfter:event.headBefore};(type==\"undo\"?hist.undone:hist.done).push(anti);var filter=hasHandler(doc,\"beforeChange\")||doc.cm&&hasHandler(doc.cm,\"beforeChange\");for(var i=event.changes.length-1;i>=0;--i){var change=event.changes[i];change.origin=type;if(filter&&!filterChange(doc,change,false)){(type==\"undo\"?hist.done:hist.undone).length=0;return}anti.changes.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change,null):{anchor:event.anchorBefore,head:event.headBefore};makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}function shiftDoc(doc,distance){function shiftPos(pos){return Pos(pos.line+distance,pos.ch)}doc.first+=distance;if(doc.cm)regChange(doc.cm,doc.first,doc.first,distance);doc.sel.head=shiftPos(doc.sel.head);doc.sel.anchor=shiftPos(doc.sel.anchor);doc.sel.from=shiftPos(doc.sel.from);doc.sel.to=shiftPos(doc.sel.to)}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return}if(change.from.line>doc.lastLine())return;if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}}change.removed=getBetween(doc,change.from,change.to);if(!selAfter)selAfter=computeSelAfterChange(doc,change,null);if(doc.cm)makeChangeSingleDocInEditor(doc.cm,change,spans,selAfter);else updateDoc(doc,change,spans,selAfter)}function makeChangeSingleDocInEditor(cm,change,spans,selAfter){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(doc,getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine){recomputeMaxLength=true;return true}})}if(!posLess(doc.sel.head,change.from)&&!posLess(change.to,doc.sel.head))cm.curOp.cursorActivity=true;updateDoc(doc,change,spans,selAfter,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(doc,line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false}});if(recomputeMaxLength)cm.curOp.updateMaxLine=true}doc.frontier=Math.min(doc.frontier,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;regChange(cm,from.line,to.line+1,lendiff);if(hasHandler(cm,\"change\")){var changeObj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(cm.curOp.textChanged){for(var cur=cm.curOp.textChanged;cur.next;cur=cur.next){}cur.next=changeObj}else cm.curOp.textChanged=changeObj}}function replaceRange(doc,code,from,to,origin){if(!to)to=from;if(posLess(to,from)){var tmp=to;to=from;from=tmp}if(typeof code==\"string\")code=splitLines(code);makeChange(doc,{from:from,to:to,text:code,origin:origin},null)}function Pos(line,ch){if(!(this instanceof Pos))return new Pos(line,ch);this.line=line;this.ch=ch}CodeMirror.Pos=Pos;function posEq(a,b){return a.line==b.line&&a.ch==b.ch}function posLess(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function copyPos(x){return Pos(x.line,x.ch)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;if(pos.line>last)return Pos(last,getLine(doc,last).text.length);return clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen)return Pos(pos.line,linelen);else if(ch<0)return Pos(pos.line,0);else return pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function extendSelection(doc,pos,other,bias){if(doc.sel.shift||doc.sel.extend){var anchor=doc.sel.anchor;if(other){var posBefore=posLess(pos,anchor);if(posBefore!=posLess(other,anchor)){anchor=pos;pos=other}else if(posBefore!=posLess(pos,other)){pos=other}}setSelection(doc,anchor,pos,bias)}else{setSelection(doc,pos,other||pos,bias)}if(doc.cm)doc.cm.curOp.userSelChange=true}function filterSelectionChange(doc,anchor,head){var obj={anchor:anchor,head:head};signal(doc,\"beforeSelectionChange\",doc,obj);if(doc.cm)signal(doc.cm,\"beforeSelectionChange\",doc.cm,obj);obj.anchor=clipPos(doc,obj.anchor);obj.head=clipPos(doc,obj.head);return obj}function setSelection(doc,anchor,head,bias,checkAtomic){if(!checkAtomic&&hasHandler(doc,\"beforeSelectionChange\")||doc.cm&&hasHandler(doc.cm,\"beforeSelectionChange\")){var filtered=filterSelectionChange(doc,anchor,head);head=filtered.head;anchor=filtered.anchor}var sel=doc.sel;sel.goalColumn=null;if(checkAtomic||!posEq(anchor,sel.anchor))anchor=skipAtomic(doc,anchor,bias,checkAtomic!=\"push\");if(checkAtomic||!posEq(head,sel.head))head=skipAtomic(doc,head,bias,checkAtomic!=\"push\");if(posEq(sel.anchor,anchor)&&posEq(sel.head,head))return;sel.anchor=anchor;sel.head=head;var inv=posLess(head,anchor);sel.from=inv?head:anchor;sel.to=inv?anchor:head;if(doc.cm)doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=doc.cm.curOp.cursorActivity=true;signalLater(doc,\"cursorActivity\",doc)}function reCheckSelection(cm){setSelection(cm.doc,cm.doc.sel.from,cm.doc.sel.to,null,\"push\")}function skipAtomic(doc,pos,bias,mayClear){var flipped=false,curPos=pos;var dir=bias||1;doc.cantEdit&=~cantEdit_inatomic;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((sp.from==null||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(sp.to==null||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear){signal(m,\"beforeCursorEnter\");if(m.explicitlyCleared){if(!line.markedSpans)break;else{--i;continue}}}if(!m.atomic)continue;var newPos=m.find()[dir<0?\"from\":\"to\"];if(posEq(newPos,curPos)){newPos.ch+=dir;if(newPos.ch<0){if(newPos.line>doc.first)newPos=clipPos(doc,Pos(newPos.line-1));else newPos=null}else if(newPos.ch>line.text.length){if(newPos.line<doc.first+doc.size-1)newPos=Pos(newPos.line+1,0);else newPos=null}if(!newPos){if(flipped){if(!mayClear)return skipAtomic(doc,pos,bias,true);doc.cantEdit|=cantEdit_inatomic;return Pos(doc.first,0)}flipped=true;newPos=pos;dir=-dir}}curPos=newPos;continue search}}}return curPos}}function scrollCursorIntoView(cm){var coords=scrollPosIntoView(cm,cm.doc.sel.head,cm.options.cursorScrollMargin);if(!cm.state.focused)return;var display=cm.display,box=getRect(display.sizer),doScroll=null;if(coords.top+box.top<0)doScroll=true;else if(coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight))doScroll=false;if(doScroll!=null&&!phantom){var hidden=display.cursor.style.display==\"none\";if(hidden){display.cursor.style.display=\"\";display.cursor.style.left=coords.left+\"px\";display.cursor.style.top=coords.top-display.viewOffset+\"px\"}display.cursor.scrollIntoView(doScroll);if(hidden)display.cursor.style.display=\"none\"}}function scrollPosIntoView(cm,pos,margin){if(margin==null)margin=0;for(;;){var changed=false,coords=cursorCoords(cm,pos);var scrollPos=calculateScrollPos(cm,coords.left,coords.top-margin,coords.left,coords.bottom+margin);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1)changed=true}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1)changed=true}if(!changed)return coords}}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);if(scrollPos.scrollTop!=null)setScrollTop(cm,scrollPos.scrollTop);if(scrollPos.scrollLeft!=null)setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);if(y1<0)y1=0;var screen=display.scroller.clientHeight-scrollerCutOff,screentop=display.scroller.scrollTop,result={};var docBottom=cm.doc.height+paddingVert(display);var atTop=y1<snapMargin,atBottom=y2>docBottom-snapMargin;if(y1<screentop){result.scrollTop=atTop?0:y1}else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);if(newTop!=screentop)result.scrollTop=newTop}var screenw=display.scroller.clientWidth-scrollerCutOff,screenleft=display.scroller.scrollLeft;x1+=display.gutters.offsetWidth;x2+=display.gutters.offsetWidth;var gutterw=display.gutters.offsetWidth;var atLeft=x1<gutterw+10;if(x1<screenleft+gutterw||atLeft){if(atLeft)x1=0;result.scrollLeft=Math.max(0,x1-10-gutterw)}else if(x2>screenw+screenleft-3){result.scrollLeft=x2+10-screenw}return result}function updateScrollPos(cm,left,top){cm.curOp.updateScrollPos={scrollLeft:left==null?cm.doc.scrollLeft:left,scrollTop:top==null?cm.doc.scrollTop:top}}function addToScrollPos(cm,left,top){var pos=cm.curOp.updateScrollPos||(cm.curOp.updateScrollPos={scrollLeft:cm.doc.scrollLeft,scrollTop:cm.doc.scrollTop});var scroll=cm.display.scroller;pos.scrollTop=Math.max(0,Math.min(scroll.scrollHeight-scroll.clientHeight,pos.scrollTop+top));pos.scrollLeft=Math.max(0,Math.min(scroll.scrollWidth-scroll.clientWidth,pos.scrollLeft+left))}function indentLine(cm,n,how,aggressive){var doc=cm.doc;if(!how)how=\"add\";if(how==\"smart\"){if(!cm.doc.mode.indent)how=\"prev\";else var state=getStateBefore(cm,n)}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);var curSpaceString=line.text.match(/^\\s*/)[0],indentation;if(how==\"smart\"){indentation=cm.doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass){if(!aggressive)return;how=\"prev\"}}if(how==\"prev\"){if(n>doc.first)indentation=countColumn(getLine(doc,n-1).text,null,tabSize);else indentation=0}else if(how==\"add\"){indentation=curSpace+cm.options.indentUnit}else if(how==\"subtract\"){indentation=curSpace-cm.options.indentUnit}indentation=Math.max(0,indentation);var indentString=\"\",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+=\"\t\"}if(pos<indentation)indentString+=spaceStr(indentation-pos);if(indentString!=curSpaceString)replaceRange(cm.doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),\"+input\");line.stateAfter=null}function changeLine(cm,handle,op){var no=handle,line=handle,doc=cm.doc;\nif(typeof handle==\"number\")line=getLine(doc,clipLine(doc,handle));else no=lineNo(handle);if(no==null)return null;if(op(line,no))regChange(cm,no,no+1);else return null;return line}function findPosH(doc,pos,dir,unit,visually){var line=pos.line,ch=pos.ch,origDir=dir;var lineObj=getLine(doc,line);var possible=true;function findNextLine(){var l=line+dir;if(l<doc.first||l>=doc.first+doc.size)return possible=false;line=l;return lineObj=getLine(doc,l)}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,true);if(next==null){if(!boundToLine&&findNextLine()){if(visually)ch=(dir<0?lineRight:lineLeft)(lineObj);else ch=dir<0?lineObj.text.length:0}else return possible=false}else ch=next;return true}if(unit==\"char\")moveOnce();else if(unit==\"column\")moveOnce(true);else if(unit==\"word\"||unit==\"group\"){var sawType=null,group=unit==\"group\";for(var first=true;;first=false){if(dir<0&&!moveOnce(!first))break;var cur=lineObj.text.charAt(ch)||\"\\n\";var type=isWordChar(cur)?\"w\":!group?null:/\\s/.test(cur)?null:\"p\";if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce()}break}if(type)sawType=type;if(dir>0&&!moveOnce(!first))break}}var result=skipAtomic(doc,Pos(line,ch),origDir,true);if(!possible)result.hitSide=true;return result}function findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit==\"page\"){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(dir<0?1.5:.5)*textHeight(cm.display))}else if(unit==\"line\"){y=dir>0?pos.bottom+3:pos.top-3}for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break}y+=dir*5}return target}function findWordAt(line,pos){var start=pos.ch,end=pos.ch;if(line){if(pos.after===false||end==line.length)--start;else++end;var startChar=line.charAt(start);var check=isWordChar(startChar)?isWordChar:/\\s/.test(startChar)?function(ch){return/\\s/.test(ch)}:function(ch){return!/\\s/.test(ch)&&!isWordChar(ch)};while(start>0&&check(line.charAt(start-1)))--start;while(end<line.length&&check(line.charAt(end)))++end}return{from:Pos(pos.line,start),to:Pos(pos.line,end)}}function selectLine(cm,line){extendSelection(cm.doc,Pos(line,0),clipPos(cm.doc,Pos(line+1,0)))}CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus();focusInput(this);onFocus(this);fastPoll(this)},setOption:function(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!=\"mode\")return;options[option]=value;if(optionHandlers.hasOwnProperty(option))operation(this,optionHandlers[option])(this,value,old)},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?\"push\":\"unshift\"](map)},removeKeyMap:function(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i)if((typeof map==\"string\"?maps[i].name:maps[i])==map){maps.splice(i,1);return true}},addOverlay:operation(null,function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error(\"Overlays may not be stateful.\");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque});this.state.modeGen++;regChange(this)}),removeOverlay:operation(null,function(spec){var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||typeof spec==\"string\"&&cur.name==spec){overlays.splice(i,1);this.state.modeGen++;regChange(this);return}}}),indentLine:operation(null,function(n,dir,aggressive){if(typeof dir!=\"string\"){if(dir==null)dir=this.options.smartIndent?\"smart\":\"prev\";else dir=dir?\"add\":\"subtract\"}if(isLine(this.doc,n))indentLine(this,n,dir,aggressive)}),indentSelection:operation(null,function(how){var sel=this.doc.sel;if(posEq(sel.from,sel.to))return indentLine(this,sel.from.line,how);var e=sel.to.line-(sel.to.ch?0:1);for(var i=sel.from.line;i<=e;++i)indentLine(this,i,how)}),getTokenAt:function(pos){var doc=this.doc;pos=clipPos(doc,pos);var state=getStateBefore(this,pos.line),mode=this.doc.mode;var line=getLine(doc,pos.line);var stream=new StringStream(line.text,this.options.tabSize);while(stream.pos<pos.ch&&!stream.eol()){stream.start=stream.pos;var style=mode.token(stream,state)}return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,type:style||null,state:state}},getStateAfter:function(line){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getStateBefore(this,line+1)},cursorCoords:function(start,mode){var pos,sel=this.doc.sel;if(start==null)pos=sel.head;else if(typeof start==\"object\")pos=clipPos(this.doc,start);else pos=start?sel.from:sel.to;return cursorCoords(this,pos,mode||\"page\")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||\"page\")},coordsChar:function(coords,mode){coords=fromCoordSystem(this,coords,mode||\"page\");return coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){height=fromCoordSystem(this,{top:height,left:0},mode||\"page\").top;return lineAtHeight(this.doc,height+this.display.viewOffset)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:operation(null,function(line,gutterID,value){return changeLine(this,line,function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers))line.gutterMarkers=null;return true})}),clearGutter:operation(null,function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){line.gutterMarkers[gutterID]=null;regChange(cm,i,i+1);if(isEmpty(line.gutterMarkers))line.gutterMarkers=null}++i})}),addLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where==\"text\"?\"textClass\":where==\"background\"?\"bgClass\":\"wrapClass\";if(!line[prop])line[prop]=cls;else if(new RegExp(\"\\\\b\"+cls+\"\\\\b\").test(line[prop]))return false;else line[prop]+=\" \"+cls;return true})}),removeLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where==\"text\"?\"textClass\":where==\"background\"?\"bgClass\":\"wrapClass\";var cur=line[prop];if(!cur)return false;else if(cls==null)line[prop]=null;else{var upd=cur.replace(new RegExp(\"^\"+cls+\"\\\\b\\\\s*|\\\\s*\\\\b\"+cls+\"\\\\b\"),\"\");if(upd==cur)return false;line[prop]=upd||null}return true})}),addLineWidget:operation(null,function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},lineInfo:function(line){if(typeof line==\"number\"){if(!isLine(this.doc,line))return null;var n=line;line=getLine(this.doc,line);if(!line)return null}else{var n=lineNo(line);if(n==null)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position=\"absolute\";display.sizer.appendChild(node);if(vert==\"over\"){top=pos.top}else if(vert==\"above\"||vert==\"near\"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);if((vert==\"above\"||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight)top=pos.top-node.offsetHeight;else if(pos.bottom+node.offsetHeight<=vspace)top=pos.bottom;if(left+node.offsetWidth>hspace)left=hspace-node.offsetWidth}node.style.top=top+\"px\";node.style.left=node.style.right=\"\";if(horiz==\"right\"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right=\"0px\"}else{if(horiz==\"left\")left=0;else if(horiz==\"middle\")left=(display.sizer.clientWidth-node.offsetWidth)/2;node.style.left=left+\"px\"}if(scroll)scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:operation(null,onKeyDown),execCommand:function(cmd){return commands[cmd](this)},findPosH:function(from,amount,unit,visually){var dir=1;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){cur=findPosH(this.doc,cur,dir,unit,visually);if(cur.hitSide)break}return cur},moveH:operation(null,function(dir,unit){var sel=this.doc.sel,pos;if(sel.shift||sel.extend||posEq(sel.from,sel.to))pos=findPosH(this.doc,sel.head,dir,unit,this.options.rtlMoveVisually);else pos=dir<0?sel.from:sel.to;extendSelection(this.doc,pos,pos,dir)}),deleteH:operation(null,function(dir,unit){var sel=this.doc.sel;if(!posEq(sel.from,sel.to))replaceRange(this.doc,\"\",sel.from,sel.to,\"+delete\");else replaceRange(this.doc,\"\",sel.from,findPosH(this.doc,sel.head,dir,unit,false),\"+delete\");this.curOp.userSelChange=true}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){var coords=cursorCoords(this,cur,\"div\");if(x==null)x=coords.left;else coords.left=x;cur=findPosV(this,coords,dir,unit);if(cur.hitSide)break}return cur},moveV:operation(null,function(dir,unit){var sel=this.doc.sel;var pos=cursorCoords(this,sel.head,\"div\");if(sel.goalColumn!=null)pos.left=sel.goalColumn;var target=findPosV(this,pos,dir,unit);if(unit==\"page\")addToScrollPos(this,0,charCoords(this,target,\"div\").top-pos.top);extendSelection(this.doc,target,target,dir);sel.goalColumn=pos.left}),toggleOverwrite:function(value){if(value!=null&&value==this.state.overwrite)return;if(this.state.overwrite=!this.state.overwrite)this.display.cursor.className+=\" CodeMirror-overwrite\";else this.display.cursor.className=this.display.cursor.className.replace(\" CodeMirror-overwrite\",\"\")},hasFocus:function(){return this.state.focused},scrollTo:operation(null,function(x,y){updateScrollPos(this,x,y)}),getScrollInfo:function(){var scroller=this.display.scroller,co=scrollerCutOff;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-co,width:scroller.scrollWidth-co,clientHeight:scroller.clientHeight-co,clientWidth:scroller.clientWidth-co}},scrollIntoView:operation(null,function(pos,margin){if(typeof pos==\"number\")pos=Pos(pos,0);if(!margin)margin=0;var coords=pos;if(!pos||pos.line!=null){this.curOp.scrollToPos=pos?clipPos(this.doc,pos):this.doc.sel.head;this.curOp.scrollToPosMargin=margin;coords=cursorCoords(this,this.curOp.scrollToPos)}var sPos=calculateScrollPos(this,coords.left,coords.top-margin,coords.right,coords.bottom+margin);updateScrollPos(this,sPos.scrollLeft,sPos.scrollTop)}),setSize:function(width,height){function interpret(val){return typeof val==\"number\"||/^\\d+$/.test(String(val))?val+\"px\":val}if(width!=null)this.display.wrapper.style.width=interpret(width);if(height!=null)this.display.wrapper.style.height=interpret(height);this.refresh()},on:function(type,f){on(this,type,f)},off:function(type,f){off(this,type,f)},operation:function(f){return runInOp(this,f)},refresh:operation(null,function(){clearCaches(this);updateScrollPos(this,this.doc.scrollLeft,this.doc.scrollTop);regChange(this)}),swapDoc:operation(null,function(doc){var old=this.doc;old.cm=null;attachDoc(this,doc);clearCaches(this);resetInput(this,true);updateScrollPos(this,doc.scrollLeft,doc.scrollTop);return old}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var optionHandlers=CodeMirror.optionHandlers={};var defaults=CodeMirror.defaults={};function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle)optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init)handle(cm,val,old)}:handle}var Init=CodeMirror.Init={toString:function(){return\"CodeMirror.Init\"}};option(\"value\",\"\",function(cm,val){cm.setValue(val)},true);option(\"mode\",null,function(cm,val){cm.doc.modeOption=val;loadMode(cm)},true);option(\"indentUnit\",2,loadMode,true);option(\"indentWithTabs\",false);option(\"smartIndent\",true);option(\"tabSize\",4,function(cm){loadMode(cm);clearCaches(cm);regChange(cm)},true);option(\"electricChars\",true);option(\"rtlMoveVisually\",!windows);option(\"theme\",\"default\",function(cm){themeChanged(cm);guttersChanged(cm)},true);option(\"keyMap\",\"default\",keyMapChanged);option(\"extraKeys\",null);option(\"onKeyEvent\",null);option(\"onDragEvent\",null);option(\"lineWrapping\",false,wrappingChanged,true);option(\"gutters\",[],function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option(\"fixedGutter\",true,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+\"px\":\"0\";cm.refresh()},true);option(\"coverGutterNextToScrollbar\",false,updateScrollbars,true);option(\"lineNumbers\",false,function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option(\"firstLineNumber\",1,guttersChanged,true);option(\"lineNumberFormatter\",function(integer){return integer},guttersChanged,true);option(\"showCursorWhenSelecting\",false,updateSelection,true);option(\"readOnly\",false,function(cm,val){if(val==\"nocursor\"){onBlur(cm);cm.display.input.blur()}else if(!val)resetInput(cm,true)});option(\"dragDrop\",true);option(\"cursorBlinkRate\",530);option(\"cursorScrollMargin\",0);option(\"cursorHeight\",1);option(\"workTime\",100);option(\"workDelay\",100);option(\"flattenSpans\",true);option(\"pollInterval\",100);option(\"undoDepth\",40,function(cm,val){cm.doc.history.undoDepth=val});option(\"historyEventDelay\",500);option(\"viewportMargin\",10,function(cm){cm.refresh()},true);option(\"maxHighlightLength\",1e4,function(cm){loadMode(cm);cm.refresh()},true);option(\"moveInputWithCursor\",true,function(cm,val){if(!val)cm.display.inputDiv.style.top=cm.display.inputDiv.style.left=0});option(\"tabindex\",null,function(cm,val){cm.display.input.tabIndex=val||\"\"});option(\"autofocus\",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(!CodeMirror.defaults.mode&&name!=\"null\")CodeMirror.defaults.mode=name;if(arguments.length>2){mode.dependencies=[];for(var i=2;i<arguments.length;++i)mode.dependencies.push(arguments[i])}modes[name]=mode};CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec};CodeMirror.resolveMode=function(spec){if(typeof spec==\"string\"&&mimeModes.hasOwnProperty(spec)){spec=mimeModes[spec]}else if(spec&&typeof spec.name==\"string\"&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];spec=createObj(found,spec);spec.name=found.name}else if(typeof spec==\"string\"&&/^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)){return CodeMirror.resolveMode(\"application/xml\")}if(typeof spec==\"string\")return{name:spec};else return spec||{name:\"null\"}};CodeMirror.getMode=function(options,spec){spec=CodeMirror.resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,\"text/plain\");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop))continue;if(modeObj.hasOwnProperty(prop))modeObj[\"_\"+prop]=modeObj[prop];modeObj[prop]=exts[prop]}}modeObj.name=spec.name;return modeObj};CodeMirror.defineMode(\"null\",function(){return{token:function(stream){stream.skipToEnd()}}});CodeMirror.defineMIME(\"text/plain\",\"null\");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)};CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func};CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};function copyState(mode,state){if(state===true)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];if(val instanceof Array)val=val.concat([]);nstate[n]=val}return nstate}CodeMirror.copyState=copyState;function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true}CodeMirror.startState=startState;CodeMirror.innerMode=function(mode,state){while(mode.innerMode){var info=mode.innerMode(state);state=info.state;mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()))},killLine:function(cm){var from=cm.getCursor(true),to=cm.getCursor(false),sel=!posEq(from,to);if(!sel&&cm.getLine(from.line).length==from.ch)cm.replaceRange(\"\",from,Pos(from.line+1,0),\"+delete\");else cm.replaceRange(\"\",from,sel?to:Pos(from.line),\"+delete\")},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange(\"\",Pos(l,0),Pos(l),\"+delete\")},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelection(lineStart(cm,cm.getCursor().line))},goLineStartSmart:function(cm){var cur=cm.getCursor(),start=lineStart(cm,cur.line);var line=cm.getLineHandle(start.line);var order=getOrder(line);if(!order||order[0].level==0){var firstNonWS=Math.max(0,line.text.search(/\\S/));var inWS=cur.line==start.line&&cur.ch<=firstNonWS&&cur.ch;cm.extendSelection(Pos(start.line,inWS?0:firstNonWS))}else cm.extendSelection(start)},goLineEnd:function(cm){cm.extendSelection(lineEnd(cm,cm.getCursor().line))},goLineRight:function(cm){var top=cm.charCoords(cm.getCursor(),\"div\").top+5;cm.extendSelection(cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},\"div\"))},goLineLeft:function(cm){var top=cm.charCoords(cm.getCursor(),\"div\").top+5;cm.extendSelection(cm.coordsChar({left:0,top:top},\"div\"))},goLineUp:function(cm){cm.moveV(-1,\"line\")},goLineDown:function(cm){cm.moveV(1,\"line\")},goPageUp:function(cm){cm.moveV(-1,\"page\")},goPageDown:function(cm){cm.moveV(1,\"page\")},goCharLeft:function(cm){cm.moveH(-1,\"char\")},goCharRight:function(cm){cm.moveH(1,\"char\")},goColumnLeft:function(cm){cm.moveH(-1,\"column\")},goColumnRight:function(cm){cm.moveH(1,\"column\")},goWordLeft:function(cm){cm.moveH(-1,\"word\")},goGroupRight:function(cm){cm.moveH(1,\"group\")},goGroupLeft:function(cm){cm.moveH(-1,\"group\")},goWordRight:function(cm){cm.moveH(1,\"word\")},delCharBefore:function(cm){cm.deleteH(-1,\"char\")},delCharAfter:function(cm){cm.deleteH(1,\"char\")},delWordBefore:function(cm){cm.deleteH(-1,\"word\")},delWordAfter:function(cm){cm.deleteH(1,\"word\")},delGroupBefore:function(cm){cm.deleteH(-1,\"group\")},delGroupAfter:function(cm){cm.deleteH(1,\"group\")},indentAuto:function(cm){cm.indentSelection(\"smart\")},indentMore:function(cm){cm.indentSelection(\"add\")},indentLess:function(cm){cm.indentSelection(\"subtract\")},insertTab:function(cm){cm.replaceSelection(\"\t\",\"end\",\"+input\")},defaultTab:function(cm){if(cm.somethingSelected())cm.indentSelection(\"add\");else cm.replaceSelection(\"\t\",\"end\",\"+input\")},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);if(cur.ch>0&&cur.ch<line.length-1)cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1))},newlineAndIndent:function(cm){operation(cm,function(){cm.replaceSelection(\"\\n\",\"end\",\"+input\");cm.indentLine(cm.getCursor().line,null,true)})()},toggleOverwrite:function(cm){cm.toggleOverwrite()}};var keyMap=CodeMirror.keyMap={};keyMap.basic={Left:\"goCharLeft\",Right:\"goCharRight\",Up:\"goLineUp\",Down:\"goLineDown\",End:\"goLineEnd\",Home:\"goLineStartSmart\",PageUp:\"goPageUp\",PageDown:\"goPageDown\",Delete:\"delCharAfter\",Backspace:\"delCharBefore\",Tab:\"defaultTab\",\"Shift-Tab\":\"indentAuto\",Enter:\"newlineAndIndent\",Insert:\"toggleOverwrite\"};keyMap.pcDefault={\"Ctrl-A\":\"selectAll\",\"Ctrl-D\":\"deleteLine\",\"Ctrl-Z\":\"undo\",\"Shift-Ctrl-Z\":\"redo\",\"Ctrl-Y\":\"redo\",\"Ctrl-Home\":\"goDocStart\",\"Alt-Up\":\"goDocStart\",\"Ctrl-End\":\"goDocEnd\",\"Ctrl-Down\":\"goDocEnd\",\"Ctrl-Left\":\"goGroupLeft\",\"Ctrl-Right\":\"goGroupRight\",\"Alt-Left\":\"goLineStart\",\"Alt-Right\":\"goLineEnd\",\"Ctrl-Backspace\":\"delGroupBefore\",\"Ctrl-Delete\":\"delGroupAfter\",\"Ctrl-S\":\"save\",\"Ctrl-F\":\"find\",\"Ctrl-G\":\"findNext\",\"Shift-Ctrl-G\":\"findPrev\",\"Shift-Ctrl-F\":\"replace\",\"Shift-Ctrl-R\":\"replaceAll\",\"Ctrl-[\":\"indentLess\",\"Ctrl-]\":\"indentMore\",fallthrough:\"basic\"};keyMap.macDefault={\"Cmd-A\":\"selectAll\",\"Cmd-D\":\"deleteLine\",\"Cmd-Z\":\"undo\",\"Shift-Cmd-Z\":\"redo\",\"Cmd-Y\":\"redo\",\"Cmd-Up\":\"goDocStart\",\"Cmd-End\":\"goDocEnd\",\"Cmd-Down\":\"goDocEnd\",\"Alt-Left\":\"goGroupLeft\",\"Alt-Right\":\"goGroupRight\",\"Cmd-Left\":\"goLineStart\",\"Cmd-Right\":\"goLineEnd\",\"Alt-Backspace\":\"delGroupBefore\",\"Ctrl-Alt-Backspace\":\"delGroupAfter\",\"Alt-Delete\":\"delGroupAfter\",\"Cmd-S\":\"save\",\"Cmd-F\":\"find\",\"Cmd-G\":\"findNext\",\"Shift-Cmd-G\":\"findPrev\",\"Cmd-Alt-F\":\"replace\",\"Shift-Cmd-Alt-F\":\"replaceAll\",\"Cmd-[\":\"indentLess\",\"Cmd-]\":\"indentMore\",fallthrough:[\"basic\",\"emacsy\"]};keyMap[\"default\"]=mac?keyMap.macDefault:keyMap.pcDefault;keyMap.emacsy={\"Ctrl-F\":\"goCharRight\",\"Ctrl-B\":\"goCharLeft\",\"Ctrl-P\":\"goLineUp\",\"Ctrl-N\":\"goLineDown\",\"Alt-F\":\"goWordRight\",\"Alt-B\":\"goWordLeft\",\"Ctrl-A\":\"goLineStart\",\"Ctrl-E\":\"goLineEnd\",\"Ctrl-V\":\"goPageDown\",\"Shift-Ctrl-V\":\"goPageUp\",\"Ctrl-D\":\"delCharAfter\",\"Ctrl-H\":\"delCharBefore\",\"Alt-D\":\"delWordAfter\",\"Alt-Backspace\":\"delWordBefore\",\"Ctrl-K\":\"killLine\",\"Ctrl-T\":\"transposeChars\"};function getKeyMap(val){if(typeof val==\"string\")return keyMap[val];else return val}function lookupKey(name,maps,handle){function lookup(map){map=getKeyMap(map);var found=map[name];if(found===false)return\"stop\";if(found!=null&&handle(found))return true;if(map.nofallthrough)return\"stop\";var fallthrough=map.fallthrough;if(fallthrough==null)return false;if(Object.prototype.toString.call(fallthrough)!=\"[object Array]\")return lookup(fallthrough);for(var i=0,e=fallthrough.length;i<e;++i){var done=lookup(fallthrough[i]);if(done)return done}return false}for(var i=0;i<maps.length;++i){var done=lookup(maps[i]);if(done)return done!=\"stop\"}}function isModifierKey(event){var name=keyNames[event.keyCode];return name==\"Ctrl\"||name==\"Alt\"||name==\"Shift\"||name==\"Mod\"}function keyName(event,noShift){if(opera&&event.keyCode==34&&event[\"char\"])return false;var name=keyNames[event.keyCode];if(name==null||event.altGraphKey)return false;if(event.altKey)name=\"Alt-\"+name;if(flipCtrlCmd?event.metaKey:event.ctrlKey)name=\"Ctrl-\"+name;if(flipCtrlCmd?event.ctrlKey:event.metaKey)name=\"Cmd-\"+name;if(!noShift&&event.shiftKey)name=\"Shift-\"+name;return name}CodeMirror.lookupKey=lookupKey;CodeMirror.isModifierKey=isModifierKey;CodeMirror.keyName=keyName;CodeMirror.fromTextArea=function(textarea,options){if(!options)options={};options.value=textarea.value;if(!options.tabindex&&textarea.tabindex)options.tabindex=textarea.tabindex;if(!options.placeholder&&textarea.placeholder)options.placeholder=textarea.placeholder;if(options.autofocus==null){var hasFocus=document.body;try{hasFocus=document.activeElement}catch(e){}options.autofocus=hasFocus==textarea||textarea.getAttribute(\"autofocus\")!=null&&hasFocus==document.body}function save(){textarea.value=cm.getValue()}if(textarea.form){on(textarea.form,\"submit\",save);if(!options.leaveSubmitMethodAlone){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save();form.submit=realSubmit;form.submit();form.submit=wrappedSubmit}}catch(e){}}}textarea.style.display=\"none\";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);cm.save=save;cm.getTextArea=function(){return textarea};cm.toTextArea=function(){save();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display=\"\";if(textarea.form){off(textarea.form,\"submit\",save);if(typeof textarea.form.submit==\"function\")textarea.form.submit=realSubmit}};return cm};function StringStream(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0}StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(match){var ch=this.string.charAt(this.pos);if(typeof match==\"string\")var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));if(ok){++this.pos;return ch}},eatWhile:function(match){var start=this.pos;while(this.eat(match)){}return this.pos>start},eatSpace:function(){var start=this.pos;while(/[\\s\\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true}},backUp:function(n){this.pos-=n},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue},indentation:function(){return countColumn(this.string,null,this.tabSize)},match:function(pattern,consume,caseInsensitive){if(typeof pattern==\"string\"){var cased=function(str){return caseInsensitive?str.toLowerCase():str};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false)this.pos+=pattern.length;return true}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0)return null;if(match&&consume!==false)this.pos+=match[0].length;return match}},current:function(){return this.string.slice(this.start,this.pos)}};CodeMirror.StringStream=StringStream;function TextMarker(doc,type){this.lines=[];this.type=type;this.doc=doc}CodeMirror.TextMarker=TextMarker;TextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp)startOperation(cm);var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.to!=null)max=lineNo(line);line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from!=null)min=lineNo(line);else if(this.collapsed&&!lineIsHidden(this.doc,line)&&cm)updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(cm.doc,this.lines[i]),len=lineLength(cm.doc,visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true}}if(min!=null&&cm)regChange(cm,min,max+1);this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit&cantEdit_inatomic){this.doc.cantEdit&=~cantEdit_inatomic;if(cm)reCheckSelection(cm)}if(withOp)endOperation(cm);signalLater(this,\"clear\")};TextMarker.prototype.find=function(){var from,to;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.from!=null||span.to!=null){var found=lineNo(line);if(span.from!=null)from=Pos(found,span.from);if(span.to!=null)to=Pos(found,span.to)}}if(this.type==\"bookmark\")return from;return from&&{from:from,to:to}};TextMarker.prototype.changed=function(){var pos=this.find(),cm=this.doc.cm;if(!pos||!cm)return;var line=getLine(this.doc,pos.from.line);clearCachedMeasurement(cm,line);if(pos.from.line>=cm.display.showingFrom&&pos.from.line<cm.display.showingTo){for(var node=cm.display.lineDiv.firstChild;node;node=node.nextSibling)if(node.lineObj==line){if(node.offsetHeight!=line.height)updateLineHeight(line,node.offsetHeight);break}runInOp(cm,function(){cm.curOp.selectionChanged=true})}};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1)(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type);if(type==\"range\"&&!posLess(from,to))return marker;if(options)copyObj(options,marker);if(marker.replacedWith){marker.collapsed=true;marker.replacedWith=elt(\"span\",[marker.replacedWith],\"CodeMirror-widget\");if(!options.handleMouseEvents)marker.replacedWith.ignoreEvents=true}if(marker.collapsed)sawCollapsedSpans=true;if(marker.addToHistory)addToHistory(doc,{from:from,to:to,origin:\"markText\"},{head:doc.sel.head,anchor:doc.sel.anchor},NaN);var curLine=from.line,size=0,collapsedAtStart,collapsedAtEnd,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(doc,line)==cm.display.maxLine)updateMaxLine=true;var span={from:null,to:null,marker:marker};size+=line.text.length;if(curLine==from.line){span.from=from.ch;size-=from.ch}if(curLine==to.line){span.to=to.ch;size-=line.text.length-to.ch}if(marker.collapsed){if(curLine==to.line)collapsedAtEnd=collapsedSpanAt(line,to.ch);if(curLine==from.line)collapsedAtStart=collapsedSpanAt(line,from.ch);else updateLineHeight(line,0)}addMarkedSpan(line,span);++curLine});if(marker.collapsed)doc.iter(from.line,to.line+1,function(line){if(lineIsHidden(doc,line))updateLineHeight(line,0)});if(marker.clearOnEnter)on(marker,\"beforeCursorEnter\",function(){marker.clear()});if(marker.readOnly){sawReadOnlySpans=true;if(doc.history.done.length||doc.history.undone.length)doc.clearHistory()}if(marker.collapsed){if(collapsedAtStart!=collapsedAtEnd)throw new Error(\"Inserting collapsed marker overlapping an existing one\");marker.size=size;marker.atomic=true}if(cm){if(updateMaxLine)cm.curOp.updateMaxLine=true;if(marker.className||marker.startStyle||marker.endStyle||marker.collapsed)regChange(cm,from.line,to.line+1);if(marker.atomic)reCheckSelection(cm)}return marker}function SharedTextMarker(markers,primary){this.markers=markers;this.primary=primary;for(var i=0,me=this;i<markers.length;++i){markers[i].parent=this;on(markers[i],\"clear\",function(){me.clear()})}}CodeMirror.SharedTextMarker=SharedTextMarker;SharedTextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,\"clear\")};SharedTextMarker.prototype.find=function(){return this.primary.find()};function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[markText(doc,from,to,options,type)],primary=markers[0];var widget=options.replacedWith;linkedDocs(doc,function(doc){if(widget)options.replacedWith=widget.cloneNode(true);markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)});return new SharedTextMarker(markers,primary)}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)if(spans[i]!=span)(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||marker.type==\"bookmark\"&&span.from==startCh&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);\n(nw||(nw=[])).push({from:span.from,to:endsAfter?null:span.to,marker:marker})}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||marker.type==\"bookmark\"&&span.from==endCh&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push({from:startsBefore?null:span.from-endCh,to:span.to==null?null:span.to-endCh,marker:marker})}}return nw}function stretchSpansOverChange(doc,change){var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=posEq(change.from,change.to);var first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);var sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){for(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found)span.to=startCh;else if(sameLine)span.to=found.to==null?null:found.to+offset}}}if(last){for(var i=0;i<last.length;++i){var span=last[i];if(span.to!=null)span.to+=offset;if(span.from==null){var found=getMarkedSpanFor(first,span.marker);if(!found){span.from=offset;if(sameLine)(first||(first=[])).push(span)}}else{span.from+=offset;if(sameLine)(first||(first=[])).push(span)}}}var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(gap>0&&first)for(var i=0;i<first.length;++i)if(first[i].to==null)(gapMarkers||(gapMarkers=[])).push({from:null,to:null,marker:first[i].marker});for(var i=0;i<gap;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}}else if(stretchCur){old[i]=stretchCur}}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1))(markers||(markers=[])).push(mark)}});if(!markers)return null;var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find();for(var j=0;j<parts.length;++j){var p=parts[j];if(posLess(p.to,m.from)||posLess(m.to,p.from))continue;var newParts=[j,1];if(posLess(p.from,m.from)||!mk.inclusiveLeft&&posEq(p.from,m.from))newParts.push({from:p.from,to:m.from});if(posLess(m.to,p.to)||!mk.inclusiveRight&&posEq(p.to,m.to))newParts.push({from:m.to,to:p.to});parts.splice.apply(parts,newParts);j+=newParts.length-1}}return parts}function collapsedSpanAt(line,ch){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if((sp.from==null||sp.from<ch)&&(sp.to==null||sp.to>ch)&&(!found||found.width<sp.marker.width))found=sp.marker}return found}function collapsedSpanAtStart(line){return collapsedSpanAt(line,-1)}function collapsedSpanAtEnd(line){return collapsedSpanAt(line,line.text.length+1)}function visualLine(doc,line){var merged;while(merged=collapsedSpanAtStart(line))line=getLine(doc,merged.find().from.line);return line}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if(sp.from==null)return true;if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return true}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find().to,endLine=getLine(doc,end.line);return lineIsHiddenInner(doc,endLine,getMarkedSpanFor(endLine.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return true;for(var sp,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&sp.from==span.to&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return true}}function detachMarkedSpans(line){var spans=line.markedSpans;if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}function attachMarkedSpans(line,spans){if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}var LineWidget=CodeMirror.LineWidget=function(cm,node,options){for(var opt in options)if(options.hasOwnProperty(opt))this[opt]=options[opt];this.cm=cm;this.node=node};function widgetOperation(f){return function(){var withOp=!this.cm.curOp;if(withOp)startOperation(this.cm);try{var result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}LineWidget.prototype.clear=widgetOperation(function(){var ws=this.line.widgets,no=lineNo(this.line);if(no==null||!ws)return;for(var i=0;i<ws.length;++i)if(ws[i]==this)ws.splice(i--,1);if(!ws.length)this.line.widgets=null;updateLineHeight(this.line,Math.max(0,this.line.height-widgetHeight(this)));regChange(this.cm,no,no+1)});LineWidget.prototype.changed=widgetOperation(function(){var oldH=this.height;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff)return;updateLineHeight(this.line,this.line.height+diff);var no=lineNo(this.line);regChange(this.cm,no,no+1)});function widgetHeight(widget){if(widget.height!=null)return widget.height;if(!widget.node.parentNode||widget.node.parentNode.nodeType!=1)removeChildrenAndAdd(widget.cm.display.measure,elt(\"div\",[widget.node],null,\"position: relative\"));return widget.height=widget.node.offsetHeight}function addLineWidget(cm,handle,node,options){var widget=new LineWidget(cm,node,options);if(widget.noHScroll)cm.display.alignWidgets=true;changeLine(cm,handle,function(line){(line.widgets||(line.widgets=[])).push(widget);widget.line=line;if(!lineIsHidden(cm.doc,line)||widget.showIfHidden){var aboveVisible=heightAtLine(cm,line)<cm.display.scroller.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible)addToScrollPos(cm,0,widget.height)}return true});return widget}function makeLine(text,markedSpans,estimateHeight){var line={text:text};attachMarkedSpans(line,markedSpans);line.height=estimateHeight?estimateHeight(line):1;return line}function updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null;if(line.order!=null)line.order=null;detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height)updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null;detachMarkedSpans(line)}function runMode(cm,text,mode,state,f){var flattenSpans=mode.flattenSpans;if(flattenSpans==null)flattenSpans=cm.options.flattenSpans;var curText=\"\",curStyle=null;var stream=new StringStream(text,cm.options.tabSize),style;if(text==\"\"&&mode.blankLine)mode.blankLine(state);while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;stream.pos=Math.min(text.length,stream.start+5e4);style=null}else{style=mode.token(stream,state)}var substr=stream.current();stream.start=stream.pos;if(!flattenSpans||curStyle!=style){if(curText)f(curText,curStyle);curText=substr;curStyle=style}else curText=curText+substr}if(curText)f(curText,curStyle)}function highlightLine(cm,line,state){var st=[cm.state.modeGen];runMode(cm,line.text,cm.doc.mode,state,function(txt,style){st.push(txt,style)});for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1;runMode(cm,line.text,overlay.mode,true,function(txt,style){var start=i,len=txt.length;while(len){var cur=st[i],len_=cur.length;if(len_<=len){len-=len_}else{st.splice(i,1,cur.slice(0,len),st[i+1],cur.slice(len));len=0}i+=2}if(!style)return;if(overlay.opaque){st.splice(start,i-start,txt,style);i=start+2}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=cur?cur+\" \"+style:style}}})}return st}function getLineStyles(cm,line){if(!line.styles||line.styles[0]!=cm.state.modeGen)line.styles=highlightLine(cm,line,line.stateAfter=getStateBefore(cm,lineNo(line)));return line.styles}function processLine(cm,line,state){var mode=cm.doc.mode;var stream=new StringStream(line.text,cm.options.tabSize);if(line.text==\"\"&&mode.blankLine)mode.blankLine(state);while(!stream.eol()&&stream.pos<=cm.options.maxHighlightLength){mode.token(stream,state);stream.start=stream.pos}}var styleToClassCache={};function styleToClass(style){if(!style)return null;return styleToClassCache[style]||(styleToClassCache[style]=\"cm-\"+style.replace(/ +/g,\" cm-\"))}function lineContent(cm,realLine,measure){var merged,line=realLine,lineBefore,sawBefore,empty=true;while(merged=collapsedSpanAtStart(line)){line=getLine(cm.doc,merged.find().from.line);if(!lineBefore)lineBefore=line}var builder={pre:elt(\"pre\"),col:0,pos:0,display:!measure,measure:null,addedOne:false,cm:cm};if(line.textClass)builder.pre.className=line.textClass;do{if(line.text)empty=false;builder.measure=line==realLine&&measure;builder.pos=0;builder.addToken=builder.measure?buildTokenMeasure:buildToken;if((ie||webkit)&&cm.getOption(\"lineWrapping\"))builder.addToken=buildTokenSplitSpaces(builder.addToken);if(measure&&sawBefore&&line!=realLine&&!builder.addedOne){measure[0]=builder.pre.appendChild(zeroWidthElement(cm.display.measure));builder.addedOne=true}var next=insertLineContent(line,builder,getLineStyles(cm,line));sawBefore=line==lineBefore;if(next)line=getLine(cm.doc,next.to.line)}while(next);if(measure&&!builder.addedOne)measure[0]=builder.pre.appendChild(empty?elt(\"span\",\"\"):zeroWidthElement(cm.display.measure));if(!builder.pre.firstChild&&!lineIsHidden(cm.doc,realLine))builder.pre.appendChild(document.createTextNode(\"\"));var order;if(measure&&ie&&(order=getOrder(line))){var l=order.length-1;if(order[l].from==order[l].to)--l;var last=order[l],prev=order[l-1];if(last.from+1==last.to&&prev&&last.level<prev.level){var span=measure[builder.pos-1];if(span)span.parentNode.insertBefore(span.measureRight=zeroWidthElement(cm.display.measure),span.nextSibling)}}signal(cm,\"renderLine\",cm,realLine,builder.pre);return builder.pre}var tokenSpecialChars=/[\\t\\u0000-\\u0019\\u00ad\\u200b\\u2028\\u2029\\uFEFF]/g;function buildToken(builder,text,style,startStyle,endStyle){if(!text)return;if(!tokenSpecialChars.test(text)){builder.col+=text.length;var content=document.createTextNode(text)}else{var content=document.createDocumentFragment(),pos=0;while(true){tokenSpecialChars.lastIndex=pos;var m=tokenSpecialChars.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){content.appendChild(document.createTextNode(text.slice(pos,pos+skipped)));builder.col+=skipped}if(!m)break;pos+=skipped+1;if(m[0]==\"\t\"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;content.appendChild(elt(\"span\",spaceStr(tabWidth),\"cm-tab\"));builder.col+=tabWidth}else{var token=elt(\"span\",\"\",\"cm-invalidchar\");token.title=\"\\\\u\"+m[0].charCodeAt(0).toString(16);content.appendChild(token);builder.col+=1}}}if(style||startStyle||endStyle||builder.measure){var fullStyle=style||\"\";if(startStyle)fullStyle+=startStyle;if(endStyle)fullStyle+=endStyle;return builder.pre.appendChild(elt(\"span\",[content],fullStyle))}builder.pre.appendChild(content)}function buildTokenMeasure(builder,text,style,startStyle,endStyle){var wrapping=builder.cm.options.lineWrapping;for(var i=0;i<text.length;++i){var ch=text.charAt(i),start=i==0;if(ch>=\"\"&&ch<\"\"&&i<text.length-1){ch=text.slice(i,i+2);++i}else if(i&&wrapping&&spanAffectsWrapping(text,i)){builder.pre.appendChild(elt(\"wbr\"))}var span=builder.measure[builder.pos]=buildToken(builder,ch,style,start&&startStyle,i==text.length-1&&endStyle);if(ie&&wrapping&&ch==\" \"&&i&&!/\\s/.test(text.charAt(i-1))&&i<text.length-1&&!/\\s/.test(text.charAt(i+1)))span.style.whiteSpace=\"normal\";builder.pos+=ch.length}if(text.length)builder.addedOne=true}function buildTokenSplitSpaces(inner){function split(old){var out=\" \";for(var i=0;i<old.length-2;++i)out+=i%2?\" \":\"\";out+=\" \";return out}return function(builder,text,style,startStyle,endStyle){return inner(builder,text.replace(/ {3,}/,split),style,startStyle,endStyle)}}function buildCollapsedSpan(builder,size,widget){if(widget){if(!builder.display)widget=widget.cloneNode(true);builder.pre.appendChild(widget);if(builder.measure&&size){builder.measure[builder.pos]=widget;builder.addedOne=true}}builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans;if(!spans){for(var i=1;i<styles.length;i+=2)builder.addToken(builder,styles[i],styleToClass(styles[i+1]));return}var allText=line.text,len=allText.length;var pos=0,i=1,text=\"\",style;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,collapsed;for(;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=\"\";collapsed=null;nextChange=Infinity;var foundBookmark=null;for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(sp.from<=pos&&(sp.to==null||sp.to>pos)){if(sp.to!=null&&nextChange>sp.to){nextChange=sp.to;spanEndStyle=\"\"}if(m.className)spanStyle+=\" \"+m.className;if(m.startStyle&&sp.from==pos)spanStartStyle+=\" \"+m.startStyle;if(m.endStyle&&sp.to==nextChange)spanEndStyle+=\" \"+m.endStyle;if(m.collapsed&&(!collapsed||collapsed.marker.width<m.width))collapsed=sp}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from}if(m.type==\"bookmark\"&&sp.from==pos&&m.replacedWith)foundBookmark=m.replacedWith}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len:collapsed.to)-pos,collapsed.from!=null&&collapsed.marker.replacedWith);if(collapsed.to==null)return collapsed.marker.find()}if(foundBookmark&&!collapsed)buildCollapsedSpan(builder,0,foundBookmark)}if(pos>=len)break;var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:\"\")}if(end>=upto){text=text.slice(upto-pos);pos=upto;break}pos=end;spanStartStyle=\"\"}text=styles[i++];style=styleToClass(styles[i++])}}}function updateDoc(doc,change,markedSpans,selAfter,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,\"change\",line,change)}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(from.ch==0&&to.ch==0&&lastText==\"\"){for(var i=0,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));update(lastLine,lastLine.text,lastSpans);if(nlines)doc.remove(from.line,nlines);if(added.length)doc.insert(from.line,added)}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans)}else{for(var added=[],i=1,e=text.length-1;i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));added.push(makeLine(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added)}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines)}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);for(var i=1,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));if(nlines>1)doc.remove(from.line+1,nlines-1);doc.insert(from.line+1,added)}signalLater(doc,\"change\",doc,change);setSelection(doc,selAfter.anchor,selAfter.head,null,true)}function LeafChunk(lines){this.lines=lines;this.parent=null;for(var i=0,e=lines.length,height=0;i<e;++i){lines[i].parent=this;height+=lines[i].height}this.height=height}LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;cleanUpLine(line);signalLater(line,\"delete\")}this.lines.splice(at,n)},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines))},insertInner:function(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;i<e;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;at<e;++at)if(op(this.lines[at]))return true}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0,e=children.length;i<e;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this}this.size=size;this.height=height;this.parent=null}BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null}if((n-=rm)==0)break;at=0}else at-=sz}if(this.size-n<25){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this}},collapse:function(lines){for(var i=0,e=this.children.length;i<e;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){while(child.lines.length>50){var spilled=child.lines.splice(child.lines.length-25,25);var newleaf=new LeafChunk(spilled);child.height-=newleaf.height;this.children.splice(i+1,0,newleaf);newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(this.children.length<=10)return;var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()},iterN:function(at,n,op){for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return true;if((n-=used)==0)break;at=0}else at-=sz}}};var cantEdit_inatomic=1,cantEdit_keymap=2;var nextDocId=0;var Doc=CodeMirror.Doc=function(text,mode,firstLine){if(!(this instanceof Doc))return new Doc(text,mode,firstLine);if(firstLine==null)firstLine=0;BranchChunk.call(this,[new LeafChunk([makeLine(\"\",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=0;this.history=makeHistory();this.frontier=firstLine;var start=Pos(firstLine,0);this.sel={from:start,to:start,head:start,anchor:start,shift:false,extend:false,goalColumn:null};this.id=++nextDocId;this.modeOption=mode;if(typeof text==\"string\")text=splitLines(text);updateDoc(this,{from:start,to:start,text:text},null,{head:start,anchor:start})};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){if(op)this.iterN(from-this.first,to-from,op);else this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){var height=0;for(var i=0,e=lines.length;i<e;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false)return lines;return lines.join(lineSep||\"\\n\")},setValue:function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:splitLines(code),origin:\"setValue\"},{head:top,anchor:top},true)},replaceRange:function(code,from,to,origin){from=clipPos(this,from);to=to?clipPos(this,to):from;replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));if(lineSep===false)return lines;return lines.join(lineSep||\"\\n\")},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},setLine:function(line,text){if(isLine(this,line))replaceRange(this,text,Pos(line,0),clipPos(this,Pos(line)))},removeLine:function(line){if(line)replaceRange(this,\"\",clipPos(this,Pos(line-1)),clipPos(this,Pos(line)));else replaceRange(this,\"\",Pos(0,0),clipPos(this,Pos(1,0)))},getLineHandle:function(line){if(isLine(this,line))return getLine(this,line)},getLineNumber:function(line){return lineNo(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var sel=this.sel,pos;if(start==null||start==\"head\")pos=sel.head;else if(start==\"anchor\")pos=sel.anchor;else if(start==\"end\"||start===false)pos=sel.to;else pos=sel.from;return copyPos(pos)},somethingSelected:function(){return!posEq(this.sel.head,this.sel.anchor)},setCursor:docOperation(function(line,ch,extend){var pos=clipPos(this,typeof line==\"number\"?Pos(line,ch||0):line);if(extend)extendSelection(this,pos);else setSelection(this,pos,pos)}),setSelection:docOperation(function(anchor,head){setSelection(this,clipPos(this,anchor),clipPos(this,head||anchor))}),extendSelection:docOperation(function(from,to){extendSelection(this,clipPos(this,from),to&&clipPos(this,to))}),getSelection:function(lineSep){return this.getRange(this.sel.from,this.sel.to,lineSep)},replaceSelection:function(code,collapse,origin){makeChange(this,{from:this.sel.from,to:this.sel.to,text:splitLines(code),origin:origin},collapse||\"around\")},undo:docOperation(function(){makeChangeFromHistory(this,\"undo\")}),redo:docOperation(function(){makeChangeFromHistory(this,\"redo\")}),setExtending:function(val){this.sel.extend=val},historySize:function(){var hist=this.history;return{undo:hist.done.length,redo:hist.undone.length}},clearHistory:function(){this.history=makeHistory()},markClean:function(){this.history.dirtyCounter=0;this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return this.history.dirtyCounter==0},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=makeHistory();hist.done=histData.done.slice(0);hist.undone=histData.undone.slice(0)},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,\"range\")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft};pos=clipPos(this,pos);return markText(this,pos,pos,realOpts,\"bookmark\")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch))markers.push(span.marker.parent||span.marker)}return markers},getAllMarks:function(){var markers=[];this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)if(sps[i].from!=null)markers.push(sps[i].marker)});return markers},posFromIndex:function(off){var ch,lineNo=this.first;this.iter(function(line){var sz=line.text.length+1;if(sz>off){ch=off;return true}off-=sz;++lineNo});return clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0)return 0;this.iter(this.first,coords.line,function(line){index+=line.text.length+1});return index},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:false,goalColumn:this.sel.goalColumn};if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory())}return doc},linkedDoc:function(options){if(!options)options={};var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from)from=options.from;if(options.to!=null&&options.to<to)to=options.to;var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from);if(options.sharedHist)copy.history=this.history;(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];return copy},unlinkDoc:function(other){if(other instanceof CodeMirror)other=other.doc;if(this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc!=other)continue;this.linked.splice(i,1);other.unlinkDoc(this);break}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},true);other.history=makeHistory();other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate=\"iter insert remove copy getEditor\".split(\" \");for(var prop in Doc.prototype)if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0)CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]);function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip)continue;var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared)continue;f(rel.doc,shared);propagate(rel.doc,doc,shared)}}propagate(doc,null,true)}function attachDoc(cm,doc){if(doc.cm)throw new Error(\"This document is already in use.\");cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);if(!cm.options.lineWrapping)computeMaxLength(cm);cm.options.mode=doc.modeOption;if(keyMap[cm.options.keyMap].disableInput)doc.cantEdit|=cantEdit_keymap;else doc.cantEdit&=~cantEdit_keymap;regChange(cm)}function getLine(chunk,n){n-=chunk.first;while(!chunk.lines){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,function(line){var text=line.text;if(n==end.line)text=text.slice(0,end.ch);if(n==start.line)text=text.slice(start.ch);out.push(text);++n});return out}function getLines(doc,from,to){var out=[];doc.iter(from,to,function(line){out.push(line.text)});return out}function updateLineHeight(line,height){var diff=height-line.height;for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(line.parent==null)return null;var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize()}}return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0,e=chunk.children.length;i<e;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch;n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0,e=chunk.lines.length;i<e;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh}return n+i}function heightAtLine(cm,lineObj){lineObj=visualLine(cm.doc,lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;else h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;else h+=cur.height}}return h}function getOrder(line){var order=line.order;if(order==null)order=line.order=bidiOrdering(line.text);return order}function makeHistory(){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function attachLocalSpans(doc,change,from,to){var existing=change[\"spans_\"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){if(line.markedSpans)(existing||(existing=change[\"spans_\"+doc.id]={}))[n]=line.markedSpans;++n})}function historyChangeFromChange(doc,change){var histChange={from:change.from,to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},true);return histChange}function addToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur=lst(hist.done);if(cur&&(hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)==\"+\"&&doc.cm&&hist.lastTime>time-doc.cm.options.historyEventDelay||change.origin.charAt(0)==\"*\"))){var last=lst(cur.changes);if(posEq(change.from,change.to)&&posEq(change.from,last.to)){last.to=changeEnd(change)}else{cur.changes.push(historyChangeFromChange(doc,change))}cur.anchorAfter=selAfter.anchor;cur.headAfter=selAfter.head}else{cur={changes:[historyChangeFromChange(doc,change)],anchorBefore:doc.sel.anchor,headBefore:doc.sel.head,anchorAfter:selAfter.anchor,headAfter:selAfter.head};hist.done.push(cur);while(hist.done.length>hist.undoDepth)hist.done.shift();if(hist.dirtyCounter<0)hist.dirtyCounter=NaN;else hist.dirtyCounter++}hist.lastTime=time;hist.lastOp=opId;hist.lastOrigin=change.origin}function removeClearedSpans(spans){if(!spans)return null;for(var i=0,out;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out)out=spans.slice(0,i)}else if(out)out.push(spans[i])}return!out?spans:out.length?out:null}function getOldSpans(doc,change){var found=change[\"spans_\"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup){for(var i=0,copy=[];i<events.length;++i){var event=events[i],changes=event.changes,newChanges=[];copy.push({changes:newChanges,anchorBefore:event.anchorBefore,headBefore:event.headBefore,anchorAfter:event.anchorAfter,headAfter:event.headAfter});for(var j=0;j<changes.length;++j){var change=changes[j],m;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup)for(var prop in change)if(m=prop.match(/^spans_(\\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop]}}}}return copy}function rebaseHistSel(pos,from,to,diff){if(to<pos.line){pos.line+=diff}else if(from<pos.line){pos.line=from;pos.ch=0}}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(!sub.copied){cur.from=copyPos(cur.from);cur.to=copyPos(cur.to)}if(to<cur.from.line){cur.from.line+=diff;cur.to.line+=diff}else if(from<=cur.to.line){ok=false;break}}if(!sub.copied){sub.anchorBefore=copyPos(sub.anchorBefore);sub.headBefore=copyPos(sub.headBefore);sub.anchorAfter=copyPos(sub.anchorAfter);\nsub.readAfter=copyPos(sub.headAfter);sub.copied=true}if(!ok){array.splice(0,i+1);i=0}else{rebaseHistSel(sub.anchorBefore);rebaseHistSel(sub.headBefore);rebaseHistSel(sub.anchorAfter);rebaseHistSel(sub.headAfter)}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff)}function stopMethod(){e_stop(this)}function addStop(event){if(!event.stop)event.stop=stopMethod;return event}function e_preventDefault(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false}function e_stopPropagation(e){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true}function e_stop(e){e_preventDefault(e);e_stopPropagation(e)}CodeMirror.e_stop=e_stop;CodeMirror.e_preventDefault=e_preventDefault;CodeMirror.e_stopPropagation=e_stopPropagation;function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;if(b==null){if(e.button&1)b=1;else if(e.button&2)b=3;else if(e.button&4)b=2}if(mac&&e.ctrlKey&&b==1)b=3;return b}function on(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,false);else if(emitter.attachEvent)emitter.attachEvent(\"on\"+type,f);else{var map=emitter._handlers||(emitter._handlers={});var arr=map[type]||(map[type]=[]);arr.push(f)}}function off(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,false);else if(emitter.detachEvent)emitter.detachEvent(\"on\"+type,f);else{var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;for(var i=0;i<arr.length;++i)if(arr[i]==f){arr.splice(i,1);break}}}function signal(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<arr.length;++i)arr[i].apply(null,args)}var delayedCallbacks,delayedCallbackDepth=0;function signalLater(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);if(!delayedCallbacks){++delayedCallbackDepth;delayedCallbacks=[];setTimeout(fireDelayed,0)}function bnd(f){return function(){f.apply(null,args)}}for(var i=0;i<arr.length;++i)delayedCallbacks.push(bnd(arr[i]))}function fireDelayed(){--delayedCallbackDepth;var delayed=delayedCallbacks;delayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function hasHandler(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];return arr&&arr.length>0}CodeMirror.on=on;CodeMirror.off=off;CodeMirror.signal=signal;var scrollerCutOff=30;var Pass=CodeMirror.Pass={toString:function(){return\"CodeMirror.Pass\"}};function Delayed(){this.id=null}Delayed.prototype={set:function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms)}};function countColumn(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\\s\\u00a0]/);if(end==-1)end=string.length}for(var i=startIndex||0,n=startValue||0;i<end;++i){if(string.charAt(i)==\"\t\")n+=tabSize-n%tabSize;else++n}return n}CodeMirror.countColumn=countColumn;var spaceStrs=[\"\"];function spaceStr(n){while(spaceStrs.length<=n)spaceStrs.push(lst(spaceStrs)+\" \");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function selectInput(node){if(ios){node.selectionStart=0;node.selectionEnd=node.value.length}else node.select()}function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;i<e;++i)if(collection[i]==elt)return i;return-1}function createObj(base,props){function Obj(){}Obj.prototype=base;var inst=new Obj;if(props)copyObj(props,inst);return inst}function copyObj(obj,target){if(!target)target={};for(var prop in obj)if(obj.hasOwnProperty(prop))target[prop]=obj[prop];return target}function emptyArray(size){for(var a=[],i=0;i<size;++i)a.push(undefined);return a}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}var nonASCIISingleCaseWordChar=/[\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;function isWordChar(ch){return/\\w/.test(ch)||ch>\"\"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return false;return true}var isExtendingChar=/[\\u0300-\\u036F\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1-\\u05C2\\u05C4-\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7-\\u06E8\\u06EA-\\u06ED\\uA66F\\uA670-\\uA672\\uA674-\\uA67D\\uA69F\\udc00-\\udfff]/;function elt(tag,content,className,style){var e=document.createElement(tag);if(className)e.className=className;if(style)e.style.cssText=style;if(typeof content==\"string\")setTextContent(e,content);else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function setTextContent(e,str){if(ie_lt9){e.innerHTML=\"\";e.appendChild(document.createTextNode(str))}else e.textContent=str}function getRect(node){return node.getBoundingClientRect()}CodeMirror.replaceGetRect=function(f){getRect=f};var dragAndDrop=function(){if(ie_lt9)return false;var div=elt(\"div\");return\"draggable\"in div||\"dragDrop\"in div}();function spanAffectsWrapping(){return false}if(gecko)spanAffectsWrapping=function(str,i){return str.charCodeAt(i-1)==36&&str.charCodeAt(i)==39};else if(safari&&!/Version\\/([6-9]|\\d\\d)\\b/.test(navigator.userAgent))spanAffectsWrapping=function(str,i){return/\\-[^ \\-?]|\\?[^ !\\'\\\"\\),.\\-\\/:;\\?\\]\\}]/.test(str.slice(i-1,i+1))};else if(webkit)spanAffectsWrapping=function(str,i){if(i>1&&str.charCodeAt(i-1)==45&&/\\w/.test(str.charAt(i-2))&&/[^\\-?\\.]/.test(str.charAt(i)))return true;return/[~!#%&*)=+}\\]|\\\"\\.>,:;][({[<]|-[^\\-?\\.\\u2010-\\u201f\\u2026]|\\?[\\w~`@#$%\\^&*(_=+{[|><]|[\\w~`@#$%\\^&*(_=+{[><]/.test(str.slice(i-1,i+1))};var knownScrollbarWidth;function scrollbarWidth(measure){if(knownScrollbarWidth!=null)return knownScrollbarWidth;var test=elt(\"div\",null,null,\"width: 50px; height: 50px; overflow-x: scroll\");removeChildrenAndAdd(measure,test);if(test.offsetWidth)knownScrollbarWidth=test.offsetHeight-test.clientHeight;return knownScrollbarWidth||0}var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt(\"span\",\"\");removeChildrenAndAdd(measure,elt(\"span\",[test,document.createTextNode(\"x\")]));if(measure.firstChild.offsetHeight!=0)zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!ie_lt8}if(zwspSupported)return elt(\"span\",\"\");else return elt(\"span\",\"\",null,\"display: inline-block; width: 1px; margin-right: -1px\")}var splitLines=\"\\n\\nb\".split(/\\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf(\"\\n\",pos);if(nl==-1)nl=string.length;var line=string.slice(pos,string.charAt(nl-1)==\"\\r\"?nl-1:nl);var rt=line.indexOf(\"\\r\");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1}else{result.push(line);pos=nl+1}}return result}:function(string){return string.split(/\\r\\n?|\\n/)};CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return false}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}if(!range||range.parentElement()!=te)return false;return range.compareEndPoints(\"StartToEnd\",range)!=0};var hasCopyEvent=function(){var e=elt(\"div\");if(\"oncopy\"in e)return true;e.setAttribute(\"oncopy\",\"return;\");return typeof e.oncopy==\"function\"}();var keyNames={3:\"Enter\",8:\"Backspace\",9:\"Tab\",13:\"Enter\",16:\"Shift\",17:\"Ctrl\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Esc\",32:\"Space\",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"Left\",38:\"Up\",39:\"Right\",40:\"Down\",44:\"PrintScrn\",45:\"Insert\",46:\"Delete\",59:\";\",91:\"Mod\",92:\"Mod\",93:\"Mod\",109:\"-\",107:\"=\",127:\"Delete\",186:\";\",187:\"=\",188:\",\",189:\"-\",190:\".\",191:\"/\",192:\"`\",219:\"[\",220:\"\\\\\",221:\"]\",222:\"'\",63276:\"PageUp\",63277:\"PageDown\",63275:\"End\",63273:\"Home\",63234:\"Left\",63232:\"Up\",63235:\"Right\",63233:\"Down\",63302:\"Insert\",63272:\"Delete\"};CodeMirror.keyNames=keyNames;(function(){for(var i=0;i<10;i++)keyNames[i+48]=String(i);for(var i=65;i<=90;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;i<=12;i++)keyNames[i+111]=keyNames[i+63235]=\"F\"+i})();function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,\"ltr\");for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from)f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?\"rtl\":\"ltr\")}}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);if(!order)return line.text.length;return bidiRight(lst(order))}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(cm.doc,line);if(visual!=line)lineN=lineNo(visual);var order=getOrder(visual);var ch=!order?0:order[0].level%2?lineRight(visual):lineLeft(visual);return Pos(lineN,ch)}function lineEnd(cm,lineN){var merged,line;while(merged=collapsedSpanAtEnd(line=getLine(cm.doc,lineN)))lineN=merged.find().to.line;var order=getOrder(line);var ch=!order?line.text.length:order[0].level%2?lineLeft(line):lineRight(line);return Pos(lineN,ch)}function compareBidiLevel(order,a,b){var linedir=order[0].level;if(a==linedir)return true;if(b==linedir)return false;return a<b}var bidiOther;function getBidiPartAt(order,pos){for(var i=0,found;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos){bidiOther=null;return i}if(cur.from==pos||cur.to==pos){if(found==null){found=i}else if(compareBidiLevel(order,cur.level,order[found].level)){bidiOther=found;return i}else{bidiOther=i;return found}}}bidiOther=null;return found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(pos>0&&isExtendingChar.test(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);var pos=getBidiPartAt(bidi,start),part=bidi[pos];var target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);for(;;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to){if(getBidiPartAt(bidi,target)==pos)return target;part=bidi[pos+=dir];return dir>0==part.level%2?part.to:part.from}else{part=bidi[pos+=dir];if(!part)return null;if(dir>0==part.level%2)target=moveInLine(line,part.to,-1,byUnit);else target=moveInLine(line,part.from,1,byUnit)}}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)while(target>0&&isExtendingChar.test(line.text.charAt(target)))target+=dir;return target<0||target>line.text.length?null:target}var bidiOrdering=function(){var lowTypes=\"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL\";var arabicTypes=\"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr\";function charType(code){if(code<=255)return lowTypes.charAt(code);else if(1424<=code&&code<=1524)return\"R\";else if(1536<=code&&code<=1791)return arabicTypes.charAt(code-1536);else if(1792<=code&&code<=2220)return\"r\";else return\"L\"}var bidiRE=/[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;var outerType=\"L\";return function(str){if(!bidiRE.test(str))return false;var len=str.length,types=[];for(var i=0,type;i<len;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;i<len;++i){var type=types[i];if(type==\"m\")types[i]=prev;else prev=type}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(type==\"1\"&&cur==\"r\")types[i]=\"n\";else if(isStrong.test(type)){cur=type;if(type==\"r\")types[i]=\"R\"}}for(var i=1,prev=types[0];i<len-1;++i){var type=types[i];if(type==\"+\"&&prev==\"1\"&&types[i+1]==\"1\")types[i]=\"1\";else if(type==\",\"&&prev==types[i+1]&&(prev==\"1\"||prev==\"n\"))types[i]=prev;prev=type}for(var i=0;i<len;++i){var type=types[i];if(type==\",\")types[i]=\"N\";else if(type==\"%\"){for(var end=i+1;end<len&&types[end]==\"%\";++end){}var replace=i&&types[i-1]==\"!\"||end<len-1&&types[end]==\"1\"?\"1\":\"N\";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(cur==\"L\"&&type==\"1\")types[i]=\"L\";else if(isStrong.test(type))cur=type}for(var i=0;i<len;++i){if(isNeutral.test(types[i])){for(var end=i+1;end<len&&isNeutral.test(types[end]);++end){}var before=(i?types[i-1]:outerType)==\"L\";var after=(end<len-1?types[end]:outerType)==\"L\";var replace=before||after?\"L\":\"R\";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}var order=[],m;for(var i=0;i<len;){if(countsAsLeft.test(types[i])){var start=i;for(++i;i<len&&countsAsLeft.test(types[i]);++i){}order.push({from:start,to:i,level:0})}else{var pos=i,at=order.length;for(++i;i<len&&types[i]!=\"L\";++i){}for(var j=pos;j<i;){if(countsAsNum.test(types[j])){if(pos<j)order.splice(at,0,{from:pos,to:j,level:1});var nstart=j;for(++j;j<i&&countsAsNum.test(types[j]);++j){}order.splice(at,0,{from:nstart,to:j,level:2});pos=j}else++j}if(pos<i)order.splice(at,0,{from:pos,to:i,level:1})}}if(order[0].level==1&&(m=str.match(/^\\s+/))){order[0].from=m[0].length;order.unshift({from:0,to:m[0].length,level:0})}if(lst(order).level==1&&(m=str.match(/\\s+$/))){lst(order).to-=m[0].length;order.push({from:len-m[0].length,to:len,level:0})}if(order[0].level!=lst(order).level)order.push({from:len,to:len,level:order[0].level});return order}}();CodeMirror.version=\"3.13 +\";return CodeMirror}();var Lawnchair=function(options,callback){if(!(this instanceof Lawnchair))return new Lawnchair(options,callback);if(!JSON)throw\"JSON unavailable! Include http://www.json.org/json2.js to fix.\";if(arguments.length<=2){callback=typeof arguments[0]===\"function\"?arguments[0]:arguments[1];options=typeof arguments[0]===\"function\"?{}:arguments[0]||{}}else{throw\"Incorrect # of ctor args!\"}this.record=options.record||\"record\";this.name=options.name||\"records\";var adapter;if(options.adapter){if(typeof options.adapter===\"string\"){options.adapter=[options.adapter]}for(var j=0,k=options.adapter.length;j<k;j++){for(var i=Lawnchair.adapters.length-1;i>=0;i--){if(Lawnchair.adapters[i].adapter===options.adapter[j]){adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:undefined;if(adapter)break}}if(adapter)break}}else{for(var i=0,l=Lawnchair.adapters.length;i<l;i++){adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:undefined;if(adapter)break}}if(!adapter)throw\"No valid adapter.\";for(var j in adapter)this[j]=adapter[j];for(var i=0,l=Lawnchair.plugins.length;i<l;i++)Lawnchair.plugins[i].call(this);this.init(options,callback)};Lawnchair.adapters=[];Lawnchair.adapter=function(id,obj){obj[\"adapter\"]=id;var implementing=\"adapter valid init keys save batch get exists all remove nuke\".split(\" \"),indexOf=this.prototype.indexOf;for(var i in obj){if(indexOf(implementing,i)===-1)throw\"Invalid adapter! Nonstandard method: \"+i}Lawnchair.adapters.splice(0,0,obj)};Lawnchair.plugins=[];Lawnchair.plugin=function(obj){for(var i in obj)i===\"init\"?Lawnchair.plugins.push(obj[i]):this.prototype[i]=obj[i]};Lawnchair.prototype={isArray:Array.isArray||function(o){return Object.prototype.toString.call(o)===\"[object Array]\"},indexOf:function(ary,item,i,l){if(ary.indexOf)return ary.indexOf(item);for(i=0,l=ary.length;i<l;i++)if(ary[i]===item)return i;return-1},lambda:function(callback){return this.fn(this.record,callback)},fn:function(name,callback){return typeof callback==\"string\"?new Function(name,callback):callback},uuid:function(){var S4=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4()},each:function(callback){var cb=this.lambda(callback);if(this.__results){for(var i=0,l=this.__results.length;i<l;i++)cb.call(this,this.__results[i],i)}else{this.all(function(r){for(var i=0,l=r.length;i<l;i++)cb.call(this,r[i],i)})}return this}};Lawnchair.adapter(\"window-name\",function(){if(typeof window===\"undefined\"){window={top:{}}}var data={};try{data=JSON.parse(window.top.name)}catch(e){}return{valid:function(){return typeof window.top.name!=\"undefined\"},init:function(options,callback){data[this.name]=data[this.name]||{index:[],store:{}};this.index=data[this.name].index;this.store=data[this.name].store;this.fn(this.name,callback).call(this,this);return this},keys:function(callback){this.fn(\"keys\",callback).call(this,this.index);return this},save:function(obj,cb){var key=obj.key||this.uuid();this.exists(key,function(exists){if(!exists){if(obj.key)delete obj.key;this.index.push(key)}this.store[key]=obj;try{window.top.name=JSON.stringify(data)}catch(e){if(!exists){this.index.pop();delete this.store[key]}throw e}if(cb){obj.key=key;this.lambda(cb).call(this,obj)}});return this},batch:function(objs,cb){var r=[];for(var i=0,l=objs.length;i<l;i++){this.save(objs[i],function(record){r.push(record)})}if(cb)this.lambda(cb).call(this,r);return this},get:function(keyOrArray,cb){var r;if(this.isArray(keyOrArray)){r=[];for(var i=0,l=keyOrArray.length;i<l;i++){r.push(this.store[keyOrArray[i]])}}else{r=this.store[keyOrArray];if(r)r.key=keyOrArray}if(cb)this.lambda(cb).call(this,r);return this},exists:function(key,cb){this.lambda(cb).call(this,!!this.store[key]);return this},all:function(cb){var r=[];for(var i=0,l=this.index.length;i<l;i++){var obj=this.store[this.index[i]];obj.key=this.index[i];r.push(obj)}this.fn(this.name,cb).call(this,r);return this},remove:function(keyOrArray,cb){var del=this.isArray(keyOrArray)?keyOrArray:[keyOrArray];for(var i=0,l=del.length;i<l;i++){var key=del[i].key?del[i].key:del[i];var where=this.indexOf(this.index,key);if(where<0)continue;delete this.store[key];this.index.splice(where,1)}window.top.name=JSON.stringify(data);if(cb)this.lambda(cb).call(this);return this},nuke:function(cb){this.store=data[this.name].store={};this.index=data[this.name].index=[];window.top.name=JSON.stringify(data);if(cb)this.lambda(cb).call(this);return this}}}());Lawnchair.adapter(\"dom\",function(){var storage=window.localStorage;var indexer=function(name){return{key:name+\"._index_\",all:function(){var a=storage.getItem(JSON.stringify(this.key));if(a){a=JSON.parse(a)}if(a===null)storage.setItem(JSON.stringify(this.key),JSON.stringify([]));return JSON.parse(storage.getItem(JSON.stringify(this.key)))},add:function(key){var a=this.all();a.push(key);storage.setItem(JSON.stringify(this.key),JSON.stringify(a))},del:function(key){var a=this.all(),r=[];for(var i=0,l=a.length;i<l;i++){if(a[i]!=key)r.push(a[i])}storage.setItem(JSON.stringify(this.key),JSON.stringify(r))},find:function(key){var a=this.all();for(var i=0,l=a.length;i<l;i++){if(key===a[i])return i}return false}}};return{valid:function(){return!!storage&&function(){var success=true;var value=Math.random();try{storage.setItem(value,value)}catch(e){success=false}storage.removeItem(value);return success}()},init:function(options,callback){this.indexer=indexer(this.name);if(callback)this.fn(this.name,callback).call(this,this)},save:function(obj,callback){var key=obj.key?this.name+\".\"+obj.key:this.name+\".\"+this.uuid();delete obj.key;storage.setItem(key,JSON.stringify(obj));if(this.indexer.find(key)===false)this.indexer.add(key);obj.key=key.slice(this.name.length+1);if(callback){this.lambda(callback).call(this,obj)}return this},batch:function(ary,callback){var saved=[];for(var i=0,l=ary.length;i<l;i++){this.save(ary[i],function(r){saved.push(r)})}if(callback)this.lambda(callback).call(this,saved);return this},keys:function(callback){if(callback){var name=this.name;var indices=this.indexer.all();var keys=[];if(Array.prototype.map){keys=indices.map(function(r){return r.replace(name+\".\",\"\")})}else{for(var key in indices){keys.push(key.replace(name+\".\",\"\"))}}this.fn(\"keys\",callback).call(this,keys)}return this},get:function(key,callback){if(this.isArray(key)){var r=[];for(var i=0,l=key.length;i<l;i++){var k=this.name+\".\"+key[i];var obj=storage.getItem(k);if(obj){obj=JSON.parse(obj);obj.key=key[i]}r.push(obj)}if(callback)this.lambda(callback).call(this,r)}else{var k=this.name+\".\"+key;var obj=storage.getItem(k);if(obj){obj=JSON.parse(obj);obj.key=key}if(callback)this.lambda(callback).call(this,obj)}return this},exists:function(key,cb){var exists=this.indexer.find(this.name+\".\"+key)===false?false:true;this.lambda(cb).call(this,exists);return this},all:function(callback){var idx=this.indexer.all(),r=[],o,k;for(var i=0,l=idx.length;i<l;i++){k=idx[i];o=JSON.parse(storage.getItem(k));o.key=k.replace(this.name+\".\",\"\");r.push(o)}if(callback)this.fn(this.name,callback).call(this,r);return this},remove:function(keyOrArray,callback){var self=this;if(this.isArray(keyOrArray)){var i,done=keyOrArray.length;var removeOne=function(i){self.remove(keyOrArray[i],function(){if(--done>0){return}if(callback){self.lambda(callback).call(self)}})};for(i=0;i<keyOrArray.length;i++)removeOne(i);return this}var key=this.name+\".\"+(keyOrArray.key?keyOrArray.key:keyOrArray);this.indexer.del(key);storage.removeItem(key);if(callback)this.lambda(callback).call(this);return this},nuke:function(callback){this.all(function(r){for(var i=0,l=r.length;i<l;i++){this.remove(r[i])}if(callback)this.lambda(callback).call(this)});return this}}}());(function(){var ie_lt8=/MSIE \\d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var Pos=CodeMirror.Pos;var matching={\"(\":\")>\",\")\":\"(<\",\"[\":\"]>\",\"]\":\"[<\",\"{\":\"}>\",\"}\":\"{<\"};function findMatchingBracket(cm){var maxScanLen=cm.state._matchBrackets.maxScanLineLength||1e4;var cur=cm.getCursor(),line=cm.getLineHandle(cur.line),pos=cur.ch-1;var match=pos>=0&&matching[line.text.charAt(pos)]||matching[line.text.charAt(++pos)];if(!match)return null;var forward=match.charAt(1)==\">\",d=forward?1:-1;var style=cm.getTokenAt(Pos(cur.line,pos+1)).type;var stack=[line.text.charAt(pos)],re=/[(){}[\\]]/;function scan(line,lineNo,start){if(!line.text)return;var pos=forward?0:line.text.length-1,end=forward?line.text.length:-1;if(line.text.length>maxScanLen)return null;var checkTokenStyles=line.text.length<1e3;if(start!=null)pos=start+d;for(;pos!=end;pos+=d){var ch=line.text.charAt(pos);if(re.test(ch)&&(!checkTokenStyles||cm.getTokenAt(Pos(lineNo,pos+1)).type==style)){var match=matching[ch];if(match.charAt(1)==\">\"==forward)stack.push(ch);else if(stack.pop()!=match.charAt(0))return{pos:pos,match:false};else if(!stack.length)return{pos:pos,match:true}}}}for(var i=cur.line,found,e=forward?Math.min(i+100,cm.lineCount()):Math.max(-1,i-100);i!=e;i+=d){if(i==cur.line)found=scan(line,i,pos);else found=scan(cm.getLineHandle(i),i);if(found)break}return{from:Pos(cur.line,pos),to:found&&Pos(i,found.pos),match:found&&found.match}}function matchBrackets(cm,autoclear){var maxHighlightLen=cm.state._matchBrackets.maxHighlightLineLength||1e3;var found=findMatchingBracket(cm);if(!found||cm.getLine(found.from.line).length>maxHighlightLen||found.to&&cm.getLine(found.to.line).length>maxHighlightLen)return;var style=found.match?\"CodeMirror-matchingbracket\":\"CodeMirror-nonmatchingbracket\";var one=cm.markText(found.from,Pos(found.from.line,found.from.ch+1),{className:style});var two=found.to&&cm.markText(found.to,Pos(found.to.line,found.to.ch+1),{className:style});if(ie_lt8&&cm.state.focused)cm.display.input.focus();var clear=function(){cm.operation(function(){one.clear();two&&two.clear()})};if(autoclear)setTimeout(clear,800);else return clear}var currentlyHighlighted=null;function doMatchBrackets(cm){cm.operation(function(){if(currentlyHighlighted){currentlyHighlighted();currentlyHighlighted=null}if(!cm.somethingSelected())currentlyHighlighted=matchBrackets(cm,false)})}CodeMirror.defineOption(\"matchBrackets\",false,function(cm,val,old){if(old&&old!=CodeMirror.Init)cm.off(\"cursorActivity\",doMatchBrackets);if(val){cm.state._matchBrackets=typeof val==\"object\"?val:{};cm.on(\"cursorActivity\",doMatchBrackets)}});CodeMirror.defineExtension(\"matchBrackets\",function(){matchBrackets(this,true)});CodeMirror.defineExtension(\"findMatchingBracket\",function(){return findMatchingBracket(this)})})();(function($){if(typeof $.fn.each2==\"undefined\"){$.fn.extend({each2:function(c){var j=$([0]),i=-1,l=this.length;while(++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==false);return this}})}})(jQuery);(function($,undefined){\"use strict\";if(window.Select2!==undefined){return}var KEY,AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer;KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){k=k.which?k.which:k;switch(k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return true}return false},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return true}if(e.metaKey)return true;return false},isFunctionKey:function(k){k=k.which?k.which:k;return k>=112&&k<=123}};nextUid=function(){var counter=1;return function(){return counter++}}();function indexOf(value,array){var i=0,l=array.length,v;if(typeof value===\"undefined\"){return-1}if(value.constructor===String){for(;i<l;i=i+1)if(value.localeCompare(array[i])===0)return i}else{for(;i<l;i=i+1){v=array[i];if(v.constructor===String){if(v.localeCompare(value)===0)return i}else{if(v===value)return i}}}return-1}function equal(a,b){if(a===b)return true;if(a===undefined||b===undefined)return false;if(a===null||b===null)return false;if(a.constructor===String)return a.localeCompare(b)===0;if(b.constructor===String)return b.localeCompare(a)===0;return false}function splitVal(string,separator){var val,i,l;if(string===null||string.length<1)return[];val=string.split(separator);for(i=0,l=val.length;i<l;i=i+1)val[i]=$.trim(val[i]);return val}function getSideBorderPadding(element){return element.outerWidth()-element.width()}function installKeyUpChangeEvent(element){var key=\"keyup-change-value\";element.bind(\"keydown\",function(){if($.data(element,key)===undefined){$.data(element,key,element.val())}});element.bind(\"keyup\",function(){var val=$.data(element,key);if(val!==undefined&&element.val()!==val){$.removeData(element,key);element.trigger(\"keyup-change\")}})}$(document).delegate(\"body\",\"mousemove\",function(e){$.data(document,\"select2-lastpos\",{x:e.pageX,y:e.pageY})});function installFilteredMouseMove(element){element.bind(\"mousemove\",function(e){var lastpos=$.data(document,\"select2-lastpos\");if(lastpos===undefined||lastpos.x!==e.pageX||lastpos.y!==e.pageY){$(e.target).trigger(\"mousemove-filtered\",e)}})}function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(ctx,args)},quietMillis)}}function thunk(formula){var evaluated=false,value;return function(){if(evaluated===false){value=formula();evaluated=true}return value}}function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger(\"scroll-debounced\",e)});element.bind(\"scroll\",function(e){if(indexOf(e.target,element.get())>=0)notify(e)})}function killEvent(event){event.preventDefault();event.stopPropagation()}function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$(\"<div></div>\").css({position:\"absolute\",left:\"-10000px\",top:\"-10000px\",display:\"none\",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:\"nowrap\"});$(\"body\").append(sizer)}sizer.text(e.val());return sizer.width()}function markMatch(text,term,markup){var match=text.toUpperCase().indexOf(term.toUpperCase()),tl=term.length;if(match<0){markup.push(text);return}markup.push(text.substring(0,match));markup.push(\"<span class='select2-match'>\");markup.push(text.substring(match,match+tl));markup.push(\"</span>\");markup.push(text.substring(match+tl,text.length))}function ajax(options){var timeout,requestSequence=0,handler=null,quietMillis=options.quietMillis||100;return function(query){window.clearTimeout(timeout);timeout=window.setTimeout(function(){requestSequence+=1;var requestNumber=requestSequence,data=options.data,transport=options.transport||$.ajax,traditional=options.traditional||false,type=options.type||\"GET\";data=data.call(this,query.term,query.page,query.context);if(null!==handler){handler.abort()}handler=transport.call(null,{url:options.url,dataType:options.dataType,data:data,type:type,traditional:traditional,success:function(data){if(requestNumber<requestSequence){return}var results=options.results(data,query.page);query.callback(results)}})},quietMillis)}}function local(options){var data=options,dataText,text=function(item){return\"\"+item.text};if(!$.isArray(data)){text=data.text;if(!$.isFunction(text)){dataText=data.text;text=function(item){return item[dataText]}}data=data.results}return function(query){var t=query.term,filtered={results:[]},process;if(t===\"\"){query.callback({results:data});return}process=function(datum,collection){var group,attr;datum=datum[0];if(datum.children){group={};for(attr in datum){if(datum.hasOwnProperty(attr))group[attr]=datum[attr]}group.children=[];$(datum.children).each2(function(i,childDatum){process(childDatum,group.children)});if(group.children.length){collection.push(group)}}else{if(query.matcher(t,text(datum))){collection.push(datum)}}};$(data).each2(function(i,datum){process(datum,filtered.results)});query.callback(filtered)}}function tags(data){if($.isFunction(data)){return data}return function(query){var t=query.term,filtered={results:[]};$(data).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;if(t===\"\"||query.matcher(t,text)){filtered.results.push(isObject?this:{id:this,text:this})}});query.callback(filtered)}}function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return true;if(!formatter)return false;throw new Error(\"formatterName must be a function or a falsy value\")}function evaluate(val){return $.isFunction(val)?val():val}function countResults(results){var count=0;$.each(results,function(i,item){if(item.children){count+=countResults(item.children)}else{count++}});return count}function defaultTokenizer(input,selection,selectCallback,opts){var original=input,dupe=false,token,index,i,l,separator;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;while(true){index=-1;for(i=0,l=opts.tokenSeparators.length;i<l;i++){separator=opts.tokenSeparators[i];index=input.indexOf(separator);if(index>=0)break}if(index<0)break;token=input.substring(0,index);input=input.substring(index+separator.length);if(token.length>0){token=opts.createSearchChoice(token,selection);if(token!==undefined&&token!==null&&opts.id(token)!==undefined&&opts.id(token)!==null){dupe=false;for(i=0,l=selection.length;i<l;i++){if(equal(opts.id(token),opts.id(selection[i]))){dupe=true;break}}if(!dupe)selectCallback(token)}}}if(original.localeCompare(input)!=0)return input}$(document).ready(function(){$(document).delegate(\"body\",\"mousedown touchend\",function(e){var target=$(e.target).closest(\"div.select2-container\").get(0),attr;if(target){$(document).find(\"div.select2-container-active\").each(function(){if(this!==target)$(this).data(\"select2\").blur()})}else{target=$(e.target).closest(\"div.select2-drop\").get(0);$(document).find(\"div.select2-drop-active\").each(function(){if(this!==target)$(this).data(\"select2\").blur()})}target=$(e.target);attr=target.attr(\"for\");if(\"LABEL\"===e.target.tagName&&attr&&attr.length>0){target=$(\"#\"+attr);\ntarget=target.data(\"select2\");if(target!==undefined){target.focus();e.preventDefault()}}})});function clazz(SuperClass,methods){var constructor=function(){};constructor.prototype=new SuperClass;constructor.prototype.constructor=constructor;constructor.prototype.parent=SuperClass.prototype;constructor.prototype=$.extend(constructor.prototype,methods);return constructor}AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments)}},init:function(opts){var results,search,resultsSelector=\".select2-results\";this.opts=opts=this.prepareOpts(opts);this.id=opts.id;if(opts.element.data(\"select2\")!==undefined&&opts.element.data(\"select2\")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId=\"s2id_\"+(opts.element.attr(\"id\")||\"autogen\"+nextUid());this.containerSelector=\"#\"+this.containerId.replace(/([;&,\\.\\+\\*\\~':\"\\!\\^#$%@\\[\\]\\(\\)=>\\|])/g,\"\\\\$1\");this.container.attr(\"id\",this.containerId);this.body=thunk(function(){return opts.element.closest(\"body\")});if(opts.element.attr(\"class\")!==undefined){this.container.addClass(opts.element.attr(\"class\").replace(/validate\\[[\\S ]+] ?/,\"\"))}this.container.css(evaluate(opts.containerCss));this.container.addClass(evaluate(opts.containerCssClass));this.opts.element.data(\"select2\",this).hide().before(this.container);this.container.data(\"select2\",this);this.dropdown=this.container.find(\".select2-drop\");this.dropdown.addClass(evaluate(opts.dropdownCssClass));this.dropdown.data(\"select2\",this);this.results=results=this.container.find(resultsSelector);this.search=search=this.container.find(\"input.select2-input\");search.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();installFilteredMouseMove(this.results);this.dropdown.delegate(resultsSelector,\"mousemove-filtered\",this.bind(this.highlightUnderEvent));installDebouncedScroll(80,this.results);this.dropdown.delegate(resultsSelector,\"scroll-debounced\",this.bind(this.loadMoreIfNeeded));if($.fn.mousewheel){results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop(),height;if(deltaY>0&&top-deltaY<=0){results.scrollTop(0);killEvent(e)}else if(deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()){results.scrollTop(results.get(0).scrollHeight-results.height());killEvent(e)}})}installKeyUpChangeEvent(search);search.bind(\"keyup-change\",this.bind(this.updateResults));search.bind(\"focus\",function(){search.addClass(\"select2-focused\");if(search.val()===\" \")search.val(\"\")});search.bind(\"blur\",function(){search.removeClass(\"select2-focused\")});this.dropdown.delegate(resultsSelector,\"mouseup\",this.bind(function(e){if($(e.target).closest(\".select2-result-selectable:not(.select2-disabled)\").length>0){this.highlightUnderEvent(e);this.selectHighlighted(e)}else{this.focusSearch()}killEvent(e)}));this.dropdown.bind(\"click mouseup mousedown\",function(e){e.stopPropagation()});if($.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(opts.element.is(\":disabled\")||opts.element.is(\"[readonly='readonly']\"))this.disable()},destroy:function(){var select2=this.opts.element.data(\"select2\");if(select2!==undefined){select2.container.remove();select2.dropdown.remove();select2.opts.element.removeData(\"select2\").unbind(\".select2\").show()}},prepareOpts:function(opts){var element,select,idKey,ajaxUrl;element=opts.element;if(element.get(0).tagName.toLowerCase()===\"select\"){this.select=select=opts.element}if(select){$.each([\"id\",\"multiple\",\"ajax\",\"query\",\"createSearchChoice\",\"initSelection\",\"data\",\"tags\"],function(){if(this in opts){throw new Error(\"Option '\"+this+\"' is not allowed for Select2 when attached to a <select> element.\")}})}opts=$.extend({},{populateResults:function(container,results,query){var populate,data,result,children,id=this.opts.id,self=this;populate=function(results,container,depth){var i,l,result,selectable,compound,node,label,innerContainer,formatted;for(i=0,l=results.length;i<l;i=i+1){result=results[i];selectable=id(result)!==undefined;compound=result.children&&result.children.length>0;node=$(\"<li></li>\");node.addClass(\"select2-results-dept-\"+depth);node.addClass(\"select2-result\");node.addClass(selectable?\"select2-result-selectable\":\"select2-result-unselectable\");if(compound){node.addClass(\"select2-result-with-children\")}node.addClass(self.opts.formatResultCssClass(result));label=$(\"<div></div>\");label.addClass(\"select2-result-label\");formatted=opts.formatResult(result,label,query);if(formatted!==undefined){label.html(self.opts.escapeMarkup(formatted))}node.append(label);if(compound){innerContainer=$(\"<ul></ul>\");innerContainer.addClass(\"select2-result-sub\");populate(result.children,innerContainer,depth+1);node.append(innerContainer)}node.data(\"select2-data\",result);container.append(node)}};populate(results,container,0)}},$.fn.select2.defaults,opts);if(typeof opts.id!==\"function\"){idKey=opts.id;opts.id=function(e){return e[idKey]}}if(select){opts.query=this.bind(function(query){var data={results:[],more:false},term=query.term,children,firstChild,process;process=function(element,collection){var group;if(element.is(\"option\")){if(query.matcher(term,element.text(),element)){collection.push({id:element.attr(\"value\"),text:element.text(),element:element.get(),css:element.attr(\"class\")})}}else if(element.is(\"optgroup\")){group={text:element.attr(\"label\"),children:[],element:element.get(),css:element.attr(\"class\")};element.children().each2(function(i,elm){process(elm,group.children)});if(group.children.length>0){collection.push(group)}}};children=element.children();if(this.getPlaceholder()!==undefined&&children.length>0){firstChild=children[0];if($(firstChild).text()===\"\"){children=children.not(firstChild)}}children.each2(function(i,elm){process(elm,data.results)});query.callback(data)});opts.id=function(e){return e.id};opts.formatResultCssClass=function(data){return data.css}}else{if(!(\"query\"in opts)){if(\"ajax\"in opts){ajaxUrl=opts.element.data(\"ajax-url\");if(ajaxUrl&&ajaxUrl.length>0){opts.ajax.url=ajaxUrl}opts.query=ajax(opts.ajax)}else if(\"data\"in opts){opts.query=local(opts.data)}else if(\"tags\"in opts){opts.query=tags(opts.tags);opts.createSearchChoice=function(term){return{id:term,text:term}};opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator)).each(function(){var id=this,text=this,tags=opts.tags;if($.isFunction(tags))tags=tags();$(tags).each(function(){if(equal(this.id,id)){text=this.text;return false}});data.push({id:id,text:text})});callback(data)}}}}if(typeof opts.query!==\"function\"){throw\"query function not defined for Select2 \"+opts.element.attr(\"id\")}return opts},monitorSource:function(){this.opts.element.bind(\"change.select2\",this.bind(function(e){if(this.opts.element.data(\"select2-change-triggered\")!==true){this.initSelection()}}))},triggerChange:function(details){details=details||{};details=$.extend({},details,{type:\"change\",val:this.val()});this.opts.element.data(\"select2-change-triggered\",true);this.opts.element.trigger(details);this.opts.element.data(\"select2-change-triggered\",false);this.opts.element.click();if(this.opts.blurOnChange)this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass(\"select2-container-disabled\")},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass(\"select2-container-disabled\")},opened:function(){return this.container.hasClass(\"select2-dropdown-open\")},positionDropdown:function(){var offset=this.container.offset(),height=this.container.outerHeight(),width=this.container.outerWidth(),dropHeight=this.dropdown.outerHeight(),viewportBottom=$(window).scrollTop()+document.documentElement.clientHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=offset.top-dropHeight>=this.body().scrollTop(),aboveNow=this.dropdown.hasClass(\"select2-drop-above\"),bodyOffset,above,css;if(this.body().css(\"position\")!==\"static\"){bodyOffset=this.body().offset();dropTop-=bodyOffset.top;dropLeft-=bodyOffset.left}if(aboveNow){above=true;if(!enoughRoomAbove&&enoughRoomBelow)above=false}else{above=false;if(!enoughRoomBelow&&enoughRoomAbove)above=true}if(above){dropTop=offset.top-dropHeight;this.container.addClass(\"select2-drop-above\");this.dropdown.addClass(\"select2-drop-above\")}else{this.container.removeClass(\"select2-drop-above\");this.dropdown.removeClass(\"select2-drop-above\")}css=$.extend({top:dropTop,left:dropLeft,width:width},evaluate(this.opts.dropdownCss));this.dropdown.css(css)},shouldOpen:function(){var event;if(this.opened())return false;event=$.Event(\"open\");this.opts.element.trigger(event);return!event.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass(\"select2-drop-above\");this.dropdown.removeClass(\"select2-drop-above\")},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var cid=this.containerId,selector=this.containerSelector,scroll=\"scroll.\"+cid,resize=\"resize.\"+cid;this.container.parents().each(function(){$(this).bind(scroll,function(){var s2=$(selector);if(s2.length==0){$(this).unbind(scroll)}s2.select2(\"close\")})});$(window).bind(resize,function(){var s2=$(selector);if(s2.length==0){$(window).unbind(resize)}s2.select2(\"close\")});this.clearDropdownAlignmentPreference();if(this.search.val()===\" \"){this.search.val(\"\")}this.container.addClass(\"select2-dropdown-open\").addClass(\"select2-container-active\");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.dropdown.show();this.positionDropdown();this.dropdown.addClass(\"select2-drop-active\");this.ensureHighlightVisible();this.focusSearch()},close:function(){if(!this.opened())return;var self=this;this.container.parents().each(function(){$(this).unbind(\"scroll.\"+self.containerId)});$(window).unbind(\"resize.\"+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass(\"select2-dropdown-open\").removeClass(\"select2-container-active\");this.results.empty();this.clearSearch();this.opts.element.trigger($.Event(\"close\"))},clearSearch:function(){},ensureHighlightVisible:function(){var results=this.results,children,index,child,hb,rb,y,more;index=this.highlight();if(index<0)return;if(index==0){results.scrollTop(0);return}children=results.find(\".select2-result-selectable\");child=$(children[index]);hb=child.offset().top+child.outerHeight();if(index===children.length-1){more=results.find(\"li.select2-more-results\");if(more.length>0){hb=more.offset().top+more.outerHeight()}}rb=results.offset().top+results.outerHeight();if(hb>rb){results.scrollTop(results.scrollTop()+(hb-rb))}y=child.offset().top-results.offset().top;if(y<0){results.scrollTop(results.scrollTop()+y)}},moveHighlight:function(delta){var choices=this.results.find(\".select2-result-selectable\"),index=this.highlight();while(index>-1&&index<choices.length){index+=delta;var choice=$(choices[index]);if(choice.hasClass(\"select2-result-selectable\")&&!choice.hasClass(\"select2-disabled\")){this.highlight(index);break}}},highlight:function(index){var choices=this.results.find(\".select2-result-selectable\").not(\".select2-disabled\");if(arguments.length===0){return indexOf(choices.filter(\".select2-highlighted\")[0],choices.get())}if(index>=choices.length)index=choices.length-1;if(index<0)index=0;choices.removeClass(\"select2-highlighted\");$(choices[index]).addClass(\"select2-highlighted\");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(\".select2-result-selectable\").not(\".select2-disabled\").length},highlightUnderEvent:function(event){var el=$(event.target).closest(\".select2-result-selectable\");if(el.length>0&&!el.is(\".select2-highlighted\")){var choices=this.results.find(\".select2-result-selectable\");this.highlight(choices.index(el))}else if(el.length==0){this.results.find(\".select2-highlighted\").removeClass(\"select2-highlighted\")}},loadMoreIfNeeded:function(){var results=this.results,more=results.find(\"li.select2-more-results\"),below,offset=-1,page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;if(more.length===0)return;below=more.offset().top-results.offset().top-results.height();if(below<=0){more.addClass(\"select2-active\");this.opts.query({term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){if(!self.opened())return;self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context});if(data.more===true){more.detach().appendTo(results).text(self.opts.formatLoadMore(page+1));window.setTimeout(function(){self.loadMoreIfNeeded()},10)}else{more.remove()}self.positionDropdown();self.resultsPage=page})})}},tokenize:function(){},updateResults:function(initial){var search=this.search,results=this.results,opts=this.opts,data,self=this,input;if(initial!==true&&(this.showSearchInput===false||!this.opened())){return}search.addClass(\"select2-active\");function postRender(){results.scrollTop(0);search.removeClass(\"select2-active\");self.positionDropdown()}function render(html){results.html(self.opts.escapeMarkup(html));postRender()}if(opts.maximumSelectionSize>=1){data=this.data();if($.isArray(data)&&data.length>=opts.maximumSelectionSize&&checkFormatter(opts.formatSelectionTooBig,\"formatSelectionTooBig\")){render(\"<li class='select2-selection-limit'>\"+opts.formatSelectionTooBig(opts.maximumSelectionSize)+\"</li>\");return}}if(search.val().length<opts.minimumInputLength&&checkFormatter(opts.formatInputTooShort,\"formatInputTooShort\")){render(\"<li class='select2-no-results'>\"+opts.formatInputTooShort(search.val(),opts.minimumInputLength)+\"</li>\");return}else{render(\"<li class='select2-searching'>\"+opts.formatSearching()+\"</li>\")}input=this.tokenize();if(input!=undefined&&input!=null){search.val(input)}this.resultsPage=1;opts.query({term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;if(!this.opened())return;this.context=data.context===undefined?null:data.context;if(this.opts.createSearchChoice&&search.val()!==\"\"){def=this.opts.createSearchChoice.call(null,search.val(),data.results);if(def!==undefined&&def!==null&&self.id(def)!==undefined&&self.id(def)!==null){if($(data.results).filter(function(){return equal(self.id(this),self.id(def))}).length===0){data.results.unshift(def)}}}if(data.results.length===0&&checkFormatter(opts.formatNoMatches,\"formatNoMatches\")){render(\"<li class='select2-no-results'>\"+opts.formatNoMatches(search.val())+\"</li>\");return}results.empty();self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null});if(data.more===true&&checkFormatter(opts.formatLoadMore,\"formatLoadMore\")){results.append(\"<li class='select2-more-results'>\"+self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage))+\"</li>\");window.setTimeout(function(){self.loadMoreIfNeeded()},10)}this.postprocessResults(data,initial);postRender()})})},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass(\"select2-container-active\");this.dropdown.removeClass(\"select2-drop-active\");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\")},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var index=this.highlight(),highlighted=this.results.find(\".select2-highlighted\").not(\".select2-disabled\"),data=highlighted.closest(\".select2-result-selectable\").data(\"select2-data\");if(data){highlighted.addClass(\"select2-disabled\");this.highlight(index);this.onSelect(data)}},getPlaceholder:function(){return this.opts.element.attr(\"placeholder\")||this.opts.element.attr(\"data-placeholder\")||this.opts.element.data(\"placeholder\")||this.opts.placeholder},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l;if(this.opts.width===\"off\"){return null}else if(this.opts.width===\"element\"){return this.opts.element.outerWidth()===0?\"auto\":this.opts.element.outerWidth()+\"px\"}else if(this.opts.width===\"copy\"||this.opts.width===\"resolve\"){style=this.opts.element.attr(\"style\");if(style!==undefined){attrs=style.split(\";\");for(i=0,l=attrs.length;i<l;i=i+1){matches=attrs[i].replace(/\\s/g,\"\").match(/width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(matches!==null&&matches.length>=1)return matches[1]}}if(this.opts.width===\"resolve\"){style=this.opts.element.css(\"width\");if(style.indexOf(\"%\")>0)return style;return this.opts.element.outerWidth()===0?\"auto\":this.opts.element.outerWidth()+\"px\"}return null}else if($.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}var width=resolveContainerWidth.call(this);if(width!==null){this.container.attr(\"style\",\"width: \"+width)}}});SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(\"<div></div>\",{\"class\":\"select2-container\"}).html([\"    <a href='#' onclick='return false;' class='select2-choice'>\",\"   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>\",\"   <div><b></b></div>\",\"</a>\",\"    <div class='select2-drop select2-offscreen'>\",\"   <div class='select2-search'>\",\"       <input type='text' autocomplete='off' class='select2-input' placeholder='search...'/>\",\"   </div>\",\"   <ul class='select2-results'>\",\"   </ul>\",\"</div>\"].join(\"\"));return container},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass(\"select2-offscreen\")},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.dropdown.removeAttr(\"style\").addClass(\"select2-offscreen\").insertAfter(this.selection).show()},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var selection,container=this.container,dropdown=this.dropdown,clickingInside=false;this.selection=selection=container.find(\".select2-choice\");this.search.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return}if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:case KEY.RIGHT:case KEY.LEFT:this.moveHighlight(e.which===KEY.UP||e.which===KEY.LEFT?-1:1);killEvent(e);return;case KEY.TAB:case KEY.ENTER:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return}}else{if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}this.open();if(e.which===KEY.ENTER){return}}}));this.search.bind(\"focus\",this.bind(function(){this.selection.attr(\"tabIndex\",\"-1\")}));this.search.bind(\"blur\",this.bind(function(){if(!this.opened())this.container.removeClass(\"select2-container-active\");window.setTimeout(this.bind(function(){this.selection.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"))}),10)}));selection.bind(\"mousedown\",this.bind(function(e){clickingInside=true;if(this.opened()){this.close();this.selection.focus()}else if(this.enabled){this.open()}clickingInside=false}));dropdown.bind(\"mousedown\",this.bind(function(){this.search.focus()}));selection.bind(\"focus\",this.bind(function(){this.container.addClass(\"select2-container-active\");this.search.attr(\"tabIndex\",\"-1\")}));selection.bind(\"blur\",this.bind(function(){if(!this.opened()){this.container.removeClass(\"select2-container-active\")}window.setTimeout(this.bind(function(){this.search.attr(\"tabIndex\",this.opts.element.attr(\"tabIndex\"))}),10)}));selection.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return}if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}if(e.which==KEY.DELETE){if(this.opts.allowClear){this.clear()}return}this.open();if(e.which===KEY.ENTER){killEvent(e);return}if(e.which<48){killEvent(e);return}var keyWritten=String.fromCharCode(e.which).toLowerCase();if(e.shiftKey){keyWritten=keyWritten.toUpperCase()}this.search.focus();this.search.val(keyWritten);killEvent(e)}));selection.delegate(\"abbr\",\"mousedown\",this.bind(function(e){if(!this.enabled)return;this.clear();killEvent(e);this.close();this.triggerChange();this.selection.focus()}));this.setPlaceholder();this.search.bind(\"focus\",this.bind(function(){this.container.addClass(\"select2-container-active\")}))},clear:function(){this.opts.element.val(\"\");this.selection.find(\"span\").empty();this.selection.removeData(\"select2-data\");this.setPlaceholder()},initSelection:function(){var selected;if(this.opts.element.val()===\"\"){this.close();this.setPlaceholder()}else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){if(selected!==undefined&&selected!==null){self.updateSelection(selected);self.close();self.setPlaceholder()}})}},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){opts.initSelection=function(element,callback){var selected=element.find(\":selected\");if($.isFunction(callback))callback({id:selected.attr(\"value\"),text:selected.text()})}}return opts},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.opts.element.val()===\"\"&&placeholder!==undefined){if(this.select&&this.select.find(\"option:first\").text()!==\"\")return;this.selection.find(\"span\").html(this.opts.escapeMarkup(placeholder));this.selection.addClass(\"select2-default\");this.selection.find(\"abbr\").hide()}},postprocessResults:function(data,initial){var selected=0,self=this,showSearchInput=true;this.results.find(\".select2-result-selectable\").each2(function(i,elm){if(equal(self.id(elm.data(\"select2-data\")),self.opts.element.val())){selected=i;return false}});this.highlight(selected);if(initial===true){showSearchInput=this.showSearchInput=countResults(data.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(\".select2-search\")[showSearchInput?\"removeClass\":\"addClass\"](\"select2-search-hidden\");$(this.dropdown,this.container)[showSearchInput?\"addClass\":\"removeClass\"](\"select2-with-searchbox\")}},onSelect:function(data){var old=this.opts.element.val();this.opts.element.val(this.id(data));this.updateSelection(data);this.close();this.selection.focus();if(!equal(old,this.id(data))){this.triggerChange()}},updateSelection:function(data){var container=this.selection.find(\"span\"),formatted;this.selection.data(\"select2-data\",data);container.empty();formatted=this.opts.formatSelection(data,container);if(formatted!==undefined){container.append(this.opts.escapeMarkup(formatted))}this.selection.removeClass(\"select2-default\");if(this.opts.allowClear&&this.getPlaceholder()!==undefined){this.selection.find(\"abbr\").show()}},val:function(){var val,data=null,self=this;if(arguments.length===0){return this.opts.element.val()}val=arguments[0];if(this.select){this.select.val(val).find(\":selected\").each2(function(i,elm){data={id:elm.attr(\"value\"),text:elm.text()};return false});this.updateSelection(data);this.setPlaceholder()}else{if(this.opts.initSelection===undefined){throw new Error(\"cannot call val() if initSelection() is not defined\")}if(!val){this.clear();return}this.opts.element.val(val);this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(!data?\"\":self.id(data));self.updateSelection(data);self.setPlaceholder()})}},clearSearch:function(){this.search.val(\"\")},data:function(value){var data;if(arguments.length===0){data=this.selection.data(\"select2-data\");if(data==undefined)data=null;return data}else{if(!value||value===\"\"){this.clear()}else{this.opts.element.val(!value?\"\":this.id(value));this.updateSelection(value)}}}});MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(\"<div></div>\",{\"class\":\"select2-container select2-container-multi\"}).html([\"    <ul class='select2-choices'>\",\"  <li class='select2-search-field'>\",\"    <input type='text' autocomplete='off' class='select2-input'>\",\"  </li>\",\"</ul>\",\"<div class='select2-drop select2-drop-multi' style='display:none;'>\",\"   <ul class='select2-results'>\",\"   </ul>\",\"</div>\"].join(\"\"));return container},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){opts.initSelection=function(element,callback){var data=[];element.find(\":selected\").each2(function(i,elm){data.push({id:elm.attr(\"value\"),text:elm.text()})});if($.isFunction(callback))callback(data)}}return opts},initContainer:function(){var selector=\".select2-choices\",selection;this.searchContainer=this.container.find(\".select2-search-field\");this.selection=selection=this.container.find(selector);this.search.bind(\"keydown\",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.BACKSPACE&&this.search.val()===\"\"){this.close();var choices,selected=selection.find(\".select2-search-choice-focus\");if(selected.length>0){this.unselect(selected.first());this.search.width(10);killEvent(e);return}choices=selection.find(\".select2-search-choice\");if(choices.length>0){choices.last().addClass(\"select2-search-choice-focus\")}}else{selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\")}if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight(e.which===KEY.UP?-1:1);killEvent(e);return;case KEY.ENTER:case KEY.TAB:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return}}if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.BACKSPACE||e.which===KEY.ESC){return}if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return}this.open();if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e)}}));this.search.bind(\"keyup\",this.bind(this.resizeSearch));this.search.bind(\"blur\",this.bind(function(e){this.container.removeClass(\"select2-container-active\");this.search.removeClass(\"select2-focused\");this.clearSearch();e.stopImmediatePropagation()}));this.container.delegate(selector,\"mousedown\",this.bind(function(e){if(!this.enabled)return;if($(e.target).closest(\".select2-search-choice\").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();e.preventDefault()}));this.container.delegate(selector,\"focus\",this.bind(function(){if(!this.enabled)return;this.container.addClass(\"select2-container-active\");this.dropdown.addClass(\"select2-drop-active\");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr(\"disabled\")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr(\"disabled\",true)},initSelection:function(){var data;if(this.opts.element.val()===\"\"){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==\"\"){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){if(data!==undefined&&data!==null){self.updateSelection(data);self.close();self.clearSearch()}})}},clearSearch:function(){var placeholder=this.getPlaceholder();if(placeholder!==undefined&&this.getVal().length===0&&this.search.hasClass(\"select2-focused\")===false){this.search.val(placeholder).addClass(\"select2-default\");this.resizeSearch()}else{this.search.val(\" \").width(10)}},clearPlaceholder:function(){if(this.search.hasClass(\"select2-default\")){this.search.val(\"\").removeClass(\"select2-default\")}else{if(this.search.val()===\" \")this.search.val(\"\")}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass(\"select2-focused\")},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each(function(){if(indexOf(self.id(this),ids)<0){ids.push(self.id(this));filtered.push(this)}});data=filtered;this.selection.find(\".select2-search-choice\").remove();$(data).each(function(){self.addSelectedChoice(this)});self.postprocessResults()},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer(input,this.data(),this.bind(this.onSelect),this.opts);if(input!=null&&input!=undefined){this.search.val(input);if(input.length>0){this.open()}}},onSelect:function(data){this.addSelectedChoice(data);if(this.select){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown()}else{this.close()}}this.triggerChange({added:data});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(data){var choice=$(\"<li class='select2-search-choice'>\"+\"    <div></div>\"+\"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>\"+\"</li>\"),id=this.id(data),val=this.getVal(),formatted;formatted=this.opts.formatSelection(data,choice);choice.find(\"div\").replaceWith(\"<div>\"+this.opts.escapeMarkup(formatted)+\"</div>\");choice.find(\".select2-search-choice-close\").bind(\"mousedown\",killEvent).bind(\"click dblclick\",this.bind(function(e){if(!this.enabled)return;$(e.target).closest(\".select2-search-choice\").fadeOut(\"fast\",this.bind(function(){this.unselect($(e.target));this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\");this.close();this.focusSearch()})).dequeue();killEvent(e)})).bind(\"focus\",this.bind(function(){if(!this.enabled)return;this.container.addClass(\"select2-container-active\");this.dropdown.addClass(\"select2-drop-active\")}));choice.data(\"select2-data\",data);choice.insertBefore(this.searchContainer);val.push(id);this.setVal(val)},unselect:function(selected){var val=this.getVal(),data,index;selected=selected.closest(\".select2-search-choice\");if(selected.length===0){throw\"Invalid argument: \"+selected+\". Must be .select2-search-choice\"}data=selected.data(\"select2-data\");index=indexOf(this.id(data),val);if(index>=0){val.splice(index,1);this.setVal(val);if(this.select)this.postprocessResults()}selected.remove();this.triggerChange({removed:data})},postprocessResults:function(){var val=this.getVal(),choices=this.results.find(\".select2-result-selectable\"),compound=this.results.find(\".select2-result-with-children\"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data(\"select2-data\"));if(indexOf(id,val)>=0){choice.addClass(\"select2-disabled\").removeClass(\"select2-result-selectable\")}else{choice.removeClass(\"select2-disabled\").addClass(\"select2-result-selectable\")}});compound.each2(function(i,e){if(e.find(\".select2-result-selectable\").length==0){e.addClass(\"select2-disabled\")}else{e.removeClass(\"select2-disabled\")}});choices.each2(function(i,choice){if(!choice.hasClass(\"select2-disabled\")&&choice.hasClass(\"select2-result-selectable\")){self.highlight(0);return false}})},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10;left=this.search.offset().left;maxWidth=this.selection.width();containerLeft=this.selection.offset().left;searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding;if(searchWidth<minimumWidth){searchWidth=maxWidth-sideBorderPadding}if(searchWidth<40){searchWidth=maxWidth-sideBorderPadding}this.search.width(searchWidth)},getVal:function(){var val;\nif(this.select){val=this.select.val();return val===null?[]:val}else{val=this.opts.element.val();return splitVal(val,this.opts.separator)}},setVal:function(val){var unique;if(this.select){this.select.val(val)}else{unique=[];$(val).each(function(){if(indexOf(this,unique)<0)unique.push(this)});this.opts.element.val(unique.length===0?\"\":unique.join(this.opts.separator))}},val:function(){var val,data=[],self=this;if(arguments.length===0){return this.getVal()}val=arguments[0];if(!val){this.opts.element.val(\"\");this.updateSelection([]);this.clearSearch();return}this.setVal(val);if(this.select){this.select.find(\":selected\").each(function(){data.push({id:$(this).attr(\"value\"),text:$(this).text()})});this.updateSelection(data)}else{if(this.opts.initSelection===undefined){throw new Error(\"val() cannot be called if initSelection() is not defined\")}this.opts.initSelection(this.opts.element,function(data){var ids=$(data).map(self.id);self.setVal(ids);self.updateSelection(data);self.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error(\"Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.\")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var val=[],self=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(\".select2-search-choice\").each(function(){val.push(self.opts.id($(this).data(\"select2-data\")))});this.setVal(val);this.triggerChange()},data:function(values){var self=this,ids;if(arguments.length===0){return this.selection.find(\".select2-search-choice\").map(function(){return $(this).data(\"select2-data\")}).get()}else{if(!values){values=[]}ids=$.map(values,function(e){return self.opts.id(e)});this.setVal(ids);this.updateSelection(values);this.clearSearch()}}});$.fn.select2=function(){var args=Array.prototype.slice.call(arguments,0),opts,select2,value,multiple,allowedMethods=[\"val\",\"destroy\",\"opened\",\"open\",\"close\",\"focus\",\"isFocused\",\"container\",\"onSortStart\",\"onSortEnd\",\"enable\",\"disable\",\"positionDropdown\",\"data\"];this.each(function(){if(args.length===0||typeof args[0]===\"object\"){opts=args.length===0?{}:$.extend({},args[0]);opts.element=$(this);if(opts.element.get(0).tagName.toLowerCase()===\"select\"){multiple=opts.element.attr(\"multiple\")}else{multiple=opts.multiple||false;if(\"tags\"in opts){opts.multiple=multiple=true}}select2=multiple?new MultiSelect2:new SingleSelect2;select2.init(opts)}else if(typeof args[0]===\"string\"){if(indexOf(args[0],allowedMethods)<0){throw\"Unknown method: \"+args[0]}value=undefined;select2=$(this).data(\"select2\");if(select2===undefined)return;if(args[0]===\"container\"){value=select2.container}else{value=select2[args[0]].apply(select2,args.slice(1))}if(value!==undefined){return false}}else{throw\"Invalid arguments to select2 plugin: \"+args}});return value===undefined?this:value};$.fn.select2.defaults={width:\"copy\",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:\"\",dropdownCssClass:\"\",formatResult:function(result,container,query){var markup=[];markMatch(result.text,query.term,markup);return markup.join(\"\")},formatSelection:function(data,container){return data?data.text:undefined},formatResultCssClass:function(data){return undefined},formatNoMatches:function(){return\"No matches found\"},formatInputTooShort:function(input,min){return\"Please enter \"+(min-input.length)+\" more characters\"},formatSelectionTooBig:function(limit){return\"You can only select \"+limit+\" item\"+(limit==1?\"\":\"s\")},formatLoadMore:function(pageNumber){return\"Loading more results...\"},formatSearching:function(){return\"Searching...\"},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(term,text){return text.toUpperCase().indexOf(term.toUpperCase())>=0},separator:\",\",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:function(markup){if(markup&&typeof markup===\"string\"){return markup.replace(/&/g,\"&amp;\")}return markup},blurOnChange:false};window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch},\"class\":{\"abstract\":AbstractSelect2,single:SingleSelect2,multi:MultiSelect2}}})(jQuery);(function(){var window=this;if(!window.localStorage){if(window.globalStorage){try{window.localStorage=window.globalStorage}catch(e){}return}var div=document.createElement(\"div\"),attrKey=\"localStorage\";div.style.display=\"none\";document.getElementsByTagName(\"head\")[0].appendChild(div);if(div.addBehavior){div.addBehavior(\"#default#userdata\");var localStorage=window[\"localStorage\"]={length:0,setItem:function(key,value){div.load(attrKey);key=cleanKey(key);if(!div.getAttribute(key)){this.length++}div.setAttribute(key,value);div.save(attrKey)},getItem:function(key){div.load(attrKey);key=cleanKey(key);return div.getAttribute(key)},removeItem:function(key){div.load(attrKey);key=cleanKey(key);div.removeAttribute(key);div.save(attrKey);this.length--;if(this.length<0){this.length=0}},clear:function(){div.load(attrKey);var i=0;while(attr=div.XMLDocument.documentElement.attributes[i++]){div.removeAttribute(attr.name)}div.save(attrKey);this.length=0},key:function(key){div.load(attrKey);return div.XMLDocument.documentElement.attributes[key]}},cleanKey=function(key){return key.replace(/[^-._0-9A-Za-z\\xb7\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u037d\\u37f-\\u1fff\\u200c-\\u200d\\u203f\\u2040\\u2070-\\u218f]/g,\"-\")};div.load(attrKey);localStorage[\"length\"]=div.XMLDocument.documentElement.attributes.length}}})();!function(root,String){\"use strict\";var nativeTrim=String.prototype.trim;var nativeTrimRight=String.prototype.trimRight;var nativeTrimLeft=String.prototype.trimLeft;var parseNumber=function(source){return source*1||0};var strRepeat=function(str,qty){if(qty<1)return\"\";var result=\"\";while(qty>0){if(qty&1)result+=str;qty>>=1,str+=str}return result};var slice=[].slice;var defaultToWhiteSpace=function(characters){if(characters==null)return\"\\\\s\";else if(characters.source)return characters.source;else return\"[\"+_s.escapeRegExp(characters)+\"]\"};var escapeChars={lt:\"<\",gt:\">\",quot:'\"',apos:\"'\",amp:\"&\"};var reversedEscapeChars={};for(var key in escapeChars){reversedEscapeChars[escapeChars[key]]=key}var sprintf=function(){function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}var str_repeat=strRepeat;var str_format=function(){if(!str_format.cache.hasOwnProperty(arguments[0])){str_format.cache[arguments[0]]=str_format.parse(arguments[0])}return str_format.format.call(null,str_format.cache[arguments[0]],arguments)};str_format.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type=\"\",arg,output=[],i,k,match,pad,pad_character,pad_length;for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i]);if(node_type===\"string\"){output.push(parse_tree[i])}else if(node_type===\"array\"){match=parse_tree[i];if(match[2]){arg=argv[cursor];for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k])){throw new Error(sprintf('[_.sprintf] property \"%s\" does not exist',match[2][k]))}arg=arg[match[2][k]]}}else if(match[1]){arg=argv[match[1]]}else{arg=argv[cursor++]}if(/[^s]/.test(match[8])&&get_type(arg)!=\"number\"){throw new Error(sprintf(\"[_.sprintf] expecting number but found %s\",get_type(arg)))}switch(match[8]){case\"b\":arg=arg.toString(2);break;case\"c\":arg=String.fromCharCode(arg);break;case\"d\":arg=parseInt(arg,10);break;case\"e\":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case\"f\":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case\"o\":arg=arg.toString(8);break;case\"s\":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case\"u\":arg=Math.abs(arg);break;case\"x\":arg=arg.toString(16);break;case\"X\":arg=arg.toString(16).toUpperCase();break}arg=/[def]/.test(match[8])&&match[3]&&arg>=0?\"+\"+arg:arg;pad_character=match[4]?match[4]==\"0\"?\"0\":match[4].charAt(1):\" \";pad_length=match[6]-String(arg).length;pad=match[6]?str_repeat(pad_character,pad_length):\"\";output.push(match[5]?arg+pad:pad+arg)}}return output.join(\"\")};str_format.cache={};str_format.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=[],arg_names=0;while(_fmt){if((match=/^[^\\x25]+/.exec(_fmt))!==null){parse_tree.push(match[0])}else if((match=/^\\x25{2}/.exec(_fmt))!==null){parse_tree.push(\"%\")}else if((match=/^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-fosuxX])/.exec(_fmt))!==null){if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if((field_match=/^([a-z_][a-z_\\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1]);while((replacement_field=replacement_field.substring(field_match[0].length))!==\"\"){if((field_match=/^\\.([a-z_][a-z_\\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1])}else if((field_match=/^\\[(\\d+)\\]/.exec(replacement_field))!==null){field_list.push(field_match[1])}else{throw new Error(\"[_.sprintf] huh?\")}}}else{throw new Error(\"[_.sprintf] huh?\")}match[2]=field_list}else{arg_names|=2}if(arg_names===3){throw new Error(\"[_.sprintf] mixing positional and named placeholders is not (yet) supported\")}parse_tree.push(match)}else{throw new Error(\"[_.sprintf] huh?\")}_fmt=_fmt.substring(match[0].length)}return parse_tree};return str_format}();var _s={VERSION:\"2.3.0\",isBlank:function(str){if(str==null)str=\"\";return/^\\s*$/.test(str)},stripTags:function(str){if(str==null)return\"\";return String(str).replace(/<\\/?[^>]+>/g,\"\")},capitalize:function(str){str=str==null?\"\":String(str);return str.charAt(0).toUpperCase()+str.slice(1)},chop:function(str,step){if(str==null)return[];str=String(str);step=~~step;return step>0?str.match(new RegExp(\".{1,\"+step+\"}\",\"g\")):[str]},clean:function(str){return _s.strip(str).replace(/\\s+/g,\" \")},count:function(str,substr){if(str==null||substr==null)return 0;return String(str).split(substr).length-1},chars:function(str){if(str==null)return[];return String(str).split(\"\")},swapCase:function(str){if(str==null)return\"\";return String(str).replace(/\\S/g,function(c){return c===c.toUpperCase()?c.toLowerCase():c.toUpperCase()})},escapeHTML:function(str){if(str==null)return\"\";return String(str).replace(/[&<>\"']/g,function(m){return\"&\"+reversedEscapeChars[m]+\";\"})},unescapeHTML:function(str){if(str==null)return\"\";return String(str).replace(/\\&([^;]+);/g,function(entity,entityCode){var match;if(entityCode in escapeChars){return escapeChars[entityCode]}else if(match=entityCode.match(/^#x([\\da-fA-F]+)$/)){return String.fromCharCode(parseInt(match[1],16))}else if(match=entityCode.match(/^#(\\d+)$/)){return String.fromCharCode(~~match[1])}else{return entity}})},escapeRegExp:function(str){if(str==null)return\"\";return String(str).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g,\"\\\\$1\")},splice:function(str,i,howmany,substr){var arr=_s.chars(str);arr.splice(~~i,~~howmany,substr);return arr.join(\"\")},insert:function(str,i,substr){return _s.splice(str,i,0,substr)},include:function(str,needle){if(needle===\"\")return true;if(str==null)return false;return String(str).indexOf(needle)!==-1},join:function(){var args=slice.call(arguments),separator=args.shift();if(separator==null)separator=\"\";return args.join(separator)},lines:function(str){if(str==null)return[];return String(str).split(\"\\n\")},reverse:function(str){return _s.chars(str).reverse().join(\"\")},startsWith:function(str,starts){if(starts===\"\")return true;if(str==null||starts==null)return false;str=String(str);starts=String(starts);return str.length>=starts.length&&str.slice(0,starts.length)===starts},endsWith:function(str,ends){if(ends===\"\")return true;if(str==null||ends==null)return false;str=String(str);ends=String(ends);return str.length>=ends.length&&str.slice(str.length-ends.length)===ends},succ:function(str){if(str==null)return\"\";str=String(str);return str.slice(0,-1)+String.fromCharCode(str.charCodeAt(str.length-1)+1)},titleize:function(str){if(str==null)return\"\";return String(str).replace(/(?:^|\\s)\\S/g,function(c){return c.toUpperCase()})},camelize:function(str){return _s.trim(str).replace(/[-_\\s]+(.)?/g,function(match,c){return c.toUpperCase()})},underscored:function(str){return _s.trim(str).replace(/([a-z\\d])([A-Z]+)/g,\"$1_$2\").replace(/[-\\s]+/g,\"_\").toLowerCase()},dasherize:function(str){return _s.trim(str).replace(/([A-Z])/g,\"-$1\").replace(/[-_\\s]+/g,\"-\").toLowerCase()},classify:function(str){return _s.titleize(String(str).replace(/_/g,\" \")).replace(/\\s/g,\"\")},humanize:function(str){return _s.capitalize(_s.underscored(str).replace(/_id$/,\"\").replace(/_/g,\" \"))},trim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrim)return nativeTrim.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(\"^\"+characters+\"+|\"+characters+\"+$\",\"g\"),\"\")},ltrim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrimLeft)return nativeTrimLeft.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(\"^\"+characters+\"+\"),\"\")},rtrim:function(str,characters){if(str==null)return\"\";if(!characters&&nativeTrimRight)return nativeTrimRight.call(str);characters=defaultToWhiteSpace(characters);return String(str).replace(new RegExp(characters+\"+$\"),\"\")},truncate:function(str,length,truncateStr){if(str==null)return\"\";str=String(str);truncateStr=truncateStr||\"...\";length=~~length;return str.length>length?str.slice(0,length)+truncateStr:str},prune:function(str,length,pruneStr){if(str==null)return\"\";str=String(str);length=~~length;pruneStr=pruneStr!=null?String(pruneStr):\"...\";if(str.length<=length)return str;var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?\"A\":\" \"},template=str.slice(0,length+1).replace(/.(?=\\W*\\w*$)/g,tmpl);if(template.slice(template.length-2).match(/\\w\\w/))template=template.replace(/\\s*\\S+$/,\"\");else template=_s.rtrim(template.slice(0,template.length-1));return(template+pruneStr).length>str.length?str:str.slice(0,template.length)+pruneStr},words:function(str,delimiter){if(_s.isBlank(str))return[];return _s.trim(str,delimiter).split(delimiter||/\\s+/)},pad:function(str,length,padStr,type){str=str==null?\"\":String(str);length=~~length;var padlen=0;if(!padStr)padStr=\" \";else if(padStr.length>1)padStr=padStr.charAt(0);switch(type){case\"right\":padlen=length-str.length;return str+strRepeat(padStr,padlen);case\"both\":padlen=length-str.length;return strRepeat(padStr,Math.ceil(padlen/2))+str+strRepeat(padStr,Math.floor(padlen/2));default:padlen=length-str.length;return strRepeat(padStr,padlen)+str}},lpad:function(str,length,padStr){return _s.pad(str,length,padStr)},rpad:function(str,length,padStr){return _s.pad(str,length,padStr,\"right\")},lrpad:function(str,length,padStr){return _s.pad(str,length,padStr,\"both\")},sprintf:sprintf,vsprintf:function(fmt,argv){argv.unshift(fmt);return sprintf.apply(null,argv)},toNumber:function(str,decimals){if(str==null||str==\"\")return 0;str=String(str);var num=parseNumber(parseNumber(str).toFixed(~~decimals));return num===0&&!str.match(/^0+$/)?Number.NaN:num},numberFormat:function(number,dec,dsep,tsep){if(isNaN(number)||number==null)return\"\";number=number.toFixed(~~dec);tsep=tsep||\",\";var parts=number.split(\".\"),fnums=parts[0],decimals=parts[1]?(dsep||\".\")+parts[1]:\"\";return fnums.replace(/(\\d)(?=(?:\\d{3})+$)/g,\"$1\"+tsep)+decimals},strRight:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str},strRightBack:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.lastIndexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str},strLeft:function(str,sep){if(str==null)return\"\";str=String(str);sep=sep!=null?String(sep):sep;var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(0,pos):str},strLeftBack:function(str,sep){if(str==null)return\"\";str+=\"\";sep=sep!=null?\"\"+sep:sep;var pos=str.lastIndexOf(sep);return~pos?str.slice(0,pos):str},toSentence:function(array,separator,lastSeparator,serial){separator=separator||\", \";lastSeparator=lastSeparator||\" and \";var a=array.slice(),lastMember=a.pop();if(array.length>2&&serial)lastSeparator=_s.rtrim(separator)+lastSeparator;return a.length?a.join(separator)+lastSeparator+lastMember:lastMember},toSentenceSerial:function(){var args=slice.call(arguments);args[3]=true;return _s.toSentence.apply(_s,args)},slugify:function(str){if(str==null)return\"\";var from=\" \",to=\"aaaaaaaaceeeeeiiiilnoooooouuuunczz\",regex=new RegExp(defaultToWhiteSpace(from),\"g\");str=String(str).toLowerCase().replace(regex,function(c){var index=from.indexOf(c);return to.charAt(index)||\"-\"});return _s.dasherize(str.replace(/[^\\w\\s-]/g,\"\"))},surround:function(str,wrapper){return[wrapper,str,wrapper].join(\"\")},quote:function(str){return _s.surround(str,'\"')},exports:function(){var result={};for(var prop in this){if(!this.hasOwnProperty(prop)||prop.match(/^(?:include|contains|reverse)$/))continue;result[prop]=this[prop]}return result},repeat:function(str,qty,separator){if(str==null)return\"\";qty=~~qty;if(separator==null)return strRepeat(String(str),qty);for(var repeat=[];qty>0;repeat[--qty]=str){}return repeat.join(separator)},levenshtein:function(str1,str2){if(str1==null&&str2==null)return 0;if(str1==null)return String(str2).length;if(str2==null)return String(str1).length;str1=String(str1);str2=String(str2);var current=[],prev,value;for(var i=0;i<=str2.length;i++)for(var j=0;j<=str1.length;j++){if(i&&j)if(str1.charAt(j-1)===str2.charAt(i-1))value=prev;else value=Math.min(current[j],current[j-1],prev)+1;else value=i+j;prev=current[j];current[j]=value}return current.pop()}};_s.strip=_s.trim;_s.lstrip=_s.ltrim;_s.rstrip=_s.rtrim;_s.center=_s.lrpad;_s.rjust=_s.lpad;_s.ljust=_s.rpad;_s.contains=_s.include;_s.q=_s.quote;if(typeof exports!==\"undefined\"){if(typeof module!==\"undefined\"&&module.exports){module.exports=_s}exports._s=_s}else if(typeof define===\"function\"&&define.amd){define(\"underscore.string\",[],function(){return _s})}else{root._=root._||{};root._.string=root._.str=_s}}(this,String);(function(){\"use strict\";var _camelizeCssPropName=function(){var matcherRegex=/\\-([a-z])/g,replacerFn=function(match,group){return group.toUpperCase()};return function(prop){return prop.replace(matcherRegex,replacerFn)}}();var _getStyle=function(el,prop){var value,camelProp,tagName,possiblePointers,i,len;if(window.getComputedStyle){value=window.getComputedStyle(el,null).getPropertyValue(prop)}else{camelProp=_camelizeCssPropName(prop);if(el.currentStyle){value=el.currentStyle[camelProp]}else{value=el.style[camelProp]}}if(prop===\"cursor\"){if(!value||value===\"auto\"){tagName=el.tagName.toLowerCase();possiblePointers=[\"a\"];for(i=0,len=possiblePointers.length;i<len;i++){if(tagName===possiblePointers[i]){return\"pointer\"}}}}return value};var _elementMouseOver=function(event){if(!ZeroClipboard.prototype._singleton)return;if(!event){event=window.event}var target;if(this!==window){target=this}else if(event.target){target=event.target}else if(event.srcElement){target=event.srcElement}ZeroClipboard.prototype._singleton.setCurrent(target)};var _addEventHandler=function(element,method,func){if(element.addEventListener){element.addEventListener(method,func,false)}else if(element.attachEvent){element.attachEvent(\"on\"+method,func)}};var _removeEventHandler=function(element,method,func){if(element.removeEventListener){element.removeEventListener(method,func,false)}else if(element.detachEvent){element.detachEvent(\"on\"+method,func)}};var _addClass=function(element,value){if(element.addClass){element.addClass(value);return element}if(value&&typeof value===\"string\"){var classNames=(value||\"\").split(/\\s+/);if(element.nodeType===1){if(!element.className){element.className=value}else{var className=\" \"+element.className+\" \",setClass=element.className;for(var c=0,cl=classNames.length;c<cl;c++){if(className.indexOf(\" \"+classNames[c]+\" \")<0){setClass+=\" \"+classNames[c]}}element.className=setClass.replace(/^\\s+|\\s+$/g,\"\")}}}return element};var _removeClass=function(element,value){if(element.removeClass){element.removeClass(value);return element}if(value&&typeof value===\"string\"||value===undefined){var classNames=(value||\"\").split(/\\s+/);if(element.nodeType===1&&element.className){if(value){var className=(\" \"+element.className+\" \").replace(/[\\n\\t]/g,\" \");for(var c=0,cl=classNames.length;c<cl;c++){className=className.replace(\" \"+classNames[c]+\" \",\" \")}element.className=className.replace(/^\\s+|\\s+$/g,\"\")}else{element.className=\"\"}}}return element};var _getZoomFactor=function(){var rect,physicalWidth,logicalWidth,zoomFactor=1;if(typeof document.body.getBoundingClientRect===\"function\"){rect=document.body.getBoundingClientRect();physicalWidth=rect.right-rect.left;logicalWidth=document.body.offsetWidth;zoomFactor=Math.round(physicalWidth/logicalWidth*100)/100}return zoomFactor};var _getDOMObjectPosition=function(obj){var info={left:0,top:0,width:0,height:0,zIndex:999999999};var zi=_getStyle(obj,\"z-index\");if(zi&&zi!==\"auto\"){info.zIndex=parseInt(zi,10)}if(obj.getBoundingClientRect){var rect=obj.getBoundingClientRect();var pageXOffset,pageYOffset,zoomFactor;if(\"pageXOffset\"in window&&\"pageYOffset\"in window){pageXOffset=window.pageXOffset;pageYOffset=window.pageYOffset}else{zoomFactor=_getZoomFactor();pageXOffset=Math.round(document.documentElement.scrollLeft/zoomFactor);pageYOffset=Math.round(document.documentElement.scrollTop/zoomFactor)}var leftBorderWidth=document.documentElement.clientLeft||0;var topBorderWidth=document.documentElement.clientTop||0;info.left=rect.left+pageXOffset-leftBorderWidth;info.top=rect.top+pageYOffset-topBorderWidth;info.width=\"width\"in rect?rect.width:rect.right-rect.left;info.height=\"height\"in rect?rect.height:rect.bottom-rect.top}return info};var _noCache=function(path,options){var useNoCache=!(options&&options.useNoCache===false);if(useNoCache){return(path.indexOf(\"?\")===-1?\"?\":\"&\")+\"nocache=\"+(new Date).getTime()}else{return\"\"}};var _vars=function(options){var str=[];var origins=[];if(options.trustedOrigins){if(typeof options.trustedOrigins===\"string\"){origins.push(options.trustedOrigins)}else if(typeof options.trustedOrigins===\"object\"&&\"length\"in options.trustedOrigins){origins=origins.concat(options.trustedOrigins)}}if(options.trustedDomains){if(typeof options.trustedDomains===\"string\"){origins.push(options.trustedDomains)}else if(typeof options.trustedDomains===\"object\"&&\"length\"in options.trustedDomains){origins=origins.concat(options.trustedDomains)}}if(origins.length){str.push(\"trustedOrigins=\"+encodeURIComponent(origins.join(\",\")))}if(typeof options.amdModuleId===\"string\"&&options.amdModuleId){str.push(\"amdModuleId=\"+encodeURIComponent(options.amdModuleId))}if(typeof options.cjsModuleId===\"string\"&&options.cjsModuleId){str.push(\"cjsModuleId=\"+encodeURIComponent(options.cjsModuleId))}return str.join(\"&\")};var _inArray=function(elem,array){if(array.indexOf){return array.indexOf(elem)}for(var i=0,length=array.length;i<length;i++){if(array[i]===elem){return i}}return-1};var _prepGlue=function(elements){if(typeof elements===\"string\")throw new TypeError(\"ZeroClipboard doesn't accept query strings.\");if(!elements.length)return[elements];return elements};var _dispatchCallback=function(func,element,instance,args,async){if(async){window.setTimeout(function(){func.call(element,instance,args)},0)}else{func.call(element,instance,args)}};var ZeroClipboard=function(elements,options){if(elements)(ZeroClipboard.prototype._singleton||this).glue(elements);if(ZeroClipboard.prototype._singleton)return ZeroClipboard.prototype._singleton;ZeroClipboard.prototype._singleton=this;this.options={};for(var kd in _defaults)this.options[kd]=_defaults[kd];for(var ko in options)this.options[ko]=options[ko];this.handlers={};if(ZeroClipboard.detectFlashSupport())_bridge()};var currentElement,gluedElements=[];ZeroClipboard.prototype.setCurrent=function(element){currentElement=element;this.reposition();var titleAttr=element.getAttribute(\"title\");if(titleAttr){this.setTitle(titleAttr)}var useHandCursor=this.options.forceHandCursor===true||_getStyle(element,\"cursor\")===\"pointer\";_setHandCursor.call(this,useHandCursor);return this};ZeroClipboard.prototype.setText=function(newText){if(newText&&newText!==\"\"){this.options.text=newText;if(this.ready())this.flashBridge.setText(newText)}return this};ZeroClipboard.prototype.setTitle=function(newTitle){if(newTitle&&newTitle!==\"\")this.htmlBridge.setAttribute(\"title\",newTitle);return this};ZeroClipboard.prototype.setSize=function(width,height){if(this.ready())this.flashBridge.setSize(width,height);return this};ZeroClipboard.prototype.setHandCursor=function(enabled){enabled=typeof enabled===\"boolean\"?enabled:!!enabled;_setHandCursor.call(this,enabled);this.options.forceHandCursor=enabled;return this};var _setHandCursor=function(enabled){if(this.ready())this.flashBridge.setHandCursor(enabled)};ZeroClipboard.version=\"1.2.3\";var _defaults={moviePath:\"ZeroClipboard.swf\",trustedOrigins:null,text:null,hoverClass:\"zeroclipboard-is-hover\",activeClass:\"zeroclipboard-is-active\",allowScriptAccess:\"sameDomain\",useNoCache:true,forceHandCursor:false};ZeroClipboard.setDefaults=function(options){for(var ko in options)_defaults[ko]=options[ko]};ZeroClipboard.destroy=function(){ZeroClipboard.prototype._singleton.unglue(gluedElements);var bridge=ZeroClipboard.prototype._singleton.htmlBridge;bridge.parentNode.removeChild(bridge);delete ZeroClipboard.prototype._singleton};ZeroClipboard.detectFlashSupport=function(){var hasFlash=false;if(typeof ActiveXObject===\"function\"){try{if(new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")){hasFlash=true}}catch(error){}}if(!hasFlash&&navigator.mimeTypes[\"application/x-shockwave-flash\"]){hasFlash=true}return hasFlash};var _amdModuleId=null;var _cjsModuleId=null;var _bridge=function(){var flashBridge,len;var client=ZeroClipboard.prototype._singleton;var container=document.getElementById(\"global-zeroclipboard-html-bridge\");if(!container){var opts={};for(var ko in client.options)opts[ko]=client.options[ko];opts.amdModuleId=_amdModuleId;opts.cjsModuleId=_cjsModuleId;var flashvars=_vars(opts);var html='      <object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" id=\"global-zeroclipboard-flash-bridge\" width=\"100%\" height=\"100%\">         <param name=\"movie\" value=\"'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'\"/>         <param name=\"allowScriptAccess\" value=\"'+client.options.allowScriptAccess+'\"/>         <param name=\"scale\" value=\"exactfit\"/>         <param name=\"loop\" value=\"false\"/>         <param name=\"menu\" value=\"false\"/>         <param name=\"quality\" value=\"best\" />         <param name=\"bgcolor\" value=\"#ffffff\"/>         <param name=\"wmode\" value=\"transparent\"/>         <param name=\"flashvars\" value=\"'+flashvars+'\"/>         <embed src=\"'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'\"           loop=\"false\" menu=\"false\"           quality=\"best\" bgcolor=\"#ffffff\"           width=\"100%\" height=\"100%\"           name=\"global-zeroclipboard-flash-bridge\"           allowScriptAccess=\"always\"           allowFullScreen=\"false\"           type=\"application/x-shockwave-flash\"           wmode=\"transparent\"           pluginspage=\"http://www.macromedia.com/go/getflashplayer\"           flashvars=\"'+flashvars+'\"           scale=\"exactfit\">         </embed>       </object>';container=document.createElement(\"div\");container.id=\"global-zeroclipboard-html-bridge\";container.setAttribute(\"class\",\"global-zeroclipboard-container\");container.setAttribute(\"data-clipboard-ready\",false);container.style.position=\"absolute\";container.style.left=\"-9999px\";container.style.top=\"-9999px\";container.style.width=\"15px\";container.style.height=\"15px\";container.style.zIndex=\"9999\";container.innerHTML=html;document.body.appendChild(container)}client.htmlBridge=container;flashBridge=document[\"global-zeroclipboard-flash-bridge\"];if(flashBridge&&(len=flashBridge.length)){flashBridge=flashBridge[len-1]}client.flashBridge=flashBridge||container.children[0].lastElementChild};ZeroClipboard.prototype.resetBridge=function(){this.htmlBridge.style.left=\"-9999px\";this.htmlBridge.style.top=\"-9999px\";this.htmlBridge.removeAttribute(\"title\");this.htmlBridge.removeAttribute(\"data-clipboard-text\");_removeClass(currentElement,this.options.activeClass);currentElement=null;this.options.text=null;return this};ZeroClipboard.prototype.ready=function(){var ready=this.htmlBridge.getAttribute(\"data-clipboard-ready\");return ready===\"true\"||ready===true};ZeroClipboard.prototype.reposition=function(){if(!currentElement)return false;var pos=_getDOMObjectPosition(currentElement);this.htmlBridge.style.top=pos.top+\"px\";this.htmlBridge.style.left=pos.left+\"px\";this.htmlBridge.style.width=pos.width+\"px\";this.htmlBridge.style.height=pos.height+\"px\";this.htmlBridge.style.zIndex=pos.zIndex+1;this.setSize(pos.width,pos.height);return this};ZeroClipboard.dispatch=function(eventName,args){ZeroClipboard.prototype._singleton.receiveEvent(eventName,args)};ZeroClipboard.prototype.on=function(eventName,func){var events=eventName.toString().split(/\\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,\"\");if(!this.handlers[eventName])this.handlers[eventName]=func}if(this.handlers.noflash&&!ZeroClipboard.detectFlashSupport()){this.receiveEvent(\"onNoFlash\",null)}return this};ZeroClipboard.prototype.addEventListener=ZeroClipboard.prototype.on;ZeroClipboard.prototype.off=function(eventName,func){var events=eventName.toString().split(/\\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,\"\");for(var event in this.handlers){if(event===eventName&&this.handlers[event]===func){delete this.handlers[event]}}}return this};ZeroClipboard.prototype.removeEventListener=ZeroClipboard.prototype.off;ZeroClipboard.prototype.receiveEvent=function(eventName,args){eventName=eventName.toString().toLowerCase().replace(/^on/,\"\");var element=currentElement;var performCallbackAsync=true;switch(eventName){case\"load\":if(args&&parseFloat(args.flashVersion.replace(\",\",\".\").replace(/[^0-9\\.]/gi,\"\"))<10){this.receiveEvent(\"onWrongFlash\",{flashVersion:args.flashVersion});return}this.htmlBridge.setAttribute(\"data-clipboard-ready\",true);break;case\"mouseover\":_addClass(element,this.options.hoverClass);break;case\"mouseout\":_removeClass(element,this.options.hoverClass);this.resetBridge();break;case\"mousedown\":_addClass(element,this.options.activeClass);break;case\"mouseup\":_removeClass(element,this.options.activeClass);break;case\"datarequested\":var targetId=element.getAttribute(\"data-clipboard-target\"),targetEl=!targetId?null:document.getElementById(targetId);if(targetEl){var textContent=targetEl.value||targetEl.textContent||targetEl.innerText;if(textContent)this.setText(textContent)}else{var defaultText=element.getAttribute(\"data-clipboard-text\");if(defaultText)this.setText(defaultText)}performCallbackAsync=false;break;case\"complete\":this.options.text=null;break}if(this.handlers[eventName]){var func=this.handlers[eventName];if(typeof func===\"string\"&&typeof window[func]===\"function\"){func=window[func]}if(typeof func===\"function\"){_dispatchCallback(func,element,this,args,performCallbackAsync)}}};ZeroClipboard.prototype.glue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){if(_inArray(elements[i],gluedElements)==-1){gluedElements.push(elements[i]);_addEventHandler(elements[i],\"mouseover\",_elementMouseOver)}}return this};ZeroClipboard.prototype.unglue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){_removeEventHandler(elements[i],\"mouseover\",_elementMouseOver);var arrayIndex=_inArray(elements[i],gluedElements);if(arrayIndex!=-1)gluedElements.splice(arrayIndex,1)}return this};if(typeof define===\"function\"&&define.amd){define([\"require\",\"exports\",\"module\"],function(require,exports,module){_amdModuleId=module&&module.id||null;\nreturn ZeroClipboard})}else if(typeof module===\"object\"&&module&&typeof module.exports===\"object\"&&module.exports){_cjsModuleId=module.id||null;module.exports=ZeroClipboard}else{window.ZeroClipboard=ZeroClipboard}})();var Handlebars={};(function(Handlebars,undefined){Handlebars.VERSION=\"1.0.0\";Handlebars.COMPILER_REVISION=4;Handlebars.REVISION_CHANGES={1:\"<= 1.0.rc.2\",2:\"== 1.0.0-rc.3\",3:\"== 1.0.0-rc.4\",4:\">= 1.0.0\"};Handlebars.helpers={};Handlebars.partials={};var toString=Object.prototype.toString,functionType=\"[object Function]\",objectType=\"[object Object]\";Handlebars.registerHelper=function(name,fn,inverse){if(toString.call(name)===objectType){if(inverse||fn){throw new Handlebars.Exception(\"Arg not supported with multiple helpers\")}Handlebars.Utils.extend(this.helpers,name)}else{if(inverse){fn.not=inverse}this.helpers[name]=fn}};Handlebars.registerPartial=function(name,str){if(toString.call(name)===objectType){Handlebars.Utils.extend(this.partials,name)}else{this.partials[name]=str}};Handlebars.registerHelper(\"helperMissing\",function(arg){if(arguments.length===2){return undefined}else{throw new Error(\"Missing helper: '\"+arg+\"'\")}});Handlebars.registerHelper(\"blockHelperMissing\",function(context,options){var inverse=options.inverse||function(){},fn=options.fn;var type=toString.call(context);if(type===functionType){context=context.call(this)}if(context===true){return fn(this)}else if(context===false||context==null){return inverse(this)}else if(type===\"[object Array]\"){if(context.length>0){return Handlebars.helpers.each(context,options)}else{return inverse(this)}}else{return fn(context)}});Handlebars.K=function(){};Handlebars.createFrame=Object.create||function(object){Handlebars.K.prototype=object;var obj=new Handlebars.K;Handlebars.K.prototype=null;return obj};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:\"debug\",1:\"info\",2:\"warn\",3:\"error\"},log:function(level,obj){if(Handlebars.logger.level<=level){var method=Handlebars.logger.methodMap[level];if(typeof console!==\"undefined\"&&console[method]){console[method].call(console,obj)}}}};Handlebars.log=function(level,obj){Handlebars.logger.log(level,obj)};Handlebars.registerHelper(\"each\",function(context,options){var fn=options.fn,inverse=options.inverse;var i=0,ret=\"\",data;var type=toString.call(context);if(type===functionType){context=context.call(this)}if(options.data){data=Handlebars.createFrame(options.data)}if(context&&typeof context===\"object\"){if(context instanceof Array){for(var j=context.length;i<j;i++){if(data){data.index=i}ret=ret+fn(context[i],{data:data})}}else{for(var key in context){if(context.hasOwnProperty(key)){if(data){data.key=key}ret=ret+fn(context[key],{data:data});i++}}}}if(i===0){ret=inverse(this)}return ret});Handlebars.registerHelper(\"if\",function(conditional,options){var type=toString.call(conditional);if(type===functionType){conditional=conditional.call(this)}if(!conditional||Handlebars.Utils.isEmpty(conditional)){return options.inverse(this)}else{return options.fn(this)}});Handlebars.registerHelper(\"unless\",function(conditional,options){return Handlebars.helpers[\"if\"].call(this,conditional,{fn:options.inverse,inverse:options.fn})});Handlebars.registerHelper(\"with\",function(context,options){var type=toString.call(context);if(type===functionType){context=context.call(this)}if(!Handlebars.Utils.isEmpty(context))return options.fn(context)});Handlebars.registerHelper(\"log\",function(context,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;Handlebars.log(level,context)});var handlebars=function(){var parser={trace:function trace(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:\"error\",5:\"EOF\",14:\"CONTENT\",15:\"COMMENT\",16:\"OPEN_BLOCK\",18:\"CLOSE\",19:\"OPEN_INVERSE\",20:\"OPEN_ENDBLOCK\",22:\"OPEN\",23:\"OPEN_UNESCAPED\",24:\"CLOSE_UNESCAPED\",25:\"OPEN_PARTIAL\",31:\"STRING\",32:\"INTEGER\",33:\"BOOLEAN\",36:\"ID\",37:\"EQUALS\",38:\"DATA\",40:\"SEP\"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];break;case 2:this.$=new yy.ProgramNode([],$$[$0]);break;case 3:this.$=new yy.ProgramNode($$[$0-2],$$[$0]);break;case 4:this.$=new yy.ProgramNode($$[$0-1],[]);break;case 5:this.$=new yy.ProgramNode($$[$0]);break;case 6:this.$=new yy.ProgramNode([],[]);break;case 7:this.$=new yy.ProgramNode([]);break;case 8:this.$=[$$[$0]];break;case 9:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 10:this.$=new yy.BlockNode($$[$0-2],$$[$0-1].inverse,$$[$0-1],$$[$0]);break;case 11:this.$=new yy.BlockNode($$[$0-2],$$[$0-1],$$[$0-1].inverse,$$[$0]);break;case 12:this.$=$$[$0];break;case 13:this.$=$$[$0];break;case 14:this.$=new yy.ContentNode($$[$0]);break;case 15:this.$=new yy.CommentNode($$[$0]);break;case 16:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1]);break;case 17:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1]);break;case 18:this.$=$$[$0-1];break;case 19:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],$$[$0-2][2]===\"&\");break;case 20:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],true);break;case 21:this.$=new yy.PartialNode($$[$0-1]);break;case 22:this.$=new yy.PartialNode($$[$0-2],$$[$0-1]);break;case 23:break;case 24:this.$=[[$$[$0-2]].concat($$[$0-1]),$$[$0]];break;case 25:this.$=[[$$[$0-1]].concat($$[$0]),null];break;case 26:this.$=[[$$[$0-1]],$$[$0]];break;case 27:this.$=[[$$[$0]],null];break;case 28:this.$=[[$$[$0]],null];break;case 29:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 30:this.$=[$$[$0]];break;case 31:this.$=$$[$0];break;case 32:this.$=new yy.StringNode($$[$0]);break;case 33:this.$=new yy.IntegerNode($$[$0]);break;case 34:this.$=new yy.BooleanNode($$[$0]);break;case 35:this.$=$$[$0];break;case 36:this.$=new yy.HashNode($$[$0]);break;case 37:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 38:this.$=[$$[$0]];break;case 39:this.$=[$$[$0-2],$$[$0]];break;case 40:this.$=[$$[$0-2],new yy.StringNode($$[$0])];break;case 41:this.$=[$$[$0-2],new yy.IntegerNode($$[$0])];break;case 42:this.$=[$$[$0-2],new yy.BooleanNode($$[$0])];break;case 43:this.$=[$$[$0-2],$$[$0]];break;case 44:this.$=new yy.PartialNameNode($$[$0]);break;case 45:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0]));break;case 46:this.$=new yy.PartialNameNode(new yy.IntegerNode($$[$0]));break;case 47:this.$=new yy.DataNode($$[$0]);break;case 48:this.$=new yy.IdNode($$[$0]);break;case 49:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]});this.$=$$[$0-2];break;case 50:this.$=[{part:$$[$0]}];break}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function parseError(str,hash){throw new Error(str)},parse:function parse(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext=\"\",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc==\"undefined\")this.lexer.yylloc={};var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError===\"function\")this.parseError=this.yy.parseError;function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n}function lex(){var token;token=self.lexer.lex()||1;if(typeof token!==\"number\"){token=self.symbols_[token]||token}return token}var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state]}else{if(symbol===null||typeof symbol==\"undefined\"){symbol=lex()}action=table[state]&&table[state][symbol]}if(typeof action===\"undefined\"||!action.length||!action[0]){var errStr=\"\";if(!recovering){expected=[];for(p in table[state])if(this.terminals_[p]&&p>2){expected.push(\"'\"+this.terminals_[p]+\"'\")}if(this.lexer.showPosition){errStr=\"Parse error on line \"+(yylineno+1)+\":\\n\"+this.lexer.showPosition()+\"\\nExpecting \"+expected.join(\", \")+\", got '\"+(this.terminals_[symbol]||symbol)+\"'\"}else{errStr=\"Parse error on line \"+(yylineno+1)+\": Unexpected \"+(symbol==1?\"end of input\":\"'\"+(this.terminals_[symbol]||symbol)+\"'\")}this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1){throw new Error(\"Parse Error: multiple actions possible at state: \"+state+\", token: \"+symbol)}switch(action[0]){case 1:stack.push(symbol);vstack.push(this.lexer.yytext);lstack.push(this.lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=this.lexer.yyleng;yytext=this.lexer.yytext;yylineno=this.lexer.yylineno;yyloc=this.lexer.yylloc;if(recovering>0)recovering--}else{symbol=preErrorSymbol;preErrorSymbol=null}break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]}r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!==\"undefined\"){return r}if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len)}stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true}}return true}};var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash)}else{throw new Error(str)}},setInput:function(input){this._input=input;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match=\"\";this.conditionStack=[\"INITIAL\"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\\r\\n?|\\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return ch},unput:function(ch){var len=ch.length;var lines=ch.split(/(?:\\r\\n?|\\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len-1);this.offset-=len;var oldLines=this.match.split(/(?:\\r\\n?|\\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1)this.yylineno-=lines.length-1;var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len]}return this},more:function(){this._more=true;return this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?\"...\":\"\")+past.substr(-20).replace(/\\n/g,\"\")},upcomingInput:function(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length)}return(next.substr(0,20)+(next.length>20?\"...\":\"\")).replace(/\\n/g,\"\")},showPosition:function(){var pre=this.pastInput();var c=new Array(pre.length+1).join(\"-\");return pre+this.upcomingInput()+\"\\n\"+c+\"^\"},next:function(){if(this.done){return this.EOF}if(!this._input)this.done=true;var token,match,tempMatch,index,col,lines;if(!this._more){this.yytext=\"\";this.match=\"\"}var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(!this.options.flex)break}}if(match){lines=match[0].match(/(?:\\r\\n?|\\n).*/g);if(lines)this.yylineno+=lines.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\\r?\\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(token)return token;else return}if(this._input===\"\"){return this.EOF}else{return this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". Unrecognized text.\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})}},lex:function lex(){var r=this.next();if(typeof r!==\"undefined\"){return r}else{return this.lex()}},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){return this.conditionStack.pop()},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function begin(condition){this.begin(condition)}};lexer.options={};lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:yy_.yytext=\"\\\\\";return 14;break;case 1:if(yy_.yytext.slice(-1)!==\"\\\\\")this.begin(\"mu\");if(yy_.yytext.slice(-1)===\"\\\\\")yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-1),this.begin(\"emu\");if(yy_.yytext)return 14;break;case 2:return 14;break;case 3:if(yy_.yytext.slice(-1)!==\"\\\\\")this.popState();if(yy_.yytext.slice(-1)===\"\\\\\")yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-1);return 14;break;case 4:yy_.yytext=yy_.yytext.substr(0,yy_.yyleng-4);this.popState();return 15;break;case 5:return 25;break;case 6:return 16;break;case 7:return 20;break;case 8:return 19;break;case 9:return 19;break;case 10:return 23;break;case 11:return 22;break;case 12:this.popState();this.begin(\"com\");break;case 13:yy_.yytext=yy_.yytext.substr(3,yy_.yyleng-5);this.popState();return 15;break;case 14:return 22;break;case 15:return 37;break;case 16:return 36;break;case 17:return 36;break;case 18:return 40;break;case 19:break;case 20:this.popState();return 24;break;case 21:this.popState();return 18;break;case 22:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2).replace(/\\\\\"/g,'\"');return 31;break;case 23:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2).replace(/\\\\'/g,\"'\");return 31;break;case 24:return 38;break;case 25:return 33;break;case 26:return 33;break;case 27:return 32;break;case 28:return 36;break;case 29:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2);return 36;break;case 30:return\"INVALID\";break;case 31:return 5;break}};lexer.rules=[/^(?:\\\\\\\\(?=(\\{\\{)))/,/^(?:[^\\x00]*?(?=(\\{\\{)))/,/^(?:[^\\x00]+)/,/^(?:[^\\x00]{2,}?(?=(\\{\\{|$)))/,/^(?:[\\s\\S]*?--\\}\\})/,/^(?:\\{\\{>)/,/^(?:\\{\\{#)/,/^(?:\\{\\{\\/)/,/^(?:\\{\\{\\^)/,/^(?:\\{\\{\\s*else\\b)/,/^(?:\\{\\{\\{)/,/^(?:\\{\\{&)/,/^(?:\\{\\{!--)/,/^(?:\\{\\{![\\s\\S]*?\\}\\})/,/^(?:\\{\\{)/,/^(?:=)/,/^(?:\\.(?=[}\\/ ]))/,/^(?:\\.\\.)/,/^(?:[\\/.])/,/^(?:\\s+)/,/^(?:\\}\\}\\})/,/^(?:\\}\\})/,/^(?:\"(\\\\[\"]|[^\"])*\")/,/^(?:'(\\\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\\s]))/,/^(?:false(?=[}\\s]))/,/^(?:-?[0-9]+(?=[}\\s]))/,/^(?:[^\\s!\"#%-,\\.\\/;->@\\[-\\^`\\{-~]+(?=[=}\\s\\/.]))/,/^(?:\\[[^\\]]*\\])/,/^(?:.)/,/^(?:$)/];lexer.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:false},emu:{rules:[3],inclusive:false},com:{rules:[4],inclusive:false},INITIAL:{rules:[0,1,2,31],inclusive:true}};return lexer}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();Handlebars.Parser=handlebars;Handlebars.parse=function(input){if(input.constructor===Handlebars.AST.ProgramNode){return input}Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(input)};Handlebars.AST={};Handlebars.AST.ProgramNode=function(statements,inverse){this.type=\"program\";this.statements=statements;if(inverse){this.inverse=new Handlebars.AST.ProgramNode(inverse)}};Handlebars.AST.MustacheNode=function(rawParams,hash,unescaped){this.type=\"mustache\";this.escaped=!unescaped;this.hash=hash;var id=this.id=rawParams[0];var params=this.params=rawParams.slice(1);var eligibleHelper=this.eligibleHelper=id.isSimple;this.isHelper=eligibleHelper&&(params.length||hash)};Handlebars.AST.PartialNode=function(partialName,context){this.type=\"partial\";this.partialName=partialName;this.context=context};Handlebars.AST.BlockNode=function(mustache,program,inverse,close){var verifyMatch=function(open,close){if(open.original!==close.original){throw new Handlebars.Exception(open.original+\" doesn't match \"+close.original)}};verifyMatch(mustache.id,close);this.type=\"block\";this.mustache=mustache;this.program=program;this.inverse=inverse;if(this.inverse&&!this.program){this.isInverse=true}};Handlebars.AST.ContentNode=function(string){this.type=\"content\";this.string=string};Handlebars.AST.HashNode=function(pairs){this.type=\"hash\";this.pairs=pairs};Handlebars.AST.IdNode=function(parts){this.type=\"ID\";var original=\"\",dig=[],depth=0;for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part;original+=(parts[i].separator||\"\")+part;if(part===\"..\"||part===\".\"||part===\"this\"){if(dig.length>0){throw new Handlebars.Exception(\"Invalid path: \"+original)}else if(part===\"..\"){depth++}else{this.isScoped=true}}else{dig.push(part)}}this.original=original;this.parts=dig;this.string=dig.join(\".\");this.depth=depth;this.isSimple=parts.length===1&&!this.isScoped&&depth===0;this.stringModeValue=this.string};Handlebars.AST.PartialNameNode=function(name){this.type=\"PARTIAL_NAME\";this.name=name.original};Handlebars.AST.DataNode=function(id){this.type=\"DATA\";this.id=id};Handlebars.AST.StringNode=function(string){this.type=\"STRING\";this.original=this.string=this.stringModeValue=string};Handlebars.AST.IntegerNode=function(integer){this.type=\"INTEGER\";this.original=this.integer=integer;this.stringModeValue=Number(integer)};Handlebars.AST.BooleanNode=function(bool){this.type=\"BOOLEAN\";this.bool=bool;this.stringModeValue=bool===\"true\"};Handlebars.AST.CommentNode=function(comment){this.type=\"comment\";this.comment=comment};var errorProps=[\"description\",\"fileName\",\"lineNumber\",\"message\",\"name\",\"number\",\"stack\"];Handlebars.Exception=function(message){var tmp=Error.prototype.constructor.apply(this,arguments);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]]}};Handlebars.Exception.prototype=new Error;Handlebars.SafeString=function(string){this.string=string};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};var escape={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"};var badChars=/[&<>\"'`]/g;var possible=/[&<>\"'`]/;var escapeChar=function(chr){return escape[chr]||\"&amp;\"};Handlebars.Utils={extend:function(obj,value){for(var key in value){if(value.hasOwnProperty(key)){obj[key]=value[key]}}},escapeExpression:function(string){if(string instanceof Handlebars.SafeString){return string.toString()}else if(string==null||string===false){return\"\"}string=string.toString();if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)},isEmpty:function(value){if(!value&&value!==0){return true}else if(toString.call(value)===\"[object Array]\"&&value.length===0){return true}else{return false}}};var Compiler=Handlebars.Compiler=function(){};var JavaScriptCompiler=Handlebars.JavaScriptCompiler=function(){};Compiler.prototype={compiler:Compiler,disassemble:function(){var opcodes=this.opcodes,opcode,out=[],params,param;for(var i=0,l=opcodes.length;i<l;i++){opcode=opcodes[i];if(opcode.opcode===\"DECLARE\"){out.push(\"DECLARE \"+opcode.name+\"=\"+opcode.value)}else{params=[];for(var j=0;j<opcode.args.length;j++){param=opcode.args[j];if(typeof param===\"string\"){param='\"'+param.replace(\"\\n\",\"\\\\n\")+'\"'}params.push(param)}out.push(opcode.opcode+\" \"+params.join(\" \"))}}return out.join(\"\\n\")},equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len){return false}for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||opcode.args.length!==otherOpcode.args.length){return false}for(var j=0;j<opcode.args.length;j++){if(opcode.args[j]!==otherOpcode.args[j]){return false}}}len=this.children.length;if(other.children.length!==len){return false}for(i=0;i<len;i++){if(!this.children[i].equals(other.children[i])){return false}}return true},guid:0,compile:function(program,options){this.children=[];this.depths={list:[]};this.options=options;var knownHelpers=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,\"if\":true,unless:true,\"with\":true,log:true};if(knownHelpers){for(var name in knownHelpers){this.options.knownHelpers[name]=knownHelpers[name]}}return this.program(program)},accept:function(node){return this[node.type](node)},program:function(program){var statements=program.statements,statement;this.opcodes=[];for(var i=0,l=statements.length;i<l;i++){statement=statements[i];this[statement.type](statement)}this.isSimple=l===1;this.depths.list=this.depths.list.sort(function(a,b){return a-b});return this},compileProgram:function(program){var result=(new this.compiler).compile(program,this.options);var guid=this.guid++,depth;this.usePartial=this.usePartial||result.usePartial;this.children[guid]=result;for(var i=0,l=result.depths.list.length;i<l;i++){depth=result.depths.list[i];if(depth<2){continue}else{this.addDepth(depth-1)}}return guid},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;if(program){program=this.compileProgram(program)}if(inverse){inverse=this.compileProgram(inverse)}var type=this.classifyMustache(mustache);if(type===\"helper\"){this.helperMustache(mustache,program,inverse)}else if(type===\"simple\"){this.simpleMustache(mustache);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"emptyHash\");this.opcode(\"blockValue\")}else{this.ambiguousMustache(mustache,program,inverse);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"emptyHash\");this.opcode(\"ambiguousBlockValue\")}this.opcode(\"append\")},hash:function(hash){var pairs=hash.pairs,pair,val;this.opcode(\"pushHash\");for(var i=0,l=pairs.length;i<l;i++){pair=pairs[i];val=pair[1];if(this.options.stringParams){if(val.depth){this.addDepth(val.depth)}this.opcode(\"getContext\",val.depth||0);this.opcode(\"pushStringParam\",val.stringModeValue,val.type)}else{this.accept(val)}this.opcode(\"assignToHash\",pair[0])}this.opcode(\"popHash\")},partial:function(partial){var partialName=partial.partialName;this.usePartial=true;if(partial.context){this.ID(partial.context)}else{this.opcode(\"push\",\"depth0\")}this.opcode(\"invokePartial\",partialName.name);this.opcode(\"append\")},content:function(content){this.opcode(\"appendContent\",content.string)},mustache:function(mustache){var options=this.options;var type=this.classifyMustache(mustache);if(type===\"simple\"){this.simpleMustache(mustache)}else if(type===\"helper\"){this.helperMustache(mustache)}else{this.ambiguousMustache(mustache)}if(mustache.escaped&&!options.noEscape){this.opcode(\"appendEscaped\")}else{this.opcode(\"append\")}},ambiguousMustache:function(mustache,program,inverse){var id=mustache.id,name=id.parts[0],isBlock=program!=null||inverse!=null;this.opcode(\"getContext\",id.depth);this.opcode(\"pushProgram\",program);this.opcode(\"pushProgram\",inverse);this.opcode(\"invokeAmbiguous\",name,isBlock)},simpleMustache:function(mustache){var id=mustache.id;if(id.type===\"DATA\"){this.DATA(id)}else if(id.parts.length){this.ID(id)}else{this.addDepth(id.depth);this.opcode(\"getContext\",id.depth);this.opcode(\"pushContext\")}this.opcode(\"resolvePossibleLambda\")},helperMustache:function(mustache,program,inverse){var params=this.setupFullMustacheParams(mustache,program,inverse),name=mustache.id.parts[0];if(this.options.knownHelpers[name]){this.opcode(\"invokeKnownHelper\",params.length,name)}else if(this.options.knownHelpersOnly){throw new Error(\"You specified knownHelpersOnly, but used the unknown helper \"+name)}else{this.opcode(\"invokeHelper\",params.length,name)}},ID:function(id){this.addDepth(id.depth);this.opcode(\"getContext\",id.depth);var name=id.parts[0];if(!name){this.opcode(\"pushContext\")}else{this.opcode(\"lookupOnContext\",id.parts[0])}for(var i=1,l=id.parts.length;i<l;i++){this.opcode(\"lookup\",id.parts[i])}},DATA:function(data){this.options.data=true;if(data.id.isScoped||data.id.depth){throw new Handlebars.Exception(\"Scoped data references are not supported: \"+data.original)}this.opcode(\"lookupData\");var parts=data.id.parts;for(var i=0,l=parts.length;i<l;i++){this.opcode(\"lookup\",parts[i])}},STRING:function(string){this.opcode(\"pushString\",string.string)},INTEGER:function(integer){this.opcode(\"pushLiteral\",integer.integer)},BOOLEAN:function(bool){this.opcode(\"pushLiteral\",bool.bool)},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:[].slice.call(arguments,1)})},declare:function(name,value){this.opcodes.push({opcode:\"DECLARE\",name:name,value:value})},addDepth:function(depth){if(isNaN(depth)){throw new Error(\"EWOT\")}if(depth===0){return}if(!this.depths[depth]){this.depths[depth]=true;this.depths.list.push(depth)}},classifyMustache:function(mustache){var isHelper=mustache.isHelper;var isEligible=mustache.eligibleHelper;var options=this.options;if(isEligible&&!isHelper){var name=mustache.id.parts[0];if(options.knownHelpers[name]){isHelper=true}else if(options.knownHelpersOnly){isEligible=false}}if(isHelper){return\"helper\"}else if(isEligible){return\"ambiguous\"}else{return\"simple\"}},pushParams:function(params){var i=params.length,param;while(i--){param=params[i];if(this.options.stringParams){if(param.depth){this.addDepth(param.depth)}this.opcode(\"getContext\",param.depth||0);this.opcode(\"pushStringParam\",param.stringModeValue,param.type)}else{this[param.type](param)}}},setupMustacheParams:function(mustache){var params=mustache.params;this.pushParams(params);if(mustache.hash){this.hash(mustache.hash)}else{this.opcode(\"emptyHash\")}return params},setupFullMustacheParams:function(mustache,program,inverse){var params=mustache.params;this.pushParams(params);this.opcode(\"pushProgram\",program);\nthis.opcode(\"pushProgram\",inverse);if(mustache.hash){this.hash(mustache.hash)}else{this.opcode(\"emptyHash\")}return params}};var Literal=function(value){this.value=value};JavaScriptCompiler.prototype={nameLookup:function(parent,name){if(/^[0-9]+$/.test(name)){return parent+\"[\"+name+\"]\"}else if(JavaScriptCompiler.isValidJavaScriptVariableName(name)){return parent+\".\"+name}else{return parent+\"['\"+name+\"']\"}},appendToBuffer:function(string){if(this.environment.isSimple){return\"return \"+string+\";\"}else{return{appendToBuffer:true,content:string,toString:function(){return\"buffer += \"+string+\";\"}}}},initializeBuffer:function(){return this.quotedString(\"\")},namespace:\"Handlebars\",compile:function(environment,options,context,asObject){this.environment=environment;this.options=options||{};Handlebars.log(Handlebars.logger.DEBUG,this.environment.disassemble()+\"\\n\\n\");this.name=this.environment.name;this.isChild=!!context;this.context=context||{programs:[],environments:[],aliases:{}};this.preamble();this.stackSlot=0;this.stackVars=[];this.registers={list:[]};this.compileStack=[];this.inlineStack=[];this.compileChildren(environment,options);var opcodes=environment.opcodes,opcode;this.i=0;for(l=opcodes.length;this.i<l;this.i++){opcode=opcodes[this.i];if(opcode.opcode===\"DECLARE\"){this[opcode.name]=opcode.value}else{this[opcode.opcode].apply(this,opcode.args)}}return this.createFunctionContext(asObject)},nextOpcode:function(){var opcodes=this.environment.opcodes;return opcodes[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var out=[];if(!this.isChild){var namespace=this.namespace;var copies=\"helpers = this.merge(helpers, \"+namespace+\".helpers);\";if(this.environment.usePartial){copies=copies+\" partials = this.merge(partials, \"+namespace+\".partials);\"}if(this.options.data){copies=copies+\" data = data || {};\"}out.push(copies)}else{out.push(\"\")}if(!this.environment.isSimple){out.push(\", buffer = \"+this.initializeBuffer())}else{out.push(\"\")}this.lastContext=0;this.source=out},createFunctionContext:function(asObject){var locals=this.stackVars.concat(this.registers.list);if(locals.length>0){this.source[1]=this.source[1]+\", \"+locals.join(\", \")}if(!this.isChild){for(var alias in this.context.aliases){if(this.context.aliases.hasOwnProperty(alias)){this.source[1]=this.source[1]+\", \"+alias+\"=\"+this.context.aliases[alias]}}}if(this.source[1]){this.source[1]=\"var \"+this.source[1].substring(2)+\";\"}if(!this.isChild){this.source[1]+=\"\\n\"+this.context.programs.join(\"\\n\")+\"\\n\"}if(!this.environment.isSimple){this.source.push(\"return buffer;\")}var params=this.isChild?[\"depth0\",\"data\"]:[\"Handlebars\",\"depth0\",\"helpers\",\"partials\",\"data\"];for(var i=0,l=this.environment.depths.list.length;i<l;i++){params.push(\"depth\"+this.environment.depths.list[i])}var source=this.mergeSource();if(!this.isChild){var revision=Handlebars.COMPILER_REVISION,versions=Handlebars.REVISION_CHANGES[revision];source=\"this.compilerInfo = [\"+revision+\",'\"+versions+\"'];\\n\"+source}if(asObject){params.push(source);return Function.apply(this,params)}else{var functionSource=\"function \"+(this.name||\"\")+\"(\"+params.join(\",\")+\") {\\n  \"+source+\"}\";Handlebars.log(Handlebars.logger.DEBUG,functionSource+\"\\n\\n\");return functionSource}},mergeSource:function(){var source=\"\",buffer;for(var i=0,len=this.source.length;i<len;i++){var line=this.source[i];if(line.appendToBuffer){if(buffer){buffer=buffer+\"\\n    + \"+line.content}else{buffer=line.content}}else{if(buffer){source+=\"buffer += \"+buffer+\";\\n  \";buffer=undefined}source+=line+\"\\n  \"}}return source},blockValue:function(){this.context.aliases.blockHelperMissing=\"helpers.blockHelperMissing\";var params=[\"depth0\"];this.setupParams(0,params);this.replaceStack(function(current){params.splice(1,0,current);return\"blockHelperMissing.call(\"+params.join(\", \")+\")\"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing=\"helpers.blockHelperMissing\";var params=[\"depth0\"];this.setupParams(0,params);var current=this.topStack();params.splice(1,0,current);params[params.length-1]=\"options\";this.source.push(\"if (!\"+this.lastHelper+\") { \"+current+\" = blockHelperMissing.call(\"+params.join(\", \")+\"); }\")},appendContent:function(content){this.source.push(this.appendToBuffer(this.quotedString(content)))},append:function(){this.flushInline();var local=this.popStack();this.source.push(\"if(\"+local+\" || \"+local+\" === 0) { \"+this.appendToBuffer(local)+\" }\");if(this.environment.isSimple){this.source.push(\"else { \"+this.appendToBuffer(\"''\")+\" }\")}},appendEscaped:function(){this.context.aliases.escapeExpression=\"this.escapeExpression\";this.source.push(this.appendToBuffer(\"escapeExpression(\"+this.popStack()+\")\"))},getContext:function(depth){if(this.lastContext!==depth){this.lastContext=depth}},lookupOnContext:function(name){this.push(this.nameLookup(\"depth\"+this.lastContext,name,\"context\"))},pushContext:function(){this.pushStackLiteral(\"depth\"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='\"function\"';this.replaceStack(function(current){return\"typeof \"+current+\" === functionType ? \"+current+\".apply(depth0) : \"+current})},lookup:function(name){this.replaceStack(function(current){return current+\" == null || \"+current+\" === false ? \"+current+\" : \"+this.nameLookup(current,name,\"context\")})},lookupData:function(id){this.push(\"data\")},pushStringParam:function(string,type){this.pushStackLiteral(\"depth\"+this.lastContext);this.pushString(type);if(typeof string===\"string\"){this.pushString(string)}else{this.pushStackLiteral(string)}},emptyHash:function(){this.pushStackLiteral(\"{}\");if(this.options.stringParams){this.register(\"hashTypes\",\"{}\");this.register(\"hashContexts\",\"{}\")}},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var hash=this.hash;this.hash=undefined;if(this.options.stringParams){this.register(\"hashContexts\",\"{\"+hash.contexts.join(\",\")+\"}\");this.register(\"hashTypes\",\"{\"+hash.types.join(\",\")+\"}\")}this.push(\"{\\n    \"+hash.values.join(\",\\n    \")+\"\\n  }\")},pushString:function(string){this.pushStackLiteral(this.quotedString(string))},push:function(expr){this.inlineStack.push(expr);return expr},pushLiteral:function(value){this.pushStackLiteral(value)},pushProgram:function(guid){if(guid!=null){this.pushStackLiteral(this.programExpression(guid))}else{this.pushStackLiteral(null)}},invokeHelper:function(paramSize,name){this.context.aliases.helperMissing=\"helpers.helperMissing\";var helper=this.lastHelper=this.setupHelper(paramSize,name,true);var nonHelper=this.nameLookup(\"depth\"+this.lastContext,name,\"context\");this.push(helper.name+\" || \"+nonHelper);this.replaceStack(function(name){return name+\" ? \"+name+\".call(\"+helper.callParams+\") \"+\": helperMissing.call(\"+helper.helperMissingParams+\")\"})},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+\".call(\"+helper.callParams+\")\")},invokeAmbiguous:function(name,helperCall){this.context.aliases.functionType='\"function\"';this.pushStackLiteral(\"{}\");var helper=this.setupHelper(0,name,helperCall);var helperName=this.lastHelper=this.nameLookup(\"helpers\",name,\"helper\");var nonHelper=this.nameLookup(\"depth\"+this.lastContext,name,\"context\");var nextStack=this.nextStack();this.source.push(\"if (\"+nextStack+\" = \"+helperName+\") { \"+nextStack+\" = \"+nextStack+\".call(\"+helper.callParams+\"); }\");this.source.push(\"else { \"+nextStack+\" = \"+nonHelper+\"; \"+nextStack+\" = typeof \"+nextStack+\" === functionType ? \"+nextStack+\".apply(depth0) : \"+nextStack+\"; }\")},invokePartial:function(name){var params=[this.nameLookup(\"partials\",name,\"partial\"),\"'\"+name+\"'\",this.popStack(),\"helpers\",\"partials\"];if(this.options.data){params.push(\"data\")}this.context.aliases.self=\"this\";this.push(\"self.invokePartial(\"+params.join(\", \")+\")\")},assignToHash:function(key){var value=this.popStack(),context,type;if(this.options.stringParams){type=this.popStack();context=this.popStack()}var hash=this.hash;if(context){hash.contexts.push(\"'\"+key+\"': \"+context)}if(type){hash.types.push(\"'\"+key+\"': \"+type)}hash.values.push(\"'\"+key+\"': (\"+value+\")\")},compiler:JavaScriptCompiler,compileChildren:function(environment,options){var children=environment.children,child,compiler;for(var i=0,l=children.length;i<l;i++){child=children[i];compiler=new this.compiler;var index=this.matchExistingProgram(child);if(index==null){this.context.programs.push(\"\");index=this.context.programs.length;child.index=index;child.name=\"program\"+index;this.context.programs[index]=compiler.compile(child,options,this.context);this.context.environments[index]=child}else{child.index=index;child.name=\"program\"+index}}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child)){return i}}},programExpression:function(guid){this.context.aliases.self=\"this\";if(guid==null){return\"self.noop\"}var child=this.environment.children[guid],depths=child.depths.list,depth;var programParams=[child.index,child.name,\"data\"];for(var i=0,l=depths.length;i<l;i++){depth=depths[i];if(depth===1){programParams.push(\"depth0\")}else{programParams.push(\"depth\"+(depth-1))}}return(depths.length===0?\"self.program(\":\"self.programWithDepth(\")+programParams.join(\", \")+\")\"},register:function(name,val){this.useRegister(name);this.source.push(name+\" = \"+val+\";\")},useRegister:function(name){if(!this.registers[name]){this.registers[name]=true;this.registers.list.push(name)}},pushStackLiteral:function(item){return this.push(new Literal(item))},pushStack:function(item){this.flushInline();var stack=this.incrStack();if(item){this.source.push(stack+\" = \"+item+\";\")}this.compileStack.push(stack);return stack},replaceStack:function(callback){var prefix=\"\",inline=this.isInline(),stack;if(inline){var top=this.popStack(true);if(top instanceof Literal){stack=top.value}else{var name=this.stackSlot?this.topStackName():this.incrStack();prefix=\"(\"+this.push(name)+\" = \"+top+\"),\";stack=this.topStack()}}else{stack=this.topStack()}var item=callback.call(this,stack);if(inline){if(this.inlineStack.length||this.compileStack.length){this.popStack()}this.push(\"(\"+prefix+item+\")\")}else{if(!/^stack/.test(stack)){stack=this.nextStack()}this.source.push(stack+\" = (\"+prefix+item+\");\")}return stack},nextStack:function(){return this.pushStack()},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push(\"stack\"+this.stackSlot)}return this.topStackName()},topStackName:function(){return\"stack\"+this.stackSlot},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];if(entry instanceof Literal){this.compileStack.push(entry)}else{this.pushStack(entry)}}}},isInline:function(){return this.inlineStack.length},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal){return item.value}else{if(!inline){this.stackSlot--}return item}},topStack:function(wrapped){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];if(!wrapped&&item instanceof Literal){return item.value}else{return item}},quotedString:function(str){return'\"'+str.replace(/\\\\/g,\"\\\\\\\\\").replace(/\"/g,'\\\\\"').replace(/\\n/g,\"\\\\n\").replace(/\\r/g,\"\\\\r\").replace(/\\u2028/g,\"\\\\u2028\").replace(/\\u2029/g,\"\\\\u2029\")+'\"'},setupHelper:function(paramSize,name,missingParams){var params=[];this.setupParams(paramSize,params,missingParams);var foundHelper=this.nameLookup(\"helpers\",name,\"helper\");return{params:params,name:foundHelper,callParams:[\"depth0\"].concat(params).join(\", \"),helperMissingParams:missingParams&&[\"depth0\",this.quotedString(name)].concat(params).join(\", \")}},setupParams:function(paramSize,params,useRegister){var options=[],contexts=[],types=[],param,inverse,program;options.push(\"hash:\"+this.popStack());inverse=this.popStack();program=this.popStack();if(program||inverse){if(!program){this.context.aliases.self=\"this\";program=\"self.noop\"}if(!inverse){this.context.aliases.self=\"this\";inverse=\"self.noop\"}options.push(\"inverse:\"+inverse);options.push(\"fn:\"+program)}for(var i=0;i<paramSize;i++){param=this.popStack();params.push(param);if(this.options.stringParams){types.push(this.popStack());contexts.push(this.popStack())}}if(this.options.stringParams){options.push(\"contexts:[\"+contexts.join(\",\")+\"]\");options.push(\"types:[\"+types.join(\",\")+\"]\");options.push(\"hashContexts:hashContexts\");options.push(\"hashTypes:hashTypes\")}if(this.options.data){options.push(\"data:data\")}options=\"{\"+options.join(\",\")+\"}\";if(useRegister){this.register(\"options\",options);params.push(\"options\")}else{params.push(options)}return params.join(\", \")}};var reservedWords=(\"break else new var\"+\" case finally return void\"+\" catch for switch while\"+\" continue function this with\"+\" default if throw\"+\" delete in try\"+\" do instanceof typeof\"+\" abstract enum int short\"+\" boolean export interface static\"+\" byte extends long super\"+\" char final native synchronized\"+\" class float package throws\"+\" const goto private transient\"+\" debugger implements protected volatile\"+\" double import public let yield\").split(\" \");var compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++){compilerWords[reservedWords[i]]=true}JavaScriptCompiler.isValidJavaScriptVariableName=function(name){if(!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(name)){return true}return false};Handlebars.precompile=function(input,options){if(input==null||typeof input!==\"string\"&&input.constructor!==Handlebars.AST.ProgramNode){throw new Handlebars.Exception(\"You must pass a string or Handlebars AST to Handlebars.precompile. You passed \"+input)}options=options||{};if(!(\"data\"in options)){options.data=true}var ast=Handlebars.parse(input);var environment=(new Compiler).compile(ast,options);return(new JavaScriptCompiler).compile(environment,options)};Handlebars.compile=function(input,options){if(input==null||typeof input!==\"string\"&&input.constructor!==Handlebars.AST.ProgramNode){throw new Handlebars.Exception(\"You must pass a string or Handlebars AST to Handlebars.compile. You passed \"+input)}options=options||{};if(!(\"data\"in options)){options.data=true}var compiled;function compile(){var ast=Handlebars.parse(input);var environment=(new Compiler).compile(ast,options);var templateSpec=(new JavaScriptCompiler).compile(environment,options,undefined,true);return Handlebars.template(templateSpec)}return function(context,options){if(!compiled){compiled=compile()}return compiled.call(this,context,options)}};Handlebars.VM={template:function(templateSpec){var container={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(i,fn,data){var programWrapper=this.programs[i];if(data){programWrapper=Handlebars.VM.program(i,fn,data)}else if(!programWrapper){programWrapper=this.programs[i]=Handlebars.VM.program(i,fn)}return programWrapper},merge:function(param,common){var ret=param||common;if(param&&common){ret={};Handlebars.Utils.extend(ret,common);Handlebars.Utils.extend(ret,param)}return ret},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop,compilerInfo:null};return function(context,options){options=options||{};var result=templateSpec.call(container,Handlebars,context,options.helpers,options.partials,options.data);var compilerInfo=container.compilerInfo||[],compilerRevision=compilerInfo[0]||1,currentRevision=Handlebars.COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=Handlebars.REVISION_CHANGES[currentRevision],compilerVersions=Handlebars.REVISION_CHANGES[compilerRevision];throw\"Template was precompiled with an older version of Handlebars than the current runtime. \"+\"Please update your precompiler to a newer version (\"+runtimeVersions+\") or downgrade your runtime to an older version (\"+compilerVersions+\").\"}else{throw\"Template was precompiled with a newer version of Handlebars than the current runtime. \"+\"Please update your runtime to a newer version (\"+compilerInfo[1]+\").\"}}return result}},programWithDepth:function(i,fn,data){var args=Array.prototype.slice.call(arguments,3);var program=function(context,options){options=options||{};return fn.apply(this,[context,options.data||data].concat(args))};program.program=i;program.depth=args.length;return program},program:function(i,fn,data){var program=function(context,options){options=options||{};return fn(context,options.data||data)};program.program=i;program.depth=0;return program},noop:function(){return\"\"},invokePartial:function(partial,name,context,helpers,partials,data){var options={helpers:helpers,partials:partials,data:data};if(partial===undefined){throw new Handlebars.Exception(\"The partial \"+name+\" could not be found\")}else if(partial instanceof Function){return partial(context,options)}else if(!Handlebars.compile){throw new Handlebars.Exception(\"The partial \"+name+\" could not be compiled when running in runtime-only mode\")}else{partials[name]=Handlebars.compile(partial,{data:data!==undefined});return partials[name](context,options)}}};Handlebars.template=Handlebars.VM.template})(Handlebars);function printStackTrace(options){options=options||{guess:true};var ex=options.e||null,guess=!!options.guess;var p=new printStackTrace.implementation,result=p.run(ex);return guess?p.guessAnonymousFunctions(result):result}if(typeof module!==\"undefined\"&&module.exports){module.exports=printStackTrace}printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(ex,mode){ex=ex||this.createException();mode=mode||this.mode(ex);if(mode===\"other\"){return this.other(arguments.callee)}else{return this[mode](ex)}},createException:function(){try{this.undef()}catch(e){return e}},mode:function(e){if(e[\"arguments\"]&&e.stack){return\"chrome\"}else if(e.stack&&e.sourceURL){return\"safari\"}else if(e.stack&&e.number){return\"ie\"}else if(typeof e.message===\"string\"&&typeof window!==\"undefined\"&&window.opera){if(!e.stacktrace){return\"opera9\"}if(e.message.indexOf(\"\\n\")>-1&&e.message.split(\"\\n\").length>e.stacktrace.split(\"\\n\").length){return\"opera9\"}if(!e.stack){return\"opera10a\"}if(e.stacktrace.indexOf(\"called from line\")<0){return\"opera10b\"}return\"opera11\"}else if(e.stack&&!e.fileName){return\"chrome\"}else if(e.stack){return\"firefox\"}return\"other\"},instrumentFunction:function(context,functionName,callback){context=context||window;var original=context[functionName];context[functionName]=function instrumented(){callback.call(this,printStackTrace().slice(4));return context[functionName]._instrumented.apply(this,arguments)};context[functionName]._instrumented=original},deinstrumentFunction:function(context,functionName){if(context[functionName].constructor===Function&&context[functionName]._instrumented&&context[functionName]._instrumented.constructor===Function){context[functionName]=context[functionName]._instrumented}},chrome:function(e){var stack=(e.stack+\"\\n\").replace(/^\\S[^\\(]+?[\\n$]/gm,\"\").replace(/^\\s+(at eval )?at\\s+/gm,\"\").replace(/^([^\\(]+?)([\\n$])/gm,\"{anonymous}()@$1$2\").replace(/^Object.<anonymous>\\s*\\(([^\\)]+)\\)/gm,\"{anonymous}()@$1\").split(\"\\n\");stack.pop();return stack},safari:function(e){return e.stack.replace(/\\[native code\\]\\n/m,\"\").replace(/^(?=\\w+Error\\:).*$\\n/m,\"\").replace(/^@/gm,\"{anonymous}()@\").split(\"\\n\")},ie:function(e){var lineRE=/^.*at (\\w+) \\(([^\\)]+)\\)$/gm;return e.stack.replace(/at Anonymous function /gm,\"{anonymous}()@\").replace(/^(?=\\w+Error\\:).*$\\n/m,\"\").replace(lineRE,\"$1@$2\").split(\"\\n\")},firefox:function(e){return e.stack.replace(/(?:\\n@:0)?\\s+$/m,\"\").replace(/^[\\(@]/gm,\"{anonymous}()@\").split(\"\\n\")},opera11:function(e){var ANON=\"{anonymous}\",lineRE=/^.*line (\\d+), column (\\d+)(?: in (.+))? in (\\S+):$/;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var location=match[4]+\":\"+match[1]+\":\"+match[2];var fnName=match[3]||\"global code\";fnName=fnName.replace(/<anonymous function: (\\S+)>/,\"$1\").replace(/<anonymous function>/,ANON);result.push(fnName+\"@\"+location+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},opera10b:function(e){var lineRE=/^(.*)@(.+):(\\d+)$/;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i++){var match=lineRE.exec(lines[i]);if(match){var fnName=match[1]?match[1]+\"()\":\"global code\";result.push(fnName+\"@\"+match[2]+\":\"+match[3])}}return result},opera10a:function(e){var ANON=\"{anonymous}\",lineRE=/Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;var lines=e.stacktrace.split(\"\\n\"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var fnName=match[3]||ANON;result.push(fnName+\"()@\"+match[2]+\":\"+match[1]+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},opera9:function(e){var ANON=\"{anonymous}\",lineRE=/Line (\\d+).*script (?:in )?(\\S+)/i;var lines=e.message.split(\"\\n\"),result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(ANON+\"()@\"+match[2]+\":\"+match[1]+\" -- \"+lines[i+1].replace(/^\\s+/,\"\"))}}return result},other:function(curr){var ANON=\"{anonymous}\",fnRE=/function\\s*([\\w\\-$]+)?\\s*\\(/i,stack=[],fn,args,maxStackSize=10;while(curr&&curr[\"arguments\"]&&stack.length<maxStackSize){fn=fnRE.test(curr.toString())?RegExp.$1||ANON:ANON;args=Array.prototype.slice.call(curr[\"arguments\"]||[]);stack[stack.length]=fn+\"(\"+this.stringifyArguments(args)+\")\";curr=curr.caller}return stack},stringifyArguments:function(args){var result=[];var slice=Array.prototype.slice;for(var i=0;i<args.length;++i){var arg=args[i];if(arg===undefined){result[i]=\"undefined\"}else if(arg===null){result[i]=\"null\"}else if(arg.constructor){if(arg.constructor===Array){if(arg.length<3){result[i]=\"[\"+this.stringifyArguments(arg)+\"]\"}else{result[i]=\"[\"+this.stringifyArguments(slice.call(arg,0,1))+\"...\"+this.stringifyArguments(slice.call(arg,-1))+\"]\"}}else if(arg.constructor===Object){result[i]=\"#object\"}else if(arg.constructor===Function){result[i]=\"#function\"}else if(arg.constructor===String){result[i]='\"'+arg+'\"'}else if(arg.constructor===Number){result[i]=arg}}}return result.join(\",\")},sourceCache:{},ajax:function(url){var req=this.createXMLHTTPObject();if(req){try{req.open(\"GET\",url,false);req.send(null);return req.responseText}catch(e){}}return\"\"},createXMLHTTPObject:function(){var xmlhttp,XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject(\"Msxml2.XMLHTTP\")},function(){return new ActiveXObject(\"Msxml3.XMLHTTP\")},function(){return new ActiveXObject(\"Microsoft.XMLHTTP\")}];for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]();this.createXMLHTTPObject=XMLHttpFactories[i];return xmlhttp}catch(e){}}},isSameDomain:function(url){return typeof location!==\"undefined\"&&url.indexOf(location.hostname)!==-1},getSource:function(url){if(!(url in this.sourceCache)){this.sourceCache[url]=this.ajax(url).split(\"\\n\")}return this.sourceCache[url]},guessAnonymousFunctions:function(stack){for(var i=0;i<stack.length;++i){var reStack=/\\{anonymous\\}\\(.*\\)@(.*)/,reRef=/^(.*?)(?::(\\d+))(?::(\\d+))?(?: -- .+)?$/,frame=stack[i],ref=reStack.exec(frame);if(ref){var m=reRef.exec(ref[1]);if(m){var file=m[1],lineno=m[2],charno=m[3]||0;if(file&&this.isSameDomain(file)&&lineno){var functionName=this.guessAnonymousFunction(file,lineno,charno);stack[i]=frame.replace(\"{anonymous}\",functionName)}}}}return stack},guessAnonymousFunction:function(url,lineNo,charNo){var ret;try{ret=this.findFunctionName(this.getSource(url),lineNo)}catch(e){ret=\"getSource failed with url: \"+url+\", exception: \"+e.toString()}return ret},findFunctionName:function(source,lineNo){var reFunctionDeclaration=/function\\s+([^(]*?)\\s*\\(([^)]*)\\)/;var reFunctionExpression=/['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*function\\b/;var reFunctionEvaluation=/['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*(?:eval|new Function)\\b/;var code=\"\",line,maxLines=Math.min(lineNo,20),m,commentPos;for(var i=0;i<maxLines;++i){line=source[lineNo-i-1];commentPos=line.indexOf(\"//\");if(commentPos>=0){line=line.substr(0,commentPos)}if(line){code=line+code;m=reFunctionExpression.exec(code);if(m&&m[1]){return m[1]}m=reFunctionDeclaration.exec(code);if(m&&m[1]){return m[1]}m=reFunctionEvaluation.exec(code);if(m&&m[1]){return m[1]}}}return\"(?)\"}};if(!window.maxkir)maxkir={};maxkir.SelectionRange=function(element){this.element=element};maxkir.SelectionRange.prototype.get_selection_range=function(){var get_sel_range=function(element){if(typeof element.selectionStart==\"undefined\"&&document.selection){var range=document.selection.createRange();var stored_range=range.duplicate();if(element.type==\"text\"){stored_range.moveStart(\"character\",-element.value.length);stored_range.moveEnd(\"character\",element.value.length)}else{stored_range.moveToElementText(element)}stored_range.setEndPoint(\"EndToEnd\",range);var selectionStart=stored_range.text.length-range.text.length;var selectionEnd=selectionStart+range.text.length;return[selectionStart,selectionEnd]}return[element.selectionStart,element.selectionEnd]};try{return get_sel_range(this.element)}catch(e){return[0,0]}};maxkir.SelectionRange.prototype.get_selection_text=function(){var r=this.get_selection_range();return this.element.value.substring(r[0],r[1])};if(!window.maxkir)maxkir={};maxkir.StringSplitter=function(width_provider_function){this.get_width=width_provider_function};maxkir.StringSplitter.prototype.splitString=function(s,max_width){if(s.length==0)return[\"\"];var prev_space_pos=-1;var width_exceeded=false;var that=this;var cut_off=function(idx){var remaining=s.substr(idx+1);if(remaining.length>0){return[s.substr(0,idx+1)].concat(that.splitString(remaining,max_width))}return[s.substr(0,idx+1)]};for(var i=0;i<s.length;i++){if(s.charAt(i)==\" \"){width_exceeded=this.get_width(s.substr(0,i))>max_width;if(width_exceeded&&prev_space_pos>0){return cut_off(prev_space_pos)}if(width_exceeded){return cut_off(i)}prev_space_pos=i}if(s.charAt(i)==\"\\n\"){return cut_off(i)}}if(prev_space_pos>0&&this.get_width(s)>max_width){return cut_off(prev_space_pos)}return[s]};if(!window.maxkir)maxkir={};maxkir.FF=/Firefox/i.test(navigator.userAgent);if(typeof document.defaultView==\"undefined\"){document.defaultView={};document.defaultView.getComputedStyle=function(element){return element.currentStyle}}maxkir.CursorPosition=function(element,padding){this.element=element;this.padding=padding;this.selection_range=new maxkir.SelectionRange(element);var that=this;this.get_string_metrics=function(s){return maxkir.CursorPosition.getTextMetrics(element,s,padding)};var splitter=new maxkir.StringSplitter(function(s){var metrics=that.get_string_metrics(s);return metrics[0]});this.split_to_lines=function(){var innerAreaWidth=element.scrollWidth;if(maxkir.FF){innerAreaWidth-=4}var pos=that.selection_range.get_selection_range()[0];return splitter.splitString(element.value.substr(0,pos),innerAreaWidth)}};maxkir.CursorPosition.prototype.getCursorCoordinates=function(){var lines=this.split_to_lines();return[lines[lines.length-1].length,lines.length]};maxkir.CursorPosition.prototype.getPixelCoordinates=function(){var lines=this.split_to_lines();var m=this.get_string_metrics(lines[lines.length-1]);var w=m[0];var h=m[1]*lines.length-this.element.scrollTop+this.padding;return[w,h]};maxkir.CursorPosition.getTextMetrics=function(styledElement,s,padding){var element=styledElement;var clone_css_style=function(target,styleName){var val=element.style[styleName];if(!val){var css=document.defaultView.getComputedStyle(element,null);val=css?css[styleName]:null}if(val){target.style[styleName]=val}};var widthElementId=\"__widther\";var div=document.getElementById(widthElementId);if(!div){div=document.createElement(\"div\");document.body.appendChild(div);div.id=widthElementId;div.style.position=\"absolute\";div.style.left=\"-10000px\"}clone_css_style(div,\"fontSize\");clone_css_style(div,\"fontFamily\");clone_css_style(div,\"fontWeight\");clone_css_style(div,\"fontVariant\");clone_css_style(div,\"fontStyle\");clone_css_style(div,\"textTransform\");clone_css_style(div,\"lineHeight\");div.style.width=\"0\";div.style.paddingLeft=padding+\"px\";div.innerHTML=s.replace(\" \",\"&nbsp;\");div.style.width=\"auto\";return[div.offsetWidth,div.offsetHeight]};(function($){$.fn.caretpixelpos=function(){if(typeof this.positioner==\"undefined\"){this.positioner=new maxkir.CursorPosition(this[0],7)}var child_pos=this.positioner.getPixelCoordinates();var t_pos=this.offset();return{left:t_pos.left+child_pos[0],top:t_pos.top+child_pos[1],childPos:{left:child_pos[0],top:child_pos[1]}}}}).call(this,jQuery);(function($){\"use strict\";var k={},max=Math.max,min=Math.min;k.c={};k.c.d=$(document);k.c.t=function(e){return e.originalEvent.touches.length-1};k.o=function(){var s=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.run=function(){var cf=function(e,conf){var k;for(k in conf){s.o[k]=conf[k]}s.init();s._configure()._draw()};if(this.$.data(\"kontroled\"))return;this.$.data(\"kontroled\",true);this.extend();this.o=$.extend({min:this.$.data(\"min\")||0,max:this.$.data(\"max\")||100,stopper:true,readOnly:this.$.data(\"readonly\"),cursor:this.$.data(\"cursor\")===true&&30||this.$.data(\"cursor\")||0,thickness:this.$.data(\"thickness\")||.35,lineCap:this.$.data(\"linecap\")||\"butt\",width:this.$.data(\"width\")||200,height:this.$.data(\"height\")||200,displayInput:this.$.data(\"displayinput\")==null||this.$.data(\"displayinput\"),displayPrevious:this.$.data(\"displayprevious\"),fgColor:this.$.data(\"fgcolor\")||\"#87CEEB\",inputColor:this.$.data(\"inputcolor\")||this.$.data(\"fgcolor\")||\"#87CEEB\",inline:false,step:this.$.data(\"step\")||1,draw:null,change:null,cancel:null,release:null},this.o);if(this.$.is(\"fieldset\")){this.v={};this.i=this.$.find(\"input\");this.i.each(function(k){var $this=$(this);s.i[k]=$this;s.v[k]=$this.val();$this.bind(\"change\",function(){var val={};val[k]=$this.val();s.val(val)})});this.$.find(\"legend\").remove()}else{this.i=this.$;this.v=this.$.val();this.v==\"\"&&(this.v=this.o.min);this.$.bind(\"change\",function(){s.val(s._validate(s.$.val()))})}!this.o.displayInput&&this.$.hide();this.$c=$('<canvas width=\"'+this.o.width+'px\" height=\"'+this.o.height+'px\"></canvas>');this.c=this.$c[0].getContext(\"2d\");this.$.wrap($('<div style=\"'+(this.o.inline?\"display:inline;\":\"\")+\"width:\"+this.o.width+\"px;height:\"+this.o.height+'px;\"></div>')).before(this.$c);if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else{this.cv=this.v}this.$.bind(\"configure\",cf).parent().bind(\"configure\",cf);this._listen()._configure()._xy().init();this.isInit=true;this._draw();return this};this._draw=function(){var d=true,c=document.createElement(\"canvas\");c.width=s.o.width;c.height=s.o.height;s.g=c.getContext(\"2d\");s.clear();s.dH&&(d=s.dH());d!==false&&s.draw();s.c.drawImage(c,0,0);c=null};this._touch=function(e){var touchMove=function(e){var v=s.xy2val(e.originalEvent.touches[s.t].pageX,e.originalEvent.touches[s.t].pageY);if(v==s.cv)return;if(s.cH&&s.cH(v)===false)return;s.change(s._validate(v));s._draw()};this.t=k.c.t(e);touchMove(e);k.c.d.bind(\"touchmove.k\",touchMove).bind(\"touchend.k\",function(){k.c.d.unbind(\"touchmove.k touchend.k\");if(s.rH&&s.rH(s.cv)===false)return;s.val(s.cv)});return this};this._mouse=function(e){var mouseMove=function(e){var v=s.xy2val(e.pageX,e.pageY);if(v==s.cv)return;if(s.cH&&s.cH(v)===false)return;s.change(s._validate(v));s._draw()};mouseMove(e);k.c.d.bind(\"mousemove.k\",mouseMove).bind(\"keyup.k\",function(e){if(e.keyCode===27){k.c.d.unbind(\"mouseup.k mousemove.k keyup.k\");if(s.eH&&s.eH()===false)return;s.cancel()}}).bind(\"mouseup.k\",function(e){k.c.d.unbind(\"mousemove.k mouseup.k keyup.k\");if(s.rH&&s.rH(s.cv)===false)return;\ns.val(s.cv)});return this};this._xy=function(){var o=this.$c.offset();this.x=o.left;this.y=o.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind(\"mousedown\",function(e){e.preventDefault();s._xy()._mouse(e)}).bind(\"touchstart\",function(e){e.preventDefault();s._xy()._touch(e)});this.listen()}else{this.$.attr(\"readonly\",\"readonly\")}return this};this._configure=function(){if(this.o.draw)this.dH=this.o.draw;if(this.o.change)this.cH=this.o.change;if(this.o.cancel)this.eH=this.o.cancel;if(this.o.release)this.rH=this.o.release;if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,\"0.4\");this.fgColor=this.h2rgba(this.o.fgColor,\"0.6\")}else{this.fgColor=this.o.fgColor}return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(v){return~~((v<0?-.5:.5)+v/this.o.step)*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(v){};this.val=function(v){};this.xy2val=function(x,y){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(h,a){var rgb;h=h.substring(1,7);rgb=[parseInt(h.substring(0,2),16),parseInt(h.substring(2,4),16),parseInt(h.substring(4,6),16)];return\"rgba(\"+rgb[0]+\",\"+rgb[1]+\",\"+rgb[2]+\",\"+a+\")\"};this.copy=function(f,t){for(var i in f){t[i]=f[i]}}};k.Dial=function(){k.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=$.extend({bgColor:this.$.data(\"bgcolor\")||\"#EEEEEE\",angleOffset:this.$.data(\"angleoffset\")||0,angleArc:this.$.data(\"anglearc\")||360,inline:true},this.o)};this.val=function(v){if(null!=v){this.cv=this.o.stopper?max(min(v,this.o.max),this.o.min):v;this.v=this.cv;this.$.val(this.v);this._draw()}else{return this.v}};this.xy2val=function(x,y){var a,ret;a=Math.atan2(x-(this.x+this.w2),-(y-this.y-this.w2))-this.angleOffset;if(this.angleArc!=this.PI2&&a<0&&a>-.5){a=0}else if(a<0){a+=this.PI2}ret=~~(.5+a*(this.o.max-this.o.min)/this.angleArc)+this.o.min;this.o.stopper&&(ret=max(min(ret,this.o.max),this.o.min));return ret};this.listen=function(){var s=this,mw=function(e){e.preventDefault();var ori=e.originalEvent,deltaX=ori.detail||ori.wheelDeltaX,deltaY=ori.detail||ori.wheelDeltaY,v=parseInt(s.$.val())+(deltaX>0||deltaY>0?s.o.step:deltaX<0||deltaY<0?-s.o.step:0);if(s.cH&&s.cH(v)===false)return;s.val(v)},kval,to,m=1,kv={37:-s.o.step,38:s.o.step,39:s.o.step,40:-s.o.step};this.$.bind(\"keydown\",function(e){var kc=e.keyCode;if(kc>=96&&kc<=105){kc=e.keyCode=kc-48}kval=parseInt(String.fromCharCode(kc));if(isNaN(kval)){kc!==13&&kc!==8&&kc!==9&&kc!==189&&e.preventDefault();if($.inArray(kc,[37,38,39,40])>-1){e.preventDefault();var v=parseInt(s.$.val())+kv[kc]*m;s.o.stopper&&(v=max(min(v,s.o.max),s.o.min));s.change(v);s._draw();to=window.setTimeout(function(){m*=2},30)}}}).bind(\"keyup\",function(e){if(isNaN(kval)){if(to){window.clearTimeout(to);to=null;m=1;s.val(s.$.val())}}else{s.$.val()>s.o.max&&s.$.val(s.o.max)||s.$.val()<s.o.min&&s.$.val(s.o.min)}});this.$c.bind(\"mousewheel DOMMouseScroll\",mw);this.$.bind(\"mousewheel DOMMouseScroll\",mw)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.o.width/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var s=max(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.o.width/2+4>>0)+\"px\",height:(this.o.width/3>>0)+\"px\",position:\"absolute\",\"vertical-align\":\"middle\",\"margin-top\":(this.o.width/3>>0)+\"px\",\"margin-left\":\"-\"+(this.o.width*3/4+2>>0)+\"px\",border:0,background:\"none\",font:\"bold \"+(this.o.width/s>>0)+\"px Arial\",\"text-align\":\"center\",color:this.o.inputColor||this.o.fgColor,padding:\"0px\",\"-webkit-appearance\":\"none\"})||this.i.css({width:\"0px\",visibility:\"hidden\"})};this.change=function(v){this.cv=v;this.$.val(v)};this.angle=function(v){return(v-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.draw=function(){var c=this.g,a=this.angle(this.cv),sat=this.startAngle,eat=sat+a,sa,ea,r=1;c.lineWidth=this.lineWidth;c.lineCap=this.lineCap;this.o.cursor&&(sat=eat-this.cursorExt)&&(eat=eat+this.cursorExt);c.beginPath();c.strokeStyle=this.o.bgColor;c.arc(this.xy,this.xy,this.radius,this.endAngle,this.startAngle,true);c.stroke();if(this.o.displayPrevious){ea=this.startAngle+this.angle(this.v);sa=this.startAngle;this.o.cursor&&(sa=ea-this.cursorExt)&&(ea=ea+this.cursorExt);c.beginPath();c.strokeStyle=this.pColor;c.arc(this.xy,this.xy,this.radius,sa,ea,false);c.stroke();r=this.cv==this.v}c.beginPath();c.strokeStyle=r?this.o.fgColor:this.fgColor;c.arc(this.xy,this.xy,this.radius,sat,eat,false);c.stroke()};this.cancel=function(){this.val(this.v)}};$.fn.dial=$.fn.knob=function(o){return this.each(function(){var d=new k.Dial;d.o=o;d.$=$(this);d.run()}).parent()}})(jQuery);(function(factory){\"use strict\";if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(window.jQuery)}})(function($){\"use strict\";var counter=0;$.ajaxTransport(\"iframe\",function(options){if(options.async){var form,iframe,addParamChar;return{send:function(_,completeCallback){form=$('<form style=\"display:none;\"></form>');form.attr(\"accept-charset\",options.formAcceptCharset);addParamChar=/\\?/.test(options.url)?\"&\":\"?\";if(options.type===\"DELETE\"){options.url=options.url+addParamChar+\"_method=DELETE\";options.type=\"POST\"}else if(options.type===\"PUT\"){options.url=options.url+addParamChar+\"_method=PUT\";options.type=\"POST\"}else if(options.type===\"PATCH\"){options.url=options.url+addParamChar+\"_method=PATCH\";options.type=\"POST\"}counter+=1;iframe=$('<iframe src=\"javascript:false;\" name=\"iframe-transport-'+counter+'\"></iframe>').bind(\"load\",function(){var fileInputClones,paramNames=$.isArray(options.paramName)?options.paramName:[options.paramName];iframe.unbind(\"load\").bind(\"load\",function(){var response;try{response=iframe.contents();if(!response.length||!response[0].firstChild){throw new Error}}catch(e){response=undefined}completeCallback(200,\"success\",{iframe:response});$('<iframe src=\"javascript:false;\"></iframe>').appendTo(form);window.setTimeout(function(){form.remove()},0)});form.prop(\"target\",iframe.prop(\"name\")).prop(\"action\",options.url).prop(\"method\",options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type=\"hidden\"/>').prop(\"name\",field.name).val(field.value).appendTo(form)})}if(options.fileInput&&options.fileInput.length&&options.type===\"POST\"){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index]});if(options.paramName){options.fileInput.each(function(index){$(this).prop(\"name\",paramNames[index]||options.paramName)})}form.append(options.fileInput).prop(\"enctype\",\"multipart/form-data\").prop(\"encoding\",\"multipart/form-data\")}form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop(\"name\",clone.prop(\"name\"));clone.replaceWith(input)})}});form.append(iframe).appendTo(document.body)},abort:function(){if(iframe){iframe.unbind(\"load\").prop(\"src\",\"javascript\".concat(\":false;\"))}if(form){form.remove()}}}}});$.ajaxSetup({converters:{\"iframe text\":function(iframe){return iframe&&$(iframe[0].body).text()},\"iframe json\":function(iframe){return iframe&&$.parseJSON($(iframe[0].body).text())},\"iframe html\":function(iframe){return iframe&&$(iframe[0].body).html()},\"iframe xml\":function(iframe){var xmlDoc=iframe&&iframe[0];return xmlDoc&&$.isXMLDoc(xmlDoc)?xmlDoc:$.parseXML(xmlDoc.XMLDocument&&xmlDoc.XMLDocument.xml||$(xmlDoc.body).html())},\"iframe script\":function(iframe){return iframe&&$.globalEval($(iframe[0].body).text())}}})});(function(factory){if(typeof define===\"function\"&&define.amd){define([\"jquery\"],factory)}else{factory(jQuery)}})(function($){var pluses=/\\+/g;function raw(s){return s}function decoded(s){return decodeURIComponent(s.replace(pluses,\" \"))}function converted(s){if(s.indexOf('\"')===0){s=s.slice(1,-1).replace(/\\\\\"/g,'\"').replace(/\\\\\\\\/g,\"\\\\\")}try{return config.json?JSON.parse(s):s}catch(er){}}var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(typeof options.expires===\"number\"){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}value=config.json?JSON.stringify(value):String(value);return document.cookie=[config.raw?key:encodeURIComponent(key),\"=\",config.raw?value:encodeURIComponent(value),options.expires?\"; expires=\"+options.expires.toUTCString():\"\",options.path?\"; path=\"+options.path:\"\",options.domain?\"; domain=\"+options.domain:\"\",options.secure?\"; secure\":\"\"].join(\"\")}var decode=config.raw?raw:decoded;var cookies=document.cookie.split(\"; \");var result=key?undefined:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split(\"=\");var name=decode(parts.shift());var cookie=decode(parts.join(\"=\"));if(key&&key===name){result=converted(cookie);break}if(!key){result[name]=converted(cookie)}}return result};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==undefined){$.cookie(key,\"\",$.extend({},options,{expires:-1}));return true}return false}});(function($){var $scrollTo=$.scrollTo=function(target,duration,settings){$(window).scrollTo(target,duration,settings)};$scrollTo.defaults={axis:\"xy\",duration:parseFloat($.fn.jquery)>=1.3?0:1,limit:true};$scrollTo.window=function(scope){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var elem=this,isWin=!elem.nodeName||$.inArray(elem.nodeName.toLowerCase(),[\"iframe\",\"#document\",\"html\",\"body\"])!=-1;if(!isWin)return elem;var doc=(elem.contentWindow||elem).document||elem.ownerDocument||elem;return/webkit/.test(navigator.userAgent.toLowerCase())||doc.compatMode==\"BackCompat\"?doc.body:doc.documentElement})};$.fn.scrollTo=function(target,duration,settings){if(typeof duration==\"object\"){settings=duration;duration=0}if(typeof settings==\"function\")settings={onAfter:settings};if(target==\"max\")target=9e9;settings=$.extend({},$scrollTo.defaults,settings);duration=duration||settings.duration;settings.queue=settings.queue&&settings.axis.length>1;if(settings.queue)duration/=2;settings.offset=both(settings.offset);settings.over=both(settings.over);return this._scrollable().each(function(){var elem=this,$elem=$(elem),targ=target,toff,attr={},win=$elem.is(\"html,body\");switch(typeof targ){case\"number\":case\"string\":if(/^([+-]=)?\\d+(\\.\\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}targ=$(targ,this);if(!targ.length)return;case\"object\":if(targ.is||targ.style)toff=(targ=$(targ)).offset()}$.each(settings.axis.split(\"\"),function(i,axis){var Pos=axis==\"x\"?\"Left\":\"Top\",pos=Pos.toLowerCase(),key=\"scroll\"+Pos,old=elem[key],max=$scrollTo.max(elem,axis);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(settings.margin){attr[key]-=parseInt(targ.css(\"margin\"+Pos))||0;attr[key]-=parseInt(targ.css(\"border\"+Pos+\"Width\"))||0}attr[key]+=settings.offset[pos]||0;if(settings.over[pos])attr[key]+=targ[axis==\"x\"?\"width\":\"height\"]()*settings.over[pos]}else{var val=targ[pos];attr[key]=val.slice&&val.slice(-1)==\"%\"?parseFloat(val)/100*max:val}if(settings.limit&&/^\\d+$/.test(attr[key]))attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&settings.queue){if(old!=attr[key])animate(settings.onAfterFirst);delete attr[key]}});animate(settings.onAfter);function animate(callback){$elem.animate(attr,duration,settings.easing,callback&&function(){callback.call(this,target,settings)})}}).end()};$scrollTo.max=function(elem,axis){var Dim=axis==\"x\"?\"Width\":\"Height\",scroll=\"scroll\"+Dim;if(!$(elem).is(\"html,body\"))return elem[scroll]-$(elem)[Dim.toLowerCase()]();var size=\"client\"+Dim,html=elem.ownerDocument.documentElement,body=elem.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[size],body[size])};function both(val){return typeof val==\"object\"?val:{top:val,left:val}}})(jQuery);(function(factory){\"use strict\";if(typeof define===\"function\"&&define.amd){define([\"jquery\",\"jquery.ui.widget\"],factory)}else{factory(window.jQuery)}})(function($){\"use strict\";$.support.fileInput=!(new RegExp(\"(Android (1\\\\.[0156]|2\\\\.[01]))\"+\"|(Windows Phone (OS 7|8\\\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)\"+\"|(w(eb)?OSBrowser)|(webOS)\"+\"|(Kindle/(1\\\\.0|2\\\\.[05]|3\\\\.0))\").test(window.navigator.userAgent)||$('<input type=\"file\">').prop(\"disabled\"));$.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);$.widget(\"blueimp.fileupload\",{options:{dropZone:$(document),pasteZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:\"Uploaded bytes exceed file size\"},i18n:function(message,context){message=this.messages[message]||message.toString();if(context){$.each(context,function(key,value){message=message.replace(\"{\"+key+\"}\",value)})}return message},formData:function(form){return form.serializeArray()},add:function(e,data){if(data.autoUpload||data.autoUpload!==false&&$(this).fileupload(\"option\",\"autoUpload\")){data.process().done(function(){data.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:[\"fileInput\",\"dropZone\",\"pasteZone\",\"multipart\",\"forceIframeTransport\"],_blobSlice:$.support.blobSlice&&function(){var slice=this.slice||this.webkitSlice||this.mozSlice;return slice.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1e3/timeDiff)*8;this.loaded=loaded;this.timestamp=now}return this.bitrate}},_isXHRUpload:function(options){return!options.forceIframeTransport&&(!options.multipart&&$.support.xhrFileUpload||$.support.xhrFormDataFileUpload)},_getFormData:function(options){var formData;if(typeof options.formData===\"function\"){return options.formData(options.form)}if($.isArray(options.formData)){return options.formData}if($.type(options.formData)===\"object\"){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value})});return formData}return[]},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1});return total},_initProgressObject:function(obj){var progress={loaded:0,total:0,bitrate:0};if(obj._progress){$.extend(obj._progress,progress)}else{obj._progress=progress}},_initResponseObject:function(obj){var prop;if(obj._response){for(prop in obj._response){if(obj._response.hasOwnProperty(prop)){delete obj._response[prop]}}}else{obj._response={}}},_onProgress:function(e,data){if(e.lengthComputable){var now=Date.now?Date.now():(new Date).getTime(),loaded;if(data._time&&data.progressInterval&&now-data._time<data.progressInterval&&e.loaded!==e.total){return}data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=loaded-data._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger(\"progress\",e,data);this._trigger(\"progressall\",e,this._progress)}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind(\"progress\",function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options)});options.xhr=function(){return xhr}}},_isInstanceOf:function(type,obj){return Object.prototype.toString.call(obj)===\"[object \"+type+\"]\"},_initXHRData:function(options){var that=this,formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=options.paramName[0];options.headers=$.extend({},options.headers);if(options.contentRange){options.headers[\"Content-Range\"]=options.contentRange}if(!multipart||options.blob||!this._isInstanceOf(\"File\",file)){options.headers[\"Content-Disposition\"]='attachment; filename=\"'+encodeURI(file.name)+'\"'}if(!multipart){options.contentType=file.type;options.data=options.blob||file}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob})}else{$.each(options.files,function(index,file){formData.push({name:options.paramName[index]||paramName,value:file})})}}else{if(that._isInstanceOf(\"FormData\",options.formData)){formData=options.formData}else{formData=new FormData;$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value)})}if(options.blob){formData.append(paramName,options.blob,file.name)}else{$.each(options.files,function(index,file){if(that._isInstanceOf(\"File\",file)||that._isInstanceOf(\"Blob\",file)){formData.append(options.paramName[index]||paramName,file,file.name)}})}}options.data=formData}options.blob=null},_initIframeSettings:function(options){var targetHost=$(\"<a></a>\").prop(\"href\",options.url).prop(\"host\");options.dataType=\"iframe \"+(options.dataType||\"\");options.formData=this._getFormData(options);if(options.redirect&&targetHost&&targetHost!==location.host){options.formData.push({name:options.redirectParamName||\"redirect\",value:options.redirect})}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options)}this._initProgressListener(options)}if(options.postMessage){options.dataType=\"postmessage \"+(options.dataType||\"\")}}else{this._initIframeSettings(options)}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop(\"name\")||\"files[]\",i=(input.prop(\"files\")||[1]).length;while(i){paramName.push(name);i-=1}});if(!paramName.length){paramName=[fileInput.prop(\"name\")||\"files[]\"]}}else if(!$.isArray(paramName)){paramName=[paramName]}return paramName},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop(\"form\"));if(!options.form.length){options.form=$(this.options.fileInput.prop(\"form\"))}}options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop(\"action\")||location.href}options.type=(options.type||$.type(options.form.prop(\"method\"))===\"string\"&&options.form.prop(\"method\")||\"\").toUpperCase();if(options.type!==\"POST\"&&options.type!==\"PUT\"&&options.type!==\"PATCH\"){options.type=\"POST\"}if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr(\"accept-charset\")}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options},_getDeferredState:function(deferred){if(deferred.state){return deferred.state()}if(deferred.isResolved()){return\"resolved\"}if(deferred.isRejected()){return\"rejected\"}return\"pending\"},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args)}else if(resolveOrReject===false){dfd.rejectWith(context,args)}promise.abort=dfd.promise;return this._enhancePromise(promise)},_addConvenienceMethods:function(e,data){var that=this,getPromise=function(data){return $.Deferred().resolveWith(that,[data]).promise()};data.process=function(resolveFunc,rejectFunc){if(resolveFunc||rejectFunc){data._processQueue=this._processQueue=(this._processQueue||getPromise(this)).pipe(resolveFunc,rejectFunc)}return this._processQueue||getPromise(this)};data.submit=function(){if(this.state()!==\"pending\"){data.jqXHR=this.jqXHR=that._trigger(\"submit\",e,this)!==false&&that._onSend(e,this)}return this.jqXHR||that._getXHRPromise()};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}return that._getXHRPromise()};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR)}if(this._processQueue){return that._getDeferredState(this._processQueue)}};data.progress=function(){return this._progress};data.response=function(){return this._response}},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader(\"Range\"),parts=range&&range.split(\"-\"),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1},_chunkedUpload:function(options,testOnly){options.uploadedBytes=options.uploadedBytes||0;var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes,mcs=options.maxChunkSize||fs,slice=this._blobSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false}if(testOnly){return true}if(ub>=fs){file.error=options.i18n(\"uploadedBytes\");return this._getXHRPromise(false,options.context,[null,\"error\",file.error])}upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange=\"bytes \"+ub+\"-\"+(ub+o.chunkSize-1)+\"/\"+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=(that._trigger(\"chunksend\",null,o)!==false&&$.ajax(o)||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||ub+o.chunkSize;if(currentLoaded+o.chunkSize-o._progress.loaded){that._onProgress($.Event(\"progress\",{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o)}options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger(\"chunkdone\",null,o);that._trigger(\"chunkalways\",null,o);if(ub<fs){upload()}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR])}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger(\"chunkfail\",null,o);that._trigger(\"chunkalways\",null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown])})};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort()};upload();return promise},_beforeSend:function(e,data){if(this._active===0){this._trigger(\"start\");this._bitrateTimer=new this._BitrateTimer;this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(data);this._initProgressObject(data);data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total,response=options._response;if(options._progress.loaded<total){this._onProgress($.Event(\"progress\",{lengthComputable:true,loaded:total,total:total}),options)}response.result=options.result=result;response.textStatus=options.textStatus=textStatus;response.jqXHR=options.jqXHR=jqXHR;this._trigger(\"done\",null,options)},_onFail:function(jqXHR,textStatus,errorThrown,options){var response=options._response;if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total}response.jqXHR=options.jqXHR=jqXHR;response.textStatus=options.textStatus=textStatus;response.errorThrown=options.errorThrown=errorThrown;this._trigger(\"fail\",null,options)},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._trigger(\"always\",null,options)},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data)}var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer;jqXHR=jqXHR||((aborted||that._trigger(\"send\",e,options)===false)&&that._getXHRPromise(false,options.context,aborted)||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options)}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options)}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);that._sending-=1;that._active-=1;if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)===\"pending\"){nextSlot.resolve();break}nextSlot=that._slots.shift()}}if(that._active===0){that._trigger(\"stop\")}});return jqXHR};this._beforeSend(e,options);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send)}else{this._sequence=this._sequence.pipe(send,send);pipe=this._sequence}pipe.abort=function(){aborted=[undefined,\"abort\",\"abort\"];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted)}return send()}return jqXHR.abort()};return this._enhancePromise(pipe)}return send()},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),limit=options.limitMultiFileUploads,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i;if(!(options.singleFileUploads||limit)||!this._isXHRUpload(options)){fileSet=[data.files];paramNameSet=[paramName]}else if(!options.singleFileUploads&&limit){fileSet=[];paramNameSet=[];for(i=0;i<data.files.length;i+=limit){fileSet.push(data.files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName}paramNameSet.push(paramNameSlice)}}else{paramNameSet=paramName}data.originalFiles=data.files;$.each(fileSet||data.files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initResponseObject(newData);that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger(\"add\",e,newData);return result});return result},_replaceFileInput:function(input){var inputClone=input.clone(true);$(\"<form></form>\").append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind(\"remove\"));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0]}return el});if(input[0]===this.element[0]){this.element=inputClone}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry}dfd.resolve([e])},dirReader;path=path||\"\";if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file)}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file)},errorHandler)}}else if(entry.isDirectory){dirReader=entry.createReader();dirReader.readEntries(function(entries){that._handleFileTreeEntries(entries,path+entry.name+\"/\").done(function(files){dfd.resolve(files)}).fail(errorHandler)},errorHandler)}else{dfd.resolve([])}return dfd.promise()},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile()}return entry}return item.getAsEntry()}))}return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise()},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop(\"webkitEntries\")||fileInput.prop(\"entries\"),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries)}files=$.makeArray(fileInput.prop(\"files\"));if(!files.length){value=fileInput.prop(\"value\");if(!value){return $.Deferred().resolve([]).promise()}files=[{name:value.replace(/^.*\\\\/,\"\")}]}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize})}return $.Deferred().resolve(files).promise()},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput)}return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput)}if(that._trigger(\"change\",e,data)!==false){that._onAdd(e,data)}})},_onPaste:function(e){var items=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,data={files:[]};if(items&&items.length){$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file)}});if(this._trigger(\"paste\",e,data)!==false){this._onAdd(e,data)}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var that=this,dataTransfer=e.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger(\"drop\",e,data)!==false){that._onAdd(e,data)}})}},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var dataTransfer=e.dataTransfer,data={dropEffect:\"copy\",preventDefault:true};if(dataTransfer&&$.inArray(\"Files\",dataTransfer.types)!==-1&&this._trigger(\"dragover\",e,data)!==false){dataTransfer.dropEffect=data.dropEffect;if(data.preventDefault){e.preventDefault()}}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,\"dragover drop\");this._off(this.options.pasteZone,\"paste\");this._off(this.options.fileInput,\"change\")},_setOption:function(key,value){var reinit=$.inArray(key,this._specialOptions)!==-1;if(reinit){this._destroyEventHandlers()}this._super(key,value);if(reinit){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type=\"file\"]')?this.element:this.element.find('input[type=\"file\"]')\n}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput)}if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone)}if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone)}},_getRegExp:function(str){var parts=str.split(\"/\"),modifiers=parts.pop();parts.shift();return new RegExp(parts.join(\"/\"),modifiers)},_isRegExpOption:function(key,value){return key!==\"url\"&&$.type(value)===\"string\"&&/^\\/.*\\/[igm]{0,3}$/.test(value)},_initDataAttributes:function(){var that=this,options=this.options;$.each($(this.element[0].cloneNode(false)).data(),function(key,value){if(that._isRegExpOption(key,value)){value=that._getRegExp(value)}options[key]=value})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(data){var that=this;if(!data||this.options.disabled){return}if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data)})}else{data.files=$.makeArray(data.files);this._onAdd(null,data)}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort()}dfd.reject(null,\"abort\",\"abort\");return promise};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return}if(!files.length){dfd.reject();return}data.files=files;jqXHR=that._onSend(null,data).then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR)},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown)})});return this._enhancePromise(promise)}data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data)}}return this._getXHRPromise(false,data&&data.context)}})});jQuery.extend(jQuery,{escapeSel:function(){return function(selector){return typeof selector!==\"undefined\"&&selector!==null?selector.replace(/([ #;?&,.+*~\\':\"!^$[\\]()=>|\\/@])/g,\"\\\\$1\"):void 0}}()});(function(f,h,$){var a=\"placeholder\"in h.createElement(\"input\"),d=\"placeholder\"in h.createElement(\"textarea\"),i=$.fn,c=$.valHooks,k,j;if(a&&d){j=i.placeholder=function(){return this};j.input=j.textarea=true}else{j=i.placeholder=function(){var l=this;l.filter((a?\"textarea\":\":input\")+\"[placeholder]\").not(\".placeholder\").bind({\"focus.placeholder\":b,\"blur.placeholder\":e}).data(\"placeholder-enabled\",true).trigger(\"blur.placeholder\");return l};j.input=a;j.textarea=d;k={get:function(m){var l=$(m);return l.data(\"placeholder-enabled\")&&l.hasClass(\"placeholder\")?\"\":m.value},set:function(m,n){var l=$(m);if(!l.data(\"placeholder-enabled\")){return m.value=n}if(n==\"\"){m.value=n;if(m!=h.activeElement){e.call(m)}}else{if(l.hasClass(\"placeholder\")){b.call(m,true,n)||(m.value=n)}else{m.value=n}}return l}};a||(c.input=k);d||(c.textarea=k);$(function(){$(h).delegate(\"form\",\"submit.placeholder\",function(){var l=$(\".placeholder\",this).each(b);setTimeout(function(){l.each(e)},10)})});$(f).bind(\"beforeunload.placeholder\",function(){$(\".placeholder\").each(function(){this.value=\"\"})})}function g(m){var l={},n=/^jQuery\\d+$/;$.each(m.attributes,function(p,o){if(o.specified&&!n.test(o.name)){l[o.name]=o.value}});return l}function b(m,n){var l=this,o=$(l);if(l.value==o.attr(\"placeholder\")&&o.hasClass(\"placeholder\")){if(o.data(\"placeholder-password\")){o=o.hide().next().show().attr(\"id\",o.removeAttr(\"id\").data(\"placeholder-id\"));if(m===true){return o[0].value=n}o.focus()}else{l.value=\"\";o.removeClass(\"placeholder\");l==h.activeElement&&l.select()}}}function e(){var q,l=this,p=$(l),m=p,o=this.id;if(l.value==\"\"){if(l.type==\"password\"){if(!p.data(\"placeholder-textinput\")){try{q=p.clone().attr({type:\"text\"})}catch(n){q=$(\"<input>\").attr($.extend(g(this),{type:\"text\"}))}q.removeAttr(\"name\").data({\"placeholder-password\":true,\"placeholder-id\":o}).bind(\"focus.placeholder\",b);p.data({\"placeholder-textinput\":q,\"placeholder-id\":o}).before(q)}p=p.removeAttr(\"id\").hide().prev().attr(\"id\",o).show()}p.addClass(\"placeholder\");p[0].value=p.attr(\"placeholder\")}else{p.removeClass(\"placeholder\")}}})(this,document,jQuery);jQuery.fn.outerHTML=function(){return $(\"<div>\").append(this.eq(0).clone()).html()};window.mobilecheck=function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){return true}else{return false}};window.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||\"an unknown browser\";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||\"an unknown version\";this.OS=this.searchString(this.dataOS)||\"an unknown OS\"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)return data[i].identity}else if(dataProp)return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:\"Chrome\",identity:\"Chrome\"},{string:navigator.userAgent,subString:\"OmniWeb\",versionSearch:\"OmniWeb/\",identity:\"OmniWeb\"},{string:navigator.vendor,subString:\"Apple\",identity:\"Safari\",versionSearch:\"Version\"},{prop:window.opera,identity:\"Opera\",versionSearch:\"Version\"},{string:navigator.vendor,subString:\"iCab\",identity:\"iCab\"},{string:navigator.vendor,subString:\"KDE\",identity:\"Konqueror\"},{string:navigator.userAgent,subString:\"Firefox\",identity:\"Firefox\"},{string:navigator.vendor,subString:\"Camino\",identity:\"Camino\"},{string:navigator.userAgent,subString:\"Netscape\",identity:\"Netscape\"},{string:navigator.userAgent,subString:\"MSIE\",identity:\"Explorer\",versionSearch:\"MSIE\"},{string:navigator.userAgent,subString:\"Gecko\",identity:\"Mozilla\",versionSearch:\"rv\"},{string:navigator.userAgent,subString:\"Mozilla\",identity:\"Netscape\",versionSearch:\"Mozilla\"}],dataOS:[{string:navigator.platform,subString:\"Win\",identity:\"Windows\"},{string:navigator.platform,subString:\"Mac\",identity:\"Mac\"},{string:navigator.userAgent,subString:\"iPhone\",identity:\"iPhone/iPod\"},{string:navigator.platform,subString:\"Linux\",identity:\"Linux\"}]};window.BrowserDetect.init();window.log=function(){if((typeof global!==\"undefined\"&&global!==null?global.debug:void 0)!=null&&!global.debug||window.debug!=null&&!window.debug){return}if(this.console){arguments.callee=arguments.callee.caller;var newarr=[].slice.call(arguments);typeof console.log===\"object\"?log.apply.call(console.log,console,newarr):console.log.apply(console,newarr)}};(function(b){function c(){}for(var d=\"assert,clear,count,debug,dir,dirxml,error,exception,firebug,group,groupCollapsed,groupEnd,info,log,memoryProfile,memoryProfileEnd,profile,profileEnd,table,time,timeEnd,timeStamp,trace,warn\".split(\",\"),a;a=d.pop();){b[a]=b[a]||c}})(function(){try{console.log();return window.console}catch(err){return window.console={}}}());Lawnchair.adapter(\"indexed-db\",function(){function fail(e,i){console.error(\"error in indexed-db adapter!\",e,i)}var STORE_VERSION=3;var getIDB=function(){return window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB};var getIDBTransaction=function(){return window.IDBTransaction||window.webkitIDBTransaction||window.mozIDBTransaction||window.oIDBTransaction||window.msIDBTransaction};var getIDBKeyRange=function(){return window.IDBKeyRange||window.webkitIDBKeyRange||window.mozIDBKeyRange||window.oIDBKeyRange||window.msIDBKeyRange};var getIDBDatabaseException=function(){return window.IDBDatabaseException||window.webkitIDBDatabaseException||window.mozIDBDatabaseException||window.oIDBDatabaseException||window.msIDBDatabaseException||window.DOMException};var useAutoIncrement=function(){return!!window.indexedDB};var READ_WRITE=getIDBTransaction()&&\"READ_WRITE\"in getIDBTransaction()?getIDBTransaction().READ_WRITE:\"readwrite\";return{valid:function(){return!!getIDB()},init:function(options,callback){this.idb=getIDB();this.waiting=[];this.useAutoIncrement=useAutoIncrement();var request=this.idb.open(this.name,STORE_VERSION);var self=this;var cb=self.fn(self.name,callback);if(cb&&typeof cb!=\"function\")throw\"callback not valid\";var win=function(){request.onupgradeneeded=request.onsuccess=request.error=null;if(cb)return cb.call(self,self)};var upgrade=function(from,to){try{self.db.deleteObjectStore(\"teststore\")}catch(e1){}try{self.db.deleteObjectStore(self.record)}catch(e2){}var params={};if(self.useAutoIncrement){params.autoIncrement=true}self.db.createObjectStore(self.record,params);self.store=true};request.onupgradeneeded=function(event){self.db=request.result;self.transaction=request.transaction;upgrade(event.oldVersion,event.newVersion)};request.onsuccess=function(event){self.db=event.target.result;if(self.db.version!=\"\"+STORE_VERSION){var oldVersion=self.db.version;var setVrequest=self.db.setVersion(\"\"+STORE_VERSION);setVrequest.onsuccess=function(event){var transaction=setVrequest.result;setVrequest.onsuccess=setVrequest.onerror=null;upgrade(oldVersion,STORE_VERSION);transaction.oncomplete=function(){for(var i=0;i<self.waiting.length;i++){self.waiting[i].call(self)}self.waiting=[];win()}};setVrequest.onerror=function(e){setVrequest.onsuccess=setVrequest.onerror=null;console.error(\"Failed to create objectstore \"+e);fail(e)}}else{self.store=true;for(var i=0;i<self.waiting.length;i++){self.waiting[i].call(self)}self.waiting=[];win()}};request.onerror=function(ev){if(request.errorCode===getIDBDatabaseException().VERSION_ERR){self.idb.deleteDatabase(self.name);if(!options.recursing){options.recursing=true;return self.init(options,callback)}}console.error(\"Failed to open database\")}},save:function(obj,callback){var self=this;if(!this.store){this.waiting.push(function(){this.save(obj,callback)});return}var objs=(this.isArray(obj)?obj:[obj]).map(function(o){if(!o.key){o.key=self.uuid()}return o});var win=function(e){if(callback){self.lambda(callback).call(self,self.isArray(obj)?objs:objs[0])}};var trans=this.db.transaction(this.record,READ_WRITE);var store=trans.objectStore(this.record);for(var i=0;i<objs.length;i++){var o=objs[i];store.put(o,o.key)}store.transaction.oncomplete=win;store.transaction.onabort=fail;return this},batch:function(objs,callback){return this.save(objs,callback)},get:function(key,callback){if(!this.store){this.waiting.push(function(){this.get(key,callback)});return}var self=this;var win=function(e){var r=e.target.result;if(callback){if(r){r.key=key}self.lambda(callback).call(self,r)}};if(!this.isArray(key)){var req=this.db.transaction(this.record).objectStore(this.record).get(key);req.onsuccess=function(event){req.onsuccess=req.onerror=null;win(event)};req.onerror=function(event){req.onsuccess=req.onerror=null;fail(event)}}else{var results=[],done=key.length,keys=key;var getOne=function(i){self.get(keys[i],function(obj){results[i]=obj;if(--done>0){return}if(callback){self.lambda(callback).call(self,results)}})};for(var i=0,l=keys.length;i<l;i++)getOne(i)}return this},exists:function(key,callback){if(!this.store){this.waiting.push(function(){this.exists(key,callback)});return}var self=this;var req=this.db.transaction(self.record).objectStore(this.record).openCursor(getIDBKeyRange().only(key));req.onsuccess=function(event){req.onsuccess=req.onerror=null;var undef;self.lambda(callback).call(self,event.target.result!==null&&event.target.result!==undef)};req.onerror=function(event){req.onsuccess=req.onerror=null;fail(event)};return this},all:function(callback){if(!this.store){this.waiting.push(function(){this.all(callback)});return}var cb=this.fn(this.name,callback)||undefined;var self=this;var objectStore=this.db.transaction(this.record).objectStore(this.record);var toReturn=[];objectStore.openCursor().onsuccess=function(event){var cursor=event.target.result;if(cursor){toReturn.push(cursor.value);cursor[\"continue\"]()}else{if(cb)cb.call(self,toReturn)}};return this},keys:function(callback){if(!this.store){this.waiting.push(function(){this.keys(callback)});return}var cb=this.fn(this.name,callback)||undefined;var self=this;var objectStore=this.db.transaction(this.record).objectStore(this.record);var toReturn=[];objectStore.openCursor().onsuccess=function(event){var cursor=event.target.result;if(cursor){toReturn.push(cursor.key);cursor[\"continue\"]()}else{if(cb)cb.call(self,toReturn)}};return this},remove:function(keyOrArray,callback){if(!this.store){this.waiting.push(function(){this.remove(keyOrArray,callback)});return}var self=this;var toDelete=keyOrArray;if(!this.isArray(keyOrArray)){toDelete=[keyOrArray]}var win=function(){if(callback)self.lambda(callback).call(self)};var os=this.db.transaction(this.record,READ_WRITE).objectStore(this.record);var key=keyOrArray.key?keyOrArray.key:keyOrArray;for(var i=0;i<toDelete.length;i++){var key=toDelete[i].key?toDelete[i].key:toDelete[i];os[\"delete\"](key)}os.transaction.oncomplete=win;os.transaction.onabort=fail;return this},nuke:function(callback){if(!this.store){this.waiting.push(function(){this.nuke(callback)});return}var self=this,win=callback?function(){self.lambda(callback).call(self)}:function(){};try{var os=this.db.transaction(this.record,READ_WRITE).objectStore(this.record);os.clear();os.transaction.oncomplete=win;os.transaction.onabort=fail}catch(e){if(e.name==\"NotFoundError\")win();else fail(e)}return this}}}());window.PrettyPills=function(){var CodeMirror=window.CodeMirror;function PrettyPills(textarea,options){if(!(this instanceof PrettyPills))return new PrettyPills(place,options);this.editor=CodeMirror.fromTextArea(textarea[0]||textarea,options);var editor=this.editor;var wrapper=$(editor.getWrapperElement());var emitter=this.emitter=$(\"<div />\");wrapper.wrap(\"<div class='PrettyPills' />\");this.container=wrapper.parent();this.textarea=$(this.editor.getTextArea());this.options=options=options||{};for(var opt in defaults){if(!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt)){options[opt]=defaults[opt]}}editor.setOption(\"lineNumbers\",false);editor.setOption(\"lineWrapping\",true);wrapper.on(\"click\",\".pill\",bind(function(e){this.setActivePill(e.target)},this));var debounceCursorActivity=debounce(bind(function(){var cursorHead=editor.getCursor(\"head\");var cursorAnchor=editor.getCursor(\"anchor\");var isCollapsed=cursorHead.line===cursorAnchor.line&&cursorHead.ch===cursorAnchor.ch;if(!this._active||isCollapsed||this._active.ch!=cursorHead.ch||this._active.line!=cursorHead.line){this.clearActivePills()}},this),200,true);var debounceChange=debounce(bind(function(){editor.getTextArea().value=editor.getValue();this.parseReplacements()},this),200);editor.on(\"cursorActivity\",debounceCursorActivity);editor.on(\"change\",debounceChange);this.refresh();var inValue=null;editor.on(\"change\",function(){emitter.trigger(\"input\",{value:editor.getValue()})});editor.on(\"focus\",function(){inValue=editor.getValue()});wrapper.on(\"mousedown\",function(){emitter.trigger(\"mousedown\",{value:editor.getValue()})});wrapper.on(\"mouseup\",function(){emitter.trigger(\"mouseup\",{value:editor.getValue()})});editor.on(\"blur\",function(){if(inValue!==editor.getValue()){emitter.trigger(\"change\",{value:editor.getValue()})}inValue=null});this.enable()}PrettyPills.prototype={enabled:false,disable:function(){if(this.enabled){this.container.remove();this.textarea.show();this.enabled=false}},enable:function(){if(!this.enabled){this.setValue(this.textarea.val());this.container.insertAfter(this.textarea);this.textarea.hide();this.enabled=true}},refresh:function(){this.editor.refresh()},setActivePill:function(pill){var editor=this.editor;var emitter=this.emitter;this.clearActivePills();var replacedWith=pill.parentNode;var active=null;var pos=null;var text=null;var ch=null;var line=null;var marker=null;editor.getAllMarks().forEach(function(m){if(m.replacedWith===replacedWith){marker=m;active=m.replacedWith;pos=m.find()}});this.refresh();if(pos){text=editor.getRange(pos.from,pos.to);if(pos.from){line=pos.from.line;ch=pos.from.ch}}editor.focus();editor.setSelection(pos.from,pos.to);$(pill).addClass(\"active\");emitter.trigger(\"pillenter\",{coords:editor.cursorCoords(true),text:text,line:line,ch:ch});this._active=editor.getCursor()},clearActivePills:function(){var editor=this.editor;var emitter=this.emitter;this.container.find(\".pill.active\").removeClass(\"active\");if(this._active){emitter.trigger(\"pillleave\");delete this._active}},setOption:function(name,val){this.options[name]=val;this.parseReplacements()},getOption:function(name){return this.options[name]},setValue:function(val){this.editor.setValue(val);this.parseReplacements()},getValue:function(val){return this.editor.getValue()},getCursorCoords:function(name){return this.editor.cursorCoords(true)},on:function(type,f){this.emitter.on(type,f)},off:function(type,f){this.emitter.off(type,f)},getPill:function(text,className){var pill=document.createElement(\"span\");pill.textContent=text;pill.className=trim(\"pill \"+(className||\"\"));return pill},insertText:function(key,start){var editor=this.editor;start=start||editor.getCursor(\"start\");editor.focus();editor.replaceRange(key,start);this.parseReplacements()},replaceText:function(key,start,length){var editor=this.editor;start=start||editor.getCursor(\"start\");var to={line:start.line,ch:start.ch+length};editor.focus();editor.replaceRange(key,start,to);this.parseReplacements()},parseReplacements:function(){var editor=this.editor;var value=editor.getValue().split(\"\\n\");var replacements=this.options.replacements||{};var sel=editor.getCursor();var clearPillsOnEnter=this.options.clearPillsOnEnter;forEach(editor.getAllMarks(),function(m){m.clear()});if(!this.options.showPills){return}for(var i=0;i<value.length;i++){for(var j in replacements){var options=typeof replacements[j]===\"object\"?replacements[j]:{replaceWith:replacements[j]};var matchRegex=options.allowRegex?j:escapeRegExp(j);var matches=allMatches(value[i],matchRegex);for(var k=0;k<matches.length;k++){var match=matches[k][0];var replace=matches[k][1];var replaceWith=typeof options.replaceWith===\"function\"?options.replaceWith(replace):options.replaceWith;var p=getPillDOM(replaceWith,options.className);var insideSelection=sel.line===i&&sel.ch>=match&&sel.ch<match+replace.length;if(clearPillsOnEnter&&insideSelection){continue}var m=editor.markText({line:i,ch:match},{line:i,ch:match+replace.length},{replacedWith:p,clearOnEnter:clearPillsOnEnter,handleMouseEvents:true})}}}}};var defaults=PrettyPills.defaults={};defaults.showPills=true;defaults.clearPillsOnEnter=false;PrettyPills.fromTextArea=function(textarea,options,cmOptions){return new PrettyPills(textarea,options)};PrettyPills.MUSTACHE_MATCH=\"{{(?:(?!{{).)+}}\";function allMatches(str,regex){var reg=new RegExp(\"\"+regex+\"\",\"g\");var match;var params=[];while(match=reg.exec(str)){params.push([match.index,match[0]])}return params}function getPillDOM(text,className){var pill=document.createElement(\"span\");pill.textContent=text;pill.className=trim(\"pill \"+(className||\"\"));return pill}function debounce(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}}function escapeRegExp(str){return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,\"\\\\$&\")}function forEach(arr,fn){for(var i=0;i<arr.length;i++){fn.apply(arr[i],[arr[i],i])}}function trim(str){return $.trim(str)}function bind(fn,ctx){return $.proxy(fn,ctx)}function log(){if(window.console){if(Function.prototype.bind)log=Function.prototype.bind.call(console.log,console);else log=function(){Function.prototype.apply.call(console.log,console,arguments)};log.apply(this,arguments)}}PrettyPills.version=\"0.0.1+\";return PrettyPills}();(function(){var e=this;this.Stripe=function(){function e(){}return e.version=2,e.endpoint=\"https://api.stripe.com/v1\",e.validateCardNumber=function(t){return t=(t+\"\").replace(/\\s+|-/g,\"\"),t.length>=10&&t.length<=16&&e.luhnCheck(t)},e.validateCVC=function(t){return t=e.trim(t),/^\\d+$/.test(t)&&t.length>=3&&t.length<=4},e.validateExpiry=function(t,n){var r,i;return t=e.trim(t),n=e.trim(n),/^\\d+$/.test(t)?/^\\d+$/.test(n)?parseInt(t,10)<=12?(i=new Date(n,t),r=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>r):!1:!1:!1},e.cardType=function(t){return e.cardTypes[t.slice(0,2)]||\"Unknown\"},e.setPublishableKey=function(t){e.key=t},e.createToken=function(t,n,r){var i,s,o;n==null&&(n={});if(!t)throw\"card required\";if(typeof t!=\"object\")throw\"card invalid\";typeof n==\"function\"?(r=n,n={}):typeof n!=\"object\"&&(i=parseInt(n,10),n={},i>0&&(n.amount=i));for(s in t)o=t[s],delete t[s],t[e.underscore(s)]=o;return n.card=t,n.key||(n.key=e.key||e.publishableKey),e.validateKey(n.key),e.ajaxJSONP({url:\"\"+e.endpoint+\"/tokens\",data:n,method:\"POST\",success:function(e,t){return typeof r==\"function\"?r(t,e):void 0},complete:e.complete(r),timeout:4e4})},e.getToken=function(t,n){if(!t)throw\"token required\";return e.validateKey(e.key),e.ajaxJSONP({url:\"\"+e.endpoint+\"/tokens/\"+t,data:{key:e.key},success:function(e,t){return typeof n==\"function\"?n(t,e):void 0},complete:e.complete(n),timeout:4e4})},e.complete=function(e){return function(t,n,r){if(t!==\"success\")return typeof e==\"function\"?e(500,{error:{code:t,type:t,message:\"An unexpected error has occured.\\nWe have been notified of the problem.\"}}):void 0}},e.validateKey=function(e){if(!e||typeof e!=\"string\")throw new Error(\"You did not set a valid publishable key.\\nCall Stripe.setPublishableKey() with your publishable key.\\nFor more info, see https://stripe.com/docs/stripe.js\");if(/^sk_/.test(e))throw new Error(\"You are using a secret key with Stripe.js, instead of the publishable one.\\nFor more info, see https://stripe.com/docs/stripe.js\")},e}.call(this),typeof module!=\"undefined\"&&module!==null&&(module.exports=this.Stripe),typeof define==\"function\"&&define(\"stripe\",[],function(){return e.Stripe})}).call(this),function(){var e,t,n,r=[].slice;e=encodeURIComponent,t=(new Date).getTime(),n=function(t,r,i){var s,o;r==null&&(r=[]);for(s in t)o=t[s],i&&(s=\"\"+i+\"[\"+s+\"]\"),typeof o==\"object\"?n(o,r,s):r.push(\"\"+s+\"=\"+e(o));return r.join(\"&\").replace(/%20/g,\"+\")},this.Stripe.ajaxJSONP=function(e){var i,s,o,u,a,f;return e==null&&(e={}),o=\"sjsonp\"+ ++t,a=document.createElement(\"script\"),s=null,i=function(){var t;return(t=a.parentNode)!=null&&t.removeChild(a),o in window&&(window[o]=function(){}),typeof e.complete==\"function\"?e.complete(\"abort\",f,e):void 0},f={abort:i},a.onerror=function(){return f.abort(),typeof e.error==\"function\"?e.error(f,e):void 0},window[o]=function(){var t;t=1<=arguments.length?r.call(arguments,0):[],clearTimeout(s),a.parentNode.removeChild(a);try{delete window[o]}catch(n){window[o]=void 0}return typeof e.success==\"function\"&&e.success.apply(e,t),typeof e.complete==\"function\"?e.complete(\"success\",f,e):void 0},e.data||(e.data={}),e.data.callback=o,e.method&&(e.data._method=e.method),a.src=e.url+\"?\"+n(e.data),u=document.getElementsByTagName(\"head\")[0],u.appendChild(a),e.timeout>0&&(s=setTimeout(function(){return f.abort(),typeof e.complete==\"function\"?e.complete(\"timeout\",f,e):void 0},e.timeout)),f}}.call(this),function(){this.Stripe.trim=function(e){return(e+\"\").replace(/^\\s+|\\s+$/g,\"\")},this.Stripe.underscore=function(e){return(e+\"\").replace(/([A-Z])/g,function(e){return\"_\"+e.toLowerCase()})},this.Stripe.luhnCheck=function(e){var t,n,r,i,s,o;r=!0,i=0,n=(e+\"\").split(\"\").reverse();for(s=0,o=n.length;s<o;s++){t=n[s],t=parseInt(t,10);if(r=!r)t*=2;t>9&&(t-=9),i+=t}return i%10===0},this.Stripe.cardTypes=function(){var e,t,n,r;t={};for(e=n=40;n<=49;e=++n)t[e]=\"Visa\";for(e=r=50;r<=59;e=++r)t[e]=\"MasterCard\";return t[34]=t[37]=\"American Express\",t[60]=t[62]=t[64]=t[65]=\"Discover\",t[35]=\"JCB\",t[30]=t[36]=t[38]=t[39]=\"Diners Club\",t}()}.call(this);(function(root,factory){if(typeof exports===\"object\"&&exports){module.exports=factory}else if(typeof define===\"function\"&&define.amd){define(factory)}else{root.Mustache=factory}})(this,function(){var exports={};exports.name=\"mustache.js\";exports.version=\"0.7.2\";exports.tags=[\"{{\",\"}}\"];exports.Scanner=Scanner;exports.Context=Context;exports.Writer=Writer;var whiteRe=/\\s*/;var spaceRe=/\\s+/;var nonSpaceRe=/\\S/;var eqRe=/\\s*=/;var curlyRe=/\\s*\\}/;var tagRe=/#|\\^|\\/|>|\\{|&|=|!/;var _test=RegExp.prototype.test;var _toString=Object.prototype.toString;function testRe(re,string){return _test.call(re,string)}function isWhitespace(string){return!testRe(nonSpaceRe,string)}var isArray=Array.isArray||function(obj){return _toString.call(obj)===\"[object Array]\"};function escapeRe(string){return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\")}var entityMap={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"/\":\"&#x2F;\"};function escapeHtml(string){return String(string).replace(/[&<>\"'\\/]/g,function(s){return entityMap[s]})}exports.escape=escapeHtml;function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function(){return this.tail===\"\"};Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(match&&match.index===0){this.tail=this.tail.substring(match[0].length);this.pos+=match[0].length;return match[0]}return\"\"};Scanner.prototype.scanUntil=function(re){var match,pos=this.tail.search(re);switch(pos){case-1:match=this.tail;this.pos+=this.tail.length;this.tail=\"\";break;case 0:match=\"\";break;default:match=this.tail.substring(0,pos);this.tail=this.tail.substring(pos);this.pos+=pos}return match};function Context(view,parent){this.view=view;this.parent=parent;this._cache={}}Context.make=function(view){return view instanceof Context?view:new Context(view)};Context.prototype.push=function(view){return new Context(view,this)};Context.prototype.lookup=function(name){var value=this._cache[name];if(!value){if(name==\".\"){value=this.view}else{var context=this;while(context){if(name.indexOf(\".\")>0){value=context.view;var names=name.split(\".\"),i=0;while(value&&i<names.length){value=value[names[i++]]}}else{value=context.view[name]}if(value!=null)break;context=context.parent}}this._cache[name]=value}if(typeof value===\"function\")value=value.call(this.view);return value};function Writer(){this.clearCache()}Writer.prototype.clearCache=function(){this._cache={};this._partialCache={}};Writer.prototype.compile=function(template,tags){var fn=this._cache[template];if(!fn){var tokens=exports.parse(template,tags);fn=this._cache[template]=this.compileTokens(tokens,template)}return fn};Writer.prototype.compilePartial=function(name,template,tags){var fn=this.compile(template,tags);this._partialCache[name]=fn;return fn};Writer.prototype.getPartial=function(name){if(!(name in this._partialCache)&&this._loadPartial){this.compilePartial(name,this._loadPartial(name))}return this._partialCache[name]};Writer.prototype.compileTokens=function(tokens,template){var self=this;return function(view,partials){if(partials){if(typeof partials===\"function\"){self._loadPartial=partials}else{for(var name in partials){self.compilePartial(name,partials[name])}}}return renderTokens(tokens,self,Context.make(view),template)}};Writer.prototype.render=function(template,view,partials){return this.compile(template)(view,partials)};function renderTokens(tokens,writer,context,template){var buffer=\"\";var token,tokenValue,value;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];tokenValue=token[1];switch(token[0]){case\"#\":value=context.lookup(tokenValue);if(typeof value===\"object\"){if(isArray(value)){for(var j=0,jlen=value.length;j<jlen;++j){buffer+=renderTokens(token[4],writer,context.push(value[j]),template)}}else if(value){buffer+=renderTokens(token[4],writer,context.push(value),template)}}else if(typeof value===\"function\"){var text=template==null?null:template.slice(token[3],token[5]);value=value.call(context.view,text,function(template){return writer.render(template,context)});if(value!=null)buffer+=value}else if(value){buffer+=renderTokens(token[4],writer,context,template)}break;case\"^\":value=context.lookup(tokenValue);if(!value||isArray(value)&&value.length===0){buffer+=renderTokens(token[4],writer,context,template)}break;case\">\":value=writer.getPartial(tokenValue);if(typeof value===\"function\")buffer+=value(context);break;case\"&\":value=context.lookup(tokenValue);if(value!=null)buffer+=value;break;case\"name\":value=context.lookup(tokenValue);if(value!=null)buffer+=exports.escape(value);break;case\"text\":buffer+=tokenValue;break}}return buffer}function nestTokens(tokens){var tree=[];var collector=tree;var sections=[];var token;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];switch(token[0]){case\"#\":case\"^\":sections.push(token);collector.push(token);collector=token[4]=[];break;case\"/\":var section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:tree;break;default:collector.push(token)}}return tree}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];if(token){if(token[0]===\"text\"&&lastToken&&lastToken[0]===\"text\"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{lastToken=token;squashedTokens.push(token)}}}return squashedTokens}function escapeTags(tags){return[new RegExp(escapeRe(tags[0])+\"\\\\s*\"),new RegExp(\"\\\\s*\"+escapeRe(tags[1]))]}exports.parse=function(template,tags){template=template||\"\";tags=tags||exports.tags;if(typeof tags===\"string\")tags=tags.split(spaceRe);if(tags.length!==2)throw new Error(\"Invalid tags: \"+tags.join(\", \"));var tagRes=escapeTags(tags);var scanner=new Scanner(template);var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length){delete tokens[spaces.pop()]}}else{spaces=[]}hasTag=false;nonSpace=false}var start,type,value,chr,token;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(tagRes[0]);if(value){for(var i=0,len=value.length;i<len;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push([\"text\",chr,start,start+1]);start+=1;if(chr==\"\\n\")stripSpace()}}if(!scanner.scan(tagRes[0]))break;hasTag=true;type=scanner.scan(tagRe)||\"name\";scanner.scan(whiteRe);if(type===\"=\"){value=scanner.scanUntil(eqRe);scanner.scan(eqRe);scanner.scanUntil(tagRes[1])}else if(type===\"{\"){value=scanner.scanUntil(new RegExp(\"\\\\s*\"+escapeRe(\"}\"+tags[1])));scanner.scan(curlyRe);scanner.scanUntil(tagRes[1]);type=\"&\"}else{value=scanner.scanUntil(tagRes[1])}if(!scanner.scan(tagRes[1]))throw new Error(\"Unclosed tag at \"+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type===\"#\"||type===\"^\"){sections.push(token)}else if(type===\"/\"){if(sections.length===0)throw new Error('Unopened section \"'+value+'\" at '+start);var openSection=sections.pop();if(openSection[1]!==value)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+start)}else if(type===\"name\"||type===\"{\"||type===\"&\"){nonSpace=true}else if(type===\"=\"){tags=value.split(spaceRe);if(tags.length!==2)throw new Error(\"Invalid tags at \"+start+\": \"+tags.join(\", \"));tagRes=escapeTags(tags)}}var openSection=sections.pop();if(openSection)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+scanner.pos);tokens=squashTokens(tokens);return nestTokens(tokens)};var _writer=new Writer;exports.clearCache=function(){return _writer.clearCache()};exports.compile=function(template,tags){return _writer.compile(template,tags)};exports.compilePartial=function(name,template,tags){return _writer.compilePartial(name,template,tags)};exports.compileTokens=function(tokens,template){return _writer.compileTokens(tokens,template)\n};exports.render=function(template,view,partials){return _writer.render(template,view,partials)};exports.to_html=function(template,view,partials,send){var result=exports.render(template,view,partials);if(typeof send===\"function\"){send(result)}else{return result}};return exports}());if(typeof owl===\"undefined\")owl={};owl.pluralize=function(){var userDefined={};function capitalizeSame(word,sampleWord){if(sampleWord.match(/^[A-Z]/)){return word.charAt(0).toUpperCase()+word.slice(1)}else{return word}}function toKeys(keys){keys=keys.split(\",\");var keysLength=keys.length;var table={};for(var i=0;i<keysLength;i++){table[keys[i]]=1}return table}var uninflected=toKeys(\"aircraft,advice,blues,corn,molasses,equipment,gold,information,cotton,jewelry,kin,legislation,luck,luggage,moose,music,offspring,rice,silver,trousers,wheat,bison,bream,breeches,britches,carp,chassis,clippers,cod,contretemps,corps,debris,diabetes,djinn,eland,elk,flounder,gallows,graffiti,headquarters,herpes,high,homework,innings,jackanapes,mackerel,measles,mews,mumps,news,pincers,pliers,proceedings,rabies,salmon,scissors,sea,series,shears,species,swine,trout,tuna,whiting,wildebeest,pike,oats,tongs,dregs,snuffers,victuals,tweezers,vespers,pinchers,bellows,cattle\");var irregular={I:\"we\",you:\"you\",he:\"they\",it:\"they\",me:\"us\",you:\"you\",him:\"them\",them:\"them\",myself:\"ourselves\",yourself:\"yourselves\",himself:\"themselves\",herself:\"themselves\",itself:\"themselves\",themself:\"themselves\",oneself:\"oneselves\",child:\"children\",dwarf:\"dwarfs\",mongoose:\"mongooses\",mythos:\"mythoi\",ox:\"oxen\",soliloquy:\"soliloquies\",trilby:\"trilbys\",person:\"people\",forum:\"forums\",syllabus:\"syllabi\",alumnus:\"alumni\",genus:\"genera\",viscus:\"viscera\",stigma:\"stigmata\"};var suffixRules=[[/man$/i,\"men\"],[/([lm])ouse$/i,\"$1ice\"],[/tooth$/i,\"teeth\"],[/goose$/i,\"geese\"],[/foot$/i,\"feet\"],[/zoon$/i,\"zoa\"],[/([tcsx])is$/i,\"$1es\"],[/ix$/i,\"ices\"],[/^(cod|mur|sil|vert)ex$/i,\"$1ices\"],[/^(agend|addend|memorand|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi)um$/i,\"$1a\"],[/^(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|\\w+hedr)on$/i,\"$1a\"],[/^(alumn|alg|vertebr)a$/i,\"$1ae\"],[/([cs]h|ss|x)$/i,\"$1es\"],[/([aeo]l|[^d]ea|ar)f$/i,\"$1ves\"],[/([nlw]i)fe$/i,\"$1ves\"],[/([aeiou])y$/i,\"$1ys\"],[/(^[A-Z][a-z]*)y$/,\"$1ys\"],[/y$/i,\"ies\"],[/([aeiou])o$/i,\"$1os\"],[/^(pian|portic|albin|generalissim|manifest|archipelag|ghett|medic|armadill|guan|octav|command|infern|phot|ditt|jumb|pr|dynam|ling|quart|embry|lumbag|rhin|fiasc|magnet|styl|alt|contralt|sopran|bass|crescend|temp|cant|sol|kimon)o$/i,\"$1os\"],[/o$/i,\"oes\"],[/s$/i,\"ses\"]];function pluralize(word,count,plural){if(word===\"\")return\"\";if(count===1)return word;if(typeof plural===\"string\")return plural;var lowerWord=word.toLowerCase();if(lowerWord in userDefined){return capitalizeSame(userDefined[lowerWord],word)}if(word.match(/^[A-Z]$/))return word+\"'s\";if(word.match(/fish$|ois$|sheep$|deer$|pox$|itis$/i))return word;if(word.match(/^[A-Z][a-z]*ese$/))return word;if(lowerWord in uninflected)return word;if(lowerWord in irregular){return capitalizeSame(irregular[lowerWord],word)}var suffixRulesLength=suffixRules.length;for(var i=0;i<suffixRulesLength;i++){var rule=suffixRules[i];if(word.match(rule[0])){return word.replace(rule[0],rule[1])}}return word+\"s\"}pluralize.define=function(word,plural){userDefined[word.toLowerCase()]=plural};return pluralize}();owl.pluralize.define(\"emacs\",\"emacsen\");(function(){var async={};var root,previous_async;root=this;if(root!=null){previous_async=root.async}async.noConflict=function(){root.async=previous_async;return async};function only_once(fn){var called=false;return function(){if(called)throw new Error(\"Callback was already called.\");called=true;fn.apply(root,arguments)}}var _each=function(arr,iterator){if(arr.forEach){return arr.forEach(iterator)}for(var i=0;i<arr.length;i+=1){iterator(arr[i],i,arr)}};var _map=function(arr,iterator){if(arr.map){return arr.map(iterator)}var results=[];_each(arr,function(x,i,a){results.push(iterator(x,i,a))});return results};var _reduce=function(arr,iterator,memo){if(arr.reduce){return arr.reduce(iterator,memo)}_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)});return memo};var _keys=function(obj){if(Object.keys){return Object.keys(obj)}var keys=[];for(var k in obj){if(obj.hasOwnProperty(k)){keys.push(k)}}return keys};if(typeof process===\"undefined\"||!process.nextTick){if(typeof setImmediate===\"function\"){async.setImmediate=setImmediate;async.nextTick=setImmediate}else{async.setImmediate=async.nextTick;async.nextTick=function(fn){setTimeout(fn,0)}}}else{async.nextTick=process.nextTick;async.setImmediate=setImmediate}async.each=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;_each(arr,function(x){iterator(x,only_once(function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}}}))})};async.forEach=async.each;async.eachSeries=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;var iterate=function(){iterator(arr[completed],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}else{iterate()}}})};iterate()};async.forEachSeries=async.eachSeries;async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])};async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){callback=callback||function(){};if(!arr.length||limit<=0){return callback()}var completed=0;var started=0;var running=0;(function replenish(){if(completed>=arr.length){return callback()}while(running<limit&&started<arr.length){started+=1;running+=1;iterator(arr[started-1],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;running-=1;if(completed>=arr.length){callback()}else{replenish()}}})}})()}};var doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}};var doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}};var doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}};var _asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v;callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap);async.mapSeries=doSeries(_asyncMap);async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v;callback(err)})},function(err){callback(err,memo)})};async.inject=async.reduce;async.foldl=async.reduce;async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)};async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter);async.filterSeries=doSeries(_filter);async.select=async.filter;async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(!v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject);async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){if(result){main_callback(x);main_callback=function(){}}else{callback()}})},function(err){main_callback()})};async.detect=doParallel(_detect);async.detectSeries=doSeries(_detect);async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(v){main_callback(true);main_callback=function(){}}callback()})},function(err){main_callback(false)})};async.any=async.some;async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(!v){main_callback(false);main_callback=function(){}}callback()})},function(err){main_callback(true)})};async.all=async.every;async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){if(err){callback(err)}else{callback(null,{value:x,criteria:criteria})}})},function(err,results){if(err){return callback(err)}else{var fn=function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))}})};async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length){return callback(null)}var results={};var listeners=[];var addListener=function(fn){listeners.unshift(fn)};var removeListener=function(fn){for(var i=0;i<listeners.length;i+=1){if(listeners[i]===fn){listeners.splice(i,1);return}}};var taskComplete=function(){_each(listeners.slice(0),function(fn){fn()})};addListener(function(){if(_keys(results).length===keys.length){callback(null,results);callback=function(){}}});_each(keys,function(k){var task=tasks[k]instanceof Function?[tasks[k]]:tasks[k];var taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}if(err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]});safeResults[k]=args;callback(err,safeResults);callback=function(){}}else{results[k]=args;async.setImmediate(taskComplete)}};var requires=task.slice(0,Math.abs(task.length-1))||[];var ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},true)&&!results.hasOwnProperty(k)};if(ready()){task[task.length-1](taskCallback,results)}else{var listener=function(){if(ready()){removeListener(listener);task[task.length-1](taskCallback,results)}};addListener(listener)}})};async.waterfall=function(tasks,callback){callback=callback||function(){};if(tasks.constructor!==Array){var err=new Error(\"First argument to waterfall must be an array of functions\");return callback(err)}if(!tasks.length){return callback()}var wrapIterator=function(iterator){return function(err){if(err){callback.apply(null,arguments);callback=function(){}}else{var args=Array.prototype.slice.call(arguments,1);var next=iterator.next();if(next){args.push(wrapIterator(next))}else{args.push(callback)}async.setImmediate(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){eachfn.map(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)};async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)};async.series=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){async.mapSeries(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){if(tasks.length){tasks[index].apply(null,arguments)}return fn.next()};fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null};return fn};return makeCallback(0)};async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]);cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat);async.concatSeries=doSeries(_concat);async.whilst=function(test,iterator,callback){if(test()){iterator(function(err){if(err){return callback(err)}async.whilst(test,iterator,callback)})}else{callback()}};async.doWhilst=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(test()){async.doWhilst(iterator,test,callback)}else{callback()}})};async.until=function(test,iterator,callback){if(!test()){iterator(function(err){if(err){return callback(err)}async.until(test,iterator,callback)})}else{callback()}};async.doUntil=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(!test()){async.doUntil(iterator,test,callback)}else{callback()}})};async.queue=function(worker,concurrency){if(concurrency===undefined){concurrency=1}function _insert(q,data,pos,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){var item={data:task,callback:typeof callback===\"function\"?callback:null};if(pos){q.tasks.unshift(item)}else{q.tasks.push(item)}if(q.saturated&&q.tasks.length===concurrency){q.saturated()}async.setImmediate(q.process)})}var workers=0;var q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,push:function(data,callback){_insert(q,data,false,callback)},unshift:function(data,callback){_insert(q,data,true,callback)},process:function(){if(workers<q.concurrency&&q.tasks.length){var task=q.tasks.shift();if(q.empty&&q.tasks.length===0){q.empty()}workers+=1;var next=function(){workers-=1;if(task.callback){task.callback.apply(task,arguments)}if(q.drain&&q.tasks.length+workers===0){q.drain()}q.process()};var cb=only_once(next);worker(task.data,cb)}},length:function(){return q.tasks.length},running:function(){return workers}};return q};async.cargo=function(worker,payload){var working=false,tasks=[];var cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,push:function(data,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){tasks.push({data:task,callback:typeof callback===\"function\"?callback:null});if(cargo.saturated&&tasks.length===payload){cargo.saturated()}});async.setImmediate(cargo.process)},process:function process(){if(working)return;if(tasks.length===0){if(cargo.drain)cargo.drain();return}var ts=typeof payload===\"number\"?tasks.splice(0,payload):tasks.splice(0);var ds=_map(ts,function(task){return task.data});if(cargo.empty)cargo.empty();working=true;worker(ds,function(){working=false;var args=arguments;_each(ts,function(data){if(data.callback){data.callback.apply(null,args)}});process()})},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);if(typeof console!==\"undefined\"){if(err){if(console.error){console.error(err)}}else if(console[name]){_each(args,function(x){console[name](x)})}}}]))}};async.log=_console_fn(\"log\");async.dir=_console_fn(\"dir\");async.memoize=function(fn,hasher){var memo={};var queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments);var callback=args.pop();var key=hasher.apply(null,args);if(key in memo){callback.apply(null,memo[key])}else if(key in queues){queues[key].push(callback)}else{queues[key]=[callback];fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;i<l;i++){q[i].apply(null,arguments)}}]))}};memoized.memo=memo;memoized.unmemoized=fn;return memoized};async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}};async.times=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.map(counter,iterator,callback)};async.timesSeries=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.mapSeries(counter,iterator,callback)};async.compose=function(){var fns=Array.prototype.reverse.call(arguments);return function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0];var nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}};var _applyEach=function(eachfn,fns){var go=function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();return eachfn(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return go.apply(this,args)}else{return go}};async.applyEach=doParallel(_applyEach);async.applyEachSeries=doSeries(_applyEach);async.forever=function(fn,callback){function next(err){if(err){if(callback){return callback(err)}throw err}fn(next)}next()};if(typeof define!==\"undefined\"&&define.amd){define([],function(){return async})}else if(typeof module!==\"undefined\"&&module.exports){module.exports=async}else{root.async=async}})();(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!==\"undefined\"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION=\"0.9.10\";var _=root._;if(!_&&typeof require!==\"undefined\")_=require(\"underscore\");Backbone.$=root.jQuery||root.Zepto||root.ender;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var eventSplitter=/\\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name===\"object\"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}}else if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}}else{return true}};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args)}};var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,\"on\",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,\"once\",name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,\"off\",name,[callback,context]))return this;if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context){retain.push(ev)}}}if(!retain.length)delete this._events[name]}}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,\"trigger\",name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners)return this;if(obj){obj.off(name,typeof name===\"object\"?this:callback,this);if(!name&&!callback)delete listeners[obj._listenerId]}else{if(typeof name===\"object\")callback=this;for(var id in listeners){listeners[id].off(name,callback,this)}this._listeners={}}return this}};var listenMethods={listenTo:\"on\",listenToOnce:\"once\"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={});var id=obj._listenerId||(obj._listenerId=_.uniqueId(\"l\"));listeners[id]=obj;obj[implementation](name,typeof name===\"object\"?this:callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults;var attrs=attributes||{};this.cid=_.uniqueId(\"c\");this.attributes={};if(options&&options.collection)this.collection=options.collection;if(options&&options.parse)attrs=this.parse(attrs,options)||{};if(defaults=_.result(this,\"defaults\")){attrs=_.defaults({},attrs,defaults)}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:\"id\",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key===\"object\"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length)this._pending=true;for(var i=0,l=changes.length;i<l;i++){this.trigger(\"change:\"+changes[i],this,current[changes[i]],options)}}if(changing)return this;if(!silent){while(this._pending){this._pending=false;this.trigger(\"change\",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],val=diff[attr]))continue;(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;options.success=function(model,resp,options){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options)};return this.sync(\"read\",this,options)},save:function(key,val,options){var attrs,success,method,xhr,attributes=this.attributes;if(key==null||typeof key===\"object\"){attrs=key;options=val}else{(attrs={})[key]=val}if(attrs&&(!options||!options.wait)&&!this.set(attrs,options))return false;options=_.extend({validate:true},options);if(!this._validate(attrs,options))return false;if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0)options.parse=true;success=options.success;options.success=function(model,resp,options){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success)success(model,resp,options)};method=this.isNew()?\"create\":options.patch?\"patch\":\"update\";if(method===\"patch\")options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger(\"destroy\",model,model.collection,options)};options.success=function(model,resp,options){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options)};if(this.isNew()){options.success(this,null,options);return false}var xhr=this.sync(\"delete\",this,options);if(!options.wait)destroy();return xhr},url:function(){var base=_.result(this,\"urlRoot\")||_.result(this.collection,\"url\")||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)===\"/\"?\"\":\"/\")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger(\"invalid\",this,error,options||{});return false}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.url)this.url=options.url;if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options))};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,model,attrs,existing,doSort,add,at,sort,sortAttr;add=[];at=options.at;sort=this.comparator&&at==null&&options.sort!==false;sortAttr=_.isString(this.comparator)?this.comparator:null;for(i=0,l=models.length;i<l;i++){if(!(model=this._prepareModel(attrs=models[i],options))){this.trigger(\"invalid\",this,attrs,options);continue}if(existing=this.get(model)){if(options.merge){existing.set(attrs===model?model.attributes:attrs,options);if(sort&&!doSort&&existing.hasChanged(sortAttr))doSort=true}continue}add.push(model);model.on(\"all\",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model}if(add.length){if(sort)doSort=true;this.length+=add.length;if(at!=null){splice.apply(this.models,[at,0].concat(add))}else{push.apply(this.models,add)}}if(doSort)this.sort({silent:true});if(options.silent)return this;for(i=0,l=add.length;i<l;i++){(model=add[i]).trigger(\"add\",model,this,options)}if(doSort)this.trigger(\"sort\",this,options);return this},remove:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger(\"remove\",model,this,options)}this._removeReference(model)}return this},push:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:this.length},options));return model},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:0},options));return model},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){if(obj==null)return void 0;this._idAttr||(this._idAttr=this.model.prototype.idAttribute);return this._byId[obj.id||obj.cid||obj[this._idAttr]||obj]},at:function(index){return this.models[index]},where:function(attrs){if(_.isEmpty(attrs))return[];return this.filter(function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false}return true})},sort:function(options){if(!this.comparator){throw new Error(\"Cannot sort a set without a comparator\")}options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent)this.trigger(\"sort\",this,options);return this},pluck:function(attr){return _.invoke(this.models,\"get\",attr)},update:function(models,options){options=_.extend({add:true,merge:true,remove:true},options);if(options.parse)models=this.parse(models,options);var model,i,l,existing;var add=[],remove=[],modelMap={};if(!_.isArray(models))models=models?[models]:[];if(options.add&&!options.remove)return this.add(models,options);for(i=0,l=models.length;i<l;i++){model=models[i];existing=this.get(model);if(options.remove&&existing)modelMap[existing.cid]=true;if(options.add&&!existing||options.merge&&existing){add.push(model)}}if(options.remove){for(i=0,l=this.models.length;i<l;i++){model=this.models[i];if(!modelMap[model.cid])remove.push(model)}}if(remove.length)this.remove(remove,options);if(add.length)this.add(add,options);return this},reset:function(models,options){options||(options={});if(options.parse)models=this.parse(models,options);for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();if(models)this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger(\"reset\",this,options);return this},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;options.success=function(collection,resp,options){var method=options.update?\"update\":\"reset\";collection[method](resp,options);if(success)success(collection,resp,options)};return this.sync(\"read\",this,options)},create:function(model,options){options=options?_.clone(options):{};\nif(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(model,resp,options){if(options.wait)collection.add(model,options);if(success)success(model,resp,options)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection)attrs.collection=this;return attrs}options||(options={});options.collection=this;var model=new this.model(attrs,options);if(!model._validate(attrs,options))return false;return model},_removeReference:function(model){if(this===model.collection)delete model.collection;model.off(\"all\",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event===\"add\"||event===\"remove\")&&collection!==this)return;if(event===\"destroy\")this.remove(model,options);if(model&&event===\"change:\"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model}this.trigger.apply(this,arguments)},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)}});var methods=[\"forEach\",\"each\",\"map\",\"collect\",\"reduce\",\"foldl\",\"inject\",\"reduceRight\",\"foldr\",\"find\",\"detect\",\"filter\",\"select\",\"reject\",\"every\",\"all\",\"some\",\"any\",\"include\",\"contains\",\"invoke\",\"max\",\"min\",\"toArray\",\"size\",\"first\",\"head\",\"take\",\"initial\",\"rest\",\"tail\",\"drop\",\"last\",\"without\",\"indexOf\",\"shuffle\",\"lastIndexOf\",\"isEmpty\",\"chain\"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=[\"groupBy\",\"countBy\",\"sortBy\"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\\((.*?)\\)/g;var namedParam=/(\\(\\?)?:\\w+/g;var splatParam=/\\*\\w+/g;var escapeRegExp=/[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(!callback)callback=this[name];Backbone.history.route(route,_.bind(function(fragment){var args=this._extractParameters(route,fragment);callback&&callback.apply(this,args);this.trigger.apply(this,[\"route:\"+name].concat(args));this.trigger(\"route\",name,args);Backbone.history.trigger(\"route\",this,name,args)},this));return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes)return;var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,\"\\\\$&\").replace(optionalParam,\"(?:$1)?\").replace(namedParam,function(match,optional){return optional?match:\"([^/]+)\"}).replace(splatParam,\"(.*?)\");return new RegExp(\"^\"+route+\"$\")},_extractParameters:function(route,fragment){return route.exec(fragment).slice(1)}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,\"checkUrl\");if(typeof window!==\"undefined\"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\\/]|\\s+$/g;var rootStripper=/^\\/+|\\/+$/g;var isExplorer=/msie [\\w.]+/;var trailingSlash=/\\/$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:\"\"},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,\"\");if(!fragment.indexOf(root))fragment=fragment.substr(root.length)}else{fragment=this.getHash()}}return fragment.replace(routeStripper,\"\")},start:function(options){if(History.started)throw new Error(\"Backbone.history has already been started\");History.started=true;this.options=_.extend({},{root:\"/\"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);this.root=(\"/\"+this.root+\"/\").replace(rootStripper,\"/\");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src=\"javascript:0\" tabindex=\"-1\" />').hide().appendTo(\"body\")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on(\"popstate\",this.checkUrl)}else if(this._wantsHashChange&&\"onhashchange\"in window&&!oldIE){Backbone.$(window).on(\"hashchange\",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\\/]$/,\"$&/\")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+\"#\"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,\"\");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){Backbone.$(window).off(\"popstate\",this.checkUrl).off(\"hashchange\",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:options};fragment=this.getFragment(fragment||\"\");if(this.fragment===fragment)return;this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState){this.history[options.replace?\"replaceState\":\"pushState\"]({},document.title,url)}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}if(options.trigger)this.loadUrl(fragment)},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,\"\");location.replace(href+\"#\"+fragment)}else{location.hash=\"#\"+fragment}}});Backbone.history=new History;var View=Backbone.View=function(options){this.cid=_.uniqueId(\"view\");this._configure(options||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\\S+)\\s*(.*)$/;var viewOptions=[\"model\",\"collection\",\"el\",\"id\",\"attributes\",\"className\",\"tagName\",\"events\"];_.extend(View.prototype,Events,{tagName:\"div\",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this},delegateEvents:function(events){if(!(events||(events=_.result(this,\"events\"))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)throw new Error('Method \"'+events[key]+'\" does not exist');var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=\".delegateEvents\"+this.cid;if(selector===\"\"){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(\".delegateEvents\"+this.cid);return this},_configure:function(options){if(this.options)options=_.extend({},_.result(this,\"options\"),options);_.extend(this,_.pick(options,viewOptions));this.options=options},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,\"attributes\"));if(this.id)attrs.id=_.result(this,\"id\");if(this.className)attrs[\"class\"]=_.result(this,\"className\");var $el=Backbone.$(\"<\"+_.result(this,\"tagName\")+\">\").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,\"el\"),false)}}});var methodMap={create:\"POST\",update:\"PUT\",patch:\"PATCH\",\"delete\":\"DELETE\",read:\"GET\"};Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:\"json\"};if(!options.url){params.url=_.result(model,\"url\")||urlError()}if(options.data==null&&model&&(method===\"create\"||method===\"update\"||method===\"patch\")){params.contentType=\"application/json\";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType=\"application/x-www-form-urlencoded\";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type===\"PUT\"||type===\"DELETE\"||type===\"PATCH\")){params.type=\"POST\";if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader(\"X-HTTP-Method-Override\",type);if(beforeSend)return beforeSend.apply(this,arguments)}}if(params.type!==\"GET\"&&!options.emulateJSON){params.processData=false}var success=options.success;options.success=function(resp){if(success)success(model,resp,options);model.trigger(\"sync\",model,resp,options)};var error=options.error;options.error=function(xhr){if(error)error(model,xhr,options);model.trigger(\"error\",model,xhr,options)};var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger(\"request\",model,xhr,options);return xhr};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,\"constructor\")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A \"url\" property or function must be specified')}}).call(this);var Showdown={};Showdown.converter=function(){var g_urls;var g_titles;var g_html_blocks;var g_list_level=0;this.makeHtml=function(text){g_urls=new Array;g_titles=new Array;g_html_blocks=new Array;text=text.replace(/~/g,\"~T\");text=text.replace(/\\$/g,\"~D\");text=text.replace(/\\r\\n/g,\"\\n\");text=text.replace(/\\r/g,\"\\n\");text=\"\\n\\n\"+text+\"\\n\\n\";text=_Detab(text);text=text.replace(/^[ \\t]+$/gm,\"\");text=_HashHTMLBlocks(text);text=_StripLinkDefinitions(text);text=_RunBlockGamut(text);text=_UnescapeSpecialChars(text);text=text.replace(/~D/g,\"$$\");text=text.replace(/~T/g,\"~\");return text};var _StripLinkDefinitions=function(text){var text=text.replace(/^[ ]{0,3}\\[(.+)\\]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"(](.+?)[\")][ \\t]*)?(?:\\n+|\\Z)/gm,function(wholeMatch,m1,m2,m3,m4){m1=m1.toLowerCase();g_urls[m1]=_EncodeAmpsAndAngles(m2);if(m3){return m3+m4}else if(m4){g_titles[m1]=m4.replace(/\"/g,\"&quot;\")}return\"\"});return text};var _HashHTMLBlocks=function(text){text=text.replace(/\\n/g,\"\\n\\n\");var block_tags_a=\"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del\";var block_tags_b=\"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math\";text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\\b[^\\r]*?\\n<\\/\\2>[ \\t]*(?=\\n+))/gm,hashElement);text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\\b[^\\r]*?.*<\\/\\2>[ \\t]*(?=\\n+)\\n)/gm,hashElement);text=text.replace(/(\\n[ ]{0,3}(<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/(\\n\\n[ ]{0,3}<!(--[^\\r]*?--\\s*)+>[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/(?:\\n\\n)([ ]{0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g,hashElement);text=text.replace(/\\n\\n/g,\"\\n\");return text};var hashElement=function(wholeMatch,m1){var blockText=m1;blockText=blockText.replace(/\\n\\n/g,\"\\n\");blockText=blockText.replace(/^\\n/,\"\");blockText=blockText.replace(/\\n+$/g,\"\");blockText=\"\\n\\n~K\"+(g_html_blocks.push(blockText)-1)+\"K\\n\\n\";return blockText};var _RunBlockGamut=function(text){text=_DoHeaders(text);var key=hashBlock(\"<hr />\");text=text.replace(/^[ ]{0,2}([ ]?\\*[ ]?){3,}[ \\t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\\-[ ]?){3,}[ \\t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\\_[ ]?){3,}[ \\t]*$/gm,key);text=_DoLists(text);text=_DoCodeBlocks(text);text=_DoBlockQuotes(text);text=_HashHTMLBlocks(text);text=_FormParagraphs(text);return text};var _RunSpanGamut=function(text){text=_DoCodeSpans(text);text=_EscapeSpecialCharsWithinTagAttributes(text);text=_EncodeBackslashEscapes(text);text=_DoImages(text);text=_DoAnchors(text);text=_DoAutoLinks(text);text=_EncodeAmpsAndAngles(text);text=_DoItalicsAndBold(text);text=text.replace(/  +\\n/g,\" <br />\\n\");return text};var _EscapeSpecialCharsWithinTagAttributes=function(text){var regex=/(<[a-z\\/!$](\"[^\"]*\"|'[^']*'|[^'\">])*>|<!(--.*?--\\s*)+>)/gi;text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\\/?code>(?=.)/g,\"$1`\");tag=escapeCharacters(tag,\"\\\\`*_\");return tag});return text};var _DoAnchors=function(text){text=text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g,writeAnchorTag);text=text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\]\\([ \\t]*()<?(.*?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g,writeAnchorTag);text=text.replace(/(\\[([^\\[\\]]+)\\])()()()()()/g,writeAnchorTag);return text};var writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){if(m7==undefined)m7=\"\";var whole_match=m1;var link_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(url==\"\"){if(link_id==\"\"){link_id=link_text.toLowerCase().replace(/ ?\\n/g,\" \")}url=\"#\"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{if(whole_match.search(/\\(\\s*\\)$/m)>-1){url=\"\"}else{return whole_match}}}url=escapeCharacters(url,\"*_\");var result='<a href=\"'+url+'\"';if(title!=\"\"){title=title.replace(/\"/g,\"&quot;\");title=escapeCharacters(title,\"*_\");result+=' title=\"'+title+'\"'}result+=\">\"+link_text+\"</a>\";return result};var _DoImages=function(text){text=text.replace(/(!\\[(.*?)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g,writeImageTag);text=text.replace(/(!\\[(.*?)\\]\\s?\\([ \\t]*()<?(\\S+?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g,writeImageTag);return text};var writeImageTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1;var alt_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(!title)title=\"\";if(url==\"\"){if(link_id==\"\"){link_id=alt_text.toLowerCase().replace(/ ?\\n/g,\" \")}url=\"#\"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{return whole_match}}alt_text=alt_text.replace(/\"/g,\"&quot;\");url=escapeCharacters(url,\"*_\");var result='<img src=\"'+url+'\" alt=\"'+alt_text+'\"';title=title.replace(/\"/g,\"&quot;\");title=escapeCharacters(title,\"*_\");result+=' title=\"'+title+'\"';result+=\" />\";return result};var _DoHeaders=function(text){text=text.replace(/^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,function(wholeMatch,m1){return hashBlock('<h1 id=\"'+headerId(m1)+'\">'+_RunSpanGamut(m1)+\"</h1>\")});text=text.replace(/^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm,function(matchFound,m1){return hashBlock('<h2 id=\"'+headerId(m1)+'\">'+_RunSpanGamut(m1)+\"</h2>\")});text=text.replace(/^(\\#{1,6})[ \\t]*(.+?)[ \\t]*\\#*\\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return hashBlock(\"<h\"+h_level+' id=\"'+headerId(m2)+'\">'+_RunSpanGamut(m2)+\"</h\"+h_level+\">\")});function headerId(m){return m.replace(/[^\\w]/g,\"\").toLowerCase()}return text};var _ProcessListItems;var _DoLists=function(text){text+=\"~0\";var whole_list=/^(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;if(g_list_level){text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1;var list_type=m2.search(/[*+-]/g)>-1?\"ul\":\"ol\";list=list.replace(/\\n{2,}/g,\"\\n\\n\\n\");var result=_ProcessListItems(list);result=result.replace(/\\s+$/,\"\");result=\"<\"+list_type+\">\"+result+\"</\"+list_type+\">\\n\";return result})}else{whole_list=/(\\n\\n|^\\n?)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/g;text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1;var list=m2;var list_type=m3.search(/[*+-]/g)>-1?\"ul\":\"ol\";var list=list.replace(/\\n{2,}/g,\"\\n\\n\\n\");var result=_ProcessListItems(list);result=runup+\"<\"+list_type+\">\\n\"+result+\"</\"+list_type+\">\\n\";return result})}text=text.replace(/~0/,\"\");return text};_ProcessListItems=function(list_str){g_list_level++;list_str=list_str.replace(/\\n{2,}$/,\"\\n\");list_str+=\"~0\";list_str=list_str.replace(/(\\n)?(^[ \\t]*)([*+-]|\\d+[.])[ \\t]+([^\\r]+?(\\n{1,2}))(?=\\n*(~0|\\2([*+-]|\\d+[.])[ \\t]+))/gm,function(wholeMatch,m1,m2,m3,m4){var item=m4;var leading_line=m1;var leading_space=m2;if(leading_line||item.search(/\\n{2,}/)>-1){item=_RunBlockGamut(_Outdent(item))}else{item=_DoLists(_Outdent(item));item=item.replace(/\\n$/,\"\");item=_RunSpanGamut(item)}return\"<li>\"+item+\"</li>\\n\"});list_str=list_str.replace(/~0/g,\"\");g_list_level--;return list_str};var _DoCodeBlocks=function(text){text+=\"~0\";text=text.replace(/(?:\\n\\n|^)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1;var nextChar=m2;codeblock=_EncodeCode(_Outdent(codeblock));codeblock=_Detab(codeblock);codeblock=codeblock.replace(/^\\n+/g,\"\");codeblock=codeblock.replace(/\\n+$/g,\"\");codeblock=\"<pre><code>\"+codeblock+\"\\n</code></pre>\";return hashBlock(codeblock)+nextChar});text=text.replace(/~0/,\"\");return text};var hashBlock=function(text){text=text.replace(/(^\\n+|\\n+$)/g,\"\");return\"\\n\\n~K\"+(g_html_blocks.push(text)-1)+\"K\\n\\n\"};var _DoCodeSpans=function(text){text=text.replace(/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,function(wholeMatch,m1,m2,m3,m4){var c=m3;c=c.replace(/^([ \\t]*)/g,\"\");c=c.replace(/[ \\t]*$/g,\"\");c=_EncodeCode(c);return m1+\"<code>\"+c+\"</code>\"});return text};var _EncodeCode=function(text){text=text.replace(/&/g,\"&amp;\");text=text.replace(/</g,\"&lt;\");text=text.replace(/>/g,\"&gt;\");text=escapeCharacters(text,\"*_{}[]\\\\\",false);return text};var _DoItalicsAndBold=function(text){text=text.replace(/(\\*\\*|__)(?=\\S)([^\\r]*?\\S[*_]*)\\1/g,\"<strong>$2</strong>\");text=text.replace(/(\\*|_)(?=\\S)([^\\r]*?\\S)\\1/g,\"<em>$2</em>\");return text};var _DoBlockQuotes=function(text){text=text.replace(/((^[ \\t]*>[ \\t]?.+\\n(.+\\n)*\\n*)+)/gm,function(wholeMatch,m1){var bq=m1;bq=bq.replace(/^[ \\t]*>[ \\t]?/gm,\"~0\");bq=bq.replace(/~0/g,\"\");bq=bq.replace(/^[ \\t]+$/gm,\"\");bq=_RunBlockGamut(bq);bq=bq.replace(/(^|\\n)/g,\"$1  \");bq=bq.replace(/(\\s*<pre>[^\\r]+?<\\/pre>)/gm,function(wholeMatch,m1){var pre=m1;pre=pre.replace(/^  /gm,\"~0\");pre=pre.replace(/~0/g,\"\");return pre});return hashBlock(\"<blockquote>\\n\"+bq+\"\\n</blockquote>\")});return text};var _FormParagraphs=function(text){text=text.replace(/^\\n+/g,\"\");text=text.replace(/\\n+$/g,\"\");var grafs=text.split(/\\n{2,}/g);var grafsOut=new Array;var end=grafs.length;for(var i=0;i<end;i++){var str=grafs[i];if(str.search(/~K(\\d+)K/g)>=0){grafsOut.push(str)}else if(str.search(/\\S/)>=0){str=_RunSpanGamut(str);str=str.replace(/^([ \\t]*)/g,\"<p>\");str+=\"</p>\";grafsOut.push(str)}}end=grafsOut.length;for(var i=0;i<end;i++){while(grafsOut[i].search(/~K(\\d+)K/)>=0){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\\$/g,\"$$$$\");grafsOut[i]=grafsOut[i].replace(/~K\\d+K/,blockText)}}return grafsOut.join(\"\\n\\n\")};var _EncodeAmpsAndAngles=function(text){text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g,\"&amp;\");text=text.replace(/<(?![a-z\\/?\\$!])/gi,\"&lt;\");return text};var _EncodeBackslashEscapes=function(text){text=text.replace(/\\\\(\\\\)/g,escapeCharacters_callback);text=text.replace(/\\\\([`*_{}\\[\\]()>#+-.!])/g,escapeCharacters_callback);return text};var _DoAutoLinks=function(text){text=text.replace(/<((https?|ftp|dict):[^'\">\\s]+)>/gi,'<a href=\"$1\">$1</a>');text=text.replace(/<(?:mailto:)?([-.\\w]+\\@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi,function(wholeMatch,m1){return _EncodeEmailAddress(_UnescapeSpecialChars(m1))});return text};var _EncodeEmailAddress=function(addr){function char2hex(ch){var hexDigits=\"0123456789ABCDEF\";var dec=ch.charCodeAt(0);return hexDigits.charAt(dec>>4)+hexDigits.charAt(dec&15)}var encode=[function(ch){return\"&#\"+ch.charCodeAt(0)+\";\"},function(ch){return\"&#x\"+char2hex(ch)+\";\"},function(ch){return ch}];addr=\"mailto:\"+addr;addr=addr.replace(/./g,function(ch){if(ch==\"@\"){ch=encode[Math.floor(Math.random()*2)](ch)}else if(ch!=\":\"){var r=Math.random();ch=r>.9?encode[2](ch):r>.45?encode[1](ch):encode[0](ch)}return ch});addr='<a href=\"'+addr+'\">'+addr+\"</a>\";addr=addr.replace(/\">.+:/g,'\">');return addr};var _UnescapeSpecialChars=function(text){text=text.replace(/~E(\\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace)});return text};var _Outdent=function(text){text=text.replace(/^(\\t|[ ]{1,4})/gm,\"~0\");text=text.replace(/~0/g,\"\");return text};var _Detab=function(text){text=text.replace(/\\t(?=\\t)/g,\"    \");text=text.replace(/\\t/g,\"~A~B\");text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1,m2){var leadingText=m1;var numSpaces=4-leadingText.length%4;for(var i=0;i<numSpaces;i++)leadingText+=\" \";return leadingText});text=text.replace(/~A/g,\"    \");text=text.replace(/~B/g,\"\");return text};var escapeCharacters=function(text,charsToEscape,afterBackslash){var regexString=\"([\"+charsToEscape.replace(/([\\[\\]\\\\])/g,\"\\\\$1\")+\"])\";if(afterBackslash){regexString=\"\\\\\\\\\"+regexString}var regex=new RegExp(regexString,\"g\");text=text.replace(regex,escapeCharacters_callback);return text};var escapeCharacters_callback=function(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return\"~E\"+charCodeToEscape+\"E\"}};if(typeof exports!=\"undefined\")exports.Showdown=Showdown;CodeMirror.defineMode(\"javascript\",function(config,parserConfig){var indentUnit=config.indentUnit;var statementIndent=parserConfig.statementIndent;var jsonMode=parserConfig.json;var isTS=parserConfig.typescript;var keywords=function(){function kw(type){return{type:type,style:\"keyword\"}}var A=kw(\"keyword a\"),B=kw(\"keyword b\"),C=kw(\"keyword c\");var operator=kw(\"operator\"),atom={type:\"atom\",style:\"atom\"};var jsKeywords={\"if\":kw(\"if\"),\"while\":A,\"with\":A,\"else\":B,\"do\":B,\"try\":B,\"finally\":B,\"return\":C,\"break\":C,\"continue\":C,\"new\":C,\"delete\":C,\"throw\":C,\"var\":kw(\"var\"),\"const\":kw(\"var\"),let:kw(\"var\"),\"function\":kw(\"function\"),\"catch\":kw(\"catch\"),\"for\":kw(\"for\"),\"switch\":kw(\"switch\"),\"case\":kw(\"case\"),\"default\":kw(\"default\"),\"in\":operator,\"typeof\":operator,\"instanceof\":operator,\"true\":atom,\"false\":atom,\"null\":atom,undefined:atom,NaN:atom,Infinity:atom,\"this\":kw(\"this\"),module:kw(\"module\"),\"class\":kw(\"class\"),\"super\":kw(\"atom\"),yield:C,\"export\":kw(\"export\"),\"import\":kw(\"import\"),\"extends\":C};if(isTS){var type={type:\"variable\",style:\"variable-3\"};var tsKeywords={\"interface\":kw(\"interface\"),\"extends\":kw(\"extends\"),constructor:kw(\"constructor\"),\"public\":kw(\"public\"),\"private\":kw(\"private\"),\"protected\":kw(\"protected\"),\"static\":kw(\"static\"),string:type,number:type,bool:type,any:type};for(var attr in tsKeywords){jsKeywords[attr]=tsKeywords[attr]}}return jsKeywords}();var isOperatorChar=/[+\\-*&%=<>!?|~^]/;function nextUntilUnescaped(stream,end){var escaped=false,next;while((next=stream.next())!=null){if(next==end&&!escaped)return false;escaped=!escaped&&next==\"\\\\\"}return escaped}var type,content;function ret(tp,style,cont){type=tp;content=cont;return style}function tokenBase(stream,state){var ch=stream.next();if(ch=='\"'||ch==\"'\"){state.tokenize=tokenString(ch);return state.tokenize(stream,state)}else if(ch==\".\"&&stream.match(/^\\d+(?:[eE][+\\-]?\\d+)?/)){return ret(\"number\",\"number\")}else if(ch==\".\"&&stream.match(\"..\")){return ret(\"spread\",\"meta\")}else if(/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)){return ret(ch)}else if(ch==\"=\"&&stream.eat(\">\")){return ret(\"=>\")}else if(ch==\"0\"&&stream.eat(/x/i)){stream.eatWhile(/[\\da-f]/i);return ret(\"number\",\"number\")}else if(/\\d/.test(ch)){stream.match(/^\\d*(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/);return ret(\"number\",\"number\")}else if(ch==\"/\"){if(stream.eat(\"*\")){state.tokenize=tokenComment;return tokenComment(stream,state)}else if(stream.eat(\"/\")){stream.skipToEnd();return ret(\"comment\",\"comment\")}else if(state.lastType==\"operator\"||state.lastType==\"keyword c\"||state.lastType==\"sof\"||/^[\\[{}\\(,;:]$/.test(state.lastType)){nextUntilUnescaped(stream,\"/\");stream.eatWhile(/[gimy]/);return ret(\"regexp\",\"string-2\")}else{stream.eatWhile(isOperatorChar);return ret(\"operator\",null,stream.current())}}else if(ch==\"`\"){state.tokenize=tokenQuasi;return tokenQuasi(stream,state)}else if(ch==\"#\"){stream.skipToEnd();return ret(\"error\",\"error\")}else if(isOperatorChar.test(ch)){stream.eatWhile(isOperatorChar);return ret(\"operator\",null,stream.current())}else{stream.eatWhile(/[\\w\\$_]/);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return known&&state.lastType!=\".\"?ret(known.type,known.style,word):ret(\"variable\",\"variable\",word)}}function tokenString(quote){return function(stream,state){if(!nextUntilUnescaped(stream,quote))state.tokenize=tokenBase;return ret(\"string\",\"string\")}}function tokenComment(stream,state){var maybeEnd=false,ch;while(ch=stream.next()){if(ch==\"/\"&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd=ch==\"*\"}return ret(\"comment\",\"comment\")}function tokenQuasi(stream,state){var escaped=false,next;while((next=stream.next())!=null){if(!escaped&&(next==\"`\"||next==\"$\"&&stream.eat(\"{\"))){state.tokenize=tokenBase;break}escaped=!escaped&&next==\"\\\\\"}return ret(\"quasi\",\"string-2\",stream.current())}var brackets=\"([{}])\";function findFatArrow(stream,state){if(state.fatArrowAt)state.fatArrowAt=null;var arrow=stream.string.indexOf(\"=>\",stream.start);if(arrow<0)return;var depth=0,sawSomething=false;for(var pos=arrow-1;pos>=0;--pos){var ch=stream.string.charAt(pos);var bracket=brackets.indexOf(ch);if(bracket>=0&&bracket<3){if(!depth){++pos;break}if(--depth==0)break}else if(bracket>=3&&bracket<6){++depth}else if(/[$\\w]/.test(ch)){sawSomething=true}else if(sawSomething&&!depth){++pos;break}}if(sawSomething&&!depth)state.fatArrowAt=pos}var atomicTypes={atom:true,number:true,variable:true,string:true,regexp:true,\"this\":true};function JSLexical(indented,column,type,align,prev,info){this.indented=indented;this.column=column;this.type=type;this.prev=prev;this.info=info;if(align!=null)this.align=align}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return true;for(var cx=state.context;cx;cx=cx.prev){for(var v=cx.vars;v;v=v.next)if(v.name==varname)return true}}function parseJS(state,style,type,content,stream){var cc=state.cc;cx.state=state;cx.stream=stream;cx.marked=null,cx.cc=cc;if(!state.lexical.hasOwnProperty(\"align\"))state.lexical.align=true;while(true){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){while(cc.length&&cc[cc.length-1].lex)cc.pop()();if(cx.marked)return cx.marked;if(type==\"variable\"&&inScope(state,content))return\"variable-2\";return style}}}var cx={state:null,column:null,marked:null,cc:null};function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){pass.apply(null,arguments);return true}function register(varname){function inList(list){for(var v=list;v;v=v.next)if(v.name==varname)return true;return false}var state=cx.state;if(state.context){cx.marked=\"def\";if(inList(state.localVars))return;state.localVars={name:varname,next:state.localVars}}else{if(inList(state.globalVars))return;if(parserConfig.globalVars)state.globalVars={name:varname,next:state.globalVars}}}var defaultVars={name:\"this\",next:{name:\"arguments\"}};function pushcontext(){cx.state.context={prev:cx.state.context,vars:cx.state.localVars};cx.state.localVars=defaultVars}function popcontext(){cx.state.localVars=cx.state.context.vars;cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;if(state.lexical.type==\"stat\")indent=state.lexical.indented;state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};result.lex=true;return result}function poplex(){var state=cx.state;if(state.lexical.prev){if(state.lexical.type==\")\")state.indented=state.lexical.indented;state.lexical=state.lexical.prev}}poplex.lex=true;function expect(wanted){return function(type){if(type==wanted)return cont();else if(wanted==\";\")return pass();else return cont(arguments.callee)}}function statement(type,value){if(type==\"var\")return cont(pushlex(\"vardef\",value.length),vardef,expect(\";\"),poplex);if(type==\"keyword a\")return cont(pushlex(\"form\"),expression,statement,poplex);if(type==\"keyword b\")return cont(pushlex(\"form\"),statement,poplex);if(type==\"{\")return cont(pushlex(\"}\"),block,poplex);if(type==\";\")return cont();if(type==\"if\")return cont(pushlex(\"form\"),expression,statement,poplex,maybeelse);if(type==\"function\")return cont(functiondef);if(type==\"for\")return cont(pushlex(\"form\"),forspec,poplex,statement,poplex);if(type==\"variable\")return cont(pushlex(\"stat\"),maybelabel);if(type==\"switch\")return cont(pushlex(\"form\"),expression,pushlex(\"}\",\"switch\"),expect(\"{\"),block,poplex,poplex);if(type==\"case\")return cont(expression,expect(\":\"));if(type==\"default\")return cont(expect(\":\"));if(type==\"catch\")return cont(pushlex(\"form\"),pushcontext,expect(\"(\"),funarg,expect(\")\"),statement,poplex,popcontext);if(type==\"module\")return cont(pushlex(\"form\"),pushcontext,afterModule,popcontext,poplex);if(type==\"class\")return cont(pushlex(\"form\"),className,objlit,poplex);if(type==\"export\")return cont(pushlex(\"form\"),afterExport,poplex);if(type==\"import\")return cont(pushlex(\"form\"),afterImport,poplex);return pass(pushlex(\"stat\"),expression,expect(\";\"),poplex)}function expression(type){return expressionInner(type,false)}function expressionNoComma(type){return expressionInner(type,true)}function expressionInner(type,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if(type==\"(\")return cont(pushcontext,commasep(pattern,\")\"),expect(\"=>\"),body,popcontext);else if(type==\"variable\")return pass(pushcontext,pattern,expect(\"=>\"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;if(atomicTypes.hasOwnProperty(type))return cont(maybeop);if(type==\"function\")return cont(functiondef);\nif(type==\"keyword c\")return cont(noComma?maybeexpressionNoComma:maybeexpression);if(type==\"(\")return cont(pushlex(\")\"),maybeexpression,comprehension,expect(\")\"),poplex,maybeop);if(type==\"operator\"||type==\"spread\")return cont(noComma?expressionNoComma:expression);if(type==\"[\")return cont(pushlex(\"]\"),expressionNoComma,maybeArrayComprehension,poplex,maybeop);if(type==\"{\")return cont(commasep(objprop,\"}\"),maybeop);return cont()}function maybeexpression(type){if(type.match(/[;\\}\\)\\],]/))return pass();return pass(expression)}function maybeexpressionNoComma(type){if(type.match(/[;\\}\\)\\],]/))return pass();return pass(expressionNoComma)}function maybeoperatorComma(type,value){if(type==\",\")return cont(expression);return maybeoperatorNoComma(type,value,false)}function maybeoperatorNoComma(type,value,noComma){var me=noComma==false?maybeoperatorComma:maybeoperatorNoComma;var expr=noComma==false?expression:expressionNoComma;if(value==\"=>\")return cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext);if(type==\"operator\"){if(/\\+\\+|--/.test(value))return cont(me);if(value==\"?\")return cont(expression,expect(\":\"),expr);return cont(expr)}if(type==\"quasi\"){cx.cc.push(me);return quasi(value)}if(type==\";\")return;if(type==\"(\")return cont(commasep(expressionNoComma,\")\",\"call\"),me);if(type==\".\")return cont(property,me);if(type==\"[\")return cont(pushlex(\"]\"),maybeexpression,expect(\"]\"),poplex,me)}function quasi(value){if(!value)debugger;if(value.slice(value.length-2)!=\"${\")return cont();return cont(expression,continueQuasi)}function continueQuasi(type){if(type==\"}\"){cx.marked=\"string-2\";cx.state.tokenize=tokenQuasi;return cont()}}function arrowBody(type){findFatArrow(cx.stream,cx.state);if(type==\"{\")return pass(statement);return pass(expression)}function arrowBodyNoComma(type){findFatArrow(cx.stream,cx.state);if(type==\"{\")return pass(statement);return pass(expressionNoComma)}function maybelabel(type){if(type==\":\")return cont(poplex,statement);return pass(maybeoperatorComma,expect(\";\"),poplex)}function property(type){if(type==\"variable\"){cx.marked=\"property\";return cont()}}function objprop(type,value){if(type==\"variable\"){cx.marked=\"property\";if(value==\"get\"||value==\"set\")return cont(getterSetter)}else if(type==\"number\"||type==\"string\"){cx.marked=type+\" property\"}else if(type==\"[\"){return cont(expression,expect(\"]\"),afterprop)}if(atomicTypes.hasOwnProperty(type))return cont(afterprop)}function getterSetter(type){if(type!=\"variable\")return pass(afterprop);cx.marked=\"property\";return cont(functiondef)}function afterprop(type){if(type==\":\")return cont(expressionNoComma);if(type==\"(\")return pass(functiondef)}function commasep(what,end,info){function proceed(type){if(type==\",\"){var lex=cx.state.lexical;if(lex.info==\"call\")lex.pos=(lex.pos||0)+1;return cont(what,proceed)}if(type==end)return cont();return cont(expect(end))}return function(type){if(type==end)return cont();if(info===false)return pass(what,proceed);return pass(pushlex(end,info),what,proceed,poplex)}}function block(type){if(type==\"}\")return cont();return pass(statement,block)}function maybetype(type){if(isTS&&type==\":\")return cont(typedef)}function typedef(type){if(type==\"variable\"){cx.marked=\"variable-3\";return cont()}}function vardef(){return pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){if(type==\"variable\"){register(value);return cont()}if(type==\"[\")return cont(commasep(pattern,\"]\"));if(type==\"{\")return cont(commasep(proppattern,\"}\"))}function proppattern(type,value){if(type==\"variable\"&&!cx.stream.match(/^\\s*:/,false)){register(value);return cont(maybeAssign)}if(type==\"variable\")cx.marked=\"property\";return cont(expect(\":\"),pattern,maybeAssign)}function maybeAssign(_type,value){if(value==\"=\")return cont(expressionNoComma)}function vardefCont(type){if(type==\",\")return cont(vardef)}function maybeelse(type,value){if(type==\"keyword b\"&&value==\"else\")return cont(pushlex(\"form\"),statement,poplex)}function forspec(type){if(type==\"(\")return cont(pushlex(\")\"),forspec1,expect(\")\"))}function forspec1(type){if(type==\"var\")return cont(vardef,expect(\";\"),forspec2);if(type==\";\")return cont(forspec2);if(type==\"variable\")return cont(formaybeinof);return pass(expression,expect(\";\"),forspec2)}function formaybeinof(_type,value){if(value==\"in\"||value==\"of\"){cx.marked=\"keyword\";return cont(expression)}return cont(maybeoperatorComma,forspec2)}function forspec2(type,value){if(type==\";\")return cont(forspec3);if(value==\"in\"||value==\"of\"){cx.marked=\"keyword\";return cont(expression)}return pass(expression,expect(\";\"),forspec3)}function forspec3(type){if(type!=\")\")cont(expression)}function functiondef(type,value){if(value==\"*\"){cx.marked=\"keyword\";return cont(functiondef)}if(type==\"variable\"){register(value);return cont(functiondef)}if(type==\"(\")return cont(pushcontext,commasep(funarg,\")\"),statement,popcontext)}function funarg(type){if(type==\"spread\")return cont(funarg);return pass(pattern,maybetype)}function className(type,value){if(type==\"variable\"){register(value);return cont(classNameAfter)}}function classNameAfter(_type,value){if(value==\"extends\")return cont(expression)}function objlit(type){if(type==\"{\")return cont(commasep(objprop,\"}\"))}function afterModule(type,value){if(type==\"string\")return cont(statement);if(type==\"variable\"){register(value);return cont(maybeFrom)}}function afterExport(_type,value){if(value==\"*\"){cx.marked=\"keyword\";return cont(maybeFrom,expect(\";\"))}if(value==\"default\"){cx.marked=\"keyword\";return cont(expression,expect(\";\"))}return pass(statement)}function afterImport(type){if(type==\"string\")return cont();return pass(importSpec,maybeFrom)}function importSpec(type,value){if(type==\"{\")return cont(commasep(importSpec,\"}\"));if(type==\"variable\")register(value);return cont()}function maybeFrom(_type,value){if(value==\"from\"){cx.marked=\"keyword\";return cont(expression)}}function maybeArrayComprehension(type){if(type==\"for\")return pass(comprehension);if(type==\",\")return cont(commasep(expressionNoComma,\"]\",false));return pass(commasep(expressionNoComma,\"]\",false))}function comprehension(type){if(type==\"for\")return cont(forspec,comprehension);if(type==\"if\")return cont(expression,comprehension)}return{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:\"sof\",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,\"block\",false),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:0};if(parserConfig.globalVars)state.globalVars=parserConfig.globalVars;return state},token:function(stream,state){if(stream.sol()){if(!state.lexical.hasOwnProperty(\"align\"))state.lexical.align=false;state.indented=stream.indentation();findFatArrow(stream,state)}if(state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);if(type==\"comment\")return style;state.lastType=type==\"operator\"&&(content==\"++\"||content==\"--\")?\"incdec\":type;return parseJS(state,style,type,content,stream)},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical;for(var i=state.cc.length-1;i>=0;--i){var c=state.cc[i];if(c==poplex)lexical=lexical.prev;else if(c!=maybeelse)break}if(lexical.type==\"stat\"&&firstChar==\"}\")lexical=lexical.prev;if(statementIndent&&lexical.type==\")\"&&lexical.prev.type==\"stat\")lexical=lexical.prev;var type=lexical.type,closing=firstChar==type;if(type==\"vardef\")return lexical.indented+(state.lastType==\"operator\"||state.lastType==\",\"?lexical.info+1:0);else if(type==\"form\"&&firstChar==\"{\")return lexical.indented;else if(type==\"form\")return lexical.indented+indentUnit;else if(type==\"stat\")return lexical.indented+(state.lastType==\"operator\"||state.lastType==\",\"?statementIndent||indentUnit:0);else if(lexical.info==\"switch\"&&!closing&&parserConfig.doubleIndentSwitch!=false)return lexical.indented+(/^(?:case|default)\\b/.test(textAfter)?indentUnit:2*indentUnit);else if(lexical.align)return lexical.column+(closing?0:1);else return lexical.indented+(closing?0:indentUnit)},electricChars:\":{}\",blockCommentStart:jsonMode?null:\"/*\",blockCommentEnd:jsonMode?null:\"*/\",lineComment:jsonMode?null:\"//\",fold:\"brace\",helperType:jsonMode?\"json\":\"javascript\",jsonMode:jsonMode}});CodeMirror.defineMIME(\"text/javascript\",\"javascript\");CodeMirror.defineMIME(\"text/ecmascript\",\"javascript\");CodeMirror.defineMIME(\"application/javascript\",\"javascript\");CodeMirror.defineMIME(\"application/ecmascript\",\"javascript\");CodeMirror.defineMIME(\"application/json\",{name:\"javascript\",json:true});CodeMirror.defineMIME(\"application/x-json\",{name:\"javascript\",json:true});CodeMirror.defineMIME(\"text/typescript\",{name:\"javascript\",typescript:true});CodeMirror.defineMIME(\"application/typescript\",{name:\"javascript\",typescript:true});\n/*\n//@ sourceMappingURL=https://zapier.cachefly.net/static/CUEboR/build/external.js.map\n*/"
      }
   },
   "visitedURLs": {
      "https://zapier.com": true,
      "https://zapier.com/app/signup": true,
      "https://zapier.com/login": "opening",
      "https://zapier.com/zapbook/gmail/": "opening",
      "https://zapier.com/zapbook/salesforce/": true,
      "https://zapier.com/zapbook/evernote/": true,
      "https://zapier.com/zapbook/zendesk/": "opening",
      "https://zapier.com/zapbook/trello/": "opening",
      "https://zapier.com/zapbook/dropbox/": "opening",
      "https://zapier.com/zapbook/twitter/": "opening",
      "https://zapier.com/zapbook/mailchimp/": true
   }
}